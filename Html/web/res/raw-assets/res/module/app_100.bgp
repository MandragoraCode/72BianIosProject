!function a(o,r,h){function g(t,e){if(!r[t]){if(!o[t]){var i="function"==typeof $require&&$require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var s=r[t]={exports:{}};o[t][0].call(s.exports,function(e){return g(o[t][1][e]||e)},s,s.exports,a,o,r,h)}return r[t].exports}for(var l="function"==typeof $require&&$require,e=0;e<h.length;e++)g(h[e]);return g}({1:[function(e,t,i){"use strict";e("./com/black8/game/GameModule"),e("./com/black8/game/util/utilIndex_0"),e("./com/black8/game/process/processIndex_0"),e("./com/black8/game/config/configIndex_0"),e("./com/black8/game/client/clientIndex_0"),e("./com/black8/game/event/eventIndex_9"),e("./com/black8/game/info/infoIndex_0"),e("./com/black8/game/fight/fightIndex_0"),e("./com/black8/game/scene/sceneIndex_2"),e("./com/black8/game/enum/enumIndex_4"),e("./com/black8/game/app/appIndex_0")},{"./com/black8/game/GameModule":3,"./com/black8/game/app/appIndex_0":4,"./com/black8/game/client/clientIndex_0":1079,"./com/black8/game/config/configIndex_0":1221,"./com/black8/game/enum/enumIndex_4":1241,"./com/black8/game/event/eventIndex_9":1247,"./com/black8/game/fight/fightIndex_0":1259,"./com/black8/game/info/infoIndex_0":1361,"./com/black8/game/process/processIndex_0":1542,"./com/black8/game/scene/sceneIndex_2":1605,"./com/black8/game/util/utilIndex_0":1664}],2:[function(e,t,i){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function a(o,r,h){function g(i,e){if(!r[i]){if(!o[i]){var t="function"==typeof $$require&&$$require;if(!e&&t)return t(i,!0);if(l)return l(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var s=r[i]={exports:{}};o[i][0].call(s.exports,function(e){var t=o[i][1][e];return g(t||e)},s,s.exports,a,o,r,h)}return r[i].exports}for(var l="function"==typeof $$require&&$$require,e=0;e<h.length;e++)g(h[e]);return g}({1:[function(e,t,i){e("./src/com/black8/sunny/engine_extension/SEngineExtension")},{"./src/com/black8/sunny/engine_extension/SEngineExtension":2}],2:[function(e,t,i){b8e.EXTENSION_VERSION="3.0.2",b8e.EngineExtension=function(){},b8e.EngineExtension.init=function(){b8e.EXTENSION_VERSION!=b8e.VERSION&&b8e.Toast.launch("Black8 Game Engine Extension和Black8 Game Engine版本不一致，请检查！\nGame Engine Extension:V"+b8e.EXTENSION_VERSION+" & Game Engine:V"+b8e.VERSION,4294901760,0)},e("./core/SWorker"),e("./utils/SDelegateUtil"),e("./utils/SMathUtil"),e("./std/SWireType"),e("./std/SWritingBuffer"),e("./std/SWriteUtil"),e("./std/SReadUtil"),e("./std/SBinary64"),e("./std/SInt64"),e("./std/SUInt64"),e("./std/SLinkedArray"),e("./enum/SMapGridType"),e("./assets/SFrameAtlas"),e("./assets/SAnimationClip"),e("./assets/SAnimatorResource"),e("./assets/SMetaConfig"),e("./assets/SBitmapData"),e("./display/SSceneDisplay"),e("./display/SDisplaySyncInfo"),e("./display/SSceneDisplaySyncInfo"),e("./display/animate/SAnimator"),e("./display/animate/SComposeAnimator"),e("./display/map/STileSurface"),e("./display/map/SGridSurface"),e("./display/map/SEarthSurface"),e("./display/map/SSceneMapLayer"),e("./display/map/SThumbSurface"),e("./display/entity/SSceneEntityLayer"),e("./display/entity/SAvatar"),e("./display/entity/SAvatarGhost"),e("./display/entity/SSceneEntity"),e("./display/SSceneCamera"),e("./display/ui/SRichText"),e("./utils/SShaderUtil"),e("./utils/SArrayUtil"),e("./manager/SProtobufMgr"),e("./input/SMouseController"),e("./state/SStateReference"),e("./state/SRoleStateReference"),e("./state/SState"),e("./state/SRoleState"),e("./state/SActionState"),e("./state/SControlState"),e("./state/SAIState"),e("./state/SStateMachine"),e("./algorithm/astar/SAstarNode"),e("./algorithm/astar/SAstarGrids"),e("./algorithm/astar/SAstar"),e("./math/SMBits"),e("./data/proto/SMapConfig"),e("./data/proto/SAnimateConfig"),b8e.startup&&b8e.startup.isInited()&&b8e.EngineExtension.init()},{"./algorithm/astar/SAstar":3,"./algorithm/astar/SAstarGrids":4,"./algorithm/astar/SAstarNode":5,"./assets/SAnimationClip":6,"./assets/SAnimatorResource":7,"./assets/SBitmapData":8,"./assets/SFrameAtlas":9,"./assets/SMetaConfig":10,"./core/SWorker":11,"./data/proto/SAnimateConfig":12,"./data/proto/SMapConfig":13,"./display/SDisplaySyncInfo":14,"./display/SSceneCamera":15,"./display/SSceneDisplay":16,"./display/SSceneDisplaySyncInfo":17,"./display/animate/SAnimator":18,"./display/animate/SComposeAnimator":19,"./display/entity/SAvatar":20,"./display/entity/SAvatarGhost":21,"./display/entity/SSceneEntity":22,"./display/entity/SSceneEntityLayer":23,"./display/map/SEarthSurface":24,"./display/map/SGridSurface":25,"./display/map/SSceneMapLayer":26,"./display/map/SThumbSurface":27,"./display/map/STileSurface":28,"./display/ui/SRichText":29,"./enum/SMapGridType":30,"./input/SMouseController":31,"./manager/SProtobufMgr":32,"./math/SMBits":33,"./state/SAIState":34,"./state/SActionState":35,"./state/SControlState":36,"./state/SRoleState":37,"./state/SRoleStateReference":38,"./state/SState":39,"./state/SStateMachine":40,"./state/SStateReference":41,"./std/SBinary64":42,"./std/SInt64":43,"./std/SLinkedArray":44,"./std/SReadUtil":45,"./std/SUInt64":46,"./std/SWireType":47,"./std/SWriteUtil":48,"./std/SWritingBuffer":49,"./utils/SArrayUtil":50,"./utils/SDelegateUtil":51,"./utils/SMathUtil":52,"./utils/SShaderUtil":53}],3:[function(e,t,i){b8e.Astar=b8e.Object.extends({ctor:function(){this._super(),this._grids=new b8e.AstarGrids},setSquares:function(e,t){this._grids.setSquares(e,t)},findPath:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(i==e&&n==t)return[];if(this.isSolid(e,t)){if(!(o=this.findWalkableGrid(e,t)))return[];e=o.x,t=o.y}if(this.isSolid(i,n)){var o;if(!(o=this.findWalkableGrid(i,n)))return[];i=o.x,n=o.y}var r=this._grids.findPath(e,t,i,n,!0);return s&&r&&this.floyd(r,a),r},findWalkableGrid:function(e,t){var i=this.getNode(e,t);if(i&&i.solid){for(var n=this._grids.width,s=this._grids.height,a=0,o=0,r=1;r<=6;r++){if(0<=(a=t+r)&&a<s)for(o=e-r;0<=o&&o<e+r;o++)if((i=this.getNode(o,a))&&!i.solid)return i;if(0<=(o=e+r)&&o<n)for(a=t-r;0<=a&&a<t+r;a++)if((i=this.getNode(o,a))&&!i.solid)return i;if(0<=(a=t-r)&&a<s)for(o=e-r;0<=o&&o<e+r;o++)if((i=this.getNode(o,a))&&!i.solid)return i;if(0<=(o=e-r)&&o<n)for(a=t-r;0<=a&&a<t+r;a++)if((i=this.getNode(o,a))&&!i.solid)return i}return null}return i},floyd:function(e,t){return this.removeNonInflectionNodes(e),this.connectNodes(e),t&&this.joinGrids(e),e},removeNonInflectionNodes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(t>=e.length-2)return e;var i=0;return this.isNodesInSameLine(e[t],e[t+1],e[t+2])?(e.splice(t+1,1),i=t):i=t+1,this.removeNonInflectionNodes(e,i)},isNodesInSameLine:function(e,t,i){return(e.y-t.y)*(e.x-i.x)==(e.y-i.y)*(e.x-t.x)},connectNodes:function(e){for(var t=0;t<e.length-2;t++)for(var i=e.length-1;t+1<i;i--)if(!this.hasAnyObstacleBetweenNodes(e[t],e[i])){var n=i-t-1;e.splice(t+1,n);break}return e},joinGrids:function(l){var e=l.slice(),c=null;e.forEach(function(e){if(c)for(var t=l.indexOf(e),i=b8e.MathUtil.getRadian(c.x,c.y,e.x,e.y),n=0,s=b8e.MathUtil.getDistance(c.x,c.y,e.x,e.y);-1<t&&n<s;){n+=1;var a=b8e.MathUtil.getDxByRadian(n,i),o=b8e.MathUtil.getDyByRadian(n,i),r=Math.round(c.x+a),h=Math.round(c.y+o),g=this._grids.getNode(r,h);g?(t++,l.splice(t,0,g)):b8e.error("中间的格子为空？")}c=e},this)},hasAnyObstacleBetweenNodes:function(e,t){var i=45,n=Math.abs(e.y-t.y)-Math.abs(e.x-t.x);0<n?i=46:n<0&&(i=44);var s={x:0,y:0},a=0,o=0;if(45<i){var r=e,h=t;for(e.y>t.y&&(r=t,h=e),s.y=r.y+1;s.y<=h.y;s.y++){a=(o=s.y-(r.y+.5))*(h.x-r.x)/(h.y-r.y),s.x=r.x+.5+a;var g=s.y,l=s.x>>0,c=g-1,u=l;if(this.isSolid(l,g)||this.isSolid(u,c))return!0}}else if(i<45){var m=e,_=t;for(e.x>t.x&&(m=t,_=e),s.x=m.x+1;s.x<=_.x;s.x++){o=(a=s.x-(m.x+.5))*(_.y-m.y)/(_.x-m.x),s.y=m.y+.5+o;var d=s.y>>0,f=s.x,p=d,S=f-1;if(this.isSolid(f,d)||this.isSolid(S,p))return!0}}else{var T=1;e.y>t.y&&(T=-1);var I=1;e.x>t.x&&(I=-1);for(var v=e.y+T,A=e.x+I;v!=t.y;){if(this.isSolid(A,v))return!0;v+=T,A+=I}}return!1},getNode:function(e,t){return this._grids.getNode(e,t)},setNodeIsSolid:function(e,t,i){var n=this.getNode(e,t);n&&(n.solid=i)},isSolid:function(e,t){var i=this.getNode(e,t);return!!i&&i.solid},setNodeWeight:function(e,t,i){i<0&&(i=0);var n=this.getNode(e,t);return n?(n.weight=i,n.weight):0},getNodeWeight:function(e,t){var i=this.getNode(e,t);return i?i.weight:0},clear:function(){this._grids.clear()}})},{}],4:[function(e,t,i){b8e.AstarGrids=b8e.Object.extends({ctor:function(){this._super(),this._resetGrids=b8e.HashMap.get()},setSquares:function(e,t){this.width=e,this.height=t,this._grids=new Array(this.width*this.height);for(var i=0;i<this.width;i++)for(var n=0;n<this.height;n++)this._grids[i+n*this.width]=b8e.AstarNode.get(i,n,0)},filter:function(e){return this._grids.filter(e)},getGrids:function(){return this._grids},getNode:function(e,t){return this._grids?this._grids[e+t*this.width]:null},neighbors:function(e,t){var i,n=[];return e.x+1<this.width&&((i=this._grids[e.x+1+e.y*this.width]).solid||i.isInOpenList||n.push(i)),e.y+1<this.height&&((i=this._grids[e.x+(e.y+1)*this.width]).solid||i.isInOpenList||n.push(i)),0<=e.y-1&&((i=this._grids[e.x+(e.y-1)*this.width]).solid||i.isInOpenList||n.push(i)),0<=e.x-1&&((i=this._grids[e.x-1+e.y*this.width]).solid||i.isInOpenList||n.push(i)),t&&(e.x+1<this.width&&e.y+1<this.height&&((i=this._grids[e.x+1+(e.y+1)*this.width]).solid||i.isInOpenList||n.push(i)),e.x+1<this.width&&0<=e.y-1&&((i=this._grids[e.x+1+(e.y-1)*this.width]).solid||i.isInOpenList||n.push(i)),0<=e.x-1&&e.y+1<this.height&&((i=this._grids[e.x-1+(e.y+1)*this.width]).solid||i.isInOpenList||n.push(i)),0<=e.x-1&&0<=e.y-1&&((i=this._grids[e.x-1+(e.y-1)*this.width]).solid||i.isInOpenList||n.push(i))),n},_euclideanHeuristic:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},_fewestTurn:function(e,t){var i=e.previousNode,n=0;if(i){var s=e.previousNode.previousNode;s&&(n=s.x==i.x&&s.y!=i.y&&i.y==e.y&&i.x!=e.x?10:s.x!=i.x&&s.y==i.y&&i.x==e.x&&i.y!=e.y?10:-0)}return 1.1*(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+n)},_manhattanHeuristic:function(e,t){return 1.5*(Math.abs(e.x-t.x)+Math.abs(e.y-t.y))},_buildPath:function(e){for(var t=[];null!==e.previousNode;)t.unshift(e),e=e.previousNode;return t.unshift(e),t},findPath:function(e,t,i,n,s,a,o){if(!this._grids)return b8e.error("未初始化数据不能查询路径！"),null;o=o||1,s=s||!0,this._resetGrids.forEach(function(e,t){t.reset()}),this._resetGrids.clear(),a=a||this._manhattanHeuristic;var r=this._grids[e+t*this.width],h=this._grids[i+n*this.width];if(!r)return b8e.error("没有找到开始节点",e,t,this.width,this.height),null;if(!h)return b8e.error("没有找到结束节点",i,n,this.width,this.height),null;if(r.solid)return null;if(h.solid)return null;this._resetGrids.set(r,r,this),this._resetGrids.set(h,h,this),r.gscore=0,r.hscore=r.gscore+a(r,h)*o;var g=[r];r.isInOpenList=!0;for(var l=2e3;0<g.length&&!(l--<1);){var c=g.sort(function(e,t){return e.hscore-t.hscore})[0];if(c==h)return this._buildPath(c);g.shift(),c.isInOpenList=!1,c.isInCloseList=!0,this._resetGrids.set(c,c,this),this.neighbors(c,s).forEach(function(e){var t=a(e,c)*o+e.weight+c.gscore;e.isInCloseList&&t>=e.gscore||(e.previousNode=c,e.gscore=t,e.hscore=e.gscore+a(e,h)*o,g.push(e),e.isInOpenList=!0,e.isInCloseList=!1,this._resetGrids.set(e,e,this))},this)}return[]},clear:function(){if(this.width=0,this.height=0,this._grids){for(var e=this._grids.length,t=0;t<e;t++)b8e.AstarNode.put(this._grids[t]);this._grids.length=0,this._grids=null}}})},{}],5:[function(e,t,i){var s=b8e.AstarNode=b8e.Object.extends({ctor:function(){this._super()},setParams:function(e,t,i){this.x=e,this.y=t,this.weight=i,this.hscore=0,this.gscore=0,this.solid=!1,this.previousNode=null,this.isInOpenList=!1,this.isInCloseList=!1},reset:function(){this.hscore=0,this.gscore=0,this.previousNode=null,this.isInOpenList=!1,this.isInCloseList=!1},clear:function(){this.x=0,this.y=0,this.weight=0,this.hscore=0,this.gscore=0,this.solid=!1,this.previousNode=null,this.isInOpenList=!1,this.isInCloseList=!1},distance:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2))}});s.pool=[],s.get=function(e,t,i){var n=0<s.pool.length?s.pool.pop():new b8e.AstarNode;return n.setParams(e,t,i),n},s.put=function(e){return e=s.pool.push(e)}},{}],6:[function(e,t,i){var n=b8e.AnimationClip=b8e.Object.extends({_isRecycled:!1,_isDisposed:!1,ctor:function(){this.constructor===n&&(n.poolCall||b8e.warn("强烈建议用engine.AnimationClip.get代替new操作！")),this._super(),this._isRecycled=!1,this._isDisposed=!1},loadClip:function(e,t,i,n){if(this._clipUrl!=e){if(this.unload(),this._clipUrl=e,this._onLoadComplete=t?{onComplete:t,thisArg:i}:null,this._useManifest=!1,this._dataType=0,this._highDefinition=!1,this._recycleDelay=0,this._priority=0,this._sequence=null,this._sequenceScale=1,this._clipData=null,n&&(void 0!==n.useManifest&&(this._useManifest=n.useManifest),void 0!==n.recycleDelay&&(this._recycleDelay=n.recycleDelay),void 0!==n.priority&&(this._priority=n.priority),void 0!==n.highDefinition&&(this._highDefinition=n.highDefinition),void 0!==n.clipName&&(this._clipName=n.clipName),void 0!==n.clipData&&(this._clipData=n.clipData)),this._clipData){var s=this._clipData;this._sequence=s.sequence;var a=s.sequenceScale;a=0<(a=isNaN(a)?0:a)?a:1,this._sequenceScale=a,this._sample=s.sample,this._speed=s.speed,this._wrapMode=s.wrapMode,this._dataType=s.dataType}this._useManifest&&b8e.macro.IS_COCOS_CREATOR?b8e.res.loadRes(this._clipUrl,cc.AnimationClip,this.onAnimComplete,this,null,{recycleDelay:this._recycleDelay,priority:this._priority}):1==this._dataType?b8e.res.loadRes(this._clipUrl,null,this.onAnimConfigComplete,this,null,{useManifest:!1,recycleDelay:this._recycleDelay,priority:this._priority}):2==this._dataType?this.loadAtlas():this.loadFrameAtlas()}},loadFrameAtlas:function(){if(this._clipData)if(0<this._clipData.frames.length)this.loadAtlas();else{var e=this.addClipWithFrames([],this._clipData);this.onAnimComplete(null,e)}},onAnimComplete:function(e,t){var i=this._onLoadComplete;this._onLoadComplete=null,e?(this._clip=null,i&&i.onComplete.call(i.thisArg,e,null)):(this._clip=t,i&&i.onComplete.call(i.thisArg,null,this))},onAnimConfigComplete:function(e,t){if(e)b8e.error("动画配置加载错误！"+e.url),this.onAnimComplete(e,null);else{var i=b8e.JsUtil.jsonParse(t),n=this._clipData;if(n.sample=i.sample,n.speed=i.speed,n.wrapMode=i.wrapMode,n.duration=1e3*i.duration,n.frames=[],this._clipData)if(this._sample=this._clipData.sample,this._speed=this._clipData.speed,this._wrapMode=this._clipData.wrapMode,this.getFrameInfos(i))this.loadAtlas(i);else{var s=this.addClipWithFrames([],this._clipData);this.onAnimComplete(null,s)}else b8e.error("动画配置数据错误！"+this._clipUrl),this.onAnimComplete(new Error("动画配置数据错误！"+this._clipUrl),null)}},getClipData:function(){return this._clipData},getClipName:function(){return this._clipName},getClip:function(){return this._clip},loadAtlas:function(e){var t=this._clipUrl?this._clipUrl.substring(0,this._clipUrl.lastIndexOf("/")):null;this._atlasUrl=t+"/"+(this._sequence?this._sequence:"sequence.plist");var i=this.getAtlasResOptions();if(i){var n=i.url,s=i.type;b8e.res.loadRes(n,s,this.onAtlasComplete,this,[e],i)}},getAtlasResOptions:function(){if(!this._atlasUrl)return null;var e={};return e.url=this._atlasUrl,e.type=b8e.FrameAtlas,e.useManifest=!1,e.recycleDelay=this._recycleDelay,e.priority=this._priority,e.dataType=this._dataType,e.highDefinition=this._highDefinition,e.textureScale=this._sequenceScale,e.loadMeta=1==this._dataType,e},onAtlasComplete:function(e,t,i){if(e)b8e.error(this._atlasUrl+"图集加载错误！"),this.onAnimComplete(e,null);else if(1==this._dataType)this.createClipWithMeta(t,i);else if(2==this._dataType){var n=engine.proto.animate.AnimateFrame,s=this._clipData;this._sample=s.sample,this._speed=s.speed,this._wrapMode=s.wrapMode;var a=[],o=t._plist.frames;for(var r in o){var h=engine.ProtobufUtil.createMessage(n);h.name=r,a.push(h)}a&&0<a.length&&(s.frames=a),this.createClipWithFrames(t)}else this.createClipWithFrames(t)},setWrapMode:function(e){this._wrapMode=e,this._clipData&&(this._clipData.wrapMode=e),this._clip&&(this._clip.wrapMode=e)},getWrapMode:function(){return this._wrapMode},setSample:function(e){if(this._sample=e,this._clipData&&(this._clipData.sample=e),this._frames){var t=this.addClipWithFrames(this._frames,this._clipData);this._clip=t}},getSample:function(){return this._sample},setSpeed:function(e){this._speed=e,this._clipData&&(this._clipData.speed=e),this._clip&&(this._clip.speed=e)},getSpeed:function(){return this._speed},createClipWithMeta:function(e,t){if(this._clipData&&(g=this.getFrameInfos(t))){var i,n=[],s=g.length;for(i=0;i<s;i++){var a=g[i];if(a.value){var o=a.value.__uuid__;n.push(o)}}var r=e.getFrameNamesByUuid(n),h=engine.proto.animate.AnimateFrame,g=[];for(s=r.length,i=0;i<s;i++){var l=r[i],c=engine.ProtobufUtil.createMessage(h);c.name=l,g.push(c)}g&&0<g.length&&(this._clipData.frames=g);var u=e.getSpriteFrames(r),m=this.addClipWithFrames(u,this._clipData);this.onAnimComplete(null,m)}},createClipWithFrames:function(e){if(this._clipData){var t=this._clipData.frames;if(t&&0<t.length){for(var i=[],n=t.length,s=0;s<n;s++){var a=t[s];i.push(a.name)}var o=e.getSpriteFrames(i),r=this.addClipWithFrames(o,this._clipData);this.onAnimComplete(null,r)}}},getFrameInfos:function(e){if(!e)return null;var t=e.curveData;if(!t)return null;var i=t.comps,n=i?i["cc.Sprite"]:null;return n?n.spriteFrame:null},addClipWithFrames:function(e,t){this._frames=e;var i=t.sample,n=t.speed,s=t.wrapMode,a=cc.AnimationClip.createWithSpriteFrames(e,i);return a.name=this._clipName,a.speed=n,a.wrapMode=s,a},getDuration:function(){return this._clipData?this._clipData.duration:0},getFrameInfoByTime:function(e){var t=this._clipData;if(t){var i=t.duration,n=0;t.wrapMode==cc.WrapMode.Normal?i<(n=e)&&(n=i):n=e%i;for(var s=1e3/t.sample,a=t.frames,o=a.length,r=null,h=0;h<o&&(r=a[h],!((n-=h*s)<0));h++);return r}return null},unload:function(){this._clipUrl&&(this._useManifest&&b8e.macro.IS_COCOS_CREATOR?b8e.res.unloadRes(this._clipUrl,this.onAnimComplete,this):1==this._dataType&&b8e.res.unloadRes(this._clipUrl,this.onAnimConfigComplete,this),this._clipUrl=null),this._atlasUrl&&(b8e.res.unloadRes(this._atlasUrl,this.onAtlasComplete,this),this._atlasUrl=null),this._useManifest=!1,this._clip=null,this._frames=null,this._onLoadComplete=null,this._dataType=0,this._recycleDelay=0,this._priority=0,this._highDefinition=!1,this._sequence=null,this._sequenceScale=0,this._clipName=null,this._clipData=null,this._sample=0,this._speed=0,this._wrapMode=0},restore:function(){this._isRecycled=!1},recycle:function(){this.unload(),this._isRecycled=!0},release:function(){this.constructor===n?n.put(this):this.destroy()},dispose:function(){this._isRecycled=!1,this._isDisposed=!0},destroy:function(){this.constructor===n&&(n.poolCall||b8e.warn("强烈建议用engine.AnimationClip.put或release代替destroy操作！")),this.recycle(),this.dispose()}});n.pool=new b8e.Pool(n,1024),n.get=function(){return n.pool.get()},n.put=function(e){return e=n.pool.put(e)}},{}],7:[function(e,t,i){b8e.AnimationActionDirection={_right:{x:1,y:0},_upRight:{x:1,y:1},_downRight:{x:1,y:-1},_up:{x:0,y:1},_down:{x:0,y:-1}},b8e.AnimatorResource=b8e.Asset.extends({ctor:function(){this._super(),this._referencesByName=b8e.HashMap.get(),this._clipByName=b8e.HashMap.get(),this._clipDataByName=b8e.HashMap.get(),this._bindNodeDatas=b8e.HashMap.get(),this._completeClipNames=b8e.HashMap.get()},setConfig:function(e,t,i){if(this._url!=e){this.unload(),this._url=e,this._dirUrl=e?e.substring(0,e.lastIndexOf("/")):null,this._useManifest=!1,this._recycleDelay=0,this._priority=0,this._highDefinition=b8e.ResMgr.HIGH_DEFINITION_ENABLED,i&&(void 0!==i.useManifest&&(this._useManifest=i.useManifest),void 0!==i.recycleDelay&&(this._recycleDelay=i.recycleDelay),void 0!==i.priority&&(this._priority=i.priority),void 0!==i.highDefinition&&(this._highDefinition=i.highDefinition));var n=b8e.proto.animate.AnimateConfigMessage,s=b8e.ProtobufUtil.decodeMessage(this._url,t,n);this.setProtoConfig(s)}},load:function(e,t,i){if(this._url!=e){this.unload(),this._onLoadComplete=t?{onComplete:t,thisArg:i}:null,this._url=e,this._cfgUrl=e,this._dirUrl=e?e.substring(0,e.lastIndexOf("/")):null;var n=b8e.proto.animate.AnimateConfigMessage;b8e.res.loadRes(this._cfgUrl,b8e.ProtobufConfig,this.onConfigComplete,this,null,{useManifest:!1,proto:n,recycleDelay:-1})}},onConfigComplete:function(e,t){var i=this._onLoadComplete;this._onLoadComplete=null,e?(b8e.error("动画配置加载错误！"+this._cfgUrl),i&&i.onComplete.call(i.thisArg,e,null)):(this.setProtoConfig(t.getProtoData()),i&&i.onComplete.call(i.thisArg,null,this))},setProtoConfig:function(e){this._isLoaded=!0;var t=this._config=e,i=t.clips,n=t.bindNodes,s=Number(t.leftBorder);s=isNaN(s)?0:s,this.left=s;var a=Number(t.rightBorder);a=isNaN(a)?0:a,this.right=a;var o=Number(t.topBorder);o=isNaN(o)?0:o,this.top=o;var r=Number(t.bottomBorder);r=isNaN(r)?0:r,this.bottom=r;var h=Number(t.anchorX);h=isNaN(h)?.5:h,this.anchorX=h;var g=Number(t.anchorY);g=isNaN(g)?.5:g,this.anchorY=g;var l=Number(t.orderX);l=isNaN(l)?0:l,this.orderX=l;var c=Number(t.orderY);c=isNaN(c)?0:c,this.orderY=c;var u=Number(t.scale);u=isNaN(u)?0:u,this.scale=u,b8e.ResMgr.HIGH_DEFINITION_ENABLED&&t.highDefinition?this._highDefinition=!0:this._highDefinition=!1;var m=this._clipDataByName;i.forEach(function(e){m.get(e.name)||m.set(e.name,e)},this),n.forEach(function(e){this.addBindNodeData(e.name,e.x,e.y)},this)},addBindNodeData:function(e,t,i){e&&(this._bindNodeDatas.get(e)?b8e.error("重复添加绑点："+e):this._bindNodeDatas.set(e,{x:t,y:i}))},removeBindNodeData:function(e){this._bindNodeDatas.del(e)},adaptAction:function(e,t){if(!this._isLoaded)return null;var i=this.adjustDirection(e,t),n=e+"/"+this.getActionDirectionName(i);return this.getClipDataByName(n)||(e="stand"),e},adjustDirection:function(e,t){if(!this._isLoaded)return null;var i=b8e.DirectionType,n=this.getActionDirectionName(t);3==b8e.macro.DIRECTION_COUNT&&(n!=i.nUpRight&&n!=i.nDownRight||(n=i.nRight));var s=e+"/"+n,a=this.getClipDataByName(s);return a||(n==i.nUpRight?n=i.nRight:n==i.nDownRight?n=i.nRight:n==i.nRight?n=i.nDownRight:n==i.nUp?n=i.nUpRight:n==i.nDown&&(n=i.nDownRight),s=e+"/"+n,(a=this.getClipDataByName(s))||(n=i.nDown)),t=this.getActionDirection(n)},getActionDirectionName:function(e){var t=b8e.DirectionType;if(!e)return t.nDown;var i=e.x,n=e.y;return-1==i&&0==n?t.nRight:-1==i&&-1==n?t.nDownRight:0==i&&-1==n?t.nDown:1==i&&-1==n?t.nDownRight:1==i&&0==n?t.nRight:1==i&&1==n?t.nUpRight:0==i&&1==n?t.nUp:-1==i&&1==n?t.nUpRight:t.nNone},getActionDirection:function(e){var t=b8e.DirectionType;return e==t.nRight?b8e.AnimationActionDirection._right:e==t.nUpRight?b8e.AnimationActionDirection._upRight:e==t.nDownRight?b8e.AnimationActionDirection._downRight:e==t.nUp?b8e.AnimationActionDirection._up:e==t.nDown?b8e.AnimationActionDirection._down:null},addClipData:function(e){e=e.replace(/\\/g,"/");var t,i,n,s=b8e.proto.animate.AnimateClip,a=b8e.ProtobufUtil.createMessage(s),o=0;if(-1<e.lastIndexOf(".anim"))i=(n=(n=e).substring(0,n.lastIndexOf("."))).substring(n.lastIndexOf("/")+1),t=(n=n.substring(0,n.lastIndexOf("/"))).substring(n.lastIndexOf("/")+1),o=1;else if(-1<e.lastIndexOf(".plist")){var r=(n=(n=e).substring(0,n.lastIndexOf("."))).substring(n.lastIndexOf("/")+1);t=(n=n.substring(0,n.lastIndexOf("/"))).substring(n.lastIndexOf("/")+1),i=r.split("_")[1],o=2}var h="sequence_"+i+".plist",g=t+"/"+i;a.name=g,a.sequence=h,a.sample=12,a.speed=1,a.wrapMode=cc.WrapMode.Normal,a.dataType=o,this._clipDataByName.set(g,a);for(var l=this._config.clips,c=l.length,u=0;u<c;u++)if(l[u].name==g){l.splice(u,1);break}l.push(a)},removeClipData:function(e){if(e){this._clipDataByName.del(e);var t=this._clipByName.get(e);t&&(t.release(),this._clipByName.del(e))}},addReference:function(e,t){if(t){var i=this._referencesByName,n=i.get(t);n||(n=b8e.HashMap.get(),i.set(t,n)),n.set(e,e,this)}},setSpeed:function(e,t){if(t){var i=this._clipByName.get(t);i&&i.setSpeed(e)}},getSpeed:function(e){if(!e)return 0;var t=this._clipByName.get(e);return t?t.getSpeed():0},setSample:function(e,t){if(t){var i=this._clipByName.get(t);i&&i.setSample(e)}},getSample:function(e){if(!e)return 0;var t=this._clipByName.get(e);return t?t.getSample():0},setWrapMode:function(e,t){if(t){var i=this._clipByName.get(t);i&&i.setWrapMode(e)}},getWrapMode:function(e){if(!e)return 0;var t=this._clipByName.get(e);return t?t.getWrapMode():0},loadAnim:function(e,t){this.addReference(e,t),this._loadAnimConfig(t)},unloadAnim:function(e,t){if(!t)return!1;var i=this._referencesByName,n=i.get(t);if(!n)return b8e.warn("注意：试图删除不存在的动画剪辑引用！"+this._url),!1;if(!n.get(e,this))return b8e.warn("注意：试图删除不存在的动画剪辑引用！"+this._url),!1;if(n.del(e,this),n.count()<1){n.release(),i.del(t);var s=this._clipByName;if(s){var a=s.get(t);a&&(a.release(),s.del(t))}}return!0},_loadAnimConfig:function(e){this._loadAnimByName(e)},_loadAnimByName:function(e){if(e){var t=this._clipDataByName.get(e);if(t){var i=this._clipByName,n=i.get(e);if(!n){n=b8e.AnimationClip.get(),i.set(e,n);var s=this.getAnimUrl(t);n.loadClip(s,this.onAnimClipComplete,this,{useManifest:this._useManifest,recycleDelay:this._recycleDelay,priority:this._priority,highDefinition:this._highDefinition,clipName:e,clipData:t})}}}},getClipData:function(e){if(!e)return null;var t=null,i=this._clipByName.get(e);return i&&(t=i.getClipData()),t},onAnimClipComplete:function(e,t){if(e)b8e.error("动画加载错误！"+e.url);else{var i=t.getClipName();if(!i)return void b8e.error("添加的剪辑名称为空！");if(!t.getClip())return void b8e.error("添加的剪辑为空！"+i);this._clipDataByName.set(i,t.getClipData()),this._completeClipNames.set(i,i),this._referencesByName.get(i)&&this.onClipComplete(i,t),this.isAllClipLoaded()&&this.onAllAnimComplete()}},onClipComplete:function(e,t){var i=this._clipCompleteVec;i&&0<i.count()&&b8e.CallBackUtil.exceteCallBackData(this,i,[e,t])},loadSubRes:function(e,t){if(this._onAllAnimComplete=e,this._onAllAnimThis=t,this.isAllClipLoaded())this.onAllAnimComplete();else{var n=b8e.DirectionType;this._clipDataByName.forEach(function(e,t){if(3==b8e.macro.DIRECTION_COUNT){var i=e.split("/")[1];if(i==n.nUpRight||i==n.nDownRight)return}this._loadAnimConfig(e)},this)}},onAllAnimComplete:function(){var e=this._onAllAnimComplete,t=this._onAllAnimThis;this._onAllAnimComplete=null,this._onAllAnimThis=null,e&&e.call(t,this)},isAllClipLoaded:function(){if(!this._isLoaded)return!1;var n=!0,s=b8e.DirectionType;return this._clipDataByName.every(function(e,t){if(3==b8e.macro.DIRECTION_COUNT){var i=e.split("/")[1];if(i==s.nUpRight||i==s.nDownRight)return!0}return!!this._completeClipNames.get(e)||(n=!1)},this),n},isLoaded:function(){return this._isLoaded},getConfig:function(){return this._config},getUrl:function(){return this._url},getAnimUrl:function(e){var t,i=e.name;if(1==e.dataType)t=this._dirUrl+"/"+i+".anim";else{var n=i.split("/");t=this._dirUrl+"/"+n[0]+"/sequence_"+n[1]+".plist"}return t},getClipByName:function(e){return e?this._clipByName.get(e):null},getClipMap:function(){return this._clipByName},getClipDataByName:function(e){return e?this._clipDataByName.get(e):null},getTextureScaleByName:function(e){if(!e)return 0;var t=this._clipDataByName.get(e);if(t){var i=1;return this._highDefinition||(i=t.sequenceScale,i=0<(i=isNaN(i)?0:i)?i:1),i}return 0},getClipDatas:function(){return this._clipDataByName},getBindNodeDataByName:function(e){return e?this._bindNodeDatas.get(e):null},getBindNodeDatas:function(){return this._bindNodeDatas},addClipComplete:function(e,t,i){this._clipCompleteVec||(this._clipCompleteVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._clipCompleteVec,e,t,i)},removeClipComplete:function(e,t){var i=this._clipCompleteVec;i&&0<i.count()&&b8e.CallBackUtil.removeCallBackData(i,e,t)},removeAllClips:function(){var e=this._clipByName;e&&(e.forEach(function(e,t){t.release()},this),e.clear())},unload:function(){this._cfgUrl&&(b8e.res.unloadRes(this._cfgUrl,this.onConfigComplete,this),this._cfgUrl=null),this._url=null,this._dirUrl=null,this._useManifest=!1,this._recycleDelay=0,this._priority=0,this._highDefinition=!1,this._isLoaded=!1,this._config=null,this._onLoadComplete=null,this.left=0,this.right=0,this.top=0,this.bottom=0,this.anchorX=0,this.anchorY=0,this.orderX=0,this.orderY=0,this.scale=0,this.removeAllClips(),this._referencesByName.forEach(function(e,t){t.release()},this),this._referencesByName.clear(),this._clipDataByName.clear(),this._bindNodeDatas.clear(),this._completeClipNames.clear(),this._clipCompleteVec&&b8e.CallBackUtil.removeAllCallBackData(this._clipCompleteVec),this._onAllAnimComplete=null,this._onAllAnimThis=null},destroy:function(){this.unload(),this._clipCompleteVec&&(this._clipCompleteVec.release(),this._clipCompleteVec=null),this._referencesByName&&(this._referencesByName.release(),this._referencesByName=null),this._clipByName&&(this._clipByName.release(),this._clipByName=null),this._clipDataByName&&(this._clipDataByName.release(),this._clipDataByName=null),this._bindNodeDatas&&(this._bindNodeDatas.release(),this._bindNodeDatas=null),this._completeClipNames&&(this._completeClipNames.release(),this._completeClipNames=null),this._super()}})},{}],8:[function(e,t,i){b8e.BitmapData=b8e.Asset.extends({ctor:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this._super(),this._rawData=e,this._width=t,this._height=i,this._alphaRawData=n},getPixelsData:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"argb",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"argb",n=null,s=this._width*this._height;if("argb"==t)if(this._alphaRawData)for(n=new Uint8Array(this._width*this._height*4),e=0;e<s;++e)this._rawData[e],n[4*e]=this._rawData[4*e],n[4*e+1]=this._rawData[4*e+1],n[4*e+2]=this._rawData[4*e+2],n[4*e+3]=this._alphaRawData[4*e+2];else n=this._rawData;else if("rgb"==t){if("argb"==i)for(n=new Uint8Array(this._width*this._height*4),e=0;e<s;++e)this._rawData[e],n[4*e]=this._rawData[4*e],n[4*e+1]=this._rawData[4*e+1],n[4*e+2]=this._rawData[4*e+2],this._alphaRawData?n[4*e+3]=this._alphaRawData[4*e+2]:n[4*e+3]=255;else if("rgb"==i)for(n=new Uint8Array(this._width*this._height*3),e=0;e<s;++e)this._rawData[e],n[3*e]=this._rawData[3*e+e],n[3*e+1]=this._rawData[3*e+1+e],n[3*e+2]=this._rawData[3*e+2+e]}else if("a"==t)if("argb"==i)for(n=new Uint8Array(this._width*this._height*4),e=0;e<s;++e)this._rawData[e],n[4*e]=0,n[4*e+1]=0,n[4*e+2]=this._rawData[4*e+3],n[4*e+3]=255;else if("rgb"==i)for(n=new Uint8Array(this._width*this._height*3),e=0;e<s;++e)this._rawData[e],n[3*e]=0,n[3*e+1]=0,n[3*e+2]=this._rawData[3*e+3+e];return{data:n,width:this._width,height:this._height}},destroy:function(){this._rawData=null,this._width=0,this._height=0,this._alphaRawData=null,this._super()}})},{}],9:[function(e,t,i){b8e.FrameAtlas=b8e.Asset.extends({ctor:function(){this._super()},parseWithAtlas:function(e,t,i,n,s){this._atlas=e,this._spriteFrames=this._atlas._spriteFrames,this._onCompleteCb={func:t,thisArg:i,args:n},this._atlasComplete()},parse:function(e,t,i,n,s,a){this._spriteFrames={},this._plistUrl=e?e.replace(/\\/g,"/"):null,this._dirUrl=this._plistUrl?this._plistUrl.substring(0,this._plistUrl.lastIndexOf("/")):null,this._onCompleteCb={func:i,thisArg:n,args:s},this._plist=t;var o=this._plist.metadata.textureFileName;this._useManifest=!1,this._loadMeta=!1,this._textureScale=1,this._highDefinition=b8e.ResMgr.HIGH_DEFINITION_ENABLED,(this._options=a)&&(void 0!==a.useManifest&&(this._useManifest=a.useManifest),void 0!==a.loadMeta&&(this._loadMeta=a.loadMeta),void 0!==a.highDefinition&&(this._highDefinition=a.highDefinition),this._highDefinition||void 0!==a.textureScale&&(this._textureScale=a.textureScale,this._textureScale=0<this._textureScale?this._textureScale:1));var r=o.lastIndexOf(".");if(o=(o=o.substring(0,r))+"."+b8e.ResMgr.DEFAULT_FORMAT,this._textureScale<1){var h=o.indexOf(".");o=o.substring(0,h)+"_min"+o.substr(h)}this._imgUrl=this._dirUrl+"/"+o,b8e.res.loadRes(this._imgUrl,b8e.Texture2D,this.onTextureComplete,this,null,{useManifest:this._useManifest})},onTextureComplete:function(e,t){e?b8e.error(e):(this.textureParser(t.getTexture()),this._loadMeta?this.loadMeta():this._atlasComplete())},_atlasComplete:function(){if(this._onCompleteCb&&this._onCompleteCb.func){var e=this._onCompleteCb.args?[this].concat(this._onCompleteCb.args):[this];this._onCompleteCb.func.apply(this._onCompleteCb.thisArg,e)}},textureParser:function(e){if(this._spriteFrames){this._texture=e;var t=this._plist.frames;for(var i in t){var n=t[i],s=this.getDataArr(n.frame),a=new cc.Rect(Number(s[0])*this._textureScale,Number(s[1])*this._textureScale,Number(s[2])*this._textureScale,Number(s[3])*this._textureScale),o=this.getDataArr(n.offset),r=new cc.Vec2(Number(o[0])*this._textureScale,Number(o[1])*this._textureScale),h=!!n.rotated,g=a.size,l=new cc.SpriteFrame;l.setTexture(this._texture,a,h,r,g),this._spriteFrames[i]=l}}},getDataArr:function(e){return(e=(e=e.replace(/\{/g,"")).replace(/\}/g,"")).split(",")},getTexture:function(){if(!this._spriteFrames)return null;var e=Object.keys(this._spriteFrames);if(0<e.length){var t=this._spriteFrames[e[0]];return t?t.getTexture():null}return null},getSpriteFrame:function(e){return this._spriteFrames?this._spriteFrames[e]:null},getSpriteFrames:function(e){if(!this._spriteFrames)return null;for(var t=[],i=e.length,n=0;n<i;n++){var s=e[n];if(s){var a=this._spriteFrames[s];a?t.push(a):(b8e.warn("注意：没有找到"+s+"对应的帧！"+this._plistUrl),t.push(null))}else t.push(null)}return 0==t.length&&b8e.warn("注意：没有可使用的帧！"),t},getAtlas:function(){return this._spriteFrames?(this._atlas||(this._atlas=new cc.SpriteAtlas,this._atlas._spriteFrames=this._spriteFrames),this._atlas):null},getDirUrl:function(){return this._dirUrl},loadMeta:function(){if(this._plistUrl){var e=this._plistUrl+".meta";this._metaUrl!=e&&(this._metaUrl&&(b8e.res.unloadRes(this._metaUrl,this.onMetaComplete,this),this._metaUrl=null),this._metaData=null,this._metaUrl=e,b8e.res.loadRes(this._metaUrl,b8e.MetaConfig,this.onMetaComplete,this,null,{useManifest:!1}))}},onMetaComplete:function(e,t){e?b8e.error("Meta加载错误！"+this._metaUrl):(this._metaData=t,this._atlasComplete())},getMetaData:function(){return this._metaData},getFrameNamesByUuid:function(e){if(!this._metaData)return null;for(var t=[],i=e.length,n=0;n<i;n++){var s=e[n],a=this._metaData.getFileNameByUuid(s,this._dirUrl);a?t.push(a):(b8e.warn(this._metaUrl+"中uuid:"+s+"对应的文件不存在！"),t.push(""))}return t},destroy:function(){this._imgUrl&&(b8e.res.unloadRes(this._imgUrl,this.onTextureComplete,this),this._imgUrl=null),this._metaUrl&&(b8e.res.unloadRes(this._metaUrl,this.onMetaComplete,this),this._metaUrl=null),this._options=null,this._loadMeta=!1,this._highDefinition=!1,this._textureScale=0,this._metaData=null,this._useManifest=!1,this._plistUrl=null,this._dirUrl=null,this._plist=null,this._texture=null,this._atlas=null,this._spriteFrames=null,this._onCompleteCb=null,this._super()}})},{}],10:[function(e,t,i){b8e.MetaConfig=b8e.Asset.extends({ctor:function(){this._super(),this._metaUrlByUuid=b8e.HashMap.get()},parseMeta:function(e,t){this._url=e;var i=b8e.JsUtil.jsonParse(t);if(!i)return null;var n=e?e.substring(0,e.lastIndexOf("/")):null,s=i.subMetas;for(var a in s){var o=s[a],r=n+"/"+a;this._metaUrlByUuid.set(o.uuid,r)}return i},getUrlByUuid:function(e){var t=this._metaUrlByUuid.get(e);return t||b8e.warn("注意："+this._url+"中没有找到"+e+"对应的url！"),t},getFileNameByUuid:function(e,t){var i=this.getUrlByUuid(e);return i&&t&&(i=i.replace(t+"/","")),i},destroy:function(){this._url=null,this._metaUrlByUuid&&(this._metaUrlByUuid.release(),this._metaUrlByUuid=null),this._super()}})},{}],11:[function(e,t,i){b8e.Worker=function(){},b8e.Worker.create=function(e,t,i){var n=function(e,t,i){t=t||[];var n=['"use strict";'];for(var s in t){var a=t[s];n.push("self."+s+"="+a.toString()+";")}i&&n.push(i.toString());n=n.concat(["self.onmessage=",e.toString(),";"]);var o=new Blob(n,{type:"text/javascript"}),r=URL.createObjectURL(o);return{_shell:(h=new Worker(r),URL.revokeObjectURL(r),h),run:function(e){return i=this._shell,t=(t=e)||{},i.postMessage(t),new Promise(function(e,t){i.onmessage=e,i.onerror=t});var i,t},terminate:function(){return e=this,g.splice(g.indexOf(e),1),e._shell.terminate();var e},subscribe:function(e){this._shell.addEventListener("message",e)},unsubscribe:function(e){this._shell.removeEventListener("message",e)}};var h}.apply(null,arguments);return g.push(n),n},b8e.Worker.runAll=function(t){var e=g.map(function(e){return e.run(t)});return Promise.all(e)},b8e.Worker.terminateAll=function(){g.forEach(function(e){e._shell.terminate()}),g.length=0},b8e.Worker.list=function(){return g};var g=[]},{}],12:[function(e,t,i){var n,s;n=JSON.parse('{"package":"animate_config","messages":[{"name":"AnimateConfigMessage","fields":[{"rule":"required","type":"int32","name":"left_border","options":{},"id":1},{"rule":"required","type":"int32","name":"right_border","options":{},"id":2},{"rule":"required","type":"int32","name":"top_border","options":{},"id":3},{"rule":"required","type":"int32","name":"bottom_border","options":{},"id":4},{"rule":"required","type":"float","name":"anchorX","options":{},"id":5},{"rule":"required","type":"float","name":"anchorY","options":{},"id":6},{"rule":"repeated","type":"AnimateClip","name":"clips","options":{},"id":7},{"rule":"repeated","type":"AnimateBindNode","name":"bind_nodes","options":{},"id":8},{"rule":"optional","type":"int32","name":"orderX","options":{},"id":9},{"rule":"optional","type":"int32","name":"orderY","options":{},"id":10},{"rule":"optional","type":"bool","name":"is_meta_data","options":{},"id":11},{"rule":"optional","type":"float","name":"scale","options":{},"id":12},{"rule":"optional","type":"bool","name":"highDefinition","options":{},"id":13}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}},{"name":"AnimateClip","fields":[{"rule":"required","type":"string","name":"name","options":{},"id":1},{"rule":"repeated","type":"AnimateBindNode","name":"bind_nodes","options":{},"id":2},{"rule":"repeated","type":"AnimateFrame","name":"frames","options":{},"id":3},{"rule":"optional","type":"int32","name":"sample","options":{},"id":4},{"rule":"optional","type":"float","name":"speed","options":{},"id":5},{"rule":"optional","type":"int32","name":"wrap_mode","options":{},"id":6},{"rule":"optional","type":"int32","name":"duration","options":{},"id":7},{"rule":"optional","type":"string","name":"sequence","options":{},"id":8},{"rule":"optional","type":"string","name":"sound","options":{},"id":9},{"rule":"optional","type":"float","name":"sequence_scale","options":{},"id":10},{"rule":"optional","type":"int32","name":"data_type","options":{},"id":11}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}},{"name":"AnimateBindNode","fields":[{"rule":"required","type":"string","name":"name","options":{},"id":1},{"rule":"optional","type":"int32","name":"x","options":{},"id":2},{"rule":"optional","type":"int32","name":"y","options":{},"id":3}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}},{"name":"AnimateFrame","fields":[{"rule":"required","type":"string","name":"name","options":{},"id":1}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}}],"enums":[],"imports":[],"options":{},"services":[],"syntax":"proto3"}'),s=b8e.ProtobufUtil.buildMessage("animate_config",n),b8e.proto.animate={},b8e.proto.animate.AnimateConfigMessage=b8e.ProtobufUtil.instantiateMessage(s.animate_config.AnimateConfigMessage),b8e.proto.animate.AnimateClip=b8e.ProtobufUtil.instantiateMessage(s.animate_config.AnimateClip),b8e.proto.animate.AnimateBindNode=b8e.ProtobufUtil.instantiateMessage(s.animate_config.AnimateBindNode),b8e.proto.animate.AnimateFrame=b8e.ProtobufUtil.instantiateMessage(s.animate_config.AnimateFrame)},{}],13:[function(e,t,i){var n,s;n=JSON.parse('{"package":"map_config","messages":[{"name":"MapConfigMessage","fields":[{"rule":"required","type":"int32","name":"map_width","options":{},"id":1},{"rule":"required","type":"int32","name":"map_height","options":{},"id":2},{"rule":"required","type":"int32","name":"tile_width","options":{},"id":3},{"rule":"required","type":"int32","name":"tile_height","options":{},"id":4},{"rule":"required","type":"int32","name":"grid_width","options":{},"id":5},{"rule":"required","type":"int32","name":"grid_height","options":{},"id":6},{"rule":"optional","type":"int32","name":"thumb_ratio","options":{},"id":7},{"rule":"repeated","type":"MapGridDataMessage","name":"grid_datas","options":{},"id":8},{"rule":"optional","type":"int32","name":"camera_distance","options":{},"id":9},{"rule":"optional","type":"int32","name":"navigate_ratio","options":{},"id":10},{"rule":"optional","type":"int32","name":"panorama_ratio","options":{},"id":11},{"rule":"optional","type":"string","name":"background_music","options":{},"id":12},{"rule":"optional","type":"string","name":"environment_audio","options":{},"id":13}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}},{"name":"MapGridDataMessage","fields":[{"rule":"optional","type":"int32","name":"x","options":{},"id":1},{"rule":"optional","type":"int32","name":"y","options":{},"id":2},{"rule":"required","type":"int32","name":"type","options":{},"id":3},{"rule":"optional","type":"int32","name":"weight","options":{},"id":4},{"rule":"optional","type":"int32","name":"event_type","options":{},"id":5}],"enums":[],"messages":[],"options":{},"services":[],"oneofs":{}}],"enums":[],"imports":[],"options":{},"services":[],"syntax":"proto3"}'),s=b8e.ProtobufUtil.buildMessage("map_config",n),b8e.proto.map={},b8e.proto.map.MapConfigMessage=b8e.ProtobufUtil.instantiateMessage(s.map_config.MapConfigMessage),b8e.proto.map.MapGridDataMessage=b8e.ProtobufUtil.instantiateMessage(s.map_config.MapGridDataMessage)},{}],14:[function(e,t,i){b8e.DisplaySyncInfo=b8e.Object.extends({ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._super(),this._obj=e,this._syncRotation=t,this._syncVisible=i,this._offsetX=0,this._offsetY=0,this._offsetZ=0},getSyncRotation:function(){return this._syncRotation},getSyncVisible:function(){return this._syncVisible},getObj:function(){return this._obj},setOffset:function(e,t,i){this._offsetX=e,this._offsetY=t,this._offsetZ=i},syncInfo:function(e,t,i){if(this._obj){var n=t.x,s=t.y,a=t.z,o=i.x,r=i.y,h=i.z;this._obj instanceof cc.Node?(this._obj.setPosition(n+this._offsetX,s+this._offsetY),this._syncRotation,this._syncVisible):this._obj instanceof b8e.BaseDisplay?(this._obj.setSyncPosition(n,s,a,this._offsetX,this._offsetY,this._offsetZ,e),this._syncRotation&&this._obj.syncRotation(o,r,h,e),this._syncVisible):this._obj.syncInfo&&this._obj.syncInfo(e,t,i)}},dispose:function(){this._obj=null,this._syncRotation=!1,this._syncVisible=!1,this._offsetX=0,this._offsetY=0,this._offsetZ=0}})},{}],15:[function(e,t,i){var n="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},s=b8e.SceneCamera=b8e.Object.extends({ctor:function(e){this._scene=e,this._cameraX=0,this._cameraY=0,this._cameraDistance=0,this._distanceRatio=1e3,this._sceneScale=1,this._mode=s.ThirdPersonMode,this._transitionPos={x:0,y:0}},_setPosition:function(e,t){var i=this._scene.getViewSize(),n=(this._scene.getSceneSize(),e-.5*i.width/this._sceneScale),s=t+.5*i.height/this._sceneScale,a=this._scene.viewUIToGLPos(-n,-s);this._scene._applyViewPos(a.x,a.y),this.applyCamera()},setFocus:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=this._scene.getViewSize();b8e.Tween.kill(this._transitionPos),0<i?(this._transitionPos.x=this._cameraX,this._transitionPos.y=this._cameraY,b8e.Tween.get(this._transitionPos,{onUpdate:function(){this._setPosition(this._transitionPos.x,this._transitionPos.y)},onUpdateThis:this}).to({x:e,y:t-n.height},i)):this._setPosition(e,t-n.height)},focusX:{get:function(){return this._cameraX}},focusY:{get:function(){var e=this._scene.getViewSize();return this._cameraY+e.height}},getSceneGLPos:function(){return this._scene.sceneUIToGLPos(this._cameraX,this._cameraY)},applyCamera:function(){var e=this._scene.getViewportPos(),t=this._scene.getViewSize();this._cameraX=e.x+.5*t.width/this._sceneScale,this._cameraY=e.y-.5*t.height/this._sceneScale},setDistance:function(e){this._cameraDistance=0<e?e:this._distanceRatio,this._sceneScale=this._distanceRatio/this._cameraDistance,this._scene.updateSceneScale(),this._setPosition(this._cameraX,this._cameraY),this._scene.dispatchEventWith(b8e.CameraEvent.CAMERA_DISTANCE_CHANGE,this)},getDistance:function(){return this._cameraDistance},getSceneScale:function(){return this._sceneScale},syncTargetFocus:function(){this._focusTarget&&this.syncInfo(this._focusTarget,this._focusTarget.getPosition(),this._focusTarget.getRotation())},setFocusTarget:function(e){this._focusTarget!=e&&(this._focusTarget&&(this._focusTarget instanceof b8e.BaseDisplay&&this._focusTarget.removeSyncInfo(this._focusSyncInfo),this._focusTarget=null,this._focusSyncInfo=null),e&&(e instanceof b8e.BaseDisplay?(this._focusTarget=e,this._focusSyncInfo=new b8e.DisplaySyncInfo(this),this._focusTarget.addSyncInfo(this._focusSyncInfo)):b8e.error("摄像机焦点目标不是一个有效的engine.BaseDisplay！type:"+(void 0===e?"undefined":n(e)))))},getFocusTarget:function(){return this._focusTarget},syncInfo:function(e,t,i){this._mode==s.ThirdPersonMode&&(t=this._scene.sceneGLToUIPos(t.x,t.y),this.setFocus(t.x,t.y))},setMode:function(e){this._mode=e,b8e.Tween.kill(this._transitionPos),this._mode==s.ThirdPersonMode&&this._setPosition(this._cameraX,this._cameraY)}});s.FirstPersonMode=1,s.ThirdPersonMode=2},{}],16:[function(e,t,i){var n="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)};b8e.SceneDisplay=b8e.BaseDisplay.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this._super(),void 0===e||"number"==typeof e?void 0===t||"number"==typeof t?(this._type=e,this._id=t,this._displayChildren=[]):b8e.error("id必须是数字类型！"):b8e.error("type必须是数字类型！")},type:{get:function(){return this._type}},id:{get:function(){return this._id}},_modifyId:function(e){"number"==typeof e?this._id=e:b8e.error("id必须是数字类型！")},gridX:{set:function(e){this._gridX},get:function(){return this._gridX}},gridY:{set:function(e){this._gridY},get:function(){return this._gridY}},sceneX:{set:function(e){this.setScenePosition(e,this._scenePosY)},get:function(){return this._scenePosX}},sceneY:{set:function(e){this.setScenePosition(this._scenePosX,e)},get:function(){return this._scenePosY}},getDisplayCount:function(){return this._displayChildren.length},getDisplayChildren:function(){return this._displayChildren},removeAllDisplay:function(){if(this._displayChildren)for(var e=this._displayChildren.length-1;0<=e;e--){var t=this._displayChildren[e];t.clearDisabled||this.removeDisplay(t)}},addDisplay:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.usable&&(e instanceof b8e.BaseDisplay?(this.addChild(e,t),this._displayChildren.indexOf(e)<0&&this._displayChildren.push(e)):b8e.error("显示对象不是一个有效的engine.BaseDisplay！type:"+(void 0===e?"undefined":n(e))))},removeDisplay:function(e){if(this._displayChildren)if(e instanceof b8e.BaseDisplay){this.removeChild(e),e.release();var t=this._displayChildren.indexOf(e);-1<t&&this._displayChildren.splice(t,1)}else b8e.error("显示对象不是一个有效的engine.BaseDisplay！type:"+(void 0===e?"undefined":n(e)))},onSyncInfo:function(e){this._super(e),e.syncGridInfo&&(this._lastGridX==this._gridX&&this._lastGridY==this._gridY||e.syncGridInfo(this,{x:this._gridX,y:this._gridY}))},getScene:function(){return this._scene},_setScene:function(e){this._scene!=e&&(this._scene=e,this._sceneVisited=!1,this._sceneVisibled=!1,e&&e.isLoaded()?this.onSceneLoaded():this._sceneLoaded=!1)},setFixedLocalZOrder:function(e){this._fixedLocalZOrder=e},adjustLocalZOrder:function(){if("number"!=typeof this._fixedLocalZOrder){var e=this.y+this._orderOffset>>0;this.getLocalZOrder()!=-e&&this.setLocalZOrder(-e)}else this.setLocalZOrder(this._fixedLocalZOrder)},adjustOpacity:function(){var e=!1;this._sceneLoaded&&-1<this._gridX&&-1<this._gridY&&(e=this._scene.gridIsSpecifyType(this._gridX,this._gridY,b8e.MapGridType.MASK)),this.contentAlpha=e?.5:1},setOrderOffset:function(e){this._orderOffset!=e&&(this._orderOffset=e)},onSyncPosition:function(e){this._applyScenePosition();this.syncAllInfo(e),this._lastGridX=this._gridX,this._lastGridY=this._gridY},setScenePosition:function(e,t){if((this._scenePosX!=e||this._scenePosY!=t)&&(this._scenePosX=e,this._scenePosY=t,this._gridX=-1,this._gridY=-1,this._scene)){var i=this._scene.sceneUIToGLPos(this._scenePosX,this._scenePosY);this.setPosition(i.x,i.y,0)}},getScenePosition:function(){return{x:this._scenePosX,y:this._scenePosY}},onSceneLoaded:function(){if(!this._sceneLoaded){this._sceneLoaded=!0;var e=null;0<=this._gridX&&0<=this._gridY?(e=this._scene.getPixelPosByGrid(this._gridX,this._gridY),e=this._scene.sceneUIToGLPos(e.x,e.y)):0<=this._scenePosX&&0<=this._scenePosY&&(e=this._scene.sceneUIToGLPos(this._scenePosX,this._scenePosY)),e&&this.setPosition(e.x,e.y,0)}},setGridPosition:function(e,t){if((this._gridX!=e||this._gridY!=t)&&(this._gridX=e,this._gridY=t,this._scenePosX=-1,this._scenePosY=-1,this._sceneLoaded)){var i=this._scene.getPixelPosByGrid(this._gridX,this._gridY);i=this._scene.sceneUIToGLPos(i.x,i.y),this.setPosition(i.x,i.y,0)}},_applyScenePosition:function(){if(this._sceneLoaded){var e=this._scene.sceneGLToUIPos(this._posX,this._posY);this._scenePosX=e.x,this._scenePosY=e.y,e=this._scene.getGridPosByPixel(e.x,e.y),this._gridX=e.x,this._gridY=e.y}},getGridPosition:function(){return{x:this._gridX,y:this._gridY}},interact:function(){this.interactTime=b8e.timeStamp},applyAttachVisible:function(e,t){void 0!==this._attachVisibleByType[e]&&!!this._attachVisibleByType[e]==!!t||(this._attachVisibleByType[e]=t,this.onAttachVisible(e,t))},onAttachVisible:function(e,t){},getAttachVisible:function(e){return void 0===this._attachVisibleByType[e]||!!this._attachVisibleByType[e]},addVisibledCallback:function(e,t,i){this._visibledCallbackVec||(this._visibledCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._visibledCallbackVec,e,t,i)},removeVisibledCallback:function(e,t){this._visibledCallbackVec&&0<this._visibledCallbackVec.count()&&b8e.CallBackUtil.removeCallBackData(this._visibledCallbackVec,e,t)},sceneVisit:function(e){this._sceneVisited||(this._sceneVisited=!0,this.onSceneVisited()),!this._sceneVisibled&&e&&(this._sceneVisibled=!0,this._visibledCallbackVec&&0<this._visibledCallbackVec.count()&&b8e.CallBackUtil.exceteCallBackData(this,this._visibledCallbackVec))},onSceneVisited:function(){},restore:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this._super(),void 0===e||"number"==typeof e?void 0===t||"number"==typeof t?(this._type=e,this._id=t):b8e.error("id必须是数字类型！"):b8e.error("type必须是数字类型！")},resetDisplay:function(){this._type=void 0,this._id=void 0,this._scene=null,this._gridX=-1,this._gridY=-1,this._lastGridX=-1,this._lastGridY=-1,this._scenePosX=-1,this._scenePosY=-1,this._orderOffset=0,this._fixedLocalZOrder=void 0,this.fovLimitable=!1,this.isLazy=!1,this.renderLimitable=!1,this.attachLimitable=null,this._sceneVisited=!1,this._sceneVisibled=!1,this._sceneLoaded=!1,this._attachVisibleByType={},this.arrivalOrder=0,this.interactTime=0,this.isUniqueId=!1,this._visibledCallbackVec&&b8e.CallBackUtil.removeAllCallBackData(this._visibledCallbackVec),this.removeAllDisplay(),this._super()},recycle:function(){this._scene&&this._scene._driveOutDisplay(this),this._super()},dispose:function(){if(this._visibledCallbackVec&&(this._visibledCallbackVec.release(),this._visibledCallbackVec=null),this._displayChildren){for(var e=this._displayChildren.length-1;0<=e;e--){var t=this._displayChildren[e];this.removeDisplay(t)}this._displayChildren.length=0,this._displayChildren=null}this._super()}})},{}],17:[function(e,t,i){b8e.SceneDisplaySyncInfo=b8e.DisplaySyncInfo.extends({ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._super(e,t,i)},syncGridInfo:function(e,t){this._obj.syncGridInfo(e,t)}})},{}],18:[function(e,t,i){var o="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},n=b8e.Animator=b8e.BaseDisplay.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this.constructor===n&&(n.poolCall||b8e.warn("强烈建议用engine.Animator.get代替new操作！")),this._super(),this._defaultPrefix="default",this.reset(e,t),this._sprite=b8e.Sprite.get(),this._sprite.clearDisabled=!0,this.addChild(this._sprite),this._animation=this._sprite.getNode().addComponent(cc.Animation),this._animation.on("play",this._onAnimationPlay,this),this._animation.on("finished",this._onAnimationFinished,this),this._bindNodeByName=b8e.HashMap.get(),this._bindChildren=b8e.HashMap.get(),this._clips=b8e.HashMap.get(),this._defaultClips=b8e.HashMap.get()},reset:function(e,t){void 0===e||"number"==typeof e?void 0===t||"number"==typeof t?(this._type=e,this._id=t,this._speedRatio=1,this._animationActive=!0,this._sprite&&this._sprite.setVisible(!0)):b8e.error("id必须是数字类型！"):b8e.error("type必须是数字类型！")},type:{get:function(){return this._type}},id:{get:function(){return this._id}},_loadDefault:function(){this._loadDefaultStarted||this._defaultUrl&&(this._loadDefaultStarted=!0,b8e.res.loadRes(this._defaultUrl,b8e.AnimatorResource,this.onDefaultConfigComplete,this,null,{useManifest:this._useManifest,preload:this._preload,recycleDelay:this._recycleDelay,priority:this._priority,highDefinition:this._highDefinition}))},load:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;if(this.usable){if(this._url==e)return this._onLoadComplete=t?{onComplete:t,thisArg:i}:null,void(this._resource&&this._resource.isLoaded()&&(this._preload=!1,n&&void 0!==n.preload&&(this._preload=n.preload),this._preload&&this._resource.loadSubRes(),this.onLoadComplete(this._resource)));b8e.ResMgr.ALLOW_SET_DEFAULT_FORMAT=!1,this._sprite&&(this._sprite.setFlippedX(!1),this._sprite.setAnchor(.5,.5),this._sprite.setPosition(0,0),this._sprite.setBlendMode(b8e.BlendMode.NORMAL)),this.unload(),this._url=e,this._useManifest=!1,this._preload=!1,this._recycleDelay=0,this._priority=0,this._highDefinition=b8e.ResMgr.HIGH_DEFINITION_ENABLED,n&&(void 0!==n.useManifest&&(this._useManifest=n.useManifest),void 0!==n.preload&&(this._preload=n.preload),void 0!==n.recycleDelay&&(this._recycleDelay=n.recycleDelay),void 0!==n.priority&&(this._priority=n.priority),void 0!==n.highDefinition&&(this._highDefinition=n.highDefinition)),this._onLoadComplete=t?{onComplete:t,thisArg:i}:null,this._startLoad()}},getShader:function(){return this._sprite.getShader()},setBlendMode:function(e){this._sprite.setBlendMode(e)},onHierarchyVisible:function(e){this._super(),e?(this._startLoad(),this.loadAndPlay()):(this._clearAnimation(),this._autoRelease?this.release():this.unload())},setAnimationActive:function(e){this._animationActive!=e&&(this._animationActive=e,this._sprite.setVisible(e),e?this.loadAndPlay():this._clearAnimation())},getAnimationActive:function(){return this._animationActive},_clearAnimation:function(){this._animationState=null,this._animation&&this._animation.stop(),this._sprite&&this._sprite.clear()},_startLoad:function(){this._loadStarted||this._url&&(this._preload||this._hierarchyVisible)&&(this._currResource=null,this._defaultResource&&this._defaultResource.isLoaded()?this.setAnimationConfig(this._defaultResource):this._loadDefault(),this._loadStarted=!0,b8e.res.loadRes(this._url,b8e.AnimatorResource,this.onConfigComplete,this,null,{useManifest:this._useManifest,preload:this._preload,recycleDelay:this._recycleDelay,priority:this._priority,highDefinition:this._highDefinition}))},getResource:function(){return this._resource},setTouchable:function(e){this._touchable!=e&&(this._touchable=e,this._applyAnimatEvents())},getTouchable:function(){return this._touchable},_applyAnimatEvents:function(){this._touchable&&this._touchCallbackVec&&0<this._touchCallbackVec.count()?this._touchEventEnable||this._setAnimatEvents(!0):this._touchEventEnable&&this._setAnimatEvents(!1)},_setAnimatEvents:function(e){(this._touchEventEnable=e)?b8e.evt.onTouchEnd(this,this._onAnimTouchEnd,this):b8e.evt.offTouchEnd(this,this._onAnimTouchEnd,this)},_onAnimTouchEnd:function(e){this._touchCallbackVec&&0<this._touchCallbackVec.count()&&b8e.CallBackUtil.exceteCallBackData(this,this._touchCallbackVec)},addTouchCallback:function(e,t,i){this._touchCallbackVec||(this._touchCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._touchCallbackVec,e,t,i),this._applyAnimatEvents()},removeTouchCallback:function(e,t){this._touchCallbackVec&&0<this._touchCallbackVec.count()&&(b8e.CallBackUtil.removeCallBackData(this._touchCallbackVec,e,t),this._applyAnimatEvents())},onDefaultConfigComplete:function(e,t){this.usable&&(e?this._autoRelease&&this.release():(this._defaultResource=t,this._defaultResource.addClipComplete(this.onClipComplete,this),this._defaultResource.loadSubRes(),this.setAnimationConfig(t)))},onConfigComplete:function(e,t){this.usable&&(e?(this.onLoadComplete(t,e),this._autoRelease&&this.release()):(this._resource=t,this._resource.addClipComplete(this.onClipComplete,this),this.setAnimationConfig(t),this.onLoadComplete(t)))},onLoadComplete:function(e,t){var i=this._onLoadComplete;this._onLoadComplete=null,i&&i.onComplete.call(i.thisArg,t,this)},setAnimationConfig:function(e){this._currResource=e,this.setAnchor(e.anchorX,e.anchorY),this.setBorder(e.left,e.right,e.top,e.bottom);var t=0<e.scale?e.scale:1;this.setResourceScale(t),this._bindNodeByName.forEach(this._updateBindNodePos,this),this.onConfigUpdate(),this.loadAndPlay()},createBindNodeByName:function(e){var t=this._bindNodeByName.get(e);return t||(t=this.createBindNode(e,0,0),this._updateBindNodePos(e,t)),t},_updateBindNodePos:function(e,t){t.setContentScale(1/this._contentScaleX,1/this._contentScaleY);var i=this._currResource;if(i){var n=i.getBindNodeDataByName(e);n&&t.setPosition(n.x/this._contentScaleX,n.y/this._contentScaleY)}},setResourceScale:function(e){this._resourceScale=e,this.setContentScale(this._resourceScale,this._resourceScale)},getOrderX:function(){return this._currResource&&this._currResource.isLoaded()?this._currResource.orderX:0},getOrderY:function(){return this._currResource&&this._currResource.isLoaded()?this._currResource.orderY:0},getBorder:function(){return{left:this._leftBorder,right:this._rightBorder,top:this._topBorder,bottom:this._bottomBorder}},setBorder:function(e,t,i,n){this._leftBorder=e,this._rightBorder=t,this._topBorder=i,this._bottomBorder=n;var s=this._rightBorder-this._leftBorder,a=this._topBorder-this._bottomBorder;s<=0&&a<=0&&(this._leftBorder=-10,this._rightBorder=10,this._bottomBorder=-10,this._topBorder=10,a=s=20),this.setSize(s,a)},onConfigUpdate:function(){this._configCompleteHandler&&this._configCompleteHandler.call(this._configCompleteThis,this)},setConfigUpdateHandler:function(e,t){this._configCompleteHandler=e,this._configCompleteThis=t},setAsBoundary:function(e){this._asBoundary=e},getAsBoundary:function(e){return this._asBoundary},addChildToBindNode:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(this.usable)if(e instanceof b8e.BaseDisplay){var n=this.createBindNodeByName(t),s=this._bindChildren.get(t);if(!s||s.child!=e){s&&(this.removeBindNodeChild(s.child),s=null);var a=e._bindAnimator;a&&a.removeBindNodeChild(e),e.setPosition(0,0),e._bindAnimator=this,s={child:e,depth:i},this._bindChildren.set(t,s),n?n.addChild(e):this.addChild(e)}s.depth=i,n?n.setLocalZOrder(i):e.setLocalZOrder(i)}else b8e.error("显示对象不是一个有效的engine.BaseDisplay！type:"+(void 0===e?"undefined":o(e)))},removeBindNodeChild:function(i){if(this.usable)if(i instanceof b8e.BaseDisplay){var n=null;if(this._bindChildren.every(function(e,t){return t.child!=i||(n=e,!1)},this),n){var e=this._bindChildren.get(n);if(e){(i=e.child).setLocalZOrder(0),i.removeFromParent();var t=this._bindNodeByName.get(n);t&&t.setLocalZOrder(0),i._bindAnimator=null,this._bindChildren.del(n)}}}else b8e.error("显示对象不是一个有效的engine.BaseDisplay！type:"+(void 0===i?"undefined":o(i)))},getBindNode:function(e){return this._bindNodeByName.get(e)},createBindNode:function(e,t,i){var n=this._bindNodeByName.get(e);if(n)b8e.warn("重复添加绑点："+e);else{n=b8e.BaseDisplay.get(),this.addChild(n),n.setContentScale(1/this._contentScaleX,1/this._contentScaleY),n.setPosition(t,i),this._bindNodeByName.set(e,n);var s=this._bindChildren.get(e);s&&(s.child.setLocalZOrder(0),s.child.removeFromParent(),n.addChild(s.child),n.setLocalZOrder(s.depth))}return n},addBindNode:function(e,t,i){return this._resource&&this._resource.isLoaded()?(this._resource.addBindNodeData(e,t,i),this.createBindNode(e,t,i)):null},setBindNodePos:function(t,e,i){var n=this._resource;if(!n||!n.isLoaded())return null;var s=null,a=n.getClipDataByName(this._currClipName);a&&a.bindNodes&&a.bindNodes.every(function(e){return e.name!=t||(s=e,!1)},this);var o=this._bindNodeByName.get(t);if(o){var r=n.getBindNodeDataByName(t);r.x=e,r.y=i,o.setPosition(r.x+(s?s.x:0),r.y+(s?s.y:0))}return o},setClipBindNodePos:function(e,i,n,s){var a=this._resource;if(!a||!a.isLoaded())return null;var o=null,t=a.getClipDataByName(this._currClipName);return t&&t.bindNodes&&t.bindNodes.every(function(e){if(e.name==i){e.x=n,e.y=s;var t=a.getBindNodeDataByName(e.name);return(o=this._bindNodeByName.get(e.name))&&o.setPosition(t.x+e.x,t.y+e.y),!1}return!0},this),o},getClipBindNodePos:function(e,t){var i=this._resource;if(!i||!i.isLoaded())return null;var n=null,s=i.getClipDataByName(this._currClipName);return s&&s.bindNodes&&s.bindNodes.every(function(e){return e.name!=t||!(n={x:e.x,y:e.y})},this),n},removeBindNode:function(e){var t=this._resource;if(t&&t.isLoaded()){t.removeBindNodeData(e);var i=this._bindNodeByName.get(e);i&&(i.release(),this._bindNodeByName.del(e))}},onClipComplete:function(e,t,i){if(this.usable){var n=this._resource,s=e==this._defaultResource;s&&this._defaultPrefix;if(i.getClip()&&t==this._currClipName)if(s){var a=null;n&&n.isLoaded()&&(a=n.getClipByName(t)),a&&a.getClip()||this.onPlay(this._defaultResource,t)}else this.onPlay(n,t)}},getAnimClipByName:function(e,t){var i=null;if(e)this._defaultResource&&this._defaultResource.isLoaded()&&(i=this._defaultResource.getClipByName(t));else{var n=this._resource;n&&n.isLoaded()&&(i=n.getClipByName(t))}return i},addClipData:function(e){this._currResource&&this._currResource.addClipData(e)},removeClipData:function(e){this._currResource&&this._currResource.removeClipData(e)},onAddClip:function(e,t,i){e&&t?i?this._defaultClips.get(e)||(this._defaultResource.addReference(this,e),this._defaultClips.set(e,t),this._animation.addClip(t,this._defaultPrefix+e)):this._clips.get(e)||(this._resource.addReference(this,e),this._clips.set(e,t),this._animation.addClip(t,e)):b8e.error("添加的剪辑为空！"+e)},setDepth:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._depth=e,this._depthFixed=t},setWrapMode:function(e){"number"==typeof e?this._resource&&this._resource.isLoaded()&&(this._resource.setWrapMode(e,this._currClipName),this._animationState&&(this._animationState.wrapMode=e)):b8e.error("wrapMode必须是数字类型！")},getWrapMode:function(){return this._currClipName&&this._resource&&this._resource.isLoaded()?this._resource.getWrapMode(this._currClipName):0},setSample:function(e){if("number"==typeof e){if(this._currClipName&&this._resource&&this._resource.isLoaded()){var t=this._currClipName;this._resource.setSample(e,t);var i=this._clips.get(t);i&&(this._animation.removeClip(i,!0),this._clips.del(t));var n=this._resource.getClipByName(t);n&&(i=n.getClip())&&(this._clips.set(t,i),this._animation.addClip(i,t),this.loadAndPlay())}}else b8e.error("sample必须是数字类型！")},getSample:function(){return this._currClipName&&this._resource&&this._resource.isLoaded()?this._resource.getSample(this._currClipName):0},setSpeed:function(e){"number"==typeof e?this._resource&&this._resource.isLoaded()&&(this._resource.setSpeed(e,this._currClipName),this._animationState&&(this._animationState.speed=this._speedRatio*e)):b8e.error("speed必须是数字类型！")},getSpeed:function(){return this._currClipName&&this._resource&&this._resource.isLoaded()?this._resource.getSpeed(this._currClipName):0},setSpeedRatio:function(e){"number"==typeof e?(this._speedRatio=e,this._currResource&&this._currResource.isLoaded()&&this._animationState&&(this._animationState.speed=e*this._currResource.getSpeed(this._currClipName))):b8e.error("speedRatio必须是数字类型！")},getSpeedRatio:function(){return this._speedRatio},play:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;this.usable&&(this._actionName?e||(e=this._actionName):e||(e="stand"),this._actionName==e?0<=t&&(this._playToTime=t,this._lastPlayTime=b8e.timeStamp):(this._actionName=e,t<0&&(t=0),this._playToTime=t,this._lastPlayTime=b8e.timeStamp),this._isPlay=!0,this._isFinished=!1,this.loadAndPlay())},stop:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;this.usable&&(e<0?this.applyPlayToTime():this._playToTime=e,this._isPlay=!1,this.loadAndPlay())},applyPlayToTime:function(){if(this._currResource&&this._currResource.isLoaded()){var e=this._currResource.getClipDataByName(this._currClipName);if(e){var t=b8e.timeStamp;this._isPlay&&(this._playToTime=this._playToTime+(t-this._lastPlayTime)*this._speedRatio*e.speed),this._lastPlayTime=t}}},getDuration:function(){var e=0;if(this._currResource&&this._currResource.isLoaded()){var t=this._currResource.getClipDataByName(this._currClipName);if(t){var i=this._currResource.getClipByName(this._currClipName);if(i){var n=i.getClip();n&&(e=1e3*n.duration/this._speedRatio*t.speed)}}}return e},loadAndPlay:function(){if(this._hierarchyVisible&&this._loadStarted&&this._actionName&&this._currResource&&this._currResource.isLoaded()){var e=this._currResource.adaptAction(this._actionName,this._direction),t=this._currResource.adjustDirection(e,this._direction),i=e+"/"+this._currResource.getActionDirectionName(t);if(this._currClipName=i,this._animationActive){var n=null;if(this._resource&&this._resource.isLoaded())if(n=this._resource.getClipDataByName(i)){if(this.soundEffectsEnabled&&n.sound){var s=b8e.SoundMgr.EFFECT_SOUND_DIR;b8e.sound.playEffectSound(s+"/"+n.sound)}}else b8e.warn("试图加载动画配置中不存在的动画！"+i+":"+this._resource.getUrl());var a=this.getAnimClipByName(!1,i);if(a&&a.getClip())this.onPlay(this._resource,i);else{if(this._defaultResource&&this._defaultResource.isLoaded())if((a=this.getAnimClipByName(!0,i))&&a.getClip())this.onPlay(this._defaultResource,i);else this._clearAnimation(),this._defaultResource.getClipDataByName(i)?this._defaultResource.loadAnim(this,i):b8e.warn("试图加载动画配置中不存在的动画！"+i+":"+this._defaultResource.getUrl());else this._clearAnimation();n&&this._resource.loadAnim(this,i)}}this.flipByDirection(this._direction),this.updateClipStatus(i)}},onPlay:function(e,t){if(e&&e.isLoaded()){var i=e==this._defaultResource,n=e.getClipDataByName(t);if(n){var s=null;s=i?this._defaultPrefix+t:t;var a=this.getAnimClipByName(i,t);if(!a)return void b8e.error(e.getUrl()+":试图播放不存在的动画剪辑！"+t);var o=a.getClip();if(!o)return void b8e.error(e.getUrl()+":试图播放没加载完成的动画剪辑！"+t);if(o&&o.isValid){this.onAddClip(t,o,i),this.applyPlayToTime();var r=1e3*o.duration/this._speedRatio*n.speed,h=this._playToTime,g=0;o.wrapMode==cc.WrapMode.Normal?r<(g=h)&&(g=r):g=h%r,this._playToTime=g,this._animationState=this._animation.play(s,.001*g),this._animationState&&(this._animationState.speed=this._speedRatio*n.speed),o.curveData.comps["cc.Sprite"].spriteFrame.length<1&&(this._sprite&&this._sprite.clear(),this._autoRelease&&this.release())}else b8e.error(e.getUrl()+":"+s+"剪辑已被销毁！"),this._autoRelease&&this.release()}else b8e.error(e.getUrl()+":试图播放动画配置中不存在的动画！"+t),this._autoRelease&&this.release()}},updateClipStatus:function(e){if(this._currResource&&this._currResource.isLoaded()){var t=this._currResource.getTextureScaleByName(e);this.setContentScale(this._resourceScale/t,this._resourceScale/t)}},_onAnimationPlay:function(e){if(this.usable&&!this._isPlay){var t=null;t=this._currResource==this._resource?this._currClipName:this._defaultPrefix+this._currClipName,this._animation.setCurrentTime(.001*this._playToTime,t),this._animation.stop(t)}},_onAnimationFinished:function(e){this.usable&&(this._isFinished=!0,this._onFinish())},_onFinish:function(){this._finishCallbackVec&&0<this._finishCallbackVec.count()&&b8e.CallBackUtil.exceteCallBackData(this,this._finishCallbackVec),this._autoRelease&&this.release()},isFinished:function(){return this._isFinished},addFinishCallback:function(e,t,i){this._finishCallbackVec||(this._finishCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._finishCallbackVec,e,t,i)},removeFinishCallback:function(e,t){this._finishCallbackVec&&0<this._finishCallbackVec.count()&&b8e.CallBackUtil.removeCallBackData(this._finishCallbackVec,e,t)},setDirection:function(e){this._direction!=e&&(this._direction&&e&&this._direction.x==e.x&&this._direction.y==e.y||(this._direction=e,this.loadAndPlay()))},getDirection:function(){return this._direction},flipByDirection:function(e){if(!e)return this._sprite.setFlippedX(!1),void(void 0!==this._depth&&this.setLocalZOrder(this._depth));var t=e.x,i=e.y;-1==t&&0==i?(this._sprite.setFlippedX(!0),void 0!==this._depth&&this.setLocalZOrder(this._depth)):-1==t&&-1==i?(this._sprite.setFlippedX(!0),void 0!==this._depth&&this.setLocalZOrder(this._depth)):0==t&&-1==i?(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depth)):1==t&&-1==i?(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depth)):1==t&&0==i?(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depth)):1==t&&1==i?(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depthFixed?this._depth:-this._depth)):0==t&&1==i?(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depthFixed?this._depth:-this._depth)):-1==t&&1==i?(this._sprite.setFlippedX(!0),void 0!==this._depth&&this.setLocalZOrder(this._depthFixed?this._depth:-this._depth)):(this._sprite.setFlippedX(!1),void 0!==this._depth&&this.setLocalZOrder(this._depth))},snapshot:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(this._currClipName){e<0&&(this.applyPlayToTime(),e=this._playToTime);var t=this.getAnimClipByName(!1,this._currClipName);if(t&&t.getClip()){var i=t.getFrameInfoByTime(e/this._speedRatio*t.getSpeed()),n={};return n.resOptions=t.getAtlasResOptions(),n.frameInfo=i,n}}return null},getCurrFrameTime:function(){return this.applyPlayToTime(),this._playToTime},autoRelease:function(){this._autoRelease=!0,!this._sceneVisited||this._hierarchyVisible&&!this._isFinished||this.release()},isAutoRelease:function(){return this._autoRelease},sceneVisited:function(){this._sceneVisited||(this._sceneVisited=!0,!this._autoRelease||this._hierarchyVisible&&!this._isFinished||this.release())},clearAllBindNode:function(){this._bindNodeByName&&(this._bindNodeByName.forEach(this._releaseBindNode,this),this._bindNodeByName.clear()),this._bindChildren&&this._bindChildren.forEach(this._resetBindChild,this)},_releaseBindNode:function(e,t){t.release()},_resetBindChild:function(e,t){var i=t.child,n=t.depth;this.addChild(i),i.setLocalZOrder(n)},unload:function(){var i=this;this._clearAnimation(),this._resource&&(this._clips&&(this._clips.forEach(function(e,t){i._animation.removeClip(t,!0),i._resource.unloadAnim(i,e)},this),this._clips.clear()),this._resource.removeClipComplete(this.onClipComplete,this),this._resource=null),this._loadStarted&&this._url&&b8e.res.unloadRes(this._url,this.onConfigComplete,this),this._useManifest=!1,this._preload=!1,this._highDefinition=!1,this._recycleDelay=0,this._priority=0,this._loadStarted=!1,this._currResource=null,this._leftBorder=0,this._rightBorder=0,this._topBorder=0,this._bottomBorder=0,this._resourceScale=0,this.setContentScale(1,1),this.onConfigUpdate()},clear:function(){this.unload(),this.clearAllBindNode(),this._url=null,this._actionName=null,this._currClipName=null,this._onLoadComplete=null},isFree:function(){return null==this._url},setDefault:function(e){this._defaultUrl!=e&&(this.clearDefault(),this._defaultUrl=e)},clearDefault:function(){var i=this;this._defaultResource&&(this._defaultClips&&(this._defaultClips.forEach(function(e,t){i._animation.removeClip(t,!0),i._defaultResource.unloadAnim(i,e)},this),this._defaultClips.clear()),this._defaultResource.removeClipComplete(this.onClipComplete,this),this._defaultResource=null),this._loadDefaultStarted&&this._defaultUrl&&b8e.res.unloadRes(this._defaultUrl,this.onDefaultConfigComplete,this),this._defaultUrl=null,this._loadDefaultStarted=!1},resetDisplay:function(){this._clearAnimation(),this._sprite&&(this._sprite.setFlippedX(!1),this._sprite.setAnchor(.5,.5),this._sprite.setPosition(0,0),this._sprite.resetShader(),this._sprite.setBlendMode(b8e.BlendMode.NORMAL)),this._bindAnimator=null,this._bindDisplay=null,this._super()},restore:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this._super(),this.reset(e,t)},recycle:function(){this.clearDefault(),this.clear(),this._bindAnimator&&(this._bindAnimator.removeBindNodeChild(this),this._bindAnimator=null),this.soundEffectsEnabled=!1,this.ghostable=!1,this._sceneVisited=!1,this._autoRelease=!1,this._isPlay=!1,this._isFinished=!1,this._actionName=null,this._direction=null,this._lastPlayTime=0,this._playToTime=0,this._speedRatio=0,this._depth=void 0,this._depthFixed=!1,this._touchable=!1,this._touchEventEnable&&(this._setAnimatEvents(!1),this._touchEventEnable=!1),this._finishCallbackVec&&b8e.CallBackUtil.removeAllCallBackData(this._finishCallbackVec),this._touchCallbackVec&&b8e.CallBackUtil.removeAllCallBackData(this._touchCallbackVec),this._bindChildren&&(this._bindChildren.forEach(this._removeBindChild,this),this._bindChildren.clear()),this._configCompleteHandler=null,this._configCompleteThis=null,this._asBoundary=!1,this._animationActive=!1,this._sprite&&this._sprite.setVisible(!1),this._type=void 0,this._id=void 0,this._super()},_removeBindChild:function(e,t){var i=t.child;i.setLocalZOrder(0),i.removeFromParent(),i._bindAnimator=null},release:function(){this._bindDisplay?(this._bindDisplay.removeAnimator(this._type,this._id),this._bindDisplay=null):this.constructor===n?n.put(this):this.destroy()},dispose:function(){this._finishCallbackVec&&(this._finishCallbackVec.release(),this._finishCallbackVec=null),this._touchCallbackVec&&(this._touchCallbackVec.release(),this._touchCallbackVec=null),this._bindChildren&&(this._bindChildren.release(),this._bindChildren=null),this._bindNodeByName&&(this._bindNodeByName.release(),this._bindNodeByName=null),this._sprite&&(this._animation&&(this._animation.off("play",this._onAnimationPlay,this),this._animation.off("finished",this._onAnimationFinished,this),this._sprite.getNode().removeComponent(this._animation),this._animation.destroy(),this._animation=null),this._sprite.release(),this._sprite=null),this._clips&&(this._clips.release(),this._clips=null),this._defaultClips&&(this._defaultClips.release(),this._defaultClips=null),this._super()},destroy:function(){this.constructor===n&&(n.poolCall||b8e.warn("强烈建议用engine.Animator.put或release代替destroy操作！")),this._super()}});n.pool=new b8e.Pool(n,1024),n.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return n.pool.get(e,t)},n.put=function(e){return e=n.pool.put(e)}},{}],19:[function(e,t,i){b8e.ComposeAnimator=b8e.BaseDisplay.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._super(e),this._animators=b8e.HashMap.get()},_getAnimatorKey:function(e,t){return"number"!=typeof e?(b8e.error("type必须是数字类型！"),0):"number"!=typeof t?(b8e.error("id必须是数字类型！"),0):b8e.CommonUtil.xyToInt(e,t)},onConfigUpdate:function(e){this._configCompleteHandler&&this._configCompleteHandler.call(this._configCompleteThis,this,e)},setConfigUpdateHandler:function(e,t){this._configCompleteHandler=e,this._configCompleteThis=t},addAnimator:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!this.usable)return null;100<this._animators.count()&&b8e.warn("试图添加超过100个animator?");var s=this._getAnimatorKey(e,t),a=this._animators.get(s);return a||(a=b8e.Animator.get(e,t),this._animators.set(s,a),this.addChild(a),a._bindDisplay=this),a.setDepth(i,n),a.setDirection(this._direction),a.setConfigUpdateHandler(this.onConfigUpdate,this),a},removeAnimator:function(e,t){if(this.usable){var i=this._getAnimatorKey(e,t),n=this._animators.get(i);n&&(n._bindDisplay=null,n.release()),this._animators.del(i)}},getAnimator:function(e,t){if(!this.usable)return null;var i=this._getAnimatorKey(e,t);return this._animators.get(i)},forEachAnimator:function(e,t){this._forEachParams={callback:e,thisArg:t},this._animators.forEach(this._onForEach,this),this._forEachParams=null},_onForEach:function(e,t){var i=this._forEachParams;if(i){var n=i.callback,s=i.thisArg;n.call(s,t)}},clear:function(){this._animators&&(this._animators.forEach(this._releaseAnimat,this),this._animators.clear()),this._direction=null,this._forEachParams=null},_releaseAnimat:function(e,t){t._bindDisplay=null,t.release()},setDirection:function(e){this._direction!=e&&(this._direction=e,this._animators.forEach(this._setAnimDire,this))},_setAnimDire:function(e,t){t.setDirection(this._direction)},getDirection:function(){return this._direction},dispose:function(){this.clear(),this._animators&&(this._animators.release(),this._animation=null),this._configCompleteHandler=null,this._configCompleteThis=null,this._super()}})},{}],20:[function(e,t,i){b8e.Avatar=b8e.ComposeAnimator.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._super(e)},dispose:function(){this._super()}})},{}],21:[function(e,t,i){b8e.AvatarGhost=b8e.SceneDisplay.extends({ctor:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.constructor===b8e.AvatarGhost&&(b8e.AvatarGhost.poolCall||b8e.warn("强烈建议用engine.AvatarGhost.get代替new操作！")),this._super(),this._atlasUrls=[],this._spParts=[],this._avatar=e,this._duration=t,this.playGhost(i)},restore:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this._super(),this._avatar=e,this._duration=t,this.playGhost(i)},playGhost:function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._avatar.localToGlobal();this._avatar.forEachAnimator(function(e){if(e.ghostable){var t=e.getCurrFrameTime(),i=e.snapshot(t+l);if(i){var n=b8e.Sprite.get();this._spParts.push(n);e.localToGlobal();var s=e._sprite.getFlippedX(),a=e.contentScaleX,o=e.contentScaleY,r=e.getLocalZOrder();n.setAnchor(.5,.5),n.setFlippedX(s),n.setContentScale(a,o),n.setLocalZOrder(r);var h=i.resOptions,g=i.frameInfo;h&&g?this._atlasUrls.indexOf(h.url)<0&&(this._atlasUrls.push(h.url),b8e.res.loadRes(h.url,h.type,this.onAtlasComplete,this,[g,n],h)):b8e.warn("animator："+e._url+" >>>>>>>>>>> "+e._currClipName+"未配置！")}}},this),b8e.Tween.get(this).to({alpha:0},this._duration).call(this.release,this)},onAtlasComplete:function(e,t,i,n){if(t){this.addChild(n);var s=t.getSpriteFrame(i.name);n.setFrame(s)}},recycle:function(){b8e.Tween.kill(this),this._atlasUrls.forEach(function(e){b8e.res.unloadRes(e,this.onAtlasComplete,this)},this),this._atlasUrls.length=0,this._spParts.forEach(function(e){e.release()},this),this._spParts.length=0,this._avatar=null,this._duration=0,this._super()},release:function(){this.constructor===b8e.AvatarGhost?b8e.AvatarGhost.put(this):this.destroy()},dispose:function(){this._atlasUrls=null,this._spParts=null,this._super()},destroy:function(){this.constructor===b8e.AvatarGhost&&(b8e.AvatarGhost.poolCall||b8e.warn("强烈建议用engine.AvatarGhost.put或release代替destroy操作！")),this.recycle(),this.dispose()}}),b8e.AvatarGhost.pool=new b8e.Pool(b8e.AvatarGhost,1024),b8e.AvatarGhost.get=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return b8e.AvatarGhost.pool.get(e,t,i)},b8e.AvatarGhost.put=function(e){return e=b8e.AvatarGhost.pool.put(e)}},{}],22:[function(e,t,i){b8e.SceneEntity=b8e.SceneDisplay.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this.constructor===b8e.SceneEntity&&(b8e.SceneEntity.poolCall||b8e.warn("强烈建议用engine.SceneEntity.get代替new操作！")),this._super(e,t),this._avatar=new b8e.Avatar,this._avatar.clearDisabled=!0,this._avatar.setConfigUpdateHandler(this.onConfigUpdate,this),this.addChild(this._avatar),this._touchable=!1,this._autoRelease=!1,this._ghostSpacing=0,this._ghostDuration=0},onConfigUpdate:function(e,t){this.updateOrderOffset()},updateOrderOffset:function(){var i=void 0;this._avatar.forEachAnimator(function(e){var t=e.getOrderY();(null==i||t<i)&&(i=t)},this),null==i&&(i=0),this.setOrderOffset(i)},getAvatar:function(){return this._avatar},setTouchable:function(e){this._touchable!=e&&(this._touchable=e,this._avatar.forEachAnimator(function(e){this._touchable?e.addTouchCallback(this._onAnimTouchCallback,this):e.removeTouchCallback(this._onAnimTouchCallback,this)},this))},getTouchable:function(){return this._touchable},addAnimator:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!this.usable)return null;var s=this._avatar.getAnimator(e,t),a=this._avatar.addAnimator(e,t,i,n);return s?b8e.warn("注意：重复添加动画type:"+e+",id:"+t):(a._bindDisplay=this)._touchable&&a.addTouchCallback(this._onAnimTouchCallback,this),a},getAnimator:function(e,t){return this.usable?this._avatar.getAnimator(e,t):null},removeAnimator:function(e,t){if(this.usable){var i=this._avatar.getAnimator(e,t);i?(this._touchable&&i.removeTouchCallback(this._onAnimTouchCallback,this),this._autoRelease&&i.isAutoRelease()&&this.release(),this.usable&&(this._avatar.removeAnimator(e,t),this.updateOrderOffset())):b8e.warn("注意：移除不存在的动画type:"+e+",id:"+t)}},_onAnimTouchCallback:function(e){this._scene&&this._scene.dispatchEventWith(b8e.SceneEvent.SCENE_ENTITY_CLICK,this)},forEachAnimator:function(n,s,a){this._avatar.forEachAnimator(function(e){var t=[this,e],i=a?t.concat(a):t;n.apply(s,i)},this)},animAutoRelease:function(e,t){var i=this._avatar.getAnimator(e,t);i?(this._autoRelease=!0,i.autoRelease()):b8e.warn("注意：自动释放不存在的动画type:"+e+",id:"+t)},onSceneVisited:function(){this._super(),this._avatar.forEachAnimator(function(e){e.sceneVisited()},this)},restore:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;this._super(e,t)},recycle:function(){this._avatar&&(this._avatar.forEachAnimator(function(e){this._touchable&&e.removeTouchCallback(this._onAnimTouchCallback,this)},this),this._avatar.clear()),this._touchable=!1,this._autoRelease=!1,this._super()},release:function(){this.constructor===b8e.SceneEntity?b8e.SceneEntity.put(this):this.destroy()},setFaceRadian:function(e){var t=b8e.CommonUtil.getDirectionByRadian(e);this.setDirection(t)},setDirection:function(e){this._avatar.setDirection(e)},getDirection:function(){return this._avatar.getDirection()},faceTo:function(e,t){var i=this.getScenePosition(),n=b8e.MathUtil.getRadian(i.x,i.y,e,t);return this.setFaceRadian(-n),n},faceToGrid:function(e,t){if((this._faceToGridX!=e||this._faceToGridY!=t)&&(this._faceToGridX=e,this._faceToGridY=t,this._scene&&this._scene.isLoaded())){var i=this.getGridPosition();if(i.x!=this._faceToGridX||i.y!=this._faceToGridY){var n=this._scene.getPixelPosByGrid(this._faceToGridX,this._faceToGridY);this.faceTo(n.x,n.y)}}},setGhost:function(e,t){this._ghostSpacing=0<e?e:0,this._ghostDuration=0<t?t:0,this._lastGhostPos={x:this._disX,y:this._disY}},onSceneLoaded:function(){if(this._scene&&this._scene.isLoaded()&&(this._super(),0<=this._faceToGridX&&0<=this._faceToGridY)){var e=this.getGridPosition();if(e.x==this._faceToGridX&&e.y==this._faceToGridY)return;var t=this._scene.getPixelPosByGrid(this._faceToGridX,this._faceToGridY);this.faceTo(t.x,t.y)}},onSyncPosition:function(e){if(this._hierarchyVisible&&0<this._ghostSpacing&&0<this._ghostDuration&&b8e.MathUtil.getDistanceNoSqrt(this._lastGhostPos.x,this._lastGhostPos.y,this._disX,this._disY)>=this._ghostSpacing*this._ghostSpacing){var t=b8e.AvatarGhost.get(this._avatar,this._ghostDuration);t.setPosition(this._disX,this._disY),this._scene?this._scene.addDisplay(t,void 0,!0,!0,!1):this.parent.addChild(t),this._lastGhostPos.x=this._disX,this._lastGhostPos.y=this._disY}this._super(e)},resetDisplay:function(){this._faceToGridX=-1,this._faceToGridY=-1,this._ghostSpacing=0,this._ghostDuration=0,this._lastGhostPos=null,this._super()},dispose:function(){this._avatar&&(this._avatar.destroy(),this._avatar=null),this._super()},destroy:function(){this.constructor===b8e.SceneEntity&&(b8e.SceneEntity.poolCall||b8e.warn("强烈建议用engine.SceneEntity.put或release代替destroy操作！")),this.recycle(),this.dispose()}}),b8e.SceneEntity.pool=new b8e.Pool(b8e.SceneEntity,1024),b8e.SceneEntity.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return b8e.SceneEntity.pool.get(e,t)},b8e.SceneEntity.put=function(e){return e=b8e.SceneEntity.pool.put(e)}},{}],23:[function(e,t,i){var s=b8e.SceneEntityLayer=b8e.Object.extends({ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._super(),this._scene=e,this._container=b8e.BaseDisplay.get(),this._container.setAnchor(0,0),this._container.setPosition(0,0),this._container.setLocalZOrder(2),this._scene._container.addChild(this._container),this._displays=[],this._displayIdMap=b8e.HashMap.get(),this._displayTypeMap=b8e.HashMap.get(),this._currRenderLimitNumByType={},this._lastRenderLimitNumByType={},this._maxRenderLimitNumByType={},this._maxOtherRenderLimitNum=-1,this._currOtherRenderLimitNum=0,this._lastOtherRenderLimitNum=0,this._renderCount=0,this._lastRenderCount=0,this._nextDisplayIndex=-1,this._visible=!0,this._arrivalIndex=0,this._viewFilter=t},setVisible:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this._visible!=e&&(this._visible=e,!t))if(this._visible)this._nextDisplayIndex=-1,this.resetViewState(),this.resetLastState(),this.updateDisplayState();else for(var i=this._displays.length-1;0<=i;i--){var n=this._displays[i];n.parent&&n.removeFromParent()}},setViewFilter:function(e){this._viewFilter=e},onSceneLoaded:function(){for(var e=this._displays.length-1;0<=e;e--){this._displays[e].onSceneLoaded()}},addDisplay:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],s=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];if(e instanceof b8e.SceneDisplay){if(!e.usable)return void b8e.error("试图添加已销毁的显示对象到场景！");if(e.getScene())return void b8e.error("试图添加已在场景中的显示对象，请先从其它场景中移除！");if(this._displays.indexOf(e)<0){e.fovLimitable=i,e.renderLimitable=n,e.isLazy=s;var a=e.type,o=e.id;if(void 0!==a&&void 0!==o){var r=this._displayTypeMap.get(a);if(r||(r=b8e.HashMap.get(),this._displayTypeMap.set(a,r)),r.get(o))return void b8e.error("试图添加type:"+a+",id:"+o+"相同的显示对象到场景！");if(r.set(o,e),e.isUniqueId){if(this._displayIdMap.get(o))return void b8e.error("试图添加唯一id:"+o+"相同的显示对象到场景！");this._displayIdMap.set(o,e)}}this._displays.unshift(e),this._nextDisplayIndex++,e.setFixedLocalZOrder(t),e._setScene(this._scene),this._arrivalIndex++,e.arrivalOrder=this._arrivalIndex,s||this.displayViewState(e)}else b8e.warn("试图添加已经存在的显示对象到场景！")}else b8e.error("对象不是一个有效的engine.SceneDisplay！")},removeDisplay:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this._driveOutDisplay(e),t)if(e instanceof b8e.SceneDisplay){if(!e.usable)return void b8e.error("试图从场景释放已释放的显示对象，其它逻辑存在对该对象的非法释放操作！");e.release()}else b8e.error("对象不是一个有效的engine.SceneDisplay！")},_driveOutDisplay:function(e){if(e instanceof b8e.SceneDisplay){if(!e.usable)return void b8e.error("试图从场景移除已移除的显示对象，其它逻辑存在对该对象的非法移除操作！");if(!e.getScene())return void b8e.error("试图移除不在场景的显示对象，其它逻辑存在对该对象的非法移除操作！");var t=this._displays.indexOf(e);if(-1<t){var i=this._scene.getCamera();i.getFocusTarget()==e&&i.setFocusTarget(null),e.setFixedLocalZOrder(void 0),this._displays.splice(t,1),t<=this._nextDisplayIndex&&this._nextDisplayIndex--;var n=e.type,s=e.id;if(void 0!==n&&void 0!==s){var a=this._displayTypeMap.get(n);a&&a.del(s),e.isUniqueId&&this._displayIdMap.del(s)}e.removeFromParent(),e._setScene(null)}else b8e.warn("试图移除不在场景中的显示对象！")}else b8e.error("对象不是一个有效的engine.SceneDisplay！")},getDisplayByType:function(e){var t=this._displayTypeMap.get(e);return t?t.values():[]},getCountByType:function(e){var t=this._displayTypeMap.get(e);return t?t.count():0},getDisplayById:function(e){return this._displayIdMap.get(e)},getDisplayByTypeAndId:function(e,t){var i=null,n=this._displayTypeMap.get(e);return n&&(i=n.get(t)),i},removeDisplayByType:function(e){for(var t=this.getDisplayByType(e),i=t.length-1;0<=i;i--){t[i].release()}},removeDisplayById:function(e){var t=this.getDisplayById(e);t&&t.release()},removeDisplayByTypeAndId:function(e,t){var i=null,n=this._displayTypeMap.get(e);n&&(i=n.get(t)),i&&i.release()},modifyDisplayId:function(e,t){var i=e.id;if(i!=t){var n=e.type,s=this._displayTypeMap.get(n);s.get(t)?b8e.error("试图修改显示对象ID到一个已被占用的ID上，type:"+n+",id:"+t):!e.isUniqueId||this._displayIdMap.get(t)?b8e.error("试图修改显示对象唯一ID到一个已被占用的ID上，id:"+t):s.get(i)?(e._modifyId(t),s.del(i),s.set(e.id,e),e.isUniqueId&&(this._displayIdMap.del(i),this._displayIdMap.set(e.id,e))):b8e.warn("试图对不在场景中的显示对象修改ID！")}},getDisplays:function(){return this._displays},getContainer:function(){return this._container},getDisplayCount:function(){return this._displays.length},getRenderCount:function(){return this._lastRenderCount},getCurrOtherRenderNum:function(){return this._lastOtherRenderLimitNum},getMaxOtherRenderNum:function(){return this._maxOtherRenderLimitNum},setMaxOtherRenderNum:function(e){this._maxOtherRenderLimitNum=e,this._currOtherRenderLimitNum=0,this._lastOtherRenderLimitNum=0},getCurrRenderNum:function(e){var t=this._lastRenderLimitNumByType[e];return t?t.count:0},getMaxRenderNum:function(e){var t=this._maxRenderLimitNumByType[e];return t?t.count:0},setMaxRenderNum:function(e,t){if(-1<t){var i=this._maxRenderLimitNumByType[e];i||(i={attaches:{},count:0},this._maxRenderLimitNumByType[e]=i),i.count=t,(i=this._currRenderLimitNumByType[e])||(i={attaches:{},count:0,limitCount:0},this._currRenderLimitNumByType[e]=i),i.count=0,i.limitCount=0,(i=this._lastRenderLimitNumByType[e])||(i={count:0,limitCount:0},this._lastRenderLimitNumByType[e]=i),i.count=0,i.limitCount=0}else this._maxRenderLimitNumByType[e]=null,delete this._maxRenderLimitNumByType[e],this._currRenderLimitNumByType[e]=null,delete this._currRenderLimitNumByType[e],this._lastRenderLimitNumByType[e]=null,delete this._lastRenderLimitNumByType[e]},getMaxAttachNum:function(e,t){var i=this._maxRenderLimitNumByType[e],n=i?i.attaches[t]:void 0;return void 0===n?0:n},setMaxAttachNum:function(e,t,i){var n,s;-1<i?(n=this._maxRenderLimitNumByType[e])?((s=n.attaches)[t]=i,(n=this._currRenderLimitNumByType[e])&&((s=n.attaches)[t]=0)):b8e.error("没有指定渲染类型："+e+"，不能设置附加类型："+t):((n=this._maxRenderLimitNumByType[e])&&((s=n.attaches)[t]=null,delete s[t]),(n=this._currRenderLimitNumByType[e])&&((s=n.attaches)[t]=null,delete s[t]))},isOtherRenderLimit:function(){return-1<this._maxOtherRenderLimitNum&&this._lastOtherRenderLimitNum>=this._maxOtherRenderLimitNum},isRenderLimit:function(e){var t=this._maxRenderLimitNumByType[e];if(t){var i=t.count;if(t=this._lastRenderLimitNumByType[e])return t.limitCount>=i}return!1},displayViewState:function(e){if(e.usable){var t=this._maxRenderLimitNumByType[e.type],i=this._currRenderLimitNumByType[e.type];i&&i.count++;var n=this._visible;if(n){if(e.fovLimitable){var s=this._scene.getViewSize(),a=this._scene.sceneGLToViewGLPos(e.x,e.y);n=0<=a.x&&a.x<=s.width&&0<=a.y&&a.y<=s.height}n&&this._viewFilter&&(n=this._viewFilter(e))}if(n&&e.renderLimitable)if(t&&i){var o=t.count;i.limitCount>=o?n=!1:i.limitCount++}else-1<this._maxOtherRenderLimitNum&&(this._currOtherRenderLimitNum>=this._maxOtherRenderLimitNum?n=!1:this._currOtherRenderLimitNum++);if(n&&t&&i)for(var r in t.attaches){var h=!0,g=t.attaches[r],l=i.attaches[r];if(void 0!==g&&void 0!==l&&(g<=l?h=!1:(l++,i.attaches[r]=l)),e.attachLimitable){var c=parseInt(r);-1<e.attachLimitable.indexOf(c)&&e.applyAttachVisible(c,h)}}n?(e.parent||this._container.addChild(e),e.adjustLocalZOrder(),e.adjustOpacity(),this._renderCount++):e.parent&&e.removeFromParent(),e.usable&&e.sceneVisit(n)}else b8e.error("不可用的显示对象试图进行视图状态更新！")},updateViewState:function(){this._displays.sort(s.displaySort),this._nextDisplayIndex=this._displays.length-1},updateDisplayState:function(){var e,t=0,i=this._displays.length,n=this._nextDisplayIndex;for((n<0||i-1<n)&&(n=i-1,this._nextDisplayIndex=n);t<s.MAX_BATCH_DISPLAY&&0<=n&&n<this._displays.length;)e=this._displays[n],n--,this._nextDisplayIndex=n,this.displayViewState(e),n=this._nextDisplayIndex,t++},update:function(e){this._nextDisplayIndex<0?(this.resetViewState(),this.updateViewState()):this.updateDisplayState()},resetViewState:function(){var e,t,i,n;for(e in this._currRenderLimitNumByType)for(e in t=this._currRenderLimitNumByType[e],(i=this._lastRenderLimitNumByType[e]).count=t.count,i.limitCount=t.limitCount,t.count=0,t.limitCount=0,n=t.attaches)n[e]=0;this._lastOtherRenderLimitNum=this._currOtherRenderLimitNum,this._lastRenderCount=this._renderCount,this._currOtherRenderLimitNum=0,this._renderCount=0,this._nextDisplayIndex=-1},resetLastState:function(){var e,t;for(e in this._lastRenderLimitNumByType)(t=this._lastRenderLimitNumByType[e]).count=0,t.limitCount=0;this._lastOtherRenderLimitNum=0,this._lastRenderCount=0},clear:function(){for(var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this._displays.length-1;0<=t;t--){var i=this._displays[t];if(i){if(!e&&i.clearDisabled)continue;i.release()}}this._nextDisplayIndex=-1,this._arrivalIndex=0,this.resetViewState(),this.resetLastState()},destroy:function(){this.clear(),this._scene=null,this._container.release(),this._container=null;for(var e=this._displays.length-1;0<=e;e--){this._displays[e].release()}this._displays.length=0,this._displays=null,this._displayIdMap.release(),this._displayIdMap=null,this._displayTypeMap.forEach(function(e,t){t.release()},this),this._displayTypeMap.release(),this._displayTypeMap=null,this._currRenderLimitNumByType=null,this._lastRenderLimitNumByType=null,this._maxRenderLimitNumByType=null,this._maxOtherRenderLimitNum=0,this._viewFilter=null}});s.displaySort=function(e,t){var i=e._scene,n=t._scene;if(i&&!n)return 1;if(!i&&n)return-1;if(i&&n){if(e.isLazy&&!t.isLazy)return-1;if(!e.isLazy&&t.isLazy)return 1;if(e.interactTime>t.interactTime)return 1;if(e.interactTime<t.interactTime)return-1;var s,a,o=i.getCamera(),r=o.getFocusTarget();if(r)s=r.x,a=r.y;else{var h=o.getSceneGLPos();s=h.x,a=h.y}var g=b8e.MathUtil.getDistanceNoSqrt(s,a,e.x,e.y),l=b8e.MathUtil.getDistanceNoSqrt(s,a,t.x,t.y);if(l<g)return-1;if(g<l)return 1;if(e.parent&&t.parent){if(e.arrivalOrder>t.arrivalOrder)return-1;if(e.arrivalOrder<t.arrivalOrder)return 1}else{if(e.parent&&!t.parent)return 1;if(!e.parent&&t.parent)return-1}}return 0},s.MAX_BATCH_DISPLAY=2},{}],24:[function(e,t,i){b8e.EarthSurface=b8e.TileSurface.extends({ctor:function(e){this._super(e)},drawMap:function(){this._super(),this._gridSurface&&this._gridSurface.redrawByGridMap(this._gridMap)},parseMapData:function(){this._config&&(this._super(),this._gridWidth=parseInt(this._config.gridWidth),this._gridHeight=parseInt(this._config.gridHeight),this._gridDatas=this._config.gridDatas,0<this._gridWidth&&0<this._gridHeight&&(this._gridMap||(this._gridMap=b8e.HashMap.get()),this._pathFinding||(this._pathFinding=new b8e.Astar),this._gridCols=Math.ceil(this._mapWidth/this._gridWidth),this._gridRows=Math.ceil(this._mapHeight/this._gridHeight),this._pathFinding.setSquares(this._gridCols,this._gridRows),this._gridDatas&&this._gridDatas.forEach(function(e){var t=b8e.CommonUtil.xyToInt(e.x,e.y);this._gridMap.set(t,e),e.type&b8e.MapGridType.UNWALKABLE?this._pathFinding.setNodeIsSolid(e.x,e.y,!0):0<e.weight&&this._pathFinding.setNodeWeight(e.x,e.y,e.weight)},this)))},openGridGraphics:function(){this._gridSurface||(this._gridSurface=new b8e.GridSurface(this._container,160),this._gridSurface.setSurface(this),this._gridSurface.redrawByGridMap(this._gridMap))},closeGridGraphics:function(){this._gridSurface&&(this._gridSurface.destroy(),this._gridSurface=null)},getGridSurface:function(){return this._gridSurface},addGrids:function(e,n){this._gridMap&&(e.forEach(function(e){var t=b8e.CommonUtil.xyToInt(e.x,e.y),i=this._gridMap.get(t);i||(i=e,this._gridMap.set(t,e)),i.type|=n,n==b8e.MapGridType.UNWALKABLE&&(this._pathFinding.setNodeIsSolid(e.x,e.y,!0),i.weight=this._pathFinding.setNodeWeight(e.x,e.y,0))},this),this._gridSurface&&this._gridSurface.redrawByGridMap(this._gridMap))},removeGrids:function(e,n){this._gridMap&&(e.forEach(function(e){var t=b8e.CommonUtil.xyToInt(e.x,e.y),i=this._gridMap.get(t);i&&i.type&n&&(i.type^=n,0==i.type&&this._gridMap.del(t),n==b8e.MapGridType.UNWALKABLE&&this._pathFinding.setNodeIsSolid(e.x,e.y,!1))},this),this._gridSurface&&this._gridSurface.redrawByGridMap(this._gridMap))},hasGrid:function(e,t,i){var n=b8e.CommonUtil.xyToInt(e,t),s=this._gridMap.get(n);return!!(s&&s.type&i)},setGridWeight:function(e,t,i){if(this._gridMap){var n=b8e.CommonUtil.xyToInt(e,t),s=this._gridMap.get(n);return s&&s.type!=b8e.MapGridType.UNWALKABLE?(s.weight=this._pathFinding.setNodeWeight(e,t,i),this._gridSurface&&this._gridSurface.redrawByGridMap(this._gridMap),s.weight):0}},setGridEventType:function(e,t,i){if(this._gridMap){var n=b8e.CommonUtil.xyToInt(e,t),s=this._gridMap.get(n);return s?(s.eventType=i,this._gridSurface&&this._gridSurface.redrawByGridMap(this._gridMap),s.eventType):0}},getGridEventType:function(e,t){if(this._gridMap){var i=b8e.CommonUtil.xyToInt(e,t),n=this._gridMap.get(i);return n?n.eventType:0}},getGridDatas:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=null;return this._gridMap&&(t=this._gridMap.values(),e&&t.sort(this._onSortGrid)),t},_onSortGrid:function(e,t){var i=b8e.CommonUtil.xyToInt(e.x,e.y),n=b8e.CommonUtil.xyToInt(t.x,t.y);return n<i?1:i<n?-1:0},getGridMap:function(){return this._gridMap},getPathFinding:function(){return this._pathFinding},findPath:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];return this._pathFinding?this._pathFinding.findPath(e,t,i,n,s,a):null},gridIsSolid:function(e,t){return!!this._pathFinding&&this._pathFinding.isSolid(e,t)},gridIsSpecifyType:function(e,t,i){var n=this._gridMap;if(n){var s=b8e.CommonUtil.xyToInt(e,t),a=n.get(s);if(a&&a.type&i)return!0}return!1},getPixelXByGrid:function(e){return(e+.5)*this._gridWidth>>0},getPixelYByGrid:function(e){return(e+.5)*this._gridHeight>>0},getGridXByPixel:function(e){return e/this._gridWidth>>0},getGridYByPixel:function(e){return e/this._gridHeight>>0},clear:function(){this._super(),this._gridWidth=0,this._gridHeight=0,this._gridCols=0,this._gridRows=0,this._gridDatas=null,this._gridMap&&this._gridMap.clear(),this._pathFinding&&this._pathFinding.clear(),this._gridSurface&&this._gridSurface.clear()}})},{}],25:[function(e,t,i){b8e.GridSurface=b8e.Object.extends({ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:128,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this._container=e,this._fillAlpha=t,this._showLabel=i,this._gridFace=b8e.Graphics.get(),this._container.addChild(this._gridFace),this._gridMap=b8e.HashMap.get(),this._labels=b8e.HashMap.get()},setSurface:function(e){this._surface=e,this.redrawGridGraphics()},setScale:function(e){this._gridFace.setScale(e,e)},drawGrid:function(e,t){if(this._surface){var i=this._surface.getPixelXByGrid(e.x),n=this._surface.getPixelYByGrid(e.y),s=i,a=this._surface._mapHeight-n,o=this._gridFace.getGraphics();if(o.fillColor=t,o.fillRect(s-.5*this._surface._gridWidth,a-.5*this._surface._gridHeight,this._surface._gridWidth,this._surface._gridHeight),this._showLabel&&(0<e.weight||0<e.eventType)){var r=b8e.CommonUtil.xyToInt(e.x,e.y),h=b8e.Label.get();h.setAnchor(.5,.5),this._gridFace.addChild(h),h.setFontSize(12),h.setText(e.weight+"-"+e.eventType),h.setPosition(s-.5*h.width,a-.5*h.height),this._labels.set(r,h)}}else b8e.error("drawGrid not find surface!")},addDraw:function(e,t){var i=b8e.CommonUtil.xyToInt(e.x,e.y);e.color=t,this._gridMap.set(i,e),this.redrawGridGraphics()},clearDraw:function(e){var t=b8e.CommonUtil.xyToInt(e.x,e.y);this._gridMap.del(t),this.redrawGridGraphics()},showWireframe:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:4280427042,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4278190335;this._showWireframe||(this._wireframeColor=e,this._wireframeCenterColor=t,this._showWireframe=!0,this.redrawGridGraphics())},hideWireframe:function(){this._showWireframe&&(this._wireframeColor=0,this._wireframeCenterColor=0,this._showWireframe=!1,this.redrawGridGraphics())},showGridType:function(e){this._showGridType=e,this.redrawGridGraphics()},redrawByGridMap:function(i){(this._gridMap.clear(),i)&&i.keys().forEach(function(e){var t=i.get(e);this._gridMap.set(e,t)},this);this.redrawGridGraphics()},redrawGridGraphics:function(){if(this._gridFace.clear(),this._labels.forEach(function(e,t){t.release()}),this._labels.clear(),this._surface){isNaN(this._bgColor)||(this._gridFace.fillColor(this._bgColor),this._gridFace.fillRect(0,0,this._surface._mapWidth,this._surface._mapHeight));var e=this._gridMap.values(),o=[];if(e.forEach(function(e){var t=!1,i=null;if(e.type){for(var n in i={r:0,g:0,b:0,a:255},b8e.GridSurface.drawGridDesc)if(e.type&n&&this._showGridType&n){var s=b8e.GridSurface.drawGridDesc[n].color;i.r|=s.r,i.g|=s.g,i.b|=s.b,t=!0}}else e.color&&(i=e.color,t=!0);if(t){var a=new cc.Color(i);a.a=this._fillAlpha,this.drawGrid(e,a)}e.line&&o.push(e)},this),1<o.length){o.sort(this._onSortGrid),this._gridFace.lineWidth(5),this._gridFace.strokeColor(4294967040);var t=!1;o.forEach(function(e){t?e.line&&this._gridFace.lineTo(e.x*this._surface._gridWidth+.5*this._surface._gridWidth,this._surface._mapHeight-e.y*this._surface._gridHeight-.5*this._surface._gridHeight):e.line?(t=!0,this._gridFace.moveTo(e.x*this._surface._gridWidth+.5*this._surface._gridWidth,this._surface._mapHeight-e.y*this._surface._gridHeight-.5*this._surface._gridHeight)):t=!1},this),this._gridFace.stroke()}if(this._showWireframe){this._gridFace.lineWidth(2),this._gridFace.strokeColor(this._wireframeColor);for(var i=this._surface.getGridXByPixel(this._surface._mapWidth),n=0;n<=i;n++){var s=n*this._surface._gridWidth;this._gridFace.moveTo(s,0),this._gridFace.lineTo(s,this._surface._mapHeight)}for(var a=this._surface.getGridYByPixel(this._surface._mapHeight),r=0;r<=a;r++){var h=this._surface._mapHeight-r*this._surface._gridHeight;this._gridFace.moveTo(0,h),this._gridFace.lineTo(this._surface._mapWidth,h)}this._gridFace.stroke(),this._gridFace.lineWidth(2),this._gridFace.strokeColor(this._wireframeCenterColor);var g=.5*this._surface._mapWidth>>0;this._gridFace.moveTo(g,0),this._gridFace.lineTo(g,this._surface._mapHeight);var l=.5*this._surface._mapHeight>>0;l=this._surface._mapHeight-l,this._gridFace.moveTo(0,l),this._gridFace.lineTo(this._surface._mapWidth,l),this._gridFace.stroke()}}},_onSortGrid:function(e,t){return e.index>t.index?-1:e.index<t.index?1:0},setBackgroundColor:function(e){this._bgColor=e,this.redrawGridGraphics()},clear:function(){this._bgColor=null,this._wireframeColor=0,this._wireframeCenterColor=0,this._showWireframe=!1,this._showGridType=0,this._gridMap.clear(),this._gridFace.clear(),this._labels.forEach(function(e,t){t.release()}),this._labels.clear()},destroy:function(){this.clear(),this._gridFace.release(),this._gridFace=null,this._container=null,this._surface=null}}),b8e.GridSurface.drawGridDesc={},b8e.GridSurface.drawGridDesc[b8e.MapGridType.UNWALKABLE]={color:{r:255,g:0,b:0,a:255}},b8e.GridSurface.drawGridDesc[b8e.MapGridType.MASK]={color:{r:0,g:0,b:255,a:255}},b8e.GridSurface.drawGridDesc[b8e.MapGridType.FIGHT_DEFINE]={color:{r:0,g:255,b:0,a:255}},b8e.GridSurface.drawGridDesc[b8e.MapGridType.PATH_FINDING_WEIGHT]={color:{r:0,g:0,b:0,a:255}},b8e.GridSurface.drawGridDesc[b8e.MapGridType.EVENT]={color:{r:255,g:255,b:0,a:255}}},{}],26:[function(e,t,i){b8e.SceneMapLayer=b8e.Object.extends({ctor:function(e){this._super(),this._scene=e,this._container=b8e.BaseDisplay.get(),this._container.setAnchor(0,0),this._container.setPosition(0,0),this._container.setLocalZOrder(1),this._scene._container.addChild(this._container),this._earthSurface=new b8e.EarthSurface(this._container)},getContainer:function(){return this._container},getViewSize:function(){return this._earthSurface.getViewSize()},viewWidth:{get:function(){return this._earthSurface.viewWidth}},viewHeight:{get:function(){return this._earthSurface.viewHeight}},getMapWidth:function(){return this._earthSurface?this._earthSurface.getMapWidth():0},getMapHeight:function(){return this._earthSurface?this._earthSurface.getMapHeight():0},getEarthSurface:function(){return this._earthSurface},getConfig:function(){return this._earthSurface.getConfig()},getMapUrl:function(){return this._mapUrl},getViewGLPos:function(){return this._earthSurface.getViewGLPos()},setViewGLPos:function(e,t){this._earthSurface.setViewGLPos(e,t)},getPixelXByGrid:function(e){return this._earthSurface?this._earthSurface.getPixelXByGrid(e):0},getPixelYByGrid:function(e){return this._earthSurface?this._earthSurface.getPixelYByGrid(e):0},getGridXByPixel:function(e){return this._earthSurface?this._earthSurface.getGridXByPixel(e):0},getGridYByPixel:function(e){return this._earthSurface?this._earthSurface.getGridYByPixel(e):0},startRender:function(){this._container.setVisible(!0),this._earthSurface.startRender()},stopRender:function(){this._container.setVisible(!1),this._earthSurface.stopRender()},loadMap:function(e,t,i){b8e.log("loadMap..."),this.clear(),this._onLoadComplete=t,this._onLoadCompleteThis=i,this._mapUrl=e.replace(/\\/g,"/");var n=b8e.proto.map.MapConfigMessage;b8e.res.loadRes(this._mapUrl,b8e.ProtobufConfig,this.onConfigComplete,this,null,{useManifest:!1,proto:n,priority:1e7,recycleDelay:-1})},onConfigComplete:function(e,t){e?(b8e.error(e),this._onLoadComplete&&this._onLoadComplete.call(this._onLoadCompleteThis,e,null)):(b8e.log("loadMap finish!"),this.setMapConfig(this._mapUrl,t.getProtoData()),this._onLoadComplete&&this._onLoadComplete.call(this._onLoadCompleteThis,null,this))},setMapConfig:function(e,t){this._earthSurface.setConfig(e,t),e&&t&&this._earthSurface.loadThumb(t.thumbFileName)},setViewSize:function(e,t){this._earthSurface&&this._earthSurface.setViewSize(e,t)},setViewBounds:function(e,t,i,n){this._earthSurface&&this._earthSurface.setViewBounds(e,t,i,n)},refreshView:function(){this._earthSurface&&this._earthSurface.refreshView(!0)},getContainerPos:function(){return this._earthSurface.getContainerPos()},mapUIToGLPos:function(e,t){return this._earthSurface.containerUIToGLPos(e,t)},mapGLToUIPos:function(e,t){return this._earthSurface.containerGLToUIPos(e,t)},update:function(e){this._earthSurface.update(e)},clear:function(){this._mapUrl&&(b8e.res.unloadRes(this._mapUrl,this.onConfigComplete,this),this._mapUrl=null),this._onLoadComplete=null,this._onLoadCompleteThis=null,this._earthSurface.clear()},getTileCount:function(){return this._earthSurface.getTileCount()},getRenderCount:function(){return this._earthSurface.getRenderCount()}})},{}],27:[function(e,t,i){b8e.ThumbSurface=b8e.Object.extends({ctor:function(e){this._container=e,this._bufferContainer=b8e.BaseDisplay.get(),this._container.addChild(this._bufferContainer),this._bufferContainer.setAnchor(0,0),this._bufferContainer.setPosition(0,0),this._thumbImg=b8e.Sprite.get(),this._bufferContainer.addChild(this._thumbImg)},load:function(e,t){this.clear(),b8e.log("loadThumb..."),this._thumbUrl=e,this._thumbRatio=t,this._thumbImg.loadTexture(this._thumbUrl,null,null,{useManifest:!1})},setSize:function(e,t){this._thumbImg.setSize(e,t)},openGridGraphics:function(){this._gridSurface||(this._gridSurface=new b8e.GridSurface(this._bufferContainer,192,!1))},closeGridGraphics:function(){this._gridSurface&&(this._gridSurface.destroy(),this._gridSurface=null)},getGridSurface:function(){return this._gridSurface},setTileSurface:function(e){this._gridSurface&&(this._gridSurface.setSurface(e),this._gridSurface.redrawByGridMap(e._gridMap),this._gridSurface.setScale(1/e._thumbRatio))},clearThumbImg:function(){this._thumbImg.unloadTexture(),this._thumbUrl=null,this._thumbRatio=0},clear:function(){this.clearThumbImg(),this._gridSurface&&this._gridSurface.clear()}})},{}],28:[function(e,t,i){b8e.TileSurface=b8e.Object.extends({ctor:function(e){this._layer=e,this._container=b8e.BaseDisplay.get(),this._layer.addChild(this._container),this._container.setAnchor(0,0),this._container.setPosition(0,0),this._thumbImg=b8e.Sprite.get(),this._container.addChild(this._thumbImg),this._tileContainer=b8e.BaseDisplay.get(),this._tileContainer.setAnchor(0,0),this._tileContainer.setPosition(0,0),this._container.addChild(this._tileContainer),this._screenRect={x:0,y:0,width:0,height:0},this._viewRect={x:0,y:0,width:0,height:0},this._offsetPoint={x:0,y:0},this._tiles=b8e.HashMap.get(),this._waitAddBatchTile=[],this._loadTiles=[],this._waitRemoveBatchTile=[],this._unloadTiles=[]},loadThumb:function(e){this._dirUrl&&(e=e||"thumb.jpg",this.clearThumbImg(),b8e.log("load "+e+"..."),this._thumbImg.setSize(this._mapWidth,this._mapHeight),this._thumbUrl=this._dirUrl+"/"+e,this._thumbImg.loadTexture(this._thumbUrl,null,null,{useManifest:!1,recycleDelay:6e5,priority:1e6}))},clearThumbImg:function(){this._thumbImg.unloadTexture(),this._thumbUrl=null},getThumbUrl:function(){return this._thumbUrl},startRender:function(){this._updatable=!0},stopRender:function(){this._updatable=!1},setConfig:function(e,t){this.clear(),this._mapUrl=e?e.replace(/\\/g,"/"):null,this._dirUrl=this._mapUrl?this._mapUrl.substring(0,this._mapUrl.lastIndexOf("/")):null,this._config=t,this.parseMapData(),this.drawMap(),this._container.setSize(this._mapWidth,this._mapHeight)},drawMap:function(){},getConfig:function(){return this._config},getDirUrl:function(){return this._dirUrl},getThumbRatio:function(){return this._thumbRatio},parseMapData:function(){this._config&&(this._loadPriority=-10,this._mapWidth=parseInt(this._config.mapWidth),this._mapHeight=parseInt(this._config.mapHeight),this._tileWidth=parseInt(this._config.tileWidth),this._tileHeight=parseInt(this._config.tileHeight),this._mapCols=0<this._tileWidth?Math.ceil(this._mapWidth/this._tileWidth):0,this._mapRows=0<this._tileHeight?Math.ceil(this._mapHeight/this._tileHeight):0,this._thumbRatio=parseInt(this._config.thumbRatio),this._thumbRatio=0<this._thumbRatio?this._thumbRatio:1)},fillInternal:function(){var e,t,i,n,s,a;if(-1==this._lastStartTileX&&-1==this._lastStartTileY){e=this._startTileY,t=this._endTileY,i=this._startTileX;var o=(n=this._endTileX)-i+1,r=t-e+1,h=.5*(r<o?o:r)>>0,g=i+.5*o>>0,l=e+.5*r>>0;b8e.ArrayUtil.getRectangularSpiralArray(this,g,l,h,this.fillReject,this.fillProcess)}else{var c=this._startTileX-this._lastStartTileX,u=this._endTileX-this._lastEndTileX,m=this._startTileY-this._lastStartTileY,_=this._endTileY-this._lastEndTileY,d=Math.abs(u)>Math.abs(c)?u:c,f=Math.abs(_)>Math.abs(m)?_:m;if(d<0?-d>this._bufferCols&&(d=-this._bufferCols):d>this._bufferCols&&(d=this._bufferCols),f<0?-f>this._bufferRows&&(f=-this._bufferRows):f>this._bufferRows&&(f=this._bufferRows),0<f)for((e=this._endTileY-f+1)<0&&(e=0),(t=this._endTileY)>=this._mapRows&&(t=this._mapRows-1),(i=this._startTileX)<0&&(i=0),(n=this._endTileX)>=this._mapCols&&(n=this._mapCols-1),s=e;s<=t;s++)for(a=n;i<=a;a--)this.loadTile(a,s);else if(f<0)for((e=this._startTileY)<0&&(e=0),(t=this._startTileY-f-1)>=this._mapRows&&(t=this._mapRows-1),(i=this._startTileX)<0&&(i=0),(n=this._endTileX)>=this._mapCols&&(n=this._mapCols-1),s=t;e<=s;s--)for(a=i;a<=n;a++)this.loadTile(a,s);if(0<d)for((e=this._startTileY)<0&&(e=0),(t=this._endTileY)>=this._mapRows&&(t=this._mapRows-1),(i=this._endTileX-d+1)<0&&(i=0),(n=this._endTileX)>=this._mapCols&&(n=this._mapCols-1),s=e;s<=t;s++)for(a=i;a<=n;a++)this.loadTile(a,s);else if(d<0)for((e=this._startTileY)<0&&(e=0),(t=this._endTileY)>=this._mapRows&&(t=this._mapRows-1),(i=this._startTileX)<0&&(i=0),(n=this._startTileX-d-1)>=this._mapCols&&(n=this._mapCols-1),s=t;e<=s;s--)for(a=n;i<=a;a--)this.loadTile(a,s)}},fillReject:function(e,t,i,n){var s=e+i,a=t+n;return!(s>=this._startTileX&&s<=this._endTileX&&a>=this._startTileY&&a<=this._endTileY)},fillProcess:function(e,t,i,n){var s=e+i,a=t+n;this.loadTile(s,a)},loadTile:function(e,t){var i=e*this._tileWidth,n=this._mapHeight-t*this._tileHeight-this._tileHeight,s=this.getTileResId(e,t),a=this._tiles.get(s);a||((a=b8e.Sprite.get()).setPosition(i,n),a.setSize(this._tileWidth,this._tileHeight),a.data={tileX:e,tileY:t},this._tiles.set(s,a));var o=this._waitAddBatchTile.indexOf(a);o<0&&this._waitAddBatchTile.push(a),-1<(o=this._waitRemoveBatchTile.indexOf(a))&&this._waitRemoveBatchTile.splice(o,1),-1<(o=this._loadTiles.indexOf(s))&&this._loadTiles.splice(o,1),-1<(o=this._unloadTiles.indexOf(s))&&this._unloadTiles.splice(o,1),this._nextLoadTile()},_nextLoadTile:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(0<this._waitAddBatchTile.length&&this._loadTiles.length<1){var t=this._waitAddBatchTile.shift(),i=t.data.tileX,n=t.data.tileY,s=this.getTileResId(i,n);this._loadTiles.indexOf(s)<0&&this._loadTiles.push(s),e?b8e.setTimeout(this._onLoadTile,this,10,i,n):this._onLoadTile(i,n)}},_onLoadTile:function(e,t){var i=this.getTileResId(e,t),n=this._loadTiles.indexOf(i);if(n<0)this._nextLoadTile(!1);else{this._loadTiles.splice(n,1);var s=this._tiles.get(i);if(s){if(this._tileContainer.addChild(s),!s.isLoaded&&!s.isLoading){var a=this.getTileResUrl(e,t);s.loadTexture(a,null,null,{useManifest:!1,recycleDelay:6e5,priority:-1e3})}this._nextLoadTile()}else this._nextLoadTile(!1)}},_nextUnloadTile:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(0<this._waitRemoveBatchTile.length&&this._unloadTiles.length<1){var t=this._waitRemoveBatchTile.shift(),i=t.data.tileX,n=t.data.tileY,s=this.getTileResId(i,n);this._unloadTiles.indexOf(s)<0&&this._unloadTiles.push(s),e?b8e.setTimeout(this._onUnloadTile,this,10,i,n):this._onUnloadTile(i,n)}},_onUnloadTile:function(e,t){var i=this.getTileResId(e,t),n=this._unloadTiles.indexOf(i);if(n<0)this._nextUnloadTile(!1);else{this._unloadTiles.splice(n,1);var s=this._tiles.get(i);s?(s.removeFromParent(),this._nextUnloadTile()):this._nextUnloadTile(!1)}},update:function(e){},getViewGLPos:function(){return{x:this._viewX,y:this._viewY}},setViewGLPos:function(e,t){this._viewX=e,this._viewY=t,this.refreshView()},refreshView:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this._viewX<this._rightBorder&&(this._viewX=this._rightBorder),this._viewX>this._leftBorder&&(this._viewX=this._leftBorder),this._viewY>this._bottomBorder&&(this._viewY=this._bottomBorder),this._viewY<this._topBorder&&(this._viewY=this._topBorder),this._updatable&&!(this._tileWidth<=0||this._tileHeight<=0)){e&&(this._lastStartTileX=-1,this._lastStartTileY=-1,this._lastEndTileX=-1,this._lastEndTileY=-1,this._lastViewX=-1,this._lastViewY=-1);var t=!0;if(this._viewX==this._lastViewX&&this._viewY==this._lastViewY&&(t=!1),this._lastViewX=this._viewX,this._lastViewY=this._viewY,t){this._screenRect.x=-this._viewX,this._screenRect.y=this._mapHeight+this._viewY-this._viewHeight,this._startTileX=this._screenRect.x/this._tileWidth>>0,this._startTileY=this._screenRect.y/this._tileHeight>>0,this._endTileX=Math.ceil((this._screenRect.x+this._screenRect.width)/this._tileWidth)-1,this._endTileX=this._endTileX>=this._mapCols?this._mapCols-1:this._endTileX,this._endTileY=Math.ceil((this._screenRect.y+this._screenRect.height)/this._tileHeight)-1,this._endTileY=this._endTileY>=this._mapRows?this._mapRows-1:this._endTileY;var i=!0;this._offsetPoint.x=this._screenRect.x%this._tileWidth,this._offsetPoint.y=this._screenRect.y%this._tileHeight;var n=this._startTileX-this._lastStartTileX,s=this._endTileX-this._lastEndTileX,a=this._startTileY-this._lastStartTileY,o=this._endTileY-this._lastEndTileY,r=Math.abs(s)>Math.abs(n)?s:n,h=Math.abs(o)>Math.abs(a)?o:a;0==r&&0==h&&(i=!1),this._viewRect.x=this._offsetPoint.x,this._viewRect.y=this._offsetPoint.y,i&&this.refreshBuffer(),this._lastStartTileX=this._startTileX,this._lastStartTileY=this._startTileY,this._lastEndTileX=this._endTileX,this._lastEndTileY=this._endTileY}}},getContainer:function(){return this._container},getContainerPos:function(){return{x:this._viewX,y:this._viewY}},containerUIToGLPos:function(e,t){return{x:e,y:this._mapHeight-t}},containerGLToUIPos:function(e,t){return{x:e,y:this._mapHeight-t}},refreshBuffer:function(){this._updatable&&(this.clearPeripheral(),this.fillInternal())},clearPeripheral:function(){var e,t,i,n,s,a;if(-1==this._lastStartTileX&&-1==this._lastStartTileY){for(e=0,t=this._startTileY-1,i=0,n=this._mapCols-1,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);for(e=this._endTileY+1,t=this._mapRows-1,i=0,n=this._mapCols-1,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);for(e=0,t=this._mapRows-1,i=0,n=this._startTileX-1,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);for(e=0,t=this._mapRows-1,i=this._endTileX+1,n=this._mapCols-1,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s)}else{var o=this._startTileX-this._lastStartTileX,r=this._endTileX-this._lastEndTileX,h=this._startTileY-this._lastStartTileY,g=this._endTileY-this._lastEndTileY,l=Math.abs(r)>Math.abs(o)?r:o,c=Math.abs(g)>Math.abs(h)?g:h;if(0<c)for(e=this._startTileY-c,t=this._startTileY-1,0<l?(i=this._startTileX-l,n=this._endTileX-l):l<0?(i=this._startTileX-l,n=this._endTileX-l):(i=this._startTileX,n=this._endTileX),s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);else if(c<0)for(e=this._endTileY+1,t=this._endTileY-c,0<l?(i=this._startTileX-l,n=this._endTileX-l):l<0?(i=this._startTileX-l,n=this._endTileX-l):(i=this._startTileX,n=this._endTileX),s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);if(0<l)for(0<c?(e=this._startTileY-c,t=this._endTileY-c):c<0?(e=this._startTileY-c,t=this._endTileY-c):(e=this._startTileY,t=this._endTileY),i=this._startTileX-l,n=this._startTileX-1,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s);else if(l<0)for(0<c?(e=this._startTileY-c,t=this._endTileY-c):c<0?(e=this._startTileY-c,t=this._endTileY-c):(e=this._startTileY,t=this._endTileY),i=this._endTileX+1,n=this._endTileX-l,s=e;s<=t;s++)for(a=i;a<=n;a++)this.clearTile(a,s)}},clearTile:function(e,t){if(0<=e&&e<this._mapCols&&0<=t&&t<this._mapRows){var i=this.getTileResId(e,t),n=this._tiles.get(i);if(n){var s=this._waitAddBatchTile.indexOf(n);-1<s&&this._waitAddBatchTile.splice(s,1),(s=this._waitRemoveBatchTile.indexOf(n))<0&&this._waitRemoveBatchTile.push(n),-1<(s=this._loadTiles.indexOf(i))&&this._loadTiles.splice(s,1),-1<(s=this._unloadTiles.indexOf(i))&&this._unloadTiles.splice(s,1),n.isLoading&&n.unloadTexture(),this._nextUnloadTile()}}},getTileResId:function(e,t){return e+"_"+t},getTileResUrl:function(e,t){var i=this.getTileResId(e,t);return this._dirUrl+"/slices/"+i+".jpg"},getViewSize:function(){return{width:this._viewWidth,height:this._viewHeight}},viewWidth:{get:function(){return this._viewWidth}},viewHeight:{get:function(){return this._viewHeight}},setViewBounds:function(e,t,i,n){this._topBorder=i,this._bottomBorder=n,this._leftBorder=e,this._rightBorder=t},setViewSize:function(e,t){this._viewWidth=e,this._viewHeight=t,this._viewRect.x=0,this._viewRect.y=0,this._viewRect.width=this._viewWidth,this._viewRect.height=this._viewHeight,this._screenRect.x=0,this._screenRect.y=0,this._screenRect.width=this._viewWidth,this._screenRect.height=this._viewHeight,this.updateBufferSize()},updateBufferSize:function(){this._bufferCols=0<this._tileWidth?Math.ceil(this._viewWidth/this._tileWidth):0,this._bufferRows=0<this._tileHeight?Math.ceil(this._viewHeight/this._tileHeight):0,this._bufferCols=this._bufferCols>this._mapCols?this._mapCols:this._bufferCols,this._bufferRows=this._bufferRows>this._mapRows?this._mapRows:this._bufferRows},getMapWidth:function(){return this._mapWidth},getMapHeight:function(){return this._mapHeight},clearAllTiles:function(){this._tiles.forEach(function(e,t){b8e.Sprite.put(t)},this),this._tiles.clear(),this._waitAddBatchTile.length=0,this._loadTiles.length=0,this._waitRemoveBatchTile.length=0,this._unloadTiles.length=0},getTileCount:function(){return this._tiles.count()},getCurrTilesResList:function(){var n=[];return this._tiles.forEach(function(e,t){var i=this.getTileResUrl(t.data.tileX,t.data.tileY);n.push(i)},this),n},getRenderCount:function(){return this._tileContainer.getChildrenCount()},clear:function(){this.clearAllTiles(),this.clearThumbImg(),this._mapWidth=0,this._mapHeight=0,this._mapCols=0,this._mapRows=0,this._tileWidth=0,this._tileHeight=0,this._bufferCols=0,this._bufferRows=0,this._viewX=0,this._viewY=0,this._mapUrl=null,this._dirUrl=null,this._config=null,this._loadPriority=0,this._lastStartTileX=-1,this._lastStartTileY=-1,this._lastViewX=-1,this._lastViewY=-1,this._startTileX=-1,this._startTileY=-1,this._thumbRatio=0,this._updatable=!1}})},{}],29:[function(e,t,i){var S=b8e.RichText=b8e.BaseDisplay.extends({_set_fontSize:null,_set_fontFile:null,_set_textColor:null,ctor:function(){},initWithStr:function(e,t,i,n){this._set_fontSize=i,this._set_fontFile=t;for(var s=e,a=0,o=0;a<s.length;){var r=!1;if(a!=(o=s.substr(a).indexOf("<"))){for(var h=s.substr(a,o-a),g=h.indexOf("\n");-1!=g;){h.substr(0,g);g=(h=h.substr(g+1)).indexOf("\n")}if(-1==o)break}a=o+1,"/"==s.charAt(a)&&(r=!0,a++);var l=S.keywords,c=0;for(c=0;c<8&&0!=s.substr(a,l[c].length).indexOf(l[c]);c++);if(c<8)switch(c){case 0:if(o=s.substr(a).indexOf(">"),r)this._set_fontSize=i;else{a=s.substr(a).indexOf("=")+1;n=parseInt(s.substr(a,o-a));this._set_fontSize=n}break;case 1:if(o=s.substr(a).indexOf(">"),r)this._set_fontFile=t;else{a=s.substr(a).indexOf("=")+1,f=(m=s.substr(a,o-a)).indexOf('"')+1,p=m.substr(f).indexOf('"');var u=m.substr(f,p-f);this._set_fontFile=u}break;case 2:if(o=s.substr(a+1).indexOf(">"),r)this._set_outline=DEFAULT_OUTLINE,this._set_outline_color=DEFAULT_OUTLINE_COLOR;else{a=s.substr(a).indexOf("=")+1;var m=s.substr(a,o-a);n=parseInt(m);if(this._set_outline=n,-1!=(f=m.indexOf("="))){var _=m.substr(f+1);this._set_outline_color=_}}break;case 3:o=s.substr(a).indexOf(">"),this._set_shadow=!r;break;case 4:if(o=s.substr(a).indexOf(">"),r)this._set_link="";else{a=s.substr(a).indexOf("=")+1,f=(m=s.substr(a,o-a)).indexOf('"')+1,p=m.substr(f).indexOf('"');var d=m.substr(f,p-f);this._set_link=d}break;case 5:var f,p;o=s.substr(a).indexOf(">"),a=s.substr(a).indexOf("=")+1,f=(m=s.substr(a,o-a)).indexOf('"')+1,p=m.substr(f).indexOf('"');m.substr(f,p-f);break;case 6:if(o=s.substr(a).indexOf(">"),r)this._set_textColor=DEFAULT_COLOR;else{a=s.substr(a).indexOf("=")+1;_=s.substr(a,o-a);this._set_textColor=_}break;case 7:if(o=s.substr(a).indexOf(">"),r)this._set_underline=!1,this._set_underline_color=DEFAULT_UNDERLINE_COLOR;else if(this._set_underline=!0,-1!=s.substr(a,o-a).indexOf("=")){a=s.substr(a).indexOf("=")+1;_=s.substr(a,o-a);this._set_underline_color=_}}a=o+1}return!0}});S.keywords=["size","fontname","outline","shadow","link","img","color","u"]},{}],30:[function(e,t,i){b8e.MapGridType=b8e.Enum({SPACE:0,UNWALKABLE:1,MASK:2,FIGHT_DEFINE:4,PATH_FINDING_WEIGHT:8,EVENT:16})},{}],31:[function(e,t,i){b8e.MouseController=b8e.Object.extends({ctor:function(e){this._target=e,"mouse"in cc.sys.capabilities?(this._node=this._target instanceof cc.Node?this._target:this._target.getNode(),b8e.evt.onMouseDown(this._node,this.onMouseDown,this),b8e.evt.onMouseUp(this._node,this.onMouseUp,this),b8e.evt.onMouseLeave(this._node,this.onMouseLeave,this),b8e.evt.onMouseMove(this._node,this.onMouseMove,this),b8e.evt.onMouseWheel(this._node,this.onMouseScroll,this),this._node.parent&&(b8e.evt.onMouseUp(this._node.parent,this.onParentMouseUp,this),b8e.evt.onMouseMove(this._node.parent,this.onParentMouseMove,this),b8e.evt.onMouseLeave(this._node.parent,this.onParentMouseLeave,this))):b8e.error("不支持鼠标事件")},onParentMouseUp:function(e){this._leftDownX=-1,this._leftDownY=-1,this._rightDownX=-1,this._rightDownY=-1;var t=e.getLocation();this._mouseX=t.x,this._mouseY=t.y;var i=e.getButton();i==cc.Event.EventMouse.BUTTON_LEFT?this._onLeftUp&&this._onLeftUp(t.x,t.y):i==cc.Event.EventMouse.BUTTON_RIGHT?this._onRightUp&&this._onRightUp(t.x,t.y):i==cc.Event.EventMouse.BUTTON_MIDDLE&&this._onMiddleUp&&this._onMiddleUp(t.x,t.y)},onParentMouseLeave:function(e){},onParentMouseMove:function(e){var t=e.getLocation();if(this.draggable){if(!this._onAcceptDragDrop||this._onAcceptDragDrop(t.x,t.y))if(-1<this._leftDownX&&-1<this._leftDownY){var i=t.x-this._leftDownX+this._downTargetX,n=t.y-this._leftDownY+this._downTargetY;this._posSetter?this._posSetter(i,n):(this._target.x=i,this._target.y=n)}else if(-1<this._rightDownX&&-1<this._rightDownY){i=t.x-this._rightDownX+this._downTargetX,n=t.y-this._rightDownY+this._downTargetY;this._posSetter?this._posSetter(i,n):(this._target.x=i,this._target.y=n)}}this._onMove&&this._onMove(t.x,t.y)},onMouseDown:function(e){this._leftDownX=-1,this._leftDownY=-1,this._rightDownX=-1,this._rightDownY=-1;var t=e.getLocation();this._mouseX=t.x,this._mouseY=t.y;var i=e.getButton();if(i==cc.Event.EventMouse.BUTTON_LEFT?(this.draggable&&(!this._onAcceptDragDrop||this._onAcceptDragDrop(t.x,t.y))&&(this._leftDownX=t.x,this._leftDownY=t.y),this._onLeftDown&&this._onLeftDown(t.x,t.y)):i==cc.Event.EventMouse.BUTTON_RIGHT?(this.draggable&&(!this._onAcceptDragDrop||this._onAcceptDragDrop(t.x,t.y))&&(this._rightDownX=t.x,this._rightDownY=t.y),this._onRightDown&&this._onRightDown(t.x,t.y)):i==cc.Event.EventMouse.BUTTON_MIDDLE&&this._onMiddleDown&&this._onMiddleDown(t.x,t.y),this._posGetter){var n=this._posGetter();this._downTargetX=n.x,this._downTargetY=n.y}else this._downTargetX=this._target.x,this._downTargetY=this._target.y},onMouseUp:function(e){this._leftDownX=-1,this._leftDownY=-1,this._rightDownX=-1,this._rightDownY=-1;var t=e.getLocation();this._mouseX=t.x,this._mouseY=t.y;var i=e.getButton();i==cc.Event.EventMouse.BUTTON_LEFT?this._onLeftUp&&this._onLeftUp(t.x,t.y):i==cc.Event.EventMouse.BUTTON_RIGHT?this._onRightUp&&this._onRightUp(t.x,t.y):i==cc.Event.EventMouse.BUTTON_MIDDLE&&this._onMiddleUp&&this._onMiddleUp(t.x,t.y)},onMouseLeave:function(e){},onMouseMove:function(e){var t=e.getLocation();if(this._mouseX=t.x,this._mouseY=t.y,this.draggable){if(!this._onAcceptDragDrop||this._onAcceptDragDrop(t.x,t.y))if(-1<this._leftDownX&&-1<this._leftDownY){var i=t.x-this._leftDownX+this._downTargetX,n=t.y-this._leftDownY+this._downTargetY;this._posSetter?this._posSetter(i,n):(this._target.x=i,this._target.y=n)}else if(-1<this._rightDownX&&-1<this._rightDownY){i=t.x-this._rightDownX+this._downTargetX,n=t.y-this._rightDownY+this._downTargetY;this._posSetter?this._posSetter(i,n):(this._target.x=i,this._target.y=n)}}this._onMove&&this._onMove(t.x,t.y)},onMouseScroll:function(e){cc.p(e.getScrollX(),e.getScrollY())},setPosGetter:function(e){this._posGetter=e},setPosSetter:function(e){this._posSetter=e},setAcceptDragDrop:function(e){this._onAcceptDragDrop=e},setOnMove:function(e){this._onMove=e},setLeftDown:function(e){this._onLeftDown=e},setLeftUp:function(e){this._onLeftUp=e},setRightDown:function(e){this._onRightDown=e},setRightUp:function(e){this._onRightUp=e},setMiddleDown:function(e){this._onMiddleDown=e},setMiddleUp:function(e){this._onMiddleUp=e},getMousePos:function(){return{x:this._mouseX,y:this._mouseY}},destroy:function(){this._node.parent&&(b8e.evt.offMouseUp(this._node.parent,this.onParentMouseUp,this),b8e.evt.offMouseMove(this._node.parent,this.onParentMouseMove,this),b8e.evt.offMouseLeave(this._node.parent,this.onParentMouseLeave,this)),b8e.evt.offMouseDown(this._node,this.onMouseDown,this),b8e.evt.offMouseUp(this._node,this.onMouseUp,this),b8e.evt.offMouseLeave(this._node,this.onMouseLeave,this),b8e.evt.offMouseMove(this._node,this.onMouseMove,this),b8e.evt.offMouseWheel(this._node,this.onMouseScroll,this),this._posGetter=null,this._posSetter=null,this._onMove=null,this._onLeftDown=null,this._onLeftUp=null,this._onRightDown=null,this._onRightUp=null,this._onMiddleDown=null,this._onMiddleUp=null,this._onAcceptDragDrop=null,this._node=null,this._target=null}})},{}],32:[function(e,t,i){var r="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},s=b8e.ProtoBuf;b8e.ProtobufMgr=b8e.Object.extends({ctor:function(){if(b8e.ProtobufMgr._singleton)throw new Error("只能通过getInstance()来获取ProtobufManager实例！");this._messages=b8e.HashMap.get()},loadProto:function(e,i){var n=this;b8e.res.loadRes(e,function(e,t){e?(b8e.error(e),i&&i(e)):(b8e.log("loadProto finish!"),n._builder=s.protoFromString(t),i&&i(null,n._builder))},this)},loadProtoFile:function(e,i){var n=this;s.loadProtoFile(e,function(e,t){e?(b8e.error("loadProtoFile failed!",e),i&&i(e)):(b8e.log("loadProtoFile complete!"),n._builder=t,i&&i(null,n._builder))})},buildClass:function(e){if(this._builder){var t=this._messages.getValue(e);return t||((t=this._builder.build(e))?(this._messages.setValue(e,t),b8e.log("build proto finish!",e)):b8e.error("build Message failed!")),t}return b8e.error("builder not init!"),null},decodeMessage:function(e,t){var i=this.buildClass(t);if(i){var n=e.buffer;return i.decode(n)}return null},buildMessage:function(e,n,s,a){var o=this;b8e.res.loadRes(e,function(e,t){if(e)b8e.error(e),s&&s.call(a,e);else if(b8e.log("buildMessage finish!",void 0===t?"undefined":r(t),t),s){var i=o.decodeMessage(t,n);s.call(a,null,i)}},this)}}),b8e.ProtobufMgr._instance=null,b8e.ProtobufMgr._singleton=!0,b8e.ProtobufMgr.inst=function(){return b8e.ProtobufMgr._instance||(b8e.ProtobufMgr._singleton=!1,b8e.ProtobufMgr._instance=new b8e.ProtobufMgr,b8e.ProtobufMgr._singleton=!0),b8e.ProtobufMgr._instance}},{}],33:[function(e,t,i){var n=b8e.MBits=function(){};n.INT_BITS=32,n.INT_MAX=2147483647,n.INT_MIN=-1<<n.INT_BITS-1,n.sign=function(e){return(0<e)-(e<0)},n.abs=function(e){var t=e>>n.INT_BITS-1;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(e<t)},n.max=function(e,t){return e^(e^t)&-(e<t)},n.isPow2=function(e){return!(e&e-1||!e)},n.log2=function(e){var t=void 0,i=void 0;return t=(65535<e)<<4,t|=i=(255<(e>>>=t))<<3,t|=i=(15<(e>>>=i))<<2,(t|=i=(3<(e>>>=i))<<1)|(e>>>=i)>>1},n.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},n.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},n.countTrailingZeros=function(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t},n.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var s=new Array(256);!function(e){for(var t=0;t<256;++t){var i=t,n=t,s=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=1&i,--s;e[t]=n<<s&255}}(s),n.reverse=function(e){return s[255&e]<<24|s[e>>>8&255]<<16|s[e>>>16&255]<<8|s[e>>>24&255]},n.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},n.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},n.interleave3=function(e,t,i){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},n.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n.countTrailingZeros(e)+1}},{}],34:[function(e,t,i){b8e.AIState=b8e.State.extends({ctor:function(e){this._super(e)},tribe:{get:function(){return"AIState"}}})},{}],35:[function(e,t,i){b8e.ActionState=b8e.RoleState.extends({_isFreeze:!1,_speedRatio:0,ctor:function(e){this._super(e)},tribe:{get:function(){return"ActionState"}},isFreeze:{get:function(){return this._isFreeze}},speedRatio:{get:function(){return this._speedRatio}},beforeEnter:function(){this._machine&&this._machine.usable&&(this._isFreeze=!1,this.syncSpeedRatio(1),this._super())},beforeExecute:function(e){this._machine&&this._machine.usable&&this._super(e)},pause:function(){this._super(),this.syncAnimation(!0,-1)},resume:function(){this._super(),this.syncAnimation(!1,-1)},afterExecute:function(){this._super()},syncAnimation:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;this._machine&&this._machine.usable&&(this._isFreeze=e,this._machine.owner.usable&&(this._machine.owner.forEachAnimator(this.eachPlayAnimation,this,[this._isFreeze,t,this._speedRatio]),this._ref instanceof b8e.RoleStateReference&&this._ref.syncAnimat()))},eachPlayAnimation:function(e,t,i,n,s){e&&t&&this.playAnimation(e,t,i,n,s)},playAnimation:function(e,t,i,n,s){},syncSpeedRatio:function(e){this._machine&&this._machine.usable&&(this._speedRatio=e,this._machine.owner.usable&&this._machine.owner.forEachAnimator(this.eachSetAnimationSpeed,this,[this._speedRatio]))},eachSetAnimationSpeed:function(e,t,i){e&&t&&this.setAnimationSpeed(e,t,i)},setAnimationSpeed:function(e,t,i){t.setSpeedRatio(i)},clear:function(){this._isFreeze=!1,this._speedRatio=0,this._super()}})},{}],36:[function(e,t,i){b8e.ControlState=b8e.RoleState.extends({ctor:function(e){this._super(e)},tribe:{get:function(){return"ControlState"}}})},{}],37:[function(e,t,i){b8e.RoleState=b8e.State.extends({ctor:function(e){this._super(e)},tribe:{get:function(){return"RoleState"}}})},{}],38:[function(e,t,i){b8e.RoleStateReference=b8e.StateReference.extends({_syncAnimatFunc:null,ctor:function(){this._super()},onSyncAnimat:function(e){return this._syncAnimatFunc=e,this},syncAnimat:function(){null!=this._syncAnimatFunc&&this._syncAnimatFunc(this)},clear:function(){this._syncAnimatFunc=null,this._super()}})},{}],39:[function(e,t,i){b8e.State=b8e.Object.extends({_type:0,_isRepeat:!1,_isPaused:!1,_isDisposed:!1,_machine:null,_ref:null,ctor:function(e){this._super(),"number"==typeof e?this._type=e:b8e.error("type必须是数字类型！")},init:function(e){this._machine=e},ref:{get:function(){return this._ref}},tribe:{get:function(){return"State"}},type:{get:function(){return this._type}},isRepeat:{get:function(){return this._isRepeat}},isPaused:{get:function(){return this._isPaused}},isDisposed:{get:function(){return this._isDisposed}},enterPass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!0},leavePass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!0},beforeEnter:function(){this._ref&&this._ref.beforeEnter()},enter:function(){this._ref&&this._ref.enter()},afterEnter:function(){this._ref&&this._ref.afterEnter()},beforeExecute:function(e){this._machine&&this._machine.usable&&(this._ref!=e&&this._ref&&this._ref.clear(),this._ref=e,this._ref&&this._ref.setOwner(this._machine.owner)),this._isPaused=!1,this._ref&&this._ref.beforeExecute()},execute:function(){this._ref&&this._ref.execute()},afterExecute:function(){this._ref&&this._ref.afterExecute(),this._isRepeat=!0},beforeLeave:function(){this._ref&&this._ref.beforeLeave()},leave:function(){this._ref&&this._ref.leave()},afterLeave:function(){this._ref&&this._ref.afterLeave(),this._isRepeat=!1},pause:function(){this._isPaused=!0,this._ref&&this._ref.pause()},resume:function(){this._isPaused=!1,this._ref&&this._ref.resume()},transition:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;this._machine&&this._machine.usable&&this._machine.transition(e,t,i,n,s)},getReference:function(e){return this._machine&&this._machine.usable?this._machine.getReference(e):null},removeSelf:function(){this._machine&&this._machine.usable&&this._machine.removeState(this._type)},clear:function(){b8e.Tween.kill(this),this._ref&&(this._ref.clear(),this._ref=null),this._machine=null,this._isRepeat=!1,this._isPaused=!1},dispose:function(){this.clear(),this._isDisposed=!0}})},{}],40:[function(e,t,i){b8e.StateMachine=b8e.Object.extends({_isRecycled:!1,_isDisposed:!1,ctor:function(e){this._owner=e,this._usePass=!0,this._isRecycled=!1,this._isDisposed=!1,this._states=b8e.HashMap.get(),this._refMap=b8e.HashMap.get(),this._currStates=b8e.HashMap.get()},transition:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];3<arguments.length&&void 0!==arguments[3]&&arguments[3],4<arguments.length&&void 0!==arguments[4]&&arguments[4];if(!this.usable)return!1;if(!this._owner||!this._owner.usable)return!1;var n=null,s=!1;if(!n&&0<e&&(s=!!(n=(n=this.extractState(e))?n.isDisposed?null:n:null)&&this.passTo(n.type,i)),n){var a=this._currStates.get(n.tribe);if(a=a?a.isDisposed?null:a:null,s){var o=!1;return(!a||a!=n&&a.tribe==n.tribe)&&(a&&a.beforeLeave(),n.beforeEnter(),a&&a.leave(),this._currStates.set(n.tribe,n),this.isDebug&&b8e.log("====================transition:",n.tribe,n.type),n.enter(),o=!0),n.beforeExecute(t),n.execute(),n.afterExecute(),o&&n.afterEnter(),a&&a.afterLeave(),!0}}return!1},passTo:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this.usable)return!1;if(!this._usePass)return!0;var i=this.extractState(e);if(!(i=i?i.isDisposed?null:i:null))return!1;var n=this._currStates.get(i.tribe),s=!(n=n?n.isDisposed?null:n:null)||n.leavePass(i,t),a=i.enterPass(n,t),o=s&&a;return this.isDebug&&!o&&b8e.log("====================no pass:",n?n.type:"",i.type),o},setStateMapping:function(e){this._stateMapping=e},removeState:function(e){if(this.usable){var t=this._states.get(e);t&&this._currStates.get(t.tribe)&&(t.beforeLeave(),t.leave(),this._currStates.del(t.tribe),t.afterLeave())}},createState:function(e){var t=null;this._stateMapping&&(t=this._stateMapping[e]);var i=null;if(t&&(i=new t),!i)throw new Error("不存在状态："+e);return i},extractState:function(e){if(!this.usable)return null;var t=null;return 0<e&&((t=this._states.get(e))||(t=this.createState(e),this._states.set(e,t)),t.init(this)),t},getCurrState:function(e){if(!this.usable)return null;var t=this._currStates.get(e);return t||null},getReference:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this._refMap)return null;t||(t=e);var i=this._refMap.get(t,this);return i||(i=new e,this._refMap.set(t,i,this)),i},owner:{get:function(){return this._owner}},usePass:{set:function(e){this._usePass=e}},usable:{get:function(){return!this._isRecycled&&!this._isDisposed}},isRecycled:{get:function(){return this._isRecycled}},isDisposed:{get:function(){return this._isDisposed}},clear:function(){this._refMap&&this._refMap.forEach(function(e,t){t.clear()},this),this._currStates&&(this._currStates.forEach(function(e,t){t.clear()},this),this._currStates.clear())},restore:function(e){this._isRecycled=!1,this._owner=e},recycle:function(){this.clear(),this._usePass=!0,this._owner=null,this._isRecycled=!0},dispose:function(){this._states&&(this._states.forEach(function(e,t){t.dispose()},this),this._states.release(),this._states=null),this._stateMapping=null,this._refMap&&(this._refMap.release(),this._refMap=null),this._currStates&&(this._currStates.release(),this._currStates=null),this._usePass=!1,this._isRecycled=!1,this._isDisposed=!0},destroy:function(){this.recycle(),this.dispose()}})},{}],41:[function(e,t,i){b8e.StateReference=b8e.Object.extends({ctor:function(){},owner:{get:function(){return this._owner}},setOwner:function(e){this._owner=e},onEnter:function(e,t,i){return this._enterCb=e?{func:e,thisArg:t,args:i}:null,this},onBeforeEnter:function(e,t,i){return this._beforeEnterCb=e?{func:e,thisArg:t,args:i}:null,this},onAfterEnter:function(e,t,i){return this._afterEnterCb=e?{func:e,thisArg:t,args:i}:null,this},onExecute:function(e,t,i){return this._executeCb=e?{func:e,thisArg:t,args:i}:null,this},onBeforeExecute:function(e,t,i){return this._beforeExecuteCb=e?{func:e,thisArg:t,args:i}:null,this},onAfterExecute:function(e,t,i){return this._afterExecuteCb=e?{func:e,thisArg:t,args:i}:null,this},onLeave:function(e,t,i){return this._leaveCb=e?{func:e,thisArg:t,args:i}:null,this},onBeforeLeave:function(e,t,i){return this._beforeLeaveCb=e?{func:e,thisArg:t,args:i}:null,this},onAfterLeave:function(e,t,i){return this._afterLeaveCb=e?{func:e,thisArg:t,args:i}:null,this},onPause:function(e,t,i){return this._pauseCb=e?{func:e,thisArg:t,args:i}:null,this},onResume:function(e,t,i){return this._resumeCb=e?{func:e,thisArg:t,args:i}:null,this},enter:function(){var e;this._enterCb&&(e=this._enterCb.args?this._enterCb.args.concat(this):[this],this._enterCb.func.apply(this._enterCb.thisArg,e))},beforeEnter:function(){var e;this._beforeEnterCb&&(e=this._beforeEnterCb.args?this._beforeEnterCb.args.concat(this):[this],this._beforeEnterCb.func.apply(this._beforeEnterCb.thisArg,e))},afterEnter:function(){var e;this._afterEnterCb&&(e=this._afterEnterCb.args?this._afterEnterCb.args.concat(this):[this],this._afterEnterCb.func.apply(this._afterEnterCb.thisArg,e))},execute:function(){var e;this._executeCb&&(e=this._executeCb.args?this._executeCb.args.concat(this):[this],this._executeCb.func.apply(this._executeCb.thisArg,e))},beforeExecute:function(){var e;this._beforeExecuteCb&&(e=this._beforeExecuteCb.args?this._beforeExecuteCb.args.concat(this):[this],this._beforeExecuteCb.func.apply(this._beforeExecuteCb.thisArg,e))},afterExecute:function(){var e;this._afterExecuteCb&&(e=this._afterExecuteCb.args?this._afterExecuteCb.args.concat(this):[this],this._afterExecuteCb.func.apply(this._afterExecuteCb.thisArg,e))},leave:function(){var e;this._leaveCb&&(e=this._leaveCb.args?this._leaveCb.args.concat(this):[this],this._leaveCb.func.apply(this._leaveCb.thisArg,e))},beforeLeave:function(){var e;this._beforeLeaveCb&&(e=this._beforeLeaveCb.args?this._beforeLeaveCb.args.concat(this):[this],this._beforeLeaveCb.func.apply(this._beforeLeaveCb.thisArg,e))},afterLeave:function(){var e;this._afterLeaveCb&&(e=this._afterLeaveCb.args?this._afterLeaveCb.args.concat(this):[this],this._afterLeaveCb.func.apply(this._afterLeaveCb.thisArg,e))},pause:function(){var e;this._pauseCb&&(e=this._pauseCb.args?this._pauseCb.args.concat(this):[this],this._pauseCb.func.apply(this._pauseCb.thisArg,e))},resume:function(){var e;this._resumeCb&&(e=this._resumeCb.args?this._resumeCb.args.concat(this):[this],this._resumeCb.func.apply(this._resumeCb.thisArg,e))},clear:function(){this._beforeEnterCb=null,this._enterCb=null,this._afterEnterCb=null,this._beforeExecuteCb=null,this._executeCb=null,this._afterExecuteCb=null,this._beforeLeaveCb=null,this._leaveCb=null,this._afterLeaveCb=null,this._pauseCb=null,this._resumeCb=null,this.data=null,this._owner=null}})},{}],42:[function(e,t,i){b8e.Binary64=b8e.Object.extends({low:0,_internalHigh:0,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.low=e,this._internalHigh=t},div:function(e){var t=this._internalHigh%e,i=(this.low%e+6*t)%e;this._internalHigh=this._internalHigh/e;var n=(4294967296*t+this.low)/e;return this._internalHigh=this._internalHigh+n/4294967296>>0,this.low=n,i},mul:function(e){var t=this.low*e;this._internalHigh=this._internalHigh*e,this._internalHigh=this._internalHigh+t/4294967296>>0,this.low=this.low*e},add:function(e){var t=this.low+e;this._internalHigh=this._internalHigh+t/4294967296>>0,this.low=t},bitwiseNot:function(){this.low=~this.low,this._internalHigh=~this._internalHigh}})},{}],43:[function(e,t,i){b8e.Int64=b8e.Binary64.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t)},high:{set:function(e){this.internalHigh=e},get:function(){return this.internalHigh}},toNumber:function(){return 4294967296*this.high+this.low},toString:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(t<2||36<t)throw new Error;switch(this.high){case 0:return this.low.toString(t);case-1:return(this.low>>0).toString(t)}if(0==this.low&&0==this.high)return"0";var i=[],n=new b8e.UInt64(this.low,this.high);for(this.high<0&&(n.bitwiseNot(),n.add(1));e=n.div(t),i.push((e<10?"0":"a").charCodeAt(0)+e),0!=n.high;);return this.high<0?"-"+n.low.toString(t)+String.fromCharCode.apply(String,i.reverse()):n.low.toString(t)+String.fromCharCode.apply(String,i.reverse())}}),b8e.Int64.fromNumber=function(e){return new b8e.Int64(e,e/4294967296>>0)},b8e.Int64.parseInt64=function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=0==e.search(/^\-/),s=n?1:0;if(0==i&&(0==e.search(/^\-?0x/)?(i=16,s+=2):i=10),i<2||36<i)throw new Error;e=e.toLowerCase();for(var a=new b8e.Int64;s<e.length;){if((t=e.charCodeAt(s))>="0".charCodeAt(0)&&t<="9".charCodeAt(0))t-="0".charCodeAt(0);else{if(!(t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)))throw new Error;t-="a".charCodeAt(0)}if(i<=t)throw new Error;a.mul(i),a.add(t),s++}return n&&(a.bitwiseNot(),a.add(1)),a}},{}],44:[function(e,t,i){b8e.LinkedArray=b8e.Object.extends({ctor:function(){this._super(),this._count=0,this._head=null,this._tail=null},head:{get:function(){return this._head}},tail:{get:function(){return this._tail}},length:{get:function(){for(var e=this._head,t=0;e;)t++,e=e._next;return t}},add:function(e){this._tail?(this._tail._next=e)._prev=this._tail:this._head=e,this._tail=e,this._count+=1},remove:function(e){for(var t=this._head,i=t;t;){if(i=t._next,t===e){e._prev?e._prev._next=e._next:this._head=e._next,e._next?e._next._prev=e._prev:this._tail=e._prev,e._next=null,e._prev=null;break}t=i}this._count-=1},forEach:function(e,t){var i=this._head;if(i){t&&(e=e.bind(t));for(var n=0,s=i;i;)s=i._next,e(i,n,this),i=s,++n}}})},{}],45:[function(e,t,i){b8e.ReadUtil=function(){},b8e.ReadUtil.skip=function(e,t){var i;switch(t){case WireType.VARINT:do{}while(128<=e.readUnsignedByte());break;case WireType.FIXED_64_BIT:e.readInt(),e.readInt();break;case WireType.LENGTH_DELIMITED:for(i=b8e.ReadUtil.read$TYPE_UINT32(e);0!=i;)e.readByte(),i--;break;case WireType.FIXED_32_BIT:e.readInt();break;default:throw new Error("Invalid wire type: "+t)}},b8e.ReadUtil.read$TYPE_DOUBLE=function(e){return e.readDouble()},b8e.ReadUtil.read$TYPE_FLOAT=function(e){return e.readFloat()},b8e.ReadUtil.read$TYPE_INT64=function(e){for(var t,i,n=new b8e.Int64;t=e.readUnsignedByte(),28!=i;){if(!(128<=t))return n.low=n.low|t<<i,n;n.low=n.low|(127&t)<<i,i+=7}if(!(128<=t))return n.low=n.low|t<<i,n.high=t>>>4,n;for(t&=127,n.low=n.low|t<<i,n.high=t>>>4,i=3;;){if(t=e.readUnsignedByte(),i<32){if(!(128<=t)){n.high=n.high|t<<i;break}n.high=n.high|(127&t)<<i}i+=7}return n},b8e.ReadUtil.read$TYPE_UINT64=function(e){for(var t,i,n=new b8e.UInt64;t=e.readUnsignedByte(),28!=i;){if(!(128<=t))return n.low=n.low|t<<i,n;n.low=n.low|(127&t)<<i,i+=7}if(!(128<=t))return n.low=n.low|t<<i,n.high=t>>>4,n;for(t&=127,n.low=n.low|t<<i,n.high=t>>>4,i=3;;){if(t=e.readUnsignedByte(),i<32){if(!(128<=t)){n.high=n.high|t<<i;break}n.high=n.high|(127&t)<<i}i+=7}return n},b8e.ReadUtil.read$TYPE_INT32=function(e){return b8e.ReadUtil.read$TYPE_UINT32(e)>>0},b8e.ReadUtil.read$TYPE_FIXED64=function(e){var t=new b8e.UInt64;return t.low=e.readUnsignedInt(),t.high=e.readUnsignedInt(),t},b8e.ReadUtil.read$TYPE_FIXED32=function(e){return e.readUnsignedInt()},b8e.ReadUtil.read$TYPE_BOOL=function(e){return!(0==b8e.ReadUtil.read$TYPE_UINT32(e))},b8e.ReadUtil.read$TYPE_STRING=function(e){var t=b8e.ReadUtil.read$TYPE_UINT32(e);return e.readUTFBytes(t)},b8e.ReadUtil.read$TYPE_BYTES=function(e){var t=new b8e.ByteArray,i=b8e.ReadUtil.read$TYPE_UINT32(e);return 0<i&&e.readBytes(t,0,i),t},b8e.ReadUtil.read$TYPE_UINT32=function(e){for(var t,i,n;;){if(t=e.readUnsignedByte(),!(n<32)){do{}while(128<=e.readUnsignedByte());break}if(!(128<=t)){i|=t<<n;break}i|=(127&t)<<n,n+=7}return i},b8e.ReadUtil.read$TYPE_ENUM=function(e){return b8e.ReadUtil.read$TYPE_INT32(e)},b8e.ReadUtil.read$TYPE_SFIXED32=function(e){return e.readInt()},b8e.ReadUtil.read$TYPE_SFIXED64=function(e){var t=new b8e.Int64;return t.low=e.readUnsignedInt(),t.high=e.readInt(),t}},{}],46:[function(e,t,i){b8e.UInt64=b8e.Binary64.extends({ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t)},high:{set:function(e){this.internalHigh=e},get:function(){return this.internalHigh}},toNumber:function(){return 4294967296*this.high+this.low},toString:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(t<2||36<t)throw new Error;if(0==this.high)return this.low.toString(t);for(var i=[],n=new b8e.UInt64(this.low,this.high);e=n.div(t),i.push((e<10?"0":"a").charCodeAt(0)+e),0!=n.high;);return n.low.toString(t)+String.fromCharCode.apply(String,i.reverse())}}),b8e.UInt64.fromNumber=function(e){return new b8e.UInt64(e,e/4294967296>>0)},b8e.UInt64.parseUInt64=function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(0==n&&(0==e.search(/^0x/)?(n=16,i=2):n=10),n<2||36<n)throw new Error;e=e.toLowerCase();for(var s=new b8e.UInt64;i<e.length;){if((t=e.charCodeAt(i))>="0".charCodeAt(0)&&t<="9".charCodeAt(0))t-="0".charCodeAt(0);else{if(!(t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)))throw new Error;t-="a".charCodeAt(0)}if(n<=t)throw new Error;s.mul(n),s.add(t),i++}return s}},{}],47:[function(e,t,i){b8e.WireType=function(){},b8e.WireType.VARINT=0,b8e.WireType.FIXED_64_BIT=1,b8e.WireType.LENGTH_DELIMITED=2,b8e.WireType.FIXED_32_BIT=5},{}],48:[function(e,t,i){b8e.WriteUtil=function(){},b8e.WriteUtil.writeSingleUnknown=function(e,t,i){switch(b8e.WriteUtils.write$TYPE_UINT32(e,t),7&t){case b8e.WireType.VARINT:b8e.WriteUtils.write$TYPE_UINT64(e,i);break;case b8e.WireType.FIXED_64_BIT:b8e.WriteUtils.write$TYPE_FIXED64(e,i);break;case b8e.WireType.LENGTH_DELIMITED:b8e.WriteUtils.write$TYPE_BYTES(e,i);break;case b8e.WireType.FIXED_32_BIT:b8e.WriteUtils.write$TYPE_FIXED32(e,i);break;default:throw new Error("Invalid wire type: "+(7&t))}},b8e.WriteUtil.writeUnknownPair=function(t,i,e){e?e.forEach(function(e){b8e.WriteUtil.writeSingleUnknown(t,i,e)}):b8e.WriteUtil.writeSingleUnknown(t,i,e)},b8e.WriteUtil.writeVarint64=function(e,t,i){var n;if(0==i)b8e.WriteUtil.write$TYPE_UINT32(e,t);else{for(n=0;n<4;)e.writeByte(127&t|128),t>>>=7,n++;0==(2147483640&i)?e.writeByte(i<<4|t):(e.writeByte(127&(i<<4|t)|128),b8e.WriteUtil.write$TYPE_UINT32(e,i>>>3))}},b8e.WriteUtil.writeTag=function(e,t,i){b8e.WriteUtil.write$TYPE_UINT32(e,i<<3|t)},b8e.WriteUtil.write$TYPE_DOUBLE=function(e,t){e.writeDouble(t)},b8e.WriteUtil.write$TYPE_FLOAT=function(e,t){e.writeFloat(t)},b8e.WriteUtil.write$TYPE_INT64=function(e,t){b8e.WriteUtil.writeVarint64(e,t.low,t.high)},b8e.WriteUtil.write$TYPE_UINT64=function(e,t){b8e.WriteUtil.writeVarint64(e,t.low,t.high)},b8e.WriteUtil.write$TYPE_INT32=function(e,t){t<0?b8e.WriteUtil.writeVarint64(e,t,4294967295):b8e.WriteUtil.write$TYPE_UINT32(e,t)},b8e.WriteUtil.write$TYPE_FIXED64=function(e,t){e.writeUnsignedInt(t.low),e.writeUnsignedInt(t.high)},b8e.WriteUtil.write$TYPE_FIXED32=function(e,t){e.writeUnsignedInt(t)},b8e.WriteUtil.write$TYPE_BOOL=function(e,t){e.writeByte(t?1:0)},b8e.WriteUtil.write$TYPE_STRING=function(e,t){var i=e.beginBlock();e.writeUTFBytes(t),e.endBlock(i)},b8e.WriteUtil.write$TYPE_BYTES=function(e,t){b8e.WriteUtil.write$TYPE_UINT32(e,t.length),e.writeBytes(t)},b8e.WriteUtil.write$TYPE_UINT32=function(e,t){for(;;){if(t<128)return void e.writeByte(t);e.writeByte(127&t|128),t>>>=7}},b8e.WriteUtil.write$TYPE_ENUM=function(e,t){b8e.WriteUtil.write$TYPE_INT32(e,t)},b8e.WriteUtil.write$TYPE_SFIXED32=function(e,t){e.writeInt(t)},b8e.WriteUtil.write$TYPE_SFIXED64=function(e,t){e.writeUnsignedInt(t.low),e.writeInt(t.high)}},{}],49:[function(e,t,i){b8e.WritingBuffer=b8e.ByteArray.extends({slices:null,ctor:function(e){this._super(e),this.endian=b8e.Endian.LITTLE_ENDIAN,this.slices=[]},beginBlock:function(){this.slices.push(this.position);var e=this.slices.length;return this.slices.length=this.slices.length+2,this.slices.push(this.position),e},endBlock:function(e){this.slices.push(this.position);var t=this.slices[e+2];this.slices[e]=this.position,WriteUtils.write$TYPE_UINT32(this,this.position-t),this.slices[e+1]=this.position,this.slices.push(this.position)},toNormal:function(e){for(var t,i,n;i<this.slices.length;){if(t=this.slices[i],i++,n<t)e.writeBytes(this,n,t-n);else if(t<n)throw new Error;n=this.slices[i],i++}e.writeBytes(this,n)}})},{}],50:[function(e,t,i){b8e.ArrayUtil=function(){},b8e.ArrayUtil.getRectangularSpiralArray=function(i,n,s,a,o,r){a=Math.ceil(a);var h,e,t,g=[],l=[];for(e=0;e<=a;e++){for(t=-e;t<=e;t++)c(t,-e);for(t=-e;t<=e;t++)c(e,t);for(t=e;-e<=t;t--)c(t,e);for(t=e;-e<=t;t--)c(-e,t)}function c(e,t){h=b8e.CommonUtil.xyToInt(a+e,a+t),l.indexOf(h)<0&&(null==o||!o.call(i,n,s,e,t))&&(g.push([e,t]),l.push(h),null!=r&&r.call(i,n,s,e,t))}return g}},{}],51:[function(e,t,i){var n=b8e.DelegateUtil=function(){};n.create=function(t,i,n){if(!i)throw"没有可代理的函数.";return function(){var e=Array.prototype.slice.call(arguments);i.apply(t,n?e.concat(n):e),t=null}},n.createExOrgParams=function(e,t,i){if(!t)throw"没有可代理的函数.";return function(){t.apply(e,i)}}},{}],52:[function(e,t,i){var r=b8e.MathUtil=function(){};r.TWO_PI=2*Math.PI,r.limitIn=function(e,t,i){return e<t?t:i<e?i:e},r.atan2=function(e,t){var i;return i=0==e?Math.PI/2:0<e?Math.atan(Math.abs(t/e)):Math.PI-Math.atan(Math.abs(t/e)),0<=t?i:-i},r.sum=function(e){var t=0;return e.forEach(function(e){t+=e},this),t},r.avg=function(e){return r.sum(e)/e.length},r.max=function(e){for(var t=NaN,i=0;i<e.length;i++)(isNaN(t)||e[i]>t)&&(t=e[i]);return t},r.min=function(e){for(var t=NaN,i=0;i<e.length;i++)(isNaN(t)||e[i]<t)&&(t=e[i]);return t},r.shortRotation=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2]?2*Math.PI:360,n=(t-e)%i;return n!=n%(i/2)&&(n=n<0?n+i:n-i),n},r.getDegree=function(e,t,i,n){var s=i-e,a=n-t,o=57.33*Math.atan2(a,s);return o%=360},r.getRadian=function(e,t,i,n){var s=i-e,a=n-t;return Math.atan2(a,s)},r.getDistance=function(e,t,i,n){return Math.sqrt((e-i)*(e-i)+(t-n)*(t-n))},r.getDistanceNoSqrt=function(e,t,i,n){return(e-i)*(e-i)+(t-n)*(t-n)},r.degreeToRadian=function(e){return.0175*e},r.radianToDegree=function(e){return r.normalDegree(e*(180/Math.PI))},r.normalDegree=function(e){return(e+360)%360},r.sind=function(e){return Math.sin(r.degreeToRadian(e))},r.cosd=function(e){return Math.cos(r.degreeToRadian(e))},r.tand=function(e){return Math.tan(r.degreeToRadian(e))},r.asind=function(e){return r.radianToDegree(Math.acos(e))},r.acosd=function(e){return r.radianToDegree(Math.acos(e))},r.atand=function(e){return r.radianToDegree(Math.acos(e))},r.atan2d=function(e,t){return r.radianToDegree(Math.atan2(e,t))},r.getDxByRadian=function(e,t){return Math.cos(t)*e},r.getDyByRadian=function(e,t){return Math.sin(t)*e},r.getDxByAngle=function(e,t){return r.cosd(t)*e},r.getDyByAngle=function(e,t){return r.sind(t)*e},r.clamp=function(e,t,i){return i<e?e:t<i?t:i},r.clockwiseSortPoints=function(e){var t=r.getPolygonCenter(e);return e.sort(r._pointCmp),t},r._pointCmp=function(e,t){if(0<=e.x&&t.x<0)return 1;if(0==e.x&&0==t.x)return e.y>t.y?1:e.y<t.y?-1:0;var i=(e.x-center.x)*(t.y-center.y)-(t.x-center.x)*(e.y-center.y);if(i<0)return 1;if(0<i)return-1;var n=(e.x-center.x)*(e.x-center.x)+(e.y-center.y)*(e.y-center.y),s=(t.x-center.x)*(t.x-center.y)+(t.y-center.y)*(t.y-center.y);return s<n?1:n<s?-1:0},r.getPolygonCenter=function(e){for(var t={x:0,y:0},i=0,n=0,s=e.length,a=0;a<s;a++){var o=e[a];i+=o.x,n+=o.y}return t.x=i/s>>0,t.y=n/s>>0,t},r.extendPolygon=function(e,a){var o=r.getPolygonCenter(e);e.forEach(function(e){var t=r.getDistance(o.x,o.y,e.x,e.y)+a,i=r.getDegree(o.x,o.y,e.x,e.y),n=r.getDxByAngle(t,i),s=r.getDyByAngle(t,i);e.x=o.x+n,e.y=o.y+s},this)},r.getDegreePos=function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=i/180*Math.PI;return r.getRadianPos(e,t,a,n,s)},r.getRadianPos=function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=s||{x:0,y:0};return a.x=e+n*Math.cos(i),a.y=t+n*Math.sin(i),a},r.getSpaceDistance=function(e,t,i,n,s){if(s<=0)return{x:e,y:t};if(r.getDistance(e,t,i,n)<s)return{x:i,y:n};var a=r.getRadian(e,t,i,n);return r.getRadianPos(e,t,a,s)},r.isPowerOfTwo=function(e){return 0<e&&!(e&e-1)},r.random=function(e,t){return Math.random()*(t-e)+e}},{}],53:[function(e,t,i){var o=b8e.ShaderUtil=function(){};o.defaultShader=null,o.grayShader=null,o.setGray=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(b8e.renderType===b8e.RenderType.WEBGL){if(!o.grayShader){var i=new b8e.ShaderProgram;i.setIsMix(!0),i.getColorTransfrom().setMultiplier([.2126,.7152,.0722,1]),i.update(!0),b8e.ShaderProgram.applyGlProgram(i),o.grayShader=i}o.setShader(e,o.grayShader.glProgram,t)}},o.reset=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(b8e.renderType===b8e.RenderType.WEBGL){if(!o.defaultShader){var i=new b8e.ShaderProgram;i.update(!0),b8e.ShaderProgram.applyGlProgram(i),o.defaultShader=i}o.setShader(e,o.defaultShader.glProgram,t)}},o.setShader=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];t&&e&&(e instanceof cc.Node||(e=e instanceof cc.Sprite?e.node:e instanceof b8e.BaseDisplay?e.getNode():null),e&&o.setChildShader(e,t,i))},o.setChildShader=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(t&&e){var n=e.getComponent(cc.Sprite);if(n&&n._sgNode.setShaderProgram(t),i)for(var s=0,a=e._children.length;s<a;s++)o.setChildShader(e._children[s],t)}}},{}]},{},[1,3,4,5,6,7,8,9,10,11,12,13,18,19,20,21,22,23,24,25,26,27,28,14,15,16,17,29,30,31,32,33,2,35,34,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53])},{}],3:[function(e,t,i){"use strict";e("../../../black8_game_engine_extension"),game.MODULE_VERSION="2.0.9",game.GameModule=b8e.Object.extends({ctor:function(){},init:function(){if(game.VERSION==game.MODULE_VERSION)if(game.mainProcess)game.mainProcess.runProcess();else{b8e.startup.initMainScene(),game.ShortNameMgr.inst().setup(),game.initApp();var e=new game.MainProcessRun;(game.mainProcess=e).initProcess(),e.runProcess()}else b8e.Toast.launch("Game Version和Module Version版本不一致，请检查！\nGame:V"+game.VERSION+" & Module:V"+game.MODULE_VERSION,4294901760,0)}})},{"../../../black8_game_engine_extension":2}],4:[function(e,t,i){"use strict";e("./appcode/appcodeIndex_0")},{"./appcode/appcodeIndex_0":1060}],5:[function(e,t,i){"use strict";e("./cmdlistener/AmuletCmd"),e("./event/AmuletEvent"),e("./manager/AmuletMgr"),e("./panel/AmuletPanel"),e("./sender/AmuletSender")},{"./cmdlistener/AmuletCmd":6,"./event/AmuletEvent":7,"./manager/AmuletMgr":8,"./panel/AmuletPanel":9,"./sender/AmuletSender":10}],6:[function(e,t,i){"use strict";game.AmuletCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Amulet.QryAmuletModuleResponse,this.onQryAmuletModuleResponse,this),b8e.addNH(game.pbmid.Amulet.UpgradeAmuletResponse,this.onUpgradeAmuletResponse,this)},onQryAmuletModuleResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryAmuletModuleResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.amulet.setUpamuletModule(t)}else b8e.log("")},onUpgradeAmuletResponse:function(e){var t=e.readProtobuf(game.pbmsg.UpgradeAmuletResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.amulet.upgradeAmulet(t)}else b8e.log("")}})},{}],7:[function(e,t,i){"use strict";game.AmuletEvent=b8e.Enum({UPDATE_AMULETPANEL:b8e.Event.nextCode(),PLAY_UPGRADESTAR_EFFECT:b8e.Event.nextCode(),PLAY_UPGRADESTATE_EFFECT:b8e.Event.nextCode()})},{}],8:[function(e,t,i){"use strict";game.AmuletMgr=b8e.Object.extends({_amuletLevel:0,_amuletstate:1,_isreqAmuletModule:!1,ctor:function(){if(1==game.AmuletMgr._singleton)throw new Error("GuildMgr 只能通过单例方法获取")},reqAmuletModule:function(){this._isreqAmuletModule||(game.AmuletSender.reqAmuletModule(),this._isreqAmuletModule=!0)},setUpamuletModule:function(e){this._amuletLevel=e.level,this._amuletstate=this.getStageByLv(this._amuletLevel)},reqUpgrade:function(){game.AmuletSender.reqUpgradeAmulet()},upgradeAmulet:function(e){this._amuletLevel=e.level,game.notice.show("升星成功");var t=this.getStageByLv(this._amuletLevel);this._amuletstate!=t?(this._amuletstate=t,b8e.evt.dptG(game.AmuletEvent.PLAY_UPGRADESTATE_EFFECT)):b8e.evt.dptG(game.AmuletEvent.PLAY_UPGRADESTAR_EFFECT),b8e.evt.dptG(game.AmuletEvent.UPDATE_AMULETPANEL)},getAmuletLevel:function(){return this._amuletLevel},getStarByLv:function(e){if(0==e)return 0;var t=e%10;return 0==t?10:t},getStageByLv:function(e){return 0==e?1:game.ccfg.AmuletCfg.getAmuletStateByLevel(e)},getAmuletNameByLevel:function(e){var t="";0==e&&(e=1);t=game.ccfg.AmuletCfg.getAmuletNameByLevel(e);return t+=this.getStageByLv(e)+"阶"},getDetailNameByLevel:function(e){var t="";0==e&&(e=1);t=game.ccfg.AmuletCfg.getAmuletNameByLevel(e);return t+=this.getStageByLv(e)+"阶"+this.getStarByLv(e)+"星"},getAmuletAtk:function(e){var t=game.ccfg.AmuletCfg.getAmuletAttrByLevel(e),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=game.mainRole.mainRoleData.getLv();return game.CCommonUtil.getPower(i,n)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.AMULET_ALERT,null,this.amuletAlert,this)},amuletAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.AMULET)){var e=this.getAmuletLevel(),t=game.ccfg.AmuletCfg.getAmuletReputationByLevel(e+1);if(!t)return!1;if(t<=game.back.getAmountInfo().getValue(game.AmountType.POPULARITY))return!0}return!1}}),game.AmuletMgr._instance=null,game.AmuletMgr._singleton=!0,game.AmuletMgr.inst=function(){return null==game.AmuletMgr._instance&&(game.AmuletMgr._singleton=!1,game.AmuletMgr._instance=new game.AmuletMgr,game.AmuletMgr._singleton=!0),game.AmuletMgr._instance}},{}],9:[function(e,t,n){"use strict";game.appModule.AmuletPanel=game.SkinUIPanel.extends({_stars:null,isCanUpgrade:!1,isMaxLevel:!1,iconBg:null,amuletIcon:null,_effect:null,_anim:null,_effect_1:null,_anim_1:null,ctor:function(e){this._super(e)},init:function(){if(!this._stars){this._stars=[];for(var e=0;e<10;e++){var t=new game.AccessoryStarItem;this._stars.push(t),t.addToParent(this._skin.startNode)}}},onShow:function(){this.updatePanel(),b8e.evt.addG(this,game.AmuletEvent.UPDATE_AMULETPANEL,this.updatePanel),b8e.evt.addG(this,game.AmuletEvent.PLAY_UPGRADESTAR_EFFECT,this.playUpgradeEffect),b8e.evt.addG(this,game.AmuletEvent.PLAY_UPGRADESTATE_EFFECT,this.playBigUpgradeEffect),b8e.evt.onC(this._skin.upgradeBtn,this.onUpgradeBtnClick,this)},onHide:function(){b8e.evt.rmvG(this,game.AmuletEvent.UPDATE_AMULETPANEL,this.updatePanel),b8e.evt.rmvG(this,game.AmuletEvent.PLAY_UPGRADESTAR_EFFECT,this.playUpgradeEffect),b8e.evt.rmvG(this,game.AmuletEvent.PLAY_UPGRADESTATE_EFFECT,this.playBigUpgradeEffect),b8e.evt.offC(this._skin.upgradeBtn,this.onUpgradeBtnClick,this),this._anim&&this._anim.clear(),this._anim_1&&this._anim_1.clear()},updatePanel:function(){var e=game.amulet.getAmuletLevel(),t=game.amulet.getAmuletNameByLevel(e),n=(game.amulet.getStageByLv(e),game.amulet.getStarByLv(e)),s=game.ccfg.AmuletCfg.getAmuletAttrByLevel(e),a=game.amulet.getAmuletAtk(e),o=game.ccfg.AmuletCfg.getnextAmuletAttrByLevel(e+1),r=game.ccfg.AmuletCfg.getResIndexByLevel(e),h=game.ccfg.AmuletCfg.getAmuletReputationByLevel(e+1),g=game.back.getAmountInfo().getValue(game.AmountType.POPULARITY);for(this.isCanUpgrade=h<=g,this.isMaxLevel=!(0<o),this._skin.atkLabel.string=a,this._skin.amuletName.string=t,this.iconBg||(this.iconBg=b8e.Sprite.get(),this.iconBg.setAnchor(.5,.5),this.iconBg.addToParent(this._skin.amuletIcon),this.iconBg.loadTexture("images/image/amuletimage/amuletBg.jpg",null,null,{useManifest:!1})),this.amuletIcon||(this.amuletIcon=b8e.Sprite.get(),this.amuletIcon.setAnchor(.5,.5),this.amuletIcon.addToParent(this._skin.amuletIcon)),this.amuletIcon.loadTexture(game.ClientCfg.getAmuletIcon(r),null,null,{useManifest:!1}),i=0;i<10;i++){var l=this._stars[i];l.show(),l.isLight(i<n)}if(this.isMaxLevel)return this._skin.normalNode.active=!1,this._skin.maxLevelNode.active=!0,void(this._skin.atrrdesc.string=this.getSpriteStatStr(s,0));this._skin.normalNode.active=!0,this._skin.maxLevelNode.active=!1,this._skin.atrrdesc.string=0==e?this.getSpriteStatStr(0,o):this.getSpriteStatStr(s,o),this._skin.costShengWu.string="<color=#00ff00></c><color=#FFFFFF>"+h+"</color>",this.isCanUpgrade?this._skin.selfShengWu.string="<color=#00ff00></c><color=#74D610>"+g+"</color>":this._skin.selfShengWu.string="<color=#00ff00></c><color=#DD3333>"+g+"</color>",this._skin.redIcon.active=this.isCanUpgrade},onUpgradeBtnClick:function(){if(this.isCanUpgrade)game.amulet.reqUpgrade();else{var e=game.back.getAmountInfo().getValue(game.AmountType.POPULARITY),t=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.POPULARITY);t&&""!=t.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:t,num:e})}},getSpriteStatStr:function(e,t){var i=null;e&&(i=game.ccfg.SpriteStatCfg.getSpriteStatById(e));var n=null;t&&(n=game.ccfg.SpriteStatCfg.getSpriteStatById(t));var s,a,o,r="",h="",g="";o=i?i.getSpriteStats():n.getSpriteStats();var l=null;if(n&&(l=n.getSpriteStats()),o&&0<o.length)for(s=0;s<o.length;s++)if(a=o[s]){h=game.ccfg.AttrRulesCfg.getAttrNameByType(a.type),g=s!=o.length-1?"<br/></c>":"</color>";var c=0;i&&(c=a.value);var u="";if(l)u="(+"+(l[s].value-c)+")";r+="<color=#E7D7A7>"+h+":</c><color=#FFFFFF>         "+c+"</c><color=#74D610>         "+u+g}return r},playUpgradeEffect:function(){var e=game.ClientCfg.getUIFxs("10012");this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effctnode)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.AMULET_UPGRADE_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._effect.setVisible(!1)},playBigUpgradeEffect:function(){var e=game.ClientCfg.getUIFxs("10074");this._effect_1||(this._effect_1=b8e.BaseDisplay.get(),this._effect_1.addToParent(this._skin.upgradenode)),e?(this._anim_1||(this._anim_1=b8e.Animator.get(game.AnimatorType.AMULET_BIGUPFRADE_EFFECT,1),this._effect_1.addChild(this._anim_1)),this._effect_1.setVisible(!0),this._anim_1.load(e),this._anim_1.addFinishCallback(this.onCompleteOtherBigEffect,this),this._anim_1.play(null,0)):this._anim_1&&this._anim_1.clear()},onCompleteOtherBigEffect:function(){this._effect_1.setVisible(!1)}})},{}],10:[function(e,t,i){"use strict";game.AmuletSender={},game.AmuletSender.reqAmuletModule=function(){var e=game.pbmid.Amulet.QryAmuletModuleRequest;b8e.sendN(e)},game.AmuletSender.reqUpgradeAmulet=function(){var e=game.pbmid.Amulet.UpgradeAmuletRequest;b8e.sendN(e)}},{}],11:[function(e,t,i){"use strict";game.appModule.AnnouncementPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this.updataArticle()},onHide:function(){},updataArticle:function(){var t=[],e=game.LoginConfig.zoneAnnouncementContents;if(e){e.forEach(function(e){t.push(e.content)},this);var i=t.join("<br/>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<br/>");this._skin.lab_content.string=i}}})},{}],12:[function(e,t,i){"use strict";e("./event/AccessoryEvent"),e("./sender/AccessorySender"),e("./manager/AccessoryMgr"),e("./cmd/AccessoryCmd"),e("./panel/AccessoryPanel"),e("./panel/AccessoryUpgradePanel"),e("./panel/AccessoryStarItem")},{"./cmd/AccessoryCmd":13,"./event/AccessoryEvent":14,"./manager/AccessoryMgr":15,"./panel/AccessoryPanel":16,"./panel/AccessoryStarItem":25,"./panel/AccessoryUpgradePanel":27,"./sender/AccessorySender":28}],13:[function(e,t,i){"use strict";game.AccessoryCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Accessory.QryAccessoryResponse,this.onQryAccessoryResponse,this),b8e.addNH(game.pbmid.Accessory.AddExpForAccessoryResponse,this.onAddExpForAccessoryResponse,this),b8e.addNH(game.pbmid.Accessory.WearAccessoryResponse,this.onWearAccessoryResponse,this),b8e.addNH(game.pbmid.Accessory.TakeOffAccessoryResponse,this.onTakeOffAccessoryResponse,this),b8e.addNH(game.pbmid.Accessory.AccessoryExpResetNotify,this.onAccessoryExpResetNotify,this),b8e.addNH(game.pbmid.Accessory.LearnSkillResponse,this.onLearnSkillResponse,this),b8e.addNH(game.pbmid.Accessory.ConvertSkillResponse,this.onConvertSkillResponse,this)},onQryAccessoryResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryAccessoryResponse);t&&(0==t.code?game.AccessoryMgr.getMgrByType(t.type).setup(t):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)))},onAddExpForAccessoryResponse:function(e){var t=e.readProtobuf(game.pbmsg.AddExpForAccessoryResponse);if(t){if(0!=t.code)return game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),void game.AccessoryMgr.stopAutoSend();game.AccessoryMgr.getMgrByType(t.type).addExpForAccessoryComplete(t)}},onWearAccessoryResponse:function(e){var t=e.readProtobuf(game.pbmsg.WearAccessoryResponse);t&&(0==t.code?game.AccessoryMgr.getMgrByType(t.type).wearAccessoryComplete(t):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)))},onTakeOffAccessoryResponse:function(e){var t=e.readProtobuf(game.pbmsg.TakeOffAccessoryResponse);t&&(0==t.code?game.AccessoryMgr.getMgrByType(t.type).takeOffAccessoryComplete(t):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)))},onAccessoryExpResetNotify:function(e){var t=e.readProtobuf(game.pbmsg.AccessoryExpResetNotify);t&&game.AccessoryMgr.resetDaily(t.type)},onLearnSkillResponse:function(e){var t=e.readProtobuf(game.pbmsg.LearnSkillResponse);if(t)if(0==t.code){var i=game.AccessoryMgr.getMgrByType(t.type);i&&i.learnSkillComplete(t)}else game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))},onConvertSkillResponse:function(e){var t=e.readProtobuf(game.pbmsg.ConvertSkillResponse);if(t)if(0==t.code){var i=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);i&&i.convertSkillComplete(t)}else game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))}})},{}],14:[function(e,t,i){"use strict";game.AccessoryEvent=b8e.Enum({AccessoryChange:b8e.Event.nextCode(),AccessoryUpgrade:b8e.Event.nextCode(),AccessoryLvChange:b8e.Event.nextCode(),AccessoryShowTypeChange:b8e.Event.nextCode(),AccessorySuccees:b8e.Event.nextCode(),SkillArchiveSelect:b8e.Event.nextCode(),UpdateConvertPanel:b8e.Event.nextCode(),SkillSelect:b8e.Event.nextCode(),SkillLearnSuccess:b8e.Event.nextCode(),SkillAddSuccees:b8e.Event.nextCode(),SkillConvertSuccees:b8e.Event.nextCode()})},{}],15:[function(e,t,i){"use strict";game.AccessoryMgr=b8e.Object.extends({_type:game.AccessoryType.None,accessoryData:null,curLv:0,isAutoSend:!1,isAutoBuy:!1,_needInit:!0,_useItemId:0,_needTip:!0,_upgradeInfo:null,_canAddExp:!0,curConvertSkillArr:null,curConvertSkillIndex:0,curConvertSkillQuality:0,curLearnSkillId:0,skillArr:null,sendConvertSkillMap:null,skillSlotLockArr:null,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:game.AccessoryType.None;e==game.AccessoryType.None&&new Error("AccessoryMgr 传入类型错误"),this._type=e,this.accessoryData=new game.AccessoryData,this._upgradeInfo=new game.UpgradeInfo,this.curConvertSkillArr=[],this.skillArr=[],this.sendConvertSkillMap=b8e.HashMap.get(),this.skillSlotLockArr=[],this.initSpotAlert()},setup:function(e){if(e&&e.type==this._type){if(e.accy&&0!=e.accy.length){this._needInit=!1,this.accessoryData=e.accy;var t=this.getCfg().getDataById(this.accessoryData.lv);this.curLv=t.stage,this._type==game.AccessoryType.FaBao&&game.skill.initSpell();var i=0;for(i=0;i<7;i++)this.skillArr[i]=0;var n=this.accessoryData.skillInfo.length;for(i=0;i<n;i++){var s=this.accessoryData.skillInfo[i];s&&(this.skillArr[s.index-1]=s.spell)}game.mountequip.setMountEquipSlotInfo(this.accessoryData.equip),b8e.evt.dptG(game.AccessoryEvent.AccessoryChange),b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade),b8e.evt.dptG(game.AccessoryEvent.AccessoryLvChange)}}else b8e.log("AccessoryMgr setup 类型不一致")},getCfg:function(){switch(this._type){case game.AccessoryType.Mount:return game.ccfg.MountCfg;case game.AccessoryType.Wing:return game.ccfg.WingCfg;case game.AccessoryType.FaBao:return game.ccfg.FaBaoCfg;case game.AccessoryType.XianZhen:return game.ccfg.XianZhenCfg;default:b8e.log("AccessoryMgr _type is None")}},getMinStageLvCfg:function(e){var t=this.getCfg();return t?t.getMinStageLvCfg(e):null},getMaxStageLvCfg:function(e){var t=this.getCfg();return t?t.getMaxStageLvCfg(e):null},getDataLvCfg:function(){var e=this.getCfg();return this.accessoryData&&e?e.getDataById(this.accessoryData.lv):null},getSpriteStat:function(){var e=this.getCfg();if(e){var t=e.getDataById(this.accessoryData.lv);if(t)return game.ccfg.SpriteStatCfg.getSpriteStatById(t.attr)}return null},getNextSpriteStat:function(){var e=this.getCfg();if(e){var t=e.getDataById(this.accessoryData.lv+1);if(t)return game.ccfg.SpriteStatCfg.getSpriteStatById(t.attr)}return null},getSpellId:function(){var e=this.getMinStageLvCfg(this.curLv);return e?e.unlockedSpell:0},getMaxLv:function(){var e=this.getCfg();return e?e.getMaxLv():0},getMaxStage:function(){var e=this.getCfg();return e?e.getMaxStage():0},getStageByLv:function(e){return this.getCfg().getDataById(e).stage},getStarByLv:function(e){if(0==e)return 0;var t=e%10;return 0==t?10:t},getLvString:function(e){if(0==e)return"无";var t=this.getStageByLv(e),i=this.getStarByLv(e),n="";return 0<t&&(n=t+"阶"),0<i&&(n+=i+"星"),n},getLeftAccessory:function(){this.curLv<=1||(this.curLv--,b8e.evt.dptG(game.AccessoryEvent.AccessoryChange))},getRightAccessory:function(){if(this.accessoryData){var e=this.getCfg().getDataById(this.accessoryData.lv);this.curLv>=e.stage+1?this.curLv=e.stage+1:(this.curLv++,b8e.evt.dptG(game.AccessoryEvent.AccessoryChange))}},onInit:function(){if(this._needInit)game.AccessorySender.inst().getAccessory(this._type);else{var e=this.getCfg().getDataById(this.accessoryData.lv);this.curLv=e.stage,b8e.evt.dptG(game.AccessoryEvent.AccessoryChange),b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade)}},onReset:function(){this._needInit=!0,game.app.isShow(game.AppConstant.ACCESSORY_PANEL)&&this.onInit()},addExpAccessoryOnce:function(){0!=this.canUpgrade()&&(this.isAutoSend=!1,this._needTip=!0,this._addExpForAccessory())},addExpAccessoryOnceBySilver:function(){this.isAutoSend=!1,this._addExpForAccessoryBySilver()},_addExpForAccessoryBySilver:function(){if(0!=this.canUpgrade()){var e=this.getDataLvCfg();this._useItemId=e.alternativeCostItemId,this._upgradeInfo.clear(),this._upgradeInfo.setData(game.AmountType.SILVER,e.alternativeCostItemNum),game.upgrade.costCheck(this,this._upgradeInfo,this.onSilverIsPass)}},onSilverIsPass:function(e){e?this.canUpgrade()&&game.AccessorySender.inst().addExpForAccessory(this._type,this._useItemId):1==this.isAutoSend&&(this.isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade))},canUpgrade:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=game.mainRole.mainRoleData.getLv(),i=this.getDataLvCfg();return!!i&&(t>=i.roleLevelLimit||(e&&game.notice.show("等级达到"+i.roleLevelLimit+"才能继续升级"),!1))},autoAddExpAccessory:function(e){0!=this.canUpgrade()&&(this._canAddExp=!0,b8e.Tween.kill(this),1==this.isAutoSend?(this.isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade)):(this.isAutoSend=!0,this._needTip=e,this._addExpForAccessory()))},_addExpForAccessory:function(){if(this._canAddExp){var e=this.getDataLvCfg();e&&0==e.expLimit?game.AccessorySender.inst().addExpForAccessory(this._type,e.costItemId):(this._useItemId=e.costItemId,game.upgrade.checkConditions(this,e.costItemId,e.costItemNum,game.AmountType.YUAN_BAO,this.onIsPass,this._needTip,this.isAutoBuy),this.isAutoSend||(this._canAddExp=!1,b8e.Tween.kill(this),b8e.Tween.get(this).wait(200).call(function(){this._canAddExp=!0,b8e.Tween.kill(this)},this)))}},onIsPass:function(e){e?game.AccessorySender.inst().addExpForAccessory(this._type,this._useItemId):1==this.isAutoSend&&(this.getDataLvCfg().alternativeCostItemId?this._addExpForAccessoryBySilver():(this.isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade)))},addExpForAccessoryComplete:function(e){if(!e||0!=e.code)return this.isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryChange),void b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade);if(e.lv>this.accessoryData.lv){var t=this.getCfg(),i=t.getDataById(this.accessoryData.lv),n=t.getDataById(e.lv);this.accessoryData.lv=e.lv,i.stage<n.stage&&(this.isAutoSend=!1,this.curLv=n.stage,1<e.lv&&game.app.show(game.AppConstant.ACCESSORY_UPGRADE_PANEL,[e.type]),b8e.evt.dptG(game.AccessoryEvent.AccessoryLvChange),this.wearAccessory()),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.AccessoryEvent.AccessoryChange),b8e.evt.dptG(game.AccessoryEvent.AccessorySuccees)}else{var s=e.exp-this.accessoryData.exp;game.notice.show(100006,[s])}this.accessoryData.exp=e.exp,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade),1==this.isAutoSend&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(300).call(this.waitAutoAddExpSend,this))},waitAutoAddExpSend:function(){1==this.isAutoSend&&this._addExpForAccessory()},addExpFail:function(){this.isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade)},wearTakeOffClick:function(){this.getCfg().getDataById(this.accessoryData.wearedLv).stage==this.curLv&&0!=this.curLv?this.takeOffAccessory():this.wearAccessory()},wearAccessory:function(){var e=this.getCfg(),t=this.accessoryData,i=this.getDataLvCfg();if(e&&t&&i){var n;if(0!=t.lv){n=this.curLv;var s,a=i.stage;a<n||(s=a==n?i:this.getMaxStageLvCfg(n),game.AccessorySender.inst().wearAccessory(this._type,s.lv))}}},wearAccessoryComplete:function(e){e&&0==e.code?(this.accessoryData.wearedLv=e.wearedLv,this._type==game.AccessoryType.FaBao&&game.skill.initSpell(),b8e.evt.dptG(game.AccessoryEvent.AccessoryChange)):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(code))},takeOffAccessory:function(){game.AccessorySender.inst().takeOffAccessory(this._type)},takeOffAccessoryComplete:function(e){e&&0==e.code?(this.accessoryData.wearedLv=0,this._type==game.AccessoryType.FaBao&&game.skill.initSpell(),b8e.evt.dptG(game.AccessoryEvent.AccessoryChange)):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(code))},closePanelAlert:function(){var e=this.getDataLvCfg();if(0!=this.accessoryData.exp&&0!=e.isResetExp){var t=new game.GameAlertInfo;t.alertType=game.GameAlertType.TwoBtn,t.string="今晚24点祝福值将清零，您确认关闭吗？",t.isShowTips=!0,game.gameAlert.showAlert(this,this.onClosePanelAlert,t)}else game.app.hide(game.AppConstant.ACCESSORY_PANEL)},onClosePanelAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.app.hide(game.AppConstant.ACCESSORY_PANEL);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},convertSkill:function(){if(!(this.curConvertSkillArr.length<3)){for(var e=this.curConvertSkillArr.length,t=0;t<e;t++)if(0==this.curConvertSkillArr[t])return;game.AccessorySender.inst().convertSkillRequest(this.curConvertSkillArr)}},convertSkillComplete:function(e){game.back.onShowRewards(e.pbItem,null),this.curConvertSkillQuality=0;for(var t=this.curConvertSkillArr.length,i=0;i<t;i++)this.curConvertSkillArr[i]=0;this.curConvertSkillIndex=0,b8e.evt.dptG(game.AccessoryEvent.UpdateConvertPanel),b8e.evt.dptG(game.AccessoryEvent.SkillSelect)},removeConvertSkill:function(e){if(!(this.curConvertSkillArr.length<e)){var t=!0,i=!1;this.curConvertSkillArr[e]=0;var n=this.curConvertSkillArr.length;for(e=0;e<n;e++)0!=this.curConvertSkillArr[e]||i||(this.curConvertSkillIndex=e,i=!0),0!=this.curConvertSkillArr[e]&&(t=!1);t&&(this.curConvertSkillQuality=0),b8e.evt.dptG(game.AccessoryEvent.UpdateConvertPanel)}},selectConvertSkill:function(e,t){if(0==this.curConvertSkillQuality)this.curConvertSkillQuality=e;else if(e!=this.curConvertSkillQuality)return void b8e.log("accessorySkill quality != this.curConvertSkillQuality");this.curConvertSkillArr.length<this.curConvertSkillIndex+1?this.curConvertSkillArr.push(t):this.curConvertSkillArr[this.curConvertSkillIndex]=t,this.curConvertSkillIndex<2?this.curConvertSkillIndex++:this.curConvertSkillIndex=0,b8e.evt.dptG(game.AccessoryEvent.SkillSelect,t)},addLearnSkill:function(e){this.curLearnSkillId=e,b8e.evt.dptG(game.AccessoryEvent.SkillAddSuccees)},sendLearnSkill:function(e){if(0!=this.curLearnSkillId){var t=this.getSkillSlotIsUnlock(0);this.accessoryData.lv<t?game.notice.show(84005):game.AccessorySender.inst().learnSkillRequest(e,this.curLearnSkillId)}else game.notice.show(84003)},learnSkillComplete:function(e){var t=e.slotInfo;t&&(this.skillArr[t.index-1]=t.spell,this.curLearnSkillId=0,b8e.evt.dptG(game.AccessoryEvent.SkillLearnSuccess,t.index))},getSkillSlotIsUnlock:function(e){if(0==this.skillSlotLockArr.length){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SKILL_SLOT_UNLOCK_LEVEL);this.skillSlotLockArr=t.split("|")}return this.skillSlotLockArr.length>e?this.skillSlotLockArr[e]:0},getSkillIdByIndex:function(e){return this.skillArr.length>e?this.skillArr[e]:0},getSkillIds:function(){return this.skillArr},getConvertSkillByIndex:function(e){return this.curConvertSkillArr.length>e?this.curConvertSkillArr[e]:0},getConvertSkillArr:function(){return this.curConvertSkillArr},clearAccessoryConvertSkill:function(){for(var e=this.curConvertSkillArr.length,t=0;t<e;t++)this.curConvertSkillArr[t]=0;this.curConvertSkillQuality=0,this.curConvertSkillIndex=0},getSkillNumInConvertArr:function(e){for(var t=0,i=this.curConvertSkillArr.length,n=0;n<i;n++){this.curConvertSkillArr[n]==e&&t++}return t},getAccessorySkillCombatByIdx:function(e){var t=0,i=game.ccfg.AccessorySpellCfg.getDataById(e);if(!i)return t;var n=game.mainRole.mainRoleData.getLv(),s=0,a=this.getSpriteStat();if(a&&i.accessoryAttrId){var o=a.getStatDataByType(i.accessoryAttrId);o&&(s=(s=game.CCommonUtil.getSingleAttrPower(o.type,o.value,n))*i.upPercent/100)}var r=game.ccfg.SpriteStatCfg.getSpriteStatById(i.attrId);return~~(t=game.CCommonUtil.getPower(r,n)+s)},getAccessorySkillAlert:function(){var e=!1,t=game.back.getItemListByType(game.GoodsType.ACCESSORY_SKILL),i=this.getSkillSlotIsUnlock(0);return t&&0<t.length&&0==this.skillArr[0]&&this.accessoryData.lv>=i&&(e=!0),e},initSpotAlert:function(){switch(this._type){case game.AccessoryType.Mount:game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MOUNT_ALERT,game.SpotAlertChildrens.MOUNT_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MOUNT_ITEM_ALERT,null,this.spotFilter,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MOUNT_SILVER_ALERT,null,this.spotSilverFilter,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MOUNT_EQUIP_ALERT,null,this.spotAlertMountEquip,this);break;case game.AccessoryType.Wing:game.spotAlert.addSpotAlert(game.SpotAlertTargetType.WING_ALERT,game.SpotAlertChildrens.WING_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.WING_ITEM_ALERT,null,this.spotFilter,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.WING_SILVER_ALERT,null,this.spotSilverFilter,this);break;case game.AccessoryType.FaBao:game.spotAlert.addSpotAlert(game.SpotAlertTargetType.FABAO_ALERT,game.SpotAlertChildrens.FABAO_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.FABAO_ITEM_ALERT,null,this.spotFilter,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.FABAO_SILVER_ALERT,null,this.spotSilverFilter,this);break;case game.AccessoryType.XianZhen:game.spotAlert.addSpotAlert(game.SpotAlertTargetType.XIANZHEN_ALERT,game.SpotAlertChildrens.XIANZHEN_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.XIANZHEN_ITEM_ALERT,null,this.spotFilter,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.XIANZHEN_SILVER_ALERT,null,this.spotSilverFilter,this)}},spotSilverFilter:function(){var e;switch(this._type){case game.AccessoryType.Mount:e=game.FunctionType.MOUNT;break;case game.AccessoryType.Wing:e=game.FunctionType.WING;break;case game.AccessoryType.FaBao:e=game.FunctionType.FA_BAO;break;case game.AccessoryType.XianZhen:e=game.FunctionType.XIANZHEN;break;default:return!1}if(game.funcOpen.checkOpen(e)){var t=this.getDataLvCfg();if(t&&0==t.expLimit)return!0;if(this.canUpgrade(!1)&&0!=t.alternativeCostItemNum&&game.upgrade.costCheckMoney(game.AmountType.SILVER,t.alternativeCostItemNum))return 1!=t.isResetExp||0!=this.accessoryData.exp}return!1},spotFilter:function(){var e;switch(this._type){case game.AccessoryType.Mount:e=game.FunctionType.MOUNT;break;case game.AccessoryType.Wing:e=game.FunctionType.WING;break;case game.AccessoryType.FaBao:e=game.FunctionType.FA_BAO;break;case game.AccessoryType.XianZhen:e=game.FunctionType.XIANZHEN;break;default:return!1}if(game.funcOpen.checkOpen(e)){var t=this.getDataLvCfg();if(t&&0==t.expLimit)return!0;if(this._upgradeInfo.clear(),this._upgradeInfo.addCostItem(t.costItemId,t.costItemNum),this.canUpgrade(!1)&&game.upgrade.isHasEnoughItem(this._upgradeInfo))return 1!=t.isResetExp||0!=this.accessoryData.exp}return!1},spotAlertMountEquip:function(){return!!game.funcOpen.checkOpen(game.FunctionType.MOUNT_EQUIP)&&game.mountequip.isShowMountEquipAlert}}),game.AccessoryMgr._mountInstance=null,game.MountMgr=function(){return game.AccessoryMgr._mountInstance||(game.AccessoryMgr._mountInstance=new game.AccessoryMgr(game.AccessoryType.Mount)),game.AccessoryMgr._mountInstance},game.AccessoryMgr._wingInstance=null,game.WingMgr=function(){return game.AccessoryMgr._wingInstance||(game.AccessoryMgr._wingInstance=new game.AccessoryMgr(game.AccessoryType.Wing)),game.AccessoryMgr._wingInstance},game.AccessoryMgr._faBaoInstance=null,game.FaBaoMgr=function(){return game.AccessoryMgr._faBaoInstance||(game.AccessoryMgr._faBaoInstance=new game.AccessoryMgr(game.AccessoryType.FaBao)),game.AccessoryMgr._faBaoInstance},game.AccessoryMgr._xianZhenInstance=null,game.XianZhenMgr=function(){return game.AccessoryMgr._xianZhenInstance||(game.AccessoryMgr._xianZhenInstance=new game.AccessoryMgr(game.AccessoryType.XianZhen)),game.AccessoryMgr._xianZhenInstance},game.AccessoryMgr.getMgrByType=function(e){switch(e){case game.AccessoryType.Mount:return game.MountMgr();case game.AccessoryType.Wing:return game.WingMgr();case game.AccessoryType.FaBao:return game.FaBaoMgr();case game.AccessoryType.XianZhen:return game.XianZhenMgr()}},game.AccessoryMgr.showPanel=function(e){game.AccessoryType.None!=e&&(game.AccessoryMgr.getMgrByType(e).isAutoSend=!1,game.app.show(game.AppConstant.ACCESSORY_PANEL,[e]),b8e.evt.dptG(game.AccessoryEvent.AccessoryShowTypeChange,e))},game.AccessoryMgr.stopAutoSend=function(){game.MountMgr().isAutoSend=!1,game.WingMgr().isAutoSend=!1,game.FaBaoMgr().isAutoSend=!1,game.XianZhenMgr().isAutoSend=!1,b8e.evt.dptG(game.AccessoryEvent.AccessoryUpgrade)},game.AccessoryMgr.resetDaily=function(e){var t=game.AccessoryMgr.getMgrByType(e);t?t.onReset():b8e.error("服务器发送的装饰物重置类型错误")}},{}],16:[function(e,t,i){"use strict";game.appModule.AccessoryPanel=game.SkinUIPanel.extends({_model:null,_mgr:null,_showType:0,itemGrid:null,_skillItem:null,_skillDesItem:null,_nameImg:null,_accessoryModel:null,_curNum:null,_stars:null,_effect:null,_upgradeAnim:null,_upgradeEffect:null,_resetTimer:null,_silverIcon:null,_silverItemIcon:null,ctor:function(e){this._super(e)},getButtonByName:function(e){switch(e){case"freeActivation":return!this._skin||this._skin.freeActivationBtn}return null},setTab:function(e){return!!this._skin&&("1"==e?this.onSelectPanel(1):"2"==e?this.onSelectPanel(2):"3"==e?this.onSelectPanel(3):"4"==e&&this.onSelectPanel(4),!0)},init:function(){if(this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.costItem),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this.itemGrid.fnOnClick(this,this.onClick),this.itemGrid.addToParent(this._skin.costItem)),this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.modelRoot)),this._nameImg||(this._nameImg=b8e.Sprite.get(),this._nameImg.setAnchor(.5,.5),this._nameImg.addToParent(this._skin.curLvName)),this._silverIcon||(this._silverIcon=b8e.Sprite.get(),this._silverIcon.setAnchor(0,0),this._silverIcon.addToParent(this._skin.silverIcon)),this._silverItemIcon||(this._silverItemIcon=b8e.Sprite.get(),this._silverItemIcon.setAnchor(0,0),this._silverItemIcon.addToParent(this._skin.silverCostItem)),this._nameImg2||(this._nameImg2=b8e.Sprite.get(),this._nameImg2.setAnchor(.5,.5),this._nameImg2.addToParent(this._skin.curLvName_1)),!this._stars){this._stars=[];for(var e=0;e<10;e++){var t=new game.AccessoryStarItem;this._stars.push(t),t.addToParent(this._skin.star)}}this._skillDesItem||(this._skillDesItem=new game.SkillIcon,this._skillDesItem.setSkillIconType(game.SkillIconType.TYPE_C),this._skillDesItem.setAnchor(.5,.5),this._skillDesItem.addToParent(this._skin.faBaoSkillIcon)),this._skillItem||(this._skillItem=new game.SkillIcon,this._skillItem.setSkillIconType(game.SkillIconType.TYPE_C),this._skillItem.setAnchor(.5,.5),this._skillItem.addToParent(this._skin.skillSlot)),this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACCESSORY_EFFECT,1),this._effect.setAnchor(.5,.5),this._effect.addToParent(this._skin.effect))},onShow:function(){b8e.evt.onC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.onC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.onC(this._skin.useBtn,this._onClickUseBtn,this),b8e.evt.onC(this._skin.upgradeBtn,this._upgradeBtn,this),b8e.evt.onC(this._skin.autoUpgradeBtn,this._autoUpgradeBtn,this),b8e.evt.onC(this._skin.preview,this._onClickPreviewBtn,this),b8e.evt.onC(this._skin.freeActivationBtn,this._onClickFreeActivationBtn,this),b8e.evt.onC(this._skillItem,this.showSkillPre,this),b8e.evt.onC(this._skin.autoBuyNode,this.onUpdateIsAutoBuy,this),b8e.evt.onC(this._skin.silverAutoNode,this.onSilverAutoNodeClick,this),b8e.evt.onC(this._skin.silverUpgradeNode,this.onSilverUpgradeNodeClick,this),b8e.evt.onC(this._skin.silverItemUpgradeNode,this.onSilverItemUpgradeNode,this),b8e.evt.onC(this._skin.accessorySkillBtn,this.onClickAccessorySkillBtn,this),b8e.evt.onC(this._skin.mountEquipBtn,this.onClickMountEquipBtn,this),b8e.evt.addG(this,game.AccessoryEvent.AccessoryChange,this.onAccessoryChange),b8e.evt.addG(this,game.AccessoryEvent.AccessoryUpgrade,this.upgaradeAccess),b8e.evt.addG(this,game.AccessoryEvent.AccessoryShowTypeChange,this.accessoryShowTypeChange),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostNum),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateCostNum),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateAutoBuyInfo),b8e.evt.addG(this,game.AccessoryEvent.AccessorySuccees,this.playEffect),b8e.evt.addG(this,game.MountEquipEvents.EQUIP_SPORTALERT,this.equipSportAlert),this.data&&0<this.data.length&&this.onSelectPanel(parseInt(this.data[0]))},onSelectPanel:function(e){this._showType=e,this.initPanel(),this.startResetTime(),this._mgr.onInit(),this.onSpotAlertChange()},onHide:function(){this._mgr.isAutoSend=!1,game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.offC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.offC(this._skin.useBtn,this._onClickUseBtn,this),b8e.evt.offC(this._skin.upgradeBtn,this._upgradeBtn,this),b8e.evt.offC(this._skin.autoUpgradeBtn,this._autoUpgradeBtn,this),b8e.evt.offC(this._skin.preview,this._onClickPreviewBtn,this),b8e.evt.offC(this._skin.freeActivationBtn,this._onClickFreeActivationBtn,this),b8e.evt.offC(this._skillItem,this.showSkillPre,this),b8e.evt.offC(this._skin.autoBuyNode,this.onUpdateIsAutoBuy,this),b8e.evt.offC(this._skin.silverAutoNode,this.onSilverAutoNodeClick,this),b8e.evt.offC(this._skin.silverUpgradeNode,this.onSilverUpgradeNodeClick,this),b8e.evt.offC(this._skin.silverItemUpgradeNode,this.onSilverItemUpgradeNode,this),b8e.evt.offC(this._skin.accessorySkillBtn,this.onClickAccessorySkillBtn,this),b8e.evt.offC(this._skin.mountEquipBtn,this.onClickMountEquipBtn,this),b8e.evt.rmvG(this,game.AccessoryEvent.AccessoryChange,this.onAccessoryChange),b8e.evt.rmvG(this,game.AccessoryEvent.AccessoryUpgrade,this.upgaradeAccess),b8e.evt.rmvG(this,game.AccessoryEvent.AccessoryShowTypeChange,this.accessoryShowTypeChange),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostNum),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateCostNum),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateAutoBuyInfo),b8e.evt.rmvG(this,game.AccessoryEvent.AccessorySuccees,this.playEffect),b8e.evt.rmvG(this,game.MountEquipEvents.EQUIP_SPORTALERT,this.equipSportAlert);var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.clear(),(e=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1))&&e.clear(),this._effect&&this._effect.clear(),this._resetTimer&&this._resetTimer.stop()},onClickCloseBtn:function(){this._mgr&&this._mgr.closePanelAlert()},onClickClostBtnReturn:function(){this._mgr&&this._mgr.closePanelAlert()},accessoryShowTypeChange:function(e){this._mgr&&(this._showType=e.data,this.initPanel(),this._mgr.onInit())},initPanel:function(){var e,t;switch(this._mgr=game.AccessoryMgr.getMgrByType(this._showType),this._skin.accessorySkillBtn.active=!1,this._skin.accessorySkillAlert.active=!1,this._skin.mountEquipBtn.active=!1,this._showType){case game.AccessoryType.Mount:t=game.Direction.getRadian(game.Direction.DownRight),e="坐  骑",game.shield.isShield(game.ShieldEnum.MOUNTEQUIP)||(this._skin.mountEquipBtn.active=!0,this._skin.mountEquipAlert.active=game.mountequip.isShowMountEquipAlert);break;case game.AccessoryType.Wing:t=game.Direction.getRadian(game.Direction.Down),e="翅  膀",game.shield.isShield(game.ShieldEnum.ACCESSORY_SKILL)||(this._skin.accessorySkillBtn.active=!0,this._skin.accessorySkillAlert.active=this._mgr.getAccessorySkillAlert());break;case game.AccessoryType.FaBao:e="法  宝",t=game.Direction.getRadian(game.Direction.Down);break;case game.AccessoryType.XianZhen:e="仙  阵",t=game.Direction.getRadian(game.Direction.Down)}this._skin.title.string=e,this._accessoryModel.setFaceRadian(t)},equipSportAlert:function(){this._skin.mountEquipAlert.active=game.mountequip.isShowMountEquipAlert},onSpotAlertChange:function(){var e,t,i=!1;switch(this._showType){case game.AccessoryType.Mount:t=e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MOUNT_ITEM_ALERT),i=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MOUNT_SILVER_ALERT);break;case game.AccessoryType.Wing:t=e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WING_ITEM_ALERT),i=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WING_SILVER_ALERT);break;case game.AccessoryType.FaBao:t=e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.FABAO_ITEM_ALERT),i=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.FABAO_SILVER_ALERT);break;case game.AccessoryType.XianZhen:t=e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.XIANZHEN_ITEM_ALERT),i=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.XIANZHEN_SILVER_ALERT)}this._skin.upgradeAlert.active=e,this._skin.silverAlert.active=i,this._skin.silverItemAlert.active=t},_onClickPreviewBtn:function(){if(this._mgr){var e,t;switch(this._showType){case game.AccessoryType.Mount:e=game.SpriteStatShowType.Mount;break;case game.AccessoryType.Wing:e=game.SpriteStatShowType.Wing;break;case game.AccessoryType.FaBao:e=game.SpriteStatShowType.FaBao;break;case game.AccessoryType.XianZhen:e=game.SpriteStatShowType.XianZhen}0==this._mgr.curLv?(t=game.SpriteStat.get()).initDefault():t=this._mgr.getSpriteStat();var i=this._mgr.getNextSpriteStat();game.spriteStat.showSpriteStat(e,this._mgr.curLv,t,i)}},startResetTime:function(){this._resetTimer?this._resetTimer.start():this._resetTimer=b8e.Timer.add(this,this.updateResetTime,500)},updateResetTime:function(){if(this._mgr){var e=this._mgr.accessoryData;if(e)if(0!=this._mgr.getDataLvCfg().isResetExp){var t=e.expResetTs-game.SysTime.curTime,i=game.html.getText(game.html.Q_RED,b8e.TimeUtil.formatTime(t));this._skin.resetTimeLabel.string="祝福值越高成功率越高，祝福值清空倒计时:"+i}else this._skin.resetTimeLabel.string="祝福值越高成功率越高，当前星级不清除祝福值"}},onAccessoryChange:function(){if(this._mgr){var e=this._mgr.getCfg(),t=this._mgr.accessoryData,i=this._skin,n=this._mgr.getDataLvCfg();if(e&&t&&i&&n){var s=0;s=0==t.lv?1:this._mgr.curLv;var a,o=e.getDataById(t.wearedLv).stage,r=n.stage;if(a=r<s?this._mgr.getMinStageLvCfg(s):r==s?n:this._mgr.getMaxStageLvCfg(s)){var h=a.stage;switch(this._showType){case game.AccessoryType.Mount:l=game.ClientCfg.getMount(a.res);break;case game.AccessoryType.Wing:l=game.ClientCfg.getWing(a.res);break;case game.AccessoryType.FaBao:l=game.ClientCfg.getFaBao(a.res);break;case game.AccessoryType.XianZhen:l=game.ClientCfg.getXianZhen(a.res)}var g=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);if(l?(g||(g=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),g.load(l),g.play(),g.setScale(a.uiScale,a.uiScale)):g&&g.clear(),g=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1),this._showType==game.AccessoryType.Mount&&a.head?(g||(g=this._accessoryModel.addAnimator(game.AnimatorType.MOUNT_HEAD,1,10)),l=game.ClientCfg.getMount(a.head),g.load(l),g.play(),g.setScale(a.uiScale,a.uiScale)):g&&g.clear(),a.effect){var l=game.ClientCfg.getUIFxs(a.effect);this._effect.load(l),this._effect.play()}else this._effect.clear();if(a.posY?this._accessoryModel.setPosition(0,a.posY):this._accessoryModel.setPosition(0,0),a.name1){var c=game.ClientCfg.getAccessoryUrl(a.name1);this._nameImg.loadTexture(c,null,null,{useManifest:!1})}else this._nameImg.unloadTexture();if(a.name2){var u=game.ClientCfg.getAccessoryUrl(a.name2);this._nameImg2.loadTexture(u,null,null,{useManifest:!1})}else this._nameImg2.unloadTexture();i.fightAmount.string=a.power+"",i.curLvLabel.string=this._mgr.getStageByLv(a.lv);var m=this._mgr.getMaxStage(),_=this._mgr.getMaxLv();if(i.leftBtn.active=1<h,i.rightBtn.active=h!=m&&h<r+1,t.lv==_)return i.upgradeNode.active=!1,i.maxLv.active=!0,i.useBtn.active=!0,i.freeActivationNode.active=!1,void(o==this._mgr.curLv?i.labUseBtn.string="卸下":i.labUseBtn.string="启用");if(i.maxLv.active=!1,n&&0==n.expLimit&&t.lv!=_)return i.upgradeNode.active=!1,i.freeActivationNode.active=!0,void(i.labUseBtn.string="未激活");i.upgradeNode.active=!0,n.alternativeCostItemId?(i.silverCostUpgradeNode.active=!0,i.normalUpgrade.active=!1):(i.normalUpgrade.active=!0,i.silverCostUpgradeNode.active=!1),i.freeActivationNode.active=!1,i.maxLv.active=!1,r+1<=h?(i.labUseBtn.string="未激活",i.useBtn.active=!1):(i.useBtn.active=!0,o==this._mgr.curLv?i.labUseBtn.string="卸下":i.labUseBtn.string="启用"),this.upgaradeAccess()}}}},upgaradeAccess:function(){if(this._mgr){var e=this._mgr.getDataLvCfg(),t=this._mgr.accessoryData,i=this._skin,n=t.exp/e.expLimit;i.progressBar.x=i.progressMask.width*n,i.progress.string=t.exp;var s=game.ccfg.ItemInfoCfg.getItemInfoById(e.costItemId);s&&(game.GridUtil.setItemGrid(this.itemGrid,s),this.itemGrid.setNum(e.costItemNum),this.itemGrid.sortLayer(),i.costItemName.string=s.name);var a,o=0,r=0,h=this._mgr.getStarByLv(t.lv);for(o=0;o<10;o++){var g=this._stars[o];g.show(),g.isLight(o<h)}this._showType==game.AccessoryType.XianZhen?(this._skin.otherBg.active=!1,this._skin.xianzhenBg.active=!0,this._skin.silhouette.active=!0):(this._skin.otherBg.active=!0,this._skin.xianzhenBg.active=!1,this._skin.silhouette.active=!1),this._showType==game.AccessoryType.FaBao?0<(r=this._mgr.getSpellId())&&(this._skin.skillSlot.active=!0,this._skin.skillTitle.active=!0,a=game.ccfg.SpellCfg.getSpellById(r),this._skillDesItem.setData(r,!1),this._skillDesItem.show(),this._skin.faBaoSkillLabel.string=a.desc,this._skillItem.setData(r,!1),this._skillItem.show()):(this._skin.skillSlot.active=!1,this._skin.skillTitle.active=!1);var l=i.silverAutoLabel.getComponent(cc.Label);1==this._mgr.isAutoSend?(i.autoUpgradeBtnLabel.string="停止升阶",l.string="停止升阶"):(i.autoUpgradeBtnLabel.string="自动进阶",l.string="自动进阶"),this.updateCostNum()}},updateCostNum:function(){if(this._mgr){var e=this._mgr.getDataLvCfg();if(e){var t,i=game.back.getItemInfoById(e.costItemId);if(i?(t=i.num<e.costItemNum?b8e.ColorUtil.toCCColor(4292686643):b8e.ColorUtil.toCCColor(4285851152),this._skin.costItemNum.string=i.num+"/"+e.costItemNum,this._curNum=i.num):(t=b8e.ColorUtil.toCCColor(4292686643),this._skin.costItemNum.string="0/"+e.costItemNum),this._skin.costItemNum.node.color=t,e.alternativeCostItemId){var n=game.ccfg.ItemInfoCfg.getIconNameById(e.costItemId);n=game.ClientCfg.getImgUrl(n),this._silverItemIcon.loadTexture(n,null,null,{useManifest:!1}),this._skin.silverCostItemLbl.string=this._skin.costItemNum.string,this._skin.silverCostItemLbl.node.color=t,game.back.getAmountInfo().getValue(game.AmountType.SILVER)<e.alternativeCostItemNum?t.fromHEX("#DD3333"):t.fromHEX("#74E610"),n=game.ccfg.ItemInfoCfg.getIconNameById(e.alternativeCostItemId),n=game.ClientCfg.getImgUrl(n),this._silverIcon.loadTexture(n,null,null,{useManifest:!1}),this._skin.silverCostLbl.string=e.alternativeCostItemNum+"",this._skin.silverCostLbl.node.color=t}this.updateAutoBuyInfo()}}},updateAutoBuyInfo:function(){if(this._mgr){this._skin.img_checkmark.active=this._mgr.isAutoBuy;var e=this._mgr.getDataLvCfg();if(e)if(game.shop.getBuyUpgradeInfo(e.costItemId)){var t="",i=game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO),n=game.shop.getItemInfoPrice(e.costItemId),s=game.back.getItemInfoCountById(e.costItemId),a=e.costItemNum-s,o=a*n;t=a<0?game.html.getText(game.html.Q_GREEN,e.costItemNum*n):o<=i?game.html.getText(game.html.Q_GREEN,o):game.html.getText(game.html.Q_RED,o),this._skin.lab_cost.string=t}}},onUpdateIsAutoBuy:function(){this._mgr&&(this._skin.img_checkmark.active?(this._skin.img_checkmark.active=!1,this._mgr.isAutoBuy=!1):(this._skin.img_checkmark.active=!0,this._mgr.isAutoBuy=!0))},onClick:function(e){e&&e.faceInfo&&""!=e.faceInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e.faceInfo,num:e.faceInfo.num})},playEffect:function(){var e=game.ClientCfg.getUIFxs("10012");this._upgradeEffect||(this._upgradeEffect=b8e.BaseDisplay.get(),this._upgradeEffect.addToParent(this._skin.upgradeEffect)),e?(this._upgradeAnim||(this._upgradeAnim=b8e.Animator.get(game.AnimatorType.ACCESSORY_UPGRADE_EFFECT,1),this._upgradeEffect.addChild(this._upgradeAnim)),this._upgradeEffect.setVisible(!0),this._upgradeAnim.load(e),this._upgradeAnim.addFinishCallback(this.onCompleteOtherEffect,this),this._upgradeAnim.play(null,0)):this._upgradeAnim&&this._upgradeAnim.clear()},onCompleteOtherEffect:function(){this._upgradeEffect.setVisible(!1)},_loadModel:function(){},_onClickPrevBtn:function(){this._mgr&&this._mgr.getLeftAccessory()},_onClickNextBtn:function(){this._mgr&&this._mgr.getRightAccessory()},_onClickUseBtn:function(){this._mgr&&this._mgr.wearTakeOffClick()},_upgradeBtn:function(){this._mgr&&this._mgr.addExpAccessoryOnce()},_autoUpgradeBtn:function(){this._mgr&&this._mgr.autoAddExpAccessory(!0)},onSilverAutoNodeClick:function(){this._mgr&&this._mgr.autoAddExpAccessory(!1)},onSilverUpgradeNodeClick:function(){this._mgr&&this._mgr.addExpAccessoryOnceBySilver()},onSilverItemUpgradeNode:function(){this._mgr&&this._mgr.addExpAccessoryOnce()},onClickAccessorySkillBtn:function(){game.app.show(game.AppConstant.ACCESSORY_SKILL_PANEL)},onClickMountEquipBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.MOUNT_EQUIP)&&game.app.show(game.AppConstant.MOUNTEQUIP_PANEL)},_onClickFreeActivationBtn:function(){this._mgr&&this._mgr.addExpAccessoryOnce()},showSkillPre:function(){var e=this._mgr.getSpellId();0<e&&game.app.show(game.AppConstant.SKILL_DESC_PANEL,{id:e,type:game.SkillIconType.TYPE_A})}})},{}],17:[function(e,t,i){"use strict";game.AccessorySkillArchiveGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 120},getWidth:function(){return 107},setData:function(e){this._itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(e),this._itemInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_ARCHIVE_CONTAINER),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClickGrid),game.GridUtil.setAccessorySkill(this._itemGrid,this._itemInfo,!1,!0),this.setImgSelect(!1,2),this._itemGrid.sortLayer())},onClickGrid:function(e){b8e.evt.dptG(game.AccessoryEvent.SkillArchiveSelect,e.faceInfo)},setImgSelect:function(e){this._itemGrid.setImgSelect(e,2)}})},{}],18:[function(e,t,i){"use strict";game.AccessorySkillArchivePage=game.SkinUI.extends({_list:null,_skillIcon:null,_str:"",_type:1,_curSelectIndex:-1,skillList:null,ctor:function(){this._super("accessory/AccessorySkillArchivePageSkin","AccessorySkillArchivePageSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.AccessorySkillArchiveGrid,5),this.skillList=game.ccfg.AccessorySpellCfg.getSpellIds(),this.skillList&&0<this.skillList.length&&this.skillList.sort(this.onSort),this._list.setData(this.skillList),this._skillIcon||(this._skillIcon=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._skillIcon.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_CONVERT_CONTAINER),this._skillIcon.addToParent(this._skin.skill_icon),game.GridUtil.setItemGrid(this._skillIcon,null,!1,!1,game.ContainerId.ACCESSORY_SKILL_CONVERT_CONTAINER),this._skillIcon.sortLayer())},onShow:function(){this._list.show(),this._curSelectIndex=-1,this.data?this._type=this.data:this._type=game.AccessoryType.Wing,this._mgr=game.AccessoryMgr.getMgrByType(this._type),this._skin.skill_desc.active=!1,this._skin.lab_desc_tips.active=!0,b8e.evt.onC(this._skin.get_away_btn,this.onClickGetAway,this),b8e.evt.addG(this,game.AccessoryEvent.SkillArchiveSelect,this.selectComplete)},onHide:function(){this._list&&this._list.hide(),this._curSelectIndex=-1,this._itemInfo=null,b8e.evt.offC(this._skin.get_away_btn,this.onClickGetAway,this),b8e.evt.rmvG(this,game.AccessoryEvent.SkillArchiveSelect,this.selectComplete)},onSort:function(e,t){return e-t},selectComplete:function(e){if(e.data){if(this._itemInfo=e.data,this._curSelectIndex<0)this._curSelectIndex=this.skillList.indexOf(this._itemInfo.id+""),this._list.getItemRender(this._curSelectIndex).setImgSelect(!0);else this._list.getItemRender(this._curSelectIndex+"").setImgSelect(!1),this._curSelectIndex=this.skillList.indexOf(this._itemInfo.id+""),this._list.getItemRender(this._curSelectIndex).setImgSelect(!0);if(this._itemInfo)game.ccfg.AccessorySpellCfg.getDataById(this._itemInfo.id)&&(this._skin.skill_desc.active=!0,this._skin.lab_desc_tips.active=!1,game.GridUtil.setItemGrid(this._skillIcon,this._itemInfo,!1,!1,game.ContainerId.ACCESSORY_SKILL_CONVERT_CONTAINER),this._skillIcon.sortLayer(),this._skin.skill_name.string=game.html.getText(game.html.getColorByQuality(this._itemInfo.quality),this._itemInfo.name),this._skin.power.string=this._mgr.getAccessorySkillCombatByIdx(this._itemInfo.id),this._skin.lab_attr.string=this._itemInfo.desc)}},onClickGetAway:function(){this._itemInfo&&""!=this._itemInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:this._itemInfo,num:this._itemInfo.num})}})},{}],19:[function(e,t,i){"use strict";game.AccessorySkillConvertGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,_mgr:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 107},getWidth:function(){return 107},setData:function(e){if(this._itemInfo=e,this._itemInfo){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_CONTAINER),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClickGrid),game.GridUtil.setAccessorySkill(this._itemGrid,this._itemInfo,!1),this._mgr=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);for(var t=this._mgr.getConvertSkillArr(),i=this._itemInfo.num,n=t.length,s=0;s<n;s++){t[s]==this._itemInfo.id&&i--}this._itemGrid.setNum(i),this._itemGrid.sortLayer()}},onClickGrid:function(e){this._mgr&&this._mgr.selectConvertSkill(e.faceInfo.quality,e.faceInfo.id)}})},{}],20:[function(e,t,i){"use strict";game.AccessorySkillConvertPage=game.SkinUI.extends({_skillSlotArr:null,_skillPrizeSlotArr:null,_list:null,_skillArr:null,_itemInfo:null,_skillIcon:null,_str:"",ctor:function(){this._super("accessory/AccessorySkillConvertPageSkin","AccessorySkillConvertPageSkin")},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.AccessorySkillConvertGrid,5)),this._skillArr=[],this._skillSlotArr=[],this._skillPrizeSlotArr=[],this._skillIcon||(this._skillIcon=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._skillIcon.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_CONVERT_CONTAINER),this._skillIcon.addToParent(this._skin.skill_icon),game.GridUtil.setAccessorySkill(this._skillIcon,null,!1,!1,!1,!1,!1),this._skillIcon.sortLayer())},onShow:function(){this._list.show(),this._mgr=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing),this.updatePanel(),this.refreshGridList(),this.refreshSkillDesc(),b8e.evt.onC(this._skin.convert_btn,this.onClickConvertBtn,this),b8e.evt.onC(this._skin.prize_icon[0],this.onClickPrizeBtn,this),b8e.evt.onC(this._skin.prize_icon[1],this.onClickPrizeBtn,this),b8e.evt.addG(this,game.AccessoryEvent.UpdateConvertPanel,this.updatePanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshGridList),b8e.evt.addG(this,game.AccessoryEvent.SkillSelect,this.updataSkillSelect)},onHide:function(){this._list&&this._list.hide(),this._mgr&&this._mgr.clearAccessoryConvertSkill(),this._itemInfo=null,b8e.evt.offC(this._skin.convert_btn,this.onClickConvertBtn,this),b8e.evt.offC(this._skin.prize_icon[0],this.onClickPrizeBtn,this),b8e.evt.offC(this._skin.prize_icon[1],this.onClickPrizeBtn,this),b8e.evt.rmvG(this,game.AccessoryEvent.UpdateConvertPanel,this.updatePanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshGridList),b8e.evt.rmvG(this,game.AccessoryEvent.SkillSelect,this.updataSkillSelect)},onClickGrid:function(e){this._mgr&&e.faceInfo&&this._mgr.removeConvertSkill(e.gridInfo.index)},onClickConvertBtn:function(){this._mgr&&this._mgr.convertSkill()},onClickPrizeBtn:function(){},updatePanel:function(){if(this._mgr){var e,t,i,n,s=0,a=!0;for(this._skillSlotArr||(this._skillSlotArr=[]),t=this._skillSlotArr.length,s=0;s<3;s++)s<t?e=this._skillSlotArr[s]:((e=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_CONVERT_CONTAINER,s),e.addToParent(this._skin.skill_slot[s]),e.fnOnClick(this,this.onClickGrid),this._skillSlotArr.push(e)),0==(n=this._mgr.getConvertSkillByIndex(s))?(i=null,a=!1):i=game.back.getItemInfoById(n),game.GridUtil.setAccessorySkill(e,i,!0,!1,!1,!1,!1,!0),e.sortLayer();if(a){var o=game.ccfg.AccessorySpellConvertCfg.getData(game.AccessoryType.Wing,this._mgr.curConvertSkillQuality);this._skin.convert_btn.active=!0,this._skin.lab_top_probability.node.active=!0,this._skin.lab_bottom_probability.node.active=!0,this._skin.lab_top_probability.string=o.topRate+"%",this._skin.lab_bottom_probability.string=o.bottomRate+"%"}else this._skin.convert_btn.active=!1,this._skin.lab_top_probability.node.active=!1,this._skin.lab_bottom_probability.node.active=!1;this.refreshGridList(),this.refreshSkillDesc()}},refreshGridList:function(){var e=game.back.getItemListByType(game.GoodsType.ACCESSORY_SKILL),t=this._skillArr.length=0,i=0;if(e&&0<e.length)for(t=0;t<e.length;t++){var n=e[t];if(0==this._mgr.curConvertSkillQuality||n.quality==this._mgr.curConvertSkillQuality){if(i<3){var s=this._mgr.getSkillNumInConvertArr(n.id);if(i+=s,s>=n.num)continue}this._skillArr.push(n)}}this._skillArr.sort(this.onSort),this._list.setData(this._skillArr)},onSort:function(e,t){return e.id-t.id},updataSkillSelect:function(e){if(!e||!e.data)return this._itemInfo=null,void this.refreshSkillDesc();this._itemInfo=game.back.getItemInfoById(e.data),this.updatePanel(),this.refreshGridList(),this.refreshSkillDesc()},refreshSkillDesc:function(){if(!this._itemInfo)return this._skin.skill_desc.active=!1,void(this._skin.lab_desc_tips.active=!0);game.ccfg.AccessorySpellCfg.getDataById(this._itemInfo.id)&&(this._skin.skill_desc.active=!0,this._skin.lab_desc_tips.active=!1,game.GridUtil.setAccessorySkill(this._skillIcon,this._itemInfo,!1,!1,!1,!1,!1),this._skillIcon.sortLayer(),this._skin.skill_name.string=game.html.getText(game.html.getColorByQuality(this._itemInfo.quality),this._itemInfo.name),this._skin.power.string=this._mgr.getAccessorySkillCombatByIdx(this._itemInfo.id),this._skin.lab_attr.string=this._itemInfo.desc)}})},{}],21:[function(e,t,i){"use strict";game.appModule.AccessorySkillConvertPanle=game.SkinUIPanel.extends({_convertPage:null,_archivePanel:null,_convertTitle:"置  换",_archiveTitle:"图  鉴",ctor:function(e){this._super(e)},init:function(){this._convertPage||(this._convertPage=new game.AccessorySkillConvertPage,this._convertPage.addToParent(this._skin.panelNode)),this._archivePanel||(this._archivePanel=new game.AccessorySkillArchivePage,this._archivePanel.addToParent(this._skin.panelNode))},onShow:function(){this.hidePanel(),this.onSelectPanelByIndex(0),b8e.evt.onC(this._skin.convert_btn.node,this.onClickConvertBtn,this),b8e.evt.onC(this._skin.archive_btn.node,this.onClickArchiveBtn,this)},onHide:function(){this.hidePanel(),b8e.evt.offC(this._skin.convert_btn.node,this.onClickConvertBtn,this),b8e.evt.offC(this._skin.archive_btn.node,this.onClickArchiveBtn,this)},onClickConvertBtn:function(){this.onSelectPanelByIndex(0)},onClickArchiveBtn:function(){this.onSelectPanelByIndex(1)},hidePanel:function(){this._convertPage.hide(),this._archivePanel.hide()},onSelectPanelByIndex:function(e){switch(this.hidePanel(),e){case 0:this._skin.convert_btn.check(),this._skin.title.string=this._convertTitle,this._convertPage.show();break;case 1:this._skin.archive_btn.check(),this._skin.title.string=this._archiveTitle,this._archivePanel.show()}}})},{}],22:[function(e,t,i){"use strict";game.appModule.AccessorySkillPanel=game.SkinUIPanel.extends({_skillSlot:null,_learnSkillSlot:null,_type:1,_anim:null,_anim2:null,_effect:null,_effect2:null,gameAlertInfo:null,_str:"",ctor:function(e){this._super(e),this._skillSlot=[]},init:function(){this._learnSkillSlot||(this._learnSkillSlot=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._learnSkillSlot.gridInfo=new game.GridInfo(game.ContainerId.RUNE_SLOT_CONTAINER_ID),this._learnSkillSlot.addToParent(this._skin.learn_skill_slot),this._learnSkillSlot.fnOnClick(this,this.onClickAddGrid)),game.GridUtil.setAccessorySkill(this._learnSkillSlot,null,!0,!1,!0,!1,!1),this._learnSkillSlot.sortLayer()},onShow:function(){this.data?this._type=this.data:this._type=game.AccessoryType.Wing,this._mgr=game.AccessoryMgr.getMgrByType(this._type),this.updatePanel(),b8e.evt.onC(this._skin.learn_btn,this.onClickLearnBtn,this),b8e.evt.onC(this._skin.convert_btn,this.onClickConvert,this),b8e.evt.onC(this._skin.pre_btn,this.onClickPreBtn,this),b8e.evt.onC(this._skin.help_btn,this.onClickHelpBtn,this),b8e.evt.addG(this,game.AccessoryEvent.SkillLearnSuccess,this.learnSkillSuccess),b8e.evt.addG(this,game.AccessoryEvent.SkillAddSuccees,this.selectSkillComplete)},onHide:function(){this._mgr.curLearnSkillId=0,this._anim&&this._anim.clear(),this._anim2&&this._anim2.clear(),b8e.evt.offC(this._skin.learn_btn,this.onClickLearnBtn,this),b8e.evt.offC(this._skin.convert_btn,this.onClickConvert,this),b8e.evt.offC(this._skin.pre_btn,this.onClickPreBtn,this),b8e.evt.offC(this._skin.help_btn,this.onClickHelpBtn,this),b8e.evt.rmvG(this,game.AccessoryEvent.SkillLearnSuccess,this.learnSkillSuccess),b8e.evt.rmvG(this,game.AccessoryEvent.SkillAddSuccees,this.selectSkillComplete)},onClickGrid:function(e){if(e.faceInfo)game.app.show(game.AppConstant.SKILL_DESC_PANEL,{id:e.faceInfo.id,type:game.SkillIconType.TYPE_WING_SKILL});else{var t=e.gridInfo.index;this._mgr=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);var i=this._mgr.getSkillSlotIsUnlock(t);if(this._mgr.accessoryData.lv<i){var n=this._mgr.getStageByLv(i);game.notice.show(84004,[n])}}},onClickAddGrid:function(e){game.app.show(game.AppConstant.ACCESSORY_SKILL_SELECT_PANEL)},onClickLearnBtn:function(){this._mgr&&(this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo),this.gameAlertInfo.clearInfo(),this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=game.ccfg.LangCfg.getText(84006),this.gameAlertInfo.isShowTips=!0,game.gameAlert.showAlert(this,this.onGameAlertClickBtn,this.gameAlertInfo))},onGameAlertClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:this._mgr.sendLearnSkill(this._type);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},onClickConvert:function(){game.app.show(game.AppConstant.ACCESSORY_SKILL_CONVERT_PANEL)},onClickPreBtn:function(){game.app.show(game.AppConstant.ACCESSORY_STAT_SPRITE_PANEL)},onClickHelpBtn:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.ACCESSORY_SKILL_RULE_ID)},selectSkillComplete:function(){var e;e=0==this._mgr.curLearnSkillId?null:game.back.getItemInfoById(this._mgr.curLearnSkillId),game.GridUtil.setAccessorySkill(this._learnSkillSlot,e,!0,!1,!0,!1,!1),this._learnSkillSlot.sortLayer(),this.updatePanel()},learnSkillSuccess:function(e){e&&e.data&&this.playEffect(e.data)},updatePanel:function(){if(this._mgr){var e,t,i;this._skin.accessorySkillAlert.active=this._mgr.getAccessorySkillAlert();for(var n=!1,s=this._skillSlot.length,a=0;a<7;a++){a<s?e=this._skillSlot[a]:((e=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.RUNE_SLOT_CONTAINER_ID,a),e.addToParent(this._skin.skill_slot[a]),e.fnOnClick(this,this.onClickGrid),this._skillSlot.push(e)),t=0==(i=this._mgr.getSkillIdByIndex(a))?null:game.ccfg.ItemInfoCfg.getItemInfoById(i);var o=this._mgr.getSkillSlotIsUnlock(a);if(n=this._mgr.accessoryData.lv<o,game.GridUtil.setAccessorySkill(e,t,!0,!1,!0,n,!1),n){o=this._mgr.getSkillSlotIsUnlock(a);var r=this._mgr.getStageByLv(o);this._str=r+"阶解锁",e.setName(this._str),e.setLabNamePos(0,25)}e.sortLayer()}t=0==this._mgr.curLearnSkillId?null:game.back.getItemInfoById(this._mgr.curLearnSkillId),game.GridUtil.setAccessorySkill(this._learnSkillSlot,t,!0,!1,!0,!1,!1),this._learnSkillSlot.sortLayer();var h=0,g=this._mgr.getSkillIds();if(!g||g.length<=0)this._skin.power.string=h;else{s=g.length;for(a=0;a<s;a++){if(game.ccfg.AccessorySpellCfg.getDataById(g[a]))h+=this._mgr.getAccessorySkillCombatByIdx(g[a])}this._skin.power.string=h}}},playEffect:function(e){var t=game.ClientCfg.getUIFxs("10094");switch(e){case 1:t=game.ClientCfg.getUIFxs("11069");break;case 2:t=game.ClientCfg.getUIFxs("11068");break;case 3:t=game.ClientCfg.getUIFxs("11067");break;case 4:t=game.ClientCfg.getUIFxs("11066");break;case 5:t=game.ClientCfg.getUIFxs("11063");break;case 6:t=game.ClientCfg.getUIFxs("11064");break;case 7:default:t=game.ClientCfg.getUIFxs("11065")}t?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.ACCESSORY_SKILL,1),this._anim.addToParent(this._skin.effect)),this._skin.effect.active=!0,this._anim.load(t),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._skin.effect.active=!1,this.showCompleteEffect()},showCompleteEffect:function(){var e=game.ClientCfg.getUIFxs("10094");e?(this._anim2||(this._anim2=b8e.Animator.get(game.AnimatorType.ACCESSORY_SKILL,2),this._anim2.addToParent(this._skin.effect2)),this._skin.effect2.active=!0,this._anim2.load(e),this._anim2.addFinishCallback(this.onCompleteNextEffect,this),this._anim2.play(null,0)):this._anim2&&this._anim2.clear()},onCompleteNextEffect:function(){this._skin.effect2.active=!1,this.updatePanel()}})},{}],23:[function(e,t,i){"use strict";game.AccessorySkillSelectGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 130},getWidth:function(){return 107},setData:function(e){this._itemInfo=e,this._itemInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_SELECT_CONTAINER),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClickGrid),game.GridUtil.setAccessorySkill(this._itemGrid,this._itemInfo,!1,!0),this.setImgSelect(!1,2),this._itemGrid.sortLayer())},onClickGrid:function(e){b8e.evt.dptG(game.AccessoryEvent.SkillSelect,e.faceInfo)},setImgSelect:function(e){this._itemGrid.setImgSelect(e,2)}})},{}],24:[function(e,t,i){"use strict";game.appModule.AccessorySkillSelectPanel=game.SkinUIPanel.extends({_list:null,_selectSkillInfo:null,curLearnSkillId:0,_skillIcon:null,_str:"",goodsList:null,_curSelectIndex:-1,ctor:function(e){this._super(e)},init:function(){this._skillIcon||(this._skillIcon=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._skillIcon.gridInfo=new game.GridInfo(game.ContainerId.ACCESSORY_SKILL_SELECT_CONTAINER),this._skillIcon.addToParent(this._skin.skill_icon),game.GridUtil.setAccessorySkill(this._skillIcon,null,!1,!1,!1,!1,!1),this._skillIcon.sortLayer())},onShow:function(){this.curLearnSkillId=0,this._list||(this._list=new b8e.List(this._skin.list,game.AccessorySkillSelectGrid,4)),this._list.show(),this._curSelectIndex=-1,this._mgr=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing),this.updateSkillInfo(),this._skin.skill_desc.active=!1,this._skin.lab_desc_tips.active=!0,b8e.evt.onC(this._skin.add_btn,this.onClickAddBtn,this),b8e.evt.addG(this,game.AccessoryEvent.SkillSelect,this.refreshSkillDesc)},onHide:function(){this.curLearnSkillId=0,this._list&&this._list.hide(),this._curSelectIndex=-1,b8e.evt.offC(this._skin.add_btn,this.onClickAddBtn,this),b8e.evt.rmvG(this,game.AccessoryEvent.SkillSelect,this.refreshSkillDesc)},updateSkillInfo:function(){this.goodsList=game.back.getItemListByType(game.GoodsType.ACCESSORY_SKILL),this.goodsList&&0<this.goodsList.length?(this._skin.lab_tip.string="",this.goodsList.sort(this.onSort)):this._skin.lab_tip.string="未获得物品",this._list.setData(this.goodsList)},onSort:function(e,t){return e.id-t.id},onClickAddBtn:function(e){this._mgr&&this._itemInfo&&(this._mgr.addLearnSkill(this._itemInfo.id),this.hide())},refreshSkillDesc:function(e){if(e&&e.data&&(this._itemInfo=e.data,this._itemInfo&&game.ccfg.AccessorySpellCfg.getDataById(this._itemInfo.id))){if(this._curSelectIndex<0)this._curSelectIndex=this.goodsList.indexOf(this._itemInfo),this._list.getItemRender(this._curSelectIndex).setImgSelect(!0);else this._list.getItemRender(this._curSelectIndex).setImgSelect(!1),this._curSelectIndex=this.goodsList.indexOf(this._itemInfo),this._list.getItemRender(this._curSelectIndex).setImgSelect(!0);this._skin.skill_desc.active=!0,this._skin.lab_desc_tips.active=!1,game.GridUtil.setAccessorySkill(this._skillIcon,this._itemInfo,!1,!1,!1,!1,!1),this._skillIcon.sortLayer(),this._skin.skill_name.string=game.html.getText(game.html.getColorByQuality(this._itemInfo.quality),this._itemInfo.name),this._skin.power.string=this._mgr.getAccessorySkillCombatByIdx(this._itemInfo.id),this._skin.lab_attr.string=this._itemInfo.desc}}})},{}],25:[function(e,t,i){"use strict";game.AccessoryStarItem=game.SkinUI.extends({_isLight:!1,ctor:function(){this._super("accessory/AccessoryStarSkin","AccessoryStarSkin")},onShow:function(){this.isLight(this._isLight)},isLight:function(e){this._isLight=e,this._skin&&(this._skin.activeNode.active=this._isLight)}})},{}],26:[function(e,t,i){"use strict";game.appModule.AccessoryStatSpritePanel=game.SkinUIPanel.extends({_attrTypeMap:null,_attrTypeCoefMap:null,_str:"",type:1,ctor:function(e){this._super(e),this._attrTypeMap=b8e.HashMap.get(),this._attrTypeCoefMap=b8e.HashMap.get()},onShow:function(){this.data?this.type=this.data:this.type=game.SpriteStatShowType.WingSkill,this.setup()},onHide:function(){this.clearLabel()},clearLabel:function(){this._skin.lab_attr_num.string="",this._skin.lab_attr_name1.string=""},setup:function(){if(this.clearLabel(),this._skin){switch(this.type){case game.SpriteStatShowType.WingSkill:default:"翅膀技能属性"}this.setArrtMap(this.type);var e=this.getAccessorySkillDesc(this.type);this._skin.lab_attr_num.string=e;var t=this.getAccessorySkillName(this.type);this._skin.lab_attr_name1.string=t}},setArrtMap:function(e){var t;switch(e){case game.SpriteStatShowType.WingSkill:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing)}var i=t.getSkillIds();if(!i||i.length<=0)return"";this._attrTypeMap.clear(),this._attrTypeCoefMap.clear();var n=i.length,s=0,a=0;for(a=0;a<n;a++){var o=game.ccfg.AccessorySpellCfg.getDataById(i[a]);if(o){if(o.accessoryAttrId&&o.upPercent){var r=this._attrTypeCoefMap.get(o.accessoryAttrId);r?r+=o.upPercent:r=o.upPercent,this._attrTypeCoefMap.set(o.accessoryAttrId,r)}var h=game.ccfg.SpriteStatCfg.getSpriteStatById(o.attrId).getSpriteStats();for(s=0;s<h.length;s++){var g=h[s];if(g){var l=this._attrTypeMap.get(g.type);l?l+=g.value:l=g.value,this._attrTypeMap.set(g.type,l)}}}}},getAccessorySkillDesc:function(){return this._str="",this._attrTypeMap.forEach(function(e,t){var i=t+"<br/>";this._str+=i},this),this._attrTypeCoefMap.forEach(function(e,t){var i=t+"%<br/>";this._str+=i},this),this._str},getAccessorySkillName:function(){return this._str="",this._attrTypeMap.forEach(function(e,t){var i=game.ccfg.AttrRulesCfg.getAttrNameByType(e)+"<br/>";this._str+=i},this),this._attrTypeCoefMap.forEach(function(e,t){var i=game.ccfg.AttrRulesCfg.getAttrNameByType(e)+"加成<br/>";this._str+=i},this),this._str}})},{}],27:[function(e,t,i){"use strict";game.appModule.AccessoryUpgradePanel=game.SkinUIPanel.extends({_model:null,_mgr:null,_showType:0,_skillIcon:null,_accessoryModel:null,ctor:function(e){this._super(e)},init:function(){this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.modelRoot))},onShow:function(){this.showPanelInit(),b8e.evt.onC(this._skin.btn_sure,this._onClickSureBtn,this),b8e.evt.onC(this._skin.btn_share,this._onClickShareBtn,this)},onHide:function(){this._skillIcon&&this._skillIcon.removeFromParent();var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),(e=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1))&&e.stop(),b8e.evt.offC(this._skin.btn_sure,this._onClickSureBtn,this),b8e.evt.offC(this._skin.btn_share,this._onClickShareBtn,this)},showPanelInit:function(){var e;switch(this._showType=this.data?parseInt(this.data[0]):0,this._mgr=game.AccessoryMgr.getMgrByType(this._showType),this._showType){case game.AccessoryType.Mount:e=game.Direction.getRadian(game.Direction.DownRight);break;case game.AccessoryType.Wing:case game.AccessoryType.FaBao:case game.AccessoryType.XianZhen:e=game.Direction.getRadian(game.Direction.Down)}this._accessoryModel.setFaceRadian(e),this._mgr&&this._mgr.onInit(),this.onAccessoryChange()},onAccessoryChange:function(){var e=this._mgr.getCfg(),t=this._mgr.accessoryData,i=this._skin;if(e&&t&&i){var n=e.getDataById(t.lv-1),s=e.getDataById(t.lv);if(n&&s){var a;switch(this._showType){case game.AccessoryType.Mount:a=game.ClientCfg.getMount(s.res);break;case game.AccessoryType.Wing:a=game.ClientCfg.getWing(s.res);break;case game.AccessoryType.FaBao:a=game.ClientCfg.getFaBao(s.res);break;case game.AccessoryType.XianZhen:a=game.ClientCfg.getXianZhen(s.res);break;default:b8e.log("出大事儿啦！我右边的程序狗猝死了")}var o=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);a?(o||(o=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),o.load(a),o.play(),o.setScale(s.uiScale,s.uiScale)):o&&o.clear(),o=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1),this._showType==game.AccessoryType.Mount&&s.head?(o||(o=this._accessoryModel.addAnimator(game.AnimatorType.MOUNT_HEAD,1,10)),a=game.ClientCfg.getMount(s.head),o.load(a),o.play(),o.setScale(s.uiScale,s.uiScale)):o&&o.clear(),s.posY?this._accessoryModel.setPosition(0,s.posY):this._accessoryModel.setPosition(0,0),i.lab_left_combat.string=n.power+"",i.lab_left_name.string=game.html.getText(game.html.getColorByQuality(n.quality),n.name+"("+this._mgr.getStageByLv(n.lv)+"阶)"),i.lab_right_combat.string=s.power+"",i.lab_right_name.string=game.html.getText(game.html.getColorByQuality(s.quality),s.name+"("+this._mgr.getStageByLv(s.lv)+"阶)"),this.setSkill()}}},setSkill:function(){var e=this._mgr.getDataLvCfg(),t=(this._mgr.accessoryData,this._skin);if(this._skillIcon||(this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_D),this._skillIcon.addToParent(this._skin.skill_icon)),e&&(t.unlock_skill_node.active=!1,t.btn_sure.setPosition(320,280),t.btn_share.setPosition(320,280),e.unlockedSpell)){t.unlock_skill_node.active=!0;var i=game.ccfg.SpellCfg.getSpellById(e.unlockedSpell);this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_D),this._skillIcon.setData(e.unlockedSpell,!1),this._skillIcon.setAnchor(.5,.5),this._skillIcon.setScale(1.2,1.2),this._skillIcon.show(),this._skin.skill_desc.string=game.html.getText(game.html.getColorByQuality(i.quality),i.name)+"\n"+i.desc,t.btn_sure.setPosition(320,160),t.btn_share.setPosition(320,160)}},_onClickSureBtn:function(){this.hide()},_onClickShareBtn:function(){}})},{}],28:[function(e,t,i){"use strict";game.AccessorySender=game.BaseSender.extends({getAccessory:function(e){var t=game.pbmsg.QryAccessoryRequest;t.type=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Accessory.QryAccessoryRequest;this.send(i),b8e.log("请求装饰类数据类型",e)},addExpForAccessory:function(e,t){var i=game.pbmsg.AddExpForAccessoryRequest;i.type=e,i.costItemId=t,this.bytes.writeProtobuf(i);var n=game.pbmid.Accessory.AddExpForAccessoryRequest;this.send(n)},wearAccessory:function(e,t){var i=game.pbmsg.WearAccessoryRequest;i.type=e,i.wearLv=t,this.bytes.writeProtobuf(i);var n=game.pbmid.Accessory.WearAccessoryRequest;this.send(n)},takeOffAccessory:function(e){var t=game.pbmsg.TakeOffAccessoryRequest;t.type=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Accessory.TakeOffAccessoryRequest;this.send(i)},learnSkillRequest:function(e,t){var i=game.pbmsg.LearnSkillRequest;i.type=e,i.id=t,this.bytes.writeProtobuf(i);var n=game.pbmid.Accessory.LearnSkillRequest;this.send(n)},convertSkillRequest:function(e){var t=game.pbmsg.ConvertSkillRequest;t.costItem=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Accessory.ConvertSkillRequest;this.send(i)}}),game.AccessorySender._instance=null,game.AccessorySender.inst=function(){return game.AccessorySender._instance||(game.AccessorySender._instance=new game.AccessorySender),game.AccessorySender._instance}},{}],29:[function(e,t,i){"use strict";e("./cmd/AchievementCmd"),e("./enum/AchievementType"),e("./event/AchievementEvent"),e("./mgr/AchievementMgr"),e("./panel/AchievementItem"),e("./panel/AchievementPanel"),e("./panel/AchievementPrizeItem"),e("./panel/AchievementPrizePanel"),e("./panel/AchievementSpriteStat"),e("./panel/WestBoundRoadPanel"),e("./sender/AchievementSender")},{"./cmd/AchievementCmd":30,"./enum/AchievementType":31,"./event/AchievementEvent":32,"./mgr/AchievementMgr":33,"./panel/AchievementItem":34,"./panel/AchievementPanel":35,"./panel/AchievementPrizeItem":36,"./panel/AchievementPrizePanel":37,"./panel/AchievementSpriteStat":38,"./panel/WestBoundRoadPanel":39,"./sender/AchievementSender":40}],30:[function(e,t,i){"use strict";game.AchievementCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Achievement.AchievementResponse,this.onAchievementResponse,this),b8e.addNH(game.pbmid.Achievement.AchievementNotify,this.onAchievementNotify,this),b8e.addNH(game.pbmid.Achievement.AchievementCompleteResponse,this.onAchievementCompleteResponse,this),b8e.addNH(game.pbmid.Achievement.AchievementAwardResponse,this.onAchievementAwardResponse,this)},onAchievementResponse:function(e){var t=e.readProtobuf(game.pbmsg.AchievementResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.AchievementMgr.inst().setup(t)}},onAchievementNotify:function(e){var t=e.readProtobuf(game.pbmsg.AchievementNotify);t&&game.AchievementMgr.inst().updateAchievement(t)},onAchievementCompleteResponse:function(e){game.reqLock.unlockReq(game.pbmid.Achievement.AchievementCompleteRequest);var t=e.readProtobuf(game.pbmsg.AchievementCompleteResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.AchievementMgr.inst().achievementComplete(t)}},onAchievementAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.AchievementAwardResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.AchievementMgr.inst().getPrizeSuccess(t)}}})},{}],31:[function(e,t,i){"use strict";game.AchievementType=b8e.Enum({TYPE_FIRST:1,TYPE_SECOND:2,TYPE_THIRD:3,TYPE_FOURTH:4,TYPE_FIFTH:5})},{}],32:[function(e,t,i){"use strict";game.AchievementEvent=b8e.Enum({ACHIEVEMENT_REFRESH:b8e.Event.nextCode(),ACHIEVEMENT_SUCCESS:b8e.Event.nextCode(),ACHIEVEMENT_AWARD_CHANGE:b8e.Event.nextCode()})},{}],33:[function(e,t,i){"use strict";game.AchievementMgr=b8e.Object.extends({score:0,awardId:0,_achievementMaps:null,_init:!1,completeItemRenderIndex:0,ctor:function(){if(1==game.AchievementMgr._singleton)throw new Error("AchievementMgr 只能通过单例方法获取");this._achievementMaps=b8e.HashMap.get()},setup:function(e){var t;this.score=e.score,this.awardId=e.awardId;for(var i=0;i<e.list.length;i++)t=e.list[i],this._achievementMaps.set(t.id,t);b8e.evt.dptG(game.AchievementEvent.ACHIEVEMENT_REFRESH)},getData:function(){this._init?b8e.evt.dptG(game.AchievementEvent.ACHIEVEMENT_REFRESH):game.AchievementSender.initData()},getAchievementListByType:function(e){if(!this._achievementMaps)return null;for(var t=this._achievementMaps.values(),i=[],n=0;n<t.length;++n){var s=game.ccfg.AchievementCfg.getDataById(t[n].id);s&&s.achievementType==e&&i.push(t[n])}return i.sort(this.sortAchievementList),i},sortAchievementList:function(e,t){if(1==e.state)return-1;if(1==t.state)return 1;var i=game.ccfg.AchievementCfg.getDataById(e.id),n=game.ccfg.AchievementCfg.getDataById(t.id);return i&&n?i.sortid-n.sortid:0},getPrizeInfoCfg:function(){var e=game.ccfg.AchievementAwardCfg.getDatas();if(!e)return null;for(var t=null,i=0;i<e.length&&this.score>=e[0].score;++i)t=e.shift(),e.push(t);return e},isShowRedIconByType:function(e){var t=this.getAchievementListByType(e);if(!t)return!1;for(var i=0;i<t.length;++i){var n=game.ccfg.AchievementCfg.getDataById(t[i].id);if(n&&t[i].progress>=n.condition.Value)return!0}return!1},updateAchievement:function(e){for(var t=0;t<e.list.length;t++){var i=e.list[t];this._achievementMaps.set(i.id,i)}b8e.evt.dptG(game.AchievementEvent.ACHIEVEMENT_REFRESH)},achievementComplete:function(e){e&&(this._achievementMaps.del(e.id),this.score+=e.score,b8e.evt.dptG(game.AchievementEvent.ACHIEVEMENT_SUCCESS,this.completeItemRenderIndex))},gotoCompleteAchievement:function(e,t){var i=this._achievementMaps.get(e);if(i)if(1==i.state)this.completeItemRenderIndex=t,game.AchievementSender.completeAchievement(e);else{var n=game.ccfg.AchievementCfg.getDataById(e);if(n){var s=n.condition;1==s.Type||2==s.Type?game.quest.getTrusteeshipLocation():3119==n.triggerId?game.pay.showPayPanel():game.TriggerMgr.inst().customTriggerById(n.triggerId)}}},getPrize:function(){var e=game.ccfg.AchievementAwardCfg.getDataById(this.awardId+1);if(e)if(this.score>=e.score)game.AchievementSender.getPrize();else if(2<=this.awardId&&3==e.type){var t=this.getBianshenIdById(e.value),i=game.ccfg.BianshenCfg.getBianshenCfgById(t);i&&game.bianshen.showBianshenDetail(i)}else 2<=this.awardId?game.app.show(game.AppConstant.ACHIEVEMENT_AWARD_PANEL,this.awardId):game.notice.show("条件暂未达成");else game.notice.show("新的奖励敬请期待")},getBianshenIdById:function(e){var t=game.ccfg.PrizeCfg.getPrizeById(e);return t&&0<t.length?t[0].itemId:0},getPrizeSuccess:function(e){e&&(this.awardId=e.id,game.TriggerMgr.inst().achievementTypeTrigger(this.awardId),b8e.evt.dptG(game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE))},isUnlockBianShenTwo:function(){return!0},isUnlockBianShenThree:function(){return!0},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ACHIEVEMENT_ALERT,null,this.achievementAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ACHIEVEMENT_PRIZE_ALERT,null,this.achievementPrizeAlert,this)},achievementPrizeAlert:function(){var e=game.ccfg.AchievementAwardCfg.getDataById(this.awardId+1);return!!(e&&this.score>=e.score)},achievementAlert:function(){for(var e=this._achievementMaps.values(),t=0;t<e.length;t++){if(1==e[t].state)return!0}return!1}}),game.AchievementMgr._instance=null,game.AchievementMgr._singleton=!0,game.AchievementMgr.inst=function(){return null==game.AchievementMgr._instance&&(game.AchievementMgr._singleton=!1,game.AchievementMgr._instance=new game.AchievementMgr,game.AchievementMgr._singleton=!0),game.AchievementMgr._instance}},{}],34:[function(e,t,i){"use strict";game.AchievementItem=game.SkinUI.extends({_data:null,_effect:null,_taskString:"",_prizeString:"",_scoreString:"",_maskWidth:208,_prizeInfo:null,itemInfo:null,ctor:function(){this._super("achievement/AchievementItemSkin","AchievementItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACHIEVEMENT_EFFECT,this.itemRenderIndex),this._effect.addToParent(this._skin.getPrize),this._effect.setAnchor(.5,.5)),b8e.evt.onC(this._skin.goto,this.clickGoToDo,this),b8e.evt.onC(this._skin.getPrize,this.clickGetPrize,this),b8e.evt.onC(this._skin.taskPrizeName.node,this.showPrizeInfoTips,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.goto,this.clickGoToDo,this),b8e.evt.offC(this._skin.getPrize,this.clickGetPrize,this),b8e.evt.offC(this._skin.taskPrizeName.node,this.showPrizeInfoTips,this)},setData:function(e){if(this._data=e,this._skin&&e){var t=game.ccfg.AchievementCfg.getDataById(e.id);if(t){var i=t.score+"";this._scoreString!=i&&(this._skin.score.string=i,this._scoreString=i),t.isAlert?(this._skin.highIcon.active=!0,this._skin.alert.active=!0,this._skin.nomralIcon.active=!1):(this._skin.highIcon.active=!1,this._skin.alert.active=!1,this._skin.nomralIcon.active=!0);var n=t.condition,s=t.des;if(this._taskString!=s&&(this._skin.task.string=s,this._taskString=s),this._prizeString!=t.reward&&(this._skin.prize.string=t.reward,this._prizeString=t.reward),1==e.state){this._skin.goto.active=!1,this._skin.getPrize.active=!0;var a=game.ClientCfg.getUIFxs(10055);this._effect.load(a),this._effect.play()}else this._skin.goto.active=!0,this._skin.getPrize.active=!1,this._effect.clear();var o=e.progress/n.Value;if(1<o&&(o=1),this._skin.maskNode.width=this._maskWidth*o,this._skin.progressLab.string=e.progress+"/"+n.Value,this._prizeInfo.setupById(t.dropid),this._prizeInfo._prizeArr||0<this._prizeInfo._prizeArr.length){var r=this._prizeInfo._prizeArr[0];if(game.upgrade.isCurrencyById(r.itemId))this._skin.taskPrizeName.node.active=!1,this._skin.yuanBaoPrize.active=!0,this._skin.prize.string=""+r.num;else{if(this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(r.itemId),!this.itemInfo)return;this._skin.taskPrizeName.string=game.html.getText(game.html.getColorByQuality(this.itemInfo.quality),"<u>"+this.itemInfo.name+"</u>"),this._skin.taskPrizeName.node.active=!0,this._skin.yuanBaoPrize.active=!1}}}}},clickGoToDo:function(){this._data&&game.AchievementMgr.inst().gotoCompleteAchievement(this._data.id,this.itemRenderIndex)},clickGetPrize:function(){this._data&&game.AchievementMgr.inst().gotoCompleteAchievement(this._data.id,this.itemRenderIndex)},getHeight:function(){return 90},getWidth:function(){return 530},showPrizeInfoTips:function(){this.itemInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this.itemInfo,containerId:game.ContainerId.PRIZE_LIST_ID})}})},{}],35:[function(e,t,i){"use strict";game.appModule.AchievementPanel=game.SkinUIPanel.extends({_westBoundRoadPanel:null,_mainQuestAwardPanel:null,_guildActivePanel:null,_index:-1,ctor:function(e){this._super(e),this._effects=[]},getButtonByName:function(e){var t;switch(e){case"westBoundRoad":return!this._skin||!(t=this._skin.buttonToggle[0].node)||t;case"zhanyao":return!this._skin||!(t=this._skin.buttonToggle[1].node)||t;case"dujie":return!this._skin||!(t=this._skin.buttonToggle[2].node)||t}return null},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"1"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"2"==e?(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]):"3"!=e||(this._skin.buttonToggle[3].check(),this.onSelectPanelByIndex(3),this._skin.buttonToggle[3]))},init:function(){this._westBoundRoadPanel||(this._westBoundRoadPanel=new game.WestBoundRoadPanel,this._westBoundRoadPanel.addToParent(this._skin.page)),this._mainQuestAwardPanel||(this._mainQuestAwardPanel=new game.MainQuestAwardPanel,this._mainQuestAwardPanel.addToParent(this._skin.page)),this._guildActivePanel||(this._guildActivePanel=new game.GuildActivePanel,this._guildActivePanel.addToParent(this._skin.page))},onShow:function(){this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this.onSelectPanelByIndex(this._index),game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)?b8e.ShaderUtil.reset(this._skin.buttonToggle[2].node,!0):b8e.ShaderUtil.setGray(this._skin.buttonToggle[2].node,!0),game.funcOpen.checkOpen(game.FunctionType.GUILD)?b8e.ShaderUtil.reset(this._skin.buttonToggle[3].node,!0):b8e.ShaderUtil.setGray(this._skin.buttonToggle[3].node,!0),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickWestBoundRoadBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickZhanyaoBtn,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickChumoBtn,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onClickGuildTask,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onHide:function(){this.hidePanel(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickWestBoundRoadBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickZhanyaoBtn,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickChumoBtn,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onClickGuildTask,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},hidePanel:function(){this._westBoundRoadPanel.hide(),this._mainQuestAwardPanel.hide(),this._guildActivePanel.hide(),this._index=-1},onSpotAlertChange:function(){this._skin.westBoundRoadRedPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ACHIEVEMENT_ALERT),this._skin.chumoRedPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REINCARNATION_ALERT),this._skin.zhanyaoRedPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MAINQUEST_AWARD_ALERT),this._skin.guildTaskPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.DAILY_TASK)},onClickWestBoundRoadBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickChumoBtn:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.JING_JIE)){if(2==this._index)return;this.onSelectPanelByIndex(2)}else this._skin.buttonToggle[this._index].check()},onClickZhanyaoBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onClickGuildTask:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.GUILD))if(game.guild.isHasGuild()){if(3==this._index)return;this.onSelectPanelByIndex(3)}else this._skin.buttonToggle[this._index].check(),game.app.show(game.AppConstant.GUILD_PANEL);else this._skin.buttonToggle[this._index].check()},onSelectPanelByIndex:function(e){switch(this.hidePanel(),this._index=e){case 0:this._skin.buttonToggle[0].check(),this._skin.title.string="西游之路",this._westBoundRoadPanel.show();break;case 1:this._skin.buttonToggle[1].check(),this._skin.title.string="一路向西",this._mainQuestAwardPanel.show();break;case 2:break;case 3:this._skin.buttonToggle[3].check(),this._skin.title.string="每日任务",this._guildActivePanel.show()}}})},{}],36:[function(e,t,i){"use strict";game.AchievementPrizeItem=game.SkinUI.extends({_data:null,_iconSprite:null,ctor:function(){this._super("achievement/AchievementPrizeItemSkin","AchievementPrizeItemSkin")},onShow:function(){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.achievementIcon)),this.setData(this._data),b8e.evt.onC(this._skin.achievementNode,this.showPrizeInfoTips,this)},onHide:function(){this._iconSprite&&this._iconSprite.unloadTexture(),b8e.evt.offC(this._skin.achievementNode,this.showPrizeInfoTips,this)},setData:function(e){if(this._data=e,this._skin&&e){var t=e;if(t){var i=t.score<=game.AchievementMgr.inst().score;if(this._skin.achievementTipsNode.active=!i,this._skin.getedPrizeTips.active=i,1==t.type)this._skin.nextPrize.active=!0;else if(3==t.type){this._skin.nextPrize.active=!1,this._skin.bianshenMask.active=!0;var n=game.AchievementMgr.inst().getBianshenIdById(t.value),s=game.ccfg.BianshenCfg.getIconById(n);this._iconSprite.loadTexture(game.ClientCfg.getImgUrl(s),null,null,{useManifest:!1})}else this._skin.bianshenMask.active=!1;this._skin.prizeDes.string=t.name,this._skin.achievementNum.string=t.score,this._skin.achievementId.string=e.id}}},getHeight:function(){return 115},getWidth:function(){return 530},showPrizeInfoTips:function(){if(this._data){var e=game.ccfg.AchievementAwardCfg.getDataById(this._data.id);if(e)if(2<this._data.id&&3==e.type){var t=game.AchievementMgr.inst().getBianshenIdById(e.value),i=game.ccfg.BianshenCfg.getBianshenCfgById(t);i&&game.bianshen.showBianshenDetail(i)}else 2<this._data.id?game.app.show(game.AppConstant.ACHIEVEMENT_AWARD_PANEL,this._data.id):game.notice.show("解锁变身槽位");else game.notice.show("新的奖励敬请期待")}}})},{}],37:[function(e,t,i){"use strict";game.appModule.AchievementPrizePanel=game.SkinUIPanel.extends({list:null,m_data:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.AchievementPrizeItem)},onShow:function(){this.m_data=game.AchievementMgr.inst().getPrizeInfoCfg(),this._list.setData(this.m_data),this._list.show()},onHide:function(){this._list&&this._list.hide()}})},{}],38:[function(e,t,i){"use strict";game.appModule.AchievementSpriteStat=game.SkinUIPanel.extends({activeStats:null,nextActiveStats:null,awardId:1,onShow:function(){null==this.data?this.awardId=1:this.awardId=this.data,this.initStats(),this.showStat()},onHide:function(){},initStats:function(){var e;if(!this.activeStats){this.activeStats=[];for(var t=0;t<3;t++)(e=this.getLabText()).node.setPosition(0,-30*t),e.node.color=b8e.ColorUtil.toCCColor(game.html.Q_WHITE),this._skin.activeStat.addChild(e.node),this.activeStats.push(e)}if(!this.nextActiveStats)for(this.nextActiveStats=[],t=0;t<3;t++)(e=this.getLabText()).node.setPosition(0,-30*t),e.node.color=b8e.ColorUtil.toCCColor(game.html.GRAY_WHITE),this._skin.nextActiveStat.addChild(e.node),this.nextActiveStats.push(e)},showStat:function(){var e,t,i,n=this.awardId,s=game.ccfg.AchievementAwardCfg.getDataById(n),a=game.ccfg.AchievementAwardCfg.getDataById(n+1);if(s&&2==s.type)if(a)if(s&&a){if(this._skin.dontActive.active=!1,this._skin.nextActiveNode.active=!0,this._skin.activeName.string=s.name+"",this._skin.activeLv.string="Lv."+s.lv,e=game.ccfg.SpriteStatCfg.getSpriteStatById(s.value)){i=e.getSpriteStats();for(o=0;o<3;o++)t=i[o],this.activeStats[o].string=t?game.ccfg.AttrRulesCfg.getAttrNameByType(t.type)+" +"+t.value:""}if(this._skin.nextActiveLv.string="Lv."+a.lv,e=game.ccfg.SpriteStatCfg.getSpriteStatById(a.value)){i=e.getSpriteStats();for(o=0;o<3;o++)t=i[o],this.nextActiveStats[o].string=t?game.ccfg.AttrRulesCfg.getAttrNameByType(t.type)+" +"+t.value:""}this._skin.activeCondition.string="激活需成就点达到"+game.html.getText(game.html.Q_GREEN,a.score)+"点",this._skin.activeCondition.node.y=30,this._skin.bg.node.height=380}else b8e.warn("AchievementSpriteStat 这是一个错误提示！！！");else{if(this._skin.dontActive.active=!1,!s)return void b8e.warn("提示错误，最终奖励错误了？");this._skin.activeName.string=s.name,this._skin.nextActiveNode.active=!1,this._skin.activeLv.string="Lv."+s.lv,i=(e=game.ccfg.SpriteStatCfg.getSpriteStatById(s.value)).getSpriteStats();for(var o=0;o<3;o++)t=i[o],this.activeStats[o].string=t?game.ccfg.AttrRulesCfg.getAttrNameByType(t.type)+" +"+t.value:"";this._skin.activeCondition.string="已激活全部属性",this._skin.activeCondition.node.y=200,this._skin.bg.node.height=230}else{if(!a)return void b8e.warn("提示错误，找不到成就开始的奖励，也没有下一阶段的？");this._skin.activeName.string=a.name,this._skin.dontActive.active=!0,this._skin.nextActiveNode.active=!1,this._skin.activeLv.string="",i=(e=game.ccfg.SpriteStatCfg.getSpriteStatById(a.value)).getSpriteStats();for(var o=0;o<3;o++)t=i[o],this.activeStats[o].string=t?game.ccfg.AttrRulesCfg.getAttrNameByType(t.type)+" +"+t.value:"";this._skin.activeCondition.string="激活需成就点达到"+game.html.getText(game.html.Q_GREEN,a.score)+"点",this._skin.activeCondition.node.y=178,this._skin.bg.node.height=230}},getLabText:function(){var e=b8e.BaseDisplay.get().getNode().addComponent(cc.Label);return e.overflow=b8e.OverflowType.NONE,e.horizontalAlign=b8e.HorizontalAlign.LEFT,e.verticalAlign=b8e.VerticalAlign.TOP,e.fontSize=18,e.node.width=100,e.node.height=20,e.node.setAnchorPoint(0,.5),e}})},{}],39:[function(e,t,i){"use strict";game.WestBoundRoadPanel=game.SkinUI.extends({_list:null,_getPrizeEffect:null,_effects:null,_iconSprite:null,_maskWidth:374,_type:1,ctor:function(){this._super("achievement/WestBoundRoadSkin","WestBoundRoadSkin"),this._effects=[]},onShow:function(){if(this._list||(this._list=new b8e.List(this._skin.list,game.AchievementItem)),this._getPrizeEffect||(this._getPrizeEffect=b8e.Animator.get(game.AnimatorType.ACHIEVEMENT_SCORE_ALERT_EFFECT,1),this._getPrizeEffect.addToParent(this._skin.prizeEffect),this._getPrizeEffect.setAnchor(.5,.5)),this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.bianshenIcon)),this._list&&this._list._itemrenderPool)for(var e=0;e<this._list._itemrenderPool.length;e++)this._list._itemrenderPool[e].alpha=1;this._list.show(),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_REFRESH,this.onRefreshPanel),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_SUCCESS,this.onAchievementSuccess),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.onRefreshPanel),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.onC(this._skin.prize,this.clickPrize,this),b8e.evt.onC(this._skin.prizeBtn,this.showPrizePanel,this),b8e.evt.onC(this._skin.buttonToggle[0].node,this.showFirstType,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.showSecondType,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.showThirdType,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.showFourthType,this),b8e.evt.onC(this._skin.buttonToggle[4].node,this.showFifthType,this),game.AchievementMgr.inst().getData()},onHide:function(){this._list&&this._list.hide(),this._iconSprite&&this._iconSprite.unloadTexture(),b8e.evt.offC(this._skin.prize,this.clickPrize,this),b8e.evt.rmvG(this,game.AchievementEvent.ACHIEVEMENT_REFRESH,this.onRefreshPanel),b8e.evt.rmvG(this,game.AchievementEvent.ACHIEVEMENT_SUCCESS,this.onAchievementSuccess),b8e.evt.rmvG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.onRefreshPanel),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.offC(this._skin.prizeBtn,this.showPrizePanel,this),b8e.evt.offC(this._skin.buttonToggle[0].node,this.showFirstType,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.showSecondType,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.showThirdType,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.showFourthType,this),b8e.evt.offC(this._skin.buttonToggle[4].node,this.showFifthType,this);for(var e=0;e<this._effects.length;e++){var t=this._effects[e];t.release(),b8e.Tween.kill(t)}this._effects.length=0},_isPlayEffect:!1,onSpotAlertChange:function(){var e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ACHIEVEMENT_PRIZE_ALERT);if(this._skin.prizeAlert.active=e){if(0==this._isPlayEffect){var t=game.ClientCfg.getUIFxs(10054);this._getPrizeEffect.load(t),this._getPrizeEffect.play(),this._isPlayEffect=!0}}else this._isPlayEffect=!1,this._getPrizeEffect.clear()},onRefreshPanel:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.setShowType();var t=game.AchievementMgr.inst().score;this._skin.nowProgress.string=t;var i=game.AchievementMgr.inst().awardId,n=game.ccfg.AchievementAwardCfg.getDataById(i),s=game.ccfg.AchievementAwardCfg.getDataById(i+1),a=0,o=0;if(n?(a=n.score,this._skin.lastProgress.string=a+""):this._skin.lastProgress.string="0",this._skin.achievementId.string=i,s){o=s.score,this._skin.maxProgress.string=o+"";var r=(t-a)/(o-a);if(1<r&&(r=1),this._skin.mask.width=this._maskWidth*r,1==s.type)this._skin.nextPrize.active=!0;else if(this._skin.nextPrize.active=!1,3==s.type){this._skin.bianshenMask.active=!0;var h=game.AchievementMgr.inst().getBianshenIdById(s.value),g=game.ccfg.BianshenCfg.getIconById(h);this._iconSprite.loadTexture(game.ClientCfg.getImgUrl(g),null,null,{useManifest:!1})}else this._skin.bianshenMask.active=!1;this._skin.nextPrizeDes.string=s.name,e||(this._skin.mask.width=0,this._skin.nextPrize.active=!1,this._skin.maxProgress.string="敬请期待",this._skin.nextPrizeDes.string="敬请期待")}this.onSpotAlertChange();for(var l=1;l<=5;++l)this._skin.btnRedIcon[l-1].active=game.AchievementMgr.inst().isShowRedIconByType(l)},onAchievementSuccess:function(e){var t=this._list.getItemRender(e.data);if(t){var i=this._list.getItemRenderLocalToGlobal(t);i.x=i.x-200;var n=b8e.Animator.get(game.AnimatorType.ACHIEVEMENT_EFFECT,e.data);n.addToParent(this._skin.effect),n.setPosition(i),n.setAnchor(.5,.5);var s=game.ClientCfg.getUIFxs(10037);n.load(s),n.play(),this._effects.push(n),b8e.Tween.get(n).to({x:this._skin.nowProgress.node.x,y:this._skin.nowProgress.node.y},500).call(this._releaseSelf,this,[n]),b8e.Tween.get(t).to({alpha:0},500).call(this._achievementSuccessCall,this,[t])}else this._achievementSuccessCall()},_releaseSelf:function(e){if(e){b8e.Tween.kill(e),e.release();var t=this._effects.indexOf(e);-1!=t&&this._effects.splice(t,1)}this.onRefreshPanel(!0)},_achievementSuccessCall:function(e){e&&(b8e.Tween.kill(e),e.x=0,e.alpha=1)},clickPrize:function(){game.AchievementMgr.inst().getPrize()},showPrizePanel:function(){game.app.show(game.AppConstant.ACHIEVEMENT_PRIZE_PANEL)},setShowType:function(){var e=game.AchievementMgr.inst().getAchievementListByType(this._type);this._list.setData(e)},showFirstType:function(){this._type=game.AchievementType.TYPE_FIRST,this.setShowType()},showSecondType:function(){this._type=game.AchievementType.TYPE_SECOND,this.setShowType()},showThirdType:function(){this._type=game.AchievementType.TYPE_THIRD,this.setShowType()},showFourthType:function(){this._type=game.AchievementType.TYPE_FOURTH,this.setShowType()},showFifthType:function(){this._type=game.AchievementType.TYPE_FIFTH,this.setShowType()}})},{}],40:[function(e,t,i){"use strict";game.AchievementSender={},game.AchievementSender.initData=function(){var e=game.pbmid.Achievement.AchievementRequest;b8e.sendN(e)},game.AchievementSender.completeAchievement=function(e){if(!game.reqLock.isReqLocked(game.pbmid.Achievement.AchievementCompleteRequest,!0)){var t=game.pbmsg.AchievementCompleteRequest;t.id=e,b8e.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Achievement.AchievementCompleteRequest;b8e.sendN(i),game.reqLock.lockReq(i)}},game.AchievementSender.getPrize=function(){var e=game.pbmid.Achievement.AchievementAwardRequest;b8e.sendN(e)}},{}],41:[function(e,t,i){"use strict";e("./event/ActiveBarEvent"),e("./info/ActiveBarItemInfo"),e("./info/ActiveBarItemType"),e("./mgr/ActiveBarMgr"),e("./panel/ActiveBarItem")},{"./event/ActiveBarEvent":42,"./info/ActiveBarItemInfo":43,"./info/ActiveBarItemType":44,"./mgr/ActiveBarMgr":45,"./panel/ActiveBarItem":46}],42:[function(e,t,i){"use strict";game.ActiveBarEvent=b8e.Enum({ACTIVE_BAR_CHANGE:b8e.Event.nextCode(),ACTIVE_BAR_ADD:b8e.Event.nextCode(),ACTIVE_BAR_REMOVE:b8e.Event.nextCode()})},{}],43:[function(e,t,i){"use strict";game.ActiveBarItemInfo=b8e.Object.extends({id:0,startTime:0,endTime:0,sortId:0,startCallBack:function(){b8e.Timer.remove(this,this.startCallBack),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_ADD,this.id)},endCallBack:function(){b8e.Timer.remove(this,this.endCallBack),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_REMOVE,this.id)}})},{}],44:[function(e,t,i){"use strict";game.ActiveBarItemType=b8e.Enum({LOGIN:1,OPEN_SERVER:2,ACTIVE_TARGET:3,WELFARE:4,SHARE:5,MICRO:6,ADD_SHORTCUT:7,FOCUS:8,WANBAGAME_VIP:9,MILLIONAWARD:10,US_ACTIVE:11,REAL_VERIFY:12,CONVERSION:13,VIP_CUSTOMER:14,WORLDCUP:15,XIAN_LAI_EXIT:16,JD_618_GIFT_BAG:17,JD_618_ACTIVE_PAGE:18,OPEN_SERVER_COMPETE:19,FUND:20,ROULETTE:21,GIFT:22,COMPETE:23,FESTIVAL_2:24,WX_ADD_SHORTCUT:25,WX_FOCUS:26,OPEN_SERVER_SUB_TYPE_1:101,OPEN_SERVER_SUB_TYPE_2:102,OPEN_SERVER_SUB_TYPE_3:103,OPEN_SERVER_SUB_TYPE_4:104,OPEN_SERVER_SUB_TYPE_5:105,OPEN_SERVER_SUB_TYPE_6:106,OPEN_SERVER_SUB_TYPE_7:107,OPEN_SERVER_SUB_TYPE_8:108,FESTIVAL_LOGIN:201,FESTIVAL_LOGIN_1:202,FESTIVAL_LOGIN_2:203,FESTIVAL_LOGIN_3:204,FESTIVAL_LOGIN_4:205,OPEN_SERVER_1:301,CROSS_SERVER:401,QQ_INTEREST_TRIBE:999})},{}],45:[function(e,t,i){"use strict";game.ActiveBarMgr=b8e.Object.extends({_barMap:null,_allBarMap:null,_firstClickArr:null,_isAddG:!0,_init:!1,_timeData:null,ctor:function(){this._super(),game.IS_SHIELD_IOS_RECHARGE||(this._firstClickArr=[],this._barMap=b8e.HashMap.get(),this._allBarMap=b8e.HashMap.get(),this._timeData=new game.TimeData)},initBar:function(e){if(!game.IS_SHIELD_IOS_RECHARGE&&(!this._init||e)){this._init=!0,this._barMap.clear(),this._allBarMap.clear();var t,i,n,s,a,o=game.ccfg.ActiveBarCfg.getDatas(),r=game.SysTime.curTime,h=game.mainRole.mainRoleData.miscData.openServerDay,g=b8e.TimeUtil.getNextDateTime(r,0);b8e.log("服务器0点时间:",b8e.TimeUtil.formatTimestamp(g));var l=new Date;l.setTime(r);for(var c=0;c<o.length;c++)t=o[c],(i=new game.ActiveBarItemInfo).id=t.id,i.sortId=t.sortId,t.startTime?(this._timeData.setup(t.startTime),i.startTime=this._timeData.getBeforeTime(l).getTime(),t.endTime?(this._timeData.setup(t.endTime),i.endTime=this._timeData.getNextTime(l).getTime()):t.duration&&(i.endTime=i.startTime+t.duration*b8e.TimeUtil.MINUTE_MICRO_SECONDS),a=r):t.openServerStartTime&&(n=t.openServerStartTime-h,i.startTime=b8e.TimeUtil.getNextDateTime(r,n),t.openServerEndTime&&(s=t.openServerEndTime-h+1,i.endTime=b8e.TimeUtil.getNextDateTime(r,s)),a=g),0!=i.startTime&&(i.endTime>a||0==i.endTime)&&(i.endTime>a&&i.startTime<=a||0==i.endTime?this._barMap.set(i.id,i):i.startTime-a,0!=i.endTime&&i.endTime>=a&&i.endTime-a),this._allBarMap.set(i.id,i);b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)}},getActiveItems:function(){if(!game.IS_SHIELD_IOS_RECHARGE){var e=[];if(!this._barMap)return e;for(var t=this._barMap.values(),i=0;i<t.length;i++){var n=t[i];this.isShowActive(n.id)&&e.push(n)}return e.sort(this.sortActive),e}},sortActive:function(e,t){return e.sortId-t.sortId},addBarItem:function(e){if(!game.IS_SHIELD_IOS_RECHARGE){var t=this._allBarMap.get(e.data);t?(this._barMap.set(t.id,t),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)):b8e.warn("添加一个活动，但是在列表里面找不到？？",e.data)}},removeBarItem:function(e){if(!game.IS_SHIELD_IOS_RECHARGE){var t=this._barMap.get(e.data);t?(this._barMap.del(t.id),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)):b8e.warn("移除一个活动，但是在列表里面找不到？？",e.data)}},getActiveBarAlert:function(){if(game.IS_SHIELD_IOS_RECHARGE)return!1;if(!this._barMap)return!1;var i=!1;return this._barMap.every(function(e,t){return!this.isShowActive(t.id)||!this.getTypeIsAlert(t.id)||!(i=!0)},this),i},getTypeIsAlert:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return!1;if(!this.checkIsOpen(e))return!1;switch(e){case game.ActiveBarItemType.LOGIN:return game.active.hasNeedGetDaysPrize();case game.ActiveBarItemType.OPEN_SERVER:case game.ActiveBarItemType.OPEN_SERVER_1:return game.active.getTargetTitleIsAlert();case game.ActiveBarItemType.WELFARE:return game.welfare.isAlert();case game.ActiveBarItemType.SHARE:return game.ShareMgr.inst().getShowAlert();case game.ActiveBarItemType.MICRO:case game.ActiveBarItemType.ADD_SHORTCUT:case game.ActiveBarItemType.REAL_VERIFY:return!0;case game.ActiveBarItemType.FOCUS:return game.LoginConfig.isFocus;case game.ActiveBarItemType.FESTIVAL_LOGIN:case game.ActiveBarItemType.FESTIVAL_LOGIN_1:case game.ActiveBarItemType.FESTIVAL_LOGIN_2:case game.ActiveBarItemType.FESTIVAL_LOGIN_3:case game.ActiveBarItemType.FESTIVAL_LOGIN_4:return game.active.getFestivalAlert();case game.ActiveBarItemType.WANBAGAME_VIP:case game.ActiveBarItemType.QQ_INTEREST_TRIBE:return!1;case game.ActiveBarItemType.MILLIONAWARD:return game.welfare.isMillionAlert();case game.ActiveBarItemType.US_ACTIVE:return game.active.getUSActiveAlert();case game.ActiveBarItemType.CONVERSION:return game.active.isShowConvertRedIcon();case game.ActiveBarItemType.CROSS_SERVER:return game.active.getCrossServerAlert();case game.ActiveBarItemType.WORLDCUP:return game.worldcup.getWorldCupActiveAlert();case game.ActiveBarItemType.OPEN_SERVER_COMPETE:return game.active.isShowCompeteActiveAlert();case game.ActiveBarItemType.GIFT:return game.active.getActiveAlert(game.ActiveType.GIFT);case game.ActiveBarItemType.COMPETE:return game.active.getActiveAlert(game.ActiveType.COMPETE);case game.ActiveBarItemType.FESTIVAL_2:return game.active.getActiveAlert(game.ActiveType.FESTIVAL_2);case game.ActiveBarItemType.FUND:return game.fund.isAlertFund();case game.ActiveBarItemType.ROULETTE:return!game.roulette.getFreeUsedByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER);case game.ActiveBarItemType.WX_ADD_SHORTCUT:return!game.welfare.isGetAddShortcutPrize;case game.ActiveBarItemType.WX_FOCUS:return!1}return!1},isShowActive:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return!1;if(!this.checkIsOpen(e))return!1;switch(e){case game.ActiveBarItemType.LOGIN:return 0==game.active.isGetAllDaysPrize();case game.ActiveBarItemType.OPEN_SERVER:case game.ActiveBarItemType.OPEN_SERVER_1:return game.active.hasActive(game.ActiveType.NEW_SERVER);case game.ActiveBarItemType.WELFARE:case game.ActiveBarItemType.ROULETTE:return!0;case game.ActiveBarItemType.SHARE:return game.LoginConfig.canShare;case game.ActiveBarItemType.MICRO:return game.LoginConfig.canDownloadMicro&&!game.LoginConfig.isMicroLogin;case game.ActiveBarItemType.ADD_SHORTCUT:return game.LoginConfig.canAddShortcut&&!game.welfare.isGetAddShortcutPrize;case game.ActiveBarItemType.FOCUS:return game.LoginConfig.canFocus&&(!game.LoginConfig.isFocus||!game.welfare.isGetFocusPrize);case game.ActiveBarItemType.WX_FOCUS:return!1;case game.ActiveBarItemType.REAL_VERIFY:return game.LoginConfig.hasRealVerify&&(!game.LoginConfig.realVerifyComplete||!game.welfare.isGetVerifyPrize);case game.ActiveBarItemType.FESTIVAL_LOGIN:case game.ActiveBarItemType.FESTIVAL_LOGIN_1:case game.ActiveBarItemType.FESTIVAL_LOGIN_2:case game.ActiveBarItemType.FESTIVAL_LOGIN_3:case game.ActiveBarItemType.FESTIVAL_LOGIN_4:return game.active.hasActive(game.ActiveType.FESTIVAL);case game.ActiveBarItemType.WANBAGAME_VIP:return game.LoginConfig.isWanBaGame;case game.ActiveBarItemType.VIP_CUSTOMER:return game.vip.isShowVipCustomer()&&!game.shield.isShieldRecharge();case game.ActiveBarItemType.MILLIONAWARD:return!game.welfare.getMillionAwardState();case game.ActiveBarItemType.QQ_INTEREST_TRIBE:return game.IS_QZONE&&"QZ"!==game.QzoneSDK.getApp();case game.ActiveBarItemType.US_ACTIVE:return game.active.hasActive(game.ActiveType.UNION_SERVER);case game.ActiveBarItemType.CROSS_SERVER:return game.active.hasActive(game.ActiveType.CROSS_SERVER);case game.ActiveBarItemType.CONVERSION:return game.active.hasActive(game.ActiveType.REBATE_CONVERT);case game.ActiveBarItemType.WORLDCUP:return game.funcOpen.checkOpen(game.FunctionType.SHIJIEBEI);case game.ActiveBarItemType.JD_618_GIFT_BAG:case game.ActiveBarItemType.JD_618_ACTIVE_PAGE:return game.LoginConfig.isActivity;case game.ActiveBarItemType.OPEN_SERVER_COMPETE:return game.funcOpen.checkOpen(game.FunctionType.COMPETE_ACTIVE)&&game.active.isHasCompeteActive();case game.ActiveBarItemType.GIFT:return game.active.hasActive(game.ActiveType.GIFT);case game.ActiveBarItemType.COMPETE:return game.active.hasActive(game.ActiveType.COMPETE);case game.ActiveBarItemType.FESTIVAL_2:return game.active.hasActive(game.ActiveType.FESTIVAL_2);case game.ActiveBarItemType.FUND:return!game.fund.isDisappear()&&!game.shield.isShieldRecharge();case game.ActiveBarItemType.WX_ADD_SHORTCUT:if(b8e.isWeChatGame&&(b8e.log("微信收藏isGetAddShortcutPrize："+game.welfare.isGetAddShortcutPrize),!game.welfare.isGetAddShortcutPrize)){var t=wx.getSystemInfoSync();if(t){var i=t.system,n=t.version;b8e.log("微信操作系统版本："+i+"__微信版本号wxVersionString："+n);var s=/iPad|iPhone|iOS|iPod/.test(i),a=-1<i.indexOf("Android");b8e.log("微信小游戏isIOS："+s+"__微信小游戏isAndroid："+a);var o=!1;if(s)return o=this.getWXVersion(n,"6.7.1"),b8e.log("IOS 微信版本号isUp："+o),o&&!game.welfare.isGetAddShortcutPrize;if(a)return b8e.log("Android 微信版本号isUp："+o),!game.welfare.isGetAddShortcutPrize}}}return!1},getWXVersion:function(e,t){if(game.IS_SHIELD_IOS_RECHARGE)return!1;for(var i=e.split("."),n=t.split("."),s=Math.min(i.length,n.length),a=0,o=0;a<s&&0==(o=parseInt(i[a])-parseInt(n[a]));)a++;return 0<=o},showEffect:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return!1;switch(e){case game.ActiveBarItemType.FESTIVAL_LOGIN:case game.ActiveBarItemType.FESTIVAL_LOGIN_1:case game.ActiveBarItemType.FESTIVAL_LOGIN_2:case game.ActiveBarItemType.FESTIVAL_LOGIN_3:case game.ActiveBarItemType.FESTIVAL_LOGIN_4:case game.ActiveBarItemType.OPEN_SERVER:case game.ActiveBarItemType.OPEN_SERVER_1:case game.ActiveBarItemType.SHARE:case game.ActiveBarItemType.WANBAGAME_VIP:case game.ActiveBarItemType.MILLIONAWARD:case game.ActiveBarItemType.US_ACTIVE:case game.ActiveBarItemType.CONVERSION:case game.ActiveBarItemType.JD_618_GIFT_BAG:case game.ActiveBarItemType.JD_618_ACTIVE_PAGE:case game.ActiveBarItemType.OPEN_SERVER_COMPETE:case game.ActiveBarItemType.GIFT:case game.ActiveBarItemType.COMPETE:case game.ActiveBarItemType.FESTIVAL_2:case game.ActiveBarItemType.FUND:case game.ActiveBarItemType.ROULETTE:if(this._isFirstClick(e))return!0}return!1},_isFirstClick:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return!0;if(-1!=this._firstClickArr.indexOf(e))return!1;switch(e){case game.ActiveBarItemType.SHARE:var t=game.ShareMgr.inst();if(t.shareTimesDaily>=t.maxGetPrizeTimes)return!1;break;case game.ActiveBarItemType.MILLIONAWARD:return game.welfare.isMillionAlert()}return!0},clickActive:function(e){if(!game.IS_SHIELD_IOS_RECHARGE){switch(e){case game.ActiveBarItemType.LOGIN:game.app.show(game.AppConstant.LOGIN_PRIZE_PANEL);break;case game.ActiveBarItemType.ACTIVE_TARGET:break;case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_1:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_2:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_3:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_4:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_5:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_6:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_7:case game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_8:case game.ActiveBarItemType.OPEN_SERVER:case game.ActiveBarItemType.OPEN_SERVER_1:game.app.show(game.AppConstant.ACTIVE_SERVER_PANEL);break;case game.ActiveBarItemType.WELFARE:game.app.show(game.AppConstant.WELFARE_PANEL);break;case game.ActiveBarItemType.SHARE:game.app.show(game.AppConstant.SHARE_PANEL);break;case game.ActiveBarItemType.MICRO:game.app.show(game.AppConstant.MICRO_PANEL);break;case game.ActiveBarItemType.ADD_SHORTCUT:game.app.show(game.AppConstant.ADD_SHORTCUT_PANEL);break;case game.ActiveBarItemType.FOCUS:game.app.show(game.AppConstant.FOCUS_PANEL);break;case game.ActiveBarItemType.WX_FOCUS:game.app.show(game.AppConstant.WX_FOCUS_PANEL);break;case game.ActiveBarItemType.REAL_VERIFY:game.app.show(game.AppConstant.REAL_VERIFY_PANEL);break;case game.ActiveBarItemType.FESTIVAL_LOGIN:case game.ActiveBarItemType.FESTIVAL_LOGIN_1:case game.ActiveBarItemType.FESTIVAL_LOGIN_2:case game.ActiveBarItemType.FESTIVAL_LOGIN_3:case game.ActiveBarItemType.FESTIVAL_LOGIN_4:game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL);break;case game.ActiveBarItemType.WANBAGAME_VIP:game.app.show(game.AppConstant.WANBAGAME_VIPPANEL);break;case game.ActiveBarItemType.MILLIONAWARD:game.app.show(game.AppConstant.MILLIONAWARD_PANEL);break;case game.ActiveBarItemType.QQ_INTEREST_TRIBE:game.sdk.openInterestTribeUrl();break;case game.ActiveBarItemType.US_ACTIVE:game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.UNION_SERVER});break;case game.ActiveBarItemType.CROSS_SERVER:game.app.show(game.AppConstant.CROSS_ACTIVE_PANEL);break;case game.ActiveBarItemType.CONVERSION:game.app.show(game.AppConstant.ACTIVE_CONVERSION_PANEL),game.active.selectType(game.ActiveSubType.ST_FRAGMENT_CONVERT);break;case game.ActiveBarItemType.VIP_CUSTOMER:game.app.show(game.AppConstant.VIP_CUSTOMER_PANEL);break;case game.ActiveBarItemType.WORLDCUP:game.worldcup.rqWorldCupCfgInfo();break;case game.ActiveBarItemType.JD_618_GIFT_BAG:game.app.show(game.AppConstant.JD_618_GIFT_BAG_PANEL);break;case game.ActiveBarItemType.JD_618_ACTIVE_PAGE:b8e.log("打开京东618活动网页："+game.LoginConfig.activityUrl),window.open(game.LoginConfig.activityUrl);break;case game.ActiveBarItemType.OPEN_SERVER_COMPETE:game.app.show(game.AppConstant.ACTIVE_COMPETE_PANEL);break;case game.ActiveBarItemType.GIFT:game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.GIFT});break;case game.ActiveBarItemType.COMPETE:game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.COMPETE});break;case game.ActiveBarItemType.FESTIVAL_2:game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.FESTIVAL_2});break;case game.ActiveBarItemType.FUND:game.app.show(game.AppConstant.WELFARE_PANEL,game.WelfareType.FUND_PANEL);break;case game.ActiveBarItemType.ROULETTE:game.app.show(game.AppConstant.WELFARE_PANEL,game.WelfareType.ROULETTE);break;case game.ActiveBarItemType.WX_ADD_SHORTCUT:game.app.show(game.AppConstant.WX_ADD_SHORTCUT_PANEL)}-1==this._firstClickArr.indexOf(e)&&this._firstClickArr.push(e),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)}},getOpenIdByType:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return 1;var t=game.ccfg.ActiveBarCfg.getDataById(e);return t?t.openId:1},checkIsOpen:function(e){if(game.IS_SHIELD_IOS_RECHARGE)return!1;var t=this.getOpenIdByType(e);return 0==t||!!game.funcOpen.checkOpen(t)}}),game.ActiveBarMgr._instance=null,game.ActiveBarMgr.inst=function(){return game.ActiveBarMgr._instance||(game.ActiveBarMgr._instance=new game.ActiveBarMgr),game.ActiveBarMgr._instance}},{}],46:[function(e,t,i){"use strict";game.ActiveBarItem=game.SkinUI.extends({_data:null,_normal:null,_timer:0,_effect:null,ctor:function(){this._super("active/ActiveBarItemSkin","ActiveTitleItemSkin")},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},initItem:function(){this._normal||(this._normal=b8e.Sprite.get(),this._normal.setAnchor(.5,.5),this._normal.addToParent(this._skin.normalTitle)),this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._effect.setAnchor(.5,.5),this._effect.setPosition(0,-15),this._effect.addToParent(this._skin.normalTitle))},onTouchThis:function(){this._data&&game.activeBar.clickActive(this._data.id)},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActiveBarCfg.getDataById(e.id);if(t){game.activeBar.showEffect(e.id)?(this._effect.load(game.ClientCfg.getUIFxs(10054)),this._effect.play()):this._effect.clear();var i=game.activeBar.getTypeIsAlert(e.id);if(this._skin.alert.active=!!i,t.isShowEndTime)0<e.endTime-game.SysTime.curTime&&(this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.start(),this._skin.endTime.node.active=!0);else this._skin.endTime.node.active=!1,this._timer&&this._timer.stop();var n=game.ClientCfg.getActiveTitleBg(t.titleBg);this._normal.loadTexture(n,null,null,{useManifest:!1})}else b8e.warn("活动 ",e.id,"没有找到配置数据")}},updateTime:function(){if(this._data){var e=this._data.endTime-game.SysTime.curTime;this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_1&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_2&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_3&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_4&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_5&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_6&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_7&&this._data.id!=game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_8||(e-=5*b8e.TimeUtil.MINUTE_MICRO_SECONDS),this._skin.endTime.string=e<0?"已结束":b8e.TimeUtil.formatTime(e,":",3)}else this._timer&&this._timer.stop()}})},{}],47:[function(e,t,i){"use strict";game.ActiveCompeteItem=game.SkinUI.extends({_data:null,_sprite:null,_prizeList:null,_prizeInfo:null,_endTimer:null,ctor:function(){this._super("activeCompete/ActiveCompeteItemSkin","ActiveCompeteItemSkin")},init:function(){this._prizeInfo=new game.PrizeInfo,this._sprite=b8e.Sprite.get(),this._sprite.addToParent(this._skin.discount),this._prizeList=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,1),this._prizeList.addToParent(this._skin.prizeNode)},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.onpenActiveBtn,this.onOpenAcitvePage,this),b8e.evt.addG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankInfoChange)},onHide:function(){this._sprite.unloadTexture(),b8e.evt.offC(this._skin.onpenActiveBtn,this.onOpenAcitvePage,this),b8e.evt.rmvG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankInfoChange)},setData:function(e){if(this._data=e,this._skin&&this._data){this._prizeInfo.setupById(e.prizeId),this._prizeList.setData(this._prizeInfo),e.resStr&&this._sprite.loadTexture(game.ClientCfg.getImgUrl(e.resStr),null,null,{useManifest:!1}),this._skin.indexLab.string=e.openSeverStr,this._skin.redIcon.active=game.active.isCanGetCompeteActivePrize(this._data.activetype2);var t=this._data.activetype2,i=game.active.getSubTypeInfo(t);if(i){var n=i.endTime-game.SysTime.curTime;if(this._skin.maskNode.active=!(0<n),t=this._data.activetype1,i=game.active.getSubTypeInfo(t)){var s=0|game.active.subTypeToRankType(t);game.RankSender.reqRankInfo(s);n=i.endTime-game.SysTime.curTime;if(this._skin.processing.active=0<n,n){var a=i.endTime-5*b8e.TimeUtil.MINUTE_MICRO_SECONDS;this._skin.endTimer.string=b8e.TimeUtil.formatTimestamp(a,"M月D日 h:m结束")}else this._skin.endTimer.string="已结算"}else this._skin.playerName.node.active=!1,this._skin.endTimer.string="已结算",this._skin.processing.active=!1}else this._skin.processing.active=!1,this._skin.endTimer.string="-------",this._skin.playerName.node.active=!1,this._skin.maskNode.active=!0}},onCostRankChange:function(e){var t=e.data.list,i=this._data.activetype2;game.active.getSubTypeInfo(i)&&(t&&0!=t.length?this._skin.playerName.string=game.ccfg.LangCfg.getText(88002,[t[0].name]):this._skin.playerName.string=game.ccfg.LangCfg.getText(88001))},onRankInfoChange:function(){var e=game.active.getCompeteFirstRank(this._data.activetype1);this._skin.playerName.string=e?game.ccfg.LangCfg.getText(88002,[e.name]):game.ccfg.LangCfg.getText(88001)},onOpenAcitvePage:function(){if(this._data){var e=this._data.activetype2,t=game.active.getSubTypeInfo(e);if(t)t.endTime-game.SysTime.curTime&&(game.app.hide(game.AppConstant.ACTIVE_COMPETE_PANEL),game.app.show(game.AppConstant.ACTIVE_COMPETE_SHOW_PANEL,{type1:0|this._data.activetype1,type2:0|this._data.activetype2}))}},getHeight:function(){return 104},getWidth:function(){return 545}})},{}],48:[function(e,t,i){"use strict";game.appModule.ActiveCompetePanel=game.SkinUIPanel.extends({_conversionList:null,_itemList:null,_activeIds:null,_spriteTitle:null,_spriteBg:null,ctor:function(e){this._super(e)},init:function(){this._skin.acitveTimer.string=game.active.getCompeteActivesTimes(),this._itemList=new b8e.List(this._skin.scrollview,game.ActiveCompeteItem)},onShow:function(){var e=game.active.getCompeteActives();this._itemList&&(this._itemList.setData(e),this._itemList.show())},onHide:function(){this._itemList&&(this._itemList.setData(null),this._itemList.hide())}})},{}],49:[function(e,t,i){"use strict";game.ActiveCompeteRankItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("activeCompete/ActiveCompeteRankItemSkin","ActiveCompeteRankItemSkin")},getHeight:function(){return 100},getWidth:function(){return 543},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prize)},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.haveName.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.haveName.node,this.onShowMenu,this)},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActivityCfg.getDataById(e.id);if(t){switch(this._skin.rankOtherLbl.string="",this._skin.firstImg.active=!1,this._skin.secondImg.active=!1,this._skin.thirdImg.active=!1,e.rank){case 0:this._skin.firstImg.active=!0;break;case 1:this._skin.secondImg.active=!0;break;case 2:this._skin.thirdImg.active=!0;break;default:this._skin.rankOtherLbl.string="第"+(e.rank+1)+"名"}this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.have.active=!1,this._skin.dontHave.active=!1;var i,n=game.active.selectSubType,s="";if(e.rankInfo){switch(i=e.rankInfo.score,n){case game.ActiveSubType.ST_RANK_LEVEL:s="等级:"+game.html.getText(game.html.Q_GREEN,i+"级");break;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:s="战斗力:"+game.html.getText(game.html.Q_GREEN,i+"");break;case game.ActiveSubType.ST_RANK_ARENA:i=e.rankInfo.rank,s="封神榜排名:"+game.html.getText(game.html.Q_GREEN,i+"名");break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:s="总星数:"+game.html.getText(game.html.Q_GREEN,i+"星");break;case game.ActiveSubType.ST_RANK_MOUNT:s="坐骑等级:"+game.html.getText(game.html.Q_GREEN,game.MountMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_WING:s="翅膀等级:"+game.html.getText(game.html.Q_GREEN,game.WingMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_FABAO:s="法宝等级:"+game.html.getText(game.html.Q_GREEN,game.FaBaoMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_XIANZHEN:s="仙阵等级:"+game.html.getText(game.html.Q_GREEN,game.XianZhenMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_HIGH_EQUIP:s="神装等级:"+game.html.getText(game.html.Q_GREEN,i)}this._skin.have.active=!0,this._skin.haveLv.string=s,this._skin.haveName.string=e.rankInfo.name}else this._skin.dontHave.active=!0}else b8e.warn("活动 ",e.id,"没有找到配置数据")}},onShowMenu:function(e){if(this._data){var t=game.ccfg.ActivityCfg.getDataById(this._data.id);t?t.activityType!=game.ActiveType.CROSS_SERVER&&game.rank.showRankMenu(this._data.rankInfo,e):b8e.warn("活动 ",this._data.id,"没有找到配置数据")}}})},{}],50:[function(e,t,i){"use strict";game.appModule.ActiveCompeteShowPanel=game.SkinUIPanel.extends({_rankList:null,_targetItem:null,_rankSubType:0,_subTypeInfo:null,_conditionValue:0,_targetSubType:0,_prizeInfo:null,_prizeList:null,_list:null,_curTargetActiveId:null,_discount:null,_endTimer:null,rankSprite:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,1),this._prizeList.addToParent(this._skin.prize),this._list=new b8e.List(this._skin.list,game.ActiveCompeteRankItem),this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount),this.rankSprite=b8e.Sprite.get(),this.rankSprite.addToParent(this._skin.rankNode),this.rankSprite.setAnchor(.5,1),this.rankSprite.loadTexture(game.ClientCfg.competeImgUrl,null,null,{useManifest:!1}),this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)},onShow:function(){if(b8e.evt.onC(this._skin.goto,this.onClickGoto,this),b8e.evt.onC(this._skin.cantGet,this.onClickGoto,this),b8e.evt.onC(this._skin.gotoRebate,this.onClickGotoRebate,this),b8e.evt.onC(this._skin.waitGet,this.getPrize,this),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankChange),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.setTargetData),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.setTargetData),b8e.evt.addG(this,game.ActiveEvent.SHOW_REWARDS,this.getPrizeSuccess),this._list.show(),this.data){if(this._rankSubType=this.data.type1,this._targetSubType=this.data.type2,this._subTypeInfo=game.active.getSubTypeInfo(this._rankSubType),this._subTypeInfo){this._endTimer.reset(),this._endTimer.start(),game.active.selectType(this._rankSubType),this._conditionValue=0,this._skin.rankNode.active=!1;var e=this._subTypeInfo.getActiveIds();if(e&&0<e.length){var t=e[0],i=game.ccfg.ActivityCfg.getDataById(t);i&&i.condition&&1<i.condition.length&&(this._conditionValue=i.condition[1].Value)}}else this._skin.rankNode.active=!0,this._skin.listConditions.node.active=this._rankSubType!=game.ActiveSubType.ST_RANK_ARENA,this._list.setData(null),this._skin.endTimer.string="已结算",this._skin.listConditions.string="已结算",this._skin.mineProgress.string="已结算",this._skin.mineRank.string="已结算";if(this._targetSubType==game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW){var n=game.active.subTypeToCondition(this._targetSubType);game.ActiveSender.getActiveCostMap(n)}var s=game.ccfg.ClientActiveCfg.getDataById(this._rankSubType);s&&""!=s.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(s.discount,!0),null,null,{useManifest:!1}),this.onRankChange(),this.setTargetData()}else b8e.warn("this.data 不存在，无法取得活动类型")},onHide:function(){this._list&&this._list.hide(),this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.goto,this.onClickGoto,this),b8e.evt.offC(this._skin.cantGet,this.onClickGoto,this),b8e.evt.offC(this._skin.gotoRebate,this.onClickGotoRebate,this),b8e.evt.offC(this._skin.waitGet,this.getPrize,this),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankChange),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.setTargetData),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.setTargetData),b8e.evt.rmvG(this,game.ActiveEvent.SHOW_REWARDS,this.getPrizeSuccess)},updateEndTime:function(){var e=game.active.getSubTypeInfo(this._rankSubType);if(e){var t=e.endTime-game.SysTime.curTime-5*b8e.TimeUtil.MINUTE_MICRO_SECONDS;0<t?this._skin.endTimer.string=game.timeUtil.formatTimeSpace(t):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结算")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结算"},onClickGotoRebate:function(){game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.GIFT,activeSubType:game.ActiveSubType.ST_VIP_REBATE})},onClickGoto:function(){var e=!1;switch(this._rankSubType){case game.ActiveSubType.ST_RANK_MOUNT:game.funcOpen.checkOpenWithTips(game.FunctionType.MOUNT)&&(game.AccessoryMgr.showPanel(game.AccessoryType.Mount),e=!0);break;case game.ActiveSubType.ST_RANK_FABAO:game.funcOpen.checkOpenWithTips(game.FunctionType.FA_BAO)&&(game.AccessoryMgr.showPanel(game.AccessoryType.FaBao),e=!0);break;case game.ActiveSubType.ST_RANK_WING:game.funcOpen.checkOpenWithTips(game.FunctionType.WING)&&(game.AccessoryMgr.showPanel(game.AccessoryType.Wing),e=!0);break;case game.ActiveSubType.ST_RANK_ARENA:game.funcOpen.checkOpenWithTips(game.FunctionType.FENG_SHEN_BANG)&&(game.app.show(game.AppConstant.FIGHT_PANEL,0),e=!0);break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_SHENG_XING)&&(game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1),e=!0);break;case game.ActiveSubType.ST_RANK_XIANZHEN:game.funcOpen.checkOpenWithTips(game.FunctionType.XIANZHEN)&&(game.AccessoryMgr.showPanel(game.AccessoryType.XianZhen),e=!0);break;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:game.app.show(game.AppConstant.STRENGTHEN_PANEL),e=!0;break;case game.ActiveSubType.ST_RANK_HIGH_EQUIP:game.funcOpen.checkOpenWithTips(game.FunctionType.HIGHEQUIP)&&(game.app.show(game.AppConstant.HIGHEQUIP_PANEL),e=!0)}e&&this.hide()},onRankChange:function(){if(this._subTypeInfo){var e=game.active.subTypeToRankType(this._rankSubType),t=game.rank.getRankListByType(e);t=game.active.getRankData(t),this._list.setData(t);var i="",n="",s=game.rank.getSelfRanInfoByType(e),a=s?s.score:0;switch(this._rankSubType){case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:i=a+"",n="战力达到"+this._conditionValue;break;case game.ActiveSubType.ST_RANK_ARENA:i="第"+s.rank+"名";break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:i=a+"星",n="总星数达到"+this._conditionValue+"星";break;case game.ActiveSubType.ST_RANK_MOUNT:i=game.MountMgr().getLvString(a),n="坐骑等级达到"+game.MountMgr().getLvString(this._conditionValue);break;case game.ActiveSubType.ST_RANK_WING:i=game.WingMgr().getLvString(a),n="翅膀等级达到"+game.WingMgr().getLvString(this._conditionValue);break;case game.ActiveSubType.ST_RANK_FABAO:i=game.FaBaoMgr().getLvString(a),n="法宝等级达到"+game.FaBaoMgr().getLvString(this._conditionValue);break;case game.ActiveSubType.ST_RANK_XIANZHEN:i=game.XianZhenMgr().getLvString(a),n="仙阵等级达到"+game.XianZhenMgr().getLvString(this._conditionValue);break;case game.ActiveSubType.ST_RANK_HIGH_EQUIP:i=a+"",n="神装等级达到"+this._conditionValue}if(this._skin.mineProgress.string=i,this._rankSubType==game.ActiveSubType.ST_RANK_ARENA?this._skin.listConditions.node.active=!1:(this._skin.listConditions.node.active=!0,this._skin.listConditions.string=n),s){var o="第"+s.rank+"名";this._skin.mineRank.string=s.score<this._conditionValue?"未上榜":o}else this._skin.mineRank.string="未上榜"}},onHighEquipRankChange:function(e){if(this._subTypeInfo&&this._rankSubType==game.ActiveSubType.ST_RANK_HIGH_EQUIP){var t=e.data,i=t.userRank,n=game.active.getRankData(t.list);this._list.setData(n);var s="",a="",o=i?i.score:0;switch(this._rankSubType){case game.ActiveSubType.ST_RANK_HIGH_EQUIP:s=o+"",a="神装等级达到"+this._conditionValue;break;default:b8e.error("活动类型没有找到!活动类型id:"+game.active.selectSubType)}if(this._skin.mineProgress.string=s,this._skin.listConditions.string=a,i){var r="第"+i.rank+"名";this._skin.mineRank.string=i.score<this._conditionValue?"未上榜":r}else this._skin.mineRank.string="未上榜"}},setTargetData:function(){if(this._targetSubType){var e,t,i;this._curTargetActiveId=0;var n=game.active.getSubTypeInfo(this._targetSubType);if(n){var s=n.getActiveIds(),a=game.mainRole.mainRoleData;this._skin.isGet.active=!1,this._skin.cantGet.active=!1,this._skin.waitGet.active=!1;for(var o=s.length,r=0;r<o&&(r==o&&!0,this._curTargetActiveId=s[r],t=game.active.activeIsGetAllPrize(this._curTargetActiveId),e=game.active.targetIsComplete(this._curTargetActiveId),t&&e);r++);t?(i=game.html.Q_GREEN,this._skin.isGet.active=!0):e?(i=game.html.Q_GREEN,this._skin.waitGet.active=!0):(i=game.html.Q_RED,this._skin.cantGet.active=!0);var h=game.ccfg.ActivityCfg.getDataById(this._curTargetActiveId);if(h){var g,l,c,u,m;this._prizeInfo.setupById(h.prize),this._prizeList.setData(this._prizeInfo);for(var _=0;_<h.condition.length;_++)switch(l=(g=h.condition[_]).Type,c=g.Value,l){case game.ActivityConditionType.TARGET_FIGHT_AMOUNT:m=a.getZhanLi(),u=game.html.getText(game.html.LIGHT_YELLOW,"战斗力达到"+c)+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_ARENA:m=game.arena.arenaInfo.rank,u=game.html.getText(game.html.LIGHT_YELLOW,"封神榜排名达到前"+c)+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_EQUIP_STAR:m=game.equip.getTotalStar(),u=game.html.getText(game.html.LIGHT_YELLOW,"全身槽位升星总和达到"+c+"星")+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_MOUNT:m=game.MountMgr().accessoryData.lv,u=game.html.getText(game.html.LIGHT_YELLOW,"坐骑达到"+game.MountMgr().getLvString(c))+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_WING:m=game.WingMgr().accessoryData.lv,u=game.html.getText(game.html.LIGHT_YELLOW,"翅膀达到"+game.WingMgr().getLvString(c))+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_FABAO:m=game.FaBaoMgr().accessoryData.lv,u=game.html.getText(game.html.LIGHT_YELLOW,"法宝达到"+game.FaBaoMgr().getLvString(c))+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW:m=game.active.getActiveConditionValue(this._targetSubType,l),u=game.html.getText(game.html.LIGHT_YELLOW,"穿戴神装总等级"+c+"级")+game.html.getText(i,"("+m+"/"+c+")");break;case game.ActivityConditionType.TARGET_XIANZHEN:m=game.XianZhenMgr().accessoryData.lv,u=game.html.getText(game.html.LIGHT_YELLOW,"仙阵达到"+game.XianZhenMgr().getLvString(c))+game.html.getText(i,"("+m+"/"+c+")")}this._skin.labTargetConditions.string=u}else b8e.warn("活动 ",this._curTargetActiveId,"没有找到配置数据")}else b8e.warn("活动 ",this._targetSubType,"没有该类型活动")}},getPrize:function(){if(this._curTargetActiveId){var e=game.ccfg.ActivityCfg.getDataById(this._curTargetActiveId);if(e){var t=game.mainRole.mainRoleData,i=t.getLv();i<e.minLv?game.notice.show(81e3):0!=e.maxLv&&i>e.maxLv?game.notice.show(81001):e.vip&&e.vip>t.vipLevel?game.notice.show(81002):game.ActiveSender.getActivePrize(this._curTargetActiveId)}else b8e.warn("活动 ",this._curTargetActiveId,"没有找到配置数据")}},getPrizeSuccess:function(e){e&&e.data&&game.back.onShowRewards(e.data)}})},{}],51:[function(e,t,i){"use strict";e("./cmd/ActiveCmd"),e("./event/ActiveEvent"),e("./mgr/ActiveMgr"),e("./panel/ActiveRankItem"),e("./panel/ActiveRankPanel"),e("./panel/ActiveServerPanel"),e("./panel/ActiveShopItem"),e("./panel/ActiveShopPanel"),e("./panel/ActiveTargetItem"),e("./panel/ActiveTargetPanel"),e("./panel/ActiveTitleItem"),e("./panel/LoginPrizeItem"),e("./panel/LoginPrizePanel"),e("./panel/RechargeActivesPanel"),e("./panel/FestivalLoginPanel"),e("./panel/FestivalPrizeItem"),e("./panel/FestivalPrizePanel"),e("./panel/FestivalRebatePanel"),e("./panel/FestivalRebateItem"),e("./panel/ActiveHongBaoPanel"),e("./panel/ActiveBossPanel"),e("./panel/VipRebatePanel")},{"./cmd/ActiveCmd":52,"./event/ActiveEvent":53,"./mgr/ActiveMgr":54,"./panel/ActiveBossPanel":55,"./panel/ActiveHongBaoPanel":65,"./panel/ActiveRankItem":70,"./panel/ActiveRankPanel":71,"./panel/ActiveServerPanel":75,"./panel/ActiveShopItem":76,"./panel/ActiveShopPanel":77,"./panel/ActiveTargetItem":78,"./panel/ActiveTargetPanel":79,"./panel/ActiveTitleItem":80,"./panel/FestivalLoginPanel":89,"./panel/FestivalPrizeItem":90,"./panel/FestivalPrizePanel":91,"./panel/FestivalRebateItem":92,"./panel/FestivalRebatePanel":93,"./panel/LoginPrizeItem":94,"./panel/LoginPrizePanel":95,"./panel/RechargeActivesPanel":96,"./panel/VipRebatePanel":97}],52:[function(e,t,i){"use strict";game.ActiveCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Activity.ActivityNotify,this.onActivityNotify,this),b8e.addNH(game.pbmid.Activity.ActivityModuleProto,this.onActivityModuleProto,this),b8e.addNH(game.pbmid.Activity.ActivityAwardResponse,this.onActivityAwardResponse,this),b8e.addNH(game.pbmid.Activity.LoginPrizeResponse,this.onLoginPrizeResponse,this),b8e.addNH(game.pbmid.Activity.ZhuanPanResponse,this.onZhuanPanResponse,this),b8e.addNH(game.pbmid.Activity.DuoBaoResponse,this.onDuoBaoResponse,this),b8e.addNH(game.pbmid.Activity.CollectZhuanPanCountAwardResponse,this.onCollectZhuanPanCountAwardResponse,this),b8e.addNH(game.pbmid.Activity.TimeLimitRankResponse,this.onTimeLimitRankResponse,this),b8e.addNH(game.pbmid.Activity.ActivityConditionResponse,this.onActivityConditionResponse,this),b8e.addNH(game.pbmid.Activity.ActivityBossInfoResponse,this.onActivityBossInfoResponse,this),b8e.addNH(game.pbmid.Activity.ZhuanPanRecordResponse,this.onZhuanPanRecordResponse,this),b8e.addNH(game.pbmid.Activity.BuyActivityItemResponse,this.onBuyActivityItemRp,this),b8e.addNH(game.pbmid.Activity.MysteryActivityListResponse,this.onMysteryActivityListRp,this),b8e.addNH(game.pbmid.Activity.BuyMysteryActivityResponse,this.onBuyMysteryActivityRp,this),b8e.addNH(game.pbmid.Activity.RefreshMysteryActivityResponse,this.onRefreshMysteryActivityRp,this),b8e.addNH(game.pbmid.Activity.RefreshMysteryActivityNotify,this.onRefreshMysteryActivityNotify,this),b8e.addNH(game.pbmid.Activity.MysteryActivityRecordResponse,this.onMysteryActivityRecordRp,this)},onActivityConditionResponse:function(e){var t=e.readProtobuf(game.pbmsg.ActivityConditionResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.setCostMap(t))},onTimeLimitRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.TimeLimitRankResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):b8e.evt.dptG(game.ActiveEvent.COST_RANK_CHANGE,t))},onLoginPrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.LoginPrizeResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.writeDaysPrize(t.days))},onActivityAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.ActivityAwardResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.getPrizeSuccess(t))},onActivityModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.ActivityModuleProto);t&&game.active.initActiveModule(t)},onActivityNotify:function(e){var t=e.readProtobuf(game.pbmsg.ActivityNotify);t&&game.active.initActive(t)},onZhuanPanResponse:function(e){var t=e.readProtobuf(game.pbmsg.ZhuanPanResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.roulette.synZhuanPan(t.activitySubType,t.awards,t.position)},onDuoBaoResponse:function(e){var t=e.readProtobuf(game.pbmsg.DuoBaoResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.roulette.synDuoBao(t.activitySubType,t.id,t.awards)},onCollectZhuanPanCountAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.CollectZhuanPanCountAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.roulette.synZhuanPanCountAward(t.activitySubType,t.count)},onActivityBossInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.ActivityBossInfoResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.worldBoss.setActiveWorldBossInfo(t)},onZhuanPanRecordResponse:function(e){var t=e.readProtobuf(game.pbmsg.ZhuanPanRecordResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.roulette.synZhuanPanRecord(t.activitySubType,t.record)},onBuyActivityItemRp:function(e){var t=e.readProtobuf(game.pbmsg.BuyActivityItemResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.notice.show("购买成功"),game.active.buyConversionItemSucceed())},onMysteryActivityListRp:function(e){var t=e.readProtobuf(game.pbmsg.MysteryActivityListResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.mysteryActivityListSuccess(t)},onBuyMysteryActivityRp:function(e){var t=e.readProtobuf(game.pbmsg.BuyMysteryActivityResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.buyMysteryActivitySuccess(t)},onRefreshMysteryActivityRp:function(e){var t=e.readProtobuf(game.pbmsg.RefreshMysteryActivityResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.refreshMysteryActivitySuccess(t)},onRefreshMysteryActivityNotify:function(e){var t=e.readProtobuf(game.pbmsg.RefreshMysteryActivityNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.refreshMysteryActivitySuccess(t,!0)},onMysteryActivityRecordRp:function(e){var t=e.readProtobuf(game.pbmsg.MysteryActivityRecordResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.active.mysteryActivityRecordSuccess(t)}})},{}],53:[function(e,t,i){"use strict";game.ActiveEvent=b8e.Enum({GET_PRIZE_CHANGE:b8e.Event.nextCode(),SELECT_SUB_TYPE_CHANGE:b8e.Event.nextCode(),SELECT_FESTIVAL_REBATE_CHANGE:b8e.Event.nextCode(),COST_RANK_CHANGE:b8e.Event.nextCode(),COST_MAP_CHANGE:b8e.Event.nextCode(),GET_ACTIVE_BOSS:b8e.Event.nextCode(),UPDATE_FRAGMENT_CONVERT:b8e.Event.nextCode(),MYSTERY_ACTIVE_CHANGE:b8e.Event.nextCode(),MYSTERY_ACTIVE_RECORD_CHANGE:b8e.Event.nextCode(),SHOW_REWARDS:b8e.Event.nextCode()})},{}],54:[function(e,t,i){"use strict";game.ActiveMgr=b8e.Object.extends({activeMap:null,activeSubMap:null,finishActiveMap:null,loginPrizes:0,selectSubType:0,rankIndex:0,firstClickArr:null,costMap:null,_upgradeInfo:null,crossGroupMap:null,subTypeArr:null,gameAlertInfo:null,fragmentBuyTimes:0,selectFestivalRebateId:0,crossStart:0,crossEnd:0,crossPurchaseStart:0,crossPurchaseEnd:0,worldCupStart:0,worldCupEnd:0,actvieDescType:0,ACTIVE_DESC:0,RAFFLE_DESC:1,_convertActive:null,mysteryIdsMap:null,refreshCountMap:null,mysteryRecordMap:null,selectMysteryActivityId:0,mysteryRefreshTime:0,ctor:function(){this._super(),this.activeMap=b8e.HashMap.get(),this.activeSubMap=b8e.HashMap.get(),this.finishActiveMap=b8e.HashMap.get(),this.costMap=b8e.HashMap.get(),this.crossGroupMap=b8e.HashMap.get(),this.firstClickArr=[],this.subTypeArr=[],this.mysteryIdsMap=b8e.HashMap.get(),this.refreshCountMap=b8e.HashMap.get(),this.mysteryRecordMap=b8e.HashMap.get()},initActiveModule:function(e){if(e){var t,i;this.loginPrizes=e.loginPrizes,this.finishActiveMap.clear(),this.fragmentBuyTimes=e.fragmentBuyTimes;for(var n=0;n<e.activities.length;n++)t=e.activities[n],this.finishActiveMap.set(t.id,t.count);for(n=0;n<e.conditions.length;n++)i=e.conditions[n],this.costMap.set(i.type,i);game.pay.synRechargeConditions(e.conditions),game.roulette.synRoulette(e.zhuanPanData,e.duoBaoData),this.crossStart=e.crossStart,this.crossEnd=e.crossEnd,this.crossPurchaseStart=e.crossPurchaseStart,this.crossPurchaseEnd=e.crossPurchaseEnd,this.worldCupStart=e.worldCupStart,this.worldCupEnd=e.worldCupEnd,this.mysteryRefreshTime=e.mysteryRefreshTime,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)}},initRechargeActives:function(){var e=this.activeMap.get(game.ActiveType.REBATE);if(e&&0<e.length)this.setRechargeActives(e);else{this.setRechargeActives([])}},setRechargeActives:function(e){0!=game.pay.getDiscountId()&&-1==e.indexOf(game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT)&&e.push(game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT),-1==e.indexOf(game.ActiveSubType.ST_RECHARGE_REBATE)&&e.push(game.ActiveSubType.ST_RECHARGE_REBATE),this.activeMap.set(game.ActiveType.REBATE,e)},initActive:function(e){if(e){var t,i,n,s;this.activeMap.clear(),this.activeSubMap.clear();for(var a=!1,o=0;o<e.activity.length;o++){if(i=e.activity[o],(n=new game.ActiveTypeInfo).setup(i),0!=n.crossGroup){var r=this.crossGroupMap.get(n.crossGroup);r||(r=[]),-1==r.indexOf(n.subType)&&r.push(n.subType),this.crossGroupMap.set(n.crossGroup,r)}if(t=n.type,n.subType!=game.ActiveSubType.ST_ZHUANPAN_COMBINE&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_FOREVER&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_FESTIVAL&&n.subType!=game.ActiveSubType.ST_DUOBAO_NORMAL&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_BAOZHU&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_LOW_COST&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_EASTEREGG&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_DIAMOND&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_VIP&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_BIANSHEN&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_NORMAL||a||(game.ActiveSender.ActivityModuleRequest(),a=!0),n.subType==game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE){var h=game.pay.getConditionsInfo(game.ActivityConditionType.TARGET_RECHARGE);h&&n.endTime!=h.expireTime&&game.pay.resetActiveRebate()}(s=this.activeMap.get(t))||(s=[],this.activeMap.set(t,s)),n.activeIds&&0<n.activeIds.length&&(n.subType!=game.ActiveSubType.ST_ZHUANPAN_FOREVER&&n.subType!=game.ActiveSubType.ST_ZHUANPAN_VIP&&s.push(n.subType),this.activeSubMap.set(n.subType,n))}this.activeMap.forEach(function(e,t){t=t.sort(this.sortTypes),this.activeMap.set(e,t)},this),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)}},_timer:null,findNextRemoveActive:function(){this._timer&&this._timer.stop();var e=this.activeSubMap.values(),t=null;if(e){for(var i=0;i<e.length;i++){var n=e[i];(null==t||t.endTime>n.endTime&&n.endTime>game.SysTime.curTime&&0!=n.endTime)&&(t=n)}if(t){var s=t.endTime-game.SysTime.curTime;0<s&&(this._timer||(this._timer=b8e.Timer.add(this,this.callRemoveActive,s,1,0,[t])),this._timer.reset(),this._timer.start())}}},callRemoveActive:function(e){if(e){var t=this.activeMap.get(e.type);if(t&&0<t.length){var i=t.indexOf(t.subType);-1!=i&&t.splice(i,1),0<t.length&&(this.selectSubType=t[0]),this.activeMap.set(e.type,t)}b8e.evt.dptG(game.ActiveEvent.SELECT_SUB_TYPE_CHANGE)}},exchangeGameAlert:function(e){this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo,this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=game.ccfg.LangCfg.getText(74001),this.gameAlertInfo.isShowTips=!0),this.gameAlertInfo.obj={id:e},game.gameAlert.showAlert(this,this.onClickExchange,this.gameAlertInfo)},onClickExchange:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ActiveSender.getActivePrize(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sortTypes:function(e,t){var i=game.ccfg.ClientActiveCfg.getDataById(e),n=game.ccfg.ClientActiveCfg.getDataById(t);return i&&n?i.sortId-n.sortId:e-t},getPrizeSuccess:function(e){if(e){var t=this.finishActiveMap.get(e.id);t?this.finishActiveMap.set(e.id,++t):this.finishActiveMap.set(e.id,1),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.ActiveEvent.GET_PRIZE_CHANGE),b8e.evt.dptG(game.PayEvents.COLLECT_AWARD_SUCCESS),b8e.evt.dptG(game.ActiveEvent.SHOW_REWARDS,e.userItem)}},isGetDaysPrize:function(e){return 0!=(this.loginPrizes&1<<e-1)},writeDaysPrize:function(e){this.loginPrizes=this.loginPrizes|1<<e-1,b8e.evt.dptG(game.ActiveEvent.GET_PRIZE_CHANGE),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},isGetAllDaysPrize:function(){for(var e=game.ccfg.LoginPrizeCfg.getDatas(),t=0;t<e.length;t++){var i=e[t];if(0==this.isGetDaysPrize(i.days))return!1}return!0},hasNeedGetDaysPrize:function(){for(var e=game.mainRole.mainRoleData.miscData,t=game.ccfg.LoginPrizeCfg.getDatas(),i=0;i<t.length;i++){var n=t[i];if(0==this.isGetDaysPrize(n.days)&&e.loginDay>=n.days)return!0}return!1},hasActive:function(e){var t=this.getSubTypes(e);return t&&0!=t.length},isShowDiscountDaily:function(e){for(var t,i=e.length,n=0;n<i;n++)t=e[n],game.pay.getIsCollectedFirstRecharge()||t!=game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT?t!=game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1&&t!=game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2||(e.splice(n,1),this.isShowDiscountDaily(e)):e.splice(n,1)},openDescPanel:function(e){this.actvieDescType=e,game.app.show(game.AppConstant.BAOZHU_DESC_PANEL)},selectType:function(e){this.selectSubType!=e&&(this.selectSubType=e,-1==this.firstClickArr.indexOf(e)&&this.firstClickArr.push(e),b8e.evt.dptG(game.ActiveEvent.SELECT_SUB_TYPE_CHANGE))},getTypeArrByCrossGroup:function(e){return this.crossGroupMap.get(e)},getSubTypeInfo:function(e){return this.activeSubMap.get(e)},hasActiveSubType:function(e){return!!this.activeSubMap.get(e)},canBuyCrossPurchase:function(e,t,i){var n=this.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL),s=this.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE);t<=n&&e<=s?game.ActiveSender.getActivePrize(i):game.pay.showPayPanel()},getSubTypes:function(e){var t=this.activeMap.get(e);return e==game.ActiveType.REBATE&&this.isShowDiscountDaily(t),t||[]},getTargetTitleIsAlert:function(){var e=this.getSubTypes(game.ActiveType.NEW_SERVER);if(!e||0==e.length)return!1;for(var t=0;t<e.length;t++){if(this.getTargetIsAlert(e[t]))return!0}return!1},activeIsGetAllPrize:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);if(!t)return b8e.warn("活动 ",e,"没有找到配置数据"),!0;var i=this.finishActiveMap.get(e);return!!(i&&i>=t.attendTimes)},getTargetIsAlert:function(e){if(e==game.ActiveSubType.ST_ZHUANPAN_EASTEREGG)return game.roulette.getLowCostAlert(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG,game.ActivityConditionType.ZHUANPAN_EASTEREGG);if(e==game.ActiveSubType.ST_ZHUANPAN_DIAMOND)return game.roulette.getLowCostAlert(game.ActiveSubType.ST_ZHUANPAN_DIAMOND,game.ActivityConditionType.ZHUANPAN_DIAMOND);if(e==game.ActiveSubType.ST_ZHUANPAN_LOW_COST)return game.roulette.getLowCostAlert(game.ActiveSubType.ST_ZHUANPAN_LOW_COST,game.ActivityConditionType.LOW_COST_RECHARGE);if(e==game.ActiveSubType.ST_ZHUANPAN_RECHARGE)return game.roulette.getLowCostAlert(game.ActiveSubType.ST_ZHUANPAN_RECHARGE,game.ActivityConditionType.ZHUANPAN_RECHARGE);if(e==game.ActiveSubType.ST_ZHUANPAN_UP_COST)return game.roulette.getLowCostAlert(game.ActiveSubType.ST_ZHUANPAN_UP_COST,game.ActivityConditionType.UP_COST_RECHARGE);if(e==game.ActiveSubType.ST_RECHARGE_REBATE){var t=game.pay.isAlertRebateRecharge();if(1==t&&t)return!0}if(e==game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST)return game.roulette.getGoldedPigAlert();if(e==game.ActiveSubType.ST_RECHARGE_SALE_DAILY&&0==game.pay.getIsCollectedSalePrizeDaily())return!0;if(e==game.ActiveSubType.ST_ZHUANPAN_NORMAL||e==game.ActiveSubType.ST_ZHUANPAN_BAOZHU||e==game.ActiveSubType.ST_ZHUANPAN_COMBINE||e==game.ActiveSubType.ST_ZHUANPAN_FESTIVAL)return!game.roulette.getFreeUsedByType(e);if(e==game.ActiveSubType.ST_WORLD_BOSS)return game.worldBoss.getActiveBossIsAlert();var i=this.getAlertSubInfo(e);if(!i)return!1;for(var n=i.activeIds,s=0;s<n.length;s++){var a=n[s],o=this.activeIsGetAllPrize(a),r=this.targetIsComplete(a);if(0==o&&r)return!0}return!1},getAlertSubInfo:function(e){var t=null;switch(e){case e==game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_COST_RANK_RAFFLE:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:case game.ActiveSubType.ST_COST_RANK_EASTEREGG:case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_VIP_REBATE:case game.ActiveSubType.ST_DAILY_REBATE:case game.ActiveSubType.ST_FESTIVAL_REBATE:case game.ActiveSubType.ST_REBATE:case game.ActiveSubType.ST_DUOBAO_NORMAL:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_SYSTEM_HONGBAO:case game.ActiveSubType.ST_CROSS_REBATE_PURCHASE:case game.ActiveSubType.ST_MYSTERY:case game.ActiveSubType.ST_COST_RANK_CROSS_PURCHASE:case game.ActiveSubType.ST_CROSS_REBATE_ZHUANPAN:case game.ActiveSubType.ST_CROSS_REBATE_STAR:case game.ActiveSubType.ST_CROSS_REBATE_FABAO:case game.ActiveSubType.ST_CROSS_REBATE_REPUTATION:case game.ActiveSubType.ST_CROSS_REBATE_MOUNT:case game.ActiveSubType.ST_CROSS_REBATE_WING:case game.ActiveSubType.ST_CROSS_REBATE_BIANSHEN:case game.ActiveSubType.ST_CROSS_REBATE_XIANZHEN:case game.ActiveSubType.ST_FRAGMENT_CONVERT:case game.ActiveSubType.ST_RANK_XIANZHEN:case game.ActiveSubType.ST_COST_RANK_XIANZHEN:case game.ActiveSubType.ST_RANK_HIGH_EQUIP:break;case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_ZHUANPAN);break;case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_STAR);break;case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_FABAO);break;case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_REPUTATION);break;case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_MOUNT);break;case game.ActiveSubType.ST_COST_RANK_CROSS_WING:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_WING);break;case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_BIANSHEN);break;case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:t=this.getSubTypeInfo(game.ActiveSubType.ST_COST_TARGET_CROSS_XIANZHEN);break;default:t=this.getSubTypeInfo(e)}return t},getIsShowEffect:function(e){if(-1!=this.firstClickArr.indexOf(e))return!1;if(!(s=game.ccfg.ClientActiveCfg.getDataById(e))||!s.showFirstEffect)return!1;var t=this.getSubTypeInfo(e);if(!t)return!1;var i=t.getActiveIds();if(!i||i.length<=0)return!1;switch(e){case game.ActiveSubType.ST_REBATE:for(var n=0;n<i.length;++n){var s;if(s=game.ccfg.ActivityCfg.getDataById(i[n])){var a=this.finishActiveMap.get(i[n]);if(!(a&&a>=s.attendTimes))return!0}}return!1;case game.ActiveSubType.ST_FESTIVAL_REBATE:for(n=0;n<i.length;++n){var o=i[n];if(o)if(!this.activeIsGetAllPrize(o))return!0}return!1;case game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT:return!game.pay.getIsBuyDiscountDaily()}return!0},targetIsComplete:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);if(!t)return b8e.warn("活动 ",e,"没有找到配置数据"),!0;var i=game.mainRole.mainRoleData,n=i.getLv();if(n<t.minLv)return!1;if(0!=t.maxLv&&n>t.maxLv)return!1;if(t.vip&&t.vip>i.vipLevel)return!1;if(t.activitySubType==game.ActiveSubType.ST_COLLECT_EXCHANGE||t.activitySubType==game.ActiveSubType.ST_COLLECT_EXCHANGE_2||t.activitySubType==game.ActiveSubType.ST_COLLECT_EXCHANGE_3)return this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.realCost),game.upgrade.isHasEnoughItem(this._upgradeInfo);if(t.activitySubType==game.ActiveSubType.ST_FRAGMENT_CONVERT)return this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.realCost),game.upgrade.isHasEnoughItem(this._upgradeInfo)&&this.isHasConverTimes(e);if(!t.condition||0==t.condition.length)return!0;for(var s,a,o,r,h,g=this.getSubTypeInfo(t.activitySubType),l=0;l<t.condition.length;l++)switch(a=(s=t.condition[l]).Type,o=s.Value,a){case game.ActivityConditionType.TARGET_LEVEL:if(n<o)return!1;break;case game.ActivityConditionType.TARGET_FIGHT_AMOUNT:if((r=i.getZhanLi())<o)return!1;break;case game.ActivityConditionType.TARGET_REPUTATION:if((r=game.amulet.getAmuletLevel())<o)return!1;break;case game.ActivityConditionType.TARGET_ARENA:if(0==(r=game.arena.arenaInfo.rank)||o<r)return!1;break;case game.ActivityConditionType.TARGET_EQUIP_STAR:if((r=game.equip.getTotalStar())<o)return!1;break;case game.ActivityConditionType.TARGET_MOUNT:if((r=game.MountMgr().accessoryData.lv)<o)return!1;break;case game.ActivityConditionType.TARGET_WING:if((r=game.WingMgr().accessoryData.lv)<o)return!1;break;case game.ActivityConditionType.TARGET_FABAO:if((r=game.FaBaoMgr().accessoryData.lv)<o)return!1;break;case game.ActivityConditionType.TARGET_XIANZHEN:if((r=game.XianZhenMgr().accessoryData.lv)<o)return!1;break;case game.ActivityConditionType.TARGET_ELITE_BOSS:if((r=game.loneyDungeon.getPassLayer())<o)return!1;break;case game.ActivityConditionType.TARGET_RECHARGE:case game.ActivityConditionType.FESTIVAL_LOGIN:case game.ActivityConditionType.FESTIVAL_RECHARGE:if(!(h=game.pay.getConditionsInfo(a)))return!1;if(g&&g.endTime!=h.expireTime)return!1;if(h.value<o)return!1;break;case game.ActivityConditionType.SINGLE_RECHARGE:case game.ActivityConditionType.COST_TARGET_MOUNT:case game.ActivityConditionType.COST_TARGET_WING:case game.ActivityConditionType.COST_TARGET_FABAO:case game.ActivityConditionType.COST_TARGET_EXCHANGE:case game.ActivityConditionType.COST_TARGET_RAFFLE:case game.ActivityConditionType.COST_TARGET_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_REPUTATION:case game.ActivityConditionType.COST_TARGET_STAR:case game.ActivityConditionType.COST_TARGET_BIANSHEN:case game.ActivityConditionType.COST_TARGET_ZHAOCAI:case game.ActivityConditionType.ZHUANPAN_EASTEREGG:case game.ActivityConditionType.COST_TARGET_EASTEREGG:case game.ActivityConditionType.COST_TARGET_DIAMOND:case game.ActivityConditionType.COST_TARGET_DIAMOND_DAILY:case game.ActivityConditionType.COST_TARGET_CROSS_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_CROSS_STAR:case game.ActivityConditionType.COST_TARGET_CROSS_FABAO:case game.ActivityConditionType.COST_TARGET_CROSS_REPUTATION:case game.ActivityConditionType.COST_TARGET_CROSS_MOUNT:case game.ActivityConditionType.COST_TARGET_CROSS_WING:case game.ActivityConditionType.COST_TARGET_CROSS_BIANSHEN:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:case game.ActivityConditionType.COST_TARGET_CROSS_XIANZHEN:case game.ActivityConditionType.COST_TARGET_MOUNT_NEW:case game.ActivityConditionType.COST_TARGET_WING_NEW:case game.ActivityConditionType.COST_TARGET_FABAO_NEW:case game.ActivityConditionType.COST_TARGET_STAR_NEW:case game.ActivityConditionType.NEW_RECHARGE:case game.ActivityConditionType.COST_TARGET_ZHAOCAI_NEW:case game.ActivityConditionType.COST_TARGET_RAFFLE_NEW:case game.ActivityConditionType.COST_TARGET_XIANZHEN_NEW:case game.ActivityConditionType.COST_TARGET_REPUTATION_NEW:case game.ActivityConditionType.COST_TARGET_BIANSHEN_NEW:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_NEW:case game.ActivityConditionType.COST_TARGET_TOWER_NEW:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW:case game.ActivityConditionType.COST_TARGET_XUNBAO_NEW:case game.ActivityConditionType.SINGLE_RECHARGE_2:case game.ActivityConditionType.SINGLE_RECHARGE_3:case game.ActivityConditionType.COST_TARGET_XIANZHEN:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_BIANSHEN:if(!(h=this.costMap.get(a)))return!1;if(g&&g.endTime!=h.expireTime)return!1;if(h.value<o)return!1;break;case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_1:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_2:continue;case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_1:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_2:case game.ActivityConditionType.TIME_LIMIT_RECHARGE_1:case game.ActivityConditionType.TIME_LIMIT_RECHARGE_2:if(!(h=this.costMap.get(a)))return!1;if(g&&g.endTime!=h.expireTime)return!1;if(h.value<o)return!1}return!0},getCrossServerStr:function(){return game.ccfg.LangCfg.getText(78e3,[this.crossStart,this.crossEnd])},getCrossPurchaseServerStr:function(){return game.ccfg.LangCfg.getText(78e3,[this.crossPurchaseStart,this.crossPurchaseEnd])},getWorldCupServerStr:function(){return game.ccfg.LangCfg.getText(78e3,[this.worldCupStart,this.worldCupEnd])},getPurchaseData:function(e){var t=[];if(!this.getSubTypeInfo(this.selectSubType)||!e||0==e.length)return t;var i;i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CROSS_PURCHASELIMITSCORE);for(var n,s=0,a=e.length,o=0;o<a;++o)(n=e[o]).score<i||(++s,n.rank=s,t.push(n));return t},getRankData:function(e){var t=[],i=this.getSubTypeInfo(this.selectSubType);if(!i)return t;var n,s,a=i.getActiveIds();this.rankIndex=0,e.length>a.length&&(e=e.slice(0,a.length));for(var o=0;o<a.length;o++){n=a[o];var r=game.ccfg.ActivityCfg.getDataById(n);r?((s=new game.ActiveRankInfo).id=n,s.rank=o,s=this._getRankInfo(e,r,s),t.push(s)):b8e.warn("活动 ",n,"没有找到配置数据")}return t},_getRankInfo:function(e,t,i){if(e.length>this.rankIndex)var n=e[this.rankIndex];for(var s,a,o,r=!0,h=0;h<t.condition.length;h++)switch(s=(o=t.condition[h]).Type,a=o.Value,s){case game.ActivityConditionType.TARGET_ARENA:n&&n.score>a&&(r=!1),i.value=a;break;case game.ActivityConditionType.TARGET_LEVEL:case game.ActivityConditionType.TARGET_FIGHT_AMOUNT:case game.ActivityConditionType.TARGET_REPUTATION:case game.ActivityConditionType.TARGET_EQUIP_STAR:case game.ActivityConditionType.TARGET_MOUNT:case game.ActivityConditionType.TARGET_WING:case game.ActivityConditionType.TARGET_FABAO:case game.ActivityConditionType.COST_TARGET_MOUNT:case game.ActivityConditionType.COST_TARGET_WING:case game.ActivityConditionType.COST_TARGET_FABAO:case game.ActivityConditionType.COST_TARGET_EXCHANGE:case game.ActivityConditionType.COST_TARGET_RAFFLE:case game.ActivityConditionType.COST_TARGET_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_REPUTATION:case game.ActivityConditionType.COST_TARGET_STAR:case game.ActivityConditionType.COST_TARGET_BIANSHEN:case game.ActivityConditionType.COST_TARGET_ZHAOCAI:case game.ActivityConditionType.COST_TARGET_CROSS_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_CROSS_STAR:case game.ActivityConditionType.COST_TARGET_CROSS_FABAO:case game.ActivityConditionType.COST_TARGET_CROSS_REPUTATION:case game.ActivityConditionType.COST_TARGET_CROSS_MOUNT:case game.ActivityConditionType.COST_TARGET_CROSS_WING:case game.ActivityConditionType.COST_TARGET_CROSS_BIANSHEN:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:case game.ActivityConditionType.COST_TARGET_CROSS_XIANZHEN:case game.ActivityConditionType.COST_TARGET_MOUNT_NEW:case game.ActivityConditionType.COST_TARGET_WING_NEW:case game.ActivityConditionType.COST_TARGET_FABAO_NEW:case game.ActivityConditionType.COST_TARGET_STAR_NEW:case game.ActivityConditionType.NEW_RECHARGE:case game.ActivityConditionType.COST_TARGET_ZHAOCAI_NEW:case game.ActivityConditionType.COST_TARGET_RAFFLE_NEW:case game.ActivityConditionType.COST_TARGET_XIANZHEN_NEW:case game.ActivityConditionType.COST_TARGET_REPUTATION_NEW:case game.ActivityConditionType.COST_TARGET_BIANSHEN_NEW:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_NEW:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_BIANSHEN:case game.ActivityConditionType.COST_TARGET_TOWER_NEW:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW:case game.ActivityConditionType.COST_TARGET_XUNBAO_NEW:case game.ActivityConditionType.TARGET_XIANZHEN:case game.ActivityConditionType.COST_TARGET_XIANZHEN:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP:n&&n.score<a&&(r=!1),i.value=a;break;case game.ActivityConditionType.RANK_LEVEL:case game.ActivityConditionType.RANK_FIGHT_AMOUNT:case game.ActivityConditionType.RANK_REPUTATION:case game.ActivityConditionType.RANK_ARENA:case game.ActivityConditionType.RANK_EQUIP_STAR:case game.ActivityConditionType.RANK_MOUNT:case game.ActivityConditionType.RANK_WING:case game.ActivityConditionType.RANK_FABAO:case game.ActivityConditionType.COST_RANK_MOUNT:case game.ActivityConditionType.COST_RANK_WING:case game.ActivityConditionType.COST_RANK_FABAO:case game.ActivityConditionType.COST_RANK_EXCHANGE:case game.ActivityConditionType.COST_RANK_RAFFLE:case game.ActivityConditionType.COST_RANK_ZHUANPAN:case game.ActivityConditionType.COST_RANK_REPUTATION:case game.ActivityConditionType.COST_RANK_STAR:case game.ActivityConditionType.COST_RANK_BIANSHEN:case game.ActivityConditionType.COST_RANK_ZHAOCAI:case game.ActivityConditionType.COST_RANK_CROSS_ZHUANPAN:case game.ActivityConditionType.COST_RANK_CROSS_STAR:case game.ActivityConditionType.COST_RANK_CROSS_FABAO:case game.ActivityConditionType.COST_RANK_CROSS_REPUTATION:case game.ActivityConditionType.COST_RANK_CROSS_MOUNT:case game.ActivityConditionType.COST_RANK_CROSS_WING:case game.ActivityConditionType.COST_RANK_CROSS_BIANSHEN:case game.ActivityConditionType.COST_RANK_CROSS_PURCHASE:case game.ActivityConditionType.COST_RANK_CROSS_XIANZHEN:case game.ActivityConditionType.COST_RANK_ZHUANPAN_BIANSHEN:case game.ActivityConditionType.RANK_XIANZHEN:case game.ActivityConditionType.COST_RANK_XIANZHEN:case game.ActivityConditionType.COST_RANK_HIGH_EQUIP:n&&n.rank>a&&(r=!1)}return e.length<=this.rankIndex||1==r&&(this.rankIndex++,i.rankInfo=n),i},subTypeToRankType:function(e){switch(e){case game.ActiveSubType.ST_RANK_LEVEL:return game.RankType.RANK_LEVEL;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:return game.RankType.RANK_POWER;case game.ActiveSubType.ST_RANK_AMULET:return game.RankType.RANK_AMULET;case game.ActiveSubType.ST_RANK_ARENA:return game.RankType.RANK_ARENA;case game.ActiveSubType.ST_RANK_EQUIP_STAR:return game.RankType.RANK_STAR;case game.ActiveSubType.ST_RANK_MOUNT:return game.RankType.RANK_MOUNT;case game.ActiveSubType.ST_RANK_WING:return game.RankType.RANK_WING;case game.ActiveSubType.ST_RANK_FABAO:return game.RankType.RANK_FABAO;case game.ActiveSubType.ST_RANK_XIANZHEN:return game.RankType.RANK_XIANZHEN;case game.ActiveSubType.ST_RANK_HIGH_EQUIP:return game.RankType.HIGH_EQUIP}return e},getFestivalAlert:function(){var e=this.getSubTypes(game.ActiveType.FESTIVAL);if(!e||0==e.length)return!1;for(var t=0;t<e.length;t++){if(this.getTargetIsAlert(e[t]))return!0}return!1},getActiveAlert:function(e){var t=this.getSubTypes(e);if(!t||0==t.length)return!1;for(var i=0;i<t.length;i++){if(this.getTargetIsAlert(t[i]))return!0}return!1},getCrossServerAlert:function(){var e=this.getSubTypes(game.ActiveType.CROSS_SERVER);if(!e||0==e.length)return!1;for(var t=0;t<e.length;t++){if(this.getTargetIsAlert(e[t]))return!0}return!1},getUSActiveAlert:function(){var e=this.getSubTypes(game.ActiveType.UNION_SERVER);if(!e||0==e.length)return!1;for(var t=0;t<e.length;t++){if(this.getTargetIsAlert(e[t]))return!0}return!1},getActiveConditionValue:function(e,t){var i,n=game.active.getSubTypeInfo(e);switch(t){case game.ActivityConditionType.FESTIVAL_RECHARGE:case game.ActivityConditionType.FESTIVAL_LOGIN:case game.ActivityConditionType.TARGET_RECHARGE:case game.ActivityConditionType.LOW_COST_RECHARGE:case game.ActivityConditionType.ZHUANPAN_EASTEREGG:i=game.pay.getConditionsInfo(t);break;case game.ActivityConditionType.COST_TARGET_MOUNT:case game.ActivityConditionType.COST_TARGET_WING:case game.ActivityConditionType.COST_TARGET_FABAO:case game.ActivityConditionType.COST_TARGET_EXCHANGE:case game.ActivityConditionType.COST_TARGET_RAFFLE:case game.ActivityConditionType.COST_TARGET_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_REPUTATION:case game.ActivityConditionType.COST_TARGET_STAR:case game.ActivityConditionType.COST_TARGET_BIANSHEN:case game.ActivityConditionType.COST_TARGET_ZHAOCAI:case game.ActivityConditionType.COST_RANK_EASTEREGG:case game.ActivityConditionType.SINGLE_RECHARGE:case game.ActivityConditionType.COST_TARGET_EASTEREGG:case game.ActivityConditionType.COST_TARGET_DIAMOND:case game.ActivityConditionType.COST_TARGET_DIAMOND_DAILY:case game.ActivityConditionType.COST_TARGET_MOUNT_NEW:case game.ActivityConditionType.COST_TARGET_WING_NEW:case game.ActivityConditionType.COST_TARGET_FABAO_NEW:case game.ActivityConditionType.COST_TARGET_STAR_NEW:case game.ActivityConditionType.NEW_RECHARGE:case game.ActivityConditionType.COST_TARGET_ZHAOCAI_NEW:case game.ActivityConditionType.COST_TARGET_RAFFLE_NEW:case game.ActivityConditionType.COST_TARGET_XIANZHEN_NEW:case game.ActivityConditionType.COST_TARGET_REPUTATION_NEW:case game.ActivityConditionType.COST_TARGET_BIANSHEN_NEW:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_NEW:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_BIANSHEN:case game.ActivityConditionType.COST_RANK_ZHUANPAN_BIANSHEN:case game.ActivityConditionType.COST_TARGET_TOWER_NEW:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW:case game.ActivityConditionType.COST_TARGET_XUNBAO_NEW:case game.ActivityConditionType.SINGLE_RECHARGE_2:case game.ActivityConditionType.SINGLE_RECHARGE_3:case game.ActivityConditionType.MYSTERY:case game.ActivityConditionType.COST_TARGET_XIANZHEN:case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP:case game.ActivityConditionType.COST_TARGET_CROSS_WING:case game.ActivityConditionType.COST_TARGET_CROSS_BIANSHEN:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:case game.ActivityConditionType.COST_TARGET_CROSS_XIANZHEN:case game.ActivityConditionType.COST_TARGET_CROSS_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_CROSS_STAR:case game.ActivityConditionType.COST_TARGET_CROSS_FABAO:case game.ActivityConditionType.COST_TARGET_CROSS_REPUTATION:case game.ActivityConditionType.COST_TARGET_CROSS_MOUNT:case game.ActivityConditionType.TIME_LIMIT_RECHARGE_1:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_1:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_1:case game.ActivityConditionType.TIME_LIMIT_RECHARGE_2:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_2:case game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_2:i=this.costMap.get(t)}return i&&n&&n.endTime==i.expireTime?i.value:0},getCostValueByType:function(e){var t=this.subTypeToCondition(e);return this.getActiveConditionValue(e,t)},sendmysteryActivityList:function(e){game.ActiveSender.mysteryActivityListRequest(e)},sendBuyMysteryActivity:function(e){var t=game.ccfg.MysteryActivityCfg.getCfgByShopId(e);t&&(this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.discountCost),game.upgrade.costCheck(this,this._upgradeInfo)&&game.ActiveSender.buyMysteryActivityRequest(this.selectMysteryActivityId,e))},sendRefreshMysteryActivity:function(e){this.refreshCountMap.get(e);var t=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.BUY_BEAUTY_COUNT,game.beauty.buyPowerTimes+1);t&&(this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo=t.upgradeInfo,this._upgradeInfo&&game.upgrade.costCheck(this,this._upgradeInfo)&&game.ActiveSender.refreshMysteryActivityRequest(e))},sendMysteryActivityRecord:function(e){game.ActiveSender.mysteryActivityRecordRequest(e)},mysteryActivityListSuccess:function(e){this.mysteryIdsMap.set(e.activityId,e.goods),this.refreshCountMap.set(e.activityId,e.refreshCount),this.mysteryRefreshTime=e.mysteryRefreshTime,b8e.evt.dptG(game.ActiveEvent.MYSTERY_ACTIVE_CHANGE)},buyMysteryActivitySuccess:function(e){var t=this.mysteryIdsMap.get(e.activityId);if(t&&!(t.length<=0)){for(var i=t.length,n=0;n<i;n++){var s=t[n];s.shopId==e.shopId&&(s.state=!0,t[n]=s)}this.mysteryIdsMap.set(e.activityId,t),b8e.evt.dptG(game.ActiveEvent.MYSTERY_ACTIVE_CHANGE)}},refreshMysteryActivitySuccess:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.mysteryIdsMap.set(e.activityId,e.goods),t)this.mysteryRefreshTime=e.nextRefreshTime;else{var i=this.refreshCountMap.get(e.activityId);i++,this.refreshCountMap.set(e.activityId,i)}b8e.evt.dptG(game.ActiveEvent.MYSTERY_ACTIVE_CHANGE)},mysteryActivityRecordSuccess:function(e){this.mysteryRecordMap.set(e.activityId,e.record),b8e.evt.dptG(game.ActiveEvent.MYSTERY_ACTIVE_RECORD_CHANGE)},getShopIdsById:function(e){var t=this.mysteryIdsMap.get(e);return t||null},getCostNumById:function(e){var t=this.refreshCountMap.get(e);return game.ccfg.CostCfg.getNextCost(game.SystemId.ACTIVITY_MYSTERY,t)},getRecordListById:function(e){return this.mysteryRecordMap.get(e)},getRankSubInfo:function(){var e,t,i=this.getSubTypes(game.ActiveType.NEW_SERVER);if(!i)return null;for(var n=0;n<i.length;n++){e=i[n],t=this.getSubTypeInfo(e);var s=this.isShowActiveBar(e);if(t&&t.type==game.ActiveType.NEW_SERVER&&s)return t}return null},isShowActiveBar:function(e){switch(e){case game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:return!0}return!1},getActiveBarInfo:function(){var e=this.getRankSubInfo();if(!e)return null;var t=this.subTypeToActiveBarType(e.subType);if(!t)return null;var i=new game.ActiveBarItemInfo;return i.endTime=e.endTime,i.id=t,i},subTypeToActiveBarType:function(e){switch(e){case game.ActiveSubType.ST_RANK_LEVEL:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_6;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_8;case game.ActiveSubType.ST_RANK_AMULET:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_4;case game.ActiveSubType.ST_RANK_ARENA:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_2;case game.ActiveSubType.ST_RANK_EQUIP_STAR:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_5;case game.ActiveSubType.ST_RANK_MOUNT:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_1;case game.ActiveSubType.ST_RANK_WING:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_3;case game.ActiveSubType.ST_RANK_FABAO:return game.ActiveBarItemType.OPEN_SERVER_SUB_TYPE_7}return b8e.log("subTypeToRankType 传入了一个错误的类型进来"),0},setCostMap:function(e){if(e){var t=game.pay.getConditionsInfo(e.type);t.value=e.value,t.expireTime=e.expireTime,this.costMap.set(e.type,e),b8e.evt.dptG(game.ActiveEvent.COST_MAP_CHANGE),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)}},subTypeToCondition:function(e){switch(e){case game.ActiveSubType.ST_COST_TARGET_MOUNT:return game.ActivityConditionType.COST_TARGET_MOUNT;case game.ActiveSubType.ST_COST_TARGET_WING:return game.ActivityConditionType.COST_TARGET_WING;case game.ActiveSubType.ST_COST_TARGET_FABAO:return game.ActivityConditionType.COST_TARGET_FABAO;case game.ActiveSubType.ST_COST_TARGET_EXCHANGE:return game.ActivityConditionType.COST_TARGET_EXCHANGE;case game.ActiveSubType.ST_COST_TARGET_RAFFLE:return game.ActivityConditionType.COST_TARGET_RAFFLE;case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN:return game.ActivityConditionType.COST_TARGET_ZHUANPAN;case game.ActiveSubType.ST_COST_TARGET_REPUTATION:return game.ActivityConditionType.COST_TARGET_REPUTATION;case game.ActiveSubType.ST_COST_TARGET_STAR:return game.ActivityConditionType.COST_TARGET_STAR;case game.ActiveSubType.ST_COST_TARGET_BIANSHEN:return game.ActivityConditionType.COST_TARGET_BIANSHEN;case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI:return game.ActivityConditionType.COST_TARGET_ZHAOCAI;case game.ActiveSubType.SINGLE_RECHARGE:return game.ActivityConditionType.SINGLE_RECHARGE;case game.ActiveSubType.ST_COST_TARGET_EASTEREGG:return game.ActivityConditionType.COST_TARGET_EASTEREGG;case game.ActiveSubType.ST_COST_TARGET_DIAMOND:return game.ActivityConditionType.COST_TARGET_DIAMOND;case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:return game.ActivityConditionType.COST_TARGET_DIAMOND_DAILY;case game.ActiveSubType.ST_COST_TARGET_CROSS_ZHUANPAN:return game.ActivityConditionType.COST_TARGET_CROSS_ZHUANPAN;case game.ActiveSubType.ST_COST_TARGET_CROSS_STAR:return game.ActivityConditionType.COST_TARGET_CROSS_STAR;case game.ActiveSubType.ST_COST_TARGET_CROSS_FABAO:return game.ActivityConditionType.COST_TARGET_CROSS_FABAO;case game.ActiveSubType.ST_COST_TARGET_CROSS_REPUTATION:return game.ActivityConditionType.COST_TARGET_CROSS_REPUTATION;case game.ActiveSubType.ST_COST_TARGET_CROSS_MOUNT:return game.ActivityConditionType.COST_TARGET_CROSS_MOUNT;case game.ActiveSubType.ST_COST_TARGET_CROSS_WING:return game.ActivityConditionType.COST_TARGET_CROSS_WING;case game.ActiveSubType.ST_COST_TARGET_CROSS_BIANSHEN:return game.ActivityConditionType.COST_TARGET_CROSS_BIANSHEN;case game.ActiveSubType.ST_COST_TARGET_CROSS_PURCHASE:return game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE;case game.ActiveSubType.ST_COST_TARGET_CROSS_XIANZHEN:return game.ActivityConditionType.COST_TARGET_CROSS_XIANZHEN;case game.ActiveSubType.ST_COST_TARGET_MOUNT_NEW:return game.ActivityConditionType.COST_TARGET_MOUNT_NEW;case game.ActiveSubType.ST_COST_TARGET_WING_NEW:return game.ActivityConditionType.COST_TARGET_WING_NEW;case game.ActiveSubType.ST_COST_TARGET_FABAO_NEW:return game.ActivityConditionType.COST_TARGET_FABAO_NEW;case game.ActiveSubType.ST_COST_TARGET_STAR_NEW:return game.ActivityConditionType.COST_TARGET_STAR_NEW;case game.ActiveSubType.ST_NEW_RECHARGE:return game.ActivityConditionType.NEW_RECHARGE;case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI_NEW:return game.ActivityConditionType.COST_TARGET_ZHAOCAI_NEW;case game.ActiveSubType.ST_COST_TARGET_RAFFLE_NEW:return game.ActivityConditionType.COST_TARGET_RAFFLE_NEW;case game.ActiveSubType.ST_COST_TARGET_XIANZHEN_NEW:return game.ActivityConditionType.COST_TARGET_XIANZHEN_NEW;case game.ActiveSubType.ST_COST_TARGET_REPUTATION_NEW:return game.ActivityConditionType.COST_TARGET_REPUTATION_NEW;case game.ActiveSubType.ST_COST_TARGET_BIANSHEN_NEW:return game.ActivityConditionType.COST_TARGET_BIANSHEN_NEW;case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_NEW:return game.ActivityConditionType.COST_TARGET_ZHUANPAN_NEW;case game.ActiveSubType.ST_COST_TARGET_TOWER_NEW:return game.ActivityConditionType.COST_TARGET_TOWER_NEW;case game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW:return game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW;case game.ActiveSubType.ST_COST_TARGET_XUNBAO_NEW:return game.ActivityConditionType.COST_TARGET_XUNBAO_NEW;case game.ActiveSubType.ST_SINGLE_RECHARGE_2:return game.ActivityConditionType.SINGLE_RECHARGE_2;case game.ActiveSubType.ST_SINGLE_RECHARGE_3:return game.ActivityConditionType.SINGLE_RECHARGE_3;case game.ActiveSubType.ST_MYSTERY:return game.ActivityConditionType.MYSTERY;case game.ActiveSubType.ST_COST_TARGET_XIANZHEN:return game.ActivityConditionType.COST_TARGET_XIANZHEN;case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_BIANSHEN:return game.ActivityConditionType.COST_TARGET_ZHUANPAN_BIANSHEN}return 0},setConvertActive:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);t?(this._convertActive=t,b8e.evt.dptG(game.ActiveEvent.UPDATE_FRAGMENT_CONVERT)):b8e.warn("活动 ",data,"没有找到配置数据")},getConvertActive:function(){return this._convertActive},getFinishActiveCount:function(e){return this.finishActiveMap.get(e)?this.finishActiveMap.get(e):0},isShowConvertRedIcon:function(){var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_FRAGMENT_CONVERT);if(!e)return!1;for(var t=e.activeIds,i=0;i<t.length;++i)if(this.targetIsComplete(t[i]))return!0;return!1},isHasConverTimes:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);if(!t)return!1;var i=this.getFinishActiveCount(e);return 0<t.attendTimes-i},buyConversionItemSucceed:function(){this.fragmentBuyTimes++},getCSMaxConditionValue:function(){var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE),t=0;if(e&&e.activeIds)for(var i,n=e.activeIds,s=n.length,a=0;a<s;++a)(i=game.ccfg.ActivityCfg.getDataById(n[a]))&&i.condition&&0<i.condition.length&&i.condition[1]&&(t=i.condition[1].Value>t?i.condition[1].Value:t);return t},getCompeteActives:function(){var e=1,t=game.mainRole.mainRoleData;t&&t.miscData&&(e=t.miscData.openServerDay);var i=game.ccfg.ActiveCompeteCfg.getActiveDatas();if(!i)return null;for(var n=0;n<i.length;++n)if(i[n].openDay==e){i[n].openDay=0;break}return i.sort(this.sortAcitive),i},sortAcitive:function(e,t){return e.openDay-t.openDay},getCompeteActivesTimes:function(){var e=game.ccfg.ActiveCompeteCfg.getActiveDatas();if(!e||0==e.length)return"";var t=0,i=game.mainRole.mainRoleData;i&&i.miscData&&(t=i.miscData.openServerDay-1);var n=game.SysTime.curTime-t*b8e.TimeUtil.DAY_MICRO_SECONDS,s=n+e.length*b8e.TimeUtil.DAY_MICRO_SECONDS;return"活动时间:"+b8e.TimeUtil.formatTimestamp(n,"M月D日")+"-"+b8e.TimeUtil.formatTimestamp(s,"M月D日")},getCompeteFirstRank:function(e){var t=this.subTypeToRankType(e),i=game.rank.getRankListByType(t);return i||0<i.length?i[0]:null},isHasCompeteActive:function(){var e,t,i=game.ccfg.ActiveCompeteCfg.getActiveDatas();if(!i)return!1;for(var n=0;n<i.length;++n)if(e=i[n].activetype2,(t=this.getSubTypeInfo(e))&&0<t.endTime-game.SysTime.curTime)return!0;return!1},isShowCompeteActiveAlert:function(){var e,t,i,n,s=game.ccfg.ActiveCompeteCfg.getActiveDatas();if(!s)return!1;for(var a=0;a<s.length;++a)if(e=s[a].activetype2,t=this.getSubTypeInfo(e))for(i=t.activeIds,n=0;n<i.length;++n)if(this.targetIsComplete(i[n])&&0==this.activeIsGetAllPrize(i[n]))return!0;return!1},isCanGetCompeteActivePrize:function(e){var t,i=this.getSubTypeInfo(e);if(i){t=i.activeIds;for(var n=0;n<t.length;++n)if(this.targetIsComplete(t[n])&&0==this.activeIsGetAllPrize(t[n]))return!0}return!1}}),game.ActiveMgr._instance=null,game.ActiveMgr.inst=function(){return game.ActiveMgr._instance||(game.ActiveMgr._instance=new game.ActiveMgr),game.ActiveMgr._instance}},{}],55:[function(e,t,i){"use strict";game.ActiveBossPanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_timer:null,discount:null,_poster:null,_activeBossInfo:null,_activeId:null,_hpRateTimer:null,_maskWidth:315,_hpRate:0,_bossBg:null,_worldBossInfo:null,ctor:function(){this._super("active/ActiveBossSkin","ActiveBossSkin")},onShow:function(){this.initPanel(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.onC(this._skin.drop_preview,this.onClickDropPreviewBtn,this),b8e.evt.onC(this._skin.lab_damage_rank,this.onClickDamagePreviewBtn,this),b8e.evt.onC(this._skin.btn_fight,this.onClickFightBtn,this),b8e.evt.addG(this,game.SceneEvent.UPDATE_ALL_WORLD_BOSS,this.setBossInfo),b8e.evt.addG(this,game.ActiveEvent.GET_ACTIVE_BOSS,this.setBossInfo)},onHide:function(){if(this._timer&&this._timer.stop(),this._hpRateTimer&&this._hpRateTimer.stop(),this._activeBossInfo){this.updateBossHpRate();var e=this._hpRate*this._activeBossInfo.maxhp;game.worldBoss.setActiveBossHp(e)}b8e.Tween.kill(this._skin.img_progress_mask),b8e.evt.offC(this._skin.drop_preview,this.onClickDropPreviewBtn,this),b8e.evt.offC(this._skin.lab_damage_rank,this.onClickDamagePreviewBtn,this),b8e.evt.offC(this._skin.btn_fight,this.onClickFightBtn,this),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_ALL_WORLD_BOSS,this.setBossInfo),b8e.evt.rmvG(this,game.ActiveEvent.GET_ACTIVE_BOSS,this.setBossInfo)},init:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_95,game.IcoSizeEnum.SIZE_95,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize_node)),this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount)),this._poster||(this._poster=b8e.Sprite.get(),this._poster.setAnchor(.5,.5),this._poster.addToParent(this._skin.poster)),this._bossBg||(this._bossBg=b8e.Sprite.get(),this._bossBg.addToParent(this._skin.img_active_boss_bg));var e=game.ClientCfg.getWorldBossImgUrlByString("activeBossBg",!0);this._bossBg.loadTexture(e,null,null,{useManifest:!1}),this._skin.lab_tips_time.string=game.html.getText(game.html.Q_GREEN,game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ACTIVE_BOSS_TIPS))},initPanel:function(){var e=game.active.selectSubType;if(e){var t=game.active.getSubTypeInfo(e);if(!t.activeIds||t.activeIds.length<0)b8e.log("没有找到 当前活动的子活动id ！！！");else{this._activeId=t.activeIds[0];var i=game.ccfg.ClientActiveCfg.getDataById(e);i&&""!=i.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(i.discount,!0),null,null,{useManifest:!1});var n=game.ccfg.WorldBossAwardCfg.getCfgByLevel();n&&(this._prizeInfo.setupById(n.activityShowPrize),this._prizeList.setData(this._prizeInfo)),game.ActiveSender.ActivityBossInfoRequest(this._activeId)}}},setBossInfo:function(){if(this._activeBossInfo=game.worldBoss.getActiveBossInfo(),this._activeBossInfo){if(!this._activeBossInfo.bossId)return this._skin.hp_rate.string="100%",this._skin.lock.active=!0,this._skin.lab_damage_rank.active=!1,void(this._skin.btn_fight.active=!1);var e=game.mainRole.mainRoleData.miscData.openServerDay;if(this._worldBossInfo=game.ccfg.WorldBossCfg.getData(this._activeBossInfo.bossId,game.worldBoss.getServerByCurServerDate(e)),this._worldBossInfo){var t=game.ClientCfg.getWorldBossImgUrlByString(this._worldBossInfo.poster);this._poster.loadTexture(t,null,null,{useManifest:!1})}switch(this._skin.lock.active=!1,this._skin.lab_damage_rank.active=!1,this._skin.btn_fight.active=!1,this._hpRate=Math.round(this._activeBossInfo.hp/this._activeBossInfo.maxhp*100),this._hpRate<0&&(this._hpRate=0),this._activeBossInfo.state){case game.WorldBossStateType.NO_OPEN:this._skin.hp_rate.string="100%",this._skin.img_progress_mask.width=this._maskWidth,this._skin.lock.active=!0;break;case game.WorldBossStateType.OVER:this._skin.hp_rate.string="0%",this._skin.img_progress_mask.width=0,this._skin.lab_damage_rank.active=!0;break;case game.WorldBossStateType.OPENING:var i=this._activeBossInfo.endTime-game.SysTime.curTime;this._skin.hp_rate.string=this._hpRate+"%",0<this._hpRate?(this._skin.img_progress_mask.width=this._maskWidth*(this._hpRate/100),b8e.Tween.kill(this._skin.img_progress_mask),b8e.Tween.get(this._skin.img_progress_mask).to({width:1},i).call(this.bossDead,this),this._skin.btn_fight.active=!0,this._hpRateTimer||(this._hpRateTimer=b8e.Timer.add(this,this.updateBossHpRate,500)),this._hpRateTimer.reset(),this._hpRateTimer.start()):(this._skin.lab_damage_rank.active=!0,game.ActiveSender.ActivityBossInfoRequest(this._activeId))}}},bossDead:function(){this._skin.btn_fight.active=!1,this._skin.lock.active=!1,this._skin.lab_damage_rank.active=!0,game.ActiveSender.ActivityBossInfoRequest(this._activeId)},updateBossHpRate:function(){if(this._activeBossInfo.endTime>game.SysTime.curTime){var e=this._activeBossInfo.maxhp*((this._activeBossInfo.endTime-game.SysTime.curTime)/(this._activeBossInfo.endTime-this._activeBossInfo.startTime));this._hpRate=Math.round(e/this._activeBossInfo.maxhp*100),this._hpRate<0&&(this._hpRate=0),this._skin.hp_rate.string=this._hpRate+"%"}else this._skin.hp_rate.string="0%",this._hpRate=0,game.worldBoss.setActiveBossHp(0),this._hpRateTimer&&this._hpRateTimer.stop()},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"},onClickDropPreviewBtn:function(){game.app.show(game.AppConstant.WORLD_BOSS_DROP_PREVIEW_PANEL,{id:this._activeBossInfo.bossId,isActiveBoss:!0})},onClickDamagePreviewBtn:function(){game.app.show(game.AppConstant.WORLD_BOSS_DAMAGE_RANK_CHECK_PANEL,{id:this._activeBossInfo.bossId,isActiveBoss:!0})},onClickFightBtn:function(){game.worldBoss.bossId=this._activeBossInfo.bossId,game.SceneSender.enterWorldBossSceneRequest(this._activeBossInfo.bossId),game.app.hide(game.AppConstant.FESTIVAL_LOGIN_PANEL)}})},{}],56:[function(e,t,i){"use strict";game.appModule.ActiveBuyConversionPanel=game.SkinUIPanel.extends({_itemGrid:null,_itemData:null,upgradeInfo:null,ctor:function(e){this._super(e)},onShow:function(){if(null!=this.data){var e=game.active.getConvertActive();e&&(this._itemData=game.ccfg.FragmentConvertCfg.getData(e.repository,this.data.Id),this._itemData&&(this.upDatePanel(),this.setItemGrid(),b8e.evt.onC(this._skin.gotoBtn,this.onTransmists,this),b8e.evt.onC(this._skin.buyBtn,this.onBuyClick,this)))}},onHide:function(){b8e.evt.offC(this._skin.gotoBtn,this.onTransmists,this),b8e.evt.offC(this._skin.buyBtn,this.onBuyClick,this)},setItemGrid:function(){var e=game.ccfg.ItemInfoCfg.getItemInfoById(this.data.Id,!0);if(e){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),this._itemGrid.addToParent(this._skin.itemNode)),game.GridUtil.setItemGrid(this._itemGrid,e);var t=e.num;this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.setName(e.name,game.html.getColorByQuality(e.quality),null,200,30,20),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.setNum(t),this._itemGrid.sortLayer()}},upDatePanel:function(){var e=this._itemData.cost;if(e&&!(e.length<=0)){var t=e[0];this._skin.itemCost.string=t.Num;var i=game.ccfg.GlobalParamCfg.getData(6701)-game.active.fragmentBuyTimes,n=0<i?81013:81014;this._skin.lastNum.string=game.ccfg.LangCfg.getText(n,[i])}},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onTransmists:function(){if(this._itemData){var e=this._itemData.sceneId,t=game.ccfg.SceneCfg.getDataById(e);if(t)game.mainRole.mainRoleData.getLv()>=t.unlocklevel?(game.quest.changeAuto(!1),game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,e)):game.notice.show(81012),this.hide()}},onBuyClick:function(){var e=this._itemData.cost;!e||e.length<=0||(this.upgradeInfo||(this.upgradeInfo=new game.UpgradeInfo),this.upgradeInfo.setUpgradeInfo(e),game.upgrade.costCheck(this,this.upgradeInfo,this.onIsPass))},onIsPass:function(e){if(e){if(game.ccfg.GlobalParamCfg.getData(6701)-game.active.fragmentBuyTimes<=0)return game.notice.show(81011),void this.hide();var t=game.active.getConvertActive();if(!t)return;game.ActiveSender.buyActivityItemRequest(t.id,this.data.Id),this.hide()}}})},{}],57:[function(e,t,i){"use strict";game.ActiveCollectExchangeItem=game.SkinUI.extends({_data:null,_costPrizeList:null,_costPrizeInfo:null,_awardPrizeList:null,_awardPrizeInfo:null,ADD_COUNT:6,upgradeInfo:null,_isEnough:!1,worldCupBg:null,ctor:function(){this._super("active/ActiveCollectExchangeItemSkin","ActiveCollectExchangeItemSkin")},onShow:function(){for(var e=0;e<this.ADD_COUNT;e++)this._skin["img_add_"+e].active=!1;this.setData(this._data),b8e.evt.onC(this._skin.btn_exchange,this.exchangeBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_exchange,this.exchangeBtn,this)},init:function(){var e=this._skin.img_add_0.width;this._costPrizeInfo||(this._costPrizeInfo=new game.PrizeInfo),this._costPrizeList||(this._costPrizeList=new game.PrizeList(3,72+e,72,game.IconScale.PERCENT_80),this._costPrizeList.addToParent(this._skin.cost_prize_node)),this._awardPrizeInfo||(this._awardPrizeInfo=new game.PrizeInfo),this._awardPrizeList||(this._awardPrizeList=new game.PrizeList(3,72+e,72,game.IconScale.PERCENT_80),this._awardPrizeList.addToParent(this._skin.award_prize_node)),this.worldCupBg||(this.worldCupBg=b8e.Sprite.get(),this.worldCupBg.addToParent(this._skin.world_cup_bg))},setData:function(e){if(this._data=e,this._data&&this._skin){var t=game.ccfg.ActivityCfg.getDataById(e);if(t)if(!t.realCost||t.realCost.length<=0)b8e.warn("兑换活动 ",e,"没有找到活动配置的消耗");else{this._costPrizeInfo.setupItemList(t.realCost,!0,!0),this._costPrizeList.setData(this._costPrizeInfo),this._awardPrizeInfo.setupById(t.prize),this._awardPrizeList.setData(this._awardPrizeInfo);var i=this._awardPrizeInfo.getPrizeList(),n=t.realCost.length,s=i.length,a=this._skin.equal_node.width,o=this._skin.img_add_0.width,r=this._skin.cost_prize_node.x;this._skin.award_prize_node.x=72*n+(n-1)*o+a+r,this._skin.equal_node.x=72*n+(n-1)*o+o/2+r;var h=1;for(h=1;h<n;h++)this._skin["img_add_"+(h-1)].active=!0,this._skin["img_add_"+(h-1)].x=72*(h-1)+(h-1)*o;for(h=1;h<s;h++){var g=h+n;this._skin["img_add_"+(g-1)].active=!0,this._skin["img_add_"+(g-1)].x=72*(g-1)+(g-2)*o+a}this.upgradeInfo||(this.upgradeInfo=new game.UpgradeInfo),this.upgradeInfo.clear(),this.upgradeInfo.setUpgradeInfo(t.realCost),this._isEnough=game.upgrade.isHasEnoughItem(this.upgradeInfo);var l=game.active.finishActiveMap.get(e);l||(l=0),l<t.attendTimes&&this._isEnough?b8e.ShaderUtil.reset(this._skin.btn_exchange):b8e.ShaderUtil.setGray(this._skin.btn_exchange),l>=t.attendTimes?this._skin.lab_exchange_count.node.color=b8e.ColorUtil.toCCColor(game.html.Q_RED):this._skin.lab_exchange_count.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN),this._skin.lab_exchange_count.string=t.attendTimes-l;var c=game.active.selectSubType;if(c){var u=game.active.getSubTypes(game.ActiveType.WORLD_CUP);u&&0<u.length?-1!=u.indexOf(c)&&(this._skin.bg.node.active=!1,this.worldCupBg.loadTexture(game.ClientCfg.worldCupRankBgUrl,this.onWorldCupBgComplete,this,{useManifest:!1})):(this._skin.bg.node.active=!0,this.worldCupBg.loadTexture(null))}}else b8e.warn("活动 ",e,"没有找到配置数据")}},exchangeBtn:function(){if(this._data){var e=game.ccfg.ActivityCfg.getDataById(this._data);if(e){this.upgradeInfo||(this.upgradeInfo=new game.UpgradeInfo),this.upgradeInfo.clear(),this.upgradeInfo.setUpgradeInfo(e.realCost);var t=game.active.finishActiveMap.get(this._data);if(t||(t=0),t<e.attendTimes){if(!game.upgrade.isHasEnoughItem(this.upgradeInfo,!0))return;game.active.exchangeGameAlert(this._data)}else game.notice.show("兑换次数不足")}else b8e.warn("活动 ",this._data,"没有找到配置数据")}},getHeight:function(){return 115},getWidth:function(){return 545},onWorldCupBgComplete:function(){this.worldCupBg.width=545,this.worldCupBg.height=115}})},{}],58:[function(e,t,i){"use strict";game.ActiveCollectExchangePanel=game.SkinUI.extends({_list:null,discount:null,_timer:null,_materialList:null,_costItemMaterialList:null,worldCupDiscountY:77,normalY:539,worldCupMMNodeY:600,worldCupListY:589,listNormalY:531,worldCupViewY:510,viewNormalY:445,ctor:function(){this._super("active/ActiveCollectExchangeSkin","ActiveCollectExchangeSkin"),this._costItemMaterialList=[]},onShow:function(){this.initPanel(),this._list.show(),this._materialList.show(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.refreshPanel)},onHide:function(){this._list&&this._list.hide(),this._materialList&&this._materialList.hide(),this._timer&&this._timer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.refreshPanel)},init:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.ActiveCollectExchangeItem)),this._materialList||(this._materialList=new b8e.List(this._skin.materialScrollview,game.ActiveCollectMaterialItem)),this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount))},initPanel:function(){var e=game.active.selectSubType;if(e){var t=game.ccfg.ClientActiveCfg.getDataById(e);t&&""!=t.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(t.discount,!0),null,null,{useManifest:!1});var i=game.active.getSubTypeInfo(e);i?this._list.setData(i.activeIds):this._list.setData(null);var n=game.active.getSubTypes(game.ActiveType.WORLD_CUP);n&&0<n.length?-1!=n.indexOf(e)&&(this._skin.discount.y=this.worldCupDiscountY,this._skin.mm_node.y=this.worldCupMMNodeY,this._skin.scrollview.node.y=this.worldCupListY,this._skin.view.height=this.worldCupViewY):(this._skin.discount.y=this.normalY,this._skin.mm_node.y=this.normalY,this._skin.scrollview.node.y=this.listNormalY,this._skin.view.height=this.viewNormalY),this.refreshPanel()}},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"},refreshPanel:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);this._costItemMaterialList.length=0,t&&this.setMaterialList(t.activeIds),this._costItemMaterialList&&0<this._costItemMaterialList.length?this._materialList.setData(this._costItemMaterialList):this._materialList.setData(null)},setMaterialList:function(e){for(var t=0;t<e.length;t++){var i=game.ccfg.ActivityCfg.getDataById(e[t]);if(i&&(i.realCost&&!(i.realCost.length<=0)))for(var n=0;n<i.realCost.length;n++){var s=i.realCost[n];if(s)if(!game.upgrade.isCurrencyById(s.Id))if(-1==this._costItemMaterialList.indexOf(s.Id)&&this._costItemMaterialList.push(s.Id),3<this._costItemMaterialList.length)break}}}})},{}],59:[function(e,t,i){"use strict";game.ActiveCollectMaterialItem=game.SkinUI.extends({_data:null,_sprite:null,ctor:function(){this._super("active/ActiveCollectMaterialItemSkin","ActiveCollectMaterialItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){this._sprite.unloadTexture()},init:function(){this._sprite=b8e.Sprite.get(),this._sprite.addToParent(this._skin.icon),this._sprite.setScale(.3,.3)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ItemInfoCfg.getItemInfoById(this._data);if(t){var i=t.iconName;this._sprite.loadTexture(game.ClientCfg.getImgUrl(i,!1),null,null,{useManifest:!1})}var n=game.back.getItemInfoCountById(this._data);this._skin.count.string="x"+n}},getHeight:function(){return 26},getWidth:function(){return 100}})},{}],60:[function(e,t,i){"use strict";game.ActiveConversionItem=game.SkinUI.extends({_data:null,_index:0,ctor:function(){this._super("active/ActiveConversionItemSkin","ActiveConversionItemSkin")},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.clickBtn,this.clickBack,this),b8e.evt.addG(this,game.ActiveEvent.UPDATE_FRAGMENT_CONVERT,this.updateCheckMark)},onHide:function(){b8e.evt.offC(this._skin.clickBtn,this.clickBack,this),b8e.evt.rmvG(this,game.ActiveEvent.UPDATE_FRAGMENT_CONVERT,this.updateCheckMark)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ActivityCfg.getDataById(e);t?(this._skin.itemName.string=t.name,this._skin.redIcon.active=game.active.targetIsComplete(e),this.updateCheckMark()):b8e.warn("活动 ",e,"没有找到配置数据")}},updateCheckMark:function(){var e=game.active.getConvertActive();e&&e.id==this._data?this._skin.checkMark.active=!0:this._skin.checkMark.active=!1},clickBack:function(){game.active.setConvertActive(this._data)},getHeight:function(){return 80},getWidth:function(){return 128}})},{}],61:[function(e,t,i){"use strict";game.appModule.ActiveConversionPanel=game.SkinUIPanel.extends({_conversionList:null,_itemList:null,_activeIds:null,_spriteTitle:null,_spriteBg:null,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._conversionList=new b8e.List(this._skin.activeList,game.ActiveConversionItem),this._itemList=new b8e.List(this._skin.convertList,game.ActiveConvertItem),this._spriteTitle=b8e.Sprite.get(),this._spriteTitle.setAnchor(.5,1),this._spriteTitle.addToParent(this._skin.title_node),this._spriteTitle.loadTexture(game.ClientCfg.ActiveConversionTitle,null,null,{useManifest:!1}),this._spriteBg=b8e.Sprite.get(),this._spriteBg.setAnchor(.5,.5),this._spriteBg.addToParent(this._skin.discount),this._spriteBg.loadTexture(game.ClientCfg.ActiveConversionBg,null,null,{useManifest:!1})},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start();var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_FRAGMENT_CONVERT);e&&(this._activeIds=e.activeIds,this._activeIds&&(game.active.setConvertActive(this._activeIds[0]),this._conversionList.setData(this._activeIds),this._conversionList.show(),this._itemList.show(),this.updateItemList(),b8e.evt.addG(this,game.ActiveEvent.UPDATE_FRAGMENT_CONVERT,this.updateItemList),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateItemList),b8e.evt.addG(this,game.BackEvt.BACK_REMOVE_ITEMINFO,this.updateItemList),b8e.evt.onC(this._skin.helpBtn,this.onClickWenHao,this),b8e.evt.onC(this._skin.duiHuanBtn,this.onDuiHuan,this)))},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.UPDATE_FRAGMENT_CONVERT,this.onUpdate),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateItemList),b8e.evt.rmvG(this,game.BackEvt.BACK_REMOVE_ITEMINFO,this.updateItemList),b8e.evt.offC(this._skin.helpBtn,this.onClickWenHao,this),b8e.evt.offC(this._skin.duiHuanBtn,this.onDuiHuan,this),this._conversionList&&this._conversionList.hide(),this._itemList&&this._itemList.hide()},updateItemList:function(){if(this._activeIds){var e=game.active.getConvertActive();if(e){this._skin.prizeTips.string=game.ccfg.LangCfg.getText(81004,[e.name]);var t=game.active.getFinishActiveCount(e.id),i=e.attendTimes,n=i-t,s=i<=t?81008:81007;this._skin.convertTimes.string=game.ccfg.LangCfg.getText(s,[n,i]);var a=game.ccfg.GlobalParamCfg.getData(6701),o=a-game.active.fragmentBuyTimes;s=0<o?81005:81006,this._skin.buyTimes.string=game.ccfg.LangCfg.getText(s,[o,a]);var r=e.realCost;this._itemList.setData(r),this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prizeNode));var h=e.prize;this._prizeInfo.setupById(h),this._prizeList.setData(this._prizeInfo),this._skin.redIcon.active=game.active.targetIsComplete(e.id)}}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束"},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onDuiHuan:function(){var e=game.active.getConvertActive();if(e){var t=game.mainRole.mainRoleData,i=t.getLv();i<e.minLv?game.notice.show(81e3):0!=e.maxLv&&i>e.maxLv?game.notice.show(81001):e.vip&&e.vip>t.vipLevel?game.notice.show(81002):game.active.getFinishActiveCount(e.id)>=e.attendTimes?game.notice.show(81003):game.active.targetIsComplete(e.id)?game.ActiveSender.getActivePrize(e.id):game.notice.show(81017)}else b8e.warn("活动 ",e.id,"没有找到配置数据")}})},{}],62:[function(e,t,i){"use strict";game.ActiveConvertItem=game.SkinUI.extends({_data:null,_sprite:null,ctor:function(){this._super("active/ActiveConvertItemSkin","ActiveConvertItemSkin")},init:function(){this._sprite=b8e.Sprite.get(),this._sprite.setAnchor(.5,.5),this._sprite.addToParent(this._skin.itemIcon)},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.buyBtn,this.onBuyItem,this)},onHide:function(){this._sprite.unloadTexture(),b8e.evt.offC(this._skin.buyBtn,this.onBuyItem,this)},setData:function(e){if((this._data=e,this._skin&&this._data)&&(t=game.ccfg.ItemInfoCfg.getItemInfoById(e.Id,!0))){this.setItemGrid(t);var t,i=0;(t=game.back.getItemInfoById(e.Id))&&(i=t.num);var n=i>=e.Num?81009:81010;this._skin.num.string=game.ccfg.LangCfg.getText(n,[i,e.Num])}},setItemGrid:function(e){if(e){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),this._itemGrid.addToParent(this._skin.itemIcon)),game.GridUtil.setItemGrid(this._itemGrid,e);e.num;this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.setName(""),this._itemGrid.setNum(""),this._itemGrid.sortLayer()}},onBuyItem:function(){game.app.show(game.AppConstant.ACTIVE_BUY_CONVERSION_PANEL,this._data)},getHeight:function(){return 130},getWidth:function(){return 100}})},{}],63:[function(e,t,i){"use strict";game.ActiveEasterEggGoldPage=game.SkinUI.extends({activebg:null,oneCost:0,tenCost:0,ctor:function(){this._super("active/ActiveEasterEggGoldSkin","ActiveEasterEggGoldSkin")},init:function(){this.activebg=b8e.Sprite.get(),this.activebg.setAnchor(0,0),this.activebg.addToParent(this._skin.activebg),this.activebg.loadTexture("images/image/easteregg/easterEggBg.jpg",null,null,{useManifest:!1}),this.createGrids();var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD);e&&(this._skin.activeconet.string=e.des),this.oneCost=game.ccfg.GlobalParamCfg.getData(6001),this.tenCost=game.ccfg.GlobalParamCfg.getData(6002),this._skin.oneCost.string=this.oneCost,this._skin.tenCost.string=this.tenCost},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.onC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.offC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.time.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束"},createGrids:function(){var e,t,i,n=0,s=game.roulette.getZhuanPanArr();if(s&&0<s.length)for(var a=0;a<5;a++)i=s[a],(t=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0))&&((e=game.GridUtil.creatItemGrid(this,this._skin.prizrNode)).gridInfo=new game.GridInfo(game.ContainerId.LOW_COST_CONTAINER_ID),e.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),t.num=i.itemNum,game.GridUtil.setItemGrid(e,t),e.fnOnClick(this,this.onClick),e.setNum(i.itemNum),e.setPosition(n,0),n+=90,e.sortLayer())},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickOneEgg:function(){game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)<this.oneCost?game.gameAlert.showVipAlert(!0,101):game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD)},onClickTenEgg:function(){game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)<this.tenCost?game.gameAlert.showVipAlert(!0,101):game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD)},onGotoPay:function(){game.pay.showPayPanel()},zhuanPanCallBack:function(){game.roulette.zhuanPanCallBack()}})},{}],64:[function(e,t,i){"use strict";game.ActiveEasterEggPage=game.SkinUI.extends({activebg:null,remainCount:0,ctor:function(){this._super("active/ActiveEasterEggSkin","ActiveEasterEggSkin")},init:function(){this.activebg=b8e.Sprite.get(),this.activebg.setAnchor(0,0),this.activebg.addToParent(this._skin.activebg),this.activebg.loadTexture("images/image/easteregg/easterEggBg.jpg",null,null,{useManifest:!1}),this.createGrids();var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG);e&&(this._skin.activeconet.string=e.des)},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.onC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.onC(this._skin.gotoPayBtn,this.onGotoPay,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),this.updatePanel()},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.offC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.offC(this._skin.gotoPayBtn,this.onGotoPay,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},updatePanel:function(){if(this._skin){var e=0,t=0,i=game.roulette.getRaffleCost(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG),n=game.pay.getConditionsInfo(game.ActivityConditionType.ZHUANPAN_EASTEREGG),s=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG);if(0<i){n&&(e=(t=n.value)%i),this._skin.progress.width=350*e/i,this._skin.progressLab.string=e+"/"+i;var a=i-e;this._skin.targetTips.string="再充值"+game.html.getText(game.html.Q_GREEN,a+"元")+"可获得1次抽奖机会";var o,r=t/i-s>>0;o=0<r?"剩余次数："+game.html.getText(game.html.Q_GREEN,r)+"次":"剩余次数："+game.html.getText(game.html.Q_RED,r)+"次",this._skin.timestips.string=o,this.remainCount=r}}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.time.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束"},createGrids:function(){var e,t,i,n=0,s=game.roulette.getZhuanPanArr();if(s&&0<s.length)for(var a=0;a<5;a++)i=s[a],(t=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0))&&((e=game.GridUtil.creatItemGrid(this,this._skin.prizrNode)).gridInfo=new game.GridInfo(game.ContainerId.LOW_COST_CONTAINER_ID),e.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),t.num=i.itemNum,game.GridUtil.setItemGrid(e,t),e.fnOnClick(this,this.onClick),e.setNum(i.itemNum),e.setPosition(n,0),n+=90,e.sortLayer())},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickOneEgg:function(){this.remainCount<=0?game.notice.show("次数不足"):game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_EASTEREGG)},onClickTenEgg:function(){this.remainCount<10?game.notice.show("次数不足"):game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_EASTEREGG)},onGotoPay:function(){game.pay.showPayPanel()},zhuanPanCallBack:function(){this.updatePanel(),game.roulette.zhuanPanCallBack()}})},{}],65:[function(e,t,i){"use strict";game.ActiveHongBaoPanel=game.SkinUI.extends({hongbao:null,ctor:function(){this._super("active/ActiveHongBaoSkin","ActiveHongBaoSkin")},init:function(){this.hongbao=b8e.Sprite.get(),this.hongbao.addToParent(this._skin.img_hongbao);var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_SYSTEM_HONGBAO);e&&""!=e.discount&&this.hongbao.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1}),this._skin.lab_hongbao.string=game.ccfg.LangCfg.getText(10032)},onShow:function(){},onHide:function(){}})},{}],66:[function(e,t,i){"use strict";game.appModule.ActiveMysteryDepotPanel=game.SkinUIPanel.extends({_list:null,subTypeInfo:null,activeId:0,list:null,ctor:function(e){this._super(e)},init:function(){},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.DepotGrid,4)),this._list.show(),this.initPanel(),b8e.evt.onC(this._skin.copperBoxBtn.node,this.onClickCopperBoxBtn,this),b8e.evt.onC(this._skin.silverBoxBtn.node,this.onClickSilverBoxBtn,this),b8e.evt.onC(this._skin.goldBoxBtn.node,this.onClickGoldBoxBtn,this)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.copperBoxBtn.node,this.onClickCopperBoxBtn,this),b8e.evt.offC(this._skin.silverBoxBtn.node,this.onClickSilverBoxBtn,this),b8e.evt.offC(this._skin.goldBoxBtn.node,this.onClickGoldBoxBtn,this)},initPanel:function(){var e=game.active.selectSubType;if(this.subTypeInfo=game.active.getSubTypeInfo(e),this.subTypeInfo)if(!this.subTypeInfo.activeIds||this.subTypeInfo.activeIds.length<0)b8e.log("没有找到 当前活动的子活动id ！！！");else{for(var t,i,n=this.subTypeInfo.activeIds.length,s=0;s<n;s++)switch(t=this.subTypeInfo.activeIds[s],i=game.ccfg.ActivityCfg.getDataById(t),s){case 0:this._skin.labCopperBoxBtn.string=i.name;break;case 1:this._skin.labSilverBoxBtn.string=i.name;break;case 2:this._skin.labGoldBoxBtn.string=i.name}this._activeId=this.subTypeInfo.activeIds[0],this._selectIndex=0,this._skin.copperBoxBtn.check(),this.refreshBoxDepot(this._activeId)}else b8e.log("没有找到 当前活动 信息！！！")},onClickCopperBoxBtn:function(){this._activeId=this.subTypeInfo.activeIds[0],this.refreshBoxDepot(this._activeId)},onClickSilverBoxBtn:function(){this._activeId=this.subTypeInfo.activeIds[1],this.refreshBoxDepot(this._activeId)},onClickGoldBoxBtn:function(){this._activeId=this.subTypeInfo.activeIds[2],this.refreshBoxDepot(this._activeId)},refreshBoxDepot:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);this.list=null,t&&(this.list=game.ccfg.MysteryActivityCfg.getCfgListByRepository(t.repository)),this.list&&0<this.list.length&&this.list.sort(this.onSort),this._list.setData(this.list)},onSort:function(e,t){return e.sortId-t.sortId}})},{}],67:[function(e,t,i){"use strict";game.ActiveMysteryItem=game.SkinUI.extends({_itemGrid:null,_shopId:0,ctor:function(){this._super("active/ActiveMysteryItemSkin","ActiveMysteryItemSkin")},init:function(){},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.buyBtn,this.onClickBuyBtn,this)},onHide:function(){b8e.evt.offC(this._skin.buyBtn,this.onClickBuyBtn,this)},onClickBuyBtn:function(){game.active.sendBuyMysteryActivity(this._shopId)},setData:function(e){if(e&&(this._data=e,this._skin)){this._shopId=this._data.shopId;var t=game.ccfg.ItemInfoCfg.getItemInfoById(this._data.award.id,!0);t&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_72),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ACTIVE_Mystery_CONTAINER_ID),this._itemGrid.addToParent(this._skin.itemGrid)),this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this._itemGrid,t),this._itemGrid.setNum(this._data.award.num),this._itemGrid.sortLayer(),this._skin.cost.string=this._data.discountCost[0].num,this._skin.rebate.string=this._data.discount+"折",this._skin.buyBtn.active=!this._data.state)}},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},getHeight:function(){return 190},getWidth:function(){return 110}})},{}],68:[function(e,t,i){"use strict";game.ActiveMysteryPanel=game.SkinUI.extends({discount:null,_activeTimeStr:"",_refreshTimeStr:"",_rechargeStr:"",_labList:null,_moveY:0,content_bg:null,_list:null,_activityId:0,_timer:null,_selectIndex:0,conditionValue:0,recordList:null,_recordIndex:0,maxShowNum:7,itemHeight:44,subTypeInfo:null,ctor:function(){this._super("active/ActiveMysterySkin","ActiveMysterySkin")},init:function(){this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount)),this.content_bg||(this.content_bg=b8e.Sprite.get(),this.content_bg.addToParent(this._skin.content_bg)),this.content_bg.loadTexture(game.ClientCfg.activeMystery,null,null,{useManifest:!1}),this._labList||(this._labList=[]),this.recordList||(this.recordList=[])},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.ActiveMysteryItem,4)),this._list.show(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),this.initPanel(),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(83003),b8e.evt.onC(this._skin.allPrizePreBtn,this.onClickAllPrizePreBtn,this),b8e.evt.onC(this._skin.copperBoxBtn,this.onClickCopperBoxBtn,this),b8e.evt.onC(this._skin.silverBoxBtn,this.onClickSilverBoxBtn,this),b8e.evt.onC(this._skin.goldBoxBtn,this.onClickGoldBoxBtn,this),b8e.evt.onC(this._skin.quickRefreshBtn,this.onClickQuickRefreshBtn,this),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.refreshConditionValue),b8e.evt.addG(this,game.ActiveEvent.MYSTERY_ACTIVE_CHANGE,this.refreshBoxPrize),b8e.evt.addG(this,game.ActiveEvent.MYSTERY_ACTIVE_RECORD_CHANGE,this.refreshRecordList)},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.Tween.kill(this._skin.record_bg),this._selectIndex=0,b8e.evt.offC(this._skin.allPrizePreBtn,this.onClickAllPrizePreBtn,this),b8e.evt.offC(this._skin.copperBoxBtn,this.onClickCopperBoxBtn,this),b8e.evt.offC(this._skin.silverBoxBtn,this.onClickSilverBoxBtn,this),b8e.evt.offC(this._skin.goldBoxBtn,this.onClickGoldBoxBtn,this),b8e.evt.offC(this._skin.quickRefreshBtn,this.onClickQuickRefreshBtn,this),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.refreshConditionValue),b8e.evt.rmvG(this,game.ActiveEvent.MYSTERY_ACTIVE_CHANGE,this.refreshBoxPrize),b8e.evt.rmvG(this,game.ActiveEvent.MYSTERY_ACTIVE_RECORD_CHANGE,this.refreshRecordList)},initPanel:function(){var e=game.active.selectSubType;if(this.subTypeInfo=game.active.getSubTypeInfo(e),this.subTypeInfo){var t=game.ccfg.ClientActiveCfg.getDataById(e);if(t&&""!=t.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(t.discount,!0),null,null,{useManifest:!1}),!this.subTypeInfo.activeIds||this.subTypeInfo.activeIds.length<0)b8e.log("没有找到 当前活动的子活动id ！！！");else{var i,n;this._skin.copperBoxBtn.active=!1,this._skin.silverBoxBtn.active=!1,this._skin.goldBoxBtn.active=!1,this._skin.labCopperBoxBtn.node.active=!1,this._skin.labSilverBoxBtn.node.active=!1,this._skin.labGoldBoxBtn.node.active=!1;for(var s=this.subTypeInfo.activeIds.length,a=0;a<s;a++)switch(i=this.subTypeInfo.activeIds[a],n=game.ccfg.ActivityCfg.getDataById(i),a){case 0:this._skin.copperBoxBtn.active=!0,this._skin.labCopperBoxBtn.node.active=!0,this._skin.labCopperBoxBtn.string=n.name;break;case 1:this._skin.silverBoxBtn.active=!0,this._skin.labSilverBoxBtn.node.active=!0,this._skin.labSilverBoxBtn.string=n.name;break;case 2:this._skin.goldBoxBtn.active=!0,this._skin.labGoldBoxBtn.node.active=!0,this._skin.labGoldBoxBtn.string=n.name}var o=game.active.subTypeToCondition(e);game.ActiveSender.getActiveCostMap(o),game.active.selectMysteryActivityId=this._activityId=this.subTypeInfo.activeIds[0],this._selectIndex=0,this._skin.checkMask.x=this._skin.copperBoxBtn.x,game.active.sendmysteryActivityList(game.active.selectMysteryActivityId),game.active.sendMysteryActivityRecord(game.active.selectMysteryActivityId)}}else b8e.log("没有找到 当前活动 信息！！！")},onClickAllPrizePreBtn:function(){game.app.show(game.AppConstant.ACTIVE_MYSTERY_DEPOT_PANEL,this._activityId)},onClickCopperBoxBtn:function(){var e=this.isPassActivityId(this.subTypeInfo.activeIds[0]);this.selectBtn(e,0),e&&(game.active.selectMysteryActivityId=this._activityId=this.subTypeInfo.activeIds[0],game.active.sendmysteryActivityList(game.active.selectMysteryActivityId),game.active.sendMysteryActivityRecord(game.active.selectMysteryActivityId))},onClickSilverBoxBtn:function(){var e=this.isPassActivityId(this.subTypeInfo.activeIds[1]);this.selectBtn(e,1),e&&(game.active.selectMysteryActivityId=this._activityId=this.subTypeInfo.activeIds[1],game.active.sendmysteryActivityList(game.active.selectMysteryActivityId),game.active.sendMysteryActivityRecord(game.active.selectMysteryActivityId))},onClickGoldBoxBtn:function(){var e=this.isPassActivityId(this.subTypeInfo.activeIds[2]);this.selectBtn(e,2),e&&(game.active.selectMysteryActivityId=this._activityId=this.subTypeInfo.activeIds[2],game.active.sendmysteryActivityList(game.active.selectMysteryActivityId),game.active.sendMysteryActivityRecord(game.active.selectMysteryActivityId))},onClickQuickRefreshBtn:function(){game.active.sendRefreshMysteryActivity(this._activityId)},isPassActivityId:function(e){var t=game.ccfg.ActivityCfg.getDataById(e);return!!t&&(!(t.condition&&0<t.condition.length&&this.conditionValue<t.condition[0].Value)||(game.notice.show(83002,[t.condition[0].Value-this.conditionValue]),!1))},selectBtn:function(e,t){switch(e&&(this._selectIndex=t),b8e.log("isPass",e,"this._selectIndex",this._selectIndex),this._selectIndex){case 0:this._skin.checkMask.x=this._skin.copperBoxBtn.x;break;case 1:this._skin.checkMask.x=this._skin.silverBoxBtn.x;break;case 2:this._skin.checkMask.x=this._skin.goldBoxBtn.x}},refreshBoxPrize:function(){var e=game.ccfg.ActivityCfg.getDataById(this._activityId);e&&(this._skin.box_desc.string=e.name+"宝物");var t=game.active.getShopIdsById(this._activityId);t&&0<t.length&&t.sort(this.onSort),this._list.setData(t),this._skin.costNum.string=game.active.getCostNumById(this._activityId)},refreshRecordList:function(){if(this.recordDatas=game.active.getRecordListById(this._activityId),this.recordDatas&&!(this.recordDatas.length<=0)){this._recordIndex=0,this.resetRecord(),b8e.Tween.kill(this._skin.record_bg),this._skin.record_bg.y=0;var e=this._skin.record_bg.y;b8e.Tween.get(this._skin.record_bg).to({y:e+this.itemHeight},2e3).call(this.updateRecord,this)}},updateRecord:function(){var e,t=this._recordIndex%this.recordList.length,i=this.recordDatas.length,n=this._recordIndex>i?this._recordIndex%i:i;(e=this.recordList[t]).setData(this.recordDatas[n]),e.setVisible(!0),e.y=-this._recordIndex*e.height,b8e.Tween.kill(this._skin.record_bg);var s=this._skin.record_bg.y;b8e.Tween.get(this._skin.record_bg).to({y:s+this.itemHeight},2e3).call(this.updateRecord,this),this._recordIndex++,b8e.log(this.recordList.length)},resetRecord:function(){for(var e,t=this.recordDatas.length,i=0;i<this.maxShowNum;i++)i<t?(this.recordList.length<=i?((e=new game.ActiveMysteryRecordItem).setData(this.recordDatas[i]),e.addToParent(this._skin.record_bg),e.show(),this.recordList.push(e)):((e=this.recordList[i]).setData(this.recordDatas[i]),e.setVisible(!0)),e.y=-this._recordIndex*this.itemHeight,this._recordIndex++):this.recordList.length>i&&e.setVisible(!1)},onSort:function(e,t){return e.sortId-t.sortId},refreshConditionValue:function(){var e=game.active.selectSubType,t=game.active.subTypeToCondition(e);this.conditionValue=game.active.getActiveConditionValue(e,t),this._skin.lab_condition_value.string=this.conditionValue+"元"},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=game.active.mysteryRefreshTime-game.SysTime.curTime;this._skin.refreshTime.string=0<i?b8e.TimeUtil.formatTime(i):"00:00:00";var n=t.endTime-game.SysTime.curTime;0<n?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(n):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"}})},{}],69:[function(e,t,i){"use strict";game.ActiveMysteryRecordItem=game.SkinUI.extends({_data:null,_index:0,ctor:function(){this._super("active/ActiveMysteryRecordItemSkin","ActiveMysteryRecordItemSkin")},init:function(){},onShow:function(){this.setData(this._data)},onHide:function(){},setData:function(e){e&&(this._data=e,this._skin&&(this._skin.lab.string=game.ccfg.LangCfg.getText(83001,[this._data.name,this._data.rebate,this._data.itemName,this._data.itemNum])))}})},{}],70:[function(e,t,i){"use strict";game.ActiveRankItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("active/ActiveRankItemSkin","ActiveRankItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){this.initItem(),this.setData(this._data),b8e.evt.onC(this._skin.haveName.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.haveName.node,this.onShowMenu,this)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prize))},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActivityCfg.getDataById(e.id);if(t){this._skin.rankOtherLbl.string="第"+(e.rank+1)+"名",this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.have.active=!1,this._skin.dontHave.active=!1;var i,n=game.active.selectSubType,s="";if(e.rankInfo){switch(i=e.rankInfo.score,n){case game.ActiveSubType.ST_RANK_LEVEL:s="等级:"+game.html.getText(game.html.Q_GREEN,i+"级");break;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:s="战斗力:"+game.html.getText(game.html.Q_GREEN,i+"");break;case game.ActiveSubType.ST_RANK_AMULET:s=game.html.getText(game.html.Q_GREEN,game.amulet.getDetailNameByLevel(i)+"");break;case game.ActiveSubType.ST_RANK_ARENA:i=e.rankInfo.rank,s="封神榜排名:"+game.html.getText(game.html.Q_GREEN,i+"名");break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:s="总星数:"+game.html.getText(game.html.Q_GREEN,i+"星");break;case game.ActiveSubType.ST_RANK_MOUNT:s="坐骑等级:"+game.html.getText(game.html.Q_GREEN,game.MountMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_WING:s="翅膀等级:"+game.html.getText(game.html.Q_GREEN,game.WingMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_FABAO:s="法宝等级:"+game.html.getText(game.html.Q_GREEN,game.FaBaoMgr().getLvString(i));break;case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:s="坐骑消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:s="翅膀消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:s="法宝消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_EXCHANGE:s="兑换消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_RAFFLE:s="抽卡次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:s="转盘次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:s="声望消耗:"+game.html.getText(game.html.Q_GREEN,i);break;case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:s="升星石消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:s="变身丹消耗:"+game.html.getText(game.html.Q_GREEN,i);break;case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:s="招财次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_EASTEREGG:s="砸蛋次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_CROSS_PURCHASE:s="团购:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:s="仙阵:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:s="抽奖次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_RANK_XIANZHEN:s="仙阵等级:"+game.html.getText(game.html.Q_GREEN,game.XianZhenMgr().getLvString(i));break;case game.ActiveSubType.ST_COST_RANK_XIANZHEN:s="仙阵消耗:"+game.html.getText(game.html.Q_GREEN,i+"个")}var a;this._skin.have.active=!0,this._skin.haveLv.string=s,a=t.activityType==game.ActiveType.CROSS_SERVER?game.ccfg.LangCfg.getText(71001,[e.rankInfo.zone,e.rankInfo.name]):e.rankInfo.name,this._skin.haveName.string=a}else{switch(i=e.value,n){case game.ActiveSubType.ST_RANK_LEVEL:s="等级达到:"+game.html.getText(game.html.Q_GREEN,i+"级");break;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:s="战斗力达到:"+game.html.getText(game.html.Q_GREEN,i+"");break;case game.ActiveSubType.ST_RANK_AMULET:s=game.html.getText(game.html.Q_GREEN,game.amulet.getDetailNameByLevel(i));break;case game.ActiveSubType.ST_RANK_ARENA:s="封神榜前:"+game.html.getText(game.html.Q_GREEN,i+"名");break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:s="总星数达到:"+game.html.getText(game.html.Q_GREEN,i+"星");break;case game.ActiveSubType.ST_RANK_MOUNT:s="坐骑达到:"+game.html.getText(game.html.Q_GREEN,game.MountMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_WING:s="翅膀达到:"+game.html.getText(game.html.Q_GREEN,game.WingMgr().getLvString(i));break;case game.ActiveSubType.ST_RANK_FABAO:s="法宝达到:"+game.html.getText(game.html.Q_GREEN,game.FaBaoMgr().getLvString(i));break;case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:s="坐骑消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:s="翅膀消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:s="法宝消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_EXCHANGE:s="兑换消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_RAFFLE:s="抽卡次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:s="转盘次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:s="声望消耗:"+game.html.getText(game.html.Q_GREEN,i);break;case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:s="升星石消耗:"+game.html.getText(game.html.Q_GREEN,i+"个");break;case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:s="变身丹消耗:"+game.html.getText(game.html.Q_GREEN,i);break;case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:s="招财次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_EASTEREGG:s="砸蛋次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_CROSS_PURCHASE:s="团购:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:s="仙阵:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:s="抽奖次数:"+game.html.getText(game.html.Q_GREEN,i+"次");break;case game.ActiveSubType.ST_RANK_XIANZHEN:s="仙阵达到:"+game.html.getText(game.html.Q_GREEN,game.XianZhenMgr().getLvString(i));break;case game.ActiveSubType.ST_COST_RANK_XIANZHEN:s="仙阵消耗:"+game.html.getText(game.html.Q_GREEN,i+"个")}this._skin.dontHave.active=!0,this._skin.waitLv.string=s}}else b8e.warn("活动 ",e.id,"没有找到配置数据")}},onShowMenu:function(e){if(this._data){var t=game.ccfg.ActivityCfg.getDataById(this._data.id);t?t.activityType!=game.ActiveType.CROSS_SERVER&&game.rank.showRankMenu(this._data.rankInfo,e):b8e.warn("活动 ",this._data.id,"没有找到配置数据")}},getHeight:function(){return 100},getWidth:function(){return 543}})},{}],71:[function(e,t,i){"use strict";game.ActiveRankPanel=game.SkinUI.extends({_list:null,_nickName:null,_endTimer:null,_titleName:null,ctor:function(){this._super("active/ActiveRankSkin","ActiveRankSkin")},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.selectRank,this.seeRank,this),b8e.evt.onC(this._skin.goto,this.onGoTo,this),b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.initPanel),b8e.evt.addG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankChange),this.initList(),this.initPanel(),this._list.show()},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.selectRank,this.seeRank,this),b8e.evt.offC(this._skin.goto,this.onGoTo,this),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.initPanel),b8e.evt.rmvG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.onRankChange),this._list&&this._list.hide()},initList:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.ActiveRankItem)),this._nickName||(this._nickName=b8e.Animator.get(game.AnimatorType.GUILD_UPGRADE_EFFECT,1),this._nickName.addToParent(this._skin.nickName)),this._titleName||(this._titleName=b8e.Sprite.get(),this._titleName.setAnchor(.5,.5),this._titleName.addToParent(this._skin.costTitle))},onGoTo:function(){switch(game.active.selectSubType){case game.ActiveSubType.ST_COST_RANK_MOUNT:game.funcOpen.checkOpenWithTips(game.FunctionType.MOUNT)&&game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.ActiveSubType.ST_COST_RANK_WING:game.funcOpen.checkOpenWithTips(game.FunctionType.WING)&&game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;case game.ActiveSubType.ST_COST_RANK_EXCHANGE:game.active.selectType(game.ActiveSubType.ST_COLLECT_EXCHANGE);break;case game.ActiveSubType.ST_COST_RANK_FABAO:game.funcOpen.checkOpenWithTips(game.FunctionType.FA_BAO)&&game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.ActiveSubType.ST_COST_RANK_RAFFLE:game.funcOpen.checkOpenWithTips(game.FunctionType.SHOP)&&game.app.show(game.AppConstant.SHOP_PANEL,game.ShopType.BianShen);break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:game.active.selectType(game.ActiveSubType.ST_ZHUANPAN_FESTIVAL);break;case game.ActiveSubType.ST_COST_RANK_REPUTATION:game.app.show(game.AppConstant.AMULET_PANEL);break;case game.ActiveSubType.ST_COST_RANK_STAR:game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_SHENG_XING)&&game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1);break;case game.ActiveSubType.ST_COST_RANK_BIANSHEN:game.funcOpen.checkOpenWithTips(game.FunctionType.BIAN_SHEN)&&game.app.show(game.AppConstant.BIANSHEN_DETAILS_PANEL);break;case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:game.TriggerMgr.inst().customTriggerById(3118);break;case game.ActiveSubType.ST_COST_RANK_EASTEREGG:game.active.hasActiveSubType(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD)?game.active.selectType(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD):game.active.hasActiveSubType(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG)&&game.active.selectType(game.ActiveSubType.ST_ZHUANPAN_EASTEREGG);break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:game.active.selectType(game.ActiveSubType.ST_ZHUANPAN_BIANSHEN);break;case game.ActiveSubType.ST_COST_RANK_XIANZHEN:game.funcOpen.checkOpenWithTips(game.FunctionType.XIANZHEN)&&game.AccessoryMgr.showPanel(game.AccessoryType.XianZhen)}},onRankChange:function(){var e=game.active.selectSubType;if(e!=game.ActiveSubType.ST_REBATE&&e!=game.ActiveSubType.ST_RECHARGE_ACCUMULATE_RECHARGE&&e!=game.ActiveSubType.ST_RECHARGE_REBATE&&e!=game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE){var t=game.active.subTypeToRankType(game.active.selectSubType),i=game.rank.getRankListByType(t);i=game.active.getRankData(i),this._list.setData(i);var n="",s=game.rank.getSelfRanInfoByType(t),a=s?s.score:0;switch(game.active.selectSubType){case game.ActiveSubType.ST_RANK_LEVEL:n="我的等级："+game.html.getText(game.html.Q_GREEN,a+"级");break;case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:n="我的战斗力："+game.html.getText(game.html.Q_GREEN,a+"");break;case game.ActiveSubType.ST_RANK_AMULET:n="我的护符"+game.html.getText(game.html.Q_GREEN,game.amulet.getDetailNameByLevel(a)+"");break;case game.ActiveSubType.ST_RANK_ARENA:n="我的封神榜排名："+game.html.getText(game.html.Q_GREEN,s?s.rank:"0名");break;case game.ActiveSubType.ST_RANK_EQUIP_STAR:n="我的总星数"+game.html.getText(game.html.Q_GREEN,a+"星");break;case game.ActiveSubType.ST_RANK_MOUNT:n="我的坐骑阶数："+game.html.getText(game.html.Q_GREEN,game.MountMgr().getLvString(a));break;case game.ActiveSubType.ST_RANK_WING:n="我的翅膀阶数："+game.html.getText(game.html.Q_GREEN,game.WingMgr().getLvString(a));break;case game.ActiveSubType.ST_RANK_FABAO:n="我的法宝阶数："+game.html.getText(game.html.Q_GREEN,game.FaBaoMgr().getLvString(a));break;case game.ActiveSubType.ST_RANK_XIANZHEN:n="我的仙阵阶数："+game.html.getText(game.html.Q_GREEN,game.XianZhenMgr().getLvString(a))}this._skin.self.string=n}},onCostRankChange:function(e){var t=e.data,i=(t.userRank,game.active.getRankData(t.list));this._list.setData(i);var n="",s=t.score;switch(game.active.selectSubType){case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:n="消耗的材料:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_RAFFLE:n="抽卡次数:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:n="转盘次数:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_REPUTATION:n="声望消耗:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:n="消耗的材料:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:n="招财次数:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_EASTEREGG:n="砸蛋次数:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:n="抽奖次数:"+game.html.getText(game.html.Q_GREEN,s+"");break;case game.ActiveSubType.ST_COST_RANK_XIANZHEN:n="消耗的材料:"+game.html.getText(game.html.Q_GREEN,s+"");break;default:b8e.error("活动类型没有找到!活动类型id:"+game.active.selectSubType)}this._skin.self.string=n},initPanel:function(){var e=game.active.selectSubType;if(e!=game.ActiveSubType.ST_REBATE&&e!=game.ActiveSubType.ST_RECHARGE_ACCUMULATE_RECHARGE&&e!=game.ActiveSubType.ST_RECHARGE_REBATE&&e!=game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE){var t=game.ccfg.ClientActiveCfg.getDataById(e);if(t&&t.nickName){var i=game.ClientCfg.getUIFxs(t.nickName);this._nickName.load(i),this._nickName.play(),this._skin.power.string=t.power+"",this._skin.nickNameNode.active=!0}else this._nickName.clear(),this._skin.nickNameNode.active=!1;switch(e){case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_RAFFLE:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:case game.ActiveSubType.ST_COST_RANK_EASTEREGG:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_XIANZHEN:game.ActiveSender.getActiveCostRank(e),this._skin.goto.active=!0,this._skin.selectRank.active=!1,this._skin.normalBg.active=!1,this._skin.costBg.active=!0,this._skin.costDes.string=t.des,this._skin.endTimer.node.y=650,t.title?this._titleName.loadTexture(game.ClientCfg.getImgUrl(t.title,!1),null,null,{useManifest:!1}):this._titleName.clear();break;case game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:case game.ActiveSubType.ST_RANK_XIANZHEN:var n=game.active.subTypeToRankType(e);game.rank.reqRanInfoByType(n),this._skin.goto.active=!1,this._skin.selectRank.active=!0,this._skin.normalBg.active=!0,this._skin.costBg.active=!1,this._skin.endTimer.node.y=690}}},seeRank:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.RANK)&&game.app.show(game.AppConstant.RANK_PANEL)},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;switch(e){case game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_COST_RANK_RAFFLE:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:case game.ActiveSubType.ST_RANK_XIANZHEN:case game.ActiveSubType.ST_COST_RANK_XIANZHEN:i-=5*b8e.TimeUtil.MINUTE_MICRO_SECONDS}0<i?this._skin.endTimer.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"}})},{}],72:[function(e,t,i){"use strict";game.ActiveRechargeItem=game.SkinUI.extends({_data:null,_activeData:null,_diamond:null,_rebateDays:null,_prizeList:null,_prizeInfo:null,_isCollected:!1,ctor:function(e){this._super("active/ActiveRechargeItemSkin","ActiveRechargeItemSkin"),this._prizeInfo=new game.PrizeInfo,this._data=e},onShow:function(){this.initItem(),this.setData(this._data),b8e.evt.onC(this._skin.btn_reward,this.onClickRewardBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_reward,this.onClickRewardBtn,this)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize))},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.active.selectSubType;switch(t){case game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE:case game.ActiveSubType.ST_FESTIVAL_RECHARGE:case game.ActiveSubType.SINGLE_RECHARGE:case game.ActiveSubType.ST_SINGLE_RECHARGE_2:case game.ActiveSubType.ST_SINGLE_RECHARGE_3:case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:this._activeData=e;var i,n=game.ccfg.ActivityCfg.getDataById(e);if(!n)return void b8e.warn("活动 ",e,"没有找到配置数据");for(var s="",a=0;a<n.condition.length;a++)i=n.condition[a].Value,s=t==game.ActiveSubType.SINGLE_RECHARGE||t==game.ActiveSubType.ST_SINGLE_RECHARGE_2||t==game.ActiveSubType.ST_SINGLE_RECHARGE_3?game.ccfg.LangCfg.getText(21019,[i]):t==game.ActiveSubType.ST_COST_TARGET_DIAMOND||t==game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY?game.ccfg.LangCfg.getText(21018,[i]):game.ccfg.LangCfg.getText(21017,[i]);this._skin.btn_reward.active=!0,this._skin.lab_desc.string=s,this._prizeInfo.setupById(n.prize),this._prizeList.setData(this._prizeInfo);var o=game.active.activeIsGetAllPrize(e),r=game.active.targetIsComplete(e);o?this._skin.btn_reward.active=!1:r?(this._skin.lab_reward.string="点击领取",b8e.ShaderUtil.reset(this._skin.btn_reward),this._skin.btn_blue.active=!1):(this._skin.lab_reward.string="未达标",b8e.ShaderUtil.setGray(this._skin.btn_reward),this._skin.btn_blue.active=!0);break;case game.ActiveSubType.ST_RECHARGE_REBATE:this._id=e.id,this._prizeInfo.setupById(e.prize),this._prizeList.setData(this._prizeInfo),this.updateRechargeRebateItem(e);break;default:this._id=e.id,this._prizeInfo.setupById(e.prize),this._prizeList.setData(this._prizeInfo),t==game.ActiveSubType.ST_RECHARGE_REBATE&&this.updateRechargeRebateItem(e)}}},updateRechargeRebateItem:function(e){if(this._rebateDays=game.pay.getRechargeRebateDays(),this._skin.lab_desc.string="累计充值"+e.rechargeDays+"天",this._skin.btn_reward.active=!0,e.rechargeDays<=this._rebateDays){var t=game.pay.getCollectedRebateArr();this._isCollected=game.pay.isCollected(t,this._id),this._isCollected?this._skin.btn_reward.active=!1:(this._skin.lab_reward.string="可领取",b8e.ShaderUtil.reset(this._skin.btn_reward),this._skin.btn_blue.active=!1)}else this._skin.lab_reward.string="未达标",b8e.ShaderUtil.setGray(this._skin.btn_reward),this._skin.btn_blue.active=!0},onClickRewardBtn:function(){var e=game.active.selectSubType;switch(e){case game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE:case game.ActiveSubType.ST_FESTIVAL_RECHARGE:case game.ActiveSubType.SINGLE_RECHARGE:case game.ActiveSubType.ST_SINGLE_RECHARGE_2:case game.ActiveSubType.ST_SINGLE_RECHARGE_3:case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:if(!game.ccfg.ActivityCfg.getDataById(this._data))return void b8e.warn("活动 ",this._data,"没有找到配置数据");var t=game.active.activeIsGetAllPrize(this._data),i=game.active.targetIsComplete(this._data);if(t)return void game.notice.show("您已经领取过奖励");if(!i)return void(e!=game.ActiveSubType.SINGLE_RECHARGE&&e!=game.ActiveSubType.ST_SINGLE_RECHARGE_2&&e!=game.ActiveSubType.ST_SINGLE_RECHARGE_3||game.pay.showPayPanel());game.ActiveSender.getActivePrize(this._data);break;case game.ActiveSubType.ST_RECHARGE_REBATE:if(!(this._rebateDays>=this._data.rechargeDays))return;if(this._isCollected)return void game.notice.show("您已经领取过奖励");game.PaySender.reqRechargeRebateAward(this._id)}},getWidth:function(){return 543},getHeight:function(){return 105}})},{}],73:[function(e,t,i){"use strict";game.ActiveRechargeLimitedTimePanel=game.SkinUI.extends({ctor:function(){this._super("active/ActiveRechargeLimitedTimeSkin","ActiveRechargeLimitedTimeSkin")},onShow:function(){this._rechargeDay=0,this._rechargeYb=0,this._list&&this._list.show(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),this.onReqActivityCondition(),b8e.evt.onC(this._skin.btn_reward,this.onClickPrize,this),b8e.evt.onC(this._skin.btn_total_prize,this.onClickTotalPrize,this),b8e.evt.onC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updatePanelInfo)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_reward,this.onClickPrize,this),b8e.evt.offC(this._skin.btn_total_prize,this.onClickTotalPrize,this),b8e.evt.offC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updatePanelInfo)},onReqActivityCondition:function(){switch(game.active.selectSubType){case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1:game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_RECHARGE_1),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_1),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_1);break;case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2:game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_RECHARGE_2),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_2),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_2)}},updatePanelInfo:function(){this.createDisCount(),this.updateDailyPrize();var e=game.active.selectSubType;switch(e){case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1:this._rechargeYb=.1*game.active.getActiveConditionValue(e,game.ActivityConditionType.TIME_LIMIT_RECHARGE_1),this._rechargeDay=game.active.getActiveConditionValue(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1,game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_1),this.updateTotalPrize(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1),this._skin.prize_alert.active=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1),this._skin.total_prize_alert.active=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1);break;case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2:this._rechargeYb=.1*game.active.getActiveConditionValue(e,game.ActivityConditionType.TIME_LIMIT_RECHARGE_2),this._rechargeDay=game.active.getActiveConditionValue(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2,game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_2),this.updateTotalPrize(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2),this._skin.prize_alert.active=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2),this._skin.total_prize_alert.active=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2)}this.updateTime()},createDisCount:function(){this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount));var e=game.active.selectSubType,t=game.ccfg.ClientActiveCfg.getDataById(e);t&&""!=t.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(t.discount),null,null,{useManifest:!1})},updateDailyPrize:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t&&t.activeIds&&!(t.activeIds.lenght<1)){this._rechargeDayActiveIds=t.activeIds[0];var i=game.ccfg.ActivityCfg.getDataById(t.activeIds[0]);if(i){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeInfo.setupById(i.prize),this._prizeList||(this._prizeList=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this._prizeList.addToParent(this._skin.prize_node)),this._prizeList.setData(this._prizeInfo),this._skin.btn_reward.active=!0;var n=game.active.activeIsGetAllPrize(t.activeIds[0]),s=game.active.targetIsComplete(t.activeIds[0]);n?this._skin.btn_reward.active=!1:s?(this._skin.lab_reward.string="点击领取",b8e.ShaderUtil.reset(this._skin.btn_reward),this._skin.btn_blue.active=!1):(this._skin.lab_reward.string="未达标",b8e.ShaderUtil.setGray(this._skin.btn_reward),this._skin.btn_blue.active=!0),i.condition&&0<i.condition.length&&i.condition[0]&&(this._skin.lab_recharge1.string=.1*i.condition[0].Value+"")}}},updateTotalPrize:function(e){var t=game.active.getSubTypeInfo(e);if(t&&t.activeIds&&!(t.activeIds.lenght<1)){this._rechargeTotalDayActiveIds=t.activeIds[0];var i=game.ccfg.ActivityCfg.getDataById(t.activeIds[0]);if(i){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeInfo.setupById(i.prize),this._TotalPrizeList||(this._TotalPrizeList=new game.PrizeList(6,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_100,6,!0),this._TotalPrizeList.addToParent(this._skin.total_prize_node)),this._TotalPrizeList.setData(this._prizeInfo),this._skin.btn_recharge.active=!0,this._skin.btn_total_prize.active=!0;var n=game.active.activeIsGetAllPrize(t.activeIds[0]),s=game.active.targetIsComplete(t.activeIds[0]);!n&&s?(this._skin.btn_recharge.active=!1,this._skin.btn_total_prize.active=!0):(this._skin.btn_recharge.active=!s,this._skin.btn_total_prize.active=!1),i.condition&&1<i.condition.length&&i.condition[0]&&i.condition[1]&&(this._skin.lab_recharge2.string=.1*i.condition[0].Value+"",this._skin.lab_show_day.string=i.condition[1].Value+"")}}},updateTime:function(){var e;switch(game.active.selectSubType){case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1:e=game.active.getSubTypeInfo(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1);break;case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2:e=game.active.getSubTypeInfo(game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2)}var t="已结束";if(e){var i=e.endTime-game.SysTime.curTime;0<i?t=game.timeUtil.formatTimeSpace(i):this._timer&&this._timer.stop()}else this._timer&&this._timer.stop();this._skin.lab_info.string=game.ccfg.LangCfg.getText(79308,[t,this._rechargeDay,this._rechargeYb])},onClickPrize:function(){game.ActiveSender.getActivePrize(this._rechargeDayActiveIds)},onClickTotalPrize:function(){game.ActiveSender.getActivePrize(this._rechargeTotalDayActiveIds)},onClickRecharge:function(){game.pay.showPayPanel()}})},{}],74:[function(e,t,i){"use strict";game.ActiveRechargePanel=game.SkinUI.extends({_list:null,_timer:null,discount:null,ctor:function(){this._super("active/ActiveRechargeSkin","ActiveRechargeSkin")},init:function(){this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount),this._list=new b8e.List(this._skin.list,game.ActiveRechargeItem),this._listPos1=525.9,this._view1=475,this._listPos2=610,this._view2=550,this._defDiscountSpX=this._skin.discount.x,this._oldDiscountSpY=this._skin.discount.y,this._newDiscountSpY=this._skin.discount.y+(this._skin.discount.y>>1),this._oldLabX=this._skin.lab_money.node.x,this._oldLabY=this._skin.lab_money.node.y,this._newLabY=this._skin.lab_money.node.y},onShow:function(){b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.updatePanel),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.PayEvents.COLLECT_AWARD_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updatePanel),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updatePanel),this._skin.btn_recharge.active=!game.shield.isShieldRecharge(),this.costMapSender(),this.updatePanel(),b8e.evt.onC(this._skin.btn_recharge,this.onClickRechargeBtn,this),this._list.show()},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.updatePanel),b8e.evt.rmvG(this,game.ActiveEvent.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.PayEvents.COLLECT_AWARD_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updatePanel),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updatePanel),b8e.evt.offC(this._skin.btn_recharge,this.onClickRechargeBtn,this)},costMapSender:function(){var e=game.active.selectSubType;switch(e){case game.ActiveSubType.SINGLE_RECHARGE:case game.ActiveSubType.ST_SINGLE_RECHARGE_2:case game.ActiveSubType.ST_SINGLE_RECHARGE_3:case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:var t=game.active.subTypeToCondition(e);game.ActiveSender.getActiveCostMap(t)}},startTimer:function(e){e?(this._skin.node_time.active=!0,this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start()):(this._skin.node_time.active=!1,this._timer&&this._timer.stop())},updatePanel:function(){var e=game.active.selectSubType;if(e==game.ActiveSubType.ST_RECHARGE_REBATE||e==game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE||e==game.ActiveSubType.ST_FESTIVAL_RECHARGE||e==game.ActiveSubType.SINGLE_RECHARGE||e==game.ActiveSubType.ST_SINGLE_RECHARGE_2||e==game.ActiveSubType.ST_SINGLE_RECHARGE_3||e==game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY||e==game.ActiveSubType.ST_COST_TARGET_DIAMOND){var t,i,n,s,a,o=game.ccfg.ClientActiveCfg.getDataById(e);switch(o&&""==o.discount||(this.discount.setVisible(!0),this.discount.loadTexture(game.ClientCfg.getImgUrl(o.discount,!0),null,null,{useManifest:!1})),this._skin.lab_money.node.y=-57,this._skin.lab_money.node.active=!0,this._skin.list.node.y=this._listPos1,this._skin.list.node.height=this._view1,this._skin.view.height=this._view1,this._skin.discount.setPosition(this._defDiscountSpX,this._oldDiscountSpY),this._skin.lab_money.node.x=this._oldLabX,this._skin.lab_money.node.y=this._oldLabY,e){case game.ActiveSubType.ST_RECHARGE_REBATE:this._skin.list.node.y=this._listPos2,this._skin.list.node.height=this._view2,this._skin.view.height=this._view2,this._skin.discount.setPosition(this._defDiscountSpX,616),this._skin.lab_money.node.x=-50,this._skin.lab_money.node.y=20;var r=game.pay.getRechargeRebateDays();t=game.pay.getRebateArr(),i=game.ccfg.LangCfg.getText("已累计充值$",[game.html.getText(game.html.Q_GREEN,r+"天")]),this.startTimer(!1),t&&0<t.length&&t.sort(this.onSortRebateDays);break;case game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE:s=game.ActivityConditionType.TARGET_RECHARGE,a=game.pay.getConditionsInfo(s),this._skin.lab_money.node.y=-67,a?(n=game.active.getActiveConditionValue(e,s),i=game.ccfg.LangCfg.getText("已累计充值$元宝",[game.html.getText(game.html.REWARD_COLOR,n)])):i="已累计充值0元宝",(h=game.active.getSubTypeInfo(e))&&(t=h.activeIds)&&0<t.length&&t.sort(this.onSortRestival),this.startTimer(!0);break;case game.ActiveSubType.ST_FESTIVAL_RECHARGE:s=game.ActivityConditionType.FESTIVAL_RECHARGE,a=game.pay.getConditionsInfo(s),this._skin.lab_money.node.y=-67,a?(n=game.active.getActiveConditionValue(e,s),i=game.ccfg.LangCfg.getText("已累计充值$元宝",[game.html.getText(game.html.REWARD_COLOR,n)])):i="已累计充值0元宝",(h=game.active.getSubTypeInfo(e))&&(t=h.activeIds)&&0<t.length&&t.sort(this.onSortRestival),this.startTimer(!0);break;case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:s=game.active.subTypeToCondition(e),a=game.pay.getConditionsInfo(s),this._skin.lab_money.node.y=-67,a?(n=game.active.getActiveConditionValue(e,s),i=game.ccfg.LangCfg.getText("已累计花费$元宝",[game.html.getText(game.html.REWARD_COLOR,n)])):i="已累计花费0元宝",(h=game.active.getSubTypeInfo(e))&&(t=h.activeIds)&&0<t.length&&t.sort(this.onSortRestival),this.startTimer(!0);break;case game.ActiveSubType.SINGLE_RECHARGE:case game.ActiveSubType.ST_SINGLE_RECHARGE_2:case game.ActiveSubType.ST_SINGLE_RECHARGE_3:var h;s=game.active.subTypeToCondition(e),a=game.pay.getConditionsInfo(s),this._skin.lab_money.node.y=-67,a?(n=game.active.getActiveConditionValue(e,s),i=game.ccfg.LangCfg.getText(21016,[game.html.getText(game.html.REWARD_COLOR,n)])):i=game.ccfg.LangCfg.getText(21016,[0]),(h=game.active.getSubTypeInfo(e))&&(t=h.activeIds)&&0<t.length&&t.sort(this.onSortRestival),this.startTimer(!0);break;default:this.startTimer(!1)}i&&(this._skin.lab_money.string=i),this._list.setData(t)}},onSortRebateDays:function(e,t){return game.pay.setRebateDaysState(e),game.pay.setRebateDaysState(t),0==e.state&&0==t.state?e.id>t.id?1:-1:0==e.state&&0!=t.state?-1:0!=e.state&&0==t.state?1:2==e.state&&2==t.state?e.id>t.id?1:-1:2==e.state&&2!=t.state?-1:2!=e.state&&2==t.state?1:1==e.state&&1==t.state?e.id>t.id?-1:1:1==e.state&&1!=t.state?1:1!=e.state&&1==t.state?-1:0},onSortRestival:function(e,t){var i=game.pay.getRestivalState(e),n=game.pay.getRestivalState(t);return 0==i&&0==n?t<e?1:-1:0==i&&0!=n?-1:0!=i&&0==n?1:2==i&&2==n?t<e?1:-1:2==i&&2!=n?-1:2!=i&&2==n?1:1==i&&1==n?t<e?-1:1:1==i&&1!=n?1:1!=i&&1==n?-1:0},onClickRechargeBtn:function(){game.pay.showPayPanel()},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.lab_time.string=game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.lab_time.string="已结束")}else this._timer&&this._timer.stop(),this._skin.lab_time.string="已结束"}})},{}],75:[function(e,t,i){"use strict";game.appModule.ActiveServerPanel=game.SkinUIPanel.extends({_titleList:null,rank:null,shop:null,activeTarget:null,hongbao:null,festivalRebate:null,festivalPrize:null,activeCollectExchangePanel:null,roulette:null,rouletteDb:null,rouletteFestival:null,rouletteRecharge:null,baozhu:null,dailyRebate:null,goldedPig:null,activeEasterEggPage:null,activeEasterEggGoldPage:null,activeBoss:null,lowCost:null,upCost:null,vipRebatePanel:null,zhuanPanBianshenPage:null,_curPanel:null,ctor:function(e){this._super(e)},onShow:function(){game.roulette.isActiveSever=!0,b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar),this.initSelectType(),this._titleList.show()},onHide:function(){this._curPanel&&this._curPanel.hide(),this._titleList&&this._titleList.hide(),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar)},selectTypeChange:function(){var e=game.active.getSubTypes(game.ActiveType.NEW_SERVER);this._titleList.setData(e),this.initPanel()},changeActiveBar:function(){var e=game.active.getSubTypes(game.ActiveType.NEW_SERVER);this._titleList.setData(e)},initSelectType:function(){var e=game.active.getSubTypes(game.ActiveType.NEW_SERVER);e&&0!=e.length?(this.data&&-1!=e.indexOf(this.data)?game.active.selectType(this.data):game.active.selectType(e[0]),this.selectTypeChange()):b8e.log("没有找到 新服活动 下有任何字类型活动！！！")},init:function(){this._titleList=new b8e.List(this._skin.titleView,game.ActiveTitleItem,20)},initPanel:function(){this._curPanel&&this._curPanel.hide();switch(game.active.selectSubType){case game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_COST_RANK_RAFFLE:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:case game.ActiveSubType.ST_COST_RANK_EASTEREGG:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_RANK_XIANZHEN:case game.ActiveSubType.ST_COST_RANK_XIANZHEN:this.rank||(this.rank=new game.ActiveRankPanel,this.rank.addToParent(this._skin.page)),this.rank.show(),this._curPanel=this.rank;break;case game.ActiveSubType.ST_REBATE:this.shop||(this.shop=new game.ActiveShopPanel,this.shop.addToParent(this._skin.page)),this.shop.show(),this._curPanel=this.shop;break;case game.ActiveSubType.ST_TARGET_LEVEL:case game.ActiveSubType.ST_TARGET_FIGHGT_AMOUNT:case game.ActiveSubType.ST_TARGET_REPUTATION:case game.ActiveSubType.ST_TARGET_ARENA:case game.ActiveSubType.ST_TARGET_EQUIP_STAR:case game.ActiveSubType.ST_TARGET_MOUNT:case game.ActiveSubType.ST_TARGET_WING:case game.ActiveSubType.ST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_MOUNT:case game.ActiveSubType.ST_COST_TARGET_WING:case game.ActiveSubType.ST_COST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_EXCHANGE:case game.ActiveSubType.ST_COST_TARGET_RAFFLE:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN:case game.ActiveSubType.ST_COST_TARGET_REPUTATION:case game.ActiveSubType.ST_COST_TARGET_STAR:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI:case game.ActiveSubType.ST_COST_TARGET_EASTEREGG:case game.ActiveSubType.ST_COST_TARGET_MOUNT_NEW:case game.ActiveSubType.ST_COST_TARGET_WING_NEW:case game.ActiveSubType.ST_COST_TARGET_FABAO_NEW:case game.ActiveSubType.ST_COST_TARGET_STAR_NEW:case game.ActiveSubType.ST_NEW_RECHARGE:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI_NEW:case game.ActiveSubType.ST_COST_TARGET_RAFFLE_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_REPUTATION_NEW:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_NEW:case game.ActiveSubType.ST_COST_TARGET_TOWER_NEW:case game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW:case game.ActiveSubType.ST_COST_TARGET_XUNBAO_NEW:case game.ActiveSubType.ST_TARGET_XIANZHEN:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN:case game.ActiveSubType.ST_TARGET_ELITE_BOSS:this.activeTarget||(this.activeTarget=new game.ActiveTargetPanel,this.activeTarget.addToParent(this._skin.page)),this.activeTarget.show(),this._curPanel=this.activeTarget;break;case game.ActiveSubType.ST_ZHUANPAN_NORMAL:case game.ActiveSubType.ST_ZHUANPAN_COMBINE:this.roulette||(this.roulette=new game.RoulettePanel,this.roulette.addToParent(this._skin.page)),this.roulette.show(),this._curPanel=this.roulette;break;case game.ActiveSubType.ST_ZHUANPAN_FESTIVAL:this.rouletteFestival||(this.rouletteFestival=new game.RoulettePanel,this.rouletteFestival.addToParent(this._skin.page)),this.rouletteFestival.show(),this._curPanel=this.rouletteFestival;break;case game.ActiveSubType.ST_ZHUANPAN_RECHARGE:this.rouletteRecharge||(this.rouletteRecharge=new game.RouletteRechargePanel,this.rouletteRecharge.addToParent(this._skin.page)),this.rouletteRecharge.show(),this._curPanel=this.rouletteRecharge;break;case game.ActiveSubType.ST_DUOBAO_NORMAL:this.rouletteDb||(this.rouletteDb=new game.RouletteDbPanel,this.rouletteDb.addToParent(this._skin.page)),this.rouletteDb.show(),this._curPanel=this.rouletteDb;break;case game.ActiveSubType.ST_ZHUANPAN_BAOZHU:this.baozhu||(this.baozhu=new game.BaozhuPanel,this.baozhu.addToParent(this._skin.page)),this.baozhu.show(),this._curPanel=this.baozhu;break;case game.ActiveSubType.ST_FESTIVAL_REBATE:this.festivalRebate||(this.festivalRebate=new game.FestivalRebatePanel,this.festivalRebate.addToParent(this._skin.page)),this.festivalRebate.show(),this._curPanel=this.festivalRebate;break;case game.ActiveSubType.ST_COLLECT_EXCHANGE:this.activeCollectExchangePanel||(this.activeCollectExchangePanel=new game.ActiveCollectExchangePanel,this.activeCollectExchangePanel.addToParent(this._skin.page)),this.activeCollectExchangePanel.show(),this._curPanel=this.activeCollectExchangePanel;break;case game.ActiveSubType.FESTIVAL_LOGIN:this.festivalPrize||(this.festivalPrize=new game.FestivalPrizePanel,this.festivalPrize.addToParent(this._skin.page)),this.festivalPrize.show(),this._curPanel=this.festivalPrize;break;case game.ActiveSubType.ST_SYSTEM_HONGBAO:this.hongbao||(this.hongbao=new game.ActiveHongBaoPanel,this.hongbao.addToParent(this._skin.page)),this.hongbao.show(),this._curPanel=this.hongbao;break;case game.ActiveSubType.ST_WORLD_BOSS:this.activeBoss||(this.activeBoss=new game.ActiveBossPanel,this.activeBoss.addToParent(this._skin.page)),this.activeBoss.show(),this._curPanel=this.activeBoss;break;case game.ActiveSubType.ST_VIP_REBATE:this.vipRebatePanel||(this.vipRebatePanel=new game.VipRebatePanel,this.vipRebatePanel.addToParent(this._skin.page)),this.vipRebatePanel.show(),this._curPanel=this.vipRebatePanel;break;case game.ActiveSubType.ST_ZHUANPAN_LOW_COST:this.lowCost||(this.lowCost=new game.LowCostPanel,this.lowCost.addToParent(this._skin.page)),this.lowCost.show(),this._curPanel=this.lowCost;break;case game.ActiveSubType.ST_DAILY_REBATE:this.dailyRebate||(this.dailyRebate=new game.DailyRebatePanel,this.dailyRebate.addToParent(this._skin.page)),this.dailyRebate.show(),this._curPanel=this.dailyRebate;break;case game.ActiveSubType.ST_ZHUANPAN_UP_COST:this.upCost||(this.upCost=new game.UpCostPanel,this.upCost.addToParent(this._skin.page)),this.upCost.show(),this._curPanel=this.upCost;break;case game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST:this.goldedPig||(this.goldedPig=new game.GoldedPigPage,this.goldedPig.addToParent(this._skin.page)),this.goldedPig.show(),this._curPanel=this.goldedPig;break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG:this.activeEasterEggPage||(this.activeEasterEggPage=new game.ActiveEasterEggPage,this.activeEasterEggPage.addToParent(this._skin.page)),this.activeEasterEggPage.show(),this._curPanel=this.activeEasterEggPage;break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD:this.activeEasterEggGoldPage||(this.activeEasterEggGoldPage=new game.ActiveEasterEggGoldPage,this.activeEasterEggGoldPage.addToParent(this._skin.page)),this.activeEasterEggGoldPage.show(),this._curPanel=this.activeEasterEggGoldPage;break;case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:this.zhuanPanBianshenPage||(this.zhuanPanBianshenPage=new game.ZhuanPanBianshen,this.zhuanPanBianshenPage.addToParent(this._skin.page)),this.zhuanPanBianshenPage.show(),this._curPanel=this.zhuanPanBianshenPage}}})},{}],76:[function(e,t,i){"use strict";game.ActiveShopItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,_discountLine:null,_titleName:null,ctor:function(){this._super("active/ActiveShopItemSkin","ActiveShopItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){b8e.evt.onC(this._skin.buy,this.buy,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.buy,this.buy,this)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prize)),this._discountLine||(this._discountLine=b8e.Graphics.get(),this._discountLine.lineWidth(2),this._discountLine.fillColor(14496563),this._discountLine.moveTo(0,0),this._discountLine.lineTo(220,0),this._discountLine.addToParent(this._skin.lastCostLine))},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActivityCfg.getDataById(e);if(t){this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.vip.node.active=!1,this._skin.normalVip.active=!1,t.vip?(t.vip,this._skin.vip.node.active=!0,this._skin.vip.string="VIP "+t.vip+" 特权"):this._skin.normalVip.active=!0,this._skin.buy.active=!1,this._skin.cantBuy.active=!1;var i=game.active.finishActiveMap.get(e);if(i&&i>=t.attendTimes?(this._skin.cantBuy.active=!0,this._skin.buyLbl.string="已购买"):(this._skin.buy.active=!0,this._skin.buyLbl.string="购买"),i||(i=0),this._skin.buyCount.string=t.attendTimes-i+"/"+t.attendTimes,this._skin.lastCostYingBi.active=!1,this._skin.lastCostYuanBao.active=!1,this._skin.nowCostYingBi.active=!1,this._skin.nowCostYuanBao.active=!1,t.showCost.length<=0||t.realCost.length<=0)b8e.log("配置表没有配置消耗！");else{var n=t.showCost[0],s=t.realCost[0];n.Id==game.AmountItemId.YUAN_BAO?this._skin.lastCostYuanBao.active=!0:this._skin.lastCostYingBi.active=!0,s.Id==game.AmountItemId.YUAN_BAO?this._skin.nowCostYuanBao.active=!0:this._skin.nowCostYingBi.active=!0,this._skin.nowCost.string=s.Num+"",this._skin.lastCost.string=n.Num+"";var a=s.Num/n.Num;a=10*a>>0,this._skin.discount.string=a+""}}else b8e.warn("活动 ",e,"没有找到配置数据")}},buy:function(){if(this._data){var e=game.ccfg.ActivityCfg.getDataById(this._data);if(e){var t=game.mainRole.mainRoleData,i=t.getLv();i<e.minLv?game.notice.show("不在等级范围内，无法购买"):0!=e.maxLv&&i>e.maxLv?game.notice.show("不在等级范围内，无法购买"):e.vip&&e.vip>t.vipLevel?game.notice.show("VIP 等级不足，无法购买"):game.ActiveSender.getActivePrize(this._data)}else b8e.warn("活动 ",this._data,"没有找到配置数据")}},getHeight:function(){return 115},getWidth:function(){return 543}})},{}],77:[function(e,t,i){"use strict";game.ActiveShopPanel=game.SkinUI.extends({_list:null,_endTimer:null,_discount:null,ctor:function(){this._super("active/ActiveShopSkin","ActiveShopSkin")},init:function(){this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount);var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_REBATE);e&&""!=e.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1})},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),this.initList(),this.initPanel(),this._list.show()},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),this._list&&this._list.hide()},initList:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.ActiveShopItem))},initPanel:function(){var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_REBATE);this._list.setData(e.getActiveIds())},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"}})},{}],78:[function(e,t,i){"use strict";game.ActiveTargetItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("active/ActiveTargetItemSkin","ActiveTargetItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){b8e.evt.onC(this._skin.waitGet,this.getPrize,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.waitGet,this.getPrize,this)},getPrize:function(){if(this._data){var e=game.ccfg.ActivityCfg.getDataById(this._data);if(e){var t=game.mainRole.mainRoleData,i=t.getLv();i<e.minLv?game.notice.show(81e3):0!=e.maxLv&&i>e.maxLv?game.notice.show(81001):e.vip&&e.vip>t.vipLevel?game.notice.show(81002):game.ActiveSender.getActivePrize(this._data)}else b8e.warn("活动 ",this._data,"没有找到配置数据")}},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize))},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActivityCfg.getDataById(e);if(t){for(var i,n,s,a,o=0;o<t.condition.length;o++)switch(n=(i=t.condition[o]).Type,s=i.Value,n){case game.ActivityConditionType.TARGET_LEVEL:a="等级达到"+s+"级";break;case game.ActivityConditionType.TARGET_FIGHT_AMOUNT:a="战斗力达到"+s;break;case game.ActivityConditionType.TARGET_REPUTATION:a=game.amulet.getDetailNameByLevel(s);break;case game.ActivityConditionType.TARGET_ARENA:a="封神榜排名达到前"+s;break;case game.ActivityConditionType.TARGET_EQUIP_STAR:a="全身槽位升星总和达到"+s+"星";break;case game.ActivityConditionType.TARGET_MOUNT:a="坐骑达到"+game.MountMgr().getLvString(s);break;case game.ActivityConditionType.TARGET_WING:a="翅膀达到"+game.WingMgr().getLvString(s);break;case game.ActivityConditionType.TARGET_FABAO:a="法宝达到"+game.FaBaoMgr().getLvString(s);break;case game.ActivityConditionType.COST_TARGET_MOUNT:case game.ActivityConditionType.COST_TARGET_CROSS_MOUNT:case game.ActivityConditionType.COST_TARGET_MOUNT_NEW:a="坐骑消耗"+s+"个";break;case game.ActivityConditionType.COST_TARGET_WING:case game.ActivityConditionType.COST_TARGET_CROSS_WING:case game.ActivityConditionType.COST_TARGET_WING_NEW:a="翅膀消耗"+s+"个";break;case game.ActivityConditionType.COST_TARGET_FABAO:case game.ActivityConditionType.COST_TARGET_CROSS_FABAO:case game.ActivityConditionType.COST_TARGET_FABAO_NEW:a="法宝消耗"+s+"个";break;case game.ActivityConditionType.COST_TARGET_EXCHANGE:a="材料消耗"+s+"个";break;case game.ActivityConditionType.COST_TARGET_RAFFLE:case game.ActivityConditionType.COST_TARGET_RAFFLE_NEW:a="抽卡次数"+s+"次";break;case game.ActivityConditionType.COST_TARGET_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_CROSS_ZHUANPAN:case game.ActivityConditionType.COST_TARGET_ZHUANPAN_NEW:a="转盘次数"+s+"次";break;case game.ActivityConditionType.COST_TARGET_REPUTATION:case game.ActivityConditionType.COST_TARGET_CROSS_REPUTATION:case game.ActivityConditionType.COST_TARGET_REPUTATION_NEW:a="声望消耗"+s;break;case game.ActivityConditionType.COST_TARGET_STAR:case game.ActivityConditionType.COST_TARGET_CROSS_STAR:case game.ActivityConditionType.COST_TARGET_STAR_NEW:a="升星石消耗"+s+"个";break;case game.ActivityConditionType.COST_TARGET_BIANSHEN:case game.ActivityConditionType.COST_TARGET_CROSS_BIANSHEN:case game.ActivityConditionType.COST_TARGET_BIANSHEN_NEW:a="变身丹消耗"+s;break;case game.ActivityConditionType.COST_TARGET_ZHAOCAI:case game.ActivityConditionType.COST_TARGET_ZHAOCAI_NEW:a="招财次数"+s+"次";break;case game.ActivityConditionType.COST_TARGET_EASTEREGG:a="砸蛋次数"+s+"次";break;case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:break;case game.ActivityConditionType.NEW_RECHARGE:a="累计充值"+s+"元";break;case game.ActivityConditionType.COST_TARGET_XIANZHEN_NEW:case game.ActivityConditionType.COST_TARGET_CROSS_XIANZHEN:case game.ActivityConditionType.COST_TARGET_XIANZHEN:a="仙阵消耗"+s;break;case game.ActivityConditionType.COST_TARGET_TOWER_NEW:a="闯天关"+game.tower.convertPassString(s);break;case game.ActivityConditionType.COST_TARGET_HIGH_EQUIP_NEW:a="穿戴神装总等级"+s+"级";break;case game.ActivityConditionType.COST_TARGET_XUNBAO_NEW:a="寻宝次数"+s+"次";break;case game.ActivityConditionType.TARGET_XIANZHEN:a="仙阵达到"+game.XianZhenMgr().getLvString(s);break;case game.ActivityConditionType.COST_TARGET_ZHUANPAN_BIANSHEN:a="变身转盘次数"+s+"次";break;case game.ActivityConditionType.TARGET_ELITE_BOSS:a="达到"+game.loneyDungeon.getLvString(s)}this._skin.itemTitle.string=a,this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.isGet.active=!1,this._skin.cantGet.active=!1,this._skin.waitGet.active=!1;var r=game.active.activeIsGetAllPrize(e),h=game.active.targetIsComplete(e);r?(this._skin.isGet.active=!0,this._skin.label.string="已领取"):h?(this._skin.label.string="领取",this._skin.waitGet.active=!0):(this._skin.label.string="领取",this._skin.cantGet.active=!0)}else b8e.warn("活动 ",e,"没有找到配置数据")}},getHeight:function(){return 115},getWidth:function(){return 543}})},{}],79:[function(e,t,i){"use strict";game.ActiveTargetPanel=game.SkinUI.extends({_list:null,_endTimer:null,_discount:null,ctor:function(){this._super("active/ActiveTargetSkin","ActiveTargetSkin")},init:function(){this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount)},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),this.initList(),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.initPanel),b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),this._list.show(),this.selectTypeChange()},onHide:function(){this._list&&this._list.hide(),this._endTimer&&this._endTimer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.initPanel),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange)},initList:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.ActiveTargetItem))},selectTypeChange:function(){var e=game.active.selectSubType;switch(e){case game.ActiveSubType.ST_COST_TARGET_MOUNT:case game.ActiveSubType.ST_COST_TARGET_WING:case game.ActiveSubType.ST_COST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_EXCHANGE:case game.ActiveSubType.ST_COST_TARGET_RAFFLE:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN:case game.ActiveSubType.ST_COST_TARGET_REPUTATION:case game.ActiveSubType.ST_COST_TARGET_STAR:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI:case game.ActiveSubType.ST_COST_TARGET_EASTEREGG:case game.ActiveSubType.ST_COST_TARGET_MOUNT_NEW:case game.ActiveSubType.ST_COST_TARGET_WING_NEW:case game.ActiveSubType.ST_COST_TARGET_FABAO_NEW:case game.ActiveSubType.ST_COST_TARGET_STAR_NEW:case game.ActiveSubType.ST_NEW_RECHARGE:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI_NEW:case game.ActiveSubType.ST_COST_TARGET_RAFFLE_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_REPUTATION_NEW:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_NEW:case game.ActiveSubType.ST_COST_TARGET_TOWER_NEW:case game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW:case game.ActiveSubType.ST_COST_TARGET_XUNBAO_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_BIANSHEN:var t=game.active.subTypeToCondition(e);game.ActiveSender.getActiveCostMap(t);break;default:this.initPanel()}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},initPanel:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.getActiveIds();i.sort(this.onSort),this._list.setData(i)}else this._list.setData(null);var n=game.ccfg.ClientActiveCfg.getDataById(e);switch(n&&""!=n.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(n.discount,!0),null,null,{useManifest:!1}),e){case game.ActiveSubType.ST_COST_TARGET_MOUNT:case game.ActiveSubType.ST_COST_TARGET_WING:case game.ActiveSubType.ST_COST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_EXCHANGE:case game.ActiveSubType.ST_COST_TARGET_RAFFLE:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN:case game.ActiveSubType.ST_COST_TARGET_REPUTATION:case game.ActiveSubType.ST_COST_TARGET_STAR:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI:case game.ActiveSubType.ST_COST_TARGET_EASTEREGG:case game.ActiveSubType.ST_COST_TARGET_MOUNT_NEW:case game.ActiveSubType.ST_COST_TARGET_WING_NEW:case game.ActiveSubType.ST_COST_TARGET_FABAO_NEW:case game.ActiveSubType.ST_COST_TARGET_STAR_NEW:case game.ActiveSubType.ST_NEW_RECHARGE:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI_NEW:case game.ActiveSubType.ST_COST_TARGET_RAFFLE_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_REPUTATION_NEW:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_NEW:case game.ActiveSubType.ST_COST_TARGET_TOWER_NEW:case game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW:case game.ActiveSubType.ST_COST_TARGET_XUNBAO_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_BIANSHEN:this._skin.lab_expend.node.active=!0;var s=game.active.subTypeToCondition(e),a=game.active.getActiveConditionValue(e,s);e==game.ActiveSubType.ST_COST_TARGET_TOWER_NEW&&(a=0==a?0:game.tower.convertPassString(a)),this._skin.lab_expend.string=a;break;default:this._skin.lab_expend.node.active=!1}},onSort:function(e,t){var i=game.active.activeIsGetAllPrize(e),n=game.active.activeIsGetAllPrize(t);return i&&!n?1:!i&&n?-1:0}})},{}],80:[function(e,t,i){"use strict";game.ActiveTitleItem=game.SkinUI.extends({_data:null,_normal:null,_normalName:null,_select:null,_selectName:null,_effect:null,ctor:function(){this._super("active/ActiveTitleItemSkin","ActiveTitleItemSkin")},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},initItem:function(){this._normal||(this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle)),this._normalName||(this._normalName=b8e.Sprite.get(),this._normalName.addToParent(this._skin.normalName)),this._select||(this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle)),this._selectName||(this._selectName=b8e.Sprite.get(),this._selectName.addToParent(this._skin.selectName)),this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._effect.setAnchor(.5,.5),this._effect.addToParent(this))},onTouchThis:function(){game.active.selectType(this._data)},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ClientActiveCfg.getDataById(e);if(t){var i,n=game.active.getTargetIsAlert(e);this._skin.alert.active=!!n,this._skin.normalTitle.active=!1,this._skin.normalName.active=!1,this._skin.selectTitle.active=!1,this._skin.selectName.active=!1;var s=game.active.selectSubType;if(this._data==s)this._skin.selectTitle.active=!0,this._skin.selectName.active=!0,i=game.ClientCfg.getActiveTitleBgSelect(t.titleBg),this._select.loadTexture(i,null,null,{useManifest:!1}),t.titleNameBg?(i=game.ClientCfg.getActiveTitleBgSelect(t.titleNameBg),this._selectName.loadTexture(i,null,null,{useManifest:!1})):this._selectName.unloadTexture(),this._effect.clear();else this._skin.normalTitle.active=!0,this._skin.normalName.active=!0,i=game.ClientCfg.getActiveTitleBg(t.titleBg),this._normal.loadTexture(i,null,null,{useManifest:!1}),t.titleNameBg?(i=game.ClientCfg.getActiveTitleBg(t.titleNameBg),this._normalName.loadTexture(i,null,null,{useManifest:!1})):this._normalName.unloadTexture(),game.active.getIsShowEffect(e)?(this._effect.load(game.ClientCfg.getUIFxs(10054)),this._effect.play()):this._effect.clear()}else b8e.warn("活动 ",e,"没有找到配置数据")}},getHeight:function(){return 95},getWidth:function(){return 85}})},{}],81:[function(e,t,i){"use strict";game.appModule.CrossActivePanel=game.SkinUIPanel.extends({_titleList:null,crossRank:null,crossPurchase:null,filterArr:null,allSubTypes:null,_curPanel:null,ctor:function(e){this._super(e),this.filterArr=[],this.allSubTypes=[]},onShow:function(){this._titleList||(this._titleList=new b8e.List(this._skin.titleView,game.ActiveTitleItem,20)),b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.hidePanel),this.initSelectType(),this._titleList.show()},onHide:function(){this._curPanel&&this._curPanel.hide(),this._titleList&&this._titleList.hide(),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.hidePanel)},initSelectType:function(){this.setBtnsArr(),0!=this.filterArr.length?(game.active.selectType(this.filterArr[0]),this.needSetBtnsArr=!1,this.selectTypeChange()):b8e.log("没有找到 跨服活动")},selectTypeChange:function(){this.needSetBtnsArr&&this.setBtnsArr(),this.needSetBtnsArr=!0,this._titleList.setData(this.filterArr),this.initPanel()},changeActiveBar:function(){this.setBtnsArr(),this._titleList.setData(this.filterArr)},hidePanel:function(){this.hide()},setBtnsArr:function(){this.allSubTypes=game.active.getSubTypes(game.ActiveType.CROSS_SERVER),this.filterTypes()},filterTypes:function(){if(this.filterArr.length=0,this.allSubTypes&&0<this.allSubTypes.length)for(var e=this.allSubTypes.length,t=0;t<e;t++)switch(this.allSubTypes[t]){case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:case game.ActiveSubType.ST_CROSS_REBATE_PURCHASE:this.filterArr.push(this.allSubTypes[t])}},initPanel:function(){this._curPanel&&this._curPanel.hide();switch(game.active.selectSubType){case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:this.crossRank||(this.crossRank=new game.CrossRankPanel,this.crossRank.addToParent(this._skin.page)),this.crossRank.show(),this._curPanel=this.crossRank;break;case game.ActiveSubType.ST_CROSS_REBATE_PURCHASE:this.crossPurchase||(this.crossPurchase=new game.CrossPurchasePanel,this.crossPurchase.addToParent(this._skin.page)),this.crossPurchase.show(),this._curPanel=this.crossPurchase}}})},{}],82:[function(e,t,i){"use strict";game.CrossPurchaseItem=game.SkinUI.extends({_data:null,_prizeInfo:null,_prizeList:null,_upgradeInfo:null,_selfContribute:0,_totalContribute:0,_cost:0,_amountType:-1,ctor:function(){this._super("active/CrossPurchaseItemSkin","CrossPurchaseItemSkin"),this._prizeInfo=new game.PrizeInfo,this._upgradeInfo=new game.UpgradeInfo},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this)},init:function(){this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ActivityCfg.getDataById(e);if(t){if(this._skin.attendTimes.string="每日限购"+t.attendTimes+"次",this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.realCost),this._upgradeInfo){var i=this._upgradeInfo.getAmountInfo();switch(0<i.amountMap.count()?this._cost=i.getFirstAmountValue():this._cost=this._upgradeInfo.getFirstUpgradeInfoNum(),this._skin.lab_price.string=this._cost,this._amountType=i.getFirstAmountType(),this._amountType=0|+this._amountType,this._amountType){case game.AmountType.SILVER:this._skin.icon_yuanbao.active=!1,this._skin.icon_yinbi.active=!0;break;case game.AmountType.YUAN_BAO:this._skin.icon_yuanbao.active=!0,this._skin.icon_yinbi.active=!1}}var n,s,a;this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo);for(var o=0;o<t.condition.length;o++)switch(s=(n=t.condition[o]).Type,a=n.Value,s){case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE:this._selfContribute=a,this._skin.lab_desc.string=game.ccfg.LangCfg.getText(71003,[a]);break;case game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL:this._totalContribute=a,this._skin.lab_title.string=game.ccfg.LangCfg.getText(71002,[a])}var r=game.active.activeIsGetAllPrize(e);this._skin.btn_buy.active=!r}}},onClickBuyBtn:function(){if(this._data){var e=game.active.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL),t=game.active.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE);e>=this._totalContribute&&t>=this._selfContribute?this.showBuyTips():game.pay.showPayPanel()}},showBuyTips:function(){var e=new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoBtn;var t="";switch(this._amountType){case game.AmountType.SILVER:t="银币";break;case game.AmountType.YUAN_BAO:t="元宝"}e.string="是否花费"+game.html.getText(game.html.Q_GREEN,this._cost+t)+"购买该物品",e.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,e)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ActiveSender.getActivePrize(this._data);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},getWidth:function(){return 545},getHeight:function(){return 140}})},{}],83:[function(e,t,i){"use strict";game.CrossPurchasePanel=game.SkinUI.extends({listShop:null,listRank:null,listReward:null,_discount:null,typeArr:null,panelIndex:0,_endTimer:null,maxContibute:0,ctor:function(){this._super("active/CrossPurchaseSkin","CrossPurchaseSkin"),this.typeArr=[]},init:function(){this.listShop=new b8e.List(this._skin.list_shop,game.CrossPurchaseItem),this.listRank=new b8e.List(this._skin.list_rank,game.CrossRankItem),this.listReward=new b8e.List(this._skin.list_reward,game.CrossRewardItem)},onShow:function(){this.updatePanel(),this.listShop.show(),this.listRank.show(),this.listReward.show(),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.toggle[0].node,this.onClickShop,this),b8e.evt.onC(this._skin.toggle[1].node,this.onClickRank,this),b8e.evt.onC(this._skin.toggle[2].node,this.onClickReward,this),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.addG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updateList),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateContribute)},onHide:function(){this.listShop&&this.listShop.hide(),this.listRank&&this.listRank.hide(),this.listReward&&this.listReward.hide(),this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.toggle[0].node,this.onClickShop,this),b8e.evt.offC(this._skin.toggle[1].node,this.onClickRank,this),b8e.evt.offC(this._skin.toggle[2].node,this.onClickReward,this),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.rmvG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updateList),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateContribute)},updatePanel:function(){this._skin.toggle[0].check();var e=game.ccfg.ClientActiveCfg.getDataById(game.active.selectSubType);e&&""!=e.discount&&(this._discount||(this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount),this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1})));var t=game.active.getSubTypeInfo(game.active.selectSubType);if(t){var i=t.endTime,n=b8e.TimeUtil.formatTimestamp(i,"Y-M-D 23:55结算");this._skin.postPrizeTime.string=n,this.panelIndex=0,this.typeArr=game.active.getTypeArrByCrossGroup(t.crossGroup),this.typeArr&&0<this.typeArr.length&&(this.typeArr.sort(this.onSort),this.selectPanel(this.typeArr[0]))}},updateContribute:function(){var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE);this.listShop.setData(e.getActiveIds());var t=game.active.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL),i=game.active.getCSMaxConditionValue();0<i?(this._skin.progressMask.width=t/i*300,this._skin.progressLab.string=t+"/"+i):(this._skin.progressMask.width=0,this._skin.progressLab.string="0"),t=game.active.getActiveConditionValue(game.ActiveSubType.ST_CROSS_REBATE_PURCHASE,game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE),this._skin.lab_contribute.string=game.ccfg.LangCfg.getText(71004,[t])},selectPanel:function(e){0==this.panelIndex?(game.ActiveSender.getActiveCostMap(game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL),this._skin.node_shop.active=!0,this._skin.node_rank.active=!1,this._skin.node_target.active=!1,this._skin.node_redBg.active=!0):1==this.panelIndex?(this.sendCostRankReq(e),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.COST_TARGET_CROSS_PURCHASE_GLOBAL),this._skin.node_shop.active=!1,this._skin.node_rank.active=!0,this._skin.node_target.active=!1,this._skin.node_redBg.active=!0):(this.sendCostRankReq(e),this._skin.node_shop.active=!1,this._skin.node_rank.active=!1,this._skin.node_target.active=!0,this._skin.node_redBg.active=!1)},sendCostRankReq:function(e){switch(e){case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_PURCHASE:case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:game.ActiveSender.getActiveCostRank(e)}},updateList:function(){this.selectPanel(this.typeArr[this.panelIndex])},onCostRankChange:function(e){var t=e.data;1==this.panelIndex?(this.listRank.setData(game.active.getPurchaseData(t.list)),0<t.userRank.rank?this._skin.mRank.string=""+t.userRank.rank:this._skin.mRank.string="未上榜"):this.listReward.setData(game.active.getRankData(t.list))},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束"},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClickShop:function(){0!=this.panelIndex&&(this.panelIndex=0,this.selectPanel(this.typeArr[this.panelIndex]))},onClickRank:function(){1!=this.panelIndex&&(this.panelIndex=1,game.active.selectSubType=this.typeArr[1],this.selectPanel(this.typeArr[this.panelIndex]))},onClickReward:function(){2!=this.panelIndex&&(this.panelIndex=2,game.active.selectSubType=this.typeArr[1],this.selectPanel(this.typeArr[1]))},onSort:function(e,t){return t-e}})},{}],84:[function(e,t,i){"use strict";game.CrossRankItem=game.SkinUI.extends({_data:null,ctor:function(){this._super("active/CrossRankItemSkin","CrossRankItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){},setData:function(e){if(this._data=e,this._skin&&this._data){switch(this._skin.lab_rank.string="",this._data.rank){case 1:this._skin.img_one.active=!0;break;case 2:this._skin.img_two.active=!0;break;case 3:this._skin.img_three.active=!0;break;default:this._skin.img_four.active=!0,this._skin.lab_rank.string=this._data.rank}this._skin.lab_name.string=e.name,this._skin.lab_server.string=e.zone}},getHeight:function(){return 54},getWidth:function(){return 520}})},{}],85:[function(e,t,i){"use strict";game.CrossRankPanel=game.SkinUI.extends({listShop:null,listRank:null,listTarget:null,_endTimer:null,_discount:null,typeArr:null,panelIndex:0,ctor:function(){this._super("active/CrossRankSkin","CrossRankSkin"),this.typeArr=[]},init:function(){this.listShop=new b8e.List(this._skin.list_shop,game.ActiveShopItem),this.listRank=new b8e.List(this._skin.list_rank,game.ActiveRankItem),this.listTarget=new b8e.List(this._skin.list_target,game.ActiveTargetItem)},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),this.updatePanel(),this.listShop.show(),this.listRank.show(),this.listTarget.show(),b8e.evt.onC(this._skin.toggle[0].node,this.onClickShop,this),b8e.evt.onC(this._skin.toggle[1].node,this.onClickRank,this),b8e.evt.onC(this._skin.toggle[2].node,this.onClickReward,this),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.addG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updateList),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateTargetList)},onHide:function(){this._endTimer&&this._endTimer.stop(),this.listShop&&this.listShop.hide(),this.listRank&&this.listRank.hide(),this.listTarget&&this.listTarget.hide(),b8e.evt.offC(this._skin.toggle[0].node,this.onClickShop,this),b8e.evt.offC(this._skin.toggle[1].node,this.onClickRank,this),b8e.evt.offC(this._skin.toggle[2].node,this.onClickReward,this),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.rmvG(this,game.ActiveEvent.COST_RANK_CHANGE,this.onCostRankChange),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.updateList),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateTargetList)},updatePanel:function(){this._skin.toggle[0].check();var e=game.ccfg.ClientActiveCfg.getDataById(game.active.selectSubType);e&&""!=e.des&&(this._skin.lab_desc.string=e.des),e&&""!=e.discount&&(this._discount||(this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount),this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1})));var t=game.active.getSubTypeInfo(game.active.selectSubType);if(t){this.panelIndex=0,this.typeArr=game.active.getTypeArrByCrossGroup(t.crossGroup),this.typeArr&&0<this.typeArr.length&&(this.typeArr.sort(this.onSort),this.selectPanel(this.typeArr[0])),this.typeArr&&2<this.typeArr.length&&(this._skin.redIcon.active=game.active.getTargetIsAlert(this.typeArr[2]));var i=game.active.getCostValueByType(this.typeArr[2]);this._skin.consNumLab.string="已消耗:"+i}},selectPanel:function(e){if(0==this.panelIndex){var t=game.active.getSubTypeInfo(e);t&&this.listShop.setData(t.getActiveIds()),this._skin.node_shop.active=!0,this._skin.node_rank.active=!1,this._skin.node_target.active=!1}else if(1==this.panelIndex){switch(e){case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:game.ActiveSender.getActiveCostRank(e)}this._skin.node_shop.active=!1,this._skin.node_rank.active=!0,this._skin.node_target.active=!1}else{var i=game.active.subTypeToCondition(e);game.ActiveSender.getActiveCostMap(i)}},updateList:function(){this.typeArr&&2<this.typeArr.length&&(this._skin.redIcon.active=game.active.getTargetIsAlert(this.typeArr[2])),this.selectPanel(this.typeArr[this.panelIndex])},updateTargetList:function(){if(this.typeArr&&!(this.typeArr.length<=0)){var e=game.active.getSubTypeInfo(this.typeArr[this.panelIndex]);if(e){switch(e.subType){case game.ActiveSubType.ST_COST_TARGET_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_TARGET_CROSS_STAR:case game.ActiveSubType.ST_COST_TARGET_CROSS_FABAO:case game.ActiveSubType.ST_COST_TARGET_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_TARGET_CROSS_MOUNT:case game.ActiveSubType.ST_COST_TARGET_CROSS_WING:case game.ActiveSubType.ST_COST_TARGET_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_CROSS_PURCHASE:case game.ActiveSubType.ST_COST_TARGET_CROSS_XIANZHEN:break;default:return}var t=e.getActiveIds();t&&0<t.length&&t.sort(this.onSortTarget),this.listTarget.setData(t),this._skin.node_shop.active=!1,this._skin.node_rank.active=!1,this._skin.node_target.active=!0}}},onSortTarget:function(e,t){var i=game.pay.getRestivalState(e),n=game.pay.getRestivalState(t);return 0==i&&0==n?t<e?1:-1:0==i&&0!=n?-1:0!=i&&0==n?1:2==i&&2==n?t<e?1:-1:2==i&&2!=n?-1:2!=i&&2==n?1:1==i&&1==n?t<e?-1:1:1==i&&1!=n?1:1!=i&&1==n?-1:0},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime-5*b8e.TimeUtil.MINUTE_MICRO_SECONDS;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimes.string="已结束"},onCostRankChange:function(e){var t=e.data,i=game.active.getRankData(t.list);this.listRank.setData(i)},onClickShop:function(){0!=this.panelIndex&&(this.panelIndex=0,this.selectPanel(this.typeArr[this.panelIndex]))},onClickRank:function(){1!=this.panelIndex&&(this.panelIndex=1,game.active.selectSubType=this.typeArr[this.panelIndex],this.selectPanel(this.typeArr[this.panelIndex]))},onClickReward:function(){2!=this.panelIndex&&(this.panelIndex=2,this.selectPanel(this.typeArr[this.panelIndex]))},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onSort:function(e,t){return t-e}})},{}],86:[function(e,t,i){"use strict";game.CrossRewardItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("active/CrossRewardItemSkin","CrossRewardItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize)),this.setData(this._data)},onHide:function(){},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ActivityCfg.getDataById(e.id);if(t)switch(this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.lab_rank.string="",this._data.rank+1){case 1:this._skin.img_one.active=!0;break;case 2:this._skin.img_two.active=!0;break;case 3:this._skin.img_three.active=!0;break;default:this._skin.img_four.active=!0,this._skin.lab_rank.string=this._data.rank+1}else b8e.warn("活动 ",e.id,"没有找到配置数据")}},getHeight:function(){return 90},getWidth:function(){return 520}})},{}],87:[function(e,t,i){"use strict";game.DailyRebatePanel=game.SkinUI.extends({discount:null,_timer:null,costItemInfo:null,upgradeInfo:null,_sprite1:null,activeCfg:null,rebateCfg:null,activeId:0,_prizeSprite:null,_width:0,_maxWidth:0,_prizeInfo:null,rebateList:null,_progressWidth:0,ctor:function(){this._super("active/DailyRebateSkin","DailyRebateSkin")},onShow:function(){this.initPanel(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.onC(this._skin.toggleBtn[0].node,this.onClickFirstItem,this),b8e.evt.onC(this._skin.toggleBtn[1].node,this.onClickSecondItem,this),b8e.evt.onC(this._skin.toggleBtn[2].node,this.onClickThirdItem,this),b8e.evt.onC(this._skin.toggleBtn[3].node,this.onClickFourthItem,this),b8e.evt.onC(this._skin.prize,this.onClickPrize,this),b8e.evt.onC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.getPrizeSuccess),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshBuyCount),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.activeChange)},onHide:function(){this.stopTime(),b8e.evt.offC(this._skin.toggleBtn[0].node,this.onClickFirstItem,this),b8e.evt.offC(this._skin.toggleBtn[1].node,this.onClickSecondItem,this),b8e.evt.offC(this._skin.toggleBtn[2].node,this.onClickThirdItem,this),b8e.evt.offC(this._skin.toggleBtn[3].node,this.onClickFourthItem,this),b8e.evt.offC(this._skin.prize,this.onClickPrize,this),b8e.evt.offC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.getPrizeSuccess),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshBuyCount),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.activeChange)},init:function(){this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount),this._sprite1=b8e.Sprite.get(),this._sprite1.addToParent(this._skin.icon1),this._sprite1.setScale(.5,.5),this._prizeSprite=b8e.Sprite.get(),this._prizeSprite.addToParent(this._skin.prize),0<this._skin.toggleBtn[0].width?this._width=this._skin.toggleBtn[0].node.width:this._width=128,this._maxWidth=560,this.rebateList=[],this._progressWidth=this._skin.progress.width-110,this._prizeInfo=new game.PrizeInfo},activeChange:function(){this.initPanel(),this._timer.reset(),this._timer.start()},initPanel:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e),i=game.ccfg.ClientActiveCfg.getDataById(e);if(i&&""!=i.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(i.discount,!0),null,null,{useManifest:!1}),t&&!(t.activeIds.length<=0)){0!=this.activeId&&-1!=t.activeIds.indexOf(this.activeId)||(this.activeId=t.activeIds[0]);var n=0;for(n=0;n<this._skin.toggleBtn.length;n++)this._skin.toggleBtn[n].node.active=!1;var s=t.activeIds.length<=4?t.activeIds.length:4;for(n=0;n<s;n++){var a=game.ccfg.ActivityCfg.getDataById(t.activeIds[n]);a&&(this._skin.toggleBtn[n].node.active=!0,this._skin.toggleLab[n].string=a.name,this._skin.toggleBtn[n].node.x=(this._maxWidth-this._width*s)/2+this._width*n,this.activeId==t.activeIds[n]&&this.selectIndexItem(n))}this.refreshPanel()}},refreshPanel:function(){var e=game.ccfg.ActivityCfg.getDataById(this.activeId);if(e){this._prizeInfo.setupById(e.prize);var t=this._prizeInfo.getPrizeList();if(t&&!(t.length<=0)&&(this.prizeItem=t[0],this.prizeItem)){switch(this.prizeItem.type){case game.PrizeItemType.TYPE_ITEM:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(this.prizeItem.itemId,!0);break;case game.PrizeItemType.TYPE_SILVER:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.SILVER,!0);break;case game.PrizeItemType.TYPE_YUAN_BAO:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.YUAN_BAO,!0);break;case game.PrizeItemType.TYPE_POPULARITY:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.POPULARITY,!0);break;case game.PrizeItemType.BIAN_SHEN_CARD:this.itemInfo=game.ccfg.BianshenCfg.getBianshenCfgById(this.prizeItem.itemId),this.itemInfo.type=game.GoodsType.BIAN_SHEN_CARD;break;default:b8e.warn("PrizeList PrizeItem type warn："+this.prizeItem.type+"---"+this.itemInfo.name+"("+this.itemInfo.id+")")}this.itemInfo?(this._prizeSprite.loadTexture(game.ClientCfg.getImgUrl(this.itemInfo.iconName,!1),null,null,{useManifest:!1}),this._skin.prize_lab.string=game.html.getText(game.html.getColorByQuality(this.itemInfo.quality),this.itemInfo.name)+game.html.getText(game.html.Q_YELLOW,"X"+this.prizeItem.num),this.refreshBuyCount(),this.refreshRebateNum()):b8e.log("配置表没有该物品的信息")}}},getPrizeSuccess:function(){this.refreshBuyCount(),this.refreshRebateNum()},refreshRebateNum:function(){var e,t=0,i=0;for(i=this._skin.rebateImg.length,t=0;t<i;t++)this._skin.rebateImg[t].active=!1,this._skin.rebateLight[t].active=!1,this._skin.rebateLabel[t].node.active=!1,0<t&&(this._skin.rebateActiveLabel[t-1].node.active=!1);var n=game.ccfg.ActivityCfg.getDataById(this.activeId);if(n&&(this.rebateList=game.ccfg.RebateCostCfg.getRebateList(n.costId),this.rebateList&&!(this.rebateList.length<=0))){for(this.last=game.active.finishActiveMap.get(this.activeId),this.last||(this.last=0),i=this.rebateList.length,t=0;t<i;t++)if(e=game.ccfg.RebateCostCfg.getData(n.costId,this.rebateList[t])){var s=this.rebateList[t]-1;0|e.rebateDesc,this._skin.rebateImg[t].active=!0,this._skin.rebateLabel[t].node.active=!0,this._skin.rebateLabel[t].string=game.ccfg.LangCfg.getText(21020,[e.rebateDesc]),0<t&&(this._skin.rebateActiveLabel[t-1].node.active=!0,this._skin.rebateActiveLabel[t-1].string=game.ccfg.LangCfg.getText(21021,[s]),this._skin.rebateActiveLabel[t-1].node.x=this._progressWidth/this.rebateList[i-1]*s,s<=this.last&&(this._skin.rebateLight[t].active=!0)),this._skin.rebateImg[t].x=this._skin.rebateLabel[t].node.x=this._progressWidth/this.rebateList[i-1]*s}this._skin.mask.width=this.last/this.rebateList[i-1]*this._progressWidth+110,this._skin.rebateLight[0].active=!0}},refreshBuyCount:function(){this.last=game.active.finishActiveMap.get(this.activeId),this.last||(this.last=0),this.vipCount=game.vip.getDailyRebateCount(),this.vipCount||(this.vipCount=0),this.maxVrc=game.ccfg.VipCfg.getMaxDRC(),this._skin.buyCount.string=game.ccfg.LangCfg.getText(21005,[this.last,this.vipCount]),this.vipCount<this.maxVrc?this._skin.buyDesc.string=game.ccfg.LangCfg.getText(21008):this._skin.buyDesc.string=game.ccfg.LangCfg.getText(21009);var e=game.ccfg.ActivityCfg.getDataById(this.activeId);if(e){var t=game.ccfg.RebateCostCfg.getCount(e.costId,this.last+1);if(t&&(this.rebateCfg=game.ccfg.RebateCostCfg.getData(e.costId,t),this.rebateCfg)){this.costItemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(this.rebateCfg.realCost[0].Id),this.costItemInfo&&this._sprite1.loadTexture(game.ClientCfg.getImgUrl(this.costItemInfo.iconName,!1),null,null,{useManifest:!1}),this._skin.costNum.string=this.rebateCfg.realCost[0].Num,this._skin.rebateNum.string=this.rebateCfg.rebateDesc;var i=game.ccfg.RebateCostCfg.getNextCfg(e.costId,t);if(i){var n=i.count-this.last-1;(n<=0||i.count>this.maxVrc)&&(n=0,this._skin.rebateDesc.node.active=!1),this._skin.rebateDesc.string=game.ccfg.LangCfg.getText(21007,[n,i.rebateDesc])}}}},onClickGetBtn:function(){this.rebateCfg&&(this.last>=this.vipCount&&this.last<this.maxVrc?game.gameAlert.showVipAlert(!1,103):this.last>=this.maxVrc?game.notice.show(21010):(this.upgradeInfo||(this.upgradeInfo=new game.UpgradeInfo),this.upgradeInfo.setUpgradeInfo(this.rebateCfg.realCost),game.upgrade.costCheck(this,this.upgradeInfo,this.callBack)))},callBack:function(e){var t=this.activeId;if(t&&this.rebateCfg&&this.prizeItem&&this.itemInfo&&this.costItemInfo&&e){var i="是否购买"+this.itemInfo.name+"*"+this.prizeItem.num+"<br/>消耗:"+this.rebateCfg.realCost[0].Num+this.costItemInfo.name,n=new game.GameAlertInfo;n.alertType=game.GameAlertType.TwoBtn,n.string=i,n.obj={id:t},n.isShowTips=!0,game.gameAlert.showAlert(this,this.onCheck,n)}},onCheck:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ActiveSender.getActivePrize(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},onClickFirstItem:function(){this.selectIndexItem(0)},onClickSecondItem:function(){this.selectIndexItem(1)},onClickThirdItem:function(){this.selectIndexItem(2)},onClickFourthItem:function(){this.selectIndexItem(3)},onClickPrize:function(){this.itemInfo?game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this.itemInfo,containerId:game.ContainerId.DAILY_REBATE_CONTAINER_ID}):b8e.log("vipRebate没有该物品的信息")},selectIndexItem:function(e){var t=game.active.selectSubType,i=game.active.getSubTypeInfo(t);!i||i.activeIds.length<=e||i.activeIds[e]&&(this.activeId=i.activeIds[e],this._skin.toggleBtn[e].check(),this.refreshPanel())},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):this.stopTime()}else this.stopTime()},stopTime:function(){this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"}})},{}],88:[function(e,t,i){"use strict";game.DepotGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 130},getWidth:function(){return 105},setData:function(e){e&&(this._itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(e.award.Id,!0),this._itemInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ACTIVE_DEPOT_CONTAINER_ID),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo,!1),this._itemGrid.setNum(e.award.Num),this._itemGrid.sortLayer()))},onClick:function(e){this._itemInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.ACTIVE_DEPOT_CONTAINER_ID})}})},{}],89:[function(e,t,i){"use strict";game.appModule.FestivalLoginPanel=game.SkinUIPanel.extends({_titleList:null,hongbao:null,festivalRebate:null,festivalPrize:null,activeCollectExchangePanel:null,roulette:null,rouletteDb:null,rouletteFestival:null,rouletteRecharge:null,baozhu:null,dailyRebate:null,rank:null,activeTarget:null,shop:null,activeBoss:null,lowCost:null,goldedPig:null,upCost:null,vipRebatePanel:null,activeEasterEggPage:null,activeEasterEggGoldPage:null,zhuanPanGoldPage:null,zhuanPanBianshenPage:null,mysteryPage:null,recharge:null,ctor:function(e){this._super(e)},onShow:function(){if(this.data&&this.data.activeType){var e=game.active.getSubTypes(this.data.activeType);switch(this.data.activeType){case game.ActiveType.UNION_SERVER:this._skin.title.string=game.ccfg.LangCfg.getText(21002);break;case game.ActiveType.FESTIVAL:this._skin.title.string=game.ccfg.LangCfg.getText(21001);break;case game.ActiveType.GIFT:this._skin.title.string=game.ccfg.LangCfg.getText(21022);break;case game.ActiveType.COMPETE:this._skin.title.string=game.ccfg.LangCfg.getText(21023);break;case game.ActiveType.FESTIVAL_2:this._skin.title.string=game.ccfg.LangCfg.getText(21024);break;default:this._skin.title.string=game.ccfg.LangCfg.getText(21001)}}else{this._skin.title.string=game.ccfg.LangCfg.getText(21001);e=game.active.getSubTypes(game.ActiveType.FESTIVAL)}this.data&&this.data.activeSubType&&-1!=e.indexOf(this.data.activeSubType)?(game.active.selectType(this.data.activeSubType),this.selectTypeChange()):this.initSelectType(),b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar),this._titleList.show()},onHide:function(){b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.changeActiveBar),this.hidePage(),this._titleList&&this._titleList.hide()},selectTypeChange:function(){var e;e=this.data&&this.data.activeType?game.active.getSubTypes(this.data.activeType):game.active.getSubTypes(game.ActiveType.FESTIVAL),this._titleList.setData(e),this.initPanel()},changeActiveBar:function(){var e;e=this.data&&this.data.activeType?game.active.getSubTypes(this.data.activeType):game.active.getSubTypes(game.ActiveType.FESTIVAL),this._titleList.setData(e)},initSelectType:function(){var e;(e=this.data&&this.data.activeType?game.active.getSubTypes(this.data.activeType):game.active.getSubTypes(game.ActiveType.FESTIVAL))&&0!=e.length?(game.active.selectType(e[0]),this.selectTypeChange()):b8e.log("没有找到 新服活动 下有任何字类型活动！！！")},init:function(){this.festivalPrize=new game.FestivalPrizePanel,this.festivalPrize.addToParent(this._skin.page),this.festivalRebate=new game.FestivalRebatePanel,this.festivalRebate.addToParent(this._skin.page),this.roulette=new game.RoulettePanel,this.roulette.addToParent(this._skin.page),this.rouletteDb=new game.RouletteDbPanel,this.rouletteDb.addToParent(this._skin.page),this.rouletteFestival=new game.RoulettePanel,this.rouletteFestival.addToParent(this._skin.page),this.baozhu=new game.BaozhuPanel,this.baozhu.addToParent(this._skin.page),this.activeCollectExchangePanel=new game.ActiveCollectExchangePanel,this.activeCollectExchangePanel.addToParent(this._skin.page),this.hongbao=new game.ActiveHongBaoPanel,this.hongbao.addToParent(this._skin.page),this._titleList=new b8e.List(this._skin.titleView,game.ActiveTitleItem,20),this.rank=new game.ActiveRankPanel,this.rank.addToParent(this._skin.page),this.activeTarget=new game.ActiveTargetPanel,this.activeTarget.addToParent(this._skin.page),this.activeBoss=new game.ActiveBossPanel,this.activeBoss.addToParent(this._skin.page),this.shop=new game.ActiveShopPanel,this.shop.addToParent(this._skin.page),this.vipRebatePanel=new game.VipRebatePanel,this.vipRebatePanel.addToParent(this._skin.page),this.lowCost=new game.LowCostPanel,this.lowCost.addToParent(this._skin.page),this.dailyRebate=new game.DailyRebatePanel,this.dailyRebate.addToParent(this._skin.page),this.rouletteRecharge=new game.RouletteRechargePanel,this.rouletteRecharge.addToParent(this._skin.page),this.activeEasterEggPage=new game.ActiveEasterEggPage,this.activeEasterEggPage.addToParent(this._skin.page),this.activeEasterEggGoldPage=new game.ActiveEasterEggGoldPage,this.activeEasterEggGoldPage.addToParent(this._skin.page),this.zhuanPanGoldPage=new game.ZhuanPanGoldPage,this.zhuanPanGoldPage.addToParent(this._skin.page),this.goldedPig=new game.GoldedPigPage,this.goldedPig.addToParent(this._skin.page),this.upCost=new game.UpCostPanel,this.upCost.addToParent(this._skin.page),this.zhuanPanBianshenPage=new game.ZhuanPanBianshen,this.zhuanPanBianshenPage.addToParent(this._skin.page),this.mysteryPage=new game.ActiveMysteryPanel,this.mysteryPage.addToParent(this._skin.page),this.recharge=new game.ActiveRechargePanel,this.recharge.addToParent(this._skin.page)},hidePage:function(){this.festivalPrize.hide(),this.festivalRebate.hide(),this.roulette.hide(),this.rouletteDb.hide(),this.rouletteFestival.hide(),this.baozhu.hide(),this.rank.hide(),this.activeTarget.hide(),this.activeCollectExchangePanel.hide(),this.hongbao.hide(),this.activeBoss.hide(),this.shop.hide(),this.vipRebatePanel.hide(),this.lowCost.hide(),this.dailyRebate.hide(),this.rouletteRecharge.hide(),this.activeEasterEggPage.hide(),this.activeEasterEggGoldPage.hide(),this.zhuanPanGoldPage.hide(),this.goldedPig.hide(),this.upCost.hide(),this.zhuanPanBianshenPage.hide(),this.mysteryPage.hide(),this.recharge.hide()},initPanel:function(){switch(this.hidePage(),game.active.selectSubType){case game.ActiveSubType.ST_RANK_LEVEL:case game.ActiveSubType.ST_RANK_FIGHGT_AMOUNT:case game.ActiveSubType.ST_RANK_AMULET:case game.ActiveSubType.ST_RANK_ARENA:case game.ActiveSubType.ST_RANK_EQUIP_STAR:case game.ActiveSubType.ST_RANK_MOUNT:case game.ActiveSubType.ST_RANK_WING:case game.ActiveSubType.ST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_MOUNT:case game.ActiveSubType.ST_COST_RANK_WING:case game.ActiveSubType.ST_COST_RANK_FABAO:case game.ActiveSubType.ST_COST_RANK_EXCHANGE:case game.ActiveSubType.ST_COST_RANK_RAFFLE:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_REPUTATION:case game.ActiveSubType.ST_COST_RANK_STAR:case game.ActiveSubType.ST_COST_RANK_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_ZHAOCAI:case game.ActiveSubType.ST_COST_RANK_EASTEREGG:case game.ActiveSubType.ST_COST_RANK_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_RANK_XIANZHEN:case game.ActiveSubType.ST_COST_RANK_XIANZHEN:this.rank.show();break;case game.ActiveSubType.ST_TARGET_LEVEL:case game.ActiveSubType.ST_TARGET_FIGHGT_AMOUNT:case game.ActiveSubType.ST_TARGET_REPUTATION:case game.ActiveSubType.ST_TARGET_ARENA:case game.ActiveSubType.ST_TARGET_EQUIP_STAR:case game.ActiveSubType.ST_TARGET_MOUNT:case game.ActiveSubType.ST_TARGET_WING:case game.ActiveSubType.ST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_MOUNT:case game.ActiveSubType.ST_COST_TARGET_WING:case game.ActiveSubType.ST_COST_TARGET_FABAO:case game.ActiveSubType.ST_COST_TARGET_EXCHANGE:case game.ActiveSubType.ST_COST_TARGET_RAFFLE:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN:case game.ActiveSubType.ST_COST_TARGET_REPUTATION:case game.ActiveSubType.ST_COST_TARGET_STAR:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI:case game.ActiveSubType.ST_COST_TARGET_EASTEREGG:case game.ActiveSubType.ST_TARGET_XIANZHEN:case game.ActiveSubType.ST_TARGET_ELITE_BOSS:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_BIANSHEN:case game.ActiveSubType.ST_COST_TARGET_ZHAOCAI_NEW:case game.ActiveSubType.ST_COST_TARGET_RAFFLE_NEW:case game.ActiveSubType.ST_COST_TARGET_XIANZHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_REPUTATION_NEW:case game.ActiveSubType.ST_COST_TARGET_BIANSHEN_NEW:case game.ActiveSubType.ST_COST_TARGET_ZHUANPAN_NEW:case game.ActiveSubType.ST_COST_TARGET_TOWER_NEW:case game.ActiveSubType.ST_COST_TARGET_HIGH_EQUIP_NEW:case game.ActiveSubType.ST_COST_TARGET_XUNBAO_NEW:case game.ActiveSubType.ST_COST_TARGET_MOUNT_NEW:case game.ActiveSubType.ST_COST_TARGET_WING_NEW:case game.ActiveSubType.ST_COST_TARGET_FABAO_NEW:case game.ActiveSubType.ST_COST_TARGET_STAR_NEW:case game.ActiveSubType.ST_NEW_RECHARGE:this.activeTarget.show();break;case game.ActiveSubType.ST_ZHUANPAN_NORMAL:case game.ActiveSubType.ST_ZHUANPAN_COMBINE:this.roulette.show();break;case game.ActiveSubType.ST_ZHUANPAN_FESTIVAL:this.rouletteFestival.show();break;case game.ActiveSubType.ST_ZHUANPAN_RECHARGE:this.rouletteRecharge.show();break;case game.ActiveSubType.ST_DUOBAO_NORMAL:this.rouletteDb.show();break;case game.ActiveSubType.ST_ZHUANPAN_BAOZHU:this.baozhu.show();break;case game.ActiveSubType.ST_FESTIVAL_REBATE:this.festivalRebate.show();break;case game.ActiveSubType.ST_COLLECT_EXCHANGE:case game.ActiveSubType.ST_COLLECT_EXCHANGE_2:case game.ActiveSubType.ST_COLLECT_EXCHANGE_3:this.activeCollectExchangePanel.show();break;case game.ActiveSubType.FESTIVAL_LOGIN:this.festivalPrize.show();break;case game.ActiveSubType.ST_SYSTEM_HONGBAO:this.hongbao.show();break;case game.ActiveSubType.ST_WORLD_BOSS:this.activeBoss.show();break;case game.ActiveSubType.ST_REBATE:this.shop.show();break;case game.ActiveSubType.ST_VIP_REBATE:this.vipRebatePanel.show();break;case game.ActiveSubType.ST_ZHUANPAN_LOW_COST:this.lowCost.show();break;case game.ActiveSubType.ST_DAILY_REBATE:this.dailyRebate.show();break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG:this.activeEasterEggPage.show();break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD:this.activeEasterEggGoldPage.show();break;case game.ActiveSubType.ST_ZHUANPAN_DIAMOND:this.zhuanPanGoldPage.show();case game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST:this.goldedPig.show();break;case game.ActiveSubType.ST_ZHUANPAN_UP_COST:this.upCost.show();break;case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:this.zhuanPanBianshenPage.show();break;case game.ActiveSubType.ST_MYSTERY:this.mysteryPage.show();break;case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:this.recharge.show()}}})},{}],90:[function(e,t,i){"use strict";game.FestivalPrizeItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,_days:null,ctor:function(){this._super("active/FestivalPrizeItemSkin","FestivalPrizeItemSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){b8e.evt.onC(this._skin.waitGet,this.getPrize,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.waitGet,this.getPrize,this)},getPrize:function(){this._data&&game.ActiveSender.getActivePrize(this._data)},init:function(){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prize),this._days=b8e.Sprite.get(),this._days.setAnchor(.5,.5),this._days.addToParent(this._skin.days)},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.ActivityCfg.getDataById(e);if(t){if(this._prizeInfo.setupById(t.prize),this._prizeList.setData(this._prizeInfo),this._skin.isGet.active=!1,this._skin.cantGet.active=!1,this._skin.waitGet.active=!1,t.condition&&!(t.condition.length<=0)){t.condition[0].Type;var i=t.condition[0].Value,n=game.active.activeIsGetAllPrize(e),s=(game.pay.getConditionsInfo(game.ActivityConditionType.FESTIVAL_LOGIN),game.active.getActiveConditionValue(game.ActiveSubType.FESTIVAL_LOGIN,game.ActivityConditionType.FESTIVAL_LOGIN));n?(this._skin.isGet.active=!0,this._skin.label.string="已领取"):i<=s?(this._skin.label.string="领取",this._skin.waitGet.active=!0):(this._skin.label.string="领取",this._skin.cantGet.active=!0),this._days.loadTexture(game.ClientCfg.getDayUrl(i),null,null,{useManifest:!1})}}else b8e.warn("活动 ",e,"没有找到配置数据")}},getHeight:function(){return 115},getWidth:function(){return 540}})},{}],91:[function(e,t,i){"use strict";game.FestivalPrizePanel=game.SkinUI.extends({_list:null,_timer:null,discount:null,ctor:function(){this._super("active/FestivalPrizeSkin","FestivalPrizeSkin")},onShow:function(){this._list.show(),this.initPanel(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel)},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel)},init:function(){this._list=new b8e.List(this._skin.scrollview,game.FestivalPrizeItem),this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount))},initPanel:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e),i=game.ccfg.ClientActiveCfg.getDataById(e);i&&""!=i.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(i.discount,!0),null,null,{useManifest:!1}),t?this._list.setData(t.getActiveIds()):this._list.setData(null);var n=game.pay.getConditionsInfo(game.ActivityConditionType.FESTIVAL_LOGIN),s=game.active.getActiveConditionValue(game.ActiveSubType.FESTIVAL_LOGIN,game.ActivityConditionType.FESTIVAL_LOGIN);this._skin.loginDays.string=n?s+"天":"0天"},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"}})},{}],92:[function(e,t,i){"use strict";game.FestivalRebateItem=game.SkinUI.extends({_data:null,titleBg:null,ctor:function(){this._super("active/FestivalRebateItemSkin","FestivalRebateItemSkin")},onShow:function(){b8e.evt.onC(this,this.selectBtn,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this,this.selectBtn,this)},init:function(){this.titleBg=b8e.Sprite.get(),this.titleBg.addToParent(this._skin.titleBg)},setData:function(e){if(this._data=e,this._skin)if(game.ccfg.ActivityCfg.getDataById(e)){var t=game.ccfg.ClientActiveCfg.getDataById(7001+this.itemRenderIndex);t&&this.titleBg.loadTexture(game.ClientCfg.getImgUrl(t.titleBg,!1),null,null,{useManifest:!1}),game.active.selectFestivalRebateId==this._data?this._skin.img_select.active=!0:this._skin.img_select.active=!1}else b8e.warn("活动 ",e,"没有找到配置数据")},selectBtn:function(){game.active.selectFestivalRebateId!=this._data&&(game.active.selectFestivalRebateId=this._data,b8e.evt.dptG(game.ActiveEvent.SELECT_FESTIVAL_REBATE_CHANGE))},getHeight:function(){return 149},getWidth:function(){return 125}})},{}],93:[function(e,t,i){"use strict";game.FestivalRebatePanel=game.SkinUI.extends({_list:null,discount:null,_prizeList:null,_prizeInfo:null,_timer:null,ctor:function(){this._super("active/FestivalRebateSkin","FestivalRebateSkin")},onShow:function(){this.initSelectItem(),this.initPanel(),this._list.show(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.onC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.addG(this,game.ActiveEvent.SELECT_FESTIVAL_REBATE_CHANGE,this.initPanel)},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_FESTIVAL_REBATE_CHANGE,this.initPanel)},init:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.FestivalRebateItem)),this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount)),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize_node))},initSelectItem:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);t?!t.activeIds||t.activeIds.length<0?b8e.log("没有找到 当前活动的子活动id ！！！"):game.active.selectFestivalRebateId=t.activeIds[0]:b8e.log("没有找到 当前活动 信息！！！")},initPanel:function(){var e=game.active.selectSubType,t=game.active.selectFestivalRebateId;if(t){this.discount.loadTexture(game.ClientCfg.getImgUrl("active/discount/festivalRebate_bg",!0),null,null,{useManifest:!1});var i=game.active.getSubTypeInfo(e);i&&this._list.setData(i.activeIds),game.active.activeIsGetAllPrize(t)?(this._skin.isGet.active=!0,this._skin.cantGet.active=!1,this._skin.label.string="已购买"):(this._skin.label.string="立即购买",this._skin.isGet.active=!1,this._skin.cantGet.active=!0);var n=game.ccfg.ActivityCfg.getDataById(t);n&&(!n.realCost||n.realCost.length<0||(this._skin.lab_desc.string=game.ccfg.LangCfg.getText(1036,[n.realCost[0].Num,n.name]),this._prizeInfo.setupById(n.prize),this._prizeList.setData(this._prizeInfo)))}},onClickGetBtn:function(){var e=game.active.selectFestivalRebateId;if(e){var t=game.ccfg.ActivityCfg.getDataById(e);if(t){var i=new game.UpgradeInfo;i.setUpgradeInfo(t.realCost),game.upgrade.costCheck(this,i,this.callBack)}}},callBack:function(e){var t=game.active.selectFestivalRebateId;if(t){var i=game.ccfg.ActivityCfg.getDataById(t);if(i&&e){var n="确认花费<s>"+i.realCost[0].Num+"</s>元宝<br/>购买"+i.name,s=new game.GameAlertInfo;s.alertType=game.GameAlertType.TwoBtn,s.string=n,s.obj={id:t},s.isShowTips=!1,game.gameAlert.showAlert(this,this.onCheck,s)}}},onCheck:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ActiveSender.getActivePrize(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string="剩余时间:"+game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"}})},{}],94:[function(e,t,i){"use strict";game.LoginPrizeItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("active/LoginPrizeItemSkin","LoginPrizeItemSkin"),this._prizeInfo=new game.PrizeInfo},getButtonByName:function(e){switch(e){case"waitGet":return!this._skin||this._skin.waitGet}return null},onShow:function(){b8e.evt.onC(this._skin.waitGet,this.getPrize,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.waitGet,this.getPrize,this)},getPrize:function(){this._data&&game.ActiveSender.getLoginPrize(this._data.days)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,1),this._prizeList.addToParent(this._skin.prize))},setData:function(e){if(this._data=e,this._skin&&this._data){this._prizeInfo.setupById(e.prize),this._prizeList.setData(this._prizeInfo),this._skin.isGet.active=!1,this._skin.cantGet.active=!1,this._skin.waitGet.active=!1;var t=game.active.isGetDaysPrize(e.days),i=game.mainRole.mainRoleData.miscData;t?(this._skin.isGet.active=!0,this._skin.label.string="已领取",this._skin.prizeDes.string="",this.setScale(.97,.97)):i.loginDay>=e.days?(this._skin.label.string="领取",this._skin.waitGet.active=!0,this.setScale(1,1),this._skin.prizeDes.string=""):i.loginDay==e.days-1?(this._skin.label.string="明日可领",this._skin.cantGet.active=!0,this.setScale(.97,.97),this._skin.prizeDes.string=""):(this._skin.label.string="",this.setScale(.97,.97),this._skin.prizeDes.string=this._data.prizeDes),this._skin.prizeName.string=this._data.prizeName,this._skin.days.string="第"+this._data.days+"天"}},getHeight:function(){return 115},getWidth:function(){return 540}})},{}],95:[function(e,t,i){"use strict";game.appModule.LoginPrizePanel=game.SkinUIPanel.extends({list:null,discount:null,items:null,onShow:function(){b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel),this.initList(),this.initPanel()},getButtonByName:function(e){switch(e){case"waitGet":return!(this._skin&&this.items&&0<this.items.length)||this.items[0].getButtonByName("waitGet");case"back":return!this._skin||this._skin.closeBtnReturn}return null},onHide:function(){b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.initPanel);for(var e=0;e<this.items.length;e++){this.items[e].hide()}},initList:function(){if(!this.items){var e,t;this.items=[];for(var i=0;i<this._skin.items.length;i++)e=this._skin.items[i],(t=new game.LoginPrizeItem).addToParent(e),this.items.push(t)}this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount))},initPanel:function(){for(var e,t,i=game.ccfg.LoginPrizeCfg.getDatas(),n=!0,s=1;s<8&&0!=(n=game.active.isGetDaysPrize(s));s++);var a=n?7:0;for(s=0;s<this.items.length;s++)e=this.items[s],(t=i[s+a])?(e.show(),e.setData(t)):e.hide();this.discount.loadTexture(game.ClientCfg.getImgUrl("active/discount/loginPrize",!0),null,null,{useManifest:!1})}})},{}],96:[function(e,t,i){"use strict";game.appModule.RechargeActivesPanel=game.SkinUIPanel.extends({_titleList:null,rank:null,shop:null,recharge:null,saleDaily:null,discountDaily:null,lowCost:null,goldedPig:null,upCost:null,rouletteRecharge:null,activeEasterEggPage:null,timeLimitRecharge:null,_curPanel:null,ctor:function(e){this._super(e)},init:function(){this._titleList=new b8e.List(this._skin.titleView,game.ActiveTitleItem,20)},onShow:function(){game.active.initRechargeActives(),b8e.evt.addG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange),this.initSelectType(),this._titleList.show()},onHide:function(){this._curPanel&&this._curPanel.hide(),this._titleList&&this._titleList.hide(),b8e.evt.rmvG(this,game.ActiveEvent.SELECT_SUB_TYPE_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange)},selectTypeChange:function(){var e=game.active.getSubTypes(game.ActiveType.REBATE);e&&0<e.length&&e.sort(this.onSortById),this._titleList.setData(e),this.initPanel()},onSortById:function(e,t){var i=game.ccfg.ClientActiveCfg.getDataById(e),n=game.ccfg.ClientActiveCfg.getDataById(t);if(i&&n){if(i.sortId>n.sortId)return-1;if(i.sortId<n.sortId)return 1}return 0},initSelectType:function(){var e=game.active.getSubTypes(game.ActiveType.REBATE);e&&0<e.length&&e.sort(this.onSortById),e&&0!=e.length?(game.active.selectType(e[0]),this.selectTypeChange()):b8e.log("没有找到 新服活动 下有任何字类型活动！！！")},initPanel:function(){this._curPanel&&this._curPanel.hide();var e=game.active.selectSubType;game.ccfg.ClientActiveCfg.getDataById(e);switch(e){case game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT:this.discountDaily||(this.discountDaily=new game.DiscountDailyPanel,this.discountDaily.addToParent(this._skin.page)),this.discountDaily.show(),this._curPanel=this.discountDaily,this.discountDaily.y=30;break;case game.ActiveSubType.ST_RECHARGE_SALE_DAILY:this.saleDaily||(this.saleDaily=new game.SaleDailyPanel,this.saleDaily.addToParent(this._skin.page)),this.saleDaily.show(),this._curPanel=this.saleDaily;break;case game.ActiveSubType.ST_FESTIVAL_RECHARGE:case game.ActiveSubType.SINGLE_RECHARGE:case game.ActiveSubType.ST_SINGLE_RECHARGE_2:case game.ActiveSubType.ST_SINGLE_RECHARGE_3:case game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE:case game.ActiveSubType.ST_COST_TARGET_DIAMOND:case game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY:case game.ActiveSubType.ST_RECHARGE_ACCUMULATE_RECHARGE:case game.ActiveSubType.ST_RECHARGE_REBATE:this.recharge||(this.recharge=new game.ActiveRechargePanel,this.recharge.addToParent(this._skin.page)),this.recharge.show(),this._curPanel=this.recharge;break;case game.ActiveSubType.ST_ZHUANPAN_LOW_COST:this.lowCost||(this.lowCost=new game.LowCostPanel,this.lowCost.addToParent(this._skin.page)),this.lowCost.show(),this._curPanel=this.lowCost;break;case game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST:this.goldedPig||(this.goldedPig=new game.GoldedPigPage,this.goldedPig.addToParent(this._skin.page)),this.goldedPig.show(),this._curPanel=this.goldedPig;break;case game.ActiveSubType.ST_ZHUANPAN_UP_COST:this.upCost||(this.upCost=new game.UpCostPanel,this.upCost.addToParent(this._skin.page)),this.upCost.show(),this._curPanel=this.upCost;break;case game.ActiveSubType.ST_ZHUANPAN_RECHARGE:this.rouletteRecharge||(this.rouletteRecharge=new game.RouletteRechargePanel,this.rouletteRecharge.addToParent(this._skin.page)),this.rouletteRecharge.show(),this._curPanel=this.rouletteRecharge;break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG:this.activeEasterEggPage||(this.activeEasterEggPage=new game.ActiveEasterEggPage,this.activeEasterEggPage.addToParent(this._skin.page)),this.activeEasterEggPage.show(),this._curPanel=this.activeEasterEggPage;break;case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1:case game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2:case game.ActiveSubType.ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2:this.timeLimitRecharge||(this.timeLimitRecharge=new game.ActiveRechargeLimitedTimePanel,this.timeLimitRecharge.addToParent(this._skin.page)),this.timeLimitRecharge.show(),this._curPanel=this.timeLimitRecharge}},setTab:function(e){return!!this._skin&&("1"==e?(game.active.selectType(game.ActiveSubType.ST_RECHARGE_SALE_DAILY),this.selectTypeChange()):"0"==e?(game.active.selectType(game.ActiveSubType.ST_RECHARGE_DAILY_DISCOUNT),this.selectTypeChange()):"2"==e?(game.active.selectType(game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE),this.selectTypeChange()):"3"==e&&(game.active.selectType(game.ActiveSubType.ST_RECHARGE_REBATE),this.selectTypeChange()),!0)}})},{}],97:[function(e,t,i){"use strict";game.VipRebatePanel=game.SkinUI.extends({discount:null,_timer:null,_prizeInfo:null,itemInfo:null,costItemInfo:null,_sprite1:null,_sprite2:null,_prizeSprite:null,_width:0,activeId:0,_maxWidth:0,prizeItem:null,upgradeInfo:null,_prizeList:null,_lab:null,_lab2:null,_str:"",ctor:function(){this._super("active/VipRebateSkin","VipRebateSkin")},onShow:function(){this.initPanel(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.onC(this._skin.toggleBtn[0].node,this.onClickFirstItem,this),b8e.evt.onC(this._skin.toggleBtn[1].node,this.onClickSecondItem,this),b8e.evt.onC(this._skin.toggleBtn[2].node,this.onClickThirdItem,this),b8e.evt.onC(this._skin.toggleBtn[3].node,this.onClickFourthItem,this),b8e.evt.onC(this._skin.prize_node,this.onClickPrize,this),b8e.evt.onC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.addG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.refreshBuyCount),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshBuyCount),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.activeChange)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.toggleBtn[0].node,this.onClickFirstItem,this),b8e.evt.offC(this._skin.toggleBtn[1].node,this.onClickSecondItem,this),b8e.evt.offC(this._skin.toggleBtn[2].node,this.onClickThirdItem,this),b8e.evt.offC(this._skin.toggleBtn[3].node,this.onClickFourthItem,this),b8e.evt.offC(this._skin.prize_node,this.onClickPrize,this),b8e.evt.offC(this._skin.btn_get,this.onClickGetBtn,this),b8e.evt.rmvG(this,game.ActiveEvent.GET_PRIZE_CHANGE,this.refreshBuyCount),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshBuyCount),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.activeChange)},init:function(){this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount),this._prizeInfo=new game.PrizeInfo,this._sprite1=b8e.Sprite.get(),this._sprite1.addToParent(this._skin.icon1),this._sprite1.setScale(.5,.5),this._sprite2=b8e.Sprite.get(),this._sprite2.addToParent(this._skin.icon2),this._sprite2.setScale(.5,.5),this._prizeSprite=b8e.Sprite.get(),this._prizeSprite.addToParent(this._skin.prize_node),0<this._skin.toggleBtn[0].width?this._width=this._skin.toggleBtn[0].node.width:this._width=128,this._maxWidth=560,this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_95,game.IcoSizeEnum.SIZE_95,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize_node),this._prizeList.containerId=game.ContainerId.VIP_REBATE_CONTAINER_ID)},setLabel:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;e.setFontSize(t),e.setLineHeight(i),e.setColor(n),e.setFontFile(s),this._lab.setLocalZOrder(100)},activeChange:function(){this.initPanel(),this._timer.reset(),this._timer.start()},initPanel:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e),i=game.ccfg.ClientActiveCfg.getDataById(e);if(i&&""!=i.discount&&this.discount.loadTexture(game.ClientCfg.getImgUrl(i.discount,!0),null,null,{useManifest:!1}),t&&!(t.activeIds.length<=0)){0!=this.activeId&&-1!=t.activeIds.indexOf(this.activeId)||(this.activeId=t.activeIds[0]);var n=0;for(n=0;n<this._skin.toggleBtn.length;n++)this._skin.toggleBtn[n].node.active=!1;var s=t.activeIds.length<=4?t.activeIds.length:4;for(n=0;n<s;n++){var a=game.ccfg.ActivityCfg.getDataById(t.activeIds[n]);a&&(this._skin.toggleBtn[n].node.active=!0,this._skin.toggleLab[n].string=a.name,this._skin.toggleBtn[n].node.x=(this._maxWidth-this._width*s)/2+this._width*n,this.activeId==t.activeIds[n]&&this.selectIndexItem(n))}this.refreshBuyCount()}},refreshPanel:function(){var e=game.ccfg.ActivityCfg.getDataById(this.activeId);if(e&&!(!e.realCost||e.realCost.length<=0||e.showCost.length<=0)){this._skin.op_lab_desc.string=game.ccfg.LangCfg.getText(21004,[e.showCost[0].Num]),this._skin.cp_lab_desc.string=game.ccfg.LangCfg.getText(21003,[e.realCost[0].Num]),this.costItemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(e.showCost[0].Id),this.costItemInfo&&(this._sprite1.loadTexture(game.ClientCfg.getImgUrl(this.costItemInfo.iconName,!1),null,null,{useManifest:!1}),this._sprite2.loadTexture(game.ClientCfg.getImgUrl(this.costItemInfo.iconName,!1),null,null,{useManifest:!1})),this._skin.rebateNum.string=Math.round(e.realCost[0].Num/e.showCost[0].Num*10),this._skin.desc.string=e.activityDesc,this._prizeInfo.setupById(e.prize),this._prizeList.setData(this._prizeInfo);var t=this._prizeInfo.getPrizeList();if(!t||t.length<=0)this._skin.gift_node.active=!1;else{switch(this._skin.gift_node.active=1<t.length,this.prizeItem=t[0],this.prizeItem.type){case game.PrizeItemType.TYPE_ITEM:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(this.prizeItem.itemId,!0);break;case game.PrizeItemType.TYPE_SILVER:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.SILVER,!0);break;case game.PrizeItemType.TYPE_YUAN_BAO:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.YUAN_BAO,!0);break;case game.PrizeItemType.TYPE_POPULARITY:this.itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.POPULARITY,!0);break;case game.PrizeItemType.BIAN_SHEN_CARD:this.itemInfo=game.ccfg.BianshenCfg.getBianshenCfgById(this.prizeItem.itemId),this.itemInfo.type=game.GoodsType.BIAN_SHEN_CARD;break;default:b8e.warn("PrizeList PrizeItem type warn："+this.prizeItem.type+"---"+this.itemInfo.name+"("+this.itemInfo.id+")")}this.itemInfo?this.refreshBuyCount():b8e.log("配置表没有该物品的信息")}}},refreshBuyCount:function(){this.last=game.active.finishActiveMap.get(this.activeId),this.last||(this.last=0);var e=game.ccfg.ActivityCfg.getDataById(this.activeId);this.maxVrc=e.attendTimes,this._skin.buyCount.string=game.ccfg.LangCfg.getText(21005,[this.last,this.maxVrc]),this.last>=this.maxVrc?(this._skin.isGet.active=!0,this._skin.btn_get.active=!1,this._skin.label.string="已达到购买上限"):(this._skin.label.string="立即购买",this._skin.isGet.active=!1,this._skin.btn_get.active=!0)},onClickFirstItem:function(){this.selectIndexItem(0)},onClickSecondItem:function(){this.selectIndexItem(1)},onClickThirdItem:function(){this.selectIndexItem(2)},onClickFourthItem:function(){this.selectIndexItem(3)},selectIndexItem:function(e){var t=game.active.selectSubType,i=game.active.getSubTypeInfo(t);!i||i.activeIds.length<=e||i.activeIds[e]&&(this.activeId=i.activeIds[e],this._skin.toggleBtn[e].check(),this.refreshPanel())},onClickPrize:function(){this.itemInfo?game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this.itemInfo,containerId:game.ContainerId.VIP_REBATE_CONTAINER_ID}):b8e.log("vipRebate没有该物品的信息")},onClickGetBtn:function(){var e=this.activeId;if(e){var t=game.ccfg.ActivityCfg.getDataById(e);t&&(this.last>=this.maxVrc?game.notice.show(21006):(this.upgradeInfo||(this.upgradeInfo=new game.UpgradeInfo),this.upgradeInfo.clear(),this.upgradeInfo.setUpgradeInfo(t.realCost),game.upgrade.costCheck(this,this.upgradeInfo,this.callBack)))}},callBack:function(e){var t=this.activeId;if(t){var i=game.ccfg.ActivityCfg.getDataById(t);if(i&&this.prizeItem&&this.itemInfo&&this.costItemInfo&&e){var n="是否购买"+this.itemInfo.name+"*"+this.prizeItem.num+"<br/>消耗:"+i.realCost[0].Num+this.costItemInfo.name,s=new game.GameAlertInfo;s.alertType=game.GameAlertType.TwoBtn,s.string=n,s.obj={id:t},s.isShowTips=!0,game.gameAlert.showAlert(this,this.onCheck,s)}}},onCheck:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ActiveSender.getActivePrize(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},updateTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimes.string=game.timeUtil.formatTimeSpace(i):(this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束")}else this._timer&&this._timer.stop(),this._skin.endTimes.string="已结束"}})},{}],98:[function(e,t,i){"use strict";game.ActiveSender={},game.ActiveSender.getLoginPrize=function(e){var t=game.pbmsg.LoginPrizeRequest;t.days=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.LoginPrizeRequest;b8e.sendN(i)},game.ActiveSender.getActivePrize=function(e){var t=game.pbmsg.ActivityAwardRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.ActivityAwardRequest;b8e.sendN(i)},game.ActiveSender.ActivityModuleRequest=function(){var e=game.pbmid.Activity.ActivityModuleRequest;b8e.sendN(e)},game.ActiveSender.reqZhuanPan=function(e,t,i){var n=game.pbmsg.ZhuanPanRequest;n.count=e,n.activitySubType=t,i&&(n.position=i),engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Activity.ZhuanPanRequest;b8e.sendN(s)},game.ActiveSender.reqDuoBao=function(e){var t=game.pbmsg.DuoBaoRequest;t.activitySubType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.DuoBaoRequest;b8e.sendN(i)},game.ActiveSender.collectZhuanPanCountAward=function(e,t){var i=game.pbmsg.CollectZhuanPanCountAwardRequest;i.count=e,i.activitySubType=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Activity.CollectZhuanPanCountAwardRequest;b8e.sendN(n)},game.ActiveSender.reqZhuanPanRecord=function(e){var t=game.pbmsg.ZhuanPanRecordRequest;t.activitySubType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.ZhuanPanRecordRequest;b8e.sendN(i)},game.ActiveSender.getActiveCostRank=function(e){var t=game.pbmid.Activity.TimeLimitRankRequest,i=game.pbmsg.TimeLimitRankRequest;i.activitySubType=e,engine.NetSender.getBytes().writeProtobuf(i),b8e.sendN(t)},game.ActiveSender.getActiveCostMap=function(e){var t=game.pbmid.Activity.ActivityConditionRequest,i=game.pbmsg.ActivityConditionRequest;i.conditionType=e,engine.NetSender.getBytes().writeProtobuf(i),b8e.sendN(t)},game.ActiveSender.ActivityBossInfoRequest=function(e){var t=game.pbmsg.ActivityBossInfoRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.ActivityBossInfoRequest;b8e.sendN(i)},game.ActiveSender.buyActivityItemRequest=function(e,t){var i=game.pbmsg.BuyActivityItemRequest;i.id=e,i.itemId=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Activity.BuyActivityItemRequest;b8e.sendN(n)},game.ActiveSender.mysteryActivityListRequest=function(e){var t=game.pbmsg.MysteryActivityListRequest;t.activityId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.MysteryActivityListRequest;b8e.sendN(i)},game.ActiveSender.buyMysteryActivityRequest=function(e,t){var i=game.pbmsg.BuyMysteryActivityRequest;i.activityId=e,i.shopId=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Activity.BuyMysteryActivityRequest;b8e.sendN(n)},game.ActiveSender.refreshMysteryActivityRequest=function(e){var t=game.pbmsg.RefreshMysteryActivityRequest;t.activityId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.RefreshMysteryActivityRequest;b8e.sendN(i)},game.ActiveSender.mysteryActivityRecordRequest=function(e){var t=game.pbmsg.MysteryActivityRecordRequest;t.activityId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Activity.MysteryActivityRecordRequest;b8e.sendN(i)}},{}],99:[function(e,t,i){"use strict";game.RealVerifyEvent=b8e.Enum({REAL_VERIFY_COMPLETE:b8e.Event.nextCode()})},{}],100:[function(e,t,i){"use strict";game.appModule.RealVerifyPanel=game.SkinUIPanel.extends({_prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.onC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.addG(this,game.RealVerifyEvent.REAL_VERIFY_COMPLETE,this.onUpdatePanel)},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.offC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.rmvG(this,game.RealVerifyEvent.REAL_VERIFY_COMPLETE,this.onUpdatePanel)},onRefresh:function(){this.onUpdatePanel()},onUpdatePanel:function(){game.LoginConfig.realVerifyComplete?game.LoginConfig.realVerifyComplete&&game.welfare.isGetVerifyPrize?(this._skin.btn.active=!1,this._skin.prizeBtn.active=!1,this._skin.isGetPrize.active=!0):(this._skin.btn.active=!1,this._skin.prizeBtn.active=!0,this._skin.isGetPrize.active=!1):(this._skin.btn.active=!0,this._skin.prizeBtn.active=!1,this._skin.isGetPrize.active=!1)},initPanel:function(){if(!this._prizeList){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this._prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.REAL_VERIFY_PRIZE);e.setupById(t),this._prizeList.setData(e)}},clickBtn:function(){game.LoginConfig.realVerifyComplete?(game.WelfareSender.sendRealVerifyPrizeRequest(),this.hide()):game.HuoShuSDK.realVerify()}})},{}],101:[function(e,t,i){"use strict";e("./RealVerifyPanel"),e("./RealVerifyEvent")},{"./RealVerifyEvent":99,"./RealVerifyPanel":100}],102:[function(e,t,i){"use strict";e("./roleLogin/roleLoginIndex_2"),e("./reconnect/ReconnectLoading"),e("./grids/gridsIndex_0"),e("./arena/arenaIndex"),e("./back/backIndex_0"),e("./boss/bossIndex_0"),e("./chat/chatIndex_0"),e("./dungeon/dungeonIndex_0"),e("./equip/equipIndex_0"),e("./gm/gmIndex_0"),e("./leaveDungeon/leaveDungeonIndex_0"),e("./loneyDungeon/loneyDungeonIndex_0"),e("./mail/mailIndex_0"),e("./mainGui/mainGuiIndex_0"),e("./map/mapIndex_0"),e("./pk/pkIndex_0"),e("./prizeList/prizeListIndex_0"),e("./relive/reliveIndex_0"),e("./role/roleIndex_0"),e("./sceneDes/sceneDesIndex_0"),e("./skill/skillIndex_0"),e("./task/taskIndex_0"),e("./tips/tipsIndex_0"),e("./wing/wingIndex_0"),e("./bianshen/bianshenIndex_0"),e("./accessory/accessoryIndex"),e("./bianshen/bianshenIndex_0"),e("./resetDaily/resetDailyIndex"),e("./funcs/funcsIndex"),e("./dialog/dialogIndex"),e("./guide/guideIndex"),e("./notice/NoticeSkinIndex"),e("./rank/rankIndex_0"),e("./welfare/welfareIndex_1"),e("./offlineAward/offlineAwardIndex_0"),e("./shop/shopIndex"),e("./guild/guilIndex"),e("./othersrole/OthersRoleIndex_0"),e("./relation/relationAppIndex"),e("./pay/payIndex_0"),e("./misc/miscIndex"),e("./vip/vipIndex_0"),e("./active/activeIndex"),e("./clientSetting/clientSettingIndex"),e("./cardRecharge/cardRechargeIndex_0"),e("./firstRecharge/firstRechargeIndex_0"),e("./sura/suraIndex"),e("./activeBar/activeBarIndex"),e("./surface/surfaceIndex"),e("./micro/microIndex"),e("./share/shareIndex"),e("./transferNotice/transferNoticeIndex"),e("./nationalBoss/nationalBossIndex_0"),e("./xiandan/xiandanIndex_0"),e("./achievement/achievementIndex"),e("./fund/fundIndex_0"),e("./nickname/nickNameIndex"),e("./wanba/wanbaIndex"),e("./aiweiyou/aiweiyouIndex"),e("./rebirth/rebirthIndex"),e("./redPacket/redPacketIndex"),e("./dujie/dujieIndex"),e("./zhanyao/zhanyaoIndex"),e("./tiangong/tiangongIndex"),e("./Amulet/AmuletIndex_0"),e("./AnnouncementPanel"),e("./crossServerArena/CSArenaIndex"),e("./rune/runeIndex_1"),e("./jingdong/jingdongIndex"),e("./weixin/winxinIndex_1")},{"./Amulet/AmuletIndex_0":5,"./AnnouncementPanel":11,"./accessory/accessoryIndex":12,"./achievement/achievementIndex":29,"./active/activeIndex":51,"./activeBar/activeBarIndex":41,"./aiweiyou/aiweiyouIndex":101,"./arena/arenaIndex":103,"./back/backIndex_0":125,"./bianshen/bianshenIndex_0":157,"./boss/bossIndex_0":194,"./cardRecharge/cardRechargeIndex_0":202,"./chat/chatIndex_0":213,"./clientSetting/clientSettingIndex":223,"./crossServerArena/CSArenaIndex":244,"./dialog/dialogIndex":267,"./dujie/dujieIndex":290,"./dungeon/dungeonIndex_0":300,"./equip/equipIndex_0":311,"./firstRecharge/firstRechargeIndex_0":354,"./funcs/funcsIndex":358,"./fund/fundIndex_0":365,"./gm/gmIndex_0":376,"./grids/gridsIndex_0":391,"./guide/guideIndex":401,"./guild/guilIndex":416,"./jingdong/jingdongIndex":456,"./leaveDungeon/leaveDungeonIndex_0":457,"./loneyDungeon/loneyDungeonIndex_0":467,"./mail/mailIndex_0":480,"./mainGui/mainGuiIndex_0":489,"./map/mapIndex_0":516,"./micro/microIndex":528,"./misc/miscIndex":531,"./nationalBoss/nationalBossIndex_0":551,"./nickname/nickNameIndex":568,"./notice/NoticeSkinIndex":575,"./offlineAward/offlineAwardIndex_0":578,"./othersrole/OthersRoleIndex_0":590,"./pay/payIndex_0":611,"./pk/pkIndex_0":622,"./prizeList/prizeListIndex_0":628,"./rank/rankIndex_0":641,"./rebirth/rebirthIndex":649,"./reconnect/ReconnectLoading":655,"./redPacket/redPacketIndex":662,"./relation/relationAppIndex":679,"./relive/reliveIndex_0":687,"./resetDaily/resetDailyIndex":692,"./role/roleIndex_0":704,"./roleLogin/roleLoginIndex_2":699,"./rune/runeIndex_1":742,"./sceneDes/sceneDesIndex_0":753,"./share/shareIndex":762,"./shop/shopIndex":778,"./skill/skillIndex_0":784,"./sura/suraIndex":835,"./surface/surfaceIndex":843,"./task/taskIndex_0":853,"./tiangong/tiangongIndex":892,"./tips/tipsIndex_0":897,"./transferNotice/transferNoticeIndex":918,"./vip/vipIndex_0":931,"./wanba/wanbaIndex":939,"./weixin/winxinIndex_1":957,"./welfare/welfareIndex_1":996,"./wing/wingIndex_0":999,"./xiandan/xiandanIndex_0":1045,"./zhanyao/zhanyaoIndex":1057}],103:[function(e,t,i){"use strict";e("./cmd/ArenaCmd"),e("./event/ArenaEvent"),e("./manager/ArenaMgr"),e("./panel/arenaPanleIndex_0"),e("./sender/ArenaSender")},{"./cmd/ArenaCmd":104,"./event/ArenaEvent":105,"./manager/ArenaMgr":106,"./panel/arenaPanleIndex_0":123,"./sender/ArenaSender":124}],104:[function(e,t,i){"use strict";game.ArenaCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Arena.ArenaInfoResponse,this.onArenaInfoResponse,this),b8e.addNH(game.pbmid.Arena.ArenaLogResponse,this.onArenaLogResponse,this),b8e.addNH(game.pbmid.Arena.ArenaChallengeResponse,this.onArenaChallengeResponse,this),b8e.addNH(game.pbmid.Arena.BuyArenaChallengeNumResponse,this.onBuyArenaChallengeNumResponse,this),b8e.addNH(game.pbmid.Arena.ArenaPlayerNotify,this.onArenaPlayerNotify,this),b8e.addNH(game.pbmid.Arena.ArenaBianshenStateNotify,this.onArenaBianshenStateNotify,this),b8e.addNH(game.pbmid.Arena.ArenaBattleFinishNotify,this.onArenaBattleFinishNotify,this),b8e.addNH(game.pbmid.Arena.ArenaQuickChallengeResponse,this.onArenaQuickChallengeResponse,this),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.onChangeSceneComplete)},onChangeSceneComplete:function(){game.arena.showArenaPlayerPanel()},onArenaPlayerNotify:function(e){var t=e.readProtobuf(game.pbmsg.ArenaPlayerNotify);t?game.arena.setupArenaPlayer(t):b8e.log("请求对战玩家信息数据失败")},onArenaBattleFinishNotify:function(e){var t=e.readProtobuf(game.pbmsg.ArenaBattleFinishNotify);t?game.arena.showResult(t):b8e.log("请求战斗完成通知失败")},onArenaBianshenStateNotify:function(e){var t=e.readProtobuf(game.pbmsg.ArenaBianshenStateNotify);t?game.arena.arenaShapeStateChange(t):b8e.log("请求变身改变数据失败")},onBuyArenaChallengeNumResponse:function(e){var t=e.readProtobuf(game.pbmsg.BuyArenaChallengeNumResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.arena.buyTimesSuccess()}else b8e.log("购买挑战次数失败")},onArenaChallengeResponse:function(e){var t=e.readProtobuf(game.pbmsg.ArenaChallengeResponse),i=t.code;if(0<i)return game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)),b8e.log(i),void(803==i&&game.ArenaSender.getArenaInfo());t&&0===t.code&&game.arena.challengeResponse()},onArenaLogResponse:function(e){var t=e.readProtobuf(game.pbmsg.ArenaLogResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):t?game.arena.setupLog(t):b8e.log("请求请求挑战日志数据失败")},onArenaInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.ArenaInfoResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):t?game.arena.setupInfo(t):b8e.log("请求竞技场初始数据失败")},onArenaQuickChallengeResponse:function(e){var t=e.readProtobuf(game.pbmsg.ArenaQuickChallengeResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.arena.quickCompleteRep(t.num)}})},{}],105:[function(e,t,i){"use strict";game.ArenaEvent=b8e.Enum({INIT_LOG:b8e.Event.nextCode(),ADD_LOG:b8e.Event.nextCode(),INIT_ARENA_INFO:b8e.Event.nextCode(),ARENA_TIMES_CHANGE:b8e.Event.nextCode(),SELF_RANK_CHANGE:b8e.Event.nextCode(),ARENA_SHAPE_STATE_CHANGE:b8e.Event.nextCode(),ATK_STATE_CHANGE:b8e.Event.nextCode(),TAR_STATE_CHANGE:b8e.Event.nextCode(),ARENA_PLAYER_DATA_INIT:b8e.Event.nextCode(),ARENA_RANK:b8e.Event.nextCode(),ARENA_RESULT_DATA:b8e.Event.nextCode(),STOP_TIMER:b8e.Event.nextCode(),UPDATA_BUYTIMES:b8e.Event.nextCode(),UPDATE_SURAPANEL:b8e.Event.nextCode()})},{}],106:[function(e,t,i){"use strict";game.ArenaMgr=b8e.Object.extends({arenaInfo:null,arenaRank:null,arenaLog:null,curLog:null,arenaLeftPlayerInfo:null,arenaRightPlayerInfo:null,isCSArena:!1,arenaFinishInfo:null,uprank:0,isAutoFight:!1,_gameAlertInfo:null,ctor:function(){this._super(),this.arenaLog=new game.ArenaLogs,this.arenaRank=new game.ArenaRank,this.arenaInfo=new game.ArenaInfo,this.arenaLeftPlayerInfo=new game.ArenaPlayerInfo,this.arenaRightPlayerInfo=new game.ArenaPlayerInfo,this.arenaFinishInfo=new game.ArenaFinishInfo},reqArenaInfo:function(){game.funcOpen.checkOpen(game.FunctionType.FENG_SHEN_BANG)&&game.ArenaSender.getArenaInfo()},setupInfo:function(e){e&&0==e.code&&(this.arenaInfo.setup(e),b8e.evt.dptG(game.ArenaEvent.INIT_ARENA_INFO),b8e.evt.dptG(game.ArenaEvent.ARENA_TIMES_CHANGE),b8e.evt.dptG(game.ArenaEvent.SELF_RANK_CHANGE),b8e.evt.dptG(game.DujieEvent.ARENA_RANK))},getSelfRank:function(){return this.arenaInfo&&0!=this.arenaInfo.rank?this.arenaInfo.rank:(game.funcOpen.checkOpen(game.FunctionType.FENG_SHEN_BANG)&&game.funcOpen.checkOpen(game.FunctionType.JING_JIE)&&game.ArenaSender.getArenaInfo(),0)},setSelfRank:function(e){if(!this.arenaInfo)return 0;this.arenaInfo.rank=e},getTimes:function(){return this.arenaInfo.times+this.arenaInfo.buyTimes},reqRank:function(){game.rank.reqRanInfoByType(game.RankType.RANK_ARENA)},initLog:function(){game.ArenaSender.initLog()},setupLog:function(e){e&&0==e.code&&(this.arenaLog.setup(e),b8e.evt.dptG(game.ArenaEvent.INIT_LOG))},getPrizeInfo:function(){},seeLog:function(e){this.curLog=e,game.app.show(game.AppConstant.ARENA_COMBATDATA_PANEL,e)},showResult:function(e){1==e.type?this.showWinResult(e):this.showNormalResult(e)},showWinResult:function(e){game.app.hide(game.AppConstant.FIGHT_PANEL),this.arenaFinishInfo.setup(e),b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this.waitTimeBack)},showNormalResult:function(e){game.TrusteeshipMgr.inst().stop(),this.arenaFinishInfo.setup(e),this.uprank=this.getSelfRank()-e.rank,this.setSelfRank(e.rank),b8e.evt.dptG(game.DujieEvent.ARENA_RANK),b8e.evt.dptG(game.ArenaEvent.STOP_TIMER),b8e.Tween.kill(this),b8e.Tween.get(this).wait(3e3).call(this.waitTimeBack),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},showRecordHighPanel:function(){game.app.show(game.AppConstant.ARENA_RECORDHIGH_PANEL)},waitTimeBack:function(){game.app.show(game.AppConstant.ARENA_RESULT_PANEL),0<this.arenaFinishInfo.diamond&&this.showRecordHighPanel()},onExitArena:function(){game.app.hide(game.AppConstant.ARENA_RESULT_PANEL);game.SceneMgr.inst().sceneId;var e=game.SceneMgr.inst().getSceneConfig();e&&(e.type==game.SceneType.ARENA&&game.SceneSender.leaveAloneDungeon(),game.app.hide(game.AppConstant.ARENA_FIGHT_PANEL),this.isAutoFight?game.TrusteeshipMgr.inst().start():game.TrusteeshipMgr.inst().stop())},buyTimes:function(){if(game.vip.getBuyArenaTimesByLv()-this.arenaInfo.buyTimes<=0)game.gameAlert.showVipAlert(!1,100);else{var e=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.BUY_ARENA_COUNT,this.arenaInfo.buyTimes);e&&game.upgrade.costCheck(this,e.upgradeInfo,this.onIsPass,!0)}},onIsPass:function(e){e&&game.ArenaSender.buyTimes()},buyTimesSuccess:function(){this.arenaInfo.buyTimes++,this.arenaInfo.times++,game.notice.show("挑战次数+1"),b8e.evt.dptG(game.ArenaEvent.ARENA_TIMES_CHANGE),b8e.evt.dptG(game.ArenaEvent.UPDATA_BUYTIMES)},challengeRequest:function(e,t){var i=game.bianshen.getBattleSlots(),n=!0;if(i&&0<i.length)for(var s=0;s<i.length;++s)0<i[s].bianshenId&&(n=!1);n?game.notice.show("请上阵变身后再发起挑战"):0!=this.arenaInfo.times?game.ArenaSender.challengeRequest(e,t):game.notice.show("挑战次数不足")},challengeResponse:function(){b8e.log("挑战成功"),this.arenaInfo.times--,b8e.evt.dptG(game.ArenaEvent.ARENA_TIMES_CHANGE)},showArenaPlayerPanel:function(){var e=game.SceneMgr.inst().getSceneConfig();e&&(e.type==game.SceneType.ARENA?(game.app.hide(game.AppConstant.FIGHT_PANEL),this.isAutoFight=game.TrusteeshipMgr.inst().autoFight,game.TrusteeshipMgr.inst().stop(),b8e.Tween.kill(this),b8e.Tween.get(this).wait(2e3).call(this.waitReady)):game.app.isShow(game.AppConstant.ARENA_FIGHT_PANEL)&&game.app.hide(game.AppConstant.ARENA_FIGHT_PANEL))},waitReady:function(){game.app.showAppNoHide(game.AppConstant.ARENA_FIGHT_PANEL),game.ArenaSender.readyRequest(),game.SceneMgr.inst().clickMap(1829,720);var e=game.mainRole.mainRoleData;game.SceneRole.get(e.type,e.id).setDirection({x:1,y:0}),b8e.Tween.kill(this),b8e.Tween.get(this).wait(3e3).call(this.readyCallBack)},readyCallBack:function(){game.ArenaSender.readyRequest()},setupArenaPlayer:function(e){this.arenaLeftPlayerInfo.setup(e.player1),this.arenaRightPlayerInfo.setup(e.player2),this.isCSArena=e.crossServer},arenaShapeStateChange:function(e){this.arenaLeftPlayerInfo.id==e.id?(this.arenaLeftPlayerInfo.changeShapeState(e),b8e.evt.dptG(game.ArenaEvent.TAR_STATE_CHANGE,e.bianshenId)):(this.arenaRightPlayerInfo.changeShapeState(e),b8e.evt.dptG(game.ArenaEvent.ATK_STATE_CHANGE,e.bianshenId))},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ARENA_ALERT,game.SpotAlertChildrens.ARENA_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ARENA_FIGHT_ALERT,null,this.fightAlert,this)},fightAlert:function(){return 0<this.arenaInfo.times},alertAllClear:function(){if(0<this.arenaInfo.times){var e=this._gameAlertInfo?this._gameAlertInfo:new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoBtn,e.isShowTips=!1,e.string=game.ccfg.LangCfg.getText(85011),e.confirmString=game.ccfg.LangCfg.getText(85002),e.cancelString=game.ccfg.LangCfg.getText(85003),game.gameAlert.showAlert(this,this.quickClick,e)}else game.app.show(game.AppConstant.ARENA_BUY_TIMES_PANEL)},quickClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:b8e.log("挑战所有"),game.ArenaSender.allclearRequest(!0);break;case game.GameAlertBtnType.CANCEL:b8e.log("挑战一次"),game.ArenaSender.allclearRequest(!1);break;case game.GameAlertBtnType.CLOSE:}},quickCompleteRep:function(e){this.arenaInfo.times=0<e?e:0,b8e.evt.dptG(game.ArenaEvent.ARENA_TIMES_CHANGE)}}),game.ArenaMgr._instance=null,game.ArenaMgr.inst=function(){return game.ArenaMgr._instance||(game.ArenaMgr._instance=new game.ArenaMgr),game.ArenaMgr._instance}},{}],107:[function(e,t,i){"use strict";game.appModule.ArenaBuyTimesPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.buyBtn,this.onBuyBtnClick,this),b8e.evt.addG(this,game.ArenaEvent.UPDATA_BUYTIMES,this.updata),this.updatePanel()},onHide:function(){b8e.evt.offC(this._skin.buyBtn,this.onBuyBtnClick,this),b8e.evt.rmvG(this,game.ArenaEvent.UPDATA_BUYTIMES,this.updata)},updatePanel:function(){var e=game.vip.getBuyArenaTimesByLv()-game.arena.arenaInfo.buyTimes;e<=0&&(e=0);var t=game.ccfg.CostCfg.getNextCost(game.SystemId.BUY_ARENA_COUNT,game.arena.arenaInfo.buyTimes);if(t){this._skin.cost.string=t,this._skin.costNumb.string=e;var i=game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO);this._skin.costNumb.node.color=0==e?b8e.ColorUtil.toCCColor(4294901760):b8e.ColorUtil.toCCColor(4291154901),this._skin.cost.node.color=i<t?b8e.ColorUtil.toCCColor(4294901760):b8e.ColorUtil.toCCColor(4285847056)}else b8e.log("没有配置竞技场次数消耗表，或次数超出配置范围 兄弟")},updata:function(){this.updatePanel()},onBuyBtnClick:function(){game.arena.buyTimes()}})},{}],108:[function(e,t,i){"use strict";game.appModule.ArenaCombatDataPanel=game.SkinUIPanel.extends({_m_data:null,m_DamageList:null,itemList:null,itemPool:null,ctor:function(e){this._super(e),this.m_DamageList=[],this.itemList=[],this.itemPool=[]},onShow:function(){this._m_data=this.data,this._m_data&&(this.setComBatData(this._m_data),b8e.evt.onC(this._skin.atk_UserIcon2,this.onAtkIconClickBack,this),b8e.evt.onC(this._skin.tar_UserIcon2,this.onTarIconClickBack,this))},onHide:function(){b8e.evt.offC(this._skin.atk_UserIcon2,this.onAtkIconClickBack,this),b8e.evt.offC(this._skin.tar_UserIcon2,this.onTarIconClickBack,this)},onAtkIconClickBack:function(e){if(this._m_data){var t=this._m_data.Attacker;this.onShowMenu(e,t)}},onTarIconClickBack:function(e){this._m_data&&this.onShowMenu(e,this._m_data.Target)},onShowMenu:function(e,t){var i=t.id;if(String(i).length<12)game.notice.show(82e3);else if(game.mainRole.mainRoleData.playerId!=i){var n=new game.MenuData;n.roleId=i,n.roleName=t.name,n.head=t.head,game.relation.isFriend(i)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,n):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,n)}},setComBatData:function(e){if(e&&this._skin){var t=e.Attacker,i=e.Target;if(e.State==game.ArenaLogType.Victory||e.State==game.ArenaLogType.DefSucceed?(this._skin.icon_Victory.active=!0,this._skin.icon_Lose.active=!1):(this._skin.icon_Lose.active=!0,this._skin.icon_Victory.active=!1),this.m_DamageList=e.LogStats,t&&i){for(var n=[],s=[],a=[],o=[],r=0;r<this.m_DamageList.length;++r)this.m_DamageList[r].isAttacker?(n.push(this.m_DamageList[r].id),a.push(this.m_DamageList[r])):(s.push(this.m_DamageList[r].id),o.push(this.m_DamageList[r]));this.onCreateSpriteByPlayerID(t.head).addToParent(this._skin.tar_UserIcon1),this.onCreateSpriteByPlayerID(i.head).addToParent(this._skin.atk_UserIcon1),this._skin.atk_UserName1.string=i.name,this._skin.atk_Userlevel1.string=i.lv,this._skin.tar_UserName1.string=t.name,this._skin.tar_Userlevel1.string=t.lv,this._skin.targeter_Atk.string=i.power,this._skin.attacker_Atk.string=t.power;var h=[],g=[];for(r=0;r<3;++r){if(r<s.length){var l=this.getPlayerDamage(s[r],!1);h.push(l)}if(n.length){var c=this.getPlayerDamage(n[r],!0);g.push(c)}}var u,m=this.getMaxPlayerDamage(h),_=this.getMaxPlayerDamage(g);u=_<m?m:_;for(r=0;r<a.length;++r){(d=this.getCombatItem()).setData(a[r],u),d.addToParent(this._skin["atk_BianshenItem_"+r]),d.show()}for(r=0;r<o.length;++r){var d;(d=this.getCombatItem()).setData(o[r],u),d.addToParent(this._skin["tar_BianshenItem_"+r]),d.show()}}}},getCombatItem:function(){return 0<this.itemPool.length?this.itemPool.shift():new game.CombatDataItem},clearItem:function(){for(;0<this.itemList.length;){var e=this.itemList.shift();e.hide(),e.removeFromParent(),this.itemPool.push(e)}this._skin.atk_UserName1.string="",this._skin.atk_Userlevel1.string="",this._skin.tar_UserName1.string="",this._skin.tar_Userlevel1.string=""},getPlayerDamage:function(e,t){if(!this.m_DamageList)return 0;for(var i=0;i<this.m_DamageList.length;++i)if(e==this.m_DamageList[i].id&&t==this.m_DamageList[i].isAttacker)return Math.abs(this.m_DamageList[i].damage)},getMaxPlayerDamage:function(e){if(e){for(var t=0,i=0;i<e.length;++i)t<e[i]&&(t=e[i]);return t}},onCreateSpriteByPlayerID:function(e){var t=b8e.Sprite.get();if(t.setAnchor(0,0),t.setScale(1.5),""!=e&&0!=e){var i=game.ClientCfg.getHeadIconUrlByHeadId(e);t.loadTexture(i,null,null,{useManifest:!1})}else t.unloadTexture();return t}})},{}],109:[function(e,t,i){"use strict";game.appModule.ArenaFightPanel=game.SkinUIPanel.extends({W_MAX_HP:220,timer_numb:60,_tarBianshenIcon:null,_atkBianshenIcon:null,_ShapeList:null,_ShapePool:null,_oldy:-1,_countDownTimer:null,_readyCountTimer:null,ctor:function(e){this._super(e),this._tarBianshenIcon,this._atkBianshenIcon,this._ShapeList=[],this._ShapePool=[]},onShow:function(){-1==this._oldy&&(this._oldy=this._skin.readytime.node.y),b8e.evt.addG(this,game.ArenaEvent.ARENA_PLAYER_DATA_INIT,this.updatePlayerData),b8e.evt.addG(this,game.ArenaEvent.ARENA_SHAPE_STATE_CHANGE,this.setBianshenState),b8e.evt.addG(this,game.ArenaEvent.STOP_TIMER,this.stopTimer),b8e.evt.addG(this,game.ArenaEvent.ATK_STATE_CHANGE,this.setAtkStat),b8e.evt.addG(this,game.ArenaEvent.TAR_STATE_CHANGE,this.setTarStat),b8e.evt.addG(this,game.AttributesEvents.ATTR_UPDATA,this.updateHp),this.updatePlayerData(),this.setLocalZOrder(-1)},onHide:function(){b8e.evt.rmvG(this,game.ArenaEvent.ARENA_PLAYER_DATA_INIT,this.updatePlayerData),b8e.evt.rmvG(this,game.ArenaEvent.ARENA_SHAPE_STATE_CHANGE,this.setBianshenState),b8e.evt.rmvG(this,game.ArenaEvent.STOP_TIMER,this.stopTimer),b8e.evt.rmvG(this,game.ArenaEvent.ATK_STATE_CHANGE,this.setAtkStat),b8e.evt.rmvG(this,game.ArenaEvent.TAR_STATE_CHANGE,this.setTarStat),b8e.evt.rmvG(this,game.AttributesEvents.ATTR_UPDATA,this.updateHp),this._countDownTimer&&this._countDownTimer.stop(),this._readyCountTimer&&this._readyCountTimer.stop(),this.clearItems()},stopTimer:function(){this._countDownTimer&&this._countDownTimer.stop(),this._readyCountTimer&&this._readyCountTimer.stop()},updatePlayerData:function(){if(this._skin){this.clearItems();var e,t=game.arena.arenaLeftPlayerInfo,i=game.arena.arenaRightPlayerInfo;this._skin.leftName.string=t.name,this._skin.leftLv.string=t.lv,this._skin.rightName.string=i.name,this._skin.rightLv.string=i.lv,this.onCreateSpriteByPlayerID(i.head).addToParent(this._skin.rightHead),this.onCreateSpriteByPlayerID(t.head).addToParent(this._skin.leftHead),this.setBianshenState();var n=[];for(e=a=0;e<3;e++){var s,a=e+1;if(e<(n=t.getIdList()).length)(s=this.getShapeItem()).addToParent(this._skin["leftShape_"+a]),s.setScale(.5),s.setData(t.getBianshenById(n[e]),!1),s.show(),this._ShapeList.push(s),this._skin["leftShape_"+a].active=!0;else this._skin["leftShape_"+a].active=!1;if(e<(n=i.getIdList()).length)(s=this.getShapeItem()).addToParent(this._skin["rightShape_"+a]),s.setData(i.getBianshenById(n[e]),!0),s.setScale(.5),s.show(),this._ShapeList.push(s),this._skin["rightShape_"+a].active=!0;else this._skin["rightShape_"+a].active=!1}this.UpdateinitInfo()}},getShapeItem:function(){return 0<this._ShapePool.length?this._ShapePool.shift():new game.ArenaShapeItem},clearItems:function(){if(this._ShapeList){for(;0<this._ShapeList.length;){var e=this._ShapeList.shift();e.hide(),e.removeFromParent(),this._ShapePool.push(e)}this._ShapeList=[],this._skin.leftName.string="",this._skin.leftLv.string="",this._skin.rightName.string="",this._skin.rightLv.string="",this._skin.rightHp.width=this.W_MAX_HP,this._skin.leftHp.width=this.W_MAX_HP}},UpdateinitInfo:function(){this.timer_numb=3,this._skin.readytime.node.active=!0,this._skin.readytime.string=this.timer_numb,this._skin.time.node.active=!1,this._skin.time.string="",this.critAnimation(),this._readyCountTimer||(this._readyCountTimer=b8e.Timer.add(this,this.readycountDown,1e3,0,2)),this._readyCountTimer.reset(),this._readyCountTimer.start()},critAnimation:function(){this._skin.readytime.node.y=this._oldy;var e=this._skin.readytime.node;this._skin.readytime.node.opacity=255,b8e.Tween.kill(e),e.scaleX=1.7,e.scaleY=1.7,b8e.Tween.get(e).to({scaleX:1,scaleY:1},100).call(this.scaleAnim,this,[e])},scaleAnim:function(e){b8e.Tween.kill(e);var t=e.x,i=e.y;b8e.Tween.get(e).to({x:t,y:i},500,b8e.Ease.getElasticInOut).call(this.riseAnim,this,[e,i])},riseAnim:function(e,t){b8e.Tween.kill(e),b8e.Tween.get(e).to({y:t+20,opacity:0},500).call(this.restoreAnim,this,[e])},restoreAnim:function(e){b8e.Tween.kill(e),this._skin.readytime.node.opacity=0,this._skin.readytime.node.y=this._oldy},updateHp:function(){if(this._skin){var e,t,i,n=game.sceneRole.getDisplayById(game.arena.arenaLeftPlayerInfo.id);if(n&&n.data)e=(i=n.data.spriteStat).getStatDataByType(game.SpriteStatType.HP),t=i.getStatDataByType(game.SpriteStatType.MAXHP),this._skin.leftHp.width=~~(e.value/t.value*this.W_MAX_HP);if((n=game.sceneRole.getDisplayById(game.arena.arenaRightPlayerInfo.id))&&n.data)e=(i=n.data.spriteStat).getStatDataByType(game.SpriteStatType.HP),t=i.getStatDataByType(game.SpriteStatType.MAXHP),this._skin.rightHp.width=~~(e.value/t.value*this.W_MAX_HP)}},countDown:function(){this._skin&&(this.timer_numb=this.timer_numb-1,this._skin.time.string=this.timer_numb,0==this.timer_numb&&(this._countDownTimer&&this._countDownTimer.stop(),this._skin.time.node.active=!1,this._skin.time.string=""))},readycountDown:function(){if(this._skin&&(this.critAnimation(),this.timer_numb=this.timer_numb-1,this._skin.readytime.string=this.timer_numb,0==this.timer_numb)){this._readyCountTimer&&this._readyCountTimer.stop(),this._skin.readytime.node.active=!1;var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ARENA_COUNTDOWN);this.timer_numb=e,this._skin.time.node.active=!0,this._countDownTimer||(this._countDownTimer=b8e.Timer.add(this,this.countDown,1e3,0,10)),this._countDownTimer.reset(),this._countDownTimer.start()}},setBianshenState:function(){},setAtkStat:function(e){if(e){var t=e.data;this.onSetSpriteByBianshenID(t,!0)}},setTarStat:function(e){if(e){var t=e.data;this.onSetSpriteByBianshenID(t,!1)}},onSetSpriteByBianshenID:function(e,t){for(var i=(t?game.arena.arenaRightPlayerInfo:game.arena.arenaLeftPlayerInfo).getStateById(e),n=0;n<this._ShapeList.length;n++)this._ShapeList[n].checkout(e,t,i)},onCreateSpriteByPlayerID:function(e){var t=b8e.Sprite.get();if(t.setAnchor(0,1),t.setScale(1.6),""!=e&&0!=e){var i=game.ClientCfg.getHeadIconUrlByHeadId(e);t.loadTexture(i,null,null,{useManifest:!1})}else t.unloadTexture();return t}})},{}],110:[function(e,t,i){"use strict";game.ArenaLogItem=game.SkinUI.extends({_data:null,ctor:function(){this._super("arena/ArenaLogItemSkin","ArenaLogItemSkin")},onShow:function(){b8e.evt.onC(this._skin.node,this.onClickNode,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.node,this.onClickNode,this)},onClickNode:function(){if(this._data){var e=this._data.ArenaStats;0==e.LogStats.length?game.notice.show("对方没有上阵变身，你不战而胜"):game.arena.seeLog(e)}},getHeight:function(){return 75},getWidth:function(){return 540},setData:function(e){if(this._data=e,this._skin){this._skin.icon_jin_gong.active=!1,this._skin.icon_fang_shou.active=!1;var t=b8e.TimeUtil.formatTimestamp(e.time,"M-D h:m");switch(e.type){case game.ArenaLogType.Victory:if(this._skin.icon_jin_gong.active=!0,e.logType==game.ArenaLogInfo.Type.ARENA)this._skin.content.string="<color=#C5D3D5>你挑战 </c><color=#E7D7A7><u>"+e.name+"</u></c><color=#74D610> 你获胜了! </c><color=#C5D3D5>升至"+e.rank+"名.</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>";else if(e.logType==game.ArenaLogInfo.Type.CS_ARENA){var i=game.ccfg.CSArenaLevelCfg.getLevelByStart(e.rank),n=game.ccfg.CSArenaLevelCfg.getLevelName(i),s=game.ccfg.CSArenaLevelCfg.getStar(e.rank);this._skin.content.string="<color=#C5D3D5>你挑战 </c><color=#E7D7A7><u>"+e.name+"</u></c><color=#74D610> 你获胜了! </c><color=#C5D3D5>升至"+n+"阶"+s+"星.</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>"}break;case game.ArenaLogType.Defeat:if(this._skin.icon_jin_gong.active=!0,e.logType==game.ArenaLogInfo.Type.ARENA)this._skin.content.string="<color=#C5D3D5>你挑战 </c><color=#E7D7A7><u>"+e.name+"</u></c><color=#DD3333> 你战败了! </c><color=#C5D3D5>排名不变</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>";else if(e.logType==game.ArenaLogInfo.Type.CS_ARENA){i=game.ccfg.CSArenaLevelCfg.getLevelByStart(e.rank),n=game.ccfg.CSArenaLevelCfg.getLevelName(i),s=game.ccfg.CSArenaLevelCfg.getStar(e.rank);this._skin.content.string="<color=#C5D3D5>你挑战 </c><color=#E7D7A7><u>"+e.name+"</u></c><color=#DD3333> 你战败了! </c><color=#C5D3D5>降低至"+n+" "+s+"星</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>"}break;case game.ArenaLogType.DefSucceed:this._skin.icon_fang_shou.active=!0,this._skin.content.string="<color=#E7D7A7><u>"+e.name+"</u></c><color=#C5D3D5>挑战你 </c><color=#74D610> 你获胜了! </c><color=#C5D3D5>排名不变</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>";break;case game.ArenaLogType.DefFailed:this._skin.icon_fang_shou.active=!0,this._skin.content.string="<color=#E7D7A7><u>"+e.name+"</u></c><color=#C5D3D5>挑战你 </c><color=#DD3333> 你战败了! </c><color=#C5D3D5>降至"+e.rank+"名.</c><color=#D8D00B>[查看详情]</c><color=#C5D3D5>("+t+")</color>"}}}})},{}],111:[function(e,t,i){"use strict";game.appModule.ArenaLogPanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.addG(this,game.ArenaEvent.INIT_LOG,this.updateLogs),game.arena.initLog(),this._list||(this._list=new b8e.List(this._skin.list,game.ArenaLogItem)),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.ArenaEvent.INIT_LOG,this.updateLogs)},updateLogs:function(){var e=game.arena.arenaLog.list;0<e.length?this._skin.tips.node.active=!1:this._skin.tips.node.active=!0,this._list.setData(e)}})},{}],112:[function(e,t,i){"use strict";game.ArenaPanel=game.SkinUI.extends({list:null,ctor:function(){this._super("arena/ArenaSkin","ArenaSkin")},getButtonByName:function(e){switch(e){case"fight":if(this._list){var t=this._list.getItemRender(0);if(t){var i=t.getButtonByName("fight");if(i)return i}}return!0}return null},onShow:function(){b8e.evt.onC(this._skin.rankBtn,this.onRankBtnClick,this),b8e.evt.onC(this._skin.prizeBtn,this.onPrizeBtnClick,this),b8e.evt.onC(this._skin.logBtn,this.onLogBtnClick,this),b8e.evt.onC(this._skin.addTimesBtn,this.onAddTimesBtnClick,this),b8e.evt.addG(this,game.ArenaEvent.INIT_ARENA_INFO,this.onUpdateArenaInfo),b8e.evt.addG(this,game.ArenaEvent.ARENA_TIMES_CHANGE,this.onArenaTimesChange),b8e.evt.addG(this,game.ArenaEvent.SELF_RANK_CHANGE,this.onSelfRankChange),game.arena.reqArenaInfo(),this._list||(this._list=new b8e.List(this._skin.list,game.ArenaUserInfoPanel)),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.rankBtn,this.onRankBtnClick,this),b8e.evt.offC(this._skin.prizeBtn,this.onPrizeBtnClick,this),b8e.evt.offC(this._skin.logBtn,this.onLogBtnClick,this),b8e.evt.offC(this._skin.addTimesBtn,this.onAddTimesBtnClick,this),b8e.evt.rmvG(this,game.ArenaEvent.INIT_ARENA_INFO,this.onUpdateArenaInfo),b8e.evt.rmvG(this,game.ArenaEvent.ARENA_TIMES_CHANGE,this.onArenaTimesChange),b8e.evt.rmvG(this,game.ArenaEvent.SELF_RANK_CHANGE,this.onSelfRankChange),game.app.isShow(game.AppConstant.ARENA_BUY_TIMES_PANEL)&&game.app.hide(game.AppConstant.ARENA_BUY_TIMES_PANEL)},onUpdateArenaInfo:function(){var e=game.arena.arenaInfo.list;this._list.setData(e)},onArenaTimesChange:function(){var e=game.arena.arenaInfo.times;this._skin.fightTime.string="挑战次数:<color = #74E610>"+e+"</c>"},onSelfRankChange:function(){var e=game.arena.arenaInfo;this._skin.selfRank.string="我的排名:"+e.rank},onAddTimesBtnClick:function(){game.app.show(game.AppConstant.ARENA_BUY_TIMES_PANEL)},onRankBtnClick:function(){game.app.show(game.AppConstant.ARENA_RANK_PANEL)},onPrizeBtnClick:function(){game.app.show(game.AppConstant.PRIZERULE_PANEL)},onLogBtnClick:function(){game.app.show(game.AppConstant.ARENA_LOG_PANEL)}})},{}],113:[function(e,t,i){"use strict";game.ArenaRankItemPanel=game.SkinUI.extends({_data:null,ctor:function(){this._super("arena/ArenaRankItemSkin","ArenaRankItemSkin")},onShow:function(){this._data&&(this.setData(this._data),b8e.evt.onC(this._skin.name_Label.node,this.onShowMenu,this))},onHide:function(){b8e.evt.offC(this._skin.name_Label.node,this.onShowMenu,this)},onShowMenu:function(e){var t=this._data.roleid;if(String(t).length<12)game.notice.show(82e3);else if(game.mainRole.mainRoleData.playerId!=t){var i=new game.MenuData;i.roleId=t,i.roleName=this._data.name,game.relation.isFriend(t)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,i):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,i)}},getHeight:function(){return 60},getWidth:function(){return 540},setData:function(e){if(this._data=e,this._skin){switch(this._skin.icon_rank_1.active=!1,this._skin.icon_rank_2.active=!1,this._skin.icon_rank_3.active=!1,this._skin.rank_Label.node.active=!1,this._data.rank){case 1:this._skin.icon_rank_1.active=!0;break;case 2:this._skin.icon_rank_2.active=!0;break;case 3:this._skin.icon_rank_3.active=!0;break;default:this._skin.rank_Label.node.active=!0,this._skin.rank_Label.string=this._data.rank}this._skin.name_Label.string=this._data.name,this._skin.level_label.string=this._data.level,this._skin.pow_label.string=this._data.power}}})},{}],114:[function(e,t,i){"use strict";game.appModule.ArenaRankPanel=game.SkinUIPanel.extends({_RankItems:null,_RankItemPool:null,list:null,ctor:function(e){this._super(e),this._RankItemPool=[],this._RankItems=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.ArenaRankItemPanel)),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.updatePanel),game.arena.reqRank(),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.updatePanel)},updatePanel:function(){var e=game.rank.getRankListByType(game.RankType.RANK_ARENA);if(e){this._list.setData(e);var t=game.arena.arenaInfo.rank;this._skin.m_paiming_Label.string="<color=#E7D7A7>我的排名：</c><color=#74D610>"+t+"</color>"}else game.notice.show("竞技场没有保存到数据")}})},{}],115:[function(e,t,i){"use strict";game.appModule.ArenaRecordHighPanel=game.SkinUIPanel.extends({m_data:null,_prizeList:null,countDown:0,ctor:function(e){this._super(e)},onShow:function(){this.setData(),b8e.evt.onC(this._skin.notarize,this.onNotarizeBntClick,this)},onHide:function(){b8e.evt.offC(this._skin.notarize,this.onNotarizeBntClick,this)},setData:function(){if(this._skin){var e=game.arena.arenaFinishInfo,t=game.arena.uprank;this._skin.winEffect.active=!0,this._skin.ranlLabel.string=e.history_rank,this._skin.currentrank.string=e.rank,this._skin.uprank.string="(  "+t+")",this._skin.diamondLabel.string=e.diamond,this._skin.uprank.node.x=this._skin.currentrank.node.x+this._skin.currentrank.node.width+10}},onNotarizeBntClick:function(){this.hide()}})},{}],116:[function(e,t,i){"use strict";game.appModule.ArenaResultPanel=game.SkinUIPanel.extends({_prizeList:null,countDown:0,_timer:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.look_result,this.onshowDetail,this),b8e.evt.onC(this._skin.share_btn,this.onShare,this),b8e.evt.onC(this._skin.exit_btn,this.onEixtBtnClick,this),this.setData(),this.countDown=10,this._timer||(this._timer=b8e.Timer.add(this,this.waitTimeBack,1e3)),this._timer.reset(),this._timer.start()},waitTimeBack:function(){this.countDown<=0&&(this._timer&&this._timer.stop(),game.app.isShow(game.AppConstant.ARENA_RESULT_PANEL)&&(game.arena.onExitArena(),this.hide())),--this.countDown},onHide:function(){b8e.evt.offC(this._skin.look_result,this.onshowDetail,this),b8e.evt.offC(this._skin.share_btn,this.onShare,this),b8e.evt.offC(this._skin.exit_btn,this.onEixtBtnClick,this)},onshowDetail:function(){var e=game.arena.arenaFinishInfo;1==e.type?game.notice.show("对方没有上阵变身，你不战而胜"):game.app.show(game.AppConstant.ARENA_COMBATDATA_PANEL,e.stats)},onShare:function(){},onEixtBtnClick:function(){this._timer&&this._timer.stop(),game.arena.onExitArena(),this.hide()},setData:function(){var e=game.arena.arenaFinishInfo;switch(e.state){case 1:this._skin.lose.active=!1,this._skin.lose_ran_logBG.active=!1,this._skin.lose_ranLabel.node.active=!1,this._skin.victory.active=!0,this._skin.win_rank_logBG.active=!0,this._skin.win_rankLabel.node.active=!0,this._skin.winEffect.active=!0,this._skin.win_rankLabel.string="排名提升至"+e.rank,b8e.ShaderUtil.reset(this._skin.win_bg);break;default:this._skin.lose.active=!0,this._skin.lose_ran_logBG.active=!0,this._skin.lose_ranLabel.node.active=!0,this._skin.victory.active=!1,this._skin.winEffect.active=!1,this._skin.win_rank_logBG.active=!1,this._skin.win_rankLabel.node.active=!1,this._skin.lose_ranLabel.string="排名不变",b8e.ShaderUtil.setGray(this._skin.win_bg)}this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize_conten)),this._prizeList.setData(e.prizeInfo)}})},{}],117:[function(e,t,i){"use strict";game.ArenaShapeItem=game.SkinUI.extends({_data:null,_isAttcker:!1,spr:null,_starBar:null,visibel:!0,_quality:0,ctor:function(){this._super("arena/ArenaShapeItemSkin","ArenaShapeItemSkin")},onShow:function(){this._data&&this.setData(this._data,this._isAttcker),this.setBianshenType(game.ArenaShapeState.NONE)},onHide:function(){},setData:function(e,t){if(this._data=e,this._isAttcker=t,e&&this._skin){var i=e.id,n=e.lv,s=e.jie,a=game.ccfg.BianshenCfg.getBianshenCfgById(i);this.spr||(this.spr=b8e.Sprite.get(),this.spr.addToParent(this._skin.img_icon));var o=game.ccfg.BianshenCfg.getIconById(i),r=game.ClientCfg.getBianshenIconUrlByIdName(o);r?this.spr.loadTexture(r,null,null,{useManifest:!1}):this.spr.unloadTexture(),this._quality=a.quality,this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(a.quality),a.name);var h=a.wuxing,g=this.getWuxing(h);this._setLeftTopImgIcon(g);var l=a.star;this.setBianShenStar(l,s),this._skin.lab_level.string="Lv"+n,this._setImgQuality(a.quality),this.setNameVisibel(this.visibel)}},setNameVisibel:function(e){this.visibel=e,this._skin&&(this._skin.lab_name.node.active=e)},setBianShenStar:function(e,t){this._skin&&(this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.img_star_nodes)),this._starBar.setStarGradeData(e,t,game.StarType.BIANSHEN_STAR),this._starBar.x=~~(this._skin.img_star_nodes.width-this._starBar.starWidth)/2,this._starBar.y=0)},getWuxing:function(e){switch(e){case game.BianshenWuxingType.JIN:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_jin");case game.BianshenWuxingType.MU:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_mu");case game.BianshenWuxingType.SHUI:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_shui");case game.BianshenWuxingType.TU:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_tu");case game.BianshenWuxingType.HUO:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_huo");default:return game.ClientCfg.getImageObj(game.ClientCfg.Bianshen_ALAST_URL,"")}},_setLeftTopImgIcon:function(e){if(e){var t="",i="";e.atlasUrl&&(t=e.atlasUrl),e.iconName&&(i=e.iconName),game.resController.setImgSpriteFrame(this._skin.img_leftTop.node,t,i)}},_setImgQuality:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._quality=e;var t;t=game.ClientCfg.Bianshen_ALAST_URL,game.resController.setQualitySpriteFrame(this._skin.img_quality.node,e,t,game.ContainerId.BIANSHEN_SHOW_GRID_CONTAINER_ID)},getNameColor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this._quality=e,game.html.getColorByQuality(this._quality)},setBianshenType:function(e){if(this._skin)switch(e){case game.ArenaShapeState.NONE:this._skin.fight.active=!1,this._skin.die.active=!1;break;case game.ArenaShapeState.USING:this._skin.fight.active=!0,this._skin.die.active=!1;break;case game.ArenaShapeState.DIE:this._skin.fight.active=!1,this._skin.die.active=!0}},clearIcon:function(){for(var e=0;e<5;++e)this._skin.starNodes[e].active=!1,this._skin.jieNodes[e].active=!1;this._skin.lab_level.string="",this.spr.unloadTexture()},checkout:function(e,t,i){return this._data.id==e&&t==this._isAttcker&&(this.setBianshenType(i),!0)}})},{}],118:[function(e,t,i){"use strict";game.ArenaUserInfoPanel=game.SkinUI.extends({m_slot:null,_iconSprite:null,_bicon_wfg:!1,_barenaTimes:!0,ctor:function(){this._super("arena/ArenaUserInfoSkin","ArenaUserInfoSkin")},getButtonByName:function(e){switch(e){case"fight":return!this._skin||this._skin.figthBtn}return null},onShow:function(){this.m_slot&&(this.setData(this.m_slot),b8e.evt.onC(this._skin.figthBtn,this.onFigthBtnClick,this),b8e.evt.onC(this._skin.headBnt,this.onShowMenu,this))},onHide:function(){this.clearHeadSprite(),b8e.evt.offC(this._skin.figthBtn,this.onFigthBtnClick,this),b8e.evt.offC(this._skin.headBnt,this.onShowMenu,this)},getHeight:function(){return 110},getWidth:function(){return 525},setData:function(e){if(this.m_slot=e,this._skin&&this._skin){this._bicon_wfg=!1;var t=game.arena.arenaInfo.rank,i=this.m_slot.rank,n=game.mainRole.mainRoleData;switch(t==i?n.playerId==this.m_slot.roleId&&(this._bicon_wfg=!0):this._skin.chanllange_Label.string=i<t?game.ClientCfg.arena_challange:game.ClientCfg.arena_one_button_challange,this._skin.icon_rank_1.active=!1,this._skin.icon_rank_2.active=!1,this._skin.icon_rank_3.active=!1,this._skin.rank_Label.node.active=!1,this._skin.self_tip.active=!1,this._barenaTimes?this._skin.figthBtn.active=!0:this._skin.figthBtn.active=!1,this._bicon_wfg?this.onShowselfRankItem():this._skin.icon_wfg.active=!1,i){case 1:this._skin.icon_rank_1.active=!0;break;case 2:this._skin.icon_rank_2.active=!0;break;case 3:this._skin.icon_rank_3.active=!0;break;default:this._skin.rank_Label.node.active=!0,this._skin.rank_Label.string=this.m_slot.rank}this._skin.userName_Label.string=this.m_slot.name,this._skin.level_Label.string=this.m_slot.level,this._skin.atk_Label.string=this.m_slot.power,this.onshowUserHeadImg(this.m_slot.head)}},onShowMenu:function(e){var t=this.m_slot.roleId;if(String(t).length<12)game.notice.show(82e3);else if(game.mainRole.mainRoleData.playerId!=t){var i=new game.MenuData;i.roleId=t,i.roleName=this.m_slot.name,i.head=this.m_slot.head,game.relation.isFriend(t)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,i):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,i)}},onShowselfRankItem:function(){this._skin.icon_wfg.active=!0,this._skin.figthBtn.active=!1,this._skin.self_tip.active=!0},onshowUserHeadImg:function(e){if(this.clearHeadSprite(),this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.setAnchor(.5,.5),this._iconSprite.setScale(1.5),this._iconSprite.addToParent(this._skin.user_icon_node)),""!=e&&0!=e){var t=game.ClientCfg.getHeadIconUrlByHeadId(e);this._iconSprite.loadTexture(t,null,null,{useManifest:!1})}else this._iconSprite.unloadTexture()},clearHeadSprite:function(){this._iconSprite&&this._iconSprite.unloadTexture()},onFigthBtnClick:function(){if(this.m_slot){var e=game.arena.arenaInfo.rank,t=this.m_slot.rank;t<e?game.arena.challengeRequest(this.m_slot.roleId,this.m_slot.rank):e<t&&game.arena.alertAllClear()}}})},{}],119:[function(e,t,i){"use strict";game.CombatDataItem=game.SkinUI.extends({_data:null,maxDamege:0,arenaShapeItem:null,ctor:function(){this._super("arena/CombatDataItemSkin","CombatDataItemSkin")},onShow:function(){this.setData(this._data,this.maxDamege)},onHide:function(){},setData:function(e,t){if(this._data=e,this.maxDamege=t,this._skin){var i=new game.ArenaBianshen;i.setup(e),this.arenaShapeItem||(this.arenaShapeItem=new game.ArenaShapeItem,this.arenaShapeItem.setScale(.7),this.arenaShapeItem.addToParent(this._skin.ArenaShapeItemNode)),this.arenaShapeItem.setData(i),this.arenaShapeItem.setNameVisibel(!1),this.arenaShapeItem.show();var n=game.ccfg.BianshenCfg.getBianshenCfgById(e.id),s=game.html.getText(this.arenaShapeItem.getNameColor(n._quality),game.ccfg.BianshenCfg.getNameById(e.id));this._skin.bianshen_Name.string=s;var a=Math.abs(e.damage);this._skin.damageLab.string="伤害:"+a;this._skin.stencil.width=a/t*150,this._skin.atk_bg.active=!e.isAttacker,this._skin.tar_bg.active=e.isAttacker}}})},{}],120:[function(e,t,i){"use strict";game.appModule.FightPanel=game.SkinUIPanel.extends({arenaPanel:null,suraPanel:null,materialPanel:null,sanzangjiangjin:null,index:-1,lastindex:0,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"material":return!this._skin||this._skin.toggle[1].node;case"arena":return!this._skin||this._skin.toggle[0].node;case"materialFight":return!this.materialPanel||!(t=this.materialPanel.getButtonByName("fight"))||t;case"materialFight_2":return!this.materialPanel||!(t=this.materialPanel.getButtonByName("fight_2"))||t;case"arenaFight":if(this.arenaPanel)return(t=this.arenaPanel.getButtonByName("fight"))||!0}return null},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.toggle[0].check(),this.showIndex(0),this._skin.toggle[0]):"1"==e?(this._skin.toggle[1].check(),this.showIndex(1),this._skin.toggle[1]):"2"==e?(this._skin.toggle[2].check(),this.showIndex(2),this._skin.toggle[2]):"3"!=e||(this._skin.toggle[3].check(),this.showIndex(3),this._skin.toggle[3]))},onShow:function(){this.updatePanel(),-1==this.index&&(this.index=1),null==this.data?this.index=1:this.index=this.data,this.showIndex(this.index),b8e.evt.onC(this._skin.toggle[0].node,this.onShowArenaPanelBtnClick,this),b8e.evt.onC(this._skin.toggle[1].node,this.onLunHuiShiLianBtnClick,this),b8e.evt.onC(this._skin.toggle[2].node,this.onSuraBtnClick,this),b8e.evt.onC(this._skin.toggle[3].node,this.onXunHuiBtnClick,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.ArenaEvent.UPDATE_SURAPANEL,this.onUpdateSuraPanel),this.onSpotAlertChange()},onHide:function(){b8e.evt.offC(this._skin.toggle[0].node,this.onShowArenaPanelBtnClick,this),b8e.evt.offC(this._skin.toggle[1].node,this.onLunHuiShiLianBtnClick,this),b8e.evt.offC(this._skin.toggle[2].node,this.onSuraBtnClick,this),b8e.evt.offC(this._skin.toggle[3].node,this.onXunHuiBtnClick,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.ArenaEvent.UPDATE_SURAPANEL,this.onUpdateSuraPanel),game.app.isShow(game.AppConstant.ARENA_BUY_TIMES_PANEL)&&game.app.hide(game.AppConstant.ARENA_BUY_TIMES_PANEL),this.suraPanel.hide(),this.materialPanel.hide(),this.arenaPanel.hide(),this.sanzangjiangjin.hide()},onSpotAlertChange:function(){this._skin.arenaAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ARENA_ALERT),this._skin.materialAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MATERIAL_ALERT),this._skin.suraAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.SURA_ALERT)},updatePanel:function(){this.arenaPanel||(this.arenaPanel=new game.ArenaPanel,this.arenaPanel.addToParent(this._skin.content)),this.suraPanel||(this.suraPanel=new game.SuraPanel,this.suraPanel.addToParent(this._skin.content)),this.materialPanel||(this.materialPanel=new game.MaterialPanel,this.materialPanel.addToParent(this._skin.content)),this.sanzangjiangjin||(this.sanzangjiangjin=new game.Sanzangjiangjin,this.sanzangjiangjin.addToParent(this._skin.content))},showIndex:function(e){switch(this.index=e,this._skin.toggle[e].check(),e){case 0:game.funcOpen.checkOpenWithTips(game.FunctionType.FENG_SHEN_BANG)?(this.suraPanel.hide(),this.materialPanel.hide(),this.sanzangjiangjin.hide(),this.arenaPanel.show(),this._skin.title.string="封神榜",this.lastindex=e):(this._skin.toggle[this.lastindex].check(),this.index=this.lastindex);break;case 1:game.funcOpen.checkOpenWithTips(game.FunctionType.MATERIAL)?(this.arenaPanel.hide(),this.suraPanel.hide(),this.sanzangjiangjin.hide(),this.materialPanel.show(),this._skin.title.string="材料宝库",this.lastindex=e):(this._skin.toggle[this.lastindex].check(),this.index=this.lastindex);break;case 2:game.funcOpen.checkOpenWithTips(game.FunctionType.SURA)?(this.arenaPanel.hide(),this.materialPanel.hide(),this.sanzangjiangjin.hide(),this.suraPanel.show(),this._skin.title.string="大逃杀",this.lastindex=e):(this._skin.toggle[this.lastindex].check(),this.index=this.lastindex);break;case 3:this.arenaPanel.hide(),this.materialPanel.hide(),this.suraPanel.hide(),this._skin.title.string="三藏讲经",this.sanzangjiangjin.show(),this.lastindex=e;break;default:game.notice.show("Coding...")}},onShowArenaPanelBtnClick:function(){this.showIndex(0)},onHusongBtnClick:function(){this.showIndex(3)},onLunHuiShiLianBtnClick:function(){this.showIndex(1)},onSuraBtnClick:function(){this.showIndex(2)},onXunHuiBtnClick:function(){this.showIndex(3)},onUpdateSuraPanel:function(){switch(this.lastindex){case 1:this.showIndex(1)}}})},{}],121:[function(e,t,i){"use strict";game.PrizeItemPanel=game.SkinUI.extends({m_data:null,_m_strRank:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("arena/PrizeItemPanelSkin","PrizeItemPanelSkin"),this._prizeInfo=new game.PrizeInfo},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},getHeight:function(){return 91},getWidth:function(){return 540},setData:function(e){if(e){this.m_data=e;var t=this.m_data.id+1;if(this._skin){this._skin.rankLabel.node.active=!1,this._skin.NO_1_icpn.active=!1,this._skin.NO_2_icpn.active=!1,this._skin.NO_3_icpn.active=!1;var i=game.arena.arenaInfo.rank;this._skin.selfNode.active=!1;var n=game.ccfg.ArenaRankPrizeCfg.getrankPrize();if(t<3)i==n[t-1]._rank&&(this._skin.selfNode.active=!0);else{var s=n[t-2]._rank+1,a=n[t-1]._rank;s<=i&&i<=a&&(this._skin.selfNode.active=!0)}switch(t){case 1:this._skin.NO_1_icpn.active=!0;break;case 2:this._skin.NO_2_icpn.active=!0;break;case 3:this._skin.NO_3_icpn.active=!0;break;default:this._skin.rankLabel.node.active=!0;s=n[t-2]._rank+1,a=n[t-1]._rank;this._skin.rankLabel.string="第"+s+"-"+a+"名"}this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3)),this._prizeList.addToParent(this._skin.prize_content);var o=n[t-1]._dropId;this._prizeInfo.setupById(o),this._prizeList.setData(this._prizeInfo)}}}})},{}],122:[function(e,t,i){"use strict";game.appModule.PrizeRulePanel=game.SkinUIPanel.extends({_Itemlist:null,_Itempool:null,list:null,ctor:function(e){this._super(e),this._Itemlist=[],this._Itempool=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.PrizeItemPanel)),this.updatePrizeRuleInfo(),this._list.show()},onHide:function(){this._list&&this._list.hide()},setUserItem:function(){},updatePrizeRuleInfo:function(){var e=game.arena.arenaInfo.rank;this._skin.m_paiming_Label.string="<color=#E7D7A7>我的排名：</c><color=#74D610>"+e+"</color>";var t=game.ccfg.ArenaRankPrizeCfg.getrankPrize();this._list.setData(t)}})},{}],123:[function(e,t,i){"use strict";e("./ArenaPanel"),e("./FightPanel"),e("./ArenaUserInfoPanel"),e("./PrizeItemPanel"),e("./PrizeRulePanel"),e("./ArenaBuyTimesPanel"),e("./ArenaLogItem"),e("./ArenaLogPanel"),e("./ArenaResultPanel"),e("./ArenaRankPanel"),e("./ArenaRankItemPanel"),e("./ArenaCombatDataPanel"),e("./ArenaFightPanel")},{"./ArenaBuyTimesPanel":107,"./ArenaCombatDataPanel":108,"./ArenaFightPanel":109,"./ArenaLogItem":110,"./ArenaLogPanel":111,"./ArenaPanel":112,"./ArenaRankItemPanel":113,"./ArenaRankPanel":114,"./ArenaResultPanel":116,"./ArenaUserInfoPanel":118,"./FightPanel":120,"./PrizeItemPanel":121,"./PrizeRulePanel":122}],124:[function(e,t,i){"use strict";game.ArenaSender={},game.ArenaSender.initLog=function(){var e=game.pbmid.Arena.ArenaLogRequest;b8e.sendN(e)},game.ArenaSender.getArenaInfo=function(){var e=game.pbmid.Arena.ArenaInfoRequest;b8e.sendN(e)},game.ArenaSender.challengeRequest=function(e,t){var i=game.pbmsg.ArenaChallengeRequest;i.roleId=e,i.rank=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Arena.ArenaChallengeRequest;b8e.sendN(n)},game.ArenaSender.buyTimes=function(){var e=game.pbmid.Arena.BuyArenaChallengeNumRequest;b8e.sendN(e)},game.ArenaSender.readyRequest=function(){var e=game.pbmid.Arena.ArenaReadyRequest;b8e.sendN(e)},game.ArenaSender.allclearRequest=function(e){var t=game.pbmsg.ArenaQuickChallengeRequest;t.challengeAll=!!e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Arena.ArenaQuickChallengeRequest;b8e.NetSender.send(i)}},{}],125:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_0"),e("./event/eventIndex_0"),e("./manager/managerIndex_0"),e("./panel/panelIndex_0"),e("./sender/senderIndex_0")},{"./cmdlistener/cmdlistenerIndex_0":127,"./event/eventIndex_0":130,"./manager/managerIndex_0":132,"./panel/panelIndex_0":139,"./sender/senderIndex_0":141}],126:[function(e,t,i){"use strict";game.BackCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Bag.BagResponse,this.onBagResponse,this),b8e.addNH(game.pbmid.Bag.UseItemResponse,this.onUseItemResponse,this),b8e.addNH(game.pbmid.Bag.GiveItemNotify,this.onGiveItemNotify,this),b8e.addNH(game.pbmid.Bag.TakeItemNotify,this.onTakeItemNotify,this),b8e.addNH(game.pbmid.Bag.SellEquipResponse,this.onSellEquipResponse,this),b8e.addNH(game.pbmid.Bag.BagFullNotify,this.onBagFullNotify,this),b8e.addNH(game.pbmid.Bag.OpenPrizeNotify,this.onOpenPrizeNotify,this)},onBagResponse:function(e){var t=e.readProtobuf(game.pbmsg.BagResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.back.synBackItemInfo(t.userItem)},onUseItemResponse:function(e){var t=e.readProtobuf(game.pbmsg.UseItemResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.app.hide(game.AppConstant.ITEM_TIPS),game.back.updateGoodsList(t.idx,t.num))},onGiveItemNotify:function(e){var t=e.readProtobuf(game.pbmsg.GiveItemNotify);game.back.addItemOrAmount(t.userItem,t.hideDisplay)},onTakeItemNotify:function(e){var t=e.readProtobuf(game.pbmsg.TakeItemNotify);game.back.removeItemOrAmount(t.userItem)},onSellEquipResponse:function(e){var t=e.readProtobuf(game.pbmsg.SellEquipResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.back.onSellEquipSuccess(t.idxs)},onBagFullNotify:function(e){game.notice.show("装备栏已满，自动帮您出售多余装备")},onOpenPrizeNotify:function(e){var t=e.readProtobuf(game.pbmsg.OpenPrizeNotify);game.back.onShowRewards(t.userItem,t.bianshens)}})},{}],127:[function(e,t,i){"use strict";e("./BackCmd")},{"./BackCmd":126}],128:[function(e,t,i){"use strict";game.AmountEvents=b8e.Enum({AMOUNT_UPDATE:b8e.Event.nextCode()})},{}],129:[function(e,t,i){"use strict";game.BackEvt=b8e.Enum({BACK_SYN_BACK_INFO:b8e.Event.nextCode(),BACK_USE_ITEM_RESPONSE:b8e.Event.nextCode(),BACK_UPDATE_ITEMINFO:b8e.Event.nextCode(),BACK_REMOVE_ITEMINFO:b8e.Event.nextCode(),BACK_ITEM_ALERT:b8e.Event.nextCode(),BACK_EQUIP_ALERT:b8e.Event.nextCode()})},{}],130:[function(e,t,i){"use strict";e("./AmountEvents"),e("./BackEvt")},{"./AmountEvents":128,"./BackEvt":129}],131:[function(e,t,i){"use strict";game.BackMgr=b8e.Object.extends({name:"BackMgr",_amountInfo:null,_goodsMap:null,curSilver:0,curYuanbao:0,curPopularity:0,curContributton:0,curHonour:0,_userItemArr:null,_maxBackCount:0,isShowItemAlert:!1,isShowEquipAlert:!1,_goodsIdsMap:null,_goodsTypesMap:null,_goodsGroupMap:null,_expireTimer:null,ctor:function(){if(1==game.BackMgr._singleton)throw new Error("BackMgr 只能通过单例方法获取");this._super(),this._goodsMap=b8e.HashMap.get(),this._userItemArr=[],this._goodsIdsMap=b8e.HashMap.get(),this._goodsTypesMap=b8e.HashMap.get(),this._goodsGroupMap=b8e.HashMap.get(),this._amountInfo=new game.AmountInfo},synBackItemInfo:function(e){if(e){this._goodsMap.clear(),this._goodsIdsMap.clear(),this._goodsTypesMap.clear(),this._goodsGroupMap.clear();var t,i,n=0,s=e.list,a=e.amount;if(s&&0<s.length){for(n=0;n<s.length;n++)(i=s[n])&&game.ccfg.ItemInfoCfg.getItemInfoById(i.id)&&(t=game.ItemInfoUtil.createItemInfo(i),this._goodsMap.set(t.idx,t),this.onAddItemInfo(t,!1),game.TriggerMgr.inst().goodsTrigger(t,!0));this.checkEquipAlert(),this.checkItemAlert(),game.equip.checkHighEquipSpotAlert(),game.mountequip.checkMountEquipSportAlert(),game.equip.checkEnchantAlert()}this._amountInfo.setData(a);var o,r=0;if(a&&a.list&&0<a.list.length)for(n=0;n<a.list.length;n++)if(o=a.list[n]){switch(o.type){case game.AmountType.SILVER:this.curSilver=o.num,r=this.curSilver;break;case game.AmountType.YUAN_BAO:this.curYuanbao=o.num,r=this.curYuanbao;break;case game.AmountType.POPULARITY:this.curPopularity=o.num,r=this.curPopularity;break;case game.AmountType.CONTRIBUTION:this.curContributton=o.num,r=this.curContributton;break;case game.AmountType.HONOUR:this.curHonour=o.num,r=this.curHonour}this._amountInfo.getValue(o.type)!=r&&this._amountInfo.setAmount(o.type,r)}b8e.evt.dptG(game.BackEvt.BACK_SYN_BACK_INFO)}},addItemOrAmount:function(e,t){if(e){var i,n=0,s=e.list,a=e.amount;if(s&&0<s.length){for(n=0;n<s.length;n++)(i=s[n])&&this.onAddNewItemInfo(i,t,!1);this.checkEquipAlert(),this.checkItemAlert(),game.equip.checkHighEquipSpotAlert(),game.mountequip.checkMountEquipSportAlert(),game.equip.checkEnchantAlert(),b8e.evt.dptG(game.BackEvt.BACK_UPDATE_ITEMINFO)}this._amountInfo.setData(a);var o,r="",h=0;if(a&&a.list&&0<a.list.length){for(n=0;n<a.list.length;n++)if(o=a.list[n]){switch(o.type){case game.AmountType.SILVER:r="银币",this.curSilver=o.curNum,h=this.curSilver;break;case game.AmountType.YUAN_BAO:r="元宝",this.curYuanbao=o.curNum,h=this.curYuanbao;break;case game.AmountType.POPULARITY:r="声望",this.curPopularity=o.curNum,h=this.curPopularity,b8e.evt.dptG(game.DujieEvent.SHENGWANG);break;case game.AmountType.CONTRIBUTION:r="帮贡",this.curContributton=o.curNum,h=this.curContributton;break;case game.AmountType.HONOUR:r=game.ClientCfg.wanfa_arena_honour,this.curHonour=o.curNum,h=this.curHonour}this._amountInfo.getValue(o.type)!=h&&this._amountInfo.setAmount(o.type,h),o.type==game.AmountType.POPULARITY&&(b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.AmuletEvent.UPDATE_AMULETPANEL)),o.type==game.AmountType.CONTRIBUTION&&b8e.evt.dptG(game.GuildEvt.GUILD_UPDATEXINFAPANEL);var g=game.html.getText(game.html.Q_GREEN,"+"+o.num);game.notice.show(1e6,[r,g])}b8e.evt.dptG(game.AmountEvents.AMOUNT_UPDATE)}}},removeItemOrAmount:function(e){if(e){var t,i,n=0,s=e.list,a=e.amount;if(s&&0<s.length){for(n=0;n<s.length;n++)(t=s[n])&&((i=this._goodsMap.get(t.idx))&&(i.num-t.num<=0?(this.onDelItemInfo(i),this._goodsMap.del(t.idx)):(i.num=i.num-t.num,this.updateNum(i)),i.effects&&0<i.effects.length&&i.effects[0].Type==game.ItemEffectType.BIANSHENEXP&&b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)),this.checkEquipAlert(),this.checkItemAlert(),game.equip.checkHighEquipSpotAlert(),game.mountequip.checkMountEquipSportAlert(),game.equip.checkEnchantAlert());b8e.evt.dptG(game.BackEvt.BACK_UPDATE_ITEMINFO)}game.TriggerMgr.inst().updateGoodsTrigger(),game.autoEquip.onUpdateAutoEquip(),this._amountInfo.reduceAmount(a);var o,r=0;if(a&&a.list&&0<a.list.length){for(n=0;n<a.list.length;n++)if(o=a.list[n]){switch(o.type){case game.AmountType.SILVER:this.curSilver=o.curNum,r=this.curSilver;break;case game.AmountType.YUAN_BAO:this.curYuanbao=o.curNum,r=this.curYuanbao;if(game.active.hasActiveSubType(game.ActiveSubType.ST_COST_TARGET_DIAMOND)){var h=game.active.subTypeToCondition(game.ActiveSubType.ST_COST_TARGET_DIAMOND);game.ActiveSender.getActiveCostMap(h)}if(game.active.hasActiveSubType(game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY)){h=game.active.subTypeToCondition(game.ActiveSubType.ST_COST_TARGET_DIAMOND_DAILY);game.ActiveSender.getActiveCostMap(h)}break;case game.AmountType.POPULARITY:this.curPopularity=o.curNum,r=this.curPopularity,b8e.evt.dptG(game.DujieEvent.SHENGWANG),b8e.evt.dptG(game.AmuletEvent.UPDATE_AMULETPANEL);break;case game.AmountType.CONTRIBUTION:this.curContributton=o.curNum,r=this.curContributton,b8e.evt.dptG(game.GuildEvt.GUILD_UPDATEXINFAPANEL);break;case game.AmountType.HONOUR:this.curHonour=o.curNum,b8e.log("removeItemOrAmount.game.AmountType.HONOUR"),r=this.curHonour}this._amountInfo.getValue(o.type)!=r&&this._amountInfo.setAmount(o.type,r)}b8e.evt.dptG(game.AmountEvents.AMOUNT_UPDATE)}}},onAddNewItemInfo:function(e,t,i){var n=game.ccfg.ItemInfoCfg.getItemInfoById(e.id);if(n){var s;switch(n.type){case game.GoodsType.WEAPON:case game.GoodsType.ARMOR:case game.GoodsType.BELT:case game.GoodsType.RING:case game.GoodsType.HELM:case game.GoodsType.NECKLACE:case game.GoodsType.LEGGUARD:case game.GoodsType.SHOE:s=game.ItemInfoUtil.createItemInfo(e),this._goodsMap.set(s.idx,s),this.onAddItemInfo(s,i),game.autoEquip.onChangeEquip();break;case game.GoodsType.ZUOAN:case game.GoodsType.GUAJIAN:case game.GoodsType.JIANGSHENG:case game.GoodsType.JIAODENG:s=game.ItemInfoUtil.createItemInfo(e),this._goodsMap.set(s.idx,s),this.onAddItemInfo(s,i);break;default:this._goodsMap.get(e.idx)?(s=this.getItemInfoById(e.id))&&this.updateAddGoodsList(s.idx,e.num):(s=game.ItemInfoUtil.createItemInfo(e),this._goodsMap.set(s.idx,s),this.onAddItemInfo(s,i)),s&&s.effects&&0<s.effects.length&&s.effects[0].Type==game.ItemEffectType.BIANSHENEXP&&b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)}if(s){if(0<s.expireTime&&!i&&(i=!0,this._expireTimer&&(this._expireTimer.reset(),this._expireTimer.start())),!t){var a=game.html.getText(game.ccfg.ItemInfoCfg.getQualityColorById(s.id)," * "+e.num);game.notice.show(1000001,[game.ccfg.ItemInfoCfg.getQualityNameById(s.id)+a])}game.TriggerMgr.inst().goodsTrigger(s)}}},isBianshenCard:function(e){return 4==e.toString().length},updateAddGoodsList:function(e,t){var i=this._goodsMap.get(e);i&&(i.num+=t,this.updateNum(i))},onCheckExpireTm:function(){var e=this._goodsGroupMap.get(game.GoodsGroup.ITEM);if(e&&!(e.length<=0)){var t=game.SysTime.curTime;if(e&&0<e.length)for(var i,n=0;n<e.length;n++)(i=e[n])&&0<i.expireTime&&t>=i.expireTime&&(this._goodsMap.del(i.idx),this.onDelItemInfo(i));var s=!1;this._goodsMap.forEach(function(e,t){t&&0<t.expireTime&&!s&&(s=!0,this._expireTimer.stop())},this)}},onAddItemInfo:function(e,t){this._goodsIdsMap.get(e.id)||this._goodsIdsMap.set(e.id,[]),this._goodsIdsMap.get(e.id).push(e),this._goodsTypesMap.get(e.type)||this._goodsTypesMap.set(e.type,[]),this._goodsTypesMap.get(e.type).push(e),this._goodsGroupMap.get(e.group)||this._goodsGroupMap.set(e.group,[]),this._goodsGroupMap.get(e.group).push(e);var i=game.SysTime.curTime;0<e.expireTime&&e.expireTime>i&&!t&&(t=!0,this._expireTimer&&(this._expireTimer||(this._expireTimer=b8e.Timer.add(this,this.onCheckExpireTm,5e3)),this._expireTimer.reset(),this._expireTimer.start()))},updateNum:function(e){var t,i,n=this._goodsIdsMap.get(e.id);if(n&&0<n.length)for(t=0;t<n.length;t++)if((i=n[t])&&i.id==e.id&&i.idx==e.idx){i.num=e.num;break}var s=this._goodsTypesMap.get(e.type);if(s&&0<s.length)for(t=0;t<s.length;t++)if((i=s[t])&&i.id==e.id&&i.idx==e.idx){i.num=e.num;break}var a=this._goodsGroupMap.get(e.group);if(a&&0<a.length)for(t=0;t<a.length;t++)if((i=a[t])&&i.id==e.id&&i.idx==e.idx){i.num=e.num;break}},onDelItemInfo:function(e){var t,i,n=this._goodsIdsMap.get(e.id);if(n&&0<n.length)for(t=0;t<n.length;t++)if((i=n[t])&&i.id==e.id&&i.idx==e.idx){n.splice(t,1);break}var s=this._goodsTypesMap.get(e.type);if(s&&0<s.length)for(t=0;t<s.length;t++)if((i=s[t])&&i.id==e.id&&i.idx==e.idx){s.splice(t,1);break}var a=this._goodsGroupMap.get(e.group);if(a&&0<a.length)for(t=0;t<a.length;t++)if((i=a[t])&&i.id==e.id&&i.idx==e.idx){a.splice(t,1);break}},updateItemInfo:function(e){var t,i,n=this._goodsIdsMap.get(e.id);if(n&&0<n.length)for(t=0;t<n.length;t++)(i=n[t])&&i.id==e.id&&i.idx==e.idx&&(n[t]=e);var s=this._goodsTypesMap.get(e.type);if(s&&0<s.length)for(t=0;t<s.length;t++)(i=s[t])&&i.id==e.id&&i.idx==e.idx&&(s[t]=e);var a=this._goodsGroupMap.get(e.group);if(a&&0<a.length)for(t=0;t<a.length;t++)(i=a[t])&&i.id==e.id&&i.idx==e.idx&&(a[t]=e)},updateGoodsList:function(e,t){var i,n=this._goodsMap.get(e);if(n&&(n.num-t<=0?(this.onDelItemInfo(n),this._goodsMap.del(e)):(n.num=n.num-t,this.updateNum(n)),n.effects&&0<n.effects.length))switch(n.effects[0].Type){case game.ItemEffectType.BEAUTYPOWER:game.notice.show(22002,[n.effects[0].Value*t]),i=n.effects[0].Value*t,game.beauty.addBeautyPower(i,!1);break;case game.ItemEffectType.CULTIVATION:i=n.effects[0].Value*t,game.rebirth.addCultivationByOtherWay(i)}game.TriggerMgr.inst().updateGoodsTrigger(),b8e.evt.dptG(game.BackEvt.BACK_USE_ITEM_RESPONSE)},useItem:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(e){var i=game.SysTime.curTime;if(0<e.expireTime&&i>=e.expireTime)game.notice.show("物品已过期，无法使用");else if(game.mainRole.mainRoleData.getLv()<e.level)game.notice.show(1000002);else if(e.isUse)if(0<e.triggerId){var n=game.ccfg.ClientTriggerCfg.getDataById(e.triggerId);n&&game.TriggerMgr.inst().triggerById(n.triggerCommandIds)}else this.checkUseConditions(e,t);else game.notice.show(1000003)}},checkUseConditions:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;e.useCost&&e.useCost.amountInfo?this.checkUseCost(e,t,i):game.BackSender.useItemRequest(e.idx,t,i)},checkUseCost:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=e.useCost.amountInfo.getValue(game.AmountType.YUAN_BAO);if(0<n){var s=n*t;s<=this.getAmountInfo().getValue(game.AmountType.YUAN_BAO)?game.html.getText(game.html.Q_GREEN,s):game.html.getText(game.html.Q_RED,s);var a="使用该物品需要消耗"+s+game.upgrade.getMoneyNameByType(game.AmountType.YUAN_BAO)+",您确认要使用吗？";this.showUseTips(a,e.idx,t)}else e.effects&&0<e.effects.length?this.checkEffectConditions(e,t,i):game.BackSender.useItemRequest(e.idx,t,i)},checkEffectConditions:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;switch(e.effects[0].Type){case game.ItemEffectType.USELVLIMIT:this.checkAccessoryEffects(e,t);break;case game.ItemEffectType.BEAUTYPOWER:if(!game.funcOpen.checkOpenWithTips(game.FunctionType.BEAUTY))return;if(e.effects[0].Value*t>game.beauty.maxPower-game.beauty.curPower)return void game.notice.show(22003);game.BackSender.useItemRequest(e.idx,t);break;case game.ItemEffectType.CULTIVATION:if(!game.funcOpen.checkOpenWithTips(game.FunctionType.REBIRTH))return;game.BackSender.useItemRequest(e.idx,t);break;default:game.BackSender.useItemRequest(e.idx,t,i)}},checkAccessoryEffects:function(e,t){var i,n="",s=game.FunctionType.MOUNT,a=game.AccessoryType.Mount;switch(e.type){case game.GoodsType.MOUNT_UPGRADE:i=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount),s=game.FunctionType.MOUNT,a=game.AccessoryType.Mount,n="坐骑";break;case game.GoodsType.FABAO_UPGRADE:i=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao),s=game.FunctionType.FA_BAO,a=game.AccessoryType.FaBao,n="法宝";break;case game.GoodsType.WING_UPGRADE:i=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing),s=game.FunctionType.WING,a=game.AccessoryType.Wing,n="翅膀"}if(game.funcOpen.checkOpenWithTips(s)){var o=i.accessoryData;if(o){var r=i.getDataLvCfg();r&&0==r.expLimit?game.AccessoryMgr.showPanel(a):e.effects[0].Value&&o.lv>=e.effects[0].Value?game.BackSender.useItemRequest(e.idx,t):game.notice.show(22001,[n])}}},showUseTips:function(e,t,i){var n=new game.GameAlertInfo;n.alertType=game.GameAlertType.TwoBtn,n.string=e,n.obj={ids:t,count:i},n.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,n)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.BackSender.useItemRequest(e.obj.ids,e.obj.count);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},onShowRewards:function(e,t){var i,n,s=this._userItemArr.length=0;if(e&&e.list&&0<e.list.length)for(s=0;s<e.list.length;s++){if(n=e.list[s])game.ccfg.RuneCfg.getRuneDataById(n.id)?(i=game.ItemInfoUtil.createRuneInfo(n)).baseType=game.GoodsType.RUNE:(i=game.ItemInfoUtil.createItemInfo(n)).baseType=game.GoodsType.ITEM_INFO,this._userItemArr.push(i)}if(t&&0<t.length)for(s=0;s<t.length;s++)(n=t[s])&&((i=game.ItemInfoUtil.createBianshenInfo(n)).baseType=game.GoodsType.BIAN_SHEN_CARD,this._userItemArr.push(i));this._userItemArr&&0<this._userItemArr.length&&game.app.show(game.AppConstant.REWARDS_PANEL,this._userItemArr)},getGoodsMap:function(){return this._goodsMap},getBackGoodsList:function(){return this._goodsMap&&0<this._goodsMap.count()?this._goodsMap.values():null},getBackEquipCount:function(){var e,t=this.getEquipList();e=t&&0<t.length?t.length:0;var i=this.getMountEquipList();return i&&0<i.length?e+i.length:e},getAmountInfo:function(){return this._amountInfo?this._amountInfo:null},getAmountValue:function(e){return this._amountInfo?this._amountInfo.getValue(e):0},updateAmountInfo:function(e){this._amountInfo&&this._amountInfo.addSomeType(game.AmountType.YUAN_BAO,e),b8e.evt.dptG(game.AmountEvents.AMOUNT_UPDATE)},getItemInfoById:function(e){var t=this._goodsIdsMap.get(e);return t&&0<t.length?t[0]:null},getItemListByType:function(e){var t=this._goodsTypesMap.get(e);return t&&0<t.length?t:null},getFitEquipByType:function(e){var t,i=this._goodsTypesMap.get(e),n=[];if(i&&0<i.length)for(var s=0;s<i.length;s++)(t=i[s])&&game.equip.isCanWear(t)&&n.push(t);return n},getBestFitEquipByType:function(e){var t=this.getFitEquipByType(e);if(t.length<=0)return null;for(var i=t[0],n=0;n<t.length;++n)if(i.power<=t[n].power&&(i=t[n],game.equip.isCanWear(i)))return i;return null},setItemInfo:function(e,t){var i=this._goodsMap.get(e);i&&(t&&(i.setEquipAppendInfo(t.attr),i.appendSpriteStat?i.appendPower=game.CCommonUtil.getPower(i.appendSpriteStat,i.level):i.appendPower=0,game.equip.srcEquip=i,this.updateItemInfo(i)),b8e.evt.dptG(game.BackEvt.BACK_UPDATE_ITEMINFO))},getItemInfoCountById:function(e){var t=this.getItemInfoById(e);return t?t.num:0},getEquipList:function(){var e=this._goodsGroupMap.get(game.GoodsGroup.EQUIP);return e&&0<e.length?e:null},getMountEquipList:function(){var e=this._goodsGroupMap.get(game.GoodsGroup.MOUNTEQUIP);return e&&0<e.length?e:null},getGoodsList:function(){var e=this._goodsGroupMap.get(game.GoodsGroup.ITEM);return e&&0<e.length?e:null},getBianshenMaterialList:function(){var e=this._goodsTypesMap.get(game.GoodsType.BIAN_SHEN_YAO_SHUI);return e&&0<e.length?(e.sort(this.onSortBianshen),e):null},onSortBianshen:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},isHasItemInfoById:function(e){var t=this._goodsIdsMap.get(e);return!!(t&&0<t.length)},getIsEnough:function(e){if(!e)return!1;if(!e.useCost)return!1;if(e.effects&&0<e.effects.length&&e.effects[0].Type==game.ItemEffectType.BEAUTYPOWER)return!1;var t=e.useCost.getCostItemList();if(!t||t.length<=0)return!0;for(var i=0;i<t.length;i++){var n=t[i];if(n){var s=this.getItemInfoById(n.id);if(!s)return!1;if(s.num<n.num)return!1}}return!0},getIsSU:function(e){if(!e)return!1;if(e&&e.effects&&0<e.effects.length&&e.effects[0].Type==game.ItemEffectType.USELVLIMIT){var t,i=game.FunctionType.MOUNT;switch(e.type){case game.GoodsType.MOUNT_UPGRADE:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount),i=game.FunctionType.MOUNT;break;case game.GoodsType.FABAO_UPGRADE:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao),i=game.FunctionType.FA_BAO;break;case game.GoodsType.WING_UPGRADE:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing),i=game.FunctionType.WING}if(!t)return!1;var n=t.accessoryData;if(!n)return!1;if(!game.funcOpen.checkOpen(i))return!1;if(e.effects[0].Value&&n.lv>=e.effects[0].Value)return!0}return!1},reqSellEquip:function(e){game.BackSender.reqSellEquip(e)},onSellEquipSuccess:function(e){if(!e||e.length<=0)b8e.log("出售物品成功，为什么移除的物品为0个！！！！");else{for(var t,i,n=0;n<e.length;n++)t=e[n],(i=this._goodsMap.get(t))&&(this.onDelItemInfo(i),this._goodsMap.del(t));this.checkEquipAlert(),game.equip.checkHighEquipSpotAlert(),game.equip.checkEnchantAlert(),game.mountequip.checkMountEquipSportAlert(),b8e.evt.dptG(game.BackEvt.BACK_UPDATE_ITEMINFO)}},checkItemAlert:function(){this.isShowItemAlert=!1;var e=game.mainRole.mainRoleData.getLv(),t=this._goodsGroupMap.get(game.GoodsGroup.ITEM);if(t)if(t.length<=0)b8e.evt.dptG(game.BackEvt.BACK_ITEM_ALERT);else{for(var i,n=0;n<t.length;n++)if((i=t[n])&&e>i.level&&!i.isCostYB&&i.isUse)if(i.type==game.GoodsType.YAO_SHUI){if(!game.rebirth.isRebirthExp()){this.isShowItemAlert=this.getIsEnough(i);break}}else{if(i.type!=game.GoodsType.XIANDAN){if(i.type==game.GoodsType.MOUNT_UPGRADE||i.type==game.GoodsType.FABAO_UPGRADE||i.type==game.GoodsType.WING_UPGRADE){this.isShowItemAlert=this.getIsSU(i);break}this.isShowItemAlert=!i.notShowRed&&this.getIsEnough(i);break}if(game.xiandan.canUseXiandanById(i.id)){this.isShowItemAlert=this.getIsEnough(i);break}}b8e.evt.dptG(game.BackEvt.BACK_ITEM_ALERT)}else b8e.evt.dptG(game.BackEvt.BACK_ITEM_ALERT)},isShowRed:function(e){var t=game.mainRole.mainRoleData.getLv();if(e&&t>e.level){if(e.isCostYB)return!0;if(!e.isUse)return!1;switch(e.type){case game.GoodsType.YAO_SHUI:if(!game.rebirth.isRebirthExp())return this.getIsEnough(e);break;case game.GoodsType.XIANDAN:if(game.xiandan.canUseXiandanById(e.id))return this.getIsEnough(e);break;case game.GoodsType.MOUNT_UPGRADE:case game.GoodsType.FABAO_UPGRADE:case game.GoodsType.WING_UPGRADE:return this.getIsSU(e);default:var i=this.getIsEnough(e);return!e.notShowRed&&i}}return!1},checkEquipAlert:function(){this.getBackEquipCount();this._maxBackCount<=0&&(this._maxBackCount=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_BACK_EQUIP_COUNT));var e=[game.Quality.Q_GREEN,game.Quality.Q_BLUE,game.Quality.Q_PURPLE];if(10<=game.equip.getSmeltEquipsByQualitys(e).length)return this.isShowEquipAlert=!0,void b8e.evt.dptG(game.BackEvt.BACK_EQUIP_ALERT);this.isShowEquipAlert=!1,b8e.evt.dptG(game.BackEvt.BACK_EQUIP_ALERT)},isMaxBackEquipNum:function(){return this._maxBackCount<=0&&(this._maxBackCount=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_BACK_EQUIP_COUNT)),!(this.getBackEquipCount()<this._maxBackCount)}}),game.BackMgr._instance=null,game.BackMgr._singleton=!0,game.BackMgr.inst=function(){return game.BackMgr._instance||(game.BackMgr._singleton=!1,game.BackMgr._instance=new game.BackMgr,game.BackMgr._singleton=!0),game.BackMgr._instance}},{}],132:[function(e,t,i){"use strict";e("./BackMgr")},{"./BackMgr":131}],133:[function(e,t,i){"use strict";game.BackEquipPanel=game.SkinUI.extends({list:null,ctor:function(){this._super("back/BackEquipSkin","BackEquipSkin")},getButtonByName:function(e){switch(e){case"sell":return!this._skin||this._skin.btn_sell;case"getCanRefineEquip":if(this._list){var i=null;if(this._list._itemRenders.every(function(e){var t=e._data;return!game.equip.isCanRefine(t)||(i=t,!1)},this),i)return i}return!0}return null},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.BackPackGrid,5)),this._list.show(),this._skin.lab_tip.string="",this.onUpdateInfo(),b8e.evt.onC(this._skin.btn_sell,this.onBatchSaleBtnClick,this),b8e.evt.addG(this,game.BackEvt.BACK_USE_ITEM_RESPONSE,this.onUpdateInfo),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateInfo),b8e.evt.addG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.onUpdateInfo),b8e.evt.addG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowEquipAlert),game.back.checkEquipAlert()},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_sell,this.onBatchSaleBtnClick,this),b8e.evt.rmvG(this,game.BackEvt.BACK_USE_ITEM_RESPONSE,this.onUpdateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.onUpdateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowEquipAlert)},updateShowEquipAlert:function(){this._skin.sellAlert.active=game.back.isShowEquipAlert},onUpdateInfo:function(e){var t=[],i=game.back.getEquipList(),n=game.back.getMountEquipList();i&&(i.sort(this.onSortByPowers),t=t.concat(i)),n&&(t=t.concat(n)),this._skin.lab_backCount.string=t.length+"/200",0<t.length?this._skin.lab_tip.string="":(this._skin.lab_backCount.string="0/200",this._skin.lab_tip.string="未获得装备"),this._list.setData(t)},onSortByPowers:function(e,t){var i=game.equip.isCanWear(e),n=game.equip.isCanWear(t),s=game.equip.isCanRefine(e),a=game.equip.isCanRefine(t),o=game.equip.isCanSmelting(e),r=game.equip.isCanSmelting(t);return i&&!n?-1:!i&&n?1:s&&!a?-1:!s&&a?1:o&&!r?-1:!o&&r?1:e.basePower>t.basePower?-1:e.basePower<t.basePower?1:e.quality>t.quality?-1:e.quality<t.quality?1:0},onBatchSaleBtnClick:function(){game.app.show(game.AppConstant.BACK_SMELT_PANEL)}})},{}],134:[function(e,t,i){"use strict";game.BackGoodsPanel=game.SkinUI.extends({ctor:function(){this._super("back/BackGoodsSkin","BackGoodsSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.BackPackGrid,5)),this._list.show(),this._skin.lab_tip.string="",this.onUpdateInfo(),b8e.evt.addG(this,game.BackEvt.BACK_USE_ITEM_RESPONSE,this.onUpdateInfo),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateInfo),b8e.evt.addG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.onUpdateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.BackEvt.BACK_USE_ITEM_RESPONSE,this.onUpdateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.onUpdateInfo)},onUpdateInfo:function(){var e=game.back.getGoodsList();e&&0<e.length?(this._skin.lab_tip.string="",e.sort(this.onSort)):this._skin.lab_tip.string="未获得物品",this._list.setData(e)},onSort:function(e,t){var i=game.back.isShowRed(e),n=game.back.isShowRed(t);return i&&!n?-1:!i&&n?1:e.isCostYB&&!t.isCostYB?-1:!e.isCostYB&&t.isCostYB?1:e.quality>t.quality?-1:e.quality<t.quality?1:e.type>t.type?-1:e.type<t.type?1:0}})},{}],135:[function(e,t,i){"use strict";game.appModule.BackPanel=game.SkinUIPanel.extends({_tabIndex:-1,_equipPanel:null,_goodsPanel:null,_cornucopiaPanel:null,_runeBagPanel:null,_curPanel:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"backEquipSell":if(this._equipPanel)return(t=this._equipPanel.getButtonByName("sell"))||!0;break;case"back":return!this._skin||this._skin.closeBtnReturn;case"equipToggle":return!this._skin||this._skin.buttonToggle[0].node;case"daojuToggle":return!this._skin||this._skin.buttonToggle[1].node;case"cornucopia":return!this._skin||this._skin.buttonToggle[2].node;case"rune":return!this._skin||this._skin.buttonToggle[3].node;case"equipToggle":return!this._skin||this._skin.buttonToggle[0].node;case"cornucopiaGet":return!this._cornucopiaPanel||!(t=this._cornucopiaPanel.getButtonByName("get"))||t}return null},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"1"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"2"==e?(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]):"3"!=e||(this._skin.buttonToggle[3].check(),this.onSelectPanelByIndex(3),this._skin.buttonToggle[3]))},onShow:function(){-1==this._tabIndex&&(this._tabIndex=0),this.onSelectPanelByIndex(this._tabIndex),this._skin.buttonToggle[this._tabIndex].check(),game.back.checkEquipAlert(),game.back.checkItemAlert(),this.onSpotAlertChange(),this.updateShowItemAlert(),this.updateShowEquipAlert(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickEquip,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickItem,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickCornucopia,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onClickRune,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.BackEvt.BACK_ITEM_ALERT,this.updateShowItemAlert),b8e.evt.addG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowEquipAlert),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickEquip,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickItem,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickCornucopia,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onClickRune,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.BackEvt.BACK_ITEM_ALERT,this.updateShowItemAlert),b8e.evt.rmvG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowEquipAlert),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onSpotAlertChange:function(){this._skin.jubaopenAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.BAG_CORNUCOPIA_ALERT)},updateShowItemAlert:function(){this._skin.itemAlert.active=game.back.isShowItemAlert},updateShowEquipAlert:function(){this._skin.equipAlert.active=game.back.isShowEquipAlert},onClickEquip:function(){0!=this._tabIndex&&this.onSelectPanelByIndex(0)},onClickItem:function(){1!=this._tabIndex&&this.onSelectPanelByIndex(1)},onClickCornucopia:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.CORNUCOPIA)){if(2==this._tabIndex)return;this.onSelectPanelByIndex(2)}else this._skin.buttonToggle[this._tabIndex].check()},onClickRune:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.RUNE)){if(3==this._tabIndex)return;this.onSelectPanelByIndex(3)}else this._skin.buttonToggle[this._tabIndex].check()},onSelectPanelByIndex:function(e){switch(this._tabIndex=e,this._curPanel&&this._curPanel.hide(),this._tabIndex){case 0:this._equipPanel||(this._equipPanel=new game.BackEquipPanel,this._equipPanel.addToParent(this._skin.panelNode)),this._equipPanel.show(),this._curPanel=this._equipPanel;break;case 1:this._goodsPanel||(this._goodsPanel=new game.BackGoodsPanel,this._goodsPanel.addToParent(this._skin.panelNode)),this._goodsPanel.show(),this._curPanel=this._goodsPanel;break;case 2:this._cornucopiaPanel||(this._cornucopiaPanel=new game.CornucopiaPanel,this._cornucopiaPanel.addToParent(this._skin.panelNode)),this._cornucopiaPanel.show(),this._curPanel=this._cornucopiaPanel;break;case 3:this._runeBagPanel||(this._runeBagPanel=new game.RuneBagPanel,this._runeBagPanel.addToParent(this._skin.panelNode)),this._runeBagPanel.show(),this._curPanel=this._runeBagPanel}}})},{}],136:[function(e,t,i){"use strict";game.appModule.BackSmeltPanel=game.SkinUIPanel.extends({_qualityGreenEquipArr:null,_qualityBlueEquipArr:null,_qualityPurpleEquipArr:null,_qualityYellowEquipArr:null,ctor:function(e){this._super(e),this._qualityGreenEquipArr=[],this._qualityBlueEquipArr=[],this._qualityPurpleEquipArr=[],this._qualityYellowEquipArr=[]},getButtonByName:function(e){switch(e){case"smelt0":return!this._skin||this._skin.btn_0;case"smelt1":return!this._skin||this._skin.btn_1;case"smelt2":return!this._skin||this._skin.btn_2;case"smelt3":return!this._skin||this._skin.btn_3;case"back":return!this._skin||this._skin.closeBtnReturn}return null},onShow:function(){this.updateInfo(),b8e.evt.onC(this._skin.btn_0,this.onBatchSaleBtnClick0,this),b8e.evt.onC(this._skin.btn_1,this.onBatchSaleBtnClick1,this),b8e.evt.onC(this._skin.btn_2,this.onBatchSaleBtnClick2,this),b8e.evt.onC(this._skin.btn_3,this.onBatchSaleBtnClick3,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},onHide:function(){this._qualityGreenEquipArr.length=0,this._qualityBlueEquipArr.length=0,this._qualityPurpleEquipArr.length=0,b8e.evt.offC(this._skin.btn_0,this.onBatchSaleBtnClick0,this),b8e.evt.offC(this._skin.btn_1,this.onBatchSaleBtnClick1,this),b8e.evt.offC(this._skin.btn_2,this.onBatchSaleBtnClick2,this),b8e.evt.offC(this._skin.btn_3,this.onBatchSaleBtnClick3,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},updateInfo:function(){var e;this._qualityGreenEquipArr=game.equip.getSmeltEquipsByQuality(game.Quality.Q_GREEN),e=this._qualityGreenEquipArr&&0<this._qualityGreenEquipArr.length?this._qualityGreenEquipArr.length:0,this._skin.lab_name_0.string=game.html.getText(game.html.Q_GREEN,"绿色装备： x"+e),this._qualityBlueEquipArr=game.equip.getSmeltEquipsByQuality(game.Quality.Q_BLUE),e=this._qualityBlueEquipArr&&0<this._qualityBlueEquipArr.length?this._qualityBlueEquipArr.length:0,this._skin.lab_name_1.string=game.html.getText(game.html.Q_BLUE,"蓝色装备： x"+e),this._qualityPurpleEquipArr=game.equip.getSmeltEquipsByQuality(game.Quality.Q_PURPLE),e=this._qualityPurpleEquipArr&&0<this._qualityPurpleEquipArr.length?this._qualityPurpleEquipArr.length:0,this._skin.lab_name_2.string=game.html.getText(game.html.Q_PURPLE,"紫色装备： x"+e),this._qualityYellowEquipArr=game.equip.getSmeltEquipsByQuality(game.Quality.Q_YELLOW),e=this._qualityYellowEquipArr&&0<this._qualityYellowEquipArr.length?this._qualityYellowEquipArr.length:0,this._skin.lab_name_3.string=game.html.getText(game.html.Q_YELLOW,"橙色装备： x"+e)},onBatchSaleBtnClick0:function(){!this._qualityGreenEquipArr||this._qualityGreenEquipArr<=0?game.notice.show("没有可熔炼的绿色品质的装备"):game.back.reqSellEquip(this.getIdxs(this._qualityGreenEquipArr))},onBatchSaleBtnClick1:function(){!this._qualityBlueEquipArr||this._qualityBlueEquipArr<=0?game.notice.show("没有可熔炼的蓝色品质的装备"):game.back.reqSellEquip(this.getIdxs(this._qualityBlueEquipArr))},onBatchSaleBtnClick2:function(){!this._qualityPurpleEquipArr||this._qualityPurpleEquipArr<=0?game.notice.show("没有可熔炼的紫色品质的装备"):game.back.reqSellEquip(this.getIdxs(this._qualityPurpleEquipArr))},onBatchSaleBtnClick3:function(){!this._qualityYellowEquipArr||this._qualityYellowEquipArr<=0?game.notice.show("没有可熔炼的橙色品质的装备"):game.back.reqSellEquip(this.getIdxs(this._qualityYellowEquipArr))},getIdxs:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];n&&t.push(n.idx)}return t}})},{}],137:[function(e,t,i){"use strict";game.appModule.ItemTips=game.SkinUIPanel.extends({_itemInfo:null,itemGrid:null,_containerId:-1,_isUse:!1,_amountYb:0,_useCount:0,ctor:function(e){this._super(e)},onShow:function(){this.clearData(),this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID)),this.data&&(this._itemInfo=this.data.itemInfo,this._containerId=this.data.containerId,this._ornamentInfo=this.data.ornamentInfo,this._containerId||b8e.Logger.log("物品tips的容器id怎么是一个undefined！！！检测代码"),this.updateInfo(),b8e.evt.onC(this._skin.minBtn,this.onMinBtnEvents,this),b8e.evt.onC(this._skin.maxBtn,this.onMaxBtnEvents,this),b8e.evt.onC(this._skin.jiahaoBtn,this.onJianhaoBtnEvents,this),b8e.evt.onC(this._skin.jianhaoBtn,this.onJiahaoBtnEvents,this),b8e.evt.onC(this._skin.useBtn,this.onUseItem,this),b8e.evt.onC(this._skin.compound_Btn,this.onCompound,this))},onHide:function(){this._skin.lab_name.string="",this._skin.lab_count.string="数量：",this._skin.lab_level.string="等级：",this._skin.lab_desc.string="",this._skin.lab_use_count.string="",this._useCount=0,this._ornamentInfo=null,this._skin.bottom_node.active=!1,this._skin.compound_node.active=!1,game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.minBtn,this.onMinBtnEvents,this),b8e.evt.offC(this._skin.maxBtn,this.onMaxBtnEvents,this),b8e.evt.offC(this._skin.jiahaoBtn,this.onJianhaoBtnEvents,this),b8e.evt.offC(this._skin.jianhaoBtn,this.onJiahaoBtnEvents,this),b8e.evt.offC(this._skin.useBtn,this.onUseItem,this),b8e.evt.offC(this._skin.compound_Btn,this.onCompound,this)},updateInfo:function(){if(this._itemInfo){if(this._containerId&&(this._containerId==game.ContainerId.BACK_CONTAINER_ID&&this._itemInfo.isUse||this._containerId==game.ContainerId.ORNAMENT_CONTAINER_ID)){if(this._isUse=!0,this._itemInfo.isCompound){var e=this._itemInfo.useCost.getFirstUpgradeInfoNum(),t=this._itemInfo.num/e|0;this._useCount=999<t?999:t,this._skin.lab_use_count.string=this._useCount+"",this._skin.lab_use.string="合 成",this._skin.lab_comp_result.node.active=!0,this.setAwardCountAndCount(e)}else{if(this._skin.lab_comp_result.node.active=!1,this._itemInfo.type==game.GoodsType.ORNAMENT&&this._ornamentInfo){var i=game.ornament.getCanEnsoulCount(this._ornamentInfo.itemId);this._useCount=i<=0?0:this._itemInfo.num<=i?this._itemInfo.num:i}else this._useCount=this._itemInfo.num;this._skin.lab_use_count.string=this._useCount+"",this._skin.lab_use.string="使 用"}this._skin.bottom_node.active=!0,this._skin.compound_node.active=!1,this._itemInfo.type==game.GoodsType.MOUNT_UPGRADE||this._itemInfo.type==game.GoodsType.FABAO_UPGRADE||this._itemInfo.type==game.GoodsType.WING_UPGRADE?(this._skin.lab_use_count.string=this._itemInfo.num+"",this._useCount=this._itemInfo.num,1<=this._itemInfo.num&&(this._skin.lab_use_count.string="1",this._useCount=1),this._skin.minBtn.active=!1,this._skin.maxBtn.active=!1,this._skin.jiahaoBtn.active=!1,this._skin.jianhaoBtn.active=!1):(this._skin.minBtn.active=!0,this._skin.maxBtn.active=!0,this._skin.jiahaoBtn.active=!0,this._skin.jianhaoBtn.active=!0)}else this._isUse=!1,this._skin.bottom_node.active=!1,this._skin.compound_node.active=!1,this._skin.lab_use_count.string="",this._useCount=0;game.GridUtil.setItemGrid(this.itemGrid,this._itemInfo,!1,!1,this._containerId),this.itemGrid.sortLayer(),this._skin.lab_name.string=game.ccfg.ItemInfoCfg.getQualityNameById(this._itemInfo.id);var n=this._itemInfo.num?this._itemInfo.num:1;this._skin.lab_count.string="数量："+n;var s="";s=game.mainRole.mainRoleData.getLv()>=this._itemInfo.level?game.html.getText(game.html.Q_GREEN,"等级："+this._itemInfo.level):game.html.getText(game.html.Q_RED,"等级："+this._itemInfo.level),this._skin.lab_level.string=s,""==this._itemInfo.desc?this._skin.lab_desc.string="":this._itemInfo.isCostYB?this.updateCost():this._itemInfo.type==game.GoodsType.ORNAMENT&&this._ornamentInfo?this._skin.lab_desc.string=this.createOrnamentDesc(this._ornamentInfo):this._skin.lab_desc.string=this._itemInfo.desc,0<this._itemInfo.expireTime?this._skin.lab_expiry.string="物品过期时间："+b8e.TimeUtil.formatTimestamp(this._itemInfo.expireTime):this._skin.lab_expiry.string="",this.updateLayout()}},getAwardWithQuality:function(e,t,i){return"合成获得："+e+"(<color=#00ff00>"+t+"</c>/"+i+")"},createOrnamentDesc:function(e){if(!e)return"";var t=[],i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ORNAMENT_ENSOUL_ATTR),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i);if(n)for(var s=e.ensoul-1;0<=s;s--)t=t.concat(n.getSpriteStats());var a,o=b8e.HashMap.get();t.forEach(function(e){(a=o.get(e.type))?o.set(e.type,a+e.value):o.set(e.type,e.value)},this);var r=game.ccfg.OrnamentCfg.getMaxEnSoul(e.itemId,e.level+1),h=game.ccfg.LangCfg.getText(79306,[r]);return 0<e.ensoul&&(h+=game.ccfg.LangCfg.getText(79307)),o.forEach(function(e,t){h+=this.getAttrStr(e,t)},this),h},getAttrStr:function(e,t){switch(game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(e).type){case game.AttrPowerCoefType.TYPE_1:return"<br/>"+game.ccfg.AttrRulesCfg.getAttrNameByType(e)+" :"+(100*t).toFixed(1)+"%";default:return"<br/>"+game.ccfg.AttrRulesCfg.getAttrNameByType(e)+" :"+Math.round(t)}},setAwardCountAndCount:function(e){var t=this._itemInfo.effects[0];if(t){var i=0|t.Value,n=game.ccfg.PrizeCfg.getPrizeById(i);if(n[0]){var s=game.ccfg.ItemInfoCfg.getQualityNameById(n[0].itemId);this._skin.lab_comp_result.string=this.getAwardWithQuality(s,this._useCount*e,e)}else b8e.warn("dropId: "+i+"掉落有问题")}},updateCost:function(){var e="",t=game.back.getAmountInfo();if(t){var i=t.getValue(game.AmountType.YUAN_BAO);if(this._itemInfo.useCost&&this._itemInfo.useCost.amountInfo){var n=this._itemInfo.useCost.amountInfo.getValue(game.AmountType.YUAN_BAO);this._amountYb=n*(this._useCount<=0?1:this._useCount),e="\n\n(打开需要"+(n<=i?game.html.getText(game.html.Q_GREEN,this._amountYb):game.html.getText(game.html.Q_RED,this._amountYb))+game.upgrade.getMoneyNameByType(game.AmountType.YUAN_BAO)+")"}}this._skin.lab_desc.string=this._itemInfo.desc+e},onMinBtnEvents:function(){if(this._skin.lab_use_count.string="1",this._useCount=1,this._itemInfo.isCostYB&&this.updateCost(),this._itemInfo.isCompound&&this._itemInfo.useCost){var e=this._itemInfo.useCost.getFirstUpgradeInfoNum();this._useCount=1,this._skin.lab_use_count.string=this._useCount+"",this.setAwardCountAndCount(e)}},onMaxBtnEvents:function(){if(this._itemInfo.isCompound){if(this._itemInfo.useCost){var e=this._itemInfo.useCost.getFirstUpgradeInfoNum(),t=this._itemInfo.num/e|0;t=999<t?999:t,this._useCount=t<=0?1:t,this.setAwardCountAndCount(e)}}else if(this._itemInfo.type==game.GoodsType.ORNAMENT&&this._ornamentInfo){var i=game.ornament.getCanEnsoulCount(this._ornamentInfo.itemId);this._useCount=i<=0?this._itemInfo.num:this._itemInfo.num<=i?this._itemInfo.num:i}else this._useCount=this._itemInfo.num;this._skin.lab_use_count.string=this._useCount+"",this._itemInfo.isCostYB&&this.updateCost()},onJianhaoBtnEvents:function(){if(this._itemInfo.isCompound){var e=this._itemInfo.useCost.getFirstUpgradeInfoNum();0<(this._itemInfo.num/e|0)&&1<this._useCount-1?this._useCount--:this._useCount=1,this.setAwardCountAndCount(e)}else this._useCount--,this._useCount<=1&&(this._useCount=1);this._skin.lab_use_count.string=this._useCount+"",this._itemInfo.isCostYB&&this.updateCost()},onJiahaoBtnEvents:function(){if(this._itemInfo.isCompound){var e=this._itemInfo.useCost.getFirstUpgradeInfoNum(),t=this._itemInfo.num/e|0;t>this._useCount+1?(this._useCount++,this._useCount=999<this._useCount?999:this._useCount):this._useCount=t,this.setAwardCountAndCount(e)}else if(this._useCount++,this._itemInfo.type==game.GoodsType.ORNAMENT&&this._ornamentInfo){var i=game.ornament.getCanEnsoulCount(this._ornamentInfo.itemId);(i=i>this._itemInfo.num?this._itemInfo.num:i)<=0?this._useCount>=this._itemInfo.num&&(this._useCount=this._itemInfo.num):this._useCount=this._useCount>i?i:this._useCount}else this._useCount>=this._itemInfo.num&&(this._useCount=this._itemInfo.num);this._skin.lab_use_count.string=this._useCount+"",this._itemInfo.isCostYB&&this.updateCost()},clearData:function(){this._skin.lab_name.string="",this._skin.lab_count.string="数量：",this._skin.lab_level.string="等级：",this._skin.lab_desc.string="",this._skin.lab_use_count.string="",this._useCount=0},onUseItem:function(){if(this._itemInfo)if(this._itemInfo.isCostYB)game.upgrade.costCheckMoney(game.AmountType.YUAN_BAO,this._amountYb,!0,!0)&&(game.back.useItem(this._itemInfo,this._useCount),this.hide());else if(this._itemInfo.type==game.GoodsType.ORNAMENT&&this._ornamentInfo){var e=game.ccfg.OrnamentCfg.getMaxEnSoul(this._ornamentInfo.itemId,this._ornamentInfo.level);if(this._ornamentInfo.ensoul>=e)return void game.notice.show(79301);game.ornament.rqOrnamentEnsoul(this._ornamentInfo.itemId,this._useCount),this.hide()}else this._itemInfo.useCost?game.upgrade.costCheck(this,this._itemInfo.useCost,this.onIsPass,!0):(game.back.useItem(this._itemInfo,this._useCount),this.hide());else b8e.log("物品数据为空！！！！！！")},onIsPass:function(e){if(e){var t=0,i=this._itemInfo.useCost.getFirstUpgradeInfo();if(i){var n=game.back.getItemInfoCountById(i.id),s=i.num*this._useCount;t=n<s?Math.floor(n/i.num):Math.floor(s/i.num)}else t=this._useCount;game.back.useItem(this._itemInfo,t),this.hide()}},onCompound:function(){this._itemInfo?this._itemInfo.useCost?game.upgrade.costCheck(this,this._itemInfo.useCost,this.onIsCompound,!0):(game.back.useItem(this._itemInfo,1),this.hide()):b8e.log("物品数据为空！！！！！！")},onIsCompound:function(e){if(e){game.back.useItem(this._itemInfo,1),this.hide()}},updateLayout:function(){var e=0;this._isUse?(this._skin.img_desc.y=this._skin.bottom_node.y+this._skin.bottom_node.height+10,this._skin.img_desc.y=this._skin.compound_node.y+this._skin.compound_node.height+10,0<this._itemInfo.expireTime?(this._skin.lab_expiry.node.active=!0,this._skin.lab_expiry.node.y=this._skin.img_desc.y+10,this._skin.lab_desc.node.y=this._skin.lab_expiry.node.y+this._skin.lab_expiry.node.height+10,e=this._skin.lab_expiry.node.height+10+this._skin.lab_desc.node.height+10):(this._skin.lab_expiry.node.active=!1,this._skin.lab_desc.node.y=this._skin.img_desc.y+10,e=this._skin.lab_desc.node.height+10),this._skin.img_desc.height=e+10):(e=150,this._skin.lab_desc.node.height>e&&(e=this._skin.lab_desc.node.height),0<this._itemInfo.expireTime?this._skin.lab_expiry.node.active=!0:this._skin.lab_expiry.node.active=!1,this._skin.img_desc.y=20,this._skin.img_desc.height=e+40,this._skin.lab_expiry.node.y=this._skin.img_desc.y+10,this._skin.lab_desc.node.y=this._skin.img_desc.height-this._skin.lab_desc.node.height),this._skin.top_node.y=this._skin.img_desc.y+this._skin.img_desc.height+10;var t=this._skin.top_node.y+this._skin.top_node.height+20+21;this._skin.bg.node.height=t,this.height=t,this.resetPosition()}})},{}],138:[function(e,t,i){"use strict";game.appModule.RewardsPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.RewardsGrid,4)),this._list.show(),this.onUpdateInfo(),b8e.evt.onC(this._skin.sure_btn,this.onHidePanel,this)},onHide:function(){this._list&&(this._list.setData(null),this._list.hide()),b8e.evt.offC(this._skin.sure_btn,this.onHidePanel,this)},onUpdateInfo:function(){this._list.setData(this.data)},onHidePanel:function(){this.hide()}})},{}],139:[function(e,t,i){"use strict";e("./BackEquipPanel"),e("./BackGoodsPanel"),e("./BackSmeltPanel"),e("./BackPanel"),e("./ItemTips")},{"./BackEquipPanel":133,"./BackGoodsPanel":134,"./BackPanel":135,"./BackSmeltPanel":136,"./ItemTips":137}],140:[function(e,t,i){"use strict";var n=game.BackSender=function(){};n.bagRequest=function(){var e=game.pbmid.Bag.BagRequest;b8e.sendN(e)},n.useItemRequest=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=game.pbmsg.UseItemRequest;n.idx=e,n.num=t,n.selectId=i,engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Bag.UseItemRequest;b8e.sendN(s)},n.reqSellEquip=function(e){var t=game.pbmsg.SellEquipRequest;t.idxs=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Bag.SellEquipRequest;b8e.sendN(i)}},{}],141:[function(e,t,i){"use strict";e("./BackSender")},{"./BackSender":140}],142:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_9"),e("./event/eventIndex_12"),e("./manager/managerIndex_17"),e("./panel/panelIndex_28"),e("./sender/senderIndex_10")},{"./cmdlistener/cmdlistenerIndex_9":144,"./event/eventIndex_12":146,"./manager/managerIndex_17":148,"./panel/panelIndex_28":154,"./sender/senderIndex_10":156}],143:[function(e,t,i){"use strict";game.BeautyCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Beauty.BeautyModuleDataResponse,this.onBeautyModuleDataResponse,this),b8e.addNH(game.pbmid.Beauty.UnlockBeautyResponse,this.onUnlockBeautyResponse,this),b8e.addNH(game.pbmid.Beauty.UpgradeFavorResponse,this.onUpgradeFavorResponse,this),b8e.addNH(game.pbmid.Beauty.UseBeautyResponse,this.onUseBeautyResponse,this),b8e.addNH(game.pbmid.Beauty.BuyUseBeautyPowerResponse,this.onBuyUseBeautyPowerResponse,this),b8e.addNH(game.pbmid.Beauty.BeautyFollowResponse,this.onBeautyFollowResponse,this)},onBeautyModuleDataResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.BeautyModuleProto);game.beauty.setup(i)},onUnlockBeautyResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.UnlockBeautyResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.beauty.getBeauty(i.id)},onUpgradeFavorResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.UpgradeFavorResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.beauty.upgradeFavor(i.id)},onUseBeautyResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.UseBeautyResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.beauty.useBeauty(i)},onBuyUseBeautyPowerResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.BuyUseBeautyPowerResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.beauty.addBeautyPower(i.power,!0)},onBeautyFollowResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.BeautyFollowResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.beauty.updateFollow(i.id)}})},{}],144:[function(e,t,i){"use strict";e("./BeautyCmd")},{"./BeautyCmd":143}],145:[function(e,t,i){"use strict";game.BeautyEvent=b8e.Enum({SELECT_BEAUTY:b8e.Event.nextCode(),REFRESH_BEAUTY:b8e.Event.nextCode(),CHANGE_POWER:b8e.Event.nextCode(),CHANGE_BEAUTY_MODEL:b8e.Event.nextCode(),UPDATA_FOLLOW_BEAUTY:b8e.Event.nextCode()})},{}],146:[function(e,t,i){"use strict";e("./BeautyEvent")},{"./BeautyEvent":145}],147:[function(e,t,i){"use strict";game.BeautyMgr=b8e.Object.extends({name:"BeautyMgr",_beautyMap:null,curPower:0,buyPowerTimes:0,maxPower:3,_curBeautyId:0,isFirst:!0,_lockBeautyId:0,maxBuyPowerTimes:0,upgradeInfo:null,curFollowBeautyId:0,isShowBeautyAlert:!1,isRequest:!1,ctor:function(){if(1==game.BeautyMgr._singleton)throw new Error("BeautyMgr 只能通过单例方法获取");this._super(),this.init(),this._beautyMap=b8e.HashMap.get(),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.checkBeautyAlert),b8e.evt.addG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.checkBeautyAlert)},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.sendBeautyModule),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.sendBeautyModule),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.sendBeautyModule)},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.BEAUTY)&&(game.beauty.isRequest=!0,game.BeautySender.BeautyModuleDataRequest())},sendBeautyModule:function(){game.funcOpen.checkOpen(game.FunctionType.BEAUTY)&&(this.isRequest||(this.isRequest=!0,game.BeautySender.BeautyModuleDataRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.sendBeautyModule),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.sendBeautyModule),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.sendBeautyModule))},setup:function(e){if(e){this._beautyMap.clear();var t=e.beautyDatas;if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i];if(n){var s=new game.BeautyUnit;s.setup(n),this._beautyMap.set(s.id,s)}}this.curPower=e.power,this.buyPowerTimes=e.buyPowerTimes,this.maxPower=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.BEAUTY_MAX_POWER),this.curFollowBeautyId=e.followedBeauty,this.checkBeautyAlert()}},upgradeFavor:function(e){var t=this._beautyMap.get(e);t&&(t.favorLevel++,this._beautyMap.set(e,t),this.checkBeautyAlert(),b8e.evt.dptG(game.BeautyEvent.REFRESH_BEAUTY))},useBeauty:function(e){var t=this._beautyMap.get(e.id);t&&(t.usedTimes++,this.curPower=e.power,this._beautyMap.set(e.id,t),this.checkBeautyAlert(),b8e.evt.dptG(game.BeautyEvent.REFRESH_BEAUTY),b8e.evt.dptG(game.BeautyEvent.CHANGE_POWER),game.TriggerMgr.inst().cherishBeautyTrigger())},getBeauty:function(e){if(1!=this._beautyMap.has(e)){var t=new game.BeautyUnit;t.id=e,this._beautyMap.set(t.id,t),1==t.id&&game.BeautySender.BeautyFollowRequest(t.id),this.checkBeautyAlert(),b8e.evt.dptG(game.BeautyEvent.REFRESH_BEAUTY),b8e.evt.dptG(game.BeautyEvent.CHANGE_BEAUTY_MODEL),b8e.evt.dptG(game.DujieEvent.BEAUTY)}else b8e.log("已经获得这个美人!!!")},showBuyPower:function(){game.app.show(game.AppConstant.BEAUTY_BUY_POWER_PANEL)},buyPower:function(){if(this.curPower!=this.maxPower)if(this.maxBuyPowerTimes=game.vip.getBuyPowerTimes(),this.isBuyMaxTimes(this.maxBuyPowerTimes))game.gameAlert.showVipAlert(!1,100);else{var e=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.BUY_BEAUTY_COUNT,this.buyPowerTimes+1);e&&(this.upgradeInfo=e.upgradeInfo,this.upgradeInfo&&game.upgrade.costCheck(this,this.upgradeInfo,this.buyPowerCallBack,!0))}else game.notice.show(72008)},buyPowerCallBack:function(e){e&&game.BeautySender.BuyUseBeautyPowerRequest()},addBeautyPower:function(e){!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?(game.beauty.curPower=e,game.beauty.buyPowerTimes++):game.beauty.curPower+=e,game.beauty.checkBeautyAlert(),b8e.evt.dptG(game.BeautyEvent.CHANGE_POWER)},sendUseBeauty:function(e){game.BeautySender.UseBeautyRequest(e)},sendUpgradeFavor:function(e){game.BeautySender.UpgradeFavorRequest(e)},sendGetBeauty:function(e){game.BeautySender.UnlockBeautyRequest(e)},resetDaily:function(){this.buyPowerTimes=0,this.curPower=this.maxPower;var e=this.getBeautyMap();e&&(e.forEach(function(e,t){t&&(t.usedTimes=0)},this),this.checkBeautyAlert(),b8e.evt.dptG(game.BeautyEvent.REFRESH_BEAUTY),b8e.evt.dptG(game.BeautyEvent.CHANGE_POWER))},curBeautyId:{set:function(e){this._curBeautyId=e},get:function(){if(1==this.isFirst){this.isFirst=!1;var e=this.getSortBeauty();this.curBeautyId=e[0].id}return this._curBeautyId}},isBuyMaxTimes:function(e){return!(this.buyPowerTimes<e)},getBeautyById:function(e){var t=this._beautyMap.get(e);return t||null},getBeautyIsGetById:function(e){return this._beautyMap.has(e)},getBeautyMap:function(){return this._beautyMap?this._beautyMap:null},getSortBeauty:function(){var e=game.ccfg.BeautyDataCfg.getBeautyDatas();if(!e)return null;var t=e.values();return t.sort(this.onSortLevel),t},getBeautyUnlock:function(e){var t=game.mainRole.mainRoleData.getLv();return game.ccfg.BeautyDataCfg.getBeautyLevelById(e)<=t},lockBeautyId:{set:function(e){this._lockBeautyId=e},get:function(){return this._lockBeautyId}},setLockBeautyId:function(){var e=this.getSortBeauty(),t=game.mainRole.mainRoleData;if(e&&!(e.length<=0))for(var i=0;i<e.length;i++){var n=e[i];if(n&&t.getLv()<n.level)return void(this.lockBeautyId=n.id)}},getBeautyCombat:function(){var a=0;return this._beautyMap&&this._beautyMap.forEach(function(e,t){if(t){var i=t.id,n=t.favorLevel,s=game.ccfg.BeautyFavorCfg.getBeautyFightAmountById(i,n);a+=s}},this),a},getBeautyIsHasUseTimes:function(){var e=this.getBeautyMap();if(!e)return!1;var t=e.values();if(!t||t.length<=0)return!1;for(var i=0;i<t.length;i++){var n=t[i],s=game.ccfg.BeautyDataCfg.getBeautyInfoById(n.id);if(n.usedTimes<s.useTimes)return!0}return!1},getBeautyIsGet:function(){var e,t,i,n,s=game.back.getAmountInfo();if(!s)return!1;var a=s.getValue(game.AmountType.POPULARITY),o=game.ccfg.BeautyDataCfg.getBeautyDatas();if(!o)return null;var r=o.values();if(!r||r.length<=0)return!1;for(var h=0;h<r.length&&(t=r[h],i=this.getBeautyUnlock(t.id),n=this.getBeautyIsGetById(t.id),i);h++)if(!n&&i&&!n){if(a<t.reputation)continue;if(e=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(t.id,1),game.upgrade.isHasEnoughItem(e))return!0}return!1},getBeautyIsUpgrede:function(){if(!this._beautyMap)return!1;var e,t,i,n=this._beautyMap.values();if(!n||n.length<=0)return!1;for(var s=0;s<n.length;s++)if(t=n[s],!(0==(i=game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(t.id))||i<=t.favorLevel)&&(e=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(t.id,t.favorLevel+1),game.upgrade.isHasEnoughItem(e)))return!0;return!1},oneBeuutyAlertFilter:function(e){var t,i,n=game.back.getAmountInfo();if(!n)return!1;var s=n.getValue(game.AmountType.POPULARITY);if(!this.getBeautyUnlock(e))return!1;if(!(i=game.ccfg.BeautyDataCfg.getBeautyInfoById(e)))return!1;if(!this.getBeautyIsGetById(e))return!(s<i.reputation)&&(!!(t=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(i.id,1))&&!!game.upgrade.isHasEnoughItem(t));var a=this.getBeautyById(e);return!!a&&(a.usedTimes<i.useTimes||!(game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(a.id)<=a.favorLevel)&&(!!(t=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(a.id,a.favorLevel+1))&&!!game.upgrade.isHasEnoughItem(t)))},beautyIsItGet:function(e){var t=game.back.getAmountInfo();if(!t)return!1;var i=t.getValue(game.AmountType.POPULARITY),n=game.ccfg.BeautyDataCfg.getBeautyInfoById(e);if(!n)return!1;if(i<n.reputation)return!1;var s=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(n.id,1);return!!s&&!!game.upgrade.isHasEnoughItem(s)},beautyIsItUpgrade:function(e){var t=this.getBeautyById(e);if(!t)return!1;if(game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(t.id)<=t.favorLevel)return!1;var i=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(t.id,t.favorLevel+1);return!!i&&!!game.upgrade.isHasEnoughItem(i)},beautyIsItUse:function(e){var t=game.ccfg.BeautyDataCfg.getBeautyInfoById(e);if(!t)return!1;var i=this.getBeautyById(e);return!!i&&(!(this.curPower<=0)&&i.usedTimes<t.useTimes)},sendUpdateFollow:function(){0==this.curFollowBeautyId?game.BeautySender.BeautyFollowRequest(this.curBeautyId):0!=this.curFollowBeautyId&&this.curBeautyId!=this.curFollowBeautyId?game.BeautySender.BeautyFollowRequest(this.curBeautyId):game.BeautySender.BeautyFollowRequest(0)},updateFollow:function(e){this.curFollowBeautyId=e,b8e.evt.dptG(game.BeautyEvent.UPDATA_FOLLOW_BEAUTY)},onSortLevel:function(e,t){var i=game.beauty.getBeautyIsGetById(e.id),n=game.beauty.getBeautyIsGetById(t.id),s=!1,a=!1,o=!1;return 0==i&&(s=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(e.id,1),a=game.upgrade.isHasEnoughItem(s)),0==n&&(s=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(t.id,1),o=game.upgrade.isHasEnoughItem(s)),1==a&&1==o?e.quality<t.quality?-1:e.quality>t.quality?1:e.id>t.id?1:e.id<t.id?-1:0:1==a?-1:1==o?1:0==i&&0==n?e.quality<t.quality?-1:e.quality>t.quality?1:e.id>t.id?1:e.id<t.id?-1:0:0==i&&1==n?1:1==i&&0==n?-1:e.quality<t.quality?1:e.quality>t.quality?-1:e.id>t.id?-1:e.id<t.id?1:0},onRandomIndex:function(e){if(e<=0)return 0;var t=e+1;return Math.floor(Math.random()*t)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.BEAUTY_ALERT,null,this.beautyAlertFilter,this)},beautyAlertFilter:function(){return this.isShowBeautyAlert},checkBeautyAlert:function(){var e=!1;if(game.funcOpen.checkOpen(game.FunctionType.BEAUTY)){var t=this.getBeautyIsHasUseTimes(),i=this.getBeautyIsGet(),n=this.getBeautyIsUpgrede();if(t&&0<this.curPower&&(e=!0),!e){i=this.getBeautyIsGet(),n=this.getBeautyIsUpgrede();(i||n)&&(e=!0)}}this.isShowBeautyAlert=e}}),game.BeautyMgr._instance=null,game.BeautyMgr._singleton=!0,game.BeautyMgr.inst=function(){return game.BeautyMgr._instance||(game.BeautyMgr._singleton=!1,game.BeautyMgr._instance=new game.BeautyMgr,game.BeautyMgr._singleton=!0),game.BeautyMgr._instance}},{}],148:[function(e,t,i){"use strict";e("./BeautyMgr")},{"./BeautyMgr":147}],149:[function(e,t,i){"use strict";game.appModule.BeautyBuyPowerPanel=game.SkinUIPanel.extends({_amountInfo:null,_setDes:!1,ctor:function(e){this._super(e)},onShow:function(){0==this._setDes&&(this._skin.bossDes.string=game.ccfg.LangCfg.getText(10030),this._setDes=!0),this.setData(),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.onC(this._skin.bossDes.node,this.onClickDes,this),b8e.evt.addG(this,game.BeautyEvent.CHANGE_POWER,this.setData)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.offC(this._skin.bossDes.node,this.onClickDes,this),b8e.evt.rmvG(this,game.BeautyEvent.CHANGE_POWER,this.setData)},onClickDes:function(){game.TriggerMgr&&game.TriggerMgr.inst().customTriggerById(3137)},setData:function(){this.setBuyCount(),this.setCostItem()},setBuyCount:function(){var e="",t=game.vip.getBuyPowerTimes()-game.beauty.buyPowerTimes;e=0<t?"今日剩余购买次数："+game.html.getText(game.html.Q_GREEN,t):"今日剩余购买次数："+game.html.getText(game.html.Q_RED,t),this._skin.lab_buyCount.string=e},setCostItem:function(){var e=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.BUY_BEAUTY_COUNT,game.beauty.buyPowerTimes+1);if(e){var t=e.upgradeInfo;if(t&&(this._amountInfo=t.getAmountInfo(),this._amountInfo)){var i=this.getAmountStr(this._amountInfo),n=this._amountInfo.getFirstAmountType();return n==game.AmountType.SILVER&&(this._skin.img_yinbi.active=!0,this._skin.img_yuanbao.active=!1),n==game.AmountType.YUAN_BAO&&(this._skin.img_yinbi.active=!1,this._skin.img_yuanbao.active=!0),void(this._skin.lab_cost.string=i)}}},getAmountStr:function(e){var t="";if(e){var i=e.getAllTyps();if(i&&0<i.length){var n=e.getFirstAmountType(),s=e.getFirstAmountValue(),a=game.back.getAmountInfo();switch(n){case game.AmountType.SILVER:var o=a.getValue(game.AmountType.SILVER);0<s&&(t=s<=o?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]));break;case game.AmountType.YUAN_BAO:var r=a.getValue(game.AmountType.YUAN_BAO);0<s&&(t=s<=r?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]));break;case game.AmountType.POPULARITY:var h=a.getValue(game.AmountType.POPULARITY);0<s&&(t=s<=h?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]))}}}return t},onClickBuyBtn:function(){game.beauty.buyPower()}})},{}],150:[function(e,t,i){"use strict";game.BeautyGrid=game.SkinUI.extends({id:0,_beautyUnit:null,_iconSprite:null,_beautyInfo:null,_heartArr:null,ctor:function(){this._super("beauty/BeautyGridSkin","BeautyGridSkin"),this._heartArr=[]},getHeight:function(){return 130},getWidth:function(){return 100},onShow:function(){this._beautyInfo&&this.setData(this._beautyInfo),b8e.evt.onC(this._skin.node,this.onClick,this),b8e.evt.addG(this,game.BeautyEvent.UPDATA_FOLLOW_BEAUTY,this.setFollowStatus)},onHide:function(){this.clearIcon(),this.clearHeart(),b8e.evt.offC(this._skin.node,this.onClick,this),b8e.evt.rmvG(this,game.BeautyEvent.UPDATA_FOLLOW_BEAUTY,this.setFollowStatus)},setData:function(e){if(this._beautyInfo=e,this._beautyInfo){this._beautyUnit=game.beauty.getBeautyById(this._beautyInfo.id),this.id=this._beautyInfo.id;var t=game.beauty.curBeautyId;game.mainRole.mainRoleData;if(this._skin){b8e.ShaderUtil.setGray(this._skin.hearts_node,!0);var i=game.beauty.getBeautyUnlock(this._beautyInfo.id);if(this._skin.red_point.active=game.beauty.oneBeuutyAlertFilter(this._beautyInfo.id),this.setFollowStatus(),1==i){if(this.setImgIcon(this._beautyInfo.icon),this.setQuality(this._beautyInfo.quality),this.setUnlockLevel(!1),this.setUnlock(!1),game.beauty.getBeautyIsGetById(this._beautyInfo.id)){this._skin.hearts_node.active=!0,this._skin.img_yinying.active=!0,this.setName(!0,this._beautyInfo.name),b8e.ShaderUtil.reset(this._iconSprite),b8e.ShaderUtil.reset(this._skin.node,!0);for(var n=0;n<this._beautyUnit.favorLevel;n++){var s=this._skin.hearts[n];s&&b8e.ShaderUtil.reset(s,!0)}}else this._skin.img_yinying.active=!0,this.setName(!0,this._beautyInfo.name,!0),this._skin.hearts_node.active=!1,b8e.ShaderUtil.setGray(this._iconSprite),b8e.ShaderUtil.setGray(this._skin.node,!0)}else{var a=game.beauty.lockBeautyId;this.setImgIcon(this._beautyInfo.icon),this.setName(!1),this._skin.hearts_node.active=!1,this._skin.img_yinying.active=!1;var o=this._beautyInfo.id==a;this.setUnlock(!o),o?this.setUnlockLevel(!0,this._beautyInfo.level):this.setUnlockLevel(!1),b8e.ShaderUtil.setGray(this._iconSprite),b8e.ShaderUtil.setGray(this._skin.node,!0)}t==this.id?this._skin.img_select.active=!0:this._skin.img_select.active=!1}}},refreshData:function(){this._beautyInfo&&this.setData(this._beautyInfo)},setImgIcon:function(e){if(this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.setAnchor(.5,0),this._iconSprite.addToParent(this._skin.img_icon)),""!=e){var t=game.ClientCfg.getBeautyIconUrlByIconName(e);this._iconSprite.loadTexture(t,null,null,{useManifest:!1})}else this._iconSprite.unloadTexture()},setHeart:function(){if(this._beautyUnit){for(var e=game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(this._beautyUnit.id),t=0;t<e;t++){var i;t>=this._heartArr.length?(i=b8e.Sprite.get(),this._heartArr.push(i)):i=this._heartArr[t],game.resController.setImgSpriteFrame(i,game.ClientCfg.BEAUTY_ALAST_URL,"icon_heart"),i.setSize(19,18),i.setAnchor(.5,.5),i.addToParent(this._skin.node_heart),i.x=16*t-33.5,b8e.ShaderUtil.setGray(i,!0)}for(var n=0;n<this._beautyUnit.favorLevel;n++)(i=this._heartArr[n])&&b8e.ShaderUtil.reset(i,!0)}},clearHeart:function(){if(this._heartArr&&0<this._heartArr.length){for(var e=0;e<this._heartArr.length;e++)this._heartArr[e]&&this._heartArr[e].clear();this._heartArr.length=0}},setName:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._skin.lab_name.node.active=e,this._beautyInfo&&0!=e&&(this._skin.lab_name.string=1!=i?game.html.getText(game.html.getColorByQuality(this._beautyInfo.quality),t):game.html.getText(game.html.GRAY,t))},setUnlockLevel:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin.lab_lock.node.active=e,this._skin.lab_lock.string=t+"级解锁"},setUnlock:function(e){this._skin.img_lock.active=e},setQuality:function(e){var t=game.ClientCfg.BEAUTY_GRID_ALAST_URL;game.resController.setQualitySpriteFrame(this._skin.img_quality,e,t,game.ContainerId.BEAUTY_CONTAINER_ID)},clearIcon:function(){this._iconSprite&&this._iconSprite.unloadTexture()},setFollowStatus:function(){this._beautyInfo&&(this._skin.img_follow.active=this._beautyInfo.id==game.beauty.curFollowBeautyId)},onClick:function(){this._beautyInfo&&(game.beauty.curBeautyId!=this._beautyInfo.id&&(0==game.beauty.getBeautyUnlock(this._beautyInfo.id)?game.notice.show("该美人未解锁"):(game.beauty.curBeautyId=this._beautyInfo.id,b8e.evt.dptG(game.BeautyEvent.SELECT_BEAUTY))))}})},{}],151:[function(e,t,i){"use strict";game.appModule.BeautyPanel=game.SkinUIPanel.extends({_curBeauytId:0,_beautyUnit:null,_beautyInfo:null,_grayPowerArr:null,_redPowerArr:null,_talkTime:3e3,_beautyModel:null,_iconSprite:null,_iconSprite1:null,_bg:null,_prizeList1:null,_prizeInfo1:null,_prizeList2:null,_prizeList3:null,_prizeList4:null,_upgradeInfo:null,_costItemInfo:null,_amountInfo:null,_effect:null,_scene:null,_list:null,_str:"",_leftModelX:210,_middleModelX:295,ctor:function(e){this._super(e),this._prizeInfo1=new game.PrizeInfo,this._grayPowerArr=[],this._redPowerArr=[]},getButtonByName:function(e){switch(e){case"getBeauty":return!this._skin||this._skin.btn_getBeauty;case"use":return!this._skin||this._skin.btn_use;case"back":return!this._skin||this._skin.closeBtnReturn;case"follow":return!this._skin||this._skin.btn_follow;case"beauty":return!this._skin||this._skin.btn_beauty;case"favor":return!this._skin||this._skin.btn_favor}return null},setTab:function(e){return!!this._skin&&("0"==e?this.selectPage(0):"1"==e&&this.selectPage(1),!0)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.beauty_list,game.BeautyGrid,30)),this._list.show(),this.setPower(),this.beautyDatas(),this.setBaseBeautyInfo(),this.setBeautyInfo(),this.setBeautyFavorInfo(),this.setExplicit(),this._beautyUnit||this.selectPage(0),this._skin.img_talk.active=!1,this._skin.lab_talk.node.active=!1,b8e.evt.onC(this._skin.btn_upgrade,this.onUpgredeBtn,this),b8e.evt.onC(this._skin.btn_use,this.onUseBtn,this),b8e.evt.onC(this._skin.btn_getBeauty,this.onGetBeautyBtn,this),b8e.evt.onC(this._skin.btn_powerAdd,this.onPowerAddBtn,this),b8e.evt.onC(this._skin.btn_help,this.onHelpBtn,this),b8e.evt.onC(this._skin.lab_favorItem.node,this.onItemGetWay,this),b8e.evt.onC(this._skin.lab_needItem.node,this.onItemGetWay,this),b8e.evt.onC(this._skin.btn_follow,this.onFollowClick,this),b8e.evt.onC(this._skin.btn_beauty,this.onBeautyClick,this),b8e.evt.onC(this._skin.btn_favor,this.onFavorClick,this),b8e.evt.onC(this._skin.btn_help_2,this.onHelpBtn,this),b8e.evt.onC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.onC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.addG(this,game.BeautyEvent.SELECT_BEAUTY,this.selectBeauty),b8e.evt.addG(this,game.BeautyEvent.REFRESH_BEAUTY,this.refreshCurBeauty),b8e.evt.addG(this,game.BeautyEvent.CHANGE_POWER,this.setPower),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateByBackUpdate),b8e.evt.addG(this,game.BeautyEvent.UPDATA_FOLLOW_BEAUTY,this.updateFollowBtn)},onHide:function(){this.clearAnimator(),this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_upgrade,this.onUpgredeBtn,this),b8e.evt.offC(this._skin.btn_use,this.onUseBtn,this),b8e.evt.offC(this._skin.btn_getBeauty,this.onGetBeautyBtn,this),b8e.evt.offC(this._skin.btn_powerAdd,this.onPowerAddBtn,this),b8e.evt.offC(this._skin.btn_help,this.onHelpBtn,this),b8e.evt.offC(this._skin.lab_favorItem.node,this.onItemGetWay,this),b8e.evt.offC(this._skin.lab_needItem.node,this.onItemGetWay,this),b8e.evt.offC(this._skin.btn_follow,this.onFollowClick,this),b8e.evt.offC(this._skin.btn_beauty,this.onBeautyClick,this),b8e.evt.offC(this._skin.btn_favor,this.onFavorClick,this),b8e.evt.offC(this._skin.btn_help_2,this.onHelpBtn,this),b8e.evt.offC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.offC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.rmvG(this,game.BeautyEvent.SELECT_BEAUTY,this.selectBeauty),b8e.evt.rmvG(this,game.BeautyEvent.REFRESH_BEAUTY,this.refreshCurBeauty),b8e.evt.rmvG(this,game.BeautyEvent.CHANGE_POWER,this.setPower),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateByBackUpdate),b8e.evt.rmvG(this,game.BeautyEvent.UPDATA_FOLLOW_BEAUTY,this.updateFollowBtn)},clickLeftBtn:function(){this._list&&this._list.scrollLeft()},clickRightBtn:function(){this._list&&this._list.scrollRight()},init:function(){this._beautyModel||(this._beautyModel=b8e.SceneEntity.get(),this._beautyModel.addToParent(this._skin.model_beautyUnit)),this._prizeList1||(this._prizeList1=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList1.addToParent(this._skin.prize_list_item1)),this._prizeList2||(this._prizeList2=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList2.addToParent(this._skin.prize_list_item2)),this._prizeList3||(this._prizeList3=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList3.addToParent(this._skin.prize_list_item3)),this._prizeList4||(this._prizeList4=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList4.addToParent(this._skin.prize_list_item4)),this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.setAnchor(.5,1),this._iconSprite.addToParent(this._skin.img_beautyName)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(0,1),this._bg.addToParent(this._skin.img_bg));var e=game.ClientCfg.getBeautyIconUrlByIconName("bg",!0);this._bg.loadTexture(e,null,null,{useManifest:!1})},beautyDatas:function(){var e=game.beauty.getSortBeauty();game.beauty.setLockBeautyId(),this._list.setData(e)},refreshRedPoint:function(){var e=game.beauty.getBeautyUnlock(game.beauty.curBeautyId);if(this._skin.favor_red_point.active=!1,!e)return this._skin.get_red_point.active=!1,this._skin.use_red_point.active=!1,void(this._skin.upgrade_red_point.active=!1);if(!game.beauty.getBeautyIsGetById(game.beauty.curBeautyId)){this._skin.use_red_point.active=!1,this._skin.upgrade_red_point.active=!1;var t=game.beauty.beautyIsItGet(game.beauty.curBeautyId);return this._skin.get_red_point.active=t,void(this._skin.beauty_red_point.active=t)}this._skin.get_red_point.active=!1;var i=game.beauty.beautyIsItUpgrade(game.beauty.curBeautyId);this._skin.upgrade_red_point.active=i;var n=game.beauty.beautyIsItUse(game.beauty.curBeautyId);this._skin.use_red_point.active=n,this._skin.favor_red_point.active=i,this._skin.beauty_red_point.active=n},updateByBackUpdate:function(){this._upgradeInfo&&(this.setBeautyFavorInfo(),this.setBeautyInfo(),this.refreshRedPoint())},setBaseBeautyInfo:function(){this._curBeauytId=game.beauty.curBeautyId,this._beautyUnit=game.beauty.getBeautyById(this._curBeauytId),this._beautyInfo=game.ccfg.BeautyDataCfg.getBeautyInfoById(this._curBeauytId)},setExplicit:function(){if(this._beautyInfo){var e;""!=this._beautyInfo.nameRes?(e=game.ClientCfg.getBeautyNameUrlByIconName(this._beautyInfo.nameRes),this._iconSprite.loadTexture(e,null,null,{useManifest:!1})):this._iconSprite.unloadTexture(),e=game.ClientCfg.getBeauty(this._beautyInfo.res);var t=this._beautyModel.getAnimator(game.AnimatorType.BODY,1);e?(t||(t=this._beautyModel.addAnimator(game.AnimatorType.BODY,1,-10)),t.load(e),t.play()):t&&t.clear()}},setBeautyInfo:function(){var e;this._skin.lab_attr.string="",this._skin.lab_skill_desc.string="",this._str="";var t=0;if(this._beautyInfo){if(this.updateFollowBtn(),0==game.beauty.getBeautyIsGetById(this._beautyInfo.id)){var i=game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(this._beautyInfo.id);if(e=game.ccfg.BeautyFavorCfg.getBeautyInfoById(this._beautyInfo.id,i),this._upgradeInfo=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(this._beautyInfo.id,1),this._upgradeInfo){var n=this._upgradeInfo.getCostItemList();if(n&&0<n.length){var s=this._upgradeInfo.getFirstUpgradeInfo();if(s){var a=this._upgradeInfo.getFirstUpgradeInfoId(),o=this._upgradeInfo.getFirstUpgradeInfoName(),r=this._upgradeInfo.getFirstUpgradeInfoNum();if(this._costItemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(s.id),this._costItemInfo){var h=game.upgrade.isHasEnoughItem(this._upgradeInfo);this._str=h?[["<u>"+o+"</u>  ",game.html.getColorByQuality(this._costItemInfo.quality)],[game.back.getItemInfoCountById(a),game.html.Q_GREEN],["/"+r,game.html.Q_WHITE]]:[["<u>"+o+"</u>  ",game.html.getColorByQuality(this._costItemInfo.quality)],[game.back.getItemInfoCountById(a),game.html.Q_RED],["/"+r,game.html.Q_WHITE]],this._skin.lab_needItem.string=game.html.getColorfulText(this._str)}}}}this._skin.unlock_node.active=!1,this._skin.lock_node.active=!0}else{this._beautyUnit=game.beauty.getBeautyById(this._beautyInfo.id),e=game.ccfg.BeautyFavorCfg.getBeautyInfoById(this._beautyUnit.id,this._beautyUnit.favorLevel),this._skin.unlock_node.active=!0,this._skin.lock_node.active=!1,this._skin.lab_favor_left.string=game.ccfg.LangCfg.getText(72007,[this._beautyUnit.favorLevel]);var g=this._skin.img_favor_level.length;for(t=0;t<g;t++)t<this._beautyUnit.favorLevel?b8e.ShaderUtil.reset(this._skin.img_favor_level[t]):b8e.ShaderUtil.setGray(this._skin.img_favor_level[t]);this._skin.btn_use.active=!0,this._skin.lab_used.active=!1,this._beautyUnit.usedTimes>=this._beautyInfo.useTimes&&(this._skin.btn_use.active=!1,this._skin.lab_used.active=!0)}if(this._skin.lab_skill_desc.string=this._beautyInfo.followEffectDesc,e){var l=e.basePrize;0!=l&&(this._prizeInfo1.setupById(l),this._prizeList1.setData(this._prizeInfo1)),this._skin.lab_beautyCombat.string=e.fightAmount;var c,u=game.ccfg.SpriteStatCfg.getSpriteStatById(e.attrId);this._str="";var m=u.getSpriteStats();for(t=0;t<m.length;t++){var _=m[t];_&&(c=this.getAttrStr(_),this._str=this._str+c)}this._skin.lab_attr.string=this._str}}},setBeautyFavorInfo:function(){this._str="";var e,t=0,i=0;if(this._beautyInfo&&this._beautyUnit){if(this._upgradeInfo=game.ccfg.BeautyFavorCfg.getBeautyUpgradeInfo(this._beautyUnit.id,this._beautyUnit.favorLevel+1),this._upgradeInfo){this._skin.btn_upgrade.active=!0,this._skin.favor_level_max_node.active=!1,this._skin.favor_level_node.active=!0;var n=this._upgradeInfo.getCostItemList();if(n&&0<n.length){var s=this._upgradeInfo.getFirstUpgradeInfo();if(s){var a=this._upgradeInfo.getFirstUpgradeInfoId(),o=this._upgradeInfo.getFirstUpgradeInfoName(),r=this._upgradeInfo.getFirstUpgradeInfoNum();if(this._costItemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(s.id),this._costItemInfo){var h=game.upgrade.isHasEnoughItem(this._upgradeInfo);this._str=h?[["<u>"+o+"</u> ",game.html.getColorByQuality(this._costItemInfo.quality)],[game.back.getItemInfoCountById(a),game.html.Q_GREEN],["/"+r,game.html.Q_WHITE]]:[["<u>"+o+"</u> ",game.html.getColorByQuality(this._costItemInfo.quality)],[game.back.getItemInfoCountById(a),game.html.Q_RED],["/"+r,game.html.Q_WHITE]],this._skin.lab_favorItem.string=game.html.getColorfulText(this._str),this._skin.lab_favor_right.string=game.ccfg.LangCfg.getText(72007,[this._beautyUnit.favorLevel])}}}}else this._skin.btn_upgrade.active=!1,this._skin.favor_level_max_node.active=!0,this._skin.favor_level_node.active=!1;var g=game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(this._beautyUnit.id),l=game.ccfg.BeautyFavorCfg.getBeautyInfoById(this._beautyUnit.id,this._beautyUnit.favorLevel);if(this._str="",l){var c=game.ccfg.SpriteStatCfg.getSpriteStatById(l.attrId).getSpriteStats();for(t=0;t<c.length;t++){(_=c[t])&&(m=this.getAttrStr(_,t%2),this._str=this._str+m)}}if(e=l.basePrize,this._beautyUnit.favorLevel<g){for(this._skin.cur_attr_node.active=!0,this._skin.next_attr_node.active=!0,this._skin.max_attr_node.active=!1,this._skin.cur_lab_attr.string=this._str,this._skin.cur_attr_combat.string=l.fightAmount,i=this._skin.cur_favor_level.length,t=0;t<i;t++)g<=t&&(this._skin.cur_favor_level[t].active=!1),t<this._beautyUnit.favorLevel?b8e.ShaderUtil.reset(this._skin.cur_favor_level[t]):b8e.ShaderUtil.setGray(this._skin.cur_favor_level[t]);0!=e&&(this._prizeInfo1.setupById(e),this._prizeList2.setData(this._prizeInfo1));var u=game.ccfg.BeautyFavorCfg.getBeautyInfoById(this._beautyUnit.id,this._beautyUnit.favorLevel+1);if(this._str="",u){var m;c=game.ccfg.SpriteStatCfg.getSpriteStatById(u.attrId).getSpriteStats();for(t=0;t<c.length;t++){var _;(_=c[t])&&(m=this.getAttrStr(_,t%2,!0),this._str=this._str+m)}for(this._skin.next_lab_attr.string=this._str,this._skin.next_attr_combat.string=u.fightAmount,i=this._skin.next_favor_level.length,t=0;t<i;t++)g<=t&&(this._skin.next_favor_level[t].active=!1),t<this._beautyUnit.favorLevel+1?b8e.ShaderUtil.reset(this._skin.next_favor_level[t]):b8e.ShaderUtil.setGray(this._skin.next_favor_level[t]);0!=(e=u.basePrize)&&(this._prizeInfo1.setupById(e),this._prizeList3.setData(this._prizeInfo1))}}else{for(this._skin.cur_attr_node.active=!1,this._skin.next_attr_node.active=!1,this._skin.max_attr_node.active=!0,this._skin.max_lab_attr.string=this._str,this._skin.max_attr_combat.string=l.fightAmount,i=this._skin.max_favor_level.length,t=0;t<i;t++)g<=t&&(this._skin.max_favor_level[t].active=!1),t<this._beautyUnit.favorLevel?b8e.ShaderUtil.reset(this._skin.max_favor_level[t]):b8e.ShaderUtil.setGray(this._skin.max_favor_level[t]);0!=e&&(this._prizeInfo1.setupById(e),this._prizeList4.setData(this._prizeInfo1))}}},updateFollowBtn:function(){game.beauty.curFollowBeautyId==this._curBeauytId?this._skin.lab_follow.string=game.ccfg.LangCfg.getText(72004):this._skin.lab_follow.string=game.ccfg.LangCfg.getText(72005)},setPower:function(){var e=game.beauty.maxPower,t=game.beauty.curPower;this._skin.lab_power.string=game.ccfg.LangCfg.getText(72006,[t,e]),this.refreshRedPoint()},playEffect:function(){var e=game.ClientCfg.getUIFxs("10013");e?(this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.MAIN_QUEST_COMPLETE_EFFECT,1),this._effect.addFinishCallback(this.callback,this),this._effect.addToParent(this._skin.model_beautyUnit)),this._effect.setVisible(!0),this._effect.load(e),this._effect.play(null,0)):this._anim&&this._anim.clear()},callback:function(){this._effect&&this._effect.setVisible(!1)},clearAnimator:function(){this._anim&&this._anim.clear()},setBg:function(e){var t;this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(0,1),this._bg.addToParent(this._skin.img_bg)),t=e?game.ClientCfg.getBeautyIconUrlByIconName("bg",!0):game.ClientCfg.getBeautyIconUrlByIconName("bg1",!0),this._bg.loadTexture(t,null,null,{useManifest:!1})},selectBeauty:function(){this.beautyDatas(),this.setBaseBeautyInfo(),this.setBeautyInfo(),this.setBeautyFavorInfo(),this.setExplicit(),this.selectPage(0),this.refreshRedPoint()},refreshCurBeauty:function(){this.beautyDatas(),this.setBaseBeautyInfo(),this.setBeautyInfo(),this.setBeautyFavorInfo(),this.refreshRedPoint()},startTalk:function(e){var t,i;switch(e){case game.BeautyTalkType.UNLOCKTALK:t=game.ccfg.BeautyDataCfg.getBeautyUnlockTalkById(this._curBeauytId);break;case game.BeautyTalkType.UPGRADETALK:t=game.ccfg.BeautyDataCfg.getBeautyUpgradeTalkById(this._curBeauytId);break;case game.BeautyTalkType.USETALK:t=game.ccfg.BeautyDataCfg.getBeautyUseTalkById(this._curBeauytId)}t&&0<t.length&&(i=t[game.beauty.onRandomIndex(t.length-1)]),i&&this._skin&&(this._skin.img_talk.active=!0,this._skin.lab_talk.node.active=!0,this._skin.lab_talk.string=i,b8e.Tween.get(this).wait(this._talkTime).call(this.endTalk))},endTalk:function(){this._skin&&(this._skin.img_talk.active=!1,this._skin.lab_talk.node.active=!1,this._skin.lab_talk.string="")},onUpgredeBtn:function(){this._upgradeInfo&&game.upgrade.costCheck(this,this._upgradeInfo,this.onUpgredeIsPass)},onUpgredeIsPass:function(e){e?(this.startTalk(game.BeautyTalkType.UPGRADETALK),game.beauty.sendUpgradeFavor(this._curBeauytId)):game.notice.show(72001)},onUseBtn:function(){game.beauty.curPower<=0?game.notice.show(72002):this._beautyUnit.usedTimes<this._beautyInfo.useTimes&&(this.startTalk(game.BeautyTalkType.USETALK),this.playEffect(),game.beauty.sendUseBeauty(this._curBeauytId))},onFavorClick:function(){this.selectPage(1)},onBeautyClick:function(){this.selectPage(0)},selectPage:function(e){switch(e){case 0:this._skin.img_beauty_check.active=!0,this._skin.img_favor_check.active=!1,this._skin.beauty_node.active=!0,this._skin.favor_node.active=!1,this._skin.model_beautyUnit.x=this._leftModelX;break;case 1:if(!game.beauty.getBeautyIsGetById(this._curBeauytId))return void game.notice.show(72003);this._skin.img_beauty_check.active=!1,this._skin.img_favor_check.active=!0,this._skin.beauty_node.active=!1,this._skin.favor_node.active=!0,this._skin.model_beautyUnit.x=this._middleModelX}},onGetBeautyBtn:function(){var e=game.back.getAmountInfo();e&&(e.getValue(game.AmountType.POPULARITY)<this._beautyInfo.reputation?this.onGetBeautyIsPass(!1):this._upgradeInfo&&game.upgrade.costCheck(this,this._upgradeInfo,this.onGetBeautyIsPass))},onGetBeautyIsPass:function(e){e?game.beauty.sendGetBeauty(this._curBeauytId):this.startTalk(game.BeautyTalkType.UNLOCKTALK)},getAttrStr:function(e){var t,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return t=2<arguments.length&&void 0!==arguments[2]&&arguments[2]?game.html.Q_GREEN:game.html.Q_WHITE,i?game.html.getText(game.html.LIGHT_YELLOW,game.ccfg.AttrRulesCfg.getAttrNameByType(e.type))+" "+game.html.getText(t,e.value)+"<br/>":game.html.getText(game.html.LIGHT_YELLOW,game.ccfg.AttrRulesCfg.getAttrNameByType(e.type))+" "+game.html.getText(t,e.value)+" "},onPowerAddBtn:function(){game.beauty.showBuyPower()},onHelpBtn:function(){game.app.show(game.AppConstant.BEAUTY_PRIZE_PANEL)},onFollowClick:function(){game.beauty.sendUpdateFollow()},onItemGetWay:function(){if(this._upgradeInfo){var e,t=this._upgradeInfo.getFirstUpgradeInfo();t&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(t.id,!0))&&e instanceof game.ItemInfo&&e&&""!=e.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e,num:e.num})}}})},{}],152:[function(e,t,i){"use strict";game.appModule.BeautyPrizePanel=game.SkinUIPanel.extends({_beautyInfo:null,_favorPrizeArr:null,ctor:function(e){this._super(e),this._favorPrizeArr=[]},onShow:function(){this.setup()},onHide:function(){},setup:function(){for(var e,t=game.beauty.curBeautyId,i=game.ccfg.BeautyFavorCfg.getMaxBeautyFavorLevel(t),n=0;n<i;n++){n>=this._favorPrizeArr.length?(e=new game.FavorPrizePanel,this._favorPrizeArr.push(e)):e=this._favorPrizeArr[n];var s=game.ccfg.BeautyFavorCfg.getBeautyInfoById(t,n+1);e.setSize(420,85),e.setAnchor(.5,1),e.setup(s),e.show(),e.addToParent(this._skin.list.content)}this._beautyInfo=game.ccfg.BeautyDataCfg.getBeautyInfoById(t),this._beautyInfo&&(this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._beautyInfo.quality),this._beautyInfo.name)+"赠礼")}})},{}],153:[function(e,t,i){"use strict";game.FavorPrizePanel=game.SkinUI.extends({_beautyFavor:null,_prizeList1:null,_prizeInfo1:null,_prizeList2:null,_prizeInfo2:null,ctor:function(){this._super("beauty/FavorPrizeSkin","FavorPrizeSkin"),this._beautyGridArr=[],this._prizeInfo1=new game.PrizeInfo,this._prizeInfo2=new game.PrizeInfo},onShow:function(){this._beautyFavor&&this.setup(this._beautyFavor)},onHide:function(){},clearLabel:function(){this._skin.lab_favor_level.string=""},setup:function(e){if(this._beautyFavor=e,this._skin&&this._beautyFavor){this._prizeList1||(this._prizeList1=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList1.addToParent(this._skin.img_prize_1));var t=this._beautyFavor.basePrize;0!=t&&(this._prizeInfo1.setupById(t),this._prizeList1.setData(this._prizeInfo1)),this._prizeList2||(this._prizeList2=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList2.addToParent(this._skin.img_prize_2));var i=this._beautyFavor.randomPrize;0!=i&&(this._prizeInfo2.setupById(i),this._prizeList2.setData(this._prizeInfo2)),1==this._beautyFavor.level&&(this._skin.img_line.active=!1),this._skin.lab_favor_level.string="亲密等级"+this._beautyFavor.level}}})},{}],154:[function(e,t,i){"use strict";e("./BeautyGrid"),e("./BeautyPanel"),e("./BeautyPrizePanel"),e("./FavorPrizePanel")},{"./BeautyGrid":150,"./BeautyPanel":151,"./BeautyPrizePanel":152,"./FavorPrizePanel":153}],155:[function(e,t,i){"use strict";var n=game.BeautySender=function(){};n.BeautyModuleDataRequest=function(){var e=game.pbmid.Beauty.BeautyModuleDataRequest;b8e.sendN(e)},n.UnlockBeautyRequest=function(e){var t=game.pbmsg.UnlockBeautyRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Beauty.UnlockBeautyRequest;b8e.sendN(i)},n.UpgradeFavorRequest=function(e){var t=game.pbmsg.UpgradeFavorRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Beauty.UpgradeFavorRequest;b8e.sendN(i)},n.UseBeautyRequest=function(e){var t=game.pbmsg.UseBeautyRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Beauty.UseBeautyRequest;b8e.sendN(i)},n.BuyUseBeautyPowerRequest=function(){var e=game.pbmid.Beauty.BuyUseBeautyPowerRequest;b8e.sendN(e)},n.BeautyFollowRequest=function(e){var t=game.pbmsg.BeautyFollowRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Beauty.BeautyFollowRequest;b8e.sendN(i)}},{}],156:[function(e,t,i){"use strict";e("./BeautySender")},{"./BeautySender":155}],157:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_1"),e("./event/eventIndex_1"),e("./manager/managerIndex_1"),e("./panel/panelIndex_1"),e("./sender/senderIndex_1")},{"./cmdlistener/cmdlistenerIndex_1":159,"./event/eventIndex_1":161,"./manager/managerIndex_1":163,"./panel/panelIndex_1":191,"./sender/senderIndex_1":193}],158:[function(e,t,i){"use strict";game.BianshenCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Char.QryBianshenModuleModelResponse,this.onQryBianshenModuleModelResponse,this),b8e.addNH(game.pbmid.Char.IntoBattleSlotResponse,this.onIntoBattleSlotResponse,this),b8e.addNH(game.pbmid.Char.OffBattleSlotResponse,this.onOffBattleSlotResponse,this),b8e.addNH(game.pbmid.Char.NewBianshensNotify,this.onNewBianshensNotify,this),b8e.addNH(game.pbmid.Char.AddExpForBianshenResponse,this.onAddExpForBianshenResponse,this),b8e.addNH(game.pbmid.Char.UpgradeBianshenJieResponse,this.onUpgradeBianshenJieResponse,this),b8e.addNH(game.pbmid.Char.UpdateBianshenProtectStateResponse,this.onUpdateBianshenProtectStateResponse,this),b8e.addNH(game.pbmid.Char.SwapBattleSlotBianshensResponse,this.onSwapBattleSlotBianshensResponse,this),b8e.addNH(game.pbmid.Char.ChangeShapeResponse,this.onChangeShapeResponse,this),b8e.addNH(game.pbmid.Char.SelfShapeStateNotify,this.onSelfShapeStateNotify,this),b8e.addNH(game.pbmid.Char.ChangeShapeNotify,this.onChangeShapeNotify,this),b8e.addNH(game.pbmid.Char.FetterInfoResponse,this.onFetterInfoResponse,this),b8e.addNH(game.pbmid.Char.FetterUnlockResponse,this.onFetterUnlockResponse,this),b8e.addNH(game.pbmid.Char.ResolveBianshenResponse,this.onResolveBianshenResponse,this),b8e.addNH(game.pbmid.Char.ConvertBianshenResponse,this.onConvertBianshenResponse,this),b8e.addNH(game.pbmid.Char.ActivateBianshenResponse,this.onActivateBianshenResponse,this)},onChangeShapeNotify:function(e){},onSelfShapeStateNotify:function(e){var t=e.readProtobuf(game.pbmsg.SelfShapeStateNotify);t&&game.ShapeShiftMgr.inst().serverShape(t)},onChangeShapeResponse:function(e){var t=e.readProtobuf(game.pbmsg.ChangeShapeResponse);if(t){game.ShapeShiftMgr.inst().unlockSend();var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ShapeShiftMgr.inst().shapeComplete(t)}},onQryBianshenModuleModelResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.QryBianshenModuleModelResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):(game.bianshen.synBianshenItemInfo(i.bianshens),game.bianshen.sysBianshenActiveInfo(i.activeBianshens),game.bianshen.sysBianshenFetterInfo(i.bianshenFetter),game.bianshen.synBianshenSlotInfo(i.battleSlots))},onIntoBattleSlotResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.IntoBattleSlotResponse),n=i.code,s=i.index,a=i.bianshenId,o=i.offBianshenId;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.bianshen.updateBianshenSlotInfo(s,a,o)},onOffBattleSlotResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.OffBattleSlotResponse),n=i.code,s=i.index;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.bianshen.updateBianshenSlotInfo(s)},onSwapBattleSlotBianshensResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.SwapBattleSlotBianshensResponse),n=i.code,s=(i.index1,i.index1BianshenId,i.index2,i.index2BianshenId,i.slot1),a=i.slot2;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.bianshen.swapBianshenSlotComplete(s,a)},onNewBianshensNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NewBianshensNotify).bianshens;game.bianshen.addBianshenInfo(i)},onAddExpForBianshenResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.AddExpForBianshenResponse),n=i.code,s=i.bianshenId,a=i.lv,o=i.exp,r=i.costBianshenIds;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.bianshen.AddExpForBianshenComplete(s,a,o,r)},onUpgradeBianshenJieResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.UpgradeBianshenJieResponse),n=i.code,s=i.bianshenId,a=i.jie,o=i.costBianshenIds;0<n?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)),game.bianshen.isJinjieing=!1):game.bianshen.UpgradeBianshenJieComplete(s,a,o)},onUpdateBianshenProtectStateResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.UpdateBianshenProtectStateResponse),n=i.code,s=i.bianshenId,a=i.isProteced;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.bianshen.setBianshenProtected(s,a)},onFetterInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.FetterInfoResponse);0<t.code&&game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))},onFetterUnlockResponse:function(e){var t=e.readProtobuf(game.pbmsg.FetterUnlockResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.bianshen.unLockFetter(t)},onResolveBianshenResponse:function(e){var t=e.readProtobuf(game.pbmsg.ResolveBianshenResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.bianshen.resolveBianshenSuccess(t)},onConvertBianshenResponse:function(e){var t=e.readProtobuf(game.pbmsg.ConvertBianshenResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.bianshen.convertBianshenResponse(t)},onActivateBianshenResponse:function(e){var t=e.readProtobuf(game.pbmsg.ActivateBianshenResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.bianshen.rpActivateBianshen(t.bianshen,t.costBianshenId)}})},{}],159:[function(e,t,i){"use strict";e("./BianshenCmd")},{"./BianshenCmd":158}],160:[function(e,t,i){"use strict";game.BianshenEvent=b8e.Enum({INTO_BATTLE_SLOT:b8e.Event.nextCode(),OFF_BATTLE_SLOT:b8e.Event.nextCode(),START_BIANSHEN:b8e.Event.nextCode(),UPDATE_LOCK_SLOT_STATUS:b8e.Event.nextCode(),BATTLE_SELECT:b8e.Event.nextCode(),DETAILS_SELECT:b8e.Event.nextCode(),UPDATE_BACK:b8e.Event.nextCode(),BIANSHEN_UPGRADE:b8e.Event.nextCode(),BIANSHEN_JINJIE:b8e.Event.nextCode(),BIANSHEN_CHANGE_PROTECTE:b8e.Event.nextCode(),SELECT_MATERIAL:b8e.Event.nextCode(),BIANSHEN_MATERIAL_SELECT_COMPLETE:b8e.Event.nextCode(),BIANSHEN_JIE_MATERIAL_SELECT_COMPLETE:b8e.Event.nextCode(),BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE:b8e.Event.nextCode(),AUTO_SELECT_TYPE_COMPLETE:b8e.Event.nextCode(),SET_BIANSHEN_SLOT:b8e.Event.nextCode(),SELECT_BIANSHEN:b8e.Event.nextCode(),SWAP_BIANSHEN:b8e.Event.nextCode(),UPDATE_BATTLE_BACK:b8e.Event.nextCode(),UPDATE_AUTOSHAPE_BTN:b8e.Event.nextCode(),BIANSHEN_UPGRADE_SHOW_EFFECT:b8e.Event.nextCode(),SPOT_ALERT_STATE_CHANGE:b8e.Event.nextCode(),UPDATE_BIANSHEN_ARCHIVE:b8e.Event.nextCode(),UNLOCK_BIANSHEN_FETTER:b8e.Event.nextCode(),SELECT_BIANSHEN_RESOLVE:b8e.Event.nextCode(),BIANSHEN_RESOLVE_SUCCESS:b8e.Event.nextCode(),UI_BIANSHEN_SELECTED:b8e.Event.nextCode(),BIANSHEN_ACTIVE_SUCCESS:b8e.Event.nextCode()})},{}],161:[function(e,t,i){"use strict";e("./BianshenEvent")},{"./BianshenEvent":160}],162:[function(e,t,i){"use strict";game.BianshenMgr=b8e.Object.extends({name:"BianshenMgr",_bianshenList:null,_bianshenMap:null,_bianshenActiveMap:null,_bianshenProtoIdMap:null,_bianshenShapeTimeMap:null,_battleSlots:null,_bianshenShowList:null,_bianshenShowMap:null,_bianshenBattleSelectMap:null,_bianshenMaterialMap:null,_bianshenMaterialOnceMap:null,_costItemOnceMap:null,_costItemMap:null,_selectMaterialCount:0,_selectMaterialMaxCount:0,_curBianshenIdx:0,_curBianshenId:0,_autoSelectType:game.BianshenAutoSelectType.ITEM,selectStarMap:null,selectWuxingMap:null,selectBattleWuxingMap:null,selectBattleStarMap:null,_bianshenMaxCount:0,isJinjieing:!1,_battleCount:0,bianshenArchive:null,archiveShowMap:null,selectArchiveWuxingMap:null,selectArchiveStarMap:null,_fetterMap:null,_slots:null,_selectResolveBianshenList:null,_upgradeInfo:null,gameAlertInfo:null,curOpenServerDay:0,curConvertTypeMap:null,resolveList:null,_bianshenBarList:null,ctor:function(){if(1==game.BianshenMgr._singleton)throw new Error("BianshenMgr 只能通过单例方法获取");this._super(),this._bianshenList=[],this._battleSlots=[],this._bianshenSelectList=[],this._bianshenShowList=[],this.selectStarList=b8e.HashMap.get(),this.selectWuxingList=b8e.HashMap.get(),this._bianshenMap=b8e.HashMap.get(),this._bianshenActiveMap=b8e.HashMap.get(),this._bianshenMaterialMap=b8e.HashMap.get(),this._bianshenMaterialOnceMap=b8e.HashMap.get(),this._costItemMap=b8e.HashMap.get(),this._costItemOnceMap=b8e.HashMap.get(),this._bianshenShowMap=b8e.HashMap.get(),this.selectStarMap=b8e.HashMap.get(),this.selectWuxingMap=b8e.HashMap.get(),this._bianshenBattleSelectMap=b8e.HashMap.get(),this.selectBattleWuxingMap=b8e.HashMap.get(),this.selectBattleStarMap=b8e.HashMap.get(),this._bianshenProtoIdMap=b8e.HashMap.get(),this._bianshenShapeTimeMap=b8e.HashMap.get(),this.bianshenArchive=[],this.archiveShowMap=b8e.HashMap.get(),this._slots=[],this.selectArchiveWuxingMap=b8e.HashMap.get(),this.selectArchiveStarMap=b8e.HashMap.get(),this._fetterMap=b8e.HashMap.get(),this._selectResolveBianshenList=[],this.curConvertTypeMap=b8e.HashMap.get(),this.resolveList=[],this._bianshenBarList=b8e.HashMap.get(),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.updataLockSlotStatus)},synBianshenItemInfo:function(e){var t,i,n=0;if(this._bianshenMap.clear(),this._bianshenShowMap.clear(),e&&0<e.length){var s=e.length;for(n=0;n<s;n++){var a=e[n];(t=game.ItemInfoUtil.createBianshenInfo(a))&&(this._bianshenMap.set(t.idx,t),this._bianshenShowMap.set(t.idx,t),this._bianshenShapeTimeMap.set(t.id,t.cdTime),(i=this._bianshenProtoIdMap.get(t.id))?i++:i=1,this._bianshenProtoIdMap.set(t.id,i))}}this.setBianshenSelectMap(),this.setBianshenMaxCount(),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)},synBianshenSlotInfo:function(e){var t,i=0;this._battleSlots.length=0,this._battleCount=0;var n=!1,s=null;if(e&&0<e.length)for(e.sort(this.sortSlot),i=0;i<e.length;i++){var a=e[i];t=game.ItemInfoUtil.createBianshenSlotInfo(a),this._battleSlots.push(t),0<t.bianshenId&&((s=this.getBianshenInfoById(t.bianshenId))&&(s.battle=!0),this._battleCount++,n=!0)}b8e.evt.dptG(game.BianshenEvent.SET_BIANSHEN_SLOT),n&&game.TriggerMgr.inst().bianShenBattleTrigger(),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)},sortSlot:function(e,t){return e.index-t.index},sysBianshenActiveInfo:function(e){if(!e||e.length<=0)this.initBarDatas();else{var t;this._bianshenActiveMap.clear(),this._bianshenBattleSelectMap.clear();for(var i=e.length-1;0<=i;i--)(t=game.ItemInfoUtil.createBianshenInfo(e[i]))&&(t.active=!0,this._bianshenActiveMap.set(t.id,t),this._bianshenBattleSelectMap.set(t.idx,t));this.initBarDatas()}},rqActivateBianshen:function(e){game.BianshenSender.ActivateBianshenRequest(e)},rpActivateBianshen:function(e,t){if(e){var i=game.ItemInfoUtil.createBianshenInfo(e);if(i){var n;i.active=!0,this._bianshenActiveMap.set(i.id,i);var s=this._bianshenMap.get(t);s&&(this._bianshenShapeTimeMap.del(s.id),(n=this._bianshenProtoIdMap.get(s.id))&&(1<n?this._bianshenProtoIdMap.set(s.id,n-1):this._bianshenProtoIdMap.del(s.id))),this._bianshenShowMap.del(t),this._bianshenMap.del(t),this._bianshenBarList.del(i.id),this._bianshenBarList.set(i.id,i),this._bianshenBattleSelectMap.set(i.idx,i);var a=this.getEmptyBattleSlot();-1<a&&this.sendIntoBattleSlotRequest(i.id,a),this._curBianshenId=i.id,this._curBianshenIdx=i.idx,b8e.evt.dptG(game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS)}}},updateBianshenSlotInfo:function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;0!=s&&this.setBianshenBattle(s,!1);for(var a=!1,o=0;o<this._battleSlots.length;o++){var r=this._battleSlots[o];r&&r.index!=e||(0==r.bianshenId&&0!=n&&this._battleCount++,0==n?(t=r.bianshenId,i=!1,this._battleCount--):(t=n,i=!0),this.setBianshenBattle(t,i),r.bianshenId=n,this._battleSlots[o]=r,i?b8e.evt.dptG(game.BianshenEvent.INTO_BATTLE_SLOT,{slotIndex:e,idx:t,offIdx:s}):b8e.evt.dptG(game.BianshenEvent.OFF_BATTLE_SLOT,{slotIndex:e,idx:t}),0<r.bianshenId&&(a=!0))}a&&game.TriggerMgr.inst().bianShenBattleTrigger(),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)},setBianshenMaxCount:function(){this.bianshenMaxCount=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.BIANSHEN_MAX_COUNT)},swapBianshenSlot:function(e,t){var i=this._battleSlots[e];if(i&&0!=i.bianshenId){var n=this._battleSlots[t];n&&0!=n.bianshenId?game.BianshenSender.SwapBattleSlotBianshensRequest(e,t):game.notice.show(20001)}else game.notice.show(20001)},swapBianshenSlotComplete:function(e,t){if(this._battleSlots&&!(this._battleSlots.length<0)){for(var i=0;i<this._battleSlots.length;i++)this._battleSlots[i].index!=e.index?this._battleSlots[i].index==t.index&&(this._battleSlots[i]=t):this._battleSlots[i]=e;b8e.evt.dptG(game.BianshenEvent.SWAP_BIANSHEN)}},updataLockSlotStatus:function(){for(var e,t=0;t<this._battleSlots.length;t++)if((e=this._battleSlots[t])&&1!=e.isUnlocked){switch(t){case 0:e.isUnlocked=!0;break;case 1:e.isUnlocked=game.AchievementMgr.inst().isUnlockBianShenTwo();break;case 2:e.isUnlocked=game.AchievementMgr.inst().isUnlockBianShenThree();break;default:e.isUnlocked=!0}b8e.evt.dptG(game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,{slotIndex:e.index})}},setBianshenBattle:function(e,t){var i=this.getBianshenInfoById(e);i&&(i.battle=t)},updateBianshenSlot:function(e){for(var t=0;t<this._battleSlots.length;t++){var i=this._battleSlots[t];e.index==i.index&&(this._battleSlots[t]=e)}},autoSelectType:{set:function(e){this._autoSelectType=e},get:function(){return this._autoSelectType}},setCostItemMap:function(e){if(this._costItemMap.has(e)){var t=this._costItemMap.get(e);t++,this._costItemMap.set(e,t)}else this._costItemMap.set(e,1)},setCostItemOnceMapByCostItemMap:function(){this.clearCostItemOnceMap();var e=this._costItemMap.keys();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t],n=this._costItemMap.get(i);this._costItemOnceMap.set(i,n),this.selectMaterialCount+=n}},setCostItemOnceMap:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=game.back.getItemInfoById(e);if(!n)return!1;var s=n.num;if(s<=0)return!1;for(t=0;t<s;t++){if(this.getMaterialExpIsOver()){0==i&&t<1&&game.notice.show(20002);break}if(this.selectMaterialCount++,this.selectMaterialCount>this.selectMaterialMaxCount){this.selectMaterialCount--,0==i&&t<1&&game.notice.show(20003);break}this._costItemOnceMap.set(e,t+1)}b8e.evt.dptG(game.BianshenEvent.SELECT_MATERIAL)},delCostItemOnceMap:function(e){if(this._costItemOnceMap.has(e)){var t=this._costItemOnceMap.get(e);this.selectMaterialCount-=t,this._costItemOnceMap.del(e),b8e.evt.dptG(game.BianshenEvent.SELECT_MATERIAL)}},setBianshenMaterial:function(e){var t=this.getBackBianshenInfoByIdx(e);t&&this._bianshenMaterialMap.set(e,t)},setBianshenOnceMaterialByBianshenMaterial:function(){this.clearBianshenOnceMaterial(),this._bianshenMaterialMap.forEach(function(e,t){t&&(this._bianshenMaterialOnceMap.set(t.idx,t),this.selectMaterialCount++)},this)},setBianshenOnceMaterial:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=(3<arguments.length&&void 0!==arguments[3]&&arguments[3],this.getBackBianshenInfoByIdx(e));return!!n&&(n.battle?(0==i&&game.notice.show(20004),!1):n.isProtected?(0==i&&game.notice.show(20005),!1):this._bianshenMaterialOnceMap.has(e)?(this._bianshenMaterialOnceMap.del(e),this.selectMaterialCount--,b8e.evt.dptG(game.BianshenEvent.SELECT_MATERIAL),!1):t==game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID&&this.getMaterialExpIsOver()?(0==i&&game.notice.show(20006),!1):(this.selectMaterialCount++,this.selectMaterialCount>this.selectMaterialMaxCount?(0==i&&game.notice.show(20007),this.selectMaterialCount--,!1):(this._bianshenMaterialOnceMap.set(e,n),b8e.evt.dptG(game.BianshenEvent.SELECT_MATERIAL),!0)))},onClickGameAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},clearBianshenMaterial:function(){this._bianshenMaterialMap.clear()},clearBianshenOnceMaterial:function(){this._bianshenMaterialOnceMap.clear()},setBianshenArchive:function(){this.archiveShowMap=game.ccfg.BianshenCfg.getArchiveShowMap(),this.bianshenArchive=this.archiveShowMap.values()},updateArchiveByStar:function(e,t){if(this.bianshenArchive){for(var i=0;i<this.bianshenArchive.length;i++){var n=this.bianshenArchive[i];if(n.star==e)if(t){if(!this.selectArchiveWuxingMap.get(n.wuxing))continue;this.archiveShowMap.set(n.id,n)}else this.archiveShowMap.del(n.id)}t?this.selectArchiveStarMap.set(e,!0):this.selectArchiveStarMap.set(e,!1),b8e.evt.dptG(game.BianshenEvent.UPDATE_BIANSHEN_ARCHIVE)}},updateArchiveByWuxing:function(e,t){if(this.bianshenArchive){for(var i=0;i<this.bianshenArchive.length;i++){var n=this.bianshenArchive[i];if(n.wuxing==e)if(t){if(!this.selectArchiveStarMap.get(n.star))continue;this.archiveShowMap.set(n.id,n)}else this.archiveShowMap.del(n.id)}t?this.selectArchiveWuxingMap.set(e,!0):this.selectArchiveWuxingMap.set(e,!1),b8e.evt.dptG(game.BianshenEvent.UPDATE_BIANSHEN_ARCHIVE)}},getShowArchive:function(){return this.archiveShowMap.values()},getBianshenMaterial:function(){return this._bianshenMaterialMap},getBianshenOnceMaterial:function(){return this._bianshenMaterialOnceMap},clearCostItemMap:function(){this._costItemMap.clear()},clearCostItemOnceMap:function(){this._costItemOnceMap.clear()},getCostItemMap:function(){return this._costItemMap},getCostItemOnceMap:function(){return this._costItemOnceMap},getSelectMaterialIsHas:function(e){return this.getBianshenOnceMaterial().has(e)},getSelectItemIsHas:function(e){return this.getCostItemOnceMap().has(e)},getSelectItemCount:function(e){var t=this.getCostItemMap();return t.has(e)?t.get(e):0},getBianshenUpgradeMaterialCount:function(){var e=this.getCostItemMap();if(!e)return 0;var i=0;e.forEach(function(e,t){i+=t},this);var t=this.getBianshenMaterial().keys(),n=0;return t&&0<t.length&&(n=t.length),i+n},autoSelect:function(e){switch(this.selectMaterialCount=0,this.clearBianshenMaterial(),this.clearCostItemMap(),e){case game.BianshenAutoSelectType.ITEM:this.autoSelectBianshen(3);break;case game.BianshenAutoSelectType.FOURSTAR:this.autoSelectBianshen(4)}},autoSelectBianshen:function(e){var t,i,n=game.back.getBianshenMaterialList();if(n&&0<n.length)for(var s=0;s<n.length;s++){var a=n[s];this.setCostItemOnceMap(a.id,1)}if(this._bianshenList=this.getBianshenBackList(),this._bianshenList&&0<this._bianshenList.length&&this._bianshenList.sort(this.onSortBianshen),this._bianshenList&&0<this._bianshenList.length)for(s=0;s<this._bianshenList.length;s++){var o=this._bianshenList[s];if(!(o.star>e))if(!o.battle)if(!o.isProtected)if(o.idx!=this._curBianshenIdx)if(0==this.setBianshenOnceMaterial(o.idx,game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID,1))break}if(0==this.selectMaterialCount&&game.notice.show(20008),this.clearCostItemMap(),(i=(t=this.getCostItemOnceMap()).keys())&&0<i.length){for(s=0;s<i.length;s++){if(g=i[s])for(var r=t.get(g),h=0;h<r;h++)this.setCostItemMap(g)}this.clearCostItemOnceMap()}if(this.clearBianshenMaterial(),(i=(t=this.getBianshenOnceMaterial()).keys())&&0<i.length){for(s=0;s<i.length;s++){var g=i[s];this.setBianshenMaterial(g)}this.clearBianshenOnceMaterial()}b8e.evt.dptG(game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE)},autoSelectItem:function(){var e=game.back.getBianshenMaterialList();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];this.setCostItemOnceMap(i.id,1)}this.clearCostItemMap();var n=this.getCostItemOnceMap(),s=n.keys();if(s&&0<s.length){for(t=0;t<s.length;t++)for(var a=s[t],o=n.get(a),r=0;r<o;r++)this.setCostItemMap(a);this.clearCostItemOnceMap()}b8e.evt.dptG(game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE)},autoSelectJinjieBianshen:function(){this._bianshenList=this.getBianshenBackList(),this._bianshenList&&0<this._bianshenList.length&&this._bianshenList.sort(this.onSortBianshen);var e=this.getBianshenIdByIdx(this._curBianshenIdx),t=this.selectMaterialCount=0;if(this._bianshenList&&0<this._bianshenList.length)for(var i=0;i<this._bianshenList.length;i++){var n=this._bianshenList[i];if(t=n.star,!n.battle)if(!n.isProtected)if(n.idx!=this._curBianshenIdx)if(n.id==e)if(n.jie!=t)if(0==this.setBianshenOnceMaterial(n.idx,game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID,1))break}this.clearBianshenMaterial();var s=this.getBianshenOnceMaterial().keys();if(s&&0<s.length){for(i=0;i<s.length;i++){var a=s[i];this.setBianshenMaterial(a)}this.clearBianshenOnceMaterial()}b8e.evt.dptG(game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE)},onSortBianshen:function(e,t){return 1==e.battle?1:1==t.battle?-1:1==e.isProtected?1:1==t.isProtected?-1:e.star>t.star?1:t.star<t.star?-1:e.jie>t.jie?1:t.jie<t.jie?-1:e.level>t.level?1:e.level<t.level?-1:e.exp<t.exp?1:e.exp<t.exp?-1:e.id>t.id?1:e.id<t.id?-1:0},setBianshenProtected:function(e,t){var i=this.getBianshenInfoByidx(e);i&&(i.isProtected=t,this._bianshenMap.set(e,i),b8e.evt.dptG(game.BianshenEvent.BIANSHEN_CHANGE_PROTECTE,{bianshenId:e}),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE))},AddExpForBianshenComplete:function(e,t,i,n){var s=this.getBianshenInfoById(e);if(s){var a=s.level,o=0;if(a<t)o=game.ccfg.BianshenUpgradeLvCfg.getBianshenMaxUpExp(a,t-1,s.quality)-s.exp+i;else o=i-s.exp;game.notice.show(100010,[o]),s.level=t,s.exp=i;for(var r=0;r<n.length;r++){var h=n[r],g=this.getBackBianshenIdByIdx(h),l=this._bianshenProtoIdMap.get(g);l&&(1<l?(l--,this._bianshenProtoIdMap.set(g,l)):this._bianshenProtoIdMap.del(g)),this._bianshenMap.del(h),this.delBianshenSelectMap(h)}this.clearBianshenMaterial(),this.clearBianshenOnceMaterial(),this.clearCostItemMap(),this.clearCostItemOnceMap(),b8e.evt.dptG(game.BianshenEvent.BIANSHEN_UPGRADE,{bianshenId:e}),b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK),a<t&&b8e.evt.dptG(game.BianshenEvent.BIANSHEN_UPGRADE_SHOW_EFFECT),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)}},UpgradeBianshenJieComplete:function(e,t,i){var n=this.getBianshenInfoById(e);if(n){n.jie=t;for(var s=0;s<i.length;s++){var a=i[s],o=this.getBianshenIdByIdx(a),r=this._bianshenProtoIdMap.get(o);r&&(1<r?(r--,this._bianshenProtoIdMap.set(o,r)):this._bianshenProtoIdMap.del(o)),this._bianshenMap.del(a),this.delBianshenSelectMap(a)}this.clearBianshenMaterial(),this.clearBianshenOnceMaterial(),b8e.evt.dptG(game.BianshenEvent.BIANSHEN_JINJIE,i.length),b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)}},sendIntoBattleSlotRequest:function(e,t){if(this.getBianshenInfoById(e)){game.SysTime.curTime,this._bianshenShapeTimeMap.get(e);game.BianshenSender.IntoBattleSlotRequest(t,e)}},updataBianshenCdTime:function(e,t){this._bianshenShapeTimeMap.set(e,t)},sendOffBattleSlotRequest:function(e){game.BianshenSender.OffBattleSlotRequest(e)},sendaddExpForBianshenRequest:function(e,t,i){i=[];var n,s=(g=this.getBianshenMaterial()).keys(),a=!1,o=!1;if(s&&0<s.length)for(var r=0;r<s.length;r++){var h=0|s[r];(n=this.getBackBianshenInfoByIdx(h))&&(a||(a=0<n.jie),o||(o=1<n.level),i.push(h))}t=[];var g,l=(g=this.getCostItemMap()).keys();if(l&&0<l.length)for(var c=0;c<l.length;c++){var u=0|l[c],m=g.get(u);for(r=0;r<m;r++)t.push(u)}i.length<=0&&t.length<=0?game.notice.show(20009):a||o?(this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo),this.gameAlertInfo.clearInfo(),this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=1==a?game.ccfg.LangCfg.getText(20013):game.ccfg.LangCfg.getText(20029),this.gameAlertInfo.obj={bianshenId:e,costMaterialIds:t,costBianshenIds:i},this.gameAlertInfo.isShowTips=!0,this.gameAlertInfo.isSelectTips=!1,game.gameAlert.showAlert(this,this.onUpgradeAlert,this.gameAlertInfo)):game.BianshenSender.AddExpForBianshenRequest(e,t,i)},onUpgradeAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.BianshenSender.AddExpForBianshenRequest(e.obj.bianshenId,e.obj.costMaterialIds,e.obj.costBianshenIds);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sendupdateBianshenProtectStateRequest:function(e,t){game.BianshenSender.UpdateBianshenProtectStateRequest(e,t)},sendupgradeBianshenJieRequest:function(e,t){game.BianshenSender.UpgradeBianshenJieRequest(e,t)},setBianshenSelectMap:function(){this.selectWuxingMap.set(game.BianshenWuxingType.JIN,!0),this.selectWuxingMap.set(game.BianshenWuxingType.MU,!0),this.selectWuxingMap.set(game.BianshenWuxingType.SHUI,!0),this.selectWuxingMap.set(game.BianshenWuxingType.TU,!0),this.selectWuxingMap.set(game.BianshenWuxingType.HUO,!0),this.selectBattleWuxingMap.set(game.BianshenWuxingType.JIN,!0),this.selectBattleWuxingMap.set(game.BianshenWuxingType.MU,!0),this.selectBattleWuxingMap.set(game.BianshenWuxingType.SHUI,!0),this.selectBattleWuxingMap.set(game.BianshenWuxingType.TU,!0),this.selectBattleWuxingMap.set(game.BianshenWuxingType.HUO,!0),this.selectArchiveWuxingMap.set(game.BianshenWuxingType.JIN,!0),this.selectArchiveWuxingMap.set(game.BianshenWuxingType.MU,!0),this.selectArchiveWuxingMap.set(game.BianshenWuxingType.SHUI,!0),this.selectArchiveWuxingMap.set(game.BianshenWuxingType.TU,!0),this.selectArchiveWuxingMap.set(game.BianshenWuxingType.HUO,!0),this.selectStarMap.set(5,!0),this.selectStarMap.set(4,!0),this.selectStarMap.set(3,!0),this.selectStarMap.set(2,!0),this.selectBattleStarMap.set(5,!0),this.selectBattleStarMap.set(4,!0),this.selectBattleStarMap.set(3,!0),this.selectBattleStarMap.set(2,!0),this.selectArchiveStarMap.set(5,!0),this.selectArchiveStarMap.set(4,!0),this.selectArchiveStarMap.set(3,!0),this.selectArchiveStarMap.set(2,!0)},setBianshenByStar:function(e,t){var i=this.getBianshenBackList();if(i){for(var n=i.length,s=0;s<n;s++){var a=i[s];if(a.star==e)if(t){if(!this.selectWuxingMap.get(a.wuxing))continue;this._bianshenShowMap.set(a.idx,a)}else{if(1==a.battle)continue;this._bianshenShowMap.del(a.idx)}}t?this.selectStarMap.set(e,!0):this.selectStarMap.set(e,!1),b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK)}},setBattleBianshenByStar:function(e,t){var i=this.getBianshenActiveList();if(i&&!(i.length<=0)){for(var n=i.length,s=0;s<n;s++){var a=i[s];a.star==e&&(t?this.selectBattleWuxingMap.get(a.wuxing)&&this._bianshenBattleSelectMap.set(a.idx,a):a.battle||this._bianshenBattleSelectMap.del(a.idx))}this.selectBattleStarMap.set(e,t),b8e.evt.dptG(game.BianshenEvent.UPDATE_BATTLE_BACK)}},setBianshenByWuxing:function(e,t){var i=this.getBianshenBackList();if(i){for(var n=i.length,s=0;s<n;s++){var a=i[s];if(a.wuxing==e)if(t){if(!this.selectStarMap.get(a.star))continue;this._bianshenShowMap.set(a.idx,a)}else{if(1==a.battle)continue;this._bianshenShowMap.del(a.idx)}}t?this.selectWuxingMap.set(e,!0):this.selectWuxingMap.set(e,!1),b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK)}},setBattleBianshenByWuxing:function(e,t){var i=this.getBianshenActiveList();if(i&&!(i.length<=0)){for(var n=i.length,s=0;s<n;s++){var a=i[s];a.wuxing==e&&(t?this.selectBattleStarMap.get(a.star)&&this._bianshenBattleSelectMap.set(a.idx,a):a.battle||this._bianshenBattleSelectMap.del(a.idx))}this.selectBattleWuxingMap.set(e,t),b8e.evt.dptG(game.BianshenEvent.UPDATE_BATTLE_BACK)}},setBianshenByAllStar:function(e){var t=this.getBianshenBackList();if(t){var i=this.selectStarMap.keys();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];this.selectStarMap.set(s,e)}var a=t.length;for(n=0;n<a;n++){var o=t[n];if(e){if(!this.selectWuxingMap.get(o.wuxing))continue;this._bianshenShowMap.set(o.idx,o)}else{if(1==o.battle)continue;this._bianshenShowMap.del(o.idx)}}b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK)}},setBattleBianshenByAllStar:function(e){var t=this.getBianshenActiveList();if(t&&!(t.length<=0)){var i=this.selectBattleStarMap.keys();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];this.selectBattleStarMap.set(s,e)}var a=t.length;for(n=0;n<a;n++){var o=t[n];e?this.selectBattleWuxingMap.get(o.wuxing)&&this._bianshenBattleSelectMap.set(o.idx,o):1==!o.battle&&this._bianshenBattleSelectMap.del(o.idx)}b8e.evt.dptG(game.BianshenEvent.UPDATE_BATTLE_BACK)}},setBianshenByAllWuxing:function(e){var t=this.getBianshenBackList();if(t){var i=this.selectWuxingMap.keys();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];this.selectWuxingMap.set(s,e)}var a=t.length;for(n=0;n<a;n++){var o=t[n];if(e){if(!this.selectStarMap.get(o.star))continue;this._bianshenShowMap.set(o.idx,o)}else{if(1==o.battle)continue;this._bianshenShowMap.del(o.idx)}}b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK)}},setBattleBianshenByAllWuxing:function(e){var t=this.getBianshenActiveList();if(t&&!(t.length<=0)){var i=this.selectBattleWuxingMap.keys();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];this.selectBattleWuxingMap.set(s,e)}var a=t.length;for(n=0;n<a;n++){var o=t[n];e?this.selectBattleStarMap.get(o.star)&&this._bianshenBattleSelectMap.set(o.idx,o):o.battle||this._bianshenBattleSelectMap.del(o.idx)}b8e.evt.dptG(game.BianshenEvent.UPDATE_BATTLE_BACK)}},delBianshenSelectMap:function(e){this._bianshenShowMap.has(e)&&this._bianshenShowMap.del(e),this._bianshenBattleSelectMap.has(e)&&this._bianshenBattleSelectMap.del(e)},addBianshenSelectMap:function(e){0==this._bianshenShowMap.has(e.idx)&&(this.selectStarMap.get(e.star)&&this.selectWuxingMap.get(e.wuxing)&&this._bianshenShowMap.set(e.idx,e))},addBianshenInfo:function(e){if(e&&0<e.length){for(var t,i,n=0;n<e.length;n++){if(t=e[n],i=game.ItemInfoUtil.createBianshenInfo(t))if(this._bianshenShapeTimeMap.set(i.id,i.cdTime),1==this._bianshenMap.has(i.idx))b8e.log("已经有了相同的变身卡");else{this._bianshenMap.set(i.idx,i);var s=this._bianshenProtoIdMap.get(i.id);s?s++:s=1,this._bianshenProtoIdMap.set(i.id,s),this.addBianshenSelectMap(i),game.notice.show(1000001,[game.html.getText(game.html.getColorByQuality(i.quality),i.star+"星变身 "+i.name)]),game.TriggerMgr.inst().bianShenTrigger(i.star)}}b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)}},initResolveBianshenList:function(){this._selectResolveBianshenList.length=0},selectResolveBianshen:function(e){if(this.getBackBianshenInfoByIdx(e)){var t=!1,i=this._selectResolveBianshenList.indexOf(e);return-1!=i?this._selectResolveBianshenList.splice(i,1):(this._selectResolveBianshenList.push(e),t=!0),t}},sendResolveBianshen:function(){!this._selectResolveBianshenList||this._selectResolveBianshenList.length<=0?game.notice.show("没有可分解变身"):(this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo),this.gameAlertInfo.clearInfo(),this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=game.ccfg.LangCfg.getText("分解后的变身将消失</br>是否分解"),this.gameAlertInfo.isShowTips=!0,game.gameAlert.showAlert(this,this.onResolveAlert,this.gameAlertInfo))},onResolveAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.BianshenSender.ResolveBianshenRequest(this._selectResolveBianshenList);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sendConvertBianshen:function(e){var t=game.ccfg.BianshenConvertCfg.getDataById(e);if(t&&(this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.convertCost),game.upgrade.isHasEnoughItem(this._upgradeInfo,!0))){var i=game.ccfg.BianshenCfg.getDataById(t.protoId);if(!i)return;var n=this._upgradeInfo.getFirstUpgradeInfoName(),s=this._upgradeInfo.getFirstUpgradeInfoNum();this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo),this.gameAlertInfo.clearInfo(),this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=game.ccfg.LangCfg.getText("是否消耗$*$兑换$",[n,s,i.name]),this.gameAlertInfo.obj={id:e,upgradeInfo:this._upgradeInfo},this.gameAlertInfo.isShowTips=!0,game.gameAlert.showAlert(this,this.onConvertAlert,this.gameAlertInfo)}},onConvertAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.BianshenSender.ConvertBianshenRequest(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},resolveBianshenSuccess:function(e){if(e.idx){for(var t=e.idx.length,i=0;i<t;i++){var n=e.idx[i];this._bianshenMap.del(n),this.delBianshenSelectMap(n)}this._selectResolveBianshenList.length=0,b8e.evt.dptG(game.BianshenEvent.BIANSHEN_RESOLVE_SUCCESS)}},convertBianshenResponse:function(e){},getAddLv:function(e,t){var i=0,n=0,s=game.ccfg.BianshenUpgradeLvCfg.getMaxLv(),a=game.mainRole.mainRoleData.getLv();n=s<a?s:a;var o,r=a-e.level;t+=e.exp;for(var h=e.level;h<n;h++){if(!((o=game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(h,e.quality))<=t))return i;if(t-=o,r<=++i)return i}return i},getYulanExp:function(e,t){var i=0,n=0,s=game.ccfg.BianshenUpgradeLvCfg.getMaxLv(),a=game.mainRole.mainRoleData.getLv();n=s<a?s:a;var o,r=a-e.level;t+=e.exp;for(var h=e.level;h<n;h++){if(!((o=game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(h,e.quality))<=t))return t;if(t-=o,r<=++i)return game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(e.level+i,e.quality)-1}return t},getAttrCoef:function(e){for(var t=0,i=0;i<e;i++){t+=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(i+1).attrCoef}return t},selectMaterialCount:{set:function(e){this._selectMaterialCount=e},get:function(){return this._selectMaterialCount}},selectMaterialMaxCount:{set:function(e){this._selectMaterialMaxCount=e},get:function(){return this._selectMaterialMaxCount}},curBianshenIdx:{set:function(e){this._curBianshenIdx=e},get:function(){return this._curBianshenIdx}},curBianshenId:{set:function(e){this._curBianshenId=e},get:function(){return this._curBianshenId}},bianshenMaxCount:{set:function(e){this._bianshenMaxCount=e},get:function(){return this._bianshenMaxCount}},getJinjieMaterialByBianshen:function(e){for(var t=1,i=0;i<e;i++){t+=game.ccfg.BianshenUpgradeJieCfg.getCostBianshenNumberByJie(i)}return t},getBianshenBackList:function(){return this._bianshenMap.values()},getBianshenActiveList:function(){return this._bianshenActiveMap.values()},getBianshenBackCount:function(){return this._bianshenMap.count()},getBianshenShowList:function(){var e=this._bianshenShowMap.values();return e&&0<e.length?e:null},getBianshenShowListCount:function(){var e=this.getBianshenShowList();return e&&0<e.length?e.length:0},getBianshenBattleSelectList:function(e){this.getBattleSlotsByIndex(e),this._bianshenBattleSelectMap.values();var i=[];return this._bianshenBattleSelectMap.forEach(function(e,t){t.battle||i.push(t)},this),i},getBattleBianshenInfo:function(){for(var e,t,i=[],n=0;n<this._battleSlots.length;n++)(e=this._battleSlots[n])&&0<e.bianshenId&&(t=this.getBianshenInfoById(e.bianshenId))&&i.push(t);return i},getBattleSlots:function(){return this._battleSlots&&0<this._battleSlots.length?this._battleSlots:null},getBattleSlotsByIndex:function(e){for(var t=0;t<this._battleSlots.length;t++){var i=this._battleSlots[t];if(i&&i.index==e)return i}return null},getBattleSlotsIsEmptyBySlotIndex:function(e){for(var t=0;t<this._battleSlots.length;t++){var i=this._battleSlots[t];if(i&&i.index==e&&0==i.bianshenId&&i.isUnlocked)return!0}return!1},getEmptyBattleSlot:function(){if(this._battleSlots&&0<this._battleSlots.length)for(var e=0;e<this._battleSlots.length;e++){if(1==this.getBattleSlotsIsEmptyBySlotIndex(e))return e}return-1},getIsInBattleSlotByidx:function(e){return!!this.getBianshenSlotInfoByid(e)},getIsInBattleSlotByid:function(e){return!!this.getBianshenSlotInfoByid(e)},getBianshenSlotInfoByid:function(e){if(this._battleSlots&&0<this._battleSlots.length)for(var t,i=0;i<this._battleSlots.length;i++)if(e==(t=this._battleSlots[i]).bianshenId)return t;return null},getHasBianshenSlotIndex:function(){if(!this._battleSlots||this._battleSlots.length<0)return null;for(var e,t=0;t<this._battleSlots.length;t++)if(0!=(e=this._battleSlots[t]).bianshenId)return e.index;return null},getBianshenIdByIdx:function(e){var t=this.getBianshenInfoByidx(e);return t?t.id:0},getBianshenInfoByidx:function(e){for(var t=null,i=this._bianshenActiveMap.values(),n=i.length-1;0<=n;n--)if((t=i[n]).idx==e)return t;return null},getBianshenInfoById:function(e){return this._bianshenActiveMap.get(e)},getBackBianshenIdByIdx:function(e){var t=this.getBackBianshenInfoByIdx(e);return t?t.id:0},getBackBianshenInfoByIdx:function(e){return this._bianshenMap.get(e)},getBackBianshenInfoById:function(e){var t=this._bianshenMap.values();if(!t||t.length<=0)return null;for(var i=t.length;0<=i;i--)if(data[i].id==e)return data[i];return null},getMaxJieBianshenInfoById:function(e){return this.getBianshenInfoById(e)},getIsPermitUpgrade:function(e){var t=game.mainRole.mainRoleData.getLv(),i=game.ccfg.BianshenUpgradeLvCfg.getMaxLv();return i<=t?!(e.level>=i):e.level<t},getMaterialExpIsOver:function(){var e=this.curBianshenIdx,t=this.getBianshenInfoByidx(e);if(!t)return b8e.log("该变身不存在:"+e),!0;var i=game.mainRole.mainRoleData.getLv(),n=game.ccfg.BianshenUpgradeLvCfg.getBianshenMaxUpExp(t.level,i,t.quality)-t.exp,s=0;this._bianshenMaterialOnceMap.forEach(function(e,t){if(t){var i=game.ccfg.BianshenUpgradeLvCfg.getBianshenMaterialExp(t.level,t.quality),n=game.ccfg.BianshenCfg.getExpById(t.id);s=s+i+n}},this);var a=this._costItemOnceMap.keys();if(a&&0<a.length)for(var o=0;o<a.length;o++)for(var r=this._costItemOnceMap.get(a[o]),h=0;h<r;h++){var g=game.back.getItemInfoById(a[o]);if(g){var l=g.getEffectValueByType(game.ItemEffectType.BIANSHENEXP);s+=l}}return n<=s},getBianshenCombatByIdx:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=0;if(e){var n,s,a=game.ccfg.BianshenCfg.getAttrById(e.id),o=game.ccfg.SpriteStatCfg.getSpriteStatById(a),r=game.mainRole.mainRoleData.getLv(),h=game.ccfg.BianshenUpgradeLvCfg.getBianshenAttrCoefByLv(e.level),g=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(t),l=0,c=0,u=0,m=game.ccfg.LvPowerCoefCfg.getLvCoefByLv(r),_=0,d=o.getSpriteStats();if(d&&0<d.length)for(var f=0;f<d.length;f++)if(n=d[f]){if(c=game.bianshen.getFetterAttrCoef(e.id,n.type),s=game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(n.type))switch(_=game.ValueUtil.getDigitsValueByNum(s.coef,4),s.type){case game.AttrPowerCoefType.TYPE_0:u=n.value*_;break;case game.AttrPowerCoefType.TYPE_1:u=n.value*_*m}u=u*h*(g+c),l+=Math.round(u)}i=l+game.ccfg.BianshenCfg.getAttrBonusCoefById(e.id)*m}return~~i},getActiveCount:function(){return this._bianshenActiveMap?this._bianshenActiveMap.count():0},getActiveAllBianshenCombat:function(){if(!this._bianshenActiveMap||this._bianshenActiveMap.count()<=0)return 0;var i=0,n=0;return this._bianshenActiveMap.forEach(function(e,t){n=this.getBianshenCombatByIdx(t,t.jie),i+=n},this),~~i},getBattleAllBianshenCombat:function(){var e=this.getBattleSlots(),t=0;if(e&&0<e.length)for(var i,n,s=0;s<e.length;s++)i=e[s],(n=this.getBianshenInfoById(i.bianshenId))&&(t+=this.getBianshenCombatByIdx(n,n.jie));return~~t},getBianshenCdTime:function(e){var t=this._bianshenShapeTimeMap.get(e);return t||0},getIsJinjieByBianshenId:function(e){var t=this.getBianshenInfoById(e);if(!t)return!1;var i=game.ccfg.BianshenUpgradeJieCfg.getCostBianshenNumberByJie(t.jie),n=0,s=t.star;if(t.jie==s)return!1;var a=this.getBianshenBackList();if(!a||a.length<0)return!1;for(var o=a.length,r=0;r<o;r++){var h=a[r];if(!h.battle)if(!h.isProtected)if(h.idx!=t.idx)if(h.id==t.id)if(h.jie!=s)if(i<=(n+=this.getJinjieMaterialByBianshen(h.jie)))return!0}return!1},getIsUpgradeByBianshenId:function(e){var t=this.getBianshenInfoById(e);if(!t)return!1;if(!this.getIsPermitUpgrade(t))return!1;var i=game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(t.level,t.quality)-t.exp,n=0,s=0,a=game.back.getBianshenMaterialList();if(a&&0<a.length)for(s=0;s<a.length;s++){var o=a[s],r=o.getEffectValueByType(game.ItemEffectType.BIANSHENEXP);if(r&&!(r<0)&&i<=(n+=r*o.num))return!0}var h=this.getBianshenBackList();if(!h||h.length<0)return!1;var g=h.length;for(s=0;s<g;s++){var l=h[s];if(!l.battle)if(!l.isProtected)if(l.idx!=t.idx)if(!(3<l.star))if(i<=(n+=game.ccfg.BianshenCfg.getExpById(l.id)+game.ccfg.BianshenUpgradeLvCfg.getBianshenMaterialExp(l.level,l.quality)))return!0}return!1},getConvertBianshenList:function(e){var t=game.mainRole.mainRoleData.miscData.openServerDay;if(0==this.curOpenServerDay||this.curOpenServerDay!=t){this.curOpenServerDay=t,this.curConvertTypeMap.clear();var i,n=game.ccfg.BianshenConvertCfg.getDatas();if(!n||n.length<=0)return;for(var s=n.length,a=0;a<s;a++){var o=n[a];o.convertServerDays>this.curOpenServerDay||((i=this.curConvertTypeMap.get(o.type))||(i=[]),i.push(o),this.curConvertTypeMap.set(o.type,i))}this.curConvertTypeMap.forEach(function(e,t){t=t.sort(this.onConvertSort),this.curConvertTypeMap.set(e,t)},this)}return this.curConvertTypeMap.get(e)},onConvertSort:function(e,t){return e.convertServerDays-t.convertServerDays},getResolveList:function(){return this.resolveList.length=0,this._bianshenMap.forEach(function(e,t){t&&(t.battle||t.isProtected||!t.resolveAward||t.resolveAward.length<=0||this.resolveList.push(t))},this),this.resolveList},getResolveBianshenIsSelect:function(e){return-1!=this._selectResolveBianshenList.indexOf(e)},getSelectResolveList:function(){return this._selectResolveBianshenList},initBarDatas:function(){this._bianshenBarList.clear();for(var e,t,i=game.ccfg.BianshenCfg.getArchiveDatas(),n=i.length,s=0;s<n;s++)e=i[s],(t=this.getBianshenInfoById(e.id))||(t=e.obtainable?e:null),t&&this._bianshenBarList.set(t.id,t)},getBarDatas:function(){return this._bianshenBarList.values().sort(this.onSortBar)},onSortBar:function(e,t){if(e.battle&&t.battle){var i=game.bianshen.getBianshenSlotInfoByid(e.id),n=game.bianshen.getBianshenSlotInfoByid(t.id);return i.index-n.index}if(1==e.battle)return-1;if(1==t.battle)return 1;if(e.active&&t.active)return game.bianshen.sortBar(t,e);if(e.active)return-1;if(t.active)return 1;var s=game.bianshen.checkCanActive(e.id),a=game.bianshen.checkCanActive(t.id);return s&&a?e.sortId>t.sortId?-1:e.sortId<t.sortId?1:game.bianshen.sortBar(e,t):s?-1:a?1:e.sortId>t.sortId?-1:e.sortId<t.sortId?1:game.bianshen.sortBar(e,t)},sortBar:function(e,t){return e.star>t.star?1:e.star<t.star?-1:e.jie>t.jie?1:t.jie<t.jie?-1:e.level>t.level?1:e.level<t.level?-1:e.exp<t.exp?1:e.exp<t.exp?-1:e.id>t.id?1:e.id<t.id?-1:0},getBarDataById:function(e){return this._bianshenBarList.get(e)},getBianshenCount:function(e){var t=this._bianshenProtoIdMap.get(e);return t||0},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.BIANSHEN_FETTER_ALERT,null,this.checkAllBianshenAlert,this)},getSpotAlertState:function(){var e,t=this.getBattleSlots();if(!t||t.length<0)return!1;if(game.rune.isShowRedPoint())return!0;for(var i=0;i<t.length;i++){var n=t[i];if(0!=n.bianshenId)if(e=this.getBianshenInfoById(n.bianshenId),this.checkBianShenAlert(e))return!0}return!1},rqFetterUnlock:function(e,t,i){var n=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(t,i);if(n){var s=n.bianshenId;if(s&&!(s.length<=0)){var a=this.getAllMaxBianshenIdx(s);a&&game.BianshenSender.FetterUnlockRequest(e,t,i,a)}}},sysBianshenFetterInfo:function(e){if(e&&!(e.length<=0)){var t;this._fetterMap.clear();for(var i=0;i<e.length;i++)t=e[i],this._fetterMap.set(t.bianshenProtoId,t)}},unLockFetter:function(e){var t=this._fetterMap.get(e.bianshenProtoId);if(!t)return t={bianshenProtoId:e.bianshenProtoId,fetter:[{fetterType:e.fetterType,fetterLevel:e.fetterLevel}]},this._fetterMap.set(t.bianshenProtoId,t),void b8e.evt.dptG(game.BianshenEvent.UNLOCK_BIANSHEN_FETTER);for(var i,n=t.fetter.length,s=!1,a=0;a<n;a++)(i=t.fetter[a])&&i.fetterType==e.fetterType&&(i.fetterLevel=e.fetterLevel,s=!0);s||t.fetter.push({fetterType:e.fetterType,fetterLevel:e.fetterLevel}),b8e.evt.dptG(game.BianshenEvent.UNLOCK_BIANSHEN_FETTER)},getFetterLv:function(e,t){var i=this._fetterMap.get(e);if(!i)return 0;for(var n,s=i.fetter.length,a=0;a<s;a++)if((n=i.fetter[a])&&n.fetterType==t)return n.fetterLevel;return 0},getFetterAttrCoef:function(e,t){var i,n,s=this._fetterMap.get(e);if(!s)return 0;for(var a=0,o=s.fetter.length-1;0<=o;o--)(i=s.fetter[o])&&(n=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(i.fetterType,i.fetterLevel))&&n.attrType==t&&(a+=n.attrCoef);return a/100},getAllMaxBianshenIdx:function(e){var t,i=[];if(!Array.isArray(e))return null;for(var n=e.length-1;0<=n;n--){if(!(t=this.getMaxJieBianshenInfoById(e[n])))return null;i.push(t.idx)}return i},checkHasBianshen:function(e){var t=0;if(Array.isArray(e))for(var i=e.length-1;0<=i;i--)this.getMaxJieBianshenInfoById(e[i])&&t++;return t},checkBianshenJie:function(e,t){var i,n=0;if(Array.isArray(e))for(var s=e.length-1;0<=s;s--)(i=this.getMaxJieBianshenInfoById(e[s]))&&i.jie>=t&&n++;return n},getFetterCondition:function(e,t){var i=this.getFetterLv(e,t),n=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(t,i+1);if(!n)return 0;var s=n.bianshenId;if(!s||s.length<=0)return 0;var a=0;if(n.bianshenStar<=0){if((a=this.checkHasBianshen(s))==s.length)return s.length}else if((a=this.checkBianshenJie(s,n.bianshenStar))==s.length)return s.length;return a},checkFetterActiveOrLvUp:function(e,t){var i=this.getFetterLv(e,t),n=this.getFetterCondition(e,t),s=(game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(t,i),game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(t,i+1));if(!s)return!1;var a=s.bianshenId;return!(!a||a.length<=0)&&!(n<a.length)},checkFetterHasActiveOrLvUp:function(e){if(!game.funcOpen.checkOpen(game.FunctionType.FETTER))return!1;var t=game.ccfg.BianshenCfg.getFetterById(e);if(!t)return!1;for(var i,n=t.length,s=0;s<n;s++)if((i=t[s])<9999&&this.checkFetterActiveOrLvUp(e,i))return!0;return!1},checkHasBianshenFetterActiveOrLvUp:function(){if(!game.funcOpen.checkOpen(game.FunctionType.FETTER))return!1;for(var e,t=game.ccfg.BianshenCfg.datas.values(),i=t.length-1;0<=i;i--)if((e=t[i]).fetterType&&0<=e.fetterType.length&&this.checkFetterHasActiveOrLvUp(e.id))return!0;return!1},checkBianShenAlert:function(e){if(!e)return!1;if(!e.active&&this.checkCanActive(e.id))return!0;if(this.checkFetterHasActiveOrLvUp(e.id))return!0;if(this.getIsJinjieByBianshenId(e.id))return!0;if(this.getIsUpgradeByBianshenId(e.id))return!0;if(e.battle){var t=this.getBianshenSlotInfoByid(e.id);if(t&&(game.rune.getRuneAlertById(t.index+1)||game.rune.getRuneUpgradeAlertById(t.index+1)))return!0}return!1},checkAllBianshenAlert:function(){if(!this._bianshenBarList||this._bianshenBarList.count()<=0)return!1;for(var e,t=this._bianshenBarList.values(),i=(t.length,0);i<t.length;i++)if(e=t[i],this.checkBianShenAlert(e))return!0;return!1},checkCanBattle:function(e){return!(this.getEmptyBattleSlot()<0)&&!(!e||!e.active||e.battle)},checkCanActive:function(e){var t=this._bianshenProtoIdMap.get(e);return t&&0<t},showBianshenDetail:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;e&&(game.app.show(game.AppConstant.BIANSHEN_DETAILS_PANEL,t),this._curBianshenId=e.id,this._curBianshenIdx=e.idx,b8e.evt.dptG(game.BianshenEvent.UI_BIANSHEN_SELECTED,this._curBianshenId))}}),game.BianshenMgr._instance=null,game.BianshenMgr._singleton=!0,game.BianshenMgr.inst=function(){return game.BianshenMgr._instance||(game.BianshenMgr._singleton=!1,game.BianshenMgr._instance=new game.BianshenMgr,game.BianshenMgr._singleton=!0),game.BianshenMgr._instance}},{}],163:[function(e,t,i){"use strict";e("./BianshenMgr")},{"./BianshenMgr":162}],164:[function(e,t,i){"use strict";game.BianShenPackGrid=b8e.BaseDisplay.extends({_bianshenInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getWidth:function(){return 120},getHeight:function(){return 135},setData:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this._bianshenInfo=e,this._bianshenInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_BACK_CONTAINER_ID),this.addChild(this._itemGrid)),t&&this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setBianshenGrid(this._itemGrid,this._bianshenInfo,!1,!1,!1,!1,!0,!0,!0,!1),this._itemGrid.sortLayer())},onClick:function(e){game.notice.show(10305)},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],165:[function(e,t,i){"use strict";game.BianShenShowList=b8e.BaseDisplay.extends({_bsGrids:null,ctor:function(){this._super(),this._bsGrids=[]},setData:function(e){if(this.clearGrids(),e)for(var t,i,n,s=this._bsGrids.length,a=0;a<e.length;a++)(i=e[a])&&(a<s?n=this._bsGrids[a]:((n=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.CSARENA_RANK_BS_CONTAINER_ID),this.addChild(n),n.x=80*a,n.setScale(game.IconScale.PERCENT_67,game.IconScale.PERCENT_67),this._bsGrids.push(n)),t=game.ItemInfoUtil.createCommonBSInfo(i),game.GridUtil.setBianshenGrid(n,t),n.setName(""),n.sortLayer())},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setBianshenGrid(e,null)}})},{}],166:[function(e,t,i){"use strict";game.appModule.BianshenArchivePanel=game.SkinUIPanel.extends({_skin:null,_bianshenList:null,_bianshenGridArr:null,_selectBianshenLists:null,_battleSlotLists:null,_isBattleStatus:!1,list:null,_bianshenSelectPanel:null,_showSelect:!1,_bgSprite:null,ctor:function(e){this._super(e),this._bianshenList=[],this._bianshenGridArr=[]},init:function(){game.bianshen.setBianshenArchive(),this._list=new b8e.List(this._skin.list,game.BianshenPreviewGrid,4),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("bianshen/bianshenArchive"),null,null,{useManifest:!1})},onShow:function(){this._list.show(),this.updateBianshenArchive(),b8e.evt.onC(this._skin.fiveStarBtn.node,this.onClickFiveStarBtn,this),b8e.evt.onC(this._skin.fourStarBtn.node,this.onClickFourStarBtn,this),b8e.evt.onC(this._skin.threeStarBtn.node,this.onClickThreeStarBtn,this),b8e.evt.onC(this._skin.twoStarBtn.node,this.onClickTwoStarBtn,this),b8e.evt.onC(this._skin.jinBtn.node,this.onClickJinBtn,this),b8e.evt.onC(this._skin.muBtn.node,this.onClickMuBtn,this),b8e.evt.onC(this._skin.shuiBtn.node,this.onClickShuiBtn,this),b8e.evt.onC(this._skin.tuBtn.node,this.onClickTuBtn,this),b8e.evt.onC(this._skin.huoBtn.node,this.onClickHuoBtn,this),b8e.evt.addG(this,game.BianshenEvent.UPDATE_BIANSHEN_ARCHIVE,this.updateBianshenArchive),b8e.evt.addG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.updateBianshenArchive)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.fiveStarBtn.node,this.onClickFiveStarBtn,this),b8e.evt.offC(this._skin.fourStarBtn.node,this.onClickFourStarBtn,this),b8e.evt.offC(this._skin.threeStarBtn.node,this.onClickThreeStarBtn,this),b8e.evt.offC(this._skin.twoStarBtn.node,this.onClickTwoStarBtn,this),b8e.evt.offC(this._skin.jinBtn.node,this.onClickJinBtn,this),b8e.evt.offC(this._skin.muBtn.node,this.onClickMuBtn,this),b8e.evt.offC(this._skin.shuiBtn.node,this.onClickShuiBtn,this),b8e.evt.offC(this._skin.tuBtn.node,this.onClickTuBtn,this),b8e.evt.offC(this._skin.huoBtn.node,this.onClickHuoBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_BIANSHEN_ARCHIVE,this.updateBianshenArchive),b8e.evt.rmvG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.updateBianshenArchive)},updateBianshenArchive:function(){var e=game.bianshen.getShowArchive();e&&0<e.length&&e.sort(this.onSortBianshen),this._list.setData(e)},onSortBianshen:function(e,t){return 1==e.battle?-1:1==t.battle?1:e.star>t.star?-1:e.star<t.star?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?1:e.id<t.id?-1:0},onClickFiveStarBtn:function(){game.bianshen.updateArchiveByStar(5,this._skin.fiveStarBtn.isChecked)},onClickFourStarBtn:function(){game.bianshen.updateArchiveByStar(4,this._skin.fourStarBtn.isChecked)},onClickThreeStarBtn:function(){game.bianshen.updateArchiveByStar(3,this._skin.threeStarBtn.isChecked)},onClickTwoStarBtn:function(){game.bianshen.updateArchiveByStar(2,this._skin.twoStarBtn.isChecked)},onClickJinBtn:function(){game.bianshen.updateArchiveByWuxing(game.BianshenWuxingType.JIN,this._skin.jinBtn.isChecked)},onClickMuBtn:function(){game.bianshen.updateArchiveByWuxing(game.BianshenWuxingType.MU,this._skin.muBtn.isChecked)},onClickShuiBtn:function(){game.bianshen.updateArchiveByWuxing(game.BianshenWuxingType.SHUI,this._skin.shuiBtn.isChecked)},onClickTuBtn:function(){game.bianshen.updateArchiveByWuxing(game.BianshenWuxingType.TU,this._skin.tuBtn.isChecked)},onClickHuoBtn:function(){game.bianshen.updateArchiveByWuxing(game.BianshenWuxingType.HUO,this._skin.huoBtn.isChecked)}})},{}],167:[function(e,t,i){"use strict";game.BianshenAutoSelectPanel=game.SkinUI.extends({_autoSelectType:game.BianshenAutoSelectType.ITEM,_str:"",ctor:function(){this._super("bianshen/BianshenAutoSelectSkin","BianshenAutoSelectSkin")},onShow:function(){b8e.evt.onC(this._skin.btn_two_star,this.onClickTwoStarBtn,this),b8e.evt.onC(this._skin.btn_three_star,this.onClickThreeStarBtn,this),b8e.evt.onC(this._skin.btn_four_star,this.onClickFourStarBtn,this),b8e.evt.onC(this._skin.btn_item,this.onClickItemBtn,this),b8e.evt.onC(this,this.onClick,this),this.setAutoSelectType()},onHide:function(){b8e.evt.offC(this._skin.btn_two_star,this.onClickTwoStarBtn,this),b8e.evt.offC(this._skin.btn_three_star,this.onClickThreeStarBtn,this),b8e.evt.offC(this._skin.btn_four_star,this.onClickFourStarBtn,this),b8e.evt.offC(this._skin.btn_item,this.onClickItemBtn,this),b8e.evt.offC(this,this.onClick,this)},autoSelectType:{set:function(e){this._autoSelectType=e},get:function(){return this._autoSelectType}},onClick:function(){this.hide()},setAutoSelectType:function(){switch(this.autoSelectType=game.bianshen.autoSelectType,this._str="",this.autoSelectType){case game.BianshenAutoSelectType.ITEM:this._skin.img_four_star_auto_select.active=!1,this._skin.img_item_auto_select.active=!0,this._str=game.ccfg.LangCfg.getText(20026);break;case game.BianshenAutoSelectType.TWOSTAR:case game.BianshenAutoSelectType.THREESTAR:this._str=game.ccfg.LangCfg.getText(20027);break;case game.BianshenAutoSelectType.FOURSTAR:this._skin.img_four_star_auto_select.active=!0,this._skin.img_item_auto_select.active=!1,this._str=game.ccfg.LangCfg.getText(20027)}this._skin.lab_cur_select.string=this._str},onClickTwoStarBtn:function(){game.bianshen.autoSelectType=game.BianshenAutoSelectType.TWOSTAR,this.hide(),b8e.evt.dptG(game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE)},onClickThreeStarBtn:function(){game.bianshen.autoSelectType=game.BianshenAutoSelectType.THREESTAR,this.hide(),b8e.evt.dptG(game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE)},onClickFourStarBtn:function(){game.bianshen.autoSelectType=game.BianshenAutoSelectType.FOURSTAR,this.hide(),b8e.evt.dptG(game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE)},onClickItemBtn:function(){game.bianshen.autoSelectType=game.BianshenAutoSelectType.ITEM,this.hide(),b8e.evt.dptG(game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE)}})},{}],168:[function(e,t,i){"use strict";game.BianshenBackPanel=game.SkinUI.extends({_skin:null,_bianshenList:null,_bianshenGridArr:null,_selectBianshenLists:null,_battleSlotLists:null,_isBattleStatus:!1,list:null,_bianshenSelectPanel:null,_showSelect:!1,ctor:function(){this._super("bianshen/BianshenBackSkin","BianshenBackSkin"),this._bianshenList=[],this._bianshenGridArr=[],this._selectBianshenLists=[],this._battleSlotLists=[]},getButtonByName:function(e){switch(e){case"battleSlot0":return this._battleSlotLists[0]||!0;case"battleSlot1":return this._battleSlotLists[1]||!0;case"battleSlot2":return this._battleSlotLists[2]||!0;case"bianshenItem0":var t=this._list.getItemRender(0);if(t){var i=t.getItemGrid();if(i)return i}return!0;case"back":return!this._skin||this._skin.closeBtnReturn;case"autoShape":if(this._skin)return this._skin.autoShapeToggle.node}return null},init:function(){this._bianshenSelectPanel||(this._bianshenSelectPanel=new game.BianshenSelectPanel,this._bianshenSelectPanel.addToParent(this._skin.page))},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.BianShenPackGrid,4)),this._list.show(),this.onShowBianshenItem(),this.setSlot(),this._skin.btn_swap1&&this._skin.btn_swap2&&(b8e.evt.onC(this._skin.btn_swap1,this.swapBianshen1,this),b8e.evt.onC(this._skin.btn_swap2,this.swapBianshen2,this)),this.updateAutoShapeBtn(),this.onSpotAlertChange(),b8e.evt.onC(this._skin.img_select_on.node,this.onClickSelectBtn,this),b8e.evt.onC(this._skin.battleSelectBtn,this.onClickBattleSelect,this),b8e.evt.onC(this._skin.detailsSelectBtn,this.onClickDetailsSelect,this),b8e.evt.onC(this._skin.convertBtn,this.onClickConvertBtn,this),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updateBack),b8e.evt.addG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.updateBack),b8e.evt.addG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.updataLockSlotStatus),b8e.evt.addG(this,game.BianshenEvent.UPDATE_BACK,this.onShowBianshenItem),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateAllSlot),b8e.evt.addG(this,game.BianshenEvent.UPDATE_AUTOSHAPE_BTN,this.updateAutoShapeBtn),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.updateAllSlot),b8e.evt.addG(this,game.BianshenEvent.START_BIANSHEN,this.updateAllSlot),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_RESOLVE_SUCCESS,this.onShowBianshenItem)},onHide:function(){this.clearSlot(),this._showSelect=!1,this._bianshenSelectPanel.hide(),this._list&&this._list.hide(),this._skin.btn_swap1&&this._skin.btn_swap2&&(b8e.evt.offC(this._skin.btn_swap1,this.swapBianshen1,this),b8e.evt.offC(this._skin.btn_swap2,this.swapBianshen2,this)),b8e.evt.offC(this._skin.img_select_on.node,this.onClickSelectBtn,this),b8e.evt.offC(this._skin.battleSelectBtn,this.onClickBattleSelect,this),b8e.evt.offC(this._skin.detailsSelectBtn,this.onClickDetailsSelect,this),b8e.evt.offC(this._skin.convertBtn,this.onClickConvertBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updateBack),b8e.evt.rmvG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.updateBack),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.updataLockSlotStatus),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_BACK,this.onShowBianshenItem),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateAllSlot),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_AUTOSHAPE_BTN,this.updateAutoShapeBtn),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.updateAllSlot),b8e.evt.rmvG(this,game.BianshenEvent.START_BIANSHEN,this.updateAllSlot),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_RESOLVE_SUCCESS,this.onShowBianshenItem),game.setting.updateSetting()},onSpotAlertChange:function(){},onUnlockFetter:function(){this.onSpotAlertChange(),this.onShowBianshenItem()},swapBianshen1:function(){game.bianshen.swapBianshenSlot(0,1)},swapBianshen2:function(){game.bianshen.swapBianshenSlot(1,2)},onClickSelectBtn:function(){if(this._bianshenSelectPanel.isShow())this._bianshenSelectPanel.hide();else{var e=game.ContainerId.BIANSHEN_BACK_CONTAINER_ID;this._bianshenSelectPanel.setContainerId(e),this._bianshenSelectPanel.show()}},onClickBattleSelect:function(){this._isBattleStatus=!0,this._skin.battleSelectBtn.active=!1,this._skin.detailsSelectBtn.active=!0},onClickDetailsSelect:function(){this._isBattleStatus=!1,this._skin.battleSelectBtn.active=!0,this._skin.detailsSelectBtn.active=!1},clickGetBianshenNode:function(){game.draw.isArchive=!0},clickAutoShapeToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.AUTO_SHAPE,!e.getAutoShapeSelect())},onClickConvertBtn:function(){game.app.show(game.AppConstant.BIANSHEN_CONVERT_PANEL)},updateAutoShapeBtn:function(){game.setting.getAutoShapeSelect()?this._skin.autoShapeToggle.check():this._skin.autoShapeToggle.uncheck()},updataBianshenStatus:function(){var e=game.bianshen.getBattleSlots(),t=game.bianshen.getBianshenBackList();if(e&&0<e.length)for(var i=0;i<e.length;i++){if(e[i])(n=this._battleSlotLists[i])&&(n.battleStatus=this._isBattleStatus)}if(t&&0<t.length)for(i=0;i<t.length;i++){var n;if(t[i])(n=this._bianshenGridArr[i])&&(n.battleStatus=this._isBattleStatus)}},updateBianshenBack:function(){this.onShowBianshenItem()},onShowBianshenItem:function(){this._bianshenList=game.bianshen.getBianshenShowList();var e=game.bianshen.getBianshenBackCount(),t=game.bianshen.getBianshenShowListCount();this._bianshenList&&0<=this._bianshenList.length&&this._bianshenList.sort(this.onSortBianshen),this._list.setData(this._bianshenList),this._skin.lab_empty.node.active=!1,this._skin.lab_space.string=e+"/"+game.bianshen.bianshenMaxCount,0==e&&(this._skin.lab_empty.node.active=!0,this._skin.lab_empty.string=game.ccfg.LangCfg.getText(20014)),0!=e&&0==t&&(this._skin.lab_empty.node.active=!0,this._skin.lab_empty.string=game.ccfg.LangCfg.getText(20015))},setSlot:function(){this.clearSlot();var e,t=0,i=this._battleSlotLists.length,n=game.bianshen.getBattleSlots();if(n&&0<n.length)for(var s=0;s<n.length;s++){var a=n[s];a&&(s<i?e=this._battleSlotLists[s]:((e=game.BianshenSlotGrid.get(a,!1,game.IconType.BianshenSlotSkin,game.ContainerId.BIANSHEN_SLOT_CONTAINER_ID)).setSize(79,79),t=20+e.width*s*2,e.setPosition(t,15),e.addToParent(this._skin.slots),this._battleSlotLists.push(e)),e.setVisible(!0),e.setBianshenSlotData(a))}},updataLockSlotStatus:function(e){e&&e.data&&this.updateSlotByIndex(e.data.slotIndex)},updateBack:function(e){e&&e.data&&(this.updateSlotByIndex(e.data.slotIndex),this.onShowBianshenItem())},updateSlotByIndex:function(e){var t=game.bianshen.getBattleSlots();if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.index==e){var s=this._battleSlotLists[i];s&&(s.setVisible(!0),s.setBianshenSlotData(n))}}},updateAllSlot:function(){var e=game.bianshen.getBattleSlots();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._battleSlotLists[t];n&&n.setBianshenSlotData(i)}}},updateBianshenByIdx:function(e){if(this._bianshenList&&0<this._bianshenList.length)for(var t=0;t<this._bianshenList.length;t++){var i=this._bianshenList[t];i&&(i.idx==e&&this._list.updateIndex(t))}},onShowSelectBianshenItem:function(e){},onSortBianshen:function(e,t){return 1==e.battle?-1:1==t.battle?1:e.star>t.star?-1:e.star<t.star?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?1:e.id<t.id?-1:0},clearSlot:function(){if(this._battleSlotLists&&0<this._battleSlotLists.length)for(var e=0;e<this._battleSlotLists.length;e++){this._battleSlotLists[e].setVisible(!1)}}})},{}],169:[function(e,t,i){"use strict";game.BianshenBattleItem=game.SkinUI.extends({_bianshenInfo:null,_bianshenGrid:null,_slotIndex:0,_itemData:null,_cdTime:0,_timer:null,ctor:function(){this._super("bianshen/BianshenBattleItemSkin","BianshenBattleItemSkin")},getButtonByName:function(e){switch(e){case"itemBtn":return!this._skin||this._skin.btn_battle}return null},getWidth:function(){return 530},getHeight:function(){return 115},onShow:function(){this._itemData&&this.setData(this._itemData),b8e.evt.onC(this._skin.btn_battle,this.onBattleClick,this)},onHide:function(){this._timer&&this._timer.stop(),game.GridUtil.setBianshenGrid(this._bianshenGrid,null),b8e.evt.offC(this._skin.btn_battle,this.onBattleClick,this)},setSlotIndex:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._slotIndex=e},setData:function(e){if(this._itemData=e,this._slotIndex=e.slotIndex,this._bianshenInfo=e.bianshenInfo,this._skin&&this._bianshenInfo){this._bianshenGrid||(this._bianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._bianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_BATTLE_BACK_CONTAINER_ID),this._bianshenGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._bianshenGrid.addToParent(this._skin.node_bianshen)),game.GridUtil.setBianshenGrid(this._bianshenGrid,this._bianshenInfo),this._bianshenGrid.setName(""),this._bianshenGrid.sortLayer(),this._cdTime=game.bianshen.getBianshenCdTime(this._bianshenInfo.id);var t=game.SysTime.curTime;this._cdTime>t?(this._timer||(this._timer=b8e.Timer.add(this,this.updataCdTime,500)),this._timer.reset(),this._timer.start()):this._skin.lab_cdTime.string="",this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._bianshenInfo.quality),this._bianshenInfo.name),this._skin.lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie);var i=this._bianshenInfo.battle;this._skin.img_battle.active=i,this._skin.btn_battle.active=!i}},onBattleClick:function(){var e=game.bianshen.getBianshenSlotInfoByid(this._bianshenInfo.id);e&&e.index==this._slotIndex?game.bianshen.sendIntoBattleSlotRequest(this._bianshenInfo.id,this._slotIndex):game.bianshen.getIsInBattleSlotByid(this._bianshenInfo.id)?game.notice.show(20010):game.bianshen.sendIntoBattleSlotRequest(this._bianshenInfo.id,this._slotIndex)},updataCdTime:function(){var e=game.SysTime.curTime;if(this._cdTime<=e)this._timer&&this._timer.stop(),this._skin.lab_cdTime.string="";else{var t=~~((this._cdTime-e)/1e3);this._skin.lab_cdTime.string=game.ccfg.LangCfg.getText(20016,[t])}}})},{}],170:[function(e,t,i){"use strict";game.appModule.BianshenBattleListPanel=game.SkinUIPanel.extends({_bianshenBattleList:null,_onSelectBattleSlotInfo:null,_list:null,_showList:null,_bianshenSelectPanel:null,_showSelect:!1,ctor:function(e){this._super(e),this._bianshenBattleList=[],this._showList=[]},getButtonByName:function(e){switch(e){case"bianshenItemBtn0":if(this._list){var t=this._list.getItemRender(0);if(t){var i=t.getButtonByName("itemBtn");if(i)return i}}return!0}return null},init:function(){this._bianshenSelectPanel||(this._bianshenSelectPanel=new game.BianshenSelectPanel,this._bianshenSelectPanel.addToParent(this._skin.page))},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.BianshenBattleItem)),this._list.show(),this._skin.lab_empty.string="",this.setSelectBattleSlot(),this.setBattleItem(),b8e.evt.onC(this._skin.img_select_on,this.onClickSelectBtn,this),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.intoBattleSucces),b8e.evt.addG(this,game.BianshenEvent.UPDATE_BATTLE_BACK,this.setBattleItem)},onHide:function(){this._list&&this._list.hide(),this._showSelect=!1,this._bianshenSelectPanel.hide(),b8e.evt.offC(this._skin.img_select_on,this.onClickSelectBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.intoBattleSucces),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_BATTLE_BACK,this.setBattleItem)},intoBattleSucces:function(e){e&&e.data&&this.hide()},onClickSelectBtn:function(){if(this._bianshenSelectPanel.isShow())this._bianshenSelectPanel.hide();else{var e=game.ContainerId.BIANSHEN_BATTLE_BACK_CONTAINER_ID;this._bianshenSelectPanel.setContainerId(e),this._bianshenSelectPanel.show()}},setSelectBattleSlot:function(){this._onSelectBattleSlotInfo=this.data.bianshenSlotInfo},setBattleItem:function(){if(this._onSelectBattleSlotInfo){if(this._bianshenBattleList=game.bianshen.getBianshenBattleSelectList(this._onSelectBattleSlotInfo.index),this._showList.length=0,this._bianshenBattleList&&0<this._bianshenBattleList.length){this._bianshenBattleList.sort(this.onSortBianshen);for(var e=0;e<this._bianshenBattleList.length;e++){var t={bianshenInfo:this._bianshenBattleList[e],slotIndex:this._onSelectBattleSlotInfo.index};this._showList.push(t)}}this._list.setData(this._showList),0<this._showList.length?this._skin.lab_empty.string="":this._skin.lab_empty.string=game.ccfg.LangCfg.getText(20015)}},setBattleSlotItem:function(){if(this._onSelectBattleSlotInfo&&0!=this._onSelectBattleSlotInfo.bianshenId){var e,t=game.bianshen.getBianshenInfoByidx(this._onSelectBattleSlotInfo.bianshenId);0<this._bianshenBattleItemArr.length?e=this._bianshenBattleItemArr[0]:(e=new game.BianshenBattleItem,this._bianshenBattleItemArr.push(e)),e.setSize(530,115),e.setAnchor(.5,.5),e.setData(t),e.setSlotIndex(this._onSelectBattleSlotInfo.index),e.show(),e.addToParent(this._skin.list.content),this._curBianshenBattleItemArr.push(e)}},onSortBianshen:function(e,t){return 1==e.battle?-1:1==t.battle?1:e.star>t.star?-1:e.star<t.star?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?1:e.id<t.id?-1:0},clearGrid:function(){for(var e=0;e<this._curBianshenBattleItemArr.length;e++){var t=this._curBianshenBattleItemArr[e];t&&t.hide()}this._curBianshenBattleItemArr.length=0}})},{}],171:[function(e,t,i){"use strict";game.BianshenConvertGrid=game.SkinUI.extends({_icon:null,_cfg:null,_itemGrid:null,getWidth:function(){return 135},getHeight:function(){return 230},ctor:function(){this._super("bianshen/BianshenConvertGridSkin","BianshenConvertGridSkin")},init:function(){this._icon=b8e.Sprite.get(),this._icon.addToParent(this._skin.icon),this._icon.setScale(.4,.4),this._icon.setAnchor(.5,.5)},onShow:function(){this.setData(this._cfg),b8e.evt.onC(this._skin.convertBtn,this.onClickConvertBtn,this)},onHide:function(){b8e.evt.offC(this._skin.convertBtn,this.onClickConvertBtn,this)},setData:function(e){if(e&&(this._cfg=e,this._skin)){var t=game.ccfg.BianshenCfg.getBianshenCfgById(this._cfg.protoId);t&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_CONVERT_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.addToParent(this._skin.bianshenNode)),game.GridUtil.setBianshenGrid(this._itemGrid,t,!1,!1,!1,!1,!0,!0,!0,!1),this._itemGrid.sortLayer(),this.updateConvertCost())}},updateConvertCost:function(){if(this._cfg&&this._cfg.convertCost&&!(this._cfg.convertCost.length<0)){var e=game.ccfg.ItemInfoCfg.getItemInfoById(this._cfg.convertCost[0].Id);if(e){var t=e.iconName;this._icon.loadTexture(game.ClientCfg.getImgUrl(t,!1),null,null,{useManifest:!1}),this._skin.lab_cost.string=this._cfg.convertCost[0].Num+"",this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(this._cfg.convertCost);var i=!1;switch(e.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.CONTRIBUTION:case game.AmountType.HONOUR:i=game.upgrade.costCheckMoney(e.type,this._cfg.convertCost[0].Num);break;default:i=game.upgrade.isHasEnoughItem(this._upgradeInfo)}i?b8e.ShaderUtil.reset(this._skin.convertBtn):b8e.ShaderUtil.setGray(this._skin.convertBtn)}}},onClick:function(){var e=game.ccfg.BianshenCfg.getBianshenCfgById(this._cfg.protoId);e&&game.bianshen.showBianshenDetail(e)},onClickConvertBtn:function(){game.bianshen.sendConvertBianshen(this._cfg.id)}})},{}],172:[function(e,t,i){"use strict";game.BianshenConvertPagePanel=game.SkinUI.extends({_list:null,_convertPage:null,_resolvePage:null,_sprite1:null,_sprite2:null,_convertCostIdList:null,curType:1,_generalType:1,_rareType:2,ctor:function(){this._super("bianshen/BianshenConvertPageSkin","BianshenConvertPageSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.BianshenConvertGrid,4),this._sprite1=b8e.Sprite.get(),this._sprite1.addToParent(this._skin.icon1),this._sprite1.setAnchor(.5,.5),this._sprite1.setScale(.4,.4),this._sprite2=b8e.Sprite.get(),this._sprite2.addToParent(this._skin.icon2),this._sprite2.setAnchor(.5,.5),this._sprite2.setScale(.4,.4)},onShow:function(){var e,t;(this._list.show(),this._convertCostIdList=game.ccfg.BianshenConvertCfg.getConvertCostItemId(),this._convertCostIdList&&0<this._convertCostIdList.length)?((t=this._convertCostIdList[0])&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(t))&&this._sprite1.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._skin.lab_num1.node.active=!!t,(t=this._convertCostIdList[1])&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(t))&&this._sprite2.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._skin.lab_num2.node.active=!!t):(this._skin.lab_num1.node.active=!1,this._skin.lab_num1.node.active=!1);this.updateItem(),this._skin.generalBtnSelect.active=!0,this._skin.rareBtnSelect.active=!1,this.curType=this._generalType,this.setConvertList(this.curType),b8e.evt.onC(this._skin.generalBtn,this.onClickGeneralBtn,this),b8e.evt.onC(this._skin.rareBtn,this.onClickRareBtn,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.generalBtn,this.onClickGeneralBtn,this),b8e.evt.offC(this._skin.rareBtn,this.onClickRareBtn,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshList)},onClickGeneralBtn:function(){this._skin.generalBtnSelect.active=!0,this._skin.rareBtnSelect.active=!1,this.curType=this._generalType,this.setConvertList(this.curType)},onClickRareBtn:function(){this._skin.generalBtnSelect.active=!1,this._skin.rareBtnSelect.active=!0,this.curType=this._rareType,this.setConvertList(this.curType)},updateItem:function(){var e;(this._resolveIdList=game.ccfg.BianshenConvertCfg.getConvertCostItemId(),!this._resolveIdList&&this._resolveIdList.length<=0)||((e=this._resolveIdList[0])&&(this._skin.lab_num1.string=game.back.getItemInfoCountById(e)),(e=this._resolveIdList[1])&&(this._skin.lab_num2.string=game.back.getItemInfoCountById(e)))},refreshList:function(){this.setConvertList(this.curType),this.updateItem()},setConvertList:function(e){var t=game.bianshen.getConvertBianshenList(e);this._list.setData(t)}})},{}],173:[function(e,t,i){"use strict";game.appModule.BianshenConvertPanel=game.SkinUIPanel.extends({_list:null,_convertPage:null,_resolvePage:null,_convertPageIndex:0,_resolvePageIndex:1,_curPanel:null,ctor:function(e){this._super(e)},onShow:function(){this.selectPage(this._convertPageIndex),b8e.evt.onC(this._skin.convertBtn,this.onClickConvertBtn,this),b8e.evt.onC(this._skin.resolveBtn,this.onClickResolveBtn,this),b8e.evt.onC(this._skin.ruleBtn,this.onClickRuleBtn,this)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.convertBtn,this.onClickConvertBtn,this),b8e.evt.offC(this._skin.resolveBtn,this.onClickResolveBtn,this),b8e.evt.offC(this._skin.ruleBtn,this.onClickRuleBtn,this)},onClickConvertBtn:function(){this.selectPage(this._convertPageIndex)},onClickResolveBtn:function(){this.selectPage(this._resolvePageIndex)},onClickRuleBtn:function(){},selectPage:function(e){switch(this._curPanel&&this._curPanel.hide(),this._skin.convert_select.active=!1,this._skin.resolve_select.active=!1,e){case this._convertPageIndex:this._convertPage||(this._convertPage=new game.BianshenConvertPagePanel,this._convertPage.addToParent(this._skin.page)),this._skin.convert_select.active=!0,this._convertPage.show(),this._curPanel=this._convertPage;break;case this._resolvePageIndex:this._resolvePage||(this._resolvePage=new game.BianshenResolvePagePanel,this._resolvePage.addToParent(this._skin.page)),this._skin.resolve_select.active=!0,this._resolvePage.show(),this._curPanel=this._resolvePage}}})},{}],174:[function(e,t,i){"use strict";game.appModule.BianshenDetailsPagePanel=game.SkinUIPanel.extends({_detailsPanel:null,_upgradePanel:null,_jinjiePanel:null,_backPanel:null,_index:-1,_limitStar:-1,_timer:null,_bianshenInfo:null,_list:null,_selectedBianShenId:0,_curPanel:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"details":return!this._skin||!(t=this._skin.buttonToggle[0].node)||t;case"upgrade":return!this._skin||!(t=this._skin.buttonToggle[1].node)||t;case"jinjie":return!this._skin||!(t=this._skin.buttonToggle[2].node)||t;case"rune":return!this._skin||!(t=this._skin.buttonToggle[3].node)||t;case"autoSelect":return!this._skin||!this._upgradePanel||this._upgradePanel.getButtonByName("autoSelect");case"upgradeBtn":return!this._skin||!this._upgradePanel||this._upgradePanel.getButtonByName("upgrade");case"active":return!this._skin||!this._detailsPanel||this._detailsPanel.getButtonByName("active");case"jinjieBtn":return!this._skin||!this._jinjiePanel||this._jinjiePanel.getButtonByName("jinjieBtn");case"back":return!this._skin||this._skin.closeBtnReturn}return null},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"1"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"2"==e?(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]):"3"!=e||(this._skin.buttonToggle[3].check(),this.onSelectPanelByIndex(3),this._skin.buttonToggle[3]))},init:function(){this._limitStar=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.RUNE_MIN_LIMIT),this._list||(this._list=new b8e.List(this._skin.list,game.BianshenSelectGrid),this._list.setViewCb(this.onListScrollEnd,this))},onShow:function(){this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this._list&&this._list.show();var e=game.bianshen.getBarDatas();e&&0<e.length&&(game.bianshen.curBianshenIdx=e[0].idx,game.bianshen.curBianshenId=e[0].id),this.onSelectPanelByIndex(this._index),this.refreshRedPoint(),this.createSelectBar(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickDetailsBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickUpgradeBtn,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickJinjieBtn,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onClickBackBtn,this),b8e.evt.onC(this._skin.btn_left,this.onClickLeft,this),b8e.evt.onC(this._skin.btn_right,this.onClickRight,this),b8e.evt.addG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshRedPoint),b8e.evt.addG(this,game.BianshenEvent.UI_BIANSHEN_SELECTED,this.onSelectedBianshen),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshRedPoint),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.onActiveSuccess),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.onActiveSuccess),b8e.evt.addG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.onActiveSuccess),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.onActiveSuccess),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.onActiveSuccess),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.onActiveSuccess),b8e.evt.dptG(game.BianshenEvent.UI_BIANSHEN_SELECTED,game.bianshen.curBianshenId)},onHide:function(){this.hidePanel(),this._list&&this._list.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickDetailsBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickUpgradeBtn,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickJinjieBtn,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onClickBackBtn,this),b8e.evt.offC(this._skin.btn_left,this.onClickLeft,this),b8e.evt.offC(this._skin.btn_right,this.onClickRight,this),b8e.evt.rmvG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshRedPoint),b8e.evt.rmvG(this,game.BianshenEvent.UI_BIANSHEN_SELECTED,this.onSelectedBianshen),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshRedPoint),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.onActiveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.onActiveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.onActiveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.onActiveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.onActiveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.onActiveSuccess),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onActiveSuccess:function(){if(this._list){var e=game.bianshen.getBarDatas();this._list.setData(e)}this._detailsPanel&&this._detailsPanel.isShow()&&(this._detailsPanel.hide(),this._detailsPanel.show()),this.refreshRedPoint()},onClickLeft:function(){this._list&&this._list.scrollLeft(10)},onClickRight:function(){this._list&&this._list.scrollRight(10)},onListScrollEnd:function(e,t,i){this._skin.left_alert.active=this.checkBianshenAlert(e),this._skin.right_alert.active=this.checkBianshenAlert(i)},checkBianshenAlert:function(e){if(!e||e.length<=0)return!1;for(var t,i=e.length,n=0;n<i;n++)if(t=e[n],game.bianshen.checkBianShenAlert(t))return!0;return!1},refreshRedPoint:function(){if(this._bianshenInfo=game.bianshen.getBarDataById(game.bianshen.curBianshenId),!this._bianshenInfo||!this._bianshenInfo.active)return this._skin.jinjieRedPoint.active=!1,void(this._skin.upgradeRedPoint.active=!1);this._skin.jinjieRedPoint.active=game.bianshen.getIsJinjieByBianshenId(game.bianshen.curBianshenId),this._skin.upgradeRedPoint.active=game.bianshen.getIsUpgradeByBianshenId(game.bianshen.curBianshenId)},createSelectBar:function(){if(this._selectedBianShenId=0,this._list){var e=game.bianshen.getBarDatas();this._list.setData(e),this._list.contentX=0}},onSortBianshen:function(e,t){return 1==e.battle?-1:1==t.battle?1:e.star>t.star?-1:e.star<t.star?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?1:e.id<t.id?-1:0},onSelectedBianshen:function(e){this._selectedBianShenId!=e.data&&(this._selectedBianShenId=e.data,this._bianshenInfo=game.bianshen.getBarDataById(this._selectedBianShenId),this._bianshenInfo||(this._bianshenInfo=game.ccfg.BianshenCfg.getBianshenCfgById(this._selectedBianShenId)),this._bianshenInfo?game.bianshen.curBianshenIdx=this._bianshenInfo.idx:game.bianshen.curBianshenIdx=0,game.bianshen.curBianshenId=this._selectedBianShenId,game.bianshen.curBianshenIdx<=0?(this.hidePanel(),this.onSelectPanelByIndex(0)):this._detailsPanel&&this._detailsPanel.isShow()?(this._detailsPanel.hide(),this._detailsPanel.show()):this._upgradePanel&&this._upgradePanel.isShow()?(this._upgradePanel.hide(),this._upgradePanel.show()):this._jinjiePanel&&this._jinjiePanel.isShow()&&(this._jinjiePanel.hide(),this._jinjiePanel.show()),this.refreshRedPoint())},onClickDetailsBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickUpgradeBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onClickJinjieBtn:function(){2!=this._index&&this.onSelectPanelByIndex(2)},onClickBackBtn:function(){3!=this._index&&this.onSelectPanelByIndex(3)},hidePanel:function(){this._curPanel&&this._curPanel.hide(),this._index=-1},onSelectPanelByIndex:function(e){if((1==e||2==e)&&!game.bianshen.getBianshenInfoById(game.bianshen.curBianshenId))return 3==this._index?this._skin.buttonToggle[3].check():this._skin.buttonToggle[0].check(),void game.notice.show(10304);switch(this.hidePanel(),this._index=e){case 0:this._detailsPanel||(this._detailsPanel=new game.BianshenDetailsPanel,this._detailsPanel.addToParent(this._skin.page)),this._skin.buttonToggle[0].check(),this._skin.title.string=game.ccfg.LangCfg.getText(20017),this._detailsPanel.show(),this._skin.bianshenBar.active=!0,this._curPanel=this._detailsPanel;break;case 1:this._upgradePanel||(this._upgradePanel=new game.BianshenUpgradePanel,this._upgradePanel.addToParent(this._skin.page)),this._skin.buttonToggle[1].check(),this._skin.title.string=game.ccfg.LangCfg.getText(20018),this._upgradePanel.show(),this._skin.bianshenBar.active=!0,this._curPanel=this._upgradePanel;break;case 2:this._jinjiePanel||(this._jinjiePanel=new game.BianshenJinjiePanel,this._jinjiePanel.addToParent(this._skin.page)),this._skin.buttonToggle[2].check(),this._skin.title.string=game.ccfg.LangCfg.getText(20019),this._jinjiePanel.show(),this._skin.bianshenBar.active=!0,this._curPanel=this._jinjiePanel;break;case 3:this._backPanel||(this._backPanel=new game.BianshenBackPanel,this._backPanel.addToParent(this._skin.page)),this._skin.buttonToggle[3].check(),this._skin.title.string=game.ccfg.LangCfg.getText(20020),this._backPanel.show(),this._skin.bianshenBar.active=!1,this._curPanel=this._backPanel}}})},{}],175:[function(e,t,n){"use strict";game.BianshenDetailsPanel=game.SkinUI.extends({_bianshenInfo:null,_firstSkillSprite:null,_secondSkillSprite:null,_nameSprite:null,_accessoryModel:null,_graphicsImg:null,_curSkillList:null,_skillList:null,_bg:null,_gotoList:null,_bianshenCfg:null,_flagImg:null,ctor:function(){this._super("bianshen/BianshenDetailsSkin","BianshenDetailsSkin"),this._curSkillList=[],this._skillList=[],this._gotoList=[]},getButtonByName:function(e){switch(e){case"upgrade":return!this._skin||this._skin.btn_upgrade;case"back":return!this._skin||this._skin.closeBtnReturn;case"active":return!this._skin||this._skin.btn_active;case"battle":return!this._skin||this._skin.btn_battle}return null},onShow:function(){this.clearData(),this._bianshenInfo=game.bianshen.getBarDataById(game.bianshen.curBianshenId),this._bianshenInfo||(this._bianshenInfo=game.ccfg.BianshenCfg.getBianshenCfgById(game.bianshen.curBianshenId)),this._bianshenCfg=game.ccfg.BianshenCfg.getDataById(this._bianshenInfo.id),this.setBianshenData(),this.showModel(),this.refreshRedPoint(),this.updateGotoList(),b8e.evt.onC(this._skin.btn_yulan,this.onClickYulanBtn,this),b8e.evt.onC(this._skin.btn_protect,this.onClickProtectBtn,this),b8e.evt.onC(this._skin.btn_quality,this.onClickQualityBtn,this),b8e.evt.onC(this._skin.icon_skill1,this.onClickFirstSkillBtn,this),b8e.evt.onC(this._skin.icon_skill2,this.onClickScendSkillBtn,this),b8e.evt.onC(this._skin.btn_upgrade,this.onClickUpgradeBtn,this),b8e.evt.onC(this._skin.btn_fetter,this.onClickFetter,this),b8e.evt.onC(this._skin.btn_rune,this.onClickRune,this),b8e.evt.onC(this._skin.btn_active,this.onClickActive,this),b8e.evt.onC(this._skin.btn_battle,this.noClickBattle,this),b8e.evt.onC(this._skin.btn_switch_battle,this.noClickSwitchBattle,this),b8e.evt.onC(this._skin.btn_help,this.onClickHelp,this),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.upgradeRefresh),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updateJie),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_CHANGE_PROTECTE,this.setProtected),b8e.evt.addG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshRedPoint),b8e.evt.addG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUnlockFetter),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.onIntoBattleSlot),b8e.evt.addG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.onOffBattleSlot),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.onSwapBattleSlot),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.refreshRedPoint),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshRedPoint)},onHide:function(){this.clearGotoList(),this.clearData(),this.clearSkillIcon(),b8e.evt.offC(this._skin.btn_yulan,this.onClickYulanBtn,this),b8e.evt.offC(this._skin.btn_protect,this.onClickProtectBtn,this),b8e.evt.offC(this._skin.btn_quality,this.onClickQualityBtn,this),b8e.evt.offC(this._skin.icon_skill1,this.onClickFirstSkillBtn,this),b8e.evt.offC(this._skin.icon_skill2,this.onClickScendSkillBtn,this),b8e.evt.offC(this._skin.btn_upgrade,this.onClickUpgradeBtn,this),b8e.evt.offC(this._skin.btn_fetter,this.onClickFetter,this),b8e.evt.offC(this._skin.btn_rune,this.onClickRune,this),b8e.evt.offC(this._skin.btn_active,this.onClickActive,this),b8e.evt.offC(this._skin.btn_battle,this.noClickBattle,this),b8e.evt.offC(this._skin.btn_switch_battle,this.noClickSwitchBattle,this),b8e.evt.offC(this._skin.btn_help,this.onClickHelp,this),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.upgradeRefresh),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updateJie),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_CHANGE_PROTECTE,this.setProtected),b8e.evt.rmvG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshRedPoint),b8e.evt.rmvG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUnlockFetter),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.onIntoBattleSlot),b8e.evt.rmvG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.onOffBattleSlot),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.onSwapBattleSlot),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.refreshRedPoint),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.refreshRedPoint);var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),this._graphicsImg&&this._graphicsImg.clear(),this._bianshenInfo=null,this._bianshenCfg=null},init:function(){this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.model_node)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.node_bg));var e=game.ClientCfg.getImgUrl("bianshen/bianshenDetalilsBg",!0);this._bg.loadTexture(e,null,null,{useManifest:!1}),this._bg.setSize(550,383),this._bg.setAnchor(.5,0),this._flagImg||(this._flagImg=b8e.Sprite.get(),this._flagImg.addToParent(this._skin.flag_node))},updateGotoList:function(){if(this._bianshenInfo&&this._bianshenInfo.goto&&""!=this._bianshenInfo.goto){var e=this._bianshenInfo.goto.split(",");if(e&&!(e.length<=0)){this._skin.goto_node.setPosition(295,254);for(var t=0,i=e.length,n=null,s=0;s<i;s++)(n=this._gotoList[s])||((n=new game.BianshenTrigger).addToParent(this._skin.goto_node),this._gotoList.push(n)),n.setData(e[s]),n.setPosition(t,0),t+=n.getWidth()+5,n.show();this._skin.goto_node.setPosition(295-t/2+55,254)}}},clearGotoList:function(){if(this._gotoList)for(var e=this._gotoList.length-1;0<=e;e--)this._gotoList[e]&&this._gotoList[e].hide()},onIntoBattleSlot:function(){this.setBattleState()},onOffBattleSlot:function(){this.setBattleState()},onSwapBattleSlot:function(){this.setBattleState()},onUnlockFetter:function(){this.setAttr(),this.setCombat(),this.setFetterAlert()},onClickHelp:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.SELECT_BIANSHEN_RULE_ID)},setFetterAlert:function(){var e=game.ccfg.BianshenCfg.getFetterById(this._bianshenInfo.id);e&&0<e.length?(this._skin.btn_fetter.active=!0,this._skin.fetter_alert.active=game.bianshen.checkFetterHasActiveOrLvUp(this._bianshenInfo.id)):(this._skin.btn_fetter.active=!1,this._skin.fetter_alert.active=!1)},clearData:function(){this.clearStar(),this._skin.lab_skill1.string="",this._skin.lab_skill2.string=""},setBianshenData:function(){this._bianshenInfo&&(this.setWuxing(this._bianshenInfo.wuxing),this.setStarLv(this._bianshenInfo.star,this._bianshenInfo.jie),this.setBianshenName(),this.setSkillDesc(),this.setAttr(),this.setCombat(),this.setTotalCombatAndActiveCount(),this.setFetterAlert(),this.setBattleState(),this.setActiveState(),this.setActiveCost(),this.setBianshenFlag())},setBianshenFlag:function(){if(this._bianshenCfg)if(this._bianshenCfg.flag&&""!=this._bianshenCfg.flag){this._skin.flag_node.active=!0;var e=game.ClientCfg.getImgUrl(this._bianshenCfg.flag,!1);this._flagImg.loadTexture(e,null,null,{useManifest:!1})}else this._skin.flag_node.active=!1;else this._skin.flag_node.active=!1},setActiveCost:function(){if(this._bianshenInfo&&this._bianshenCfg)if(this._bianshenInfo.active||!this._bianshenCfg.obtainable)this._skin.lab_active.node.active=!1;else{this._skin.lab_active.node.active=!0;var e=game.bianshen.getBianshenCount(this._bianshenInfo.id);this._skin.lab_active.string=game.ccfg.LangCfg.getText(79250,[this._bianshenCfg.name,game.html.getText(1<=e?game.html.Q_GREEN:game.html.Q_RED,e)])}},setActiveState:function(){this._bianshenInfo&&this._bianshenCfg&&(this._bianshenCfg.obtainable?(this._skin.img_active.active=!this._bianshenInfo.active,this._skin.btn_active.active=!this._bianshenInfo.active,this._skin.img_active_alert.active=game.bianshen.checkCanActive(this._bianshenInfo.id)):(this._skin.img_active.active=!1,this._skin.btn_active.active=!1,this._skin.img_active_alert.active=!1))},setBattleState:function(){this._bianshenInfo&&(this._skin.img_battle.active=this._bianshenInfo.battle,this._skin.btn_battle.active=!this._bianshenInfo.battle&&this._bianshenInfo.active,this._skin.btn_switch_battle.active=this._bianshenInfo.battle,this._skin.btn_rune.active=this._bianshenInfo.battle)},setBianshenName:function(){this._bianshenInfo&&(this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._bianshenInfo.quality),this._bianshenInfo.name))},showModel:function(){if(this._bianshenInfo&&this._bianshenCfg){var e=game.ccfg.BianshenCfg.getUiPosterById(this._bianshenInfo.id),t=game.ClientCfg.getUiUnits(e),i=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);t?(i||(i=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),i.load(t),i.setScale(this._bianshenCfg.uiScale),i.setPosition(this._bianshenCfg.uiOffsetX,this._bianshenCfg.uiOffsetY),i.play()):i&&i.clear()}},upgradeRefresh:function(){this._bianshenInfo=game.bianshen.getBianshenInfoById(this._bianshenInfo.id),this._bianshenInfo&&(this.setAttr(),this.setCombat())},updateJie:function(){this._bianshenInfo=game.bianshen.getBianshenInfoById(this._bianshenInfo.id),this._bianshenInfo&&(this.setAttr(),this.setStarLv(this._bianshenInfo.star,this._bianshenInfo.jie),this.setCombat())},refreshRedPoint:function(){if(this._bianshenInfo){if(this._bianshenInfo.battle){var e=game.bianshen.getIsJinjieByBianshenId(this._bianshenInfo.id),t=game.bianshen.getIsUpgradeByBianshenId(this._bianshenInfo.id);this._skin.jinjieRedPoint.active=e,this._skin.upgradeRedPoint.active=t}else this._skin.jinjieRedPoint.active=!1,this._skin.upgradeRedPoint.active=!1;var i=!1;if(this._bianshenInfo.battle){var n=game.bianshen.getBianshenSlotInfoByid(this._bianshenInfo.id);n&&(game.rune.getRuneAlertById(n.index+1)||game.rune.getRuneUpgradeAlertById(n.index+1))&&(i=!0)}this._skin.rune_alert.active=i}},setStarLv:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.star_node)),this._starBar.setStarGradeData(e,t,game.StarType.BIANSHEN_DETAILS_STAR),this._starBar.x=~~(this._skin.star_node.width-this._starBar.starWidth)/2,this._starBar.y=0},clearStar:function(){this._starBar&&this._starBar.clearData()},setWuxing:function(e){var t="icon_wx_jin",i="icon_wx_mu",n="";switch(e){case game.BianshenWuxingType.JIN:t="icon_wx_jin",i="icon_wx_mu",n="木";break;case game.BianshenWuxingType.MU:t="icon_wx_mu",i="icon_wx_tu",n="土";break;case game.BianshenWuxingType.SHUI:t="icon_wx_shui",i="icon_wx_huo",n="火";break;case game.BianshenWuxingType.TU:t="icon_wx_tu",i="icon_wx_shui",n="水";break;case game.BianshenWuxingType.HUO:t="icon_wx_huo",i="icon_wx_jin",n="金"}game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,t),game.resController.setImgSpriteFrame(this._skin.img_mine_wuxing,game.ClientCfg.Bianshen_ALAST_URL,t),game.resController.setImgSpriteFrame(this._skin.img_restraint_wuxing,game.ClientCfg.Bianshen_ALAST_URL,i),this._bianshenInfo&&(this._skin.lab_restraint.string=game.ccfg.LangCfg.getText(10301,[t,n,this._bianshenInfo.restraintRate]))},setAttr:function(){var e=game.ccfg.BianshenUpgradeLvCfg.getMaxLv();!(this._bianshenInfo.level<e)&&(this._skin.btn_upgrade.active=!1);var t=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(this._bianshenInfo.level);this._skin.lab_level.string=game.ccfg.LangCfg.getText(10503,[this._bianshenInfo.level]);for(var i,n=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n),a=t.attrCoef,o=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie),r=1,h="",g=s.getSpriteStats(),l=0;l<g.length;l++)(i=g[l])&&(r=a*(o+game.bianshen.getFetterAttrCoef(this._bianshenInfo.id,i.type)),h+=this.getAttrStr(i,l,r));var c=game.ccfg.BianshenCfg.getDataById(this._bianshenInfo.id);c&&(h+=game.ccfg.LangCfg.getText(79251)+" "+c.speed+"<br/>"),this._skin.lab_attr.string=h},setCombat:function(){if(this._bianshenInfo){var e=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie);this._skin.lab_combat.string=e}},setTotalCombatAndActiveCount:function(){var e=game.bianshen.getActiveAllBianshenCombat(),t=game.bianshen.getActiveCount();this._skin.lab_total_pow.string=game.ccfg.LangCfg.getText(10302,[e,t])},getAttrStr:function(e,t,i){return game.ccfg.AttrRulesCfg.getAttrNameByType(e.type)+" "+Math.round(e.value*i)+"<br/>"},setLeidatu:function(){var e=.49*game.ccfg.BianshenCfg.getDtById(this._bianshenInfo.id),t=.49*game.ccfg.BianshenCfg.getQzById(this._bianshenInfo.id),i=.49*game.ccfg.BianshenCfg.getKzById(this._bianshenInfo.id),n=.49*game.ccfg.BianshenCfg.getFzById(this._bianshenInfo.id),s=.49*game.ccfg.BianshenCfg.getScById(this._bianshenInfo.id),a=[];a[0]=cc.v2(-e*Math.cos(Math.PI/180*18),e*Math.sin(Math.PI/180*18)),a[1]=cc.v2(t*Math.cos(Math.PI/180*90),t*Math.sin(Math.PI/180*90)),a[2]=cc.v2(i*Math.cos(Math.PI/180*18),i*Math.sin(Math.PI/180*18)),a[3]=cc.v2(n*Math.cos(Math.PI/180*54),-n*Math.sin(Math.PI/180*54)),a[4]=cc.v2(-s*Math.cos(Math.PI/180*54),-s*Math.sin(Math.PI/180*54)),this._graphicsImg||(this._graphicsImg=b8e.Graphics.get(),this._graphicsImg.addToParent(this._skin.techang_node)),this._graphicsImg.strokeColor(2990660095),this._graphicsImg.fillColor(2990660095),this._graphicsImg.lineWidth(2),this._graphicsImg.moveTo(a[0].x,a[0].y),this._graphicsImg.lineTo(a[1].x,a[1].y),this._graphicsImg.lineTo(a[2].x,a[2].y),this._graphicsImg.lineTo(a[3].x,a[3].y),this._graphicsImg.lineTo(a[4].x,a[4].y),this._graphicsImg.lineTo(a[0].x,a[0].y),this._graphicsImg.fill()},setSkillDesc:function(){this.setSkill(1),this.setPublicSkill(0)},setSkill:function(e){if(this._bianshenInfo){var t=game.ccfg.HeroCfg.getSpellListById(this._bianshenInfo.id);if(t&&t[e]){var i=game.ccfg.SpellCfg.getSpellById(t[e]);i&&(this._skin.lab_skill1_desc.string=game.html.getText(game.html.getColorByQuality(i.quality),"["+i.name+"]")+i.desc)}else b8e.log("spellList为null或spellList.length<2,变身配置id:"+this._bianshenInfo.id)}},setPublicSkill:function(e){if(this._bianshenInfo){var t=game.ccfg.HeroCfg.getPublicSpellList(this._bianshenInfo.id);if(t&&t[e]){var i=game.ccfg.SpellCfg.getSpellById(t[e]);i&&(this._skin.lab_skill2_desc.string=game.html.getText(game.html.getColorByQuality(i.quality),"["+i.name+"]")+i.desc)}else b8e.log("PublicSpellList为null或PublicSpellList.length<1,变身配置id:"+this._bianshenInfo.id)}},setProtected:function(){var e=game.bianshen.getBianshenInfoByidx(this._bianshenInfo.idx);switch(this._bianshenInfo=e,this._bianshenInfo.isProtected){case!0:this._skin.img_protect.active=!0,this._skin.img_unProtect.active=!1;break;case!1:this._skin.img_protect.active=!1,this._skin.img_unProtect.active=!0}},onClickYulanBtn:function(){var e=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),t=game.ccfg.SpriteStatCfg.getSpriteStatById(e);game.spriteStat.showSpriteStat(game.SpriteStatShowType.Bianshen,this._bianshenInfo.level,t)},onClickProtectBtn:function(){game.bianshen.sendupdateBianshenProtectStateRequest(this._bianshenInfo.idx,!this._bianshenInfo.isProtected)},onClickQualityBtn:function(){},onClickFirstSkillBtn:function(){},onClickScendSkillBtn:function(){},clearLeida:function(){this._graphicsImg&&this._graphicsImg.removeFromParent()},onClickUpgradeBtn:function(){},clearSkillIcon:function(){for(i=0;i<this._curSkillList.length;i++)this._curSkillList[i].hide();this._curSkillList.length=0},onClickFetter:function(){if(game.funcOpen.checkOpen(game.FunctionType.FETTER))game.app.show(game.AppConstant.BIANSHEN_FETTER_PANEL,this._bianshenInfo);else{var e=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.FETTER);game.notice.show(game.ccfg.LangCfg.getText(27011,[e.minLevel]))}},onClickRune:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.RUNE)){var e=game.bianshen.getBianshenSlotInfoByid(this._bianshenInfo.id);e&&game.app.show(game.AppConstant.RUNE_PANEL,e.index)}},onClickActive:function(){game.bianshen.checkCanActive(game.bianshen.curBianshenId)?game.bianshen.rqActivateBianshen(game.bianshen.curBianshenId):game.notice.show(10303)},noClickBattle:function(){var e=game.bianshen.getEmptyBattleSlot();-1<e?game.bianshen.sendIntoBattleSlotRequest(game.bianshen.curBianshenId,e):game.app.show(game.AppConstant.SWAP_BATTLE_SHAPE_PANEL)},noClickSwitchBattle:function(){game.app.show(game.AppConstant.SWAP_BATTLE_SHAPE_PANEL)}})},{}],176:[function(e,t,i){"use strict";game.BianshenFetterItem=game.SkinUI.extends({_data:null,_bsGrids:null,_canActiveOrLvUp:!1,ctor:function(){this._super("bianshen/BianshenFetterItem","BianshenFetterItemSkin")},init:function(){this._bsGrids=[]},getWidth:function(){return 550},getHeight:function(){return 170},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.btn_lvup,this.onClickLevelUp,this),b8e.evt.onC(this._skin.btn_active,this.onClickActive,this)},onHide:function(){this.clearGrids(),b8e.evt.offC(this._skin.btn_lvup,this.onClickLevelUp,this),b8e.evt.offC(this._skin.btn_active,this.onClickActive,this)},onClickLevelUp:function(){if(this._canActiveOrLvUp){if(this._data){var e=game.bianshen.getFetterLv(this._data.protoId,this._data.type)+1;game.bianshen.rqFetterUnlock(this._data.protoId,this._data.type,e)}}else game.notice.show(game.ccfg.LangCfg.getText(79204))},onClickActive:function(){this._canActiveOrLvUp?this._data&&game.bianshen.rqFetterUnlock(this._data.protoId,this._data.type,1):game.notice.show(game.ccfg.LangCfg.getText(79204))},setData:function(e){if(this.clearGrids(),this._data=e,this._data&&this._skin){if(9999<=this._data.type)return this._skin.fetter_panel.active=!1,void(this._skin.lb_lock.node.active=!0);this._skin.fetter_panel.active=!0,this._skin.lb_lock.node.active=!1;var t=game.bianshen.getFetterLv(this._data.protoId,this._data.type),i=!1,n=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(this._data.type,t),s=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(this._data.type,t+1);if(s||0<t&&(i=!0,s=game.ccfg.BianshenFetterCfg.getDataByTypeAndLv(this._data.type,t)),s){var a=s.bianshenId;if(a&&!(a.length<=0)){var o=a.length;b8e.ShaderUtil.reset(this._skin.btn_active),b8e.ShaderUtil.reset(this._skin.btn_lvup);var r,h,g,l=game.bianshen.getFetterCondition(this._data.protoId,this._data.type),c=game.ccfg.AttrRulesCfg.getAttrNameByType(s.attrType);this._canActiveOrLvUp=o<=l,t<=0?(this._skin.lb_name.string=s.name.replace("Lv1",game.ccfg.LangCfg.getText(79205)),this._skin.btn_lvup.active=!1,this._skin.btn_active.active=!0,this._skin.full_level_node.active=!1,this._canActiveOrLvUp||b8e.ShaderUtil.setGray(this._skin.btn_active),this._skin.lb_attr.string=game.ccfg.LangCfg.getText(79202,[c,0,s.attrCoef]),this._skin.lb_condition.string=game.ccfg.LangCfg.getText(79200,[game.html.getText(o<=l?game.html.Q_GREEN:game.html.Q_RED,l),o])):(this._skin.btn_active.active=!1,n&&(this._skin.lb_name.string=n.name),i?(this.setButtonState(!1),this._skin.lb_attr.string=game.ccfg.LangCfg.getText(79203,[c,s.attrCoef])):(this.setButtonState(!0),this._skin.lb_condition.string=game.ccfg.LangCfg.getText(79201,[s.bianshenStar,game.html.getText(o<=l?game.html.Q_GREEN:game.html.Q_RED,l),o]),n&&(this._skin.lb_attr.string=game.ccfg.LangCfg.getText(79202,[c,n.attrCoef,s.attrCoef])),this._canActiveOrLvUp||b8e.ShaderUtil.setGray(this._skin.btn_lvup)));for(var u=0;u<o;u++)(g=this._bsGrids[u])||((g=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.CSARENA_RANK_BS_CONTAINER_ID),this.addChild(g),g.x=93*u,g.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._bsGrids.push(g),g.addToParent(this._skin.bianshen_node)),(r=game.bianshen.getMaxJieBianshenInfoById(a[u]))?g.setGray(!1):(h={lv:0,protoId:a[u],isInBattleSlot:!1,isProtected:!1,exp:0},r=game.ItemInfoUtil.createCommonBSInfo(h),g.setGray(!0)),g.fnOnClick(this,this.onClick),g.gridInfo.data=r,game.GridUtil.setBianshenGrid(g,r),g.setName(""),g.setTRLabel(""),g.setBattle(!1),g.sortLayer()}}}},setButtonState:function(e){this._skin.btn_lvup.active=e,this._skin.full_level_node.active=!e,this._skin.lb_condition.node.active=e},onClick:function(e){if(e&&e.gridInfo&&e.gridInfo.data)if(0<e.gridInfo.data.idx)game.bianshen.showBianshenDetail(e.gridInfo.data);else{var t=game.ccfg.BianshenCfg.getBianshenCfgById(e.gridInfo.data.id);game.bianshen.showBianshenDetail(t)}},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setBianshenGrid(e,null)}})},{}],177:[function(e,t,i){"use strict";game.appModule.BianshenFetterPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.BianshenFetterItem))},onShow:function(){this._list.show(),this.updateShow(),b8e.evt.onC(this._skin.btn_help,this.onClickHelpBtn,this),b8e.evt.addG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.updateShow),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updateShow),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.updateShow)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_help,this.onClickHelpBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.updateShow),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updateShow),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.updateShow)},onClickHelpBtn:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.BIANSHEN_FETTER_RULE_ID)},updateShow:function(){if(this.data){var e=game.ccfg.BianshenCfg.getFetterById(this.data.id);if(e){for(var t,i=[],n=e.length,s=0;s<n;s++)t={type:e[s],protoId:this.data.id},i.push(t);this._list.setData(i)}}}})},{}],178:[function(e,t,i){"use strict";game.BianshenJinjiePanel=game.SkinUI.extends({_bianshenInfo:null,_curBianshenGrid:null,_nextBianshenGrid:null,_maxBianshenGrid:null,_bianshenGridArr:null,_hasCount:0,_needCostCount:0,_effect:null,_anim:null,_effectArr:null,_animArr:null,jinjieFinish:!1,_idxList:null,_gotoList:null,ctor:function(){this._super("bianshen/BianshenJinjieSkin","BianshenJinjieSkin"),this._bianshenGridArr=[],this._animArr=[],this._effectArr=[],this._idxList=[],this._gotoList=[]},getButtonByName:function(e){var t;switch(e){case"jinjieBtn":return!this._skin||!(t=this._skin.btn_jinjie)||t}return null},onShow:function(){this._bianshenInfo=game.bianshen.getBarDataById(game.bianshen.curBianshenId),game.bianshen.isJinjieing=!1,this.setData(),b8e.evt.onC(this._skin.btn_jinjie,this.onClickJinjieBtn,this),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.upgradeBianshenFinish),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_MATERIAL_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE,this.resetMaterialGrid),game.bianshen.autoSelectJinjieBianshen()},onHide:function(){this.clearGrid(),this.clearBianshenGrid(),this.clearBianshenJinjieEffect(),game.bianshen.clearBianshenMaterial(),game.bianshen.isJinjieing=!1,this._anim&&this._anim.clear(),this.clearGotoList(),b8e.evt.offC(this._skin.btn_jinjie,this.onClickJinjieBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.upgradeBianshenFinish),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_MATERIAL_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE,this.resetMaterialGrid)},setData:function(){if(this._bianshenInfo){var e=this._bianshenInfo.star;this._bianshenInfo.jie<e?(this.setLeftBianshenIcon(),this.setLeftAttr(),this.setRightBianshenIcon(),this.setRightAttr(),this.setMaterial(),this.showMaterial(),this.setNodes(!0)):(this.setMaxBianshenIcon(),this.setMaxAttr(),this.setNodes(!1)),this.updateGotoList()}},updateGotoList:function(){if(this._skin&&this._bianshenInfo&&this._bianshenInfo.goto&&""!=this._bianshenInfo.goto){var e=this._bianshenInfo.goto.split(",");if(e&&!(e.length<=0)){this._skin.goto_node.setPosition(295,104);for(var t=0,i=e.length,n=null,s=0;s<i;s++)(n=this._gotoList[s])||((n=new game.BianshenTrigger).addToParent(this._skin.goto_node),this._gotoList.push(n)),n.setData(e[s]),n.setPosition(t,0),t+=n.getWidth()+5,n.show();this._skin.goto_node.setPosition(295-t/2+55,104)}}},clearGotoList:function(){if(this._gotoList)for(var e=this._gotoList.length-1;0<=e;e--)this._gotoList[e]&&this._gotoList[e].hide()},jinjieComplete:function(){this._bianshenInfo=game.bianshen.getBianshenInfoById(this._bianshenInfo.id),this.clearBianshenGrid(),this.playEffect(),this.setData();var e=this._bianshenInfo.star;this._bianshenInfo.jie<e?(this._curBianshenGrid.bianshenStarBoom(this._bianshenInfo.star,this._bianshenInfo.jie),game.bianshen.autoSelectJinjieBianshen()):this._maxBianshenGrid.bianshenStarBoom(this._bianshenInfo.star,this._bianshenInfo.jie),game.bianshen.isJinjieing=!1},playEffect:function(){var e=game.ClientCfg.getUIFxs("10025");this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.BIANSHEN_JINJIE_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._effect.setVisible(!1)},setLeftBianshenIcon:function(){this._curBianshenGrid||(this._curBianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._curBianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_JIE_LEFT_GRID_CONTAINER_ID),this._curBianshenGrid.addToParent(this._skin.left_img_node)),game.GridUtil.setBianshenGrid(this._curBianshenGrid,this._bianshenInfo),this._curBianshenGrid.setRedIcon(!1),this._curBianshenGrid.sortLayer()},setLeftAttr:function(){if(0==this._bianshenInfo.jie)return this._skin.left_attr.string=game.ccfg.LangCfg.getText(20021,[this._bianshenInfo.jie]),void(this._skin.left_lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie));var e=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie);e=Math.round(100*(e-1)),this._skin.left_attr.string=game.ccfg.LangCfg.getText(20021,[e]),this._skin.left_lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie)},setRightBianshenIcon:function(){var e=this._bianshenInfo;e.jie++,this._nextBianshenGrid||(this._nextBianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._nextBianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_JIE_RIGHT_GRID_CONTAINER_ID),this._nextBianshenGrid.addToParent(this._skin.right_img_node)),game.GridUtil.setBianshenGrid(this._nextBianshenGrid,e),this._nextBianshenGrid.setRedIcon(!1),this._nextBianshenGrid.sortLayer(),e.jie--},setRightAttr:function(){var e=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie+1);e=Math.round(100*(e-1)),this._skin.right_attr.string=game.ccfg.LangCfg.getText(20021,[e]),this._skin.right_lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie+1)},setMaxBianshenIcon:function(){this._maxBianshenGrid||(this._maxBianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._maxBianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_JIE_MAX_GRID_CONTAINER_ID),this._maxBianshenGrid.addToParent(this._skin.max_img_node)),game.GridUtil.setBianshenGrid(this._maxBianshenGrid,this._bianshenInfo),this._maxBianshenGrid.setRedIcon(!1),this._maxBianshenGrid.sortLayer()},setMaxAttr:function(){var e=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie);e=Math.round(100*(e-1)),this._skin.max_attr.string=game.ccfg.LangCfg.getText(20021,[e]),this._skin.max_lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie)},setNodes:function(e){this._skin.material_nodes.active=e,this._skin.leftGroup.active=e,this._skin.rightGroup.active=e,this._skin.lab_max_desc.active=!e,this._skin.maxGroup.active=!e},setMaterial:function(){this.clearGrid();var e,t,i=game.ccfg.BianshenUpgradeJieCfg.getCostBianshenNumberByJie(this._bianshenInfo.jie);for(t=0;t<i;t++)t<this._bianshenGridArr.length?(a=this._bianshenGridArr[t]).setVisible(!0):((a=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID),a.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),a.fnOnClick(this,this.onClickMaterial),a.addToParent(this._skin.need_icon_nodes),this._bianshenGridArr.push(a)),game.GridUtil.setBianshenGrid(a,null,!0,!0),a.x=.8*a.iconSize*t+10*t,a.sortLayer();var n=this._effectArr.length;for(t=0;t<i;t++)if(n<=t){(o=b8e.BaseDisplay.get()).addToParent(this._skin.jinjieEffect),o.x=107*.8*t+10*t;var s=b8e.Animator.get(game.AnimatorType.BIANSHEN_UPGRADE_EFFECT_2,1);o.addChild(s),this._effectArr.push(o),this._animArr.push(s)}else{var a,o=this._effectArr[t];(a=this._bianshenGridArr[t])&&o&&(o.x=.8*a.iconSize*t+10*t)}e=(.8*game.IcoSizeEnum.SIZE_107>>1>>0)*(i-1)+10*(i-1),this._skin.need_icon_nodes.x=(this.width>>1)-e,this._skin.jinjieEffect.x=this._skin.need_icon_nodes.x},onClickMaterial:function(e){game.app.show(game.AppConstant.BIANSHEN_MATERIAL_PANEL,{containerId:game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID})},resetMaterialGrid:function(){var e,t,i=null,n=game.bianshen.getBianshenMaterial();if(n&&((i=n.values())&&0<i.length))for(var s=0;s<i.length;s++)(t=i[s])&&(e=this._bianshenGridArr[s])&&(game.GridUtil.setBianshenGrid(e,t),e.sortLayer());var a=game.ccfg.BianshenUpgradeJieCfg.getCostBianshenNumberByJie(this._bianshenInfo.jie),o=0;o=i&&0<i.length?a-i.length:a;for(s=0;s<o;s++)(e=this._bianshenGridArr[a-o+s])&&(game.GridUtil.setBianshenGrid(e,null,!0,!0),e.setVisible(!0),e.sortLayer());this.showMaterial()},showMaterial:function(){this._hasCount=0;var e=game.bianshen.getBianshenMaterial();if(e){var t=e.values();if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i],s=game.bianshen.getJinjieMaterialByBianshen(n.jie);this._hasCount+=s}}this._needCostCount=game.ccfg.BianshenUpgradeJieCfg.getCostBianshenNumberByJie(this._bianshenInfo.jie),this._hasCount>=this._needCostCount?this._skin.lab_need.string=game.ccfg.LangCfg.getText(20022,[game.html.getText(game.html.Q_GREEN,this._hasCount),game.html.getText(game.html.Q_GREEN,this._needCostCount)]):this._skin.lab_need.string=game.ccfg.LangCfg.getText(20022,[game.html.getText(game.html.Q_RED,this._hasCount),game.html.getText(game.html.Q_GREEN,this._needCostCount)]),game.bianshen.selectMaterialCount=this._hasCount,game.bianshen.selectMaterialMaxCount=this._needCostCount},onClickJinjieBtn:function(){if(!game.bianshen.isJinjieing&&this._bianshenInfo){if(this._hasCount>=this._needCostCount){this._idxList.length=0;var e=game.bianshen.getBianshenMaterial(),i=!1;if(e.forEach(function(e,t){t&&((0<t.jie||1<t.level)&&(i=!0),this._idxList.push(parseInt(e)))},this),i){var t=new game.GameAlertInfo;return t.alertType=game.GameAlertType.TwoBtn,t.string=game.ccfg.LangCfg.getText(20012),t.obj={id:this._bianshenInfo.id,list:this._idxList},t.isShowTips=!1,void game.gameAlert.showAlert(this,this.onClickJinjieBtnComplete,t)}game.bianshen.isJinjieing=!0,game.bianshen.sendupgradeBianshenJieRequest(this._bianshenInfo.id,this._idxList)}this._hasCount<this._needCostCount&&game.notice.show(20011)}},onClickJinjieBtnComplete:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.bianshen.isJinjieing=!0,game.bianshen.sendupgradeBianshenJieRequest(e.obj.id,e.obj.list);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},upgradeBianshenFinish:function(e){if(e&&e.data){this.jinjieFinish=!1;for(var t=e.data,i=0;i<t;i++)i==t-1&&(this.jinjieFinish=!0),this.playEffectByIndex(i)}},playEffectByIndex:function(e){var t=game.ClientCfg.getUIFxs("10006"),i=this._effectArr[e];if(i){var n=this._animArr[e];n&&(t?(i.setVisible(!0),n.load(t),n.addFinishCallback(this.onCompleteEffect2,this,[i]),n.play(null,0)):n&&n.clear())}},onCompleteEffect2:function(e,t){t.setVisible(!1),(this.jinjieFinish=!0)&&this.jinjieComplete()},clearBianshenJinjieEffect:function(){var e;for(e=0;e<this._effectArr.length;e++){var t=this._effectArr[e];t&&t.setVisible(!1)}for(e=0;e<this._animArr.length;e++){var i=this._animArr[e];i&&i.stop()}},clearGrid:function(){if(this._bianshenGridArr&&0<this._bianshenGridArr.length)for(var e=0;e<this._bianshenGridArr.length;e++){var t=this._bianshenGridArr[e];game.GridUtil.setBianshenGrid(t,null,!0,!0),t.sortLayer(),t.setVisible(!1)}},clearBianshenGrid:function(){this._curBianshenGrid&&game.GridUtil.setBianshenGrid(this._curBianshenGrid,null),this._nextBianshenGrid&&game.GridUtil.setBianshenGrid(this._nextBianshenGrid,null),this._maxBianshenGrid&&game.GridUtil.setBianshenGrid(this._maxBianshenGrid,null)}})},{}],179:[function(e,t,i){"use strict";game.BianshenMaterialGrid=game.SkinUI.extends({_data:null,_itemInfo:null,_itemGrid:null,_gridInfo:null,ctor:function(){this._super()},onShow:function(){this.setData(this._data)},onHide:function(){this._itemGrid&&(this._itemGrid.setGridEmpty(),this._itemGrid.removeFromParent())},getWidth:function(){return 120},getHeight:function(){return 140},setData:function(e){if(this._data=e,this._data&&this.isShow()&&(this._itemInfo=this._data.info,this._itemInfo)){switch(this._gridInfo||(this._gridInfo=new game.GridInfo(this._data.containerId)),this._itemGrid||(this._itemGrid=new game.ItemGrid),this._gridInfo.containerId=this._data.containerId,this._itemGrid.gridInfo=this._gridInfo,this._itemGrid.fnOnClick(this,this.onClick),this.addChild(this._itemGrid),this._itemGrid.gridInfo.containerId){case game.ContainerId.BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID:this._itemGrid.setScale(game.IconScale.PERCENT_100,game.IconScale.PERCENT_100),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_107,this.setBianshenGrid();break;case game.ContainerId.BIANSHEN_MATERIAL_ITEM_BACK_CONTAINER_ID:this._itemGrid.setScale(game.IconScale.PERCENT_115,game.IconScale.PERCENT_115),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_90,this.setItemGridInfo()}this._itemGrid.setBgImage(game.ClientCfg.getQualityBg(this._itemInfo.quality,this._itemGrid.iconSize));var t=this._itemInfo.iconName;t||(t=""),""==t&&(t="item/90001",b8e.log("---物品要加载的图标为空---\x3eitemInfo.id="+this._itemInfo.id+"__itemInfo.name"+this._itemInfo.name)),this._itemGrid.setIcon(game.ClientCfg.getImgUrl(t));var i=game.html.getColorByQuality(this._itemInfo.quality);this._itemGrid.setName(this._itemInfo.name,i),this._itemGrid.setNum(this._itemInfo.num),this._itemGrid.sortLayer()}},setBianshenGrid:function(){var e=1;0!=this._itemInfo.level&&(e=this._itemInfo.level),this._itemGrid.setTRLabel("Lv"+e,null,null,null,null,null,null,2),this._itemGrid.setWuxingIcon(game.ClientCfg.getWuxingIcon(this._itemInfo.wuxing)),this._itemGrid.setEffect(this._itemInfo.qualityEffect,game.AnimatorType.ITEM_EFFECT,1.2,1.2),this._itemGrid.setStarBar(game.StarType.BIANSHEN_STAR,this._itemInfo.star,this._itemInfo.jie),this._itemGrid.setProtected(this._itemInfo.isProtected),this._itemGrid.setBattle(this._itemInfo.battle);var t=game.bianshen.getSelectMaterialIsHas(this._itemInfo.idx);this._itemGrid.setImgSelect(t)},setItemGridInfo:function(){this._itemGrid.setTRLabel(""),this._itemGrid.setWuxingIcon(""),this._itemGrid.setEffect(this._itemInfo.qualityEffect,game.AnimatorType.ITEM_EFFECT),this._itemGrid.setStarBar(game.StarType.BIANSHEN_STAR,0,0),this._itemGrid.setProtected(!1);var e=game.bianshen.getSelectItemIsHas(this._itemInfo.id);this._itemGrid.setImgSelect(e),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_90},getItemGrid:function(){return this._itemGrid?this._itemGrid:null},onClick:function(e){if(this._itemInfo)switch(e.gridInfo.containerId){case game.ContainerId.BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID:var t=game.bianshen.setBianshenOnceMaterial(this._itemInfo.idx,e.gridInfo.containerId);e.setImgSelect(t);break;case game.ContainerId.BIANSHEN_MATERIAL_ITEM_BACK_CONTAINER_ID:e.isSelect?(game.bianshen.delCostItemOnceMap(this._itemInfo.id),this._itemGrid.setImgSelect(!1)):(game.bianshen.setCostItemOnceMap(this._itemInfo.id),e.isSelect=game.bianshen.getSelectItemIsHas(this._itemInfo.id),this._itemGrid.setImgSelect(e.isSelect))}}})},{}],180:[function(e,t,i){"use strict";game.BianshenPackSlotGrid=b8e.BaseDisplay.extends({_bianshenInfo:null,_bianshenSlotInfo:null,_itemGrid:null,_isUnlocked:!1,ctor:function(){this._super()},show:function(){},hide:function(){},setData:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this._bianshenSlotInfo=e,this._bianshenSlotInfo){switch(this._bianshenInfo=game.bianshen.getBianshenInfoById(this._bianshenSlotInfo.bianshenId),this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_BACK_CONTAINER_ID),this.addChild(this._itemGrid)),this._bianshenSlotInfo.index){case 0:this._isUnlocked=!0;break;case 1:this._isUnlocked=game.AchievementMgr.inst().isUnlockBianShenTwo();break;case 2:this._isUnlocked=game.AchievementMgr.inst().isUnlockBianShenThree();break;default:this._isUnlocked=!0}t&&this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setBianshenGrid(this._itemGrid,this._bianshenInfo,!1,!0,!1,!0),this._itemGrid.sortLayer(),this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80)}},onClick:function(e){game.SysTime.curTime;if(this._bianshenSlotInfo)if(0<this._bianshenSlotInfo.dataId);else{if(0==this._isUnlocked)return void game.app.show(game.AppConstant.ACHIEVEMENT_PANEL);game.app.show(game.AppConstant.BIANSHEN_BATTLE_LIST_PANEL,{bianshenSlotInfo:this._bianshenSlotInfo})}},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],181:[function(e,t,i){"use strict";game.BianshenResolveGrid=game.SkinUI.extends({_bianshenInfo:null,_itemGrid:null,getWidth:function(){return 135},getHeight:function(){return 160},ctor:function(){this._super("bianshen/BianshenResolveGridSkin","BianshenResolveGridSkin")},init:function(){},onShow:function(){this.setData(this._bianshenInfo)},onHide:function(){},setData:function(e){if(e&&(this._bianshenInfo=e,this._skin)){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_RESOLVE_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.addToParent(this._skin.bianshenNode)),game.GridUtil.setBianshenGrid(this._itemGrid,this._bianshenInfo,!1,!1,!1,!1,!0,!0,!0,!1);var t=game.bianshen.getResolveBianshenIsSelect(this._bianshenInfo.idx);this._itemGrid.setImgSelect(t),this._itemGrid.sortLayer()}},onClick:function(){game.bianshen.selectResolveBianshen(this._bianshenInfo.idx);var e=game.bianshen.getResolveBianshenIsSelect(this._bianshenInfo.idx);this._itemGrid.setImgSelect(e),b8e.evt.dptG(game.BianshenEvent.SELECT_BIANSHEN_RESOLVE)}})},{}],182:[function(e,t,i){"use strict";game.BianshenResolvePagePanel=game.SkinUI.extends({_list:null,_convertPage:null,_resolvePage:null,_sprite1:null,_sprite2:null,ctor:function(){this._super("bianshen/BianshenResolvePageSkin","BianshenResolvePageSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.BianshenResolveGrid,4),this._sprite1=b8e.Sprite.get(),this._sprite1.addToParent(this._skin.icon1),this._sprite1.setAnchor(.5,.5),this._sprite1.setScale(.4,.4),this._sprite2=b8e.Sprite.get(),this._sprite2.addToParent(this._skin.icon2),this._sprite2.setAnchor(.5,.5),this._sprite2.setScale(.4,.4)},onShow:function(){var e,t;(this._list.show(),this._resolveIdList=game.ccfg.BianshenCfg.getResolveIdList(),this._resolveIdList&&0<this._resolveIdList.length)?((t=this._resolveIdList[0])&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(t))&&this._sprite1.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._skin.lab_num1.node.active=!!t,(t=this._resolveIdList[1])&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(t))&&this._sprite2.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._skin.lab_num2.node.active=!!t):(this._skin.lab_num1.node.active=!1,this._skin.lab_num1.node.active=!1);game.bianshen.initResolveBianshenList(),this.updateBianshen(),this.updateItem(),b8e.evt.onC(this._skin.resolveBtn,this.onClickResolveBtn,this),b8e.evt.addG(this,game.BianshenEvent.SELECT_BIANSHEN_RESOLVE,this.updateItem),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_RESOLVE_SUCCESS,this.resolveSuccess),b8e.evt.addG(this,game.BianshenEvent.UPDATE_BACK,this.updateBianshen)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.resolveBtn,this.onClickResolveBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.SELECT_BIANSHEN_RESOLVE,this.updateItem),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_RESOLVE_SUCCESS,this.resolveSuccess),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_BACK,this.updateBianshen)},onClickResolveBtn:function(){game.bianshen.sendResolveBianshen()},resolveSuccess:function(){this.updateBianshen(),this.updateItem()},updateItem:function(){var e=game.bianshen.getSelectResolveList();if(!e||e.length<=0)return this._skin.lab_num1.string=0,void(this._skin.lab_num2.string=0);for(var t,i,n,s=e.length,a=0,o=0,r=0;r<s;r++)if(t=e[r],(i=game.bianshen.getBackBianshenInfoByIdx(t))&&(n=i.resolveAward)&&!(n.length<=0)){var h=n[0];h.Id==this._resolveIdList[0]&&(a+=h.Num*(i.jie+1)),h.Id==this._resolveIdList[1]&&(o+=h.Num*(i.jie+1))}this._skin.lab_num1.string=a+"",this._skin.lab_num2.string=o+""},updateBianshen:function(){var e=game.bianshen.getResolveList();this._list.setData(e)}})},{}],183:[function(e,t,i){"use strict";game.appModule.BianshenSelectBackPanel=game.SkinUIPanel.extends({_info:null,_containerId:-1,_bianshenGridArr:null,_itemItemArr:null,list:null,showList:null,ctor:function(e){this._super(e),this._bianshenGridArr=[],this._itemItemArr=[],this.showList=[]},onShow:function(){switch(this._list||(this._list=new b8e.List(this._skin.list,game.BianshenMaterialGrid,4)),this._list.show(),b8e.evt.onC(this._skin.btn_ok,this.onClickOkBtn,this),b8e.evt.onC(this._skin.get_bianshen,this.onClickGetBianshenBtn,this),b8e.evt.addG(this,game.BianshenEvent.SELECT_MATERIAL,this.updateLabSpace),game.bianshen.clearBianshenOnceMaterial(),game.bianshen.clearCostItemOnceMap(),game.bianshen.selectMaterialCount=0,this._containerId=this.data.containerId,this._containerId){case game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:this.showList.length=0,this.onShowItem(),this.onShowBianshenUpgradeMaterialItem(),this._skin.lab_title_space.string=game.ccfg.LangCfg.getText(20023);break;case game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:this.showList.length=0,this._skin.lab_title_space.string=game.ccfg.LangCfg.getText(20028),this.onShowBianshenJieMaterialItem()}this.updateLabSpace()},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_ok,this.onClickOkBtn,this),b8e.evt.offC(this._skin.get_bianshen,this.onClickGetBianshenBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.SELECT_MATERIAL,this.updateLabSpace),game.bianshen.clearBianshenOnceMaterial(),game.bianshen.clearCostItemOnceMap()},onShowItem:function(){game.bianshen.setCostItemOnceMapByCostItemMap();var e,t=game.back.getBianshenMaterialList();if(t&&0<t.length){for(var i=0;i<t.length;i++){e={info:t[i],containerId:game.ContainerId.BIANSHEN_MATERIAL_ITEM_BACK_CONTAINER_ID},this.showList.push(e)}this._list.setData(this.showList)}},onShowBianshenUpgradeMaterialItem:function(){var e;if(game.bianshen.setBianshenOnceMaterialByBianshenMaterial(),this._bianshenList=game.bianshen.getBianshenBackList(),this._bianshenList&&0<this._bianshenList.length){this._bianshenList.sort(this.onSortBianshen);for(var t=0;t<this._bianshenList.length;t++){var i=this._bianshenList[t],n=game.bianshen.curBianshenIdx;i.idx!=n&&(e={info:i,containerId:game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID},this.showList.push(e))}this._list.setData(this.showList)}!this.showList||this.showList.length<=0?(this._skin.get_bianshen.active=!0,this._skin.lab_empty_bianshen.active=!0):(this._skin.get_bianshen.active=!1,this._skin.lab_empty_bianshen.active=!1)},onShowBianshenJieMaterialItem:function(){var e;if(game.bianshen.setBianshenOnceMaterialByBianshenMaterial(),this._bianshenList=game.bianshen.getBianshenBackList(),this._bianshenList&&0<this._bianshenList.length){for(var t=0;t<this._bianshenList.length;t++){var i=this._bianshenList[t],n=game.bianshen.curBianshenIdx,s=game.bianshen.getBianshenIdByIdx(n);i.id==s&&(i.idx!=n&&(e={info:i,containerId:game.ContainerId.BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID},this.showList.push(e)))}this._list.setData(this.showList)}!this.showList||this.showList.length<=0?(this._skin.get_bianshen.active=!0,this._skin.lab_empty_bianshen.active=!0):(this._skin.get_bianshen.active=!1,this._skin.lab_empty_bianshen.active=!1)},updateLabSpace:function(){var e=game.bianshen.selectMaterialCount,t=game.bianshen.selectMaterialMaxCount;this._skin.lab_space.string=e+"/"+t},onClickOkBtn:function(){switch(this._containerId){case game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:this.upgradeItemSelectComplete(),this.upgradeBianshenSelectComplete();break;case game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:this.jieSelectComplete()}b8e.evt.dptG(game.BianshenEvent.BIANSHEN_MATERIAL_SELECT_COMPLETE),game.app.hide(game.AppConstant.BIANSHEN_MATERIAL_PANEL)},onClickGetBianshenBtn:function(){game.TriggerMgr.inst().customTriggerById(3108)},upgradeItemSelectComplete:function(){game.bianshen.clearCostItemMap();var e=game.bianshen.getCostItemOnceMap(),t=e.keys();if(t&&!(t.length<=0)){for(var i=0;i<t.length;i++)for(var n=t[i],s=e.get(n),a=0;a<s;a++)game.bianshen.setCostItemMap(n);game.bianshen.clearCostItemOnceMap()}},upgradeBianshenSelectComplete:function(){game.bianshen.clearBianshenMaterial();var e=game.bianshen.getBianshenOnceMaterial().keys();if(e&&!(e.length<=0)){for(var t=0;t<e.length;t++){var i=e[t];game.bianshen.setBianshenMaterial(i)}game.bianshen.clearBianshenOnceMaterial()}},jieSelectComplete:function(){game.bianshen.clearBianshenMaterial();var e=game.bianshen.getBianshenOnceMaterial().keys();if(e&&!(e.length<=0)){for(var t=0;t<e.length;t++){var i=e[t];game.bianshen.setBianshenMaterial(i)}game.bianshen.clearBianshenOnceMaterial()}},onSortBianshen:function(e,t){return 1==e.battle?1:1==t.battle?-1:1==e.isProtected?1:1==t.isProtected?-1:e.star>t.star?-1:e.star<t.star?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?1:e.id<t.id?-1:0}})},{}],184:[function(e,t,i){"use strict";game.BianshenSelectGrid=game.SkinUI.extends({_bianshenInfo:null,_itemGrid:null,ctor:function(){this._super()},onShow:function(){b8e.evt.addG(this,game.BianshenEvent.UI_BIANSHEN_SELECTED,this.onSelectedBianshen),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.onUpdateBattleSlot),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.onUpdateBattleSlot),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.onUpdateBattleSlot),b8e.evt.addG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUpdateBattleSlot),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.onUpdateBattleSlot),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateBattleSlot)},onHide:function(){b8e.evt.rmvG(this,game.BianshenEvent.UI_BIANSHEN_SELECTED,this.onSelectedBianshen),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.onUpdateBattleSlot),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.onUpdateBattleSlot),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_ACTIVE_SUCCESS,this.onUpdateBattleSlot),b8e.evt.rmvG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUpdateBattleSlot),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.onUpdateBattleSlot),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.onUpdateBattleSlot)},onUpdateBattleSlot:function(){this.setData(this._bianshenInfo)},getWidth:function(){return game.IcoSizeEnum.SIZE_90},getHeight:function(){return game.IcoSizeEnum.SIZE_90},setData:function(e){if(this._bianshenInfo=e,this._bianshenInfo){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.SELECT_BIANSHEN_CONTAINER_ID),this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.setImgSelect(game.bianshen.curBianshenId==this._bianshenInfo.id,3),this._itemGrid.setImgSelectScale(game.IconScale.PERCENT_100,game.IconScale.PERCENT_100),this.addChild(this._itemGrid),this._itemGrid.fnOnClick(this,this.onClick));var t=game.bianshen.checkBianShenAlert(this._bianshenInfo);game.GridUtil.setBianshenGrid(this._itemGrid,this._bianshenInfo,!1,!1,!1,!1,!0,!0,!0,t),this._itemGrid.setCanActive(!this._bianshenInfo.active&&game.bianshen.checkCanActive(this._bianshenInfo.id)),this._itemGrid.setImgSelectScale(1.5,1.5),this._itemGrid.setImgSelectPos(-10,10),this._itemGrid.setLabNamePos(0,-4),this._itemGrid.setGray(!this._bianshenInfo.active),this._itemGrid.sortLayer(),this._itemGrid.setImgSelectGray(!1),this._itemGrid.setRedIconGray(!1),this._itemGrid.setActiveIconGray(!1),this.onSelectedBianshen({data:game.bianshen.curBianshenId})}},onClick:function(e){game.bianshen.curBianshenId!=this._bianshenInfo.id&&b8e.evt.dptG(game.BianshenEvent.UI_BIANSHEN_SELECTED,this._bianshenInfo.id)},onSelectedBianshen:function(e){e.data==this._bianshenInfo.id?this._itemGrid.setImgSelect(!0):this._itemGrid.setImgSelect(!1)},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],185:[function(e,t,i){"use strict";game.BianshenSelectPanel=game.SkinUI.extends({_fiveStarIsSelect:!0,_fourStarIsSelect:!0,_threeStarIsSelect:!0,_twoStarIsSelect:!0,_allStarIsSelect:!0,_jinIsSelect:!0,_muIsSelect:!0,_shuiIsSelect:!0,_huoIsSelect:!0,_tuIsSelect:!0,_allWuxingIsSelect:!0,containerId:-1,ctor:function(){this._super("bianshen/BianshenSelectSkin","BianshenSelectSkin")},onShow:function(){-1==this.containerId&&(this.containerId=game.ContainerId.BIANSHEN_BACK_CONTAINER_ID),this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?this._skin.select_node.y=298:this._skin.select_node.y=246,this._locked=!1,this.setSelectBtn(),this.registerOrUnregisterEvent(!0),b8e.log("this bianshenSelect skin is open!!!!")},onHide:function(){this._timer&&this._timer.stop(),this.containerId=-1,this._locked=!1,this.registerOrUnregisterEvent(!1)},setContainerId:function(e){this.containerId=e},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.fiveStarBtn.node,this.onClickFiveStarBtn,this),b8e.evt.onC(this._skin.fourStarBtn.node,this.onClickFourStarBtn,this),b8e.evt.onC(this._skin.threeStarBtn.node,this.onClickThreeStarBtn,this),b8e.evt.onC(this._skin.twoStarBtn.node,this.onClickTwoStarBtn,this),b8e.evt.onC(this._skin.allStarBtn.node,this.onClickAllStarBtn,this),b8e.evt.onC(this._skin.jinBtn.node,this.onClickJinBtn,this),b8e.evt.onC(this._skin.muBtn.node,this.onClickMuBtn,this),b8e.evt.onC(this._skin.shuiBtn.node,this.onClickShuiBtn,this),b8e.evt.onC(this._skin.tuBtn.node,this.onClickTuBtn,this),b8e.evt.onC(this._skin.huoBtn.node,this.onClickHuoBtn,this),b8e.evt.onC(this._skin.allWuxingBtn.node,this.onClickAllWuxingBtn,this),b8e.evt.onC(this,this.onClickBg,this)):(b8e.evt.offC(this._skin.fiveStarBtn.node,this.onClickFiveStarBtn,this),b8e.evt.offC(this._skin.fourStarBtn.node,this.onClickFourStarBtn,this),b8e.evt.offC(this._skin.threeStarBtn.node,this.onClickThreeStarBtn,this),b8e.evt.offC(this._skin.twoStarBtn.node,this.onClickTwoStarBtn,this),b8e.evt.offC(this._skin.allStarBtn.node,this.onClickAllStarBtn,this),b8e.evt.offC(this._skin.jinBtn.node,this.onClickJinBtn,this),b8e.evt.offC(this._skin.muBtn.node,this.onClickMuBtn,this),b8e.evt.offC(this._skin.shuiBtn.node,this.onClickShuiBtn,this),b8e.evt.offC(this._skin.tuBtn.node,this.onClickTuBtn,this),b8e.evt.offC(this._skin.huoBtn.node,this.onClickHuoBtn,this),b8e.evt.offC(this._skin.allWuxingBtn.node,this.onClickAllWuxingBtn,this),b8e.evt.offC(this,this.onClickBg,this))},onClickBg:function(){this.hide()},onClickFiveStarBtn:function(){this._locked?this._fiveStarIsSelect?this._skin.fiveStarBtn.check():this._skin.fiveStarBtn.uncheck():(this.setLockTime(),this._fiveStarIsSelect=this._skin.fiveStarBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByStar(5,this._fiveStarIsSelect):game.bianshen.setBattleBianshenByStar(5,this._fiveStarIsSelect),this.setStarCheck(),this.setSelectBtn())},onClickFourStarBtn:function(){this._locked?this._fourStarIsSelect?this._skin.fourStarBtn.check():this._skin.fourStarBtn.uncheck():(this.setLockTime(),this._fourStarIsSelect=this._skin.fourStarBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByStar(4,this._fourStarIsSelect):game.bianshen.setBattleBianshenByStar(4,this._fourStarIsSelect),this.setStarCheck(),this.setSelectBtn())},onClickThreeStarBtn:function(){this._locked?this._threeStarIsSelect?this._skin.threeStarBtn.check():this._skin.threeStarBtn.uncheck():(this.setLockTime(),this._threeStarIsSelect=this._skin.threeStarBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByStar(3,this._threeStarIsSelect):game.bianshen.setBattleBianshenByStar(3,this._threeStarIsSelect),this.setStarCheck(),this.setSelectBtn())},onClickTwoStarBtn:function(){this._locked?this._twoStarIsSelect?this._skin.twoStarBtn.check():this._skin.twoStarBtn.uncheck():(this.setLockTime(),this._twoStarIsSelect=this._skin.twoStarBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByStar(2,this._twoStarIsSelect):game.bianshen.setBattleBianshenByStar(2,this._twoStarIsSelect),this.setStarCheck(),this.setSelectBtn())},onClickAllStarBtn:function(){this._locked?this._allStarIsSelect?this._skin.allStarBtn.check():this._skin.allStarBtn.uncheck():(this.setLockTime(),this._allStarIsSelect?(this._fiveStarIsSelect=!1,this._fourStarIsSelect=!1,this._threeStarIsSelect=!1,this._twoStarIsSelect=!1,this._skin.allStarBtn.uncheck(),this._skin.fiveStarBtn.uncheck(),this._skin.fourStarBtn.uncheck(),this._skin.threeStarBtn.uncheck(),this._skin.twoStarBtn.uncheck()):(this._fiveStarIsSelect=!0,this._fourStarIsSelect=!0,this._threeStarIsSelect=!0,this._twoStarIsSelect=!0,this._skin.allStarBtn.check(),this._skin.fiveStarBtn.check(),this._skin.fourStarBtn.check(),this._skin.threeStarBtn.check(),this._skin.twoStarBtn.check()),this._allStarIsSelect=this._skin.allStarBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByAllStar(this._allStarIsSelect):game.bianshen.setBattleBianshenByAllStar(this._allStarIsSelect),this.setSelectBtn())},onClickJinBtn:function(){this._locked?this._jinIsSelect?this._skin.jinBtn.check():this._skin.jinBtn.uncheck():(this.setLockTime(),this._jinIsSelect=this._skin.jinBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByWuxing(game.BianshenWuxingType.JIN,this._jinIsSelect):game.bianshen.setBattleBianshenByWuxing(game.BianshenWuxingType.JIN,this._jinIsSelect),this.setWuxingCheck(),this.setSelectBtn())},onClickMuBtn:function(){this._locked?this._muIsSelect?this._skin.muBtn.check():this._skin.muBtn.uncheck():(this.setLockTime(),this._muIsSelect=this._skin.muBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByWuxing(game.BianshenWuxingType.MU,this._muIsSelect):game.bianshen.setBattleBianshenByWuxing(game.BianshenWuxingType.MU,this._muIsSelect),this.setWuxingCheck(),this.setSelectBtn())},onClickShuiBtn:function(){this._locked?this._shuiIsSelect?this._skin.shuiBtn.check():this._skin.shuiBtn.uncheck():(this.setLockTime(),this._shuiIsSelect=this._skin.shuiBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByWuxing(game.BianshenWuxingType.SHUI,this._shuiIsSelect):game.bianshen.setBattleBianshenByWuxing(game.BianshenWuxingType.SHUI,this._shuiIsSelect),this.setWuxingCheck(),this.setSelectBtn())},onClickTuBtn:function(){this._locked?this._tuIsSelect?this._skin.tuBtn.check():this._skin.tuBtn.uncheck():(this.setLockTime(),this._tuIsSelect=this._skin.tuBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByWuxing(game.BianshenWuxingType.TU,this._tuIsSelect):game.bianshen.setBattleBianshenByWuxing(game.BianshenWuxingType.TU,this._tuIsSelect),this.setWuxingCheck(),this.setSelectBtn())},onClickHuoBtn:function(){this._locked?this._huoIsSelect?this._skin.huoBtn.check():this._skin.huoBtn.uncheck():(this.setLockTime(),this._huoIsSelect=this._skin.huoBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByWuxing(game.BianshenWuxingType.HUO,this._huoIsSelect):game.bianshen.setBattleBianshenByWuxing(game.BianshenWuxingType.HUO,this._huoIsSelect),this.setWuxingCheck(),this.setSelectBtn())},onClickAllWuxingBtn:function(){this._locked?this._allWuxingIsSelect?this._skin.allWuxingBtn.check():this._skin.allWuxingBtn.uncheck():(this.setLockTime(),this._allWuxingIsSelect?(this._jinIsSelect=!1,this._muIsSelect=!1,this._shuiIsSelect=!1,this._huoIsSelect=!1,this._tuIsSelect=!1,this._skin.allWuxingBtn.uncheck(),this._skin.jinBtn.uncheck(),this._skin.muBtn.uncheck(),this._skin.shuiBtn.uncheck(),this._skin.tuBtn.uncheck(),this._skin.huoBtn.uncheck()):(this._jinIsSelect=!0,this._muIsSelect=!0,this._shuiIsSelect=!0,this._huoIsSelect=!0,this._tuIsSelect=!0,this._skin.allWuxingBtn.check(),this._skin.jinBtn.check(),this._skin.muBtn.check(),this._skin.shuiBtn.check(),this._skin.tuBtn.check(),this._skin.huoBtn.check()),this._allWuxingIsSelect=this._skin.allWuxingBtn.isChecked,this.containerId==game.ContainerId.BIANSHEN_BACK_CONTAINER_ID?game.bianshen.setBianshenByAllWuxing(this._allWuxingIsSelect):game.bianshen.setBattleBianshenByAllWuxing(this._allWuxingIsSelect),this.setSelectBtn())},setLockTime:function(){this._locked=!0,b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this.lock)},lock:function(){this._locked=!1},setSelectBtn:function(){},setStarCheck:function(){this._fiveStarIsSelect&&this._fourStarIsSelect&&this._threeStarIsSelect&&this._twoStarIsSelect?(this._skin.allStarBtn.check(),this._allStarIsSelect=!0):(this._skin.allStarBtn.uncheck(),this._allStarIsSelect=!1)},setWuxingCheck:function(){this._jinIsSelect&&this._muIsSelect&&this._shuiIsSelect&&this._huoIsSelect&&this._tuIsSelect?(this._skin.allWuxingBtn.check(),this._allWuxingIsSelect=!0):(this._skin.allWuxingBtn.uncheck(),this._allWuxingIsSelect=!1)}})},{}],186:[function(e,t,i){"use strict";game.BianshenSlotGrid=game.BaseGrid.extends({_bianshenSlotInfo:null,_isJiahao:!1,_isUnlocked:!1,_isOnMain:!0,_isBianshen:!1,_battleStatus:!1,_bianshenCdTime:0,_isHasTicker:!1,ctor:function(e,t,i,n){this.setOnMain(t),this._super(i,e,n),this.onreset(e,t,i,n)},onreset:function(e,t,i,n){this.containerId=n,this.setOnMain(t),this.iconType=i,e&&(this._bianshenSlotInfo=e),b8e.evt.onC(this,this.onClickBattleSlot,this)},setOnMain:function(e){this._isOnMain=e},commitData:function(){this._bianshenSlotInfo=this.baseData,this.setBianshenSlotData(this._bianshenSlotInfo)},setBianshenSlotData:function(e){if(this._bianshenSlotInfo=e,this._skin)if(e){this._skin.bg.node.active=!0,this._skin.lab_slot_lock_desc.node.active=!1,this._skin.node.active=!0,this._skin.lab_slotIndex.string=this._bianshenSlotInfo.index+1;var t=0<e.dataId?e.dataId:e.bianshenId,i=game.ccfg.BianshenCfg.getIconById(t);if(this.setGridImg(i),0<t){this._skin.bg.node.active=!1;game.ccfg.BianshenCfg.getQualityById(t);this.setImgQuality(!0),this.setJiahao(!1),this.setUnLock(!1),this._isOnMain?(this._skin.lab_slotIndex.node.active=!1,this._skin.img_slotIndex.active=!1):(this._skin.lab_slotIndex.node.active=!0,this._skin.img_slotIndex.active=!0)}if(this._bianshenSlotInfo&&0==this._bianshenSlotInfo.bianshenId)return this.setJiahao(this._isUnlocked),this.setUnLock(!this._isUnlocked),this.setUnLockLvDesc(this._bianshenSlotInfo.unlockLv),this.setImgQuality(!1),this.setGridImg(""),void(this._isOnMain?(this._skin.node.active=!1,this._skin.lab_slotIndex.node.active=!1,this._skin.img_slotIndex.active=!1):(this._skin.lab_slotIndex.node.active=!0,this._skin.img_slotIndex.active=!0));if(this._bianshenSlotInfo){t=this._bianshenSlotInfo.bianshenId;this._bianshenCdTime=game.bianshen.getBianshenCdTime(t);var n=game.SysTime.curTime;(0<t||n<this._bianshenSlotInfo.cdFinishTs||n<this._bianshenCdTime)&&this.tick()}}else this.setGridImg("")},setGridImg:function(e){this.imgIcon=e},setGridImgQuality:function(e){this.imgQuality=e},setJiahao:function(e){this._skin&&this._skin.img_slot_jiahao&&(this._skin.img_slot_jiahao.active=e)},setUnLock:function(e){this._skin&&this._skin.img_slot_lock&&(this._skin.img_slot_lock.active=e)},setUnLockLvDesc:function(e){this._skin&&this._skin.lab_slot_lock_desc&&(this._skin.lab_slot_lock_desc.string=game.ccfg.LangCfg.getText(20024,[e]))},setImgQuality:function(e){},battleStatus:{set:function(e){this._battleStatus=e},get:function(){return this._battleStatus}},onClickBattleSlot:function(){game.SysTime.curTime;if(this._bianshenSlotInfo)if(0<this._bianshenSlotInfo.dataId);else if(this._isOnMain){if(this._bianshenSlotInfo.bianshenId&&0!=this._bianshenSlotInfo.bianshenId)return void game.ShapeShiftMgr.inst().sendShapeShift(this._bianshenSlotInfo)}else game.app.show(game.AppConstant.BIANSHEN_BATTLE_LIST_PANEL,{bianshenSlotInfo:this._bianshenSlotInfo})},update:function(){if(!this._bianshenSlotInfo)return this._highlight(!1),this._maskActive(!1),this._isHasTicker=!1,void b8e.Ticker.remove(this,this.update);var e=game.SysTime.curTime,t=0;this._skin&&(this._skin.lab_cd.node.active=!0,this._bianshenSlotInfo.isIn?(this._isOnMain&&this._highlight(!0),e<this._bianshenSlotInfo.misoperationTime?(this._maskActive(!0),t=this._bianshenSlotInfo.misoperationTime-e,this._skin.lab_cd.string=Math.floor(t/1e3)):(this._maskActive(!1),this._skin.lab_cd.node.active=!1)):this._bianshenCdTime<=this._bianshenSlotInfo.cdFinishTs&&e<this._bianshenSlotInfo.cdFinishTs?(this._highlight(!1),this._maskActive(!0),t=this._bianshenSlotInfo.cdFinishTs-e,this._skin.lab_cd.string=Math.floor(t/1e3)):this._bianshenSlotInfo.cdFinishTs<=this._bianshenCdTime&&e<this._bianshenCdTime?(this._highlight(!1),this._maskActive(!0),t=this._bianshenCdTime-e,this._skin.lab_cd.string=Math.floor(t/1e3)):(this._highlight(!1),this._maskActive(!1),this._isHasTicker=!1,b8e.Ticker.remove(this,this.update)))},tick:function(){this._isHasTicker||(this._isHasTicker=!0,b8e.Ticker.add(this,this.update))},_highlight:function(e){this._skin&&(this._skin.img_hight_light.active=e)},_maskActive:function(e){this._skin&&(this._skin.mask.active=e)},clear:function(){},restore:function(e,t,i,n){this._super(i,e,n),this.onreset(e,t,i,n)},recycle:function(){this.setGridImg(""),this._maskActive(!1),this._highlight(!1),this._bianshenSlotInfo=null,b8e.evt.offC(this,this.onClickBattleSlot,this),this._isHasTicker=!1,b8e.Ticker.remove(this,this.update),this._super()}}),game.BianshenSlotGrid.pool=new b8e.Pool(game.BianshenSlotGrid,250),game.BianshenSlotGrid.get=function(e,t,i,n){return game.BianshenSlotGrid.pool.get(e,t,i,n)},game.BianshenSlotGrid.put=function(e){return e=game.BianshenSlotGrid.pool.put(e)}},{}],187:[function(e,t,i){"use strict";game.BianshenTrigger=game.SkinUI.extends({_gotoString:null,_turnInfo:null,_gotoPanel:"",ctor:function(){this._super("bianshen/BianshenTriggerSkin","BianshenTriggerSkin")},getWidth:function(){return 110},getHeight:function(){return 26},onShow:function(){this.setData(this._gotoString),b8e.evt.onC(this._skin.node_click,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClickItem,this)},setData:function(e){if(this._gotoString=e,this._skin&&this._gotoString){var t=parseInt(e);this._turnInfo=game.ccfg.GotoCfg.getDataByKey(t),this._turnInfo&&(this._skin.lab_goto.string="<u>"+this._turnInfo.title+"</u>")}},onClickItem:function(){var e=game.ccfg.ClientTriggerCfg.getDataById(this._turnInfo.triggerId);if(e){var t=game.ccfg.ClientCommandCfg.getDataById(e.triggerCommandIds);if(t)switch(parseInt(e.triggerCommandIds)){case game.GotoType.MOUNT_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.GotoType.FABAO_UP:game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.GotoType.WING_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;default:game.funcOpen.checkOpenWithTips(t.functionOpenId)&&game.TriggerMgr.inst().triggerById(e.triggerCommandIds)}game.app.isShow(game.AppConstant.GOTO_PANEL)&&game.app.hide(game.AppConstant.GOTO_PANEL)}}})},{}],188:[function(e,t,i){"use strict";game.BianshenUpgradePanel=game.SkinUI.extends({_bianshenInfo:null,_gridArr:null,_curBianshenGrid:null,_itemItemArr:null,_autoSelectType:game.BianshenAutoSelectType.ITEM,list:null,showList:null,_effect:null,_anim:null,curSelectMaterialCount:0,_effectArr:null,_animArr:null,_bianshenAutoSelectPanel:null,_showSelect:!1,_upgradeEffectDisplay:null,_upgradeAnim:null,ctor:function(){this._super("bianshen/BianshenUpgradeSkin","BianshenUpgradeSkin"),this._gridArr=[],this._itemItemArr=[],this.showList=[],this._animArr=[],this._effectArr=[]},getButtonByName:function(e){switch(e){case"autoSelect":return!this._skin||this._skin.btn_auto_select;case"upgrade":return!this._skin||this._skin.btn_upgrade;case"back":return!this._skin||this._skin.closeBtnReturn}return null},init:function(){this._bianshenAutoSelectPanel||(this._bianshenAutoSelectPanel=new game.BianshenAutoSelectPanel,this._bianshenAutoSelectPanel.addToParent(this._skin.page))},onShow:function(){this._upgradeEffectDisplay||(this._upgradeEffectDisplay=b8e.BaseDisplay.get(),this._upgradeEffectDisplay.addToParent(this._skin.upgradeEffect)),this._bianshenInfo=game.bianshen.getBarDataById(game.bianshen.curBianshenId),this._curBianshenGrid||(this._curBianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._curBianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_UPGRADE_GRID_CONTAINER_ID),this._curBianshenGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._curBianshenGrid.addToParent(this._skin.bianshen_icon_node)),this.setData();for(var e=this._effectArr.length,t=0;t<10;t++)if(e<=t){var i=b8e.BaseDisplay.get();i.addToParent(this._skin["img_icon_"+t]);var n=b8e.Animator.get(game.AnimatorType.BIANSHEN_UPGRADE_EFFECT_2,1);i.addChild(n),this._effectArr.push(i),this._animArr.push(n)}this.refreshUpgradeEffect(),b8e.evt.onC(this._skin.btn_yulan,this.onClickYulanBtn,this),b8e.evt.onC(this._skin.btn_upgrade,this.onClickUpgradeBtn,this),b8e.evt.onC(this._skin.btn_auto_select,this.onClickAutoSelectBtn,this),b8e.evt.onC(this._skin.btn_select,this.onClickSelectBtn,this),b8e.evt.onC(this._skin.jiahao_nodes,this.onClickJiahao,this),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE_SHOW_EFFECT,this.playEffect),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.upgradeBianshenFinish),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_MATERIAL_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.addG(this,game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE,this.setAutoSelectType),b8e.evt.addG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshUpgradeEffect)},onHide:function(){this._showSelect=!1,this._bianshenAutoSelectPanel.hide(),game.bianshen.clearBianshenMaterial(),game.bianshen.clearCostItemMap(),this.clearGrid(),this._anim&&this._anim.clear(),this.clearCanUpgradeEffect(),this.clearBianshenUpgradeEffect(),b8e.evt.offC(this._skin.btn_yulan,this.onClickYulanBtn,this),b8e.evt.offC(this._skin.btn_upgrade,this.onClickUpgradeBtn,this),b8e.evt.offC(this._skin.btn_auto_select,this.onClickAutoSelectBtn,this),b8e.evt.offC(this._skin.btn_select,this.onClickSelectBtn,this),b8e.evt.offC(this._skin.jiahao_nodes,this.onClickJiahao,this),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE_SHOW_EFFECT,this.playEffect),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.upgradeBianshenFinish),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_MATERIAL_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_MATERIAL_AUTO_SELECT_COMPLETE,this.resetMaterialGrid),b8e.evt.rmvG(this,game.BianshenEvent.AUTO_SELECT_TYPE_COMPLETE,this.setAutoSelectType),b8e.evt.rmvG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.refreshUpgradeEffect)},autoSelectType:{set:function(e){this._autoSelectType=e},get:function(){return this._autoSelectType}},setAutoSelectType:function(){switch(this.autoSelectType=game.bianshen.autoSelectType,this.autoSelectType){case game.BianshenAutoSelectType.ITEM:this._skin.img_two_star_auto_select.active=!1,this._skin.img_three_star_auto_select.active=!1,this._skin.img_four_star_auto_select.active=!1,this._skin.img_item_auto_select.active=!0;break;case game.BianshenAutoSelectType.TWOSTAR:this._skin.img_two_star_auto_select.active=!0,this._skin.img_three_star_auto_select.active=!1,this._skin.img_four_star_auto_select.active=!1,this._skin.img_item_auto_select.active=!1;break;case game.BianshenAutoSelectType.THREESTAR:this._skin.img_two_star_auto_select.active=!1,this._skin.img_three_star_auto_select.active=!0,this._skin.img_four_star_auto_select.active=!1,this._skin.img_item_auto_select.active=!1;break;case game.BianshenAutoSelectType.FOURSTAR:this._skin.img_two_star_auto_select.active=!1,this._skin.img_three_star_auto_select.active=!1,this._skin.img_four_star_auto_select.active=!0,this._skin.img_item_auto_select.active=!1}},setData:function(){this.updateExp(),this.setAutoSelectType(),this.setMaxLevelState()},setMaxLevelState:function(){if(this._bianshenInfo){var e=game.ccfg.BianshenUpgradeLvCfg.getMaxLv(),t=!(this._bianshenInfo.level<e);this._skin.lab_max_level.node.active=t,this._skin.btn_upgrade.active=!t,this._skin.btn_select.active=!t,this._skin.btn_auto_select.active=!t,this._skin.list.node.active=!t,this._skin.jiahao_nodes.active=!t,this._skin.select_node.active=!t}},playEffect:function(){var e=game.ClientCfg.getUIFxs("10028");this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.BIANSHEN_UPGRADE_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._effect.setVisible(!1)},upgradeBianshenFinish:function(){this.updateExp(),this.setMaxLevelState();for(var e=this.curSelectMaterialCount,t=0;t<e;t++)this.playEffectByIndex(t);this.curSelectMaterialCount=0},playEffectByIndex:function(e){var t=game.ClientCfg.getUIFxs("10006"),i=this._effectArr[e];if(i){var n=this._animArr[e];n&&(t?(i.setVisible(!0),n.load(t),n.addFinishCallback(this.onCompleteEffect2,this,[i]),n.play(null,0)):n&&n.clear())}},clearBianshenUpgradeEffect:function(){var e;for(e=0;e<this._effectArr.length;e++){var t=this._effectArr[e];t&&t.setVisible(!1)}for(e=0;e<this._animArr.length;e++){var i=this._animArr[e];i&&i.stop()}},refreshUpgradeEffect:function(){game.bianshen.getIsUpgradeByBianshenId(this._bianshenInfo.id)?this.playCanUpgradeEffect():this.clearCanUpgradeEffect()},playCanUpgradeEffect:function(){var e=game.ClientCfg.getUIFxs("10019");e?(this._upgradeAnim||(this._upgradeAnim=b8e.Animator.get(game.AnimatorType.BIANSHEN_CAN_UPGRADE_EFFECT,1),this._upgradeEffectDisplay.addChild(this._upgradeAnim)),this._upgradeEffectDisplay.setVisible(!0),this._upgradeAnim.load(e),this._upgradeAnim.play()):this._upgradeAnim&&this._upgradeAnim.clear()},clearCanUpgradeEffect:function(){this._upgradeAnim&&this._upgradeAnim.stop(),this._upgradeEffectDisplay&&this._upgradeEffectDisplay.setVisible(!1)},onCompleteEffect2:function(e,t){t.setVisible(!1)},resetMaterialGrid:function(){this.clearGrid();var e=this._gridArr.length,t=0,i=game.bianshen.getBianshenMaterial();if(i){var n=i.values();if(n&&0<n.length)for(var s=0;s<n.length;s++){var a=n[s];if(a){var o=this._skin["img_icon_"+t];t<e?u=this._gridArr[t]:((u=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID),u.fnOnClick(this,this.onClickMaterial),this._gridArr.push(u),u.addToParent(o)),u.iconSize=game.IcoSizeEnum.SIZE_107,u.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),game.GridUtil.setBianshenGrid(u,a),u.setName(""),u.sortLayer(),t++}}}if(i=game.bianshen.getCostItemMap()){var r=i.keys();if(r&&0<r.length)for(var h=0;h<r.length;h++)for(var g=i.get(r[h]),l=0;l<g;l++){var c=game.back.getItemInfoById(r[h]);if(c){var u;o=this._skin["img_icon_"+t];t<e?u=this._gridArr[t]:((u=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID),u.fnOnClick(this,this.onClickMaterial),this._gridArr.push(u),u.addToParent(o)),u.iconSize=game.IcoSizeEnum.SIZE_90,u.setScale(.95,.95),game.GridUtil.setBianshenGrid(u,null,!0,!0),game.GridUtil.setItemGrid(u,c),u.setName(""),u.setNum(""),u.setTRLabel(""),u.sortLayer(),t++}}}this.setAttr(),this.setCombat()},onClickMaterial:function(e){var t=game.bianshen.curBianshenIdx,i=game.bianshen.getBianshenInfoByidx(t);i&&(game.bianshen.getIsPermitUpgrade(i)?game.app.show(game.AppConstant.BIANSHEN_MATERIAL_PANEL,{containerId:this._containerId}):game.notice.show(20025))},setImgJiahaoNodes:function(e){for(var t=this._skin.img_jiahao_nodes,i=0;i<t.length;i++){var n=t[i];n.active=!(i<e)}},setAttr:function(){var e=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(this._bianshenInfo.level),t=(a=game.bianshen.getBianshenMaterial()).values(),i=0;if(t&&0<t.length)for(var n=0;n<t.length;n++){var s=t[n];if(s)i=i+game.ccfg.BianshenUpgradeLvCfg.getBianshenMaterialExp(s.level,s.quality)+game.ccfg.BianshenCfg.getExpById(s.id)+s.exp}var a,o=(a=game.bianshen.getCostItemMap()).keys();if(o&&0<o.length)for(var r=0;r<o.length;r++)for(var h=a.get(o[r]),g=0;g<h;g++){var l=game.back.getItemInfoById(o[r]);if(l)i+=l.getEffectValueByType(game.ItemEffectType.BIANSHENEXP)}var c=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),u=game.ccfg.SpriteStatCfg.getSpriteStatById(c),m=e.attrCoef,_=game.bianshen.getAddLv(this._bianshenInfo,i),d=game.bianshen.getYulanExp(this._bianshenInfo,i),f=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(this._bianshenInfo.level+_).attrCoef,p=game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(this._bianshenInfo.level,this._bianshenInfo.quality),S=game.ccfg.BianshenUpgradeLvCfg.getBianshenExp(this._bianshenInfo.level+_,this._bianshenInfo.quality);this.setLevel(this._bianshenInfo.level,_),this.setExp(this._bianshenInfo.exp,p,d,S,i),this.setProgress(this._bianshenInfo.exp,p,d,S),this.setLabAttr(u,m,f)},updateExp:function(){if(this._bianshenInfo){var e=this._bianshenInfo.idx,t=game.bianshen.getBianshenInfoByidx(e);t&&(this._bianshenInfo=t,game.GridUtil.setBianshenGrid(this._curBianshenGrid,this._bianshenInfo),this._curBianshenGrid.setRedIcon(!1),this._curBianshenGrid.sortLayer(),this.resetMaterialGrid(),game.bianshen.selectMaterialCount=game.bianshen.getBianshenUpgradeMaterialCount(),game.bianshen.selectMaterialMaxCount=10)}},setLevel:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;t=0<i?"(+"+i+")":"",this._skin.lab_level.string="等级："+e+game.html.getText(game.html.Q_GREEN,t)},setExp:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;0<s?(this._skin.lab_exp.string=i+"/"+n,this._skin.lab_addExp.string=this.setStringBeGreen("(+"+s+")")):(this._skin.lab_exp.string=e+"/"+t,this._skin.lab_addExp.string="")},setLabAttr:function(e,t){for(var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie),s=0,a=0,o=0,r="",h=e.getSpriteStats(),g=0;g<h.length;g++){var l=h[g];l&&(a=t*(n+(s=game.bianshen.getFetterAttrCoef(this._bianshenInfo.id,l.type))),o=i*(n+s),r+=this.getAttrStr(l,g,h,a,o))}this._skin.lab_attr.string=r},getAttrStr:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a="",o=e.value,r=game.ccfg.AttrRulesCfg.getAttrNameByType(e.type),h=o*n,g=o*s-h;t!=i.length-1&&(a="\n");return 0==g?r+":"+Math.round(h)+a:r+":"+Math.round(h)+this.setStringBeGreen("(+"+Math.round(g)+")")+a},setCombat:function(){this._skin.lab_combat.string=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie)},setProgress:function(e,t,i,n){var s;this._skin.progress_mask.active=!0,this._skin.progress_yulan_mask.active=!1,s=0==t?1:e/t,this._skin.progress_mask.width=s*this._skin.progress.width;var a=i/n;this._skin.progress_yulan_mask.width=a*this._skin.progress.width,s<a&&t<=n&&(this._skin.progress_mask.active=!0,this._skin.progress_yulan_mask.active=!0),a<s&&t<n&&(this._skin.progress_mask.active=!1,this._skin.progress_yulan_mask.active=!0)},setStringBeGreen:function(e){return game.html.getText(game.html.Q_GREEN,e)},onClickJiahao:function(){this._bianshenInfo&&(game.bianshen.getIsPermitUpgrade(this._bianshenInfo)?game.app.show(game.AppConstant.BIANSHEN_MATERIAL_PANEL,{containerId:game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID}):game.notice.show(20025))},onClickYulanBtn:function(){var e=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),t=game.ccfg.SpriteStatCfg.getSpriteStatById(e);game.spriteStat.showSpriteStat(game.SpriteStatShowType.Bianshen,this._bianshenInfo.level,t)},onClickUpgradeBtn:function(){game.bianshen.getIsPermitUpgrade(this._bianshenInfo)?(this.curSelectMaterialCount=game.bianshen.getBianshenUpgradeMaterialCount(),game.bianshen.sendaddExpForBianshenRequest(this._bianshenInfo.id)):game.notice.show(20025)},onClickAutoSelectBtn:function(){this._bianshenInfo&&(game.bianshen.getIsPermitUpgrade(this._bianshenInfo)?game.bianshen.autoSelect(this.autoSelectType):game.notice.show(20025))},onClickSelectBtn:function(){this._bianshenAutoSelectPanel.isShow()?this._bianshenAutoSelectPanel.hide():this._bianshenAutoSelectPanel.show()},clearGrid:function(){for(var e=0;e<this._gridArr.length;e++){var t=this._gridArr[e];t&&t.setVisible(!1)}}})},{}],189:[function(e,t,i){"use strict";game.SwapBattleShapeItem=game.SkinUI.extends({_itemGrid:null,ctor:function(e){this._super("bianshen/SwapBattleShapeItem","SwapBattleShapeItemSkin"),this._slotInfo=e},init:function(){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BATTLE_BIANSHEN_CONTAINER_ID),this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.addToParent(this._skin.head_node))},onShow:function(){this.setData(this._slotInfo),b8e.evt.onC(this._skin.btn_swap,this.onSwap,this)},onHide:function(){b8e.evt.offC(this._skin.btn_swap,this.onSwap,this)},setData:function(e){if(this._slotInfo=e,this._skin&&this._slotInfo){var t=game.bianshen.getBianshenInfoById(this._slotInfo.bianshenId);t&&(game.GridUtil.setBianshenGrid(this._itemGrid,t,!1,!1,!1,!1,!0,!0,!0,!1),this._itemGrid.sortLayer()),this._skin.lab_shape.string=""+(this._slotInfo.index+1);var i=this._slotInfo.bianshenId==game.bianshen.curBianshenId;this._skin.btn_swap.active=!i,this._skin.pic_battle.active=i}},onSwap:function(){if(this._slotInfo)if(game.bianshen.getIsInBattleSlotByid(game.bianshen.curBianshenId)){var e=game.bianshen.getBianshenSlotInfoByid(game.bianshen.curBianshenId);e&&game.bianshen.swapBianshenSlot(e.index,this._slotInfo.index)}else game.bianshen.sendIntoBattleSlotRequest(game.bianshen.curBianshenId,this._slotInfo.index)},getHeight:function(){return 260},getWidth:function(){return 150}})},{}],190:[function(e,t,i){"use strict";game.appModule.SwapBattleShapePanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.SwapBattleShapeItem))},onShow:function(){this._list&&this._list.show(),this.setSwapBattleItem(),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.setSwapBattleItem),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.setSwapBattleItem)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.setSwapBattleItem),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.setSwapBattleItem)},setSwapBattleItem:function(){if(this._list){var e=game.bianshen.getBattleSlots();!e||e.length<=0||this._list.setData(e)}}})},{}],191:[function(e,t,i){"use strict";e("./BianshenAutoSelectPanel"),e("./BianshenBackPanel"),e("./BianshenBattleItem"),e("./BianshenBattleListPanel"),e("./BianshenDetailsPanel"),e("./BianshenJinjiePanel"),e("./BianshenSelectBackPanel"),e("./BianshenSelectPanel"),e("./BianshenSlotGrid"),e("./BianshenUpgradePanel"),e("./BianshenMaterialGrid"),e("./SwapBattleShapePanel"),e("./SwapBattleShapeItem")},{"./BianshenAutoSelectPanel":167,"./BianshenBackPanel":168,"./BianshenBattleItem":169,"./BianshenBattleListPanel":170,"./BianshenDetailsPanel":175,"./BianshenJinjiePanel":178,"./BianshenMaterialGrid":179,"./BianshenSelectBackPanel":183,"./BianshenSelectPanel":185,"./BianshenSlotGrid":186,"./BianshenUpgradePanel":188,"./SwapBattleShapeItem":189,"./SwapBattleShapePanel":190}],192:[function(e,t,i){"use strict";var n=game.BianshenSender=function(){};n.QryBianshenModuleModelRequest=function(){var e=game.pbmid.Char.QryBianshenModuleModelRequest;b8e.sendN(e)},n.IntoBattleSlotRequest=function(e,t){var i=game.pbmsg.IntoBattleSlotRequest;i.index=e,i.bianshenId=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Char.IntoBattleSlotRequest;b8e.sendN(n)},n.OffBattleSlotRequest=function(e){var t=game.pbmsg.OffBattleSlotRequest;t.index=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.OffBattleSlotRequest;b8e.sendN(i)},n.SwapBattleSlotBianshensRequest=function(e,t){var i=game.pbmsg.SwapBattleSlotBianshensRequest;i.index1=e,i.index2=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Char.SwapBattleSlotBianshensRequest;b8e.sendN(n)},n.UpdateBianshenProtectStateRequest=function(e,t){var i=game.pbmsg.UpdateBianshenProtectStateRequest;i.bianshenId=e,i.toBeProteced=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Char.UpdateBianshenProtectStateRequest;b8e.sendN(n)},n.UpgradeBianshenJieRequest=function(e,t){var i=game.pbmsg.UpgradeBianshenJieRequest;i.bianshenId=e,i.costBianshenIds=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Char.UpgradeBianshenJieRequest;b8e.sendN(n)},n.AddExpForBianshenRequest=function(e,t,i){var n=game.pbmsg.AddExpForBianshenRequest;n.bianshenId=e,n.costMaterialIds=t,n.costBianshenIds=i,engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Char.AddExpForBianshenRequest;b8e.sendN(s)},n.FetterInfoRequest=function(e){var t=game.pbmsg.FetterInfoRequest;t.bianshenProtoId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.FetterInfoRequest;b8e.sendN(i)},n.FetterUnlockRequest=function(e,t,i,n){var s=game.pbmsg.FetterUnlockRequest;s.bianshenProtoId=e,s.fetterType=t,s.fetterLevel=i,engine.NetSender.getBytes().writeProtobuf(s);var a=game.pbmid.Char.FetterUnlockRequest;b8e.sendN(a)},n.ResolveBianshenRequest=function(e){var t=game.pbmsg.ResolveBianshenRequest;t.idx=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ResolveBianshenRequest;b8e.sendN(i)},n.ConvertBianshenRequest=function(e){var t=game.pbmsg.ConvertBianshenRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ConvertBianshenRequest;b8e.sendN(i)},n.ActivateBianshenRequest=function(e){var t=game.pbmsg.ActivateBianshenRequest;t.protoId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ActivateBianshenRequest;b8e.sendN(i)}},{}],193:[function(e,t,i){"use strict";e("./BianshenSender")},{"./BianshenSender":192}],194:[function(e,t,i){"use strict";e("./event/eventIndex_2"),e("./manager/managerIndex_2"),e("./panel/panelIndex_2")},{"./event/eventIndex_2":197,"./manager/managerIndex_2":199,"./panel/panelIndex_2":201}],195:[function(e,t,i){"use strict";game.AttributesEvents=b8e.Enum({ATTR_UPDATA:b8e.Event.nextCode(),BASE_ATTR_UPDATE:b8e.Event.nextCode()})},{}],196:[function(e,t,i){"use strict";game.BossEvents=b8e.Enum({BOSS_EMERGE:b8e.Event.nextCode(),BOSS_CLEAR:b8e.Event.nextCode()})},{}],197:[function(e,t,i){"use strict";e("./AttributesEvents"),e("./BossEvent")},{"./AttributesEvents":195,"./BossEvent":196}],198:[function(e,t,i){"use strict";game.BossMgr=b8e.Object.extends({owner:null,ctor:function(){this._super(),this.owner=[]},setOwner:function(e){e&&(b8e.log("归属改变",e.monsterId,e.ownerName),this.owner[e.monsterId]=e,b8e.evt.dptG(this,game.SceneEvent.DROP_ITEM_OWNER_CHANGE))},getOwner:function(e){return this.owner[e]}}),game.BossMgr._instance=null,game.BossMgr.inst=function(){return null==game.BossMgr._instance&&(game.BossMgr._instance=new game.BossMgr),game.BossMgr._instance}},{}],199:[function(e,t,i){"use strict";e("./BossMgr")},{"./BossMgr":198}],200:[function(e,t,i){"use strict";game.BossUI=game.SkinUI.extends({_bossUI:null,_isPersonal:!0,data:null,_iconSprite:null,_progressWidth:0,_lastHpBarIndex:0,_hpBarCount:1,_hpBarArray:null,_bgBarArray:null,ctor:function(){this._super("boss/BossSkin","BossSkin")},initBar:function(){this._hpBarArray||(this._hpBarArray=[this._skin.hpBar1,this._skin.hpBar2,this._skin.hpBar3]),this._bgBarArray||(this._bgBarArray=[this._skin.bgBar1,this._skin.bgBar2,this._skin.bgBar3])},onShow:function(){this.initBar(),this._bossUI=this._skin,this._progressWidth=this._bossUI.progress_boss_hp.width,this.showPanel(),this.onResize()},showPanel:function(){this._bossUI&&this.data&&(this.setBossAtt(this.data),this.setBossdata(this.data),b8e.evt.addG(this,game.AttributesEvents.ATTR_UPDATA,this.updateAttr),b8e.evt.addG(this,game.SceneEvent.DROP_ITEM_OWNER_CHANGE,this.dropItemOwnerChange))},hidePanel:function(){this._bossUI&&(b8e.evt.rmvG(this,game.AttributesEvents.ATTR_UPDATA,this.updateAttr),b8e.evt.rmvG(this,game.SceneEvent.DROP_ITEM_OWNER_CHANGE,this.dropItemOwnerChange),this.initBossAtt())},updateAttr:function(){var e=game.ScenePickMgr.inst().getTarget();e&&e.data&&e.data.id==this.data.id&&(this.setBossAtt(e.data),this.data=e.data)},setBossAtt:function(e){if(e){this._bossUI.lab_boss_name.string=e.name;var t=e.spriteStat;if(t){var i=t.getStatDataByType(game.SpriteStatType.HP),n=t.getStatDataByType(game.SpriteStatType.MAXHP);if(i&&n){e.getMonsterType();game.MonsterType.WORLD_BOSS,this._bossUI.lab_boss_hp.node.active=!1,this.updateHpBar(i.value,n.value)}else b8e.log("场景实体不存在血量？",e.name)}this.dropItemOwnerChange()}},updateHpBar:function(e,t){for(var i,n,s=e/t*this._hpBarCount>>0,a=t/this._hpBarCount,o=e-s*a,r=s%this._hpBarArray.length,h=0;h<this._hpBarArray.length;h++)i=this._hpBarArray[h],n=this._bgBarArray[h],h==r?(i.active=!0,n.active=0!=s):(i.active=!1,n.active=!1);var g=o/a*(i=this._hpBarArray[r]).width;s<this._lastHpBarIndex?(this._skin.progress_mask.width=i.width,b8e.Tween.get(this._skin.progress_mask).to({width:g},100),this._skin.tweenHpBarMask.width=i.width):(this._skin.tweenHpBarMask.width=this._skin.progress_mask.width,b8e.Tween.get(this._skin.progress_mask).to({width:g},100)),b8e.Tween.get(this._skin.tweenHpBarMask).to({width:g},500),this._lastHpBarIndex=s,this._skin.hpBarCount.string="x"+(s+1)},setBossdata:function(e){var t=game.ccfg.MonsterCfg.getMonsterModelById(e.modelId);if(t){this._hpBarCount=t.hpBarCount?t.hpBarCount:1,this._lastHpBarIndex=this._hpBarCount,this._bossUI.lab_desc.string=game.html.getText(game.html.Q_YELLOW,"lv"+t.level+t.name);var i=e.getMonsterHeadId(),n=game.ClientCfg.getHeadportraitUrlByIconName(i);this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_boss_head)),this._iconSprite.loadTexture(n,null,null,{useManifest:!1}),e.getMonsterType()==game.MonsterType.WORLD_BOSS&&game.worldBoss.setSceneWorldBoss()}},dropItemOwnerChange:function(){if(this.data){var e=game.BossMgr.inst().getOwner(this.data.id),t=game.ccfg.MonsterCfg.getMonsterModelById(this.data.modelId);if(e){var i=game.html.getText(game.html.Q_YELLOW,"lv"+t.level+this.data.name),n=game.html.getText(game.html.Q_GREEN,"归属("+e.ownerName+")"),s=this.setLabelSize(n);this._bossUI.lab_desc.string=i+s}}},initBossAtt:function(){this._bossUI.lab_boss_name.string="",this._bossUI.lab_boss_level.string="",this._bossUI.lab_boss_hp.string="",this._bossUI.lab_desc.string="",this._bossUI.lab_boss_hp.node.active=!1},setLabelSize:function(e){var t="<size=18> "+e+"</size>";return t="<outline color=black width=1>"+t+"</outline>"},onHide:function(){this.hidePanel()},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=(b8e.stageWidth-this.width)/2+e,this.y=b8e.stageHeight-this.height-153+t)}})},{}],201:[function(e,t,i){"use strict";e("./BossUI")},{"./BossUI":200}],202:[function(e,t,i){"use strict";e("./panel/panelIndex_88")},{"./panel/panelIndex_88":205}],203:[function(e,t,i){"use strict";game.CardRechargeType=b8e.Enum({MONTH:0,SEASON:1,FOREVER:2})},{}],204:[function(e,t,i){"use strict";game.appModule.CardRechargePanel=game.SkinUIPanel.extends({_index:0,_bgSprite:null,_tagSprite:null,_cardSprite:null,_titleSprite:null,_cardYuanbaoIcon:null,_cardArr:null,ctor:function(e){this._super(e),this._cardArr=[]},init:function(){this._cardSprite=b8e.Sprite.get(),this._cardSprite.addToParent(this._skin.img_card),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite1=b8e.Sprite.get(),this._bgSprite1.addToParent(this._skin.node_bg1),this._bgSprite1.loadTexture(game.ClientCfg.getImgUrl("cardRecharge/bg1",!1),null,null,{useManifest:!1}),this._tagSprite=b8e.Sprite.get(),this._tagSprite.addToParent(this._skin.node_tag),this._tagSprite.loadTexture(game.ClientCfg.getImgUrl("cardRecharge/tag",!1),null,null,{useManifest:!1}),this._titleSprite=b8e.Sprite.get(),this._titleSprite.addToParent(this._skin.node_title),this._titleSprite.loadTexture(game.ClientCfg.getImgUrl("cardRecharge/titleBg",!1),null,null,{useManifest:!1}),this._cardYuanbaoIcon=b8e.Sprite.get(),this._cardYuanbaoIcon.addToParent(this._skin.img_yuanbao),this._cardYuanbaoIcon.loadTexture(game.ClientCfg.getImgUrl("item/20002"),null,null,{useManifest:!1}),this._cardYuanbaoIcon.setScale(.8,.8)},onShow:function(){this.updatePanel(),b8e.evt.onC(this._skin.btn_left,this.onClickLeft,this),b8e.evt.onC(this._skin.btn_right,this.onClickRight,this),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.onC(this._skin.toggle[0].node,this.onClickMount,this),b8e.evt.onC(this._skin.toggle[1].node,this.onClickSeason,this),b8e.evt.onC(this._skin.toggle[2].node,this.onClickForever,this),b8e.evt.addG(this,game.PayEvents.COLLECT_CARD_AWARD_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel)},onHide:function(){b8e.evt.offC(this._skin.btn_left,this.onClickLeft,this),b8e.evt.offC(this._skin.btn_right,this.onClickRight,this),b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.offC(this._skin.toggle[0].node,this.onClickMount,this),b8e.evt.offC(this._skin.toggle[1].node,this.onClickSeason,this),b8e.evt.offC(this._skin.toggle[2].node,this.onClickForever,this),b8e.evt.rmvG(this,game.PayEvents.COLLECT_CARD_AWARD_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel)},updatePanel:function(){this._cardArr=game.ccfg.CardRechargeCfg.getCardRechargeArr(),this._cardArr.length<=0||(this._cardArr.sort(this.onSort),this.updateAlert(this._cardArr),this.selectCard(this._index))},updateAlert:function(e){this._skin.alert1.active=game.pay.getAlertByCardType(game.CardRechargeType.MONTH),this._skin.alert2.active=game.pay.getAlertByCardType(game.CardRechargeType.SEASON),this._skin.alert3.active=game.pay.getAlertByCardType(game.CardRechargeType.FOREVER)},selectCard:function(e){if(!(this._cardArr.length<=0)){var t=this._cardArr[e];if(t){this._itemId=t.itemId,this._cardType=t.cardType,this._skin.lab_yuanbao.string=t.diamondDaily,this._skin.lab_desc.string=game.ccfg.LangCfg.getText(77e3,[t.diamondDaily,t.addAwardRate,t.addAwardRate,t.addMaterialRate]),this._cardSprite.loadTexture(game.ClientCfg.getImgUrl(t.cardIcon,!1),null,null,{useManifest:!1}),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl(t.cardBg,!1),null,null,{useManifest:!1}),this._skin.node_remain.active=this._cardType!=game.CardRechargeType.FOREVER;var i=game.pay.getCardsInfo(this._cardType);if(i){this._skin.img_remain.active=!0,this._skin.img_total.active=!1,this._skin.lab_buy.string="领  取";var n=game.pay.getRemainDays(i.expireTime);this._cardType==game.CardRechargeType.FOREVER?this._skin.lab_remain.string="永久可领":this._skin.lab_remain.string=game.ccfg.LangCfg.getText(77001,[n]),this._isReceive=i.collectedPrizeDaily,this._isReceive?(this._skin.btn_buy.active=!1,this._skin.img_get.active=!0,this._skin.lab_remainYuanbao.string=n*t.diamondDaily):(this._skin.btn_buy.active=!0,this._skin.img_get.active=!1,this._skin.lab_remainYuanbao.string=(n+1)*t.diamondDaily)}else{this._skin.lab_remainYuanbao.string=t.validDays*t.diamondDaily,this._skin.lab_remain.string="",this._cardType==game.CardRechargeType.FOREVER?this._skin.lab_remain.string="永久可领":this._skin.lab_remain.string=game.ccfg.LangCfg.getText(77002,[t.validDays]),this._skin.img_remain.active=!1,this._skin.img_total.active=!0,this._skin.btn_buy.active=!0,this._skin.img_get.active=!1;var s=game.ccfg.RechargeCfg.getRecharge(this._itemId);if(!s)return;if(game.IS_HUO_SHU){var a=game.HuoShuSDK.getAppId();("2038"==a||"2066"==a)&&game.LoginConfig.isExchangeType?this._skin.lab_buy.string=s.money*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name+"购买":this._skin.lab_buy.string=s.money+"元购买"}else this._skin.lab_buy.string=s.money+"元购买"}}}},onClickLeft:function(){var e;e=0==this._index?this._cardArr.length-1:this._index-1,this.clickCard(e)},onClickRight:function(){var e;e=this._index==this._cardArr.length-1?0:this._index+1,this.clickCard(e)},onClickMount:function(){this.clickCard(0)},onClickSeason:function(){this.clickCard(1)},onClickForever:function(){this.clickCard(2)},clickCard:function(e){this._index!=e&&(this._index=e,this._skin.toggle[this._index].check(),this.selectCard(this._index))},onClickBuyBtn:function(){var e=game.pay.getCardsInfo(this._cardType);if(e){if(e.collectedPrizeDaily)return void game.notice.show("您已经领取过了");game.PaySender.reqCardAward(this._cardType)}else if(game.pay.isGetSeverData){var t={itemId:this._itemId};game.sdk.pay(t)}else game.notice.show("数据发生错误，请重新登陆！")},onSort:function(e,t){return e.itemId-t.itemId}})},{}],205:[function(e,t,i){"use strict";e("./CardRechargePanel")},{"./CardRechargePanel":204}],206:[function(e,t,i){"use strict";game.ChallangeDailyPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("challange/ChallangeDailySkin","ChallangeDailySkin")},init:function(){this._list=new b8e.List(this._skin.list,game.ChallangeItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],207:[function(e,t,i){"use strict";game.ChallangeItem=game.SkinUI.extends({_list:null,_wanfaInfo:null,_cardSprite:null,ctor:function(){this._super("challange/ChallangeItemSkin","ChallangeItemSkin")},onShow:function(){this.setData(this._wanfaInfo),b8e.evt.onC(this._skin.node_click,this.onClick,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClick,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},getButtonByName:function(e){switch(e){case"node_click":return!this._skin||this._skin.node_click}return null},setData:function(e){if(this._wanfaInfo=e,this._skin&&this._wanfaInfo){this._cardSprite||(this._cardSprite=b8e.Sprite.get(),this._cardSprite.addToParent(this._skin.node_img),this._cardSprite.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!0),null,null,{useManifest:!1})),""!=e.timeDesc&&(this._skin.lab_desc.string=e.timeDesc);var t=game.ccfg.ClientTriggerCfg.getDataById(e.triggerId);if(t){var i=game.ccfg.ClientCommandCfg.getDataById(t.triggerCommandIds);if(i&&i.functionOpenId){var n=game.ccfg.ClientFunctionOpenCfg.getDataById(i.functionOpenId);if(n){var s="";if(-1<(s=n.closeTips).indexOf("{TaskDiffSeq}")){var a,o=0,r=game.quest.questInfo;r&&(o=r.sequence);var h=n.questId;s=0<(a=((r=0<h?game.ccfg.MainQuestCfg.getQuestById(h):null)?r.sequence:0)-o+1)?s.replace("{TaskDiffSeq}",a):""}game.mainRole.mainRoleData.getLv()<n.minLevel?this._skin.lab_task.string=s:this._skin.lab_task.string=""}}}}},onSpotAlertChange:function(){this._skin&&this._wanfaInfo&&(this._skin.red_point.active=this.isShowRedPoint(this._wanfaInfo.id))},isShowRedPoint:function(e){var t=!1;if(!this._wanfaInfo)return t;switch(e){case game.WanfaItemType.CAILIAOBAOKU:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MATERIAL_ALERT);break;case game.WanfaItemType.JINGYINBOOS:t=game.loneyDungeon.getLoneyDungeonIsAlert();break;case game.WanfaItemType.TIANTIANZHANGYAO:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ZHANYAO_ALERT);break;case game.WanfaItemType.SANZAHNGJIANGJIN:t=game.sceneRole.isInBubbleExp;break;case game.WanfaItemType.TOWER:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.TOWER_ALERT);break;case game.WanfaItemType.CHUMO:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CHUMO_ALERT)}return t},onClick:function(){this._wanfaInfo.triggerId&&game.TriggerMgr.inst().customTriggerById(this._wanfaInfo.triggerId),this._wanfaInfo.functionId&&game.funcOpen.checkOpen(this._wanfaInfo.functionId)&&game.app.hide(game.AppConstant.CHALLANGE_PANEL)},getHeight:function(){return 153},getWidth:function(){return 540}})},{}],208:[function(e,t,i){"use strict";game.appModule.ChallangePanel=game.SkinUIPanel.extends({_task:null,_daily:null,_index:-1,_loneyDungeonIsAlert:!1,_curPanel:null,ctor:function(e){this._super(e)},onShow:function(){this.data&&(this._index=Math.max(this.data,0)),this._index=Math.max(this.data,0),this._loneyDungeonIsAlert=game.loneyDungeon.getLoneyDungeonIsAlert(),this.onSelectPanelByIndex(this._index),this.changeRedPoint(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickTaskBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickDailyBtn,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAlert),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateAlert),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.updateAlert)},onHide:function(){this._curPanel&&this._curPanel.hide(),this._index=-1,b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickTaskBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickDailyBtn,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAlert),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateAlert),b8e.evt.rmvG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.updateAlert)},changeRedPoint:function(){},onClickTaskBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickDailyBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onSpotAlertChange:function(){this._skin&&(this._skin.taskPoint.active=!!this._loneyDungeonIsAlert||game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_CHALLANGE_TASK_ALERT),this._skin.daliyPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_CHALLANGE_DAILY_ALERT))},updateAlert:function(){this._loneyDungeonIsAlert=game.loneyDungeon.getLoneyDungeonIsAlert()},onSelectPanelByIndex:function(e){switch(this._curPanel&&this._curPanel.hide(),this._index=e,game.wanfa.page=e,this._skin.title.string=game.ClientCfg.challange,e){case 0:this._task||(this._task=new game.ChallangeTaskPanel,this._task.addToParent(this._skin.page)),this._skin.buttonToggle[e].check(),this._task.show(),this._curPanel=this._task;break;case 1:this._daily||(this._daily=new game.ChallangeDailyPanel,this._daily.addToParent(this._skin.page)),this._skin.buttonToggle[e].check(),this._daily.show(),this._curPanel=this._daily}},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(0|e),this._skin.buttonToggle[e]):"1"!=e||(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(0|e),this._skin.buttonToggle[e]))},getButtonByName:function(e){var t=null;switch(e){case game.ClientCfg.challange_task:this._skin&&(t=this._skin.buttonToggle[0].node);break;case game.ClientCfg.challange_daily:this._skin&&(t=this._skin.buttonToggle[1].node);break;case"material":return!(this._skin&&this._task&&(t=this._task.getButtonByName("material")))||t;case"loney":case"loneyFight":return!(this._skin&&this._task&&(t=this._task.getButtonByName(e)))||t}return t}})},{}],209:[function(e,t,i){"use strict";game.ChallangeTaskPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("challange/ChallangeTaskSkin","ChallangeTaskSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.ChallangeItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},getButtonByName:function(e){switch(e){case game.ClientCfg.challange_material:if(this._list)if(t=this._list.getItemRender(0))if(i=t.getButtonByName("node_click"))return i;return!0;case"loney":var t,i;if(this._list)if(t=this._list.getItemRender(2))if(i=t.getButtonByName("node_click"))return i;return!0}return null},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],210:[function(e,t,i){"use strict";game.AutoEquipEvent=b8e.Enum({UPDATE_AUTOEQUIP:b8e.Event.nextCode()})},{}],211:[function(e,t,i){"use strict";game.AutoEquipMgr=b8e.Object.extends({goodsIdList:null,itemInfoMap:null,ctor:function(){this._super(),this.goodsIdList=[]},onChangeEquip:function(){this.checkFitEquip()&&(game.app.isShow(game.AppConstant.AUTOEQUIP_PANEL)?b8e.evt.dptG(game.AutoEquipEvent.UPDATE_AUTOEQUIP):game.app.show(game.AppConstant.AUTOEQUIP_PANEL))},onUpdateAutoEquip:function(){game.app.isShow(game.AppConstant.AUTOEQUIP_PANEL)&&(this.checkFitEquip()?b8e.evt.dptG(game.AutoEquipEvent.UPDATE_AUTOEQUIP):game.app.hide(game.AppConstant.AUTOEQUIP_PANEL))},checkFitEquip:function(){var e=game.mainRole.mainRoleData;if(this.goodsIdList.length=0,!e||!e.equipSlotsMap)return!1;var t=e.equipSlotsMap.keys();if(!t||t.length<=0)return!1;for(var i=0;i<t.length;++i){var n=game.back.getBestFitEquipByType(t[i]);if(n){if(!this.checkHasEquipByType(t[i]))continue;this.goodsIdList.push(n)}}return!!(this.goodsIdList&&0<this.goodsIdList.length)},checkHasEquipByType:function(e){var t=game.mainRole.mainRoleData;if(t&&t.equipSlotsMap)return!!t.equipSlotsMap.get(e).equip;return!1},clearGoodIdList:function(){this.goodsIdList.length=0},getGoodId:function(){return 0<this.goodsIdList.length?this.goodsIdList[0]:null},onPutOnEquip:function(e){if(e)if(0!=this.goodsIdList.length)for(var t=this.goodsIdList.length-1;0<=t;t--){var i=this.goodsIdList[t];i&&e.idx==i.idx&&(this.goodsIdList.shift(),b8e.evt.dptG(game.AutoEquipEvent.UPDATE_AUTOEQUIP))}else game.app.hide(game.AppConstant.AUTOEQUIP_PANEL)}}),game.AutoEquipMgr._instance=null,game.AutoEquipMgr.inst=function(){return game.AutoEquipMgr._instance||(game.AutoEquipMgr._instance=new game.AutoEquipMgr),game.AutoEquipMgr._instance}},{}],212:[function(e,t,i){"use strict";game.appModule.AutoEquipPanel=game.SkinUIPanel.extends({_itemGrid:null,_itemInfo:null,_useButtonLabel:null,ctor:function(e){this._super(e)},init:function(){this._itemGrid=game.GridUtil.creatItemGrid(this,this._skin.imgIcon),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.AOTU_EQUIP_CONTAINER_ID)},onShow:function(){this.updateData(),b8e.evt.addG(this,game.AutoEquipEvent.UPDATE_AUTOEQUIP,this.updateData),b8e.evt.addG(this,game.EquipEvt.PUT_ON_EQUIP,this.onPutOnEquip),b8e.evt.onC(this._skin.btn_Close,this.onClickCloseBtn,this),b8e.evt.onC(this._skin.btn_dress,this.onClickDress,this)},onHide:function(){b8e.evt.offC(this._skin.btn_dress,this.onClickDress,this),b8e.evt.rmvG(this,game.AutoEquipEvent.UPDATE_AUTOEQUIP,this.updateData),b8e.evt.rmvG(this,game.EquipEvt.PUT_ON_EQUIP,this.onPutOnEquip),b8e.evt.offC(this._skin.btn_Close,this.onClickCloseBtn,this),game.GridUtil.setItemGrid(this._itemGrid,null)},updateData:function(){if(this._skin){var e=game.autoEquip.getGoodId();if(e){this._skin.lab_equip_name.string=e.name;var t=game.html.getColorByQuality(e.quality);this._skin.lab_equip_name.node.color=b8e.ColorUtil.toCCColor(t),this._skin.lab_power.string=e.power,game.GridUtil.setItemGrid(this._itemGrid,e),this._itemGrid.sortLayer(),this._itemInfo=e}else this.hide(),game.autoEquip.clearGoodIdList()}},onPutOnEquip:function(e){if(e&&e.data){var t=e.data.equipSlotInfo;if(t){var i=t.equip;i&&game.autoEquip.onPutOnEquip(i)}}},onClickDress:function(){var e=game.autoEquip.getGoodId();e?game.equip.wearEquip(e):this.hide()},onClickCloseBtn:function(){game.autoEquip.onPutOnEquip(this._itemInfo)}})},{}],213:[function(e,t,i){"use strict";e("./panel/panelIndex_3"),e("./cmd/ChatCmd"),e("./event/ChatEvent"),e("./manager/ChatMgr"),e("./sender/ChatSender")},{"./cmd/ChatCmd":214,"./event/ChatEvent":216,"./manager/ChatMgr":217,"./panel/panelIndex_3":221,"./sender/ChatSender":222}],214:[function(e,t,i){"use strict";game.ChatCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Chat.ChatModuleProto,this.onChatModuleProto,this),b8e.addNH(game.pbmid.Chat.GetHistoryChatResponse,this.onGetHistoryChatResponse,this),b8e.addNH(game.pbmid.Chat.ChatSuccess,this.onChatSuccess,this),b8e.addNH(game.pbmid.Chat.ChatBroadcast,this.onChatBroadcast,this),b8e.addNH(game.pbmid.Chat.PrivateChatHistoryProto,this.onPrivateChatHistoryProto,this),b8e.addNH(game.pbmid.Chat.RemovePrivateChatResponse,this.onRemovePrivateChatResponse,this)},onRemovePrivateChatResponse:function(e){var t=e.readProtobuf(game.pbmsg.RemovePrivateChatResponse);t&&game.relationChat.removeChat(t.roleId)},onPrivateChatHistoryProto:function(e){var t=e.readProtobuf(game.pbmsg.PrivateChatHistoryProto);t&&game.relationChat.setupData(t)},onChatBroadcast:function(e){var t=e.readProtobuf(game.pbmsg.ChatBroadcast);t&&game.chat.chatBroadcast(t)},onChatSuccess:function(e){var t=e.readProtobuf(game.pbmsg.ChatSuccess);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.chat.sendSuccess(t))},onGetHistoryChatResponse:function(e){var t=e.readProtobuf(game.pbmsg.GetHistoryChatResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.chat.initChatPanelInfo(t))},onChatModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.ChatModuleProto);t&&game.chat.initChat(t)}})},{}],215:[function(e,t,i){"use strict";game.ChatFuncType=b8e.Enum({CHAT_FUNC_NONE:0,CHAT_FUNC_TEAM_BOSS:1})},{}],216:[function(e,t,i){"use strict";game.ChatEvent=b8e.Enum({CUR_CHAT_PANEL_INFO_CHANGE:b8e.Event.nextCode(),CUR_CHAT_ADD_CHAT_ITEM_INFO:b8e.Event.nextCode(),WORLD_CHAT_FREE_TIME_CHANGE:b8e.Event.nextCode(),NEXT_CAN_WROLD_CHAT_TIME_CHANGE:b8e.Event.nextCode(),CHAT_SEND_SUCCESS:b8e.Event.nextCode()})},{}],217:[function(e,t,i){"use strict";game.ChatMgr=b8e.Object.extends({_worldChat:null,_guildChat:null,_systemChat:null,_csChat:null,_chatMap:null,_curChat:null,isInit:!1,nextCanWroldChatTime:0,todayWroldChatTime:0,nextCanCrossChatTime:0,todayCrossChatTimes:0,dontAlert:!1,lockSend:!1,ctor:function(){this._super(),this._worldChat=new game.ChatPanelInfo(game.ChatType.WORLD_CHAT),this._guildChat=new game.ChatPanelInfo(game.ChatType.GUILD_CHAT),this._systemChat=new game.ChatPanelInfo(game.ChatType.SYSTEM_CHAT),this._csChat=new game.ChatPanelInfo(game.ChatType.CS_CHAT),this._relationChat=new game.RelationChatInfo,this._systemChat.isInit=!0,this._chatMap=b8e.HashMap.get(),this._chatMap.set(game.ChatType.WORLD_CHAT,this._worldChat),this._chatMap.set(game.ChatType.GUILD_CHAT,this._guildChat),this._chatMap.set(game.ChatType.SYSTEM_CHAT,this._systemChat),this._chatMap.set(game.ChatType.CS_CHAT,this._csChat)},resetDaily:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_FREE_TIME);this.todayWroldChatTime=e,this.isInit=!1},init:function(){0==this.isInit?game.ChatSender.initChat():(b8e.evt.dptG(game.ChatEvent.WORLD_CHAT_FREE_TIME_CHANGE),b8e.evt.dptG(game.ChatEvent.NEXT_CAN_WROLD_CHAT_TIME_CHANGE))},initChat:function(e){if(e){this.isInit=!0,this.nextCanWroldChatTime=e.nextCanWorldChatTime,this.nextCanCrossChatTime=e.nextCanCrossChatTime;var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_FREE_TIME);this.todayCrossChatTimes=t-e.todayCrossChatTimes,this.todayWroldChatTime=t-e.todayWorldChatTimes,b8e.evt.dptG(game.ChatEvent.WORLD_CHAT_FREE_TIME_CHANGE),b8e.evt.dptG(game.ChatEvent.NEXT_CAN_WROLD_CHAT_TIME_CHANGE)}},selectChat:function(e){this._curChat&&(this._curChat.logCount=0),this._curChat=this._chatMap.get(e),this._curChat&&(this._curChat.logCount=0),(e!=game.ChatType.GUILD_CHAT||0!=game.guild.isHasGuild())&&0==this._curChat.isInit?game.ChatSender.initChatType(e):b8e.evt.dptG(game.ChatEvent.CUR_CHAT_PANEL_INFO_CHANGE)},getCurChat:function(){return this._curChat},initChatPanelInfo:function(e){if(e){var t=this._chatMap.get(e.type);t&&(t.setup(e.chatContent),b8e.evt.dptG(game.ChatEvent.CUR_CHAT_PANEL_INFO_CHANGE))}},sendChat:function(e){var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_MAX_LEN);if(e&&0!=e.length)if(e.length>t)game.notice.show("文字长度超过"+t);else switch(this._curChat.type){case game.ChatType.CS_CHAT:case game.ChatType.WORLD_CHAT:this._sendWorldChat(this._curChat.type,e);break;case game.ChatType.GUILD_CHAT:this._sendChat(this._curChat.type,e);break;default:b8e.error("sendChat 未知的当前类型")}},_sendWorldChat:function(e,t){if(game.SysTime.curTime<this.nextCanWroldChatTime)game.notice.show("发送过于频繁");else{var i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_LV);if(game.mainRole.mainRoleData.getLv()<i)game.notice.show("未满"+i+"级无法在世界频道发送信息");else{game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_FREE_TIME);if((this.todayWroldChatTime<=0&&e==game.ChatType.WORLD_CHAT||this.todayCrossChatTimes<=0&&e==game.ChatType.CS_CHAT)&&0==this.dontAlert){var n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.VIP_FREE_TALK);if(game.vip.getVipLv()<n){var s="",a=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_CHAT_COST).split("|");2==a.length&&(s="本次发言需要消耗"+a[1]+"元宝");var o=new game.GameAlertInfo;return o.alertType=game.GameAlertType.TwoBtn,o.string=s,o.desc=game.ccfg.LangCfg.getText(23e3),o.descFunc=this.onDescFunc,o.obj={type:e,chatContent:t},o.isShowTips=!0,void game.gameAlert.showAlert(this,this.onCheckWorldChatClickBtn,o)}}this._sendChat(e,t)}}},onDescFunc:function(){game.pay.isRechargePanel=!1,game.app.show(game.AppConstant.PAY_PANEL)},onCheckWorldChatClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:var i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_CHAT_COST).split("|"),n=game.ccfg.ItemInfoCfg.getItemInfoById(i[0]);game.upgrade.costCheckMoney(n.type,i[1],!0,!0)&&this._sendChat(e.obj.type,e.obj.chatContent);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sendGuildChatContent:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._sendChat(game.ChatType.GUILD_CHAT,e,t)},_sendChat:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];1!=this.lockSend?(this.lockSend,b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e3).call(this._unLockSend),game.ChatSender.sendChat(e,t,0,i)):game.notice.show("发言过于频繁")},_unLockSend:function(){this.lockSend},addSystemChat:function(e){var t=this._chatMap.get(game.ChatType.SYSTEM_CHAT),i=t.addSysTem(e);t=this._chatMap.get(game.ChatType.WORLD_CHAT);var n=this._curChat!=t;t.addSysTem(e,n),b8e.evt.dptG(game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,i)},sendSuccess:function(e){if(e.type==game.ChatType.CHAT_PRIVATE)game.relationChat.sendSuccess();else{this.lockSend;var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_SPEED_TIME),i=game.SysTime.curTime;e.type==game.ChatType.WORLD_CHAT?(this.todayWroldChatTime--,this.nextCanWroldChatTime=i+1e3*t):e.type==game.ChatType.CS_CHAT&&(this.todayCrossChatTimes--,this.nextCanCrossChatTime=i+1e3*t),b8e.evt.dptG(game.ChatEvent.NEXT_CAN_WROLD_CHAT_TIME_CHANGE),b8e.evt.dptG(game.ChatEvent.WORLD_CHAT_FREE_TIME_CHANGE),b8e.evt.dptG(game.ChatEvent.CHAT_SEND_SUCCESS)}},getCurChatNextChatTime:function(){return this._curChat?this._curChat.type==game.ChatType.WORLD_CHAT?this.nextCanWroldChatTime:this._curChat.type==game.ChatType.CS_CHAT?this.nextCanCrossChatTime:0:0},chatBroadcast:function(e){if(e){var t=e.chatContent;if(t&&!game.relation.isBlack(t.roleId))if(t.type==game.ChatType.CHAT_PRIVATE)game.relationChat.addChat(t);else{var i=this._chatMap.get(t.type),n=this._curChat!=i,s=i.addChat(t,n);b8e.evt.dptG(game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,s)}}},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.WORLD_CHAT_ALERT,null,this.worldChatAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_CHAT_ALERT,null,this.guildChatAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.SYSTEM_CHAT_ALERT,null,this.systemChatAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CS_CHAT_ALERT,null,this.csChatAlert,this)},csChatAlert:function(){return 0<this._csChat.logCount},worldChatAlert:function(){return 0<this._worldChat.logCount},guildChatAlert:function(){return 0<this._guildChat.logCount},systemChatAlert:function(){return 0<this._systemChat.logCount}}),game.ChatMgr._instance=null,game.ChatMgr.inst=function(){return game.ChatMgr._instance||(game.ChatMgr._instance=new game.ChatMgr),game.ChatMgr._instance}},{}],218:[function(e,t,i){"use strict";game.ChatItem=game.SkinUI.extends({_data:null,_head:null,_selfHead:null,_otherHead:null,_lastHead:null,chatItemIndex:0,ctor:function(){this._super("chat/ChatItemSkin","ChatItemSkin")},onShow:function(){this._selfHead||(this._selfHead=b8e.Sprite.get(),this._selfHead.setSize(58,58),this._selfHead.addToParent(this._skin.selfHead)),this._otherHead||(this._otherHead=b8e.Sprite.get(),this._otherHead.setSize(58,58),this._otherHead.addToParent(this._skin.otherHead)),b8e.evt.onC(this._otherHead,this.clickHead,this),b8e.evt.onC(this._selfHead,this.clickHead,this),this.setup(this._data,!0)},onHide:function(){b8e.evt.offC(this._otherHead,this.clickHead,this),b8e.evt.offC(this._selfHead,this.clickHead,this)},clickHead:function(e){var t=game.mainRole.mainRoleData;if(this._data&&t.playerId!=this._data.roleId&&this._data.type!=game.ChatType.CS_CHAT){var i=new game.MenuData;i.roleId=this._data.roleId,i.roleName=this._data.roleName,i.head=this._data.head,game.relation.isFriend(this._data.roleId)?game.menu.show(this,e,game.MenuList.FRIEND_MENU,i):game.menu.show(this,e,game.MenuList.NORMAL_MENU,i)}},setup:function(e,t){if((e!=this._data||t)&&(this._data=e,this._skin)){this._skin.systemNode.active=!1,this._skin.otherNode.active=!1,this._skin.selfNode.active=!1;this._skin.node;if(e.type==game.ChatType.SYSTEM_CHAT)this._skin.systemNode.active=!0,this._skin.systemContent.string=e.content;else{var i=game.mainRole.mainRoleData,n=game.guild.getRankName(e.guildOfficePos);if(i.playerId==e.roleId){if(this._skin.selfNode.active=!0,e.funcType==game.ChatFuncType.CHAT_FUNC_TEAM_BOSS){if(o=game.ccfg.DungeonCfg.getDungeonById(e.insId)){var s=o.name,a=game.ccfg.LangCfg.getText(27013);a=game.richText.getString(this,this._skin.selfContent,a,game.html.Q_GREEN,e,"100","onClickFunc",this.onClickFunc),this._skin.selfContent.string=game.ccfg.LangCfg.getText(27012,[e.roleName,s,a])}}else this._skin.selfContent.string=e.content;this._head=this._selfHead,this._otherHead.setVisible(!1),this._selfHead.setVisible(!0),e.type==game.ChatType.WORLD_CHAT?e.guildName?this._skin.selfTitle.string="【"+e.guildName+"】【"+n+"】"+e.roleName:this._skin.selfTitle.string=e.roleName:e.type==game.ChatType.CS_CHAT?e.guildName?this._skin.selfTitle.string="【 s."+e.zone+"】【"+e.guildName+"】【"+n+"】"+e.roleName:this._skin.selfTitle.string="【 s."+e.zone+"】"+e.roleName:e.guildName?this._skin.selfTitle.string="【"+n+"】"+e.roleName:this._skin.selfTitle.string=e.roleName}else{var o;if(this._skin.otherNode.active=!0,e.funcType==game.ChatFuncType.CHAT_FUNC_TEAM_BOSS){if(o=game.ccfg.DungeonCfg.getDungeonById(e.insId)){s=o.name,a=game.ccfg.LangCfg.getText(27013);a=game.richText.getString(this,this._skin.otherContent,a,game.html.Q_GREEN,e,"100","onClickFunc",this.onClickFunc),this._skin.otherContent.string=game.ccfg.LangCfg.getText(27012,[e.roleName,s,a])}}else this._skin.otherContent.string=e.content;this._head=this._otherHead,this._selfHead.setVisible(!1),this._otherHead.setVisible(!0),e.type==game.ChatType.WORLD_CHAT?e.guildName?this._skin.otherTitle.string="【"+e.guildName+"】【"+n+"】"+e.roleName:this._skin.otherTitle.string=e.roleName:e.type==game.ChatType.CS_CHAT?e.guildName?this._skin.otherTitle.string="【 s."+e.zone+"】【"+e.guildName+"】【"+n+"】"+e.roleName:this._skin.otherTitle.string="【 s."+e.zone+"】"+e.roleName:e.guildName?this._skin.otherTitle.string="【"+n+"】"+e.roleName:this._skin.otherTitle.string=e.roleName}var r=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=r&&r?this._head.loadTexture(game.ClientCfg.getHeadUrl(r),null,null,{useManifest:!1}):this._head.unloadTexture()}}},getHeight:function(){return this._data&&this._data.type==game.ChatType.SYSTEM_CHAT?70:90},onClickFunc:function(e,t){this._data&&game.team.joinOthersTeam(this._data.insId,this._data.teamId)}})},{}],219:[function(e,t,i){"use strict";game.appModule.ChatPanel=game.SkinUIPanel.extends({_chatItems:null,_chatItemPool:null,_csChatItems:null,_csChatItemPool:null,_normalItems:null,_normalItemPool:null,_systemItems:null,_systemItemPool:null,_guildItems:null,_guildItemPool:null,_content:null,_contentLen:0,_scrollView:null,_selectType:-1,_timer:null,_refreshTimer:null,_refreshIndex:0,_tempItem:null,_contentHeight:0,_scrollToBottom:!0,ctor:function(e){this._super(e),this._chatItems=[],this._chatItemPool=[],this._normalItems=[],this._systemItems=[],this._guildItems=[],this._csChatItems=[],this._normalItemPool=[],this._systemItemPool=[],this._guildItemPool=[],this._csChatItemPool=[]},setTab:function(e){return!!this._skin&&("0"==e?this.onSelectWorldChatBtn():"1"==e?this.onSelectCsChatBtn():"2"==e&&this.onSelectGuildChatBtn(),!0)},init:function(){this._tempItem=new game.ChatItem;for(var e=0;e<20;e++)this._normalItemPool.push(new game.ChatItem);for(e=0;e<20;e++)this._csChatItemPool.push(new game.ChatItem);for(e=0;e<20;e++)this._systemItemPool.push(new game.ChatItem);for(e=0;e<20;e++)this._guildItemPool.push(new game.ChatItem)},onClickEnter:function(e){e.keyCode==cc.KEY.enter&&this.sendChat()},onShow:function(){b8e.evt.addG(this,game.ChatEvent.CUR_CHAT_PANEL_INFO_CHANGE,this.onCurPanelInfoChange),b8e.evt.addG(this,game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,this._onAddChatInfo),b8e.evt.addG(this,game.ChatEvent.WORLD_CHAT_FREE_TIME_CHANGE,this.onWorldFreeTimeChange),b8e.evt.addG(this,game.ChatEvent.NEXT_CAN_WROLD_CHAT_TIME_CHANGE,this.onWorldChatTimeChange),b8e.evt.addG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateChatCost),b8e.evt.onC(this._skin.worldChatBtn,this.onSelectWorldChatBtn,this),b8e.evt.onC(this._skin.csChatBtn,this.onSelectCsChatBtn,this),b8e.evt.onC(this._skin.guildChatBtn,this.onSelectGuildChatBtn,this),b8e.evt.onC(this._skin.systemChatBtn,this.onSelectSystemChatBtn,this),b8e.evt.onC(this._skin.joinGuildBtn,this.onClickJoinGuildBtn,this),b8e.evt.onC(this._skin.sendBtn.node,this.onClickSendBtn,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onClickEnter,this),-1==this._selectType?game.chat.selectChat(game.ChatType.WORLD_CHAT):game.chat.selectChat(this._selectType),game.chat.init(),this.onWorldFreeTimeChange(),this.onWorldChatTimeChange(),this.onSpotAlertChange()},onHide:function(){b8e.evt.rmvG(this,game.ChatEvent.CUR_CHAT_PANEL_INFO_CHANGE,this.onCurPanelInfoChange),b8e.evt.rmvG(this,game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,this._onAddChatInfo),b8e.evt.rmvG(this,game.ChatEvent.WORLD_CHAT_FREE_TIME_CHANGE,this.onWorldFreeTimeChange),b8e.evt.rmvG(this,game.ChatEvent.NEXT_CAN_WROLD_CHAT_TIME_CHANGE,this.onWorldChatTimeChange),b8e.evt.rmvG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateChatCost),b8e.evt.offC(this._skin.worldChatBtn,this.onSelectWorldChatBtn,this),b8e.evt.offC(this._skin.csChatBtn,this.onSelectCsChatBtn,this),b8e.evt.offC(this._skin.guildChatBtn,this.onSelectGuildChatBtn,this),b8e.evt.offC(this._skin.systemChatBtn,this.onSelectSystemChatBtn,this),b8e.evt.offC(this._skin.joinGuildBtn,this.onClickJoinGuildBtn,this),b8e.evt.offC(this._skin.sendBtn.node,this.onClickSendBtn,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onClickEnter,this)},updateChatCost:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.VIP_FREE_TALK),t=game.vip.getVipLv();this._skin.chatCostIcon.node.active=!(e<=t),this._skin.chatTimes.node.active=!(e<=t)},onSpotAlertChange:function(){this._skin.worldChatAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WORLD_CHAT_ALERT),this._skin.guildChatAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_CHAT_ALERT),this._skin.systemChatAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.SYSTEM_CHAT_ALERT),this._skin.csChatAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CS_CHAT_ALERT)},onClickSendBtn:function(){this.sendChat()},onClickJoinGuildBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.GUILD)&&game.app.showAppHideOtherApp(game.AppConstant.GUILD_PANEL)},onSelectSystemChatBtn:function(){game.chat.selectChat(game.ChatType.SYSTEM_CHAT)},onSelectWorldChatBtn:function(){game.chat.selectChat(game.ChatType.WORLD_CHAT)},onSelectCsChatBtn:function(){game.chat.selectChat(game.ChatType.CS_CHAT)},onSelectGuildChatBtn:function(){game.chat.selectChat(game.ChatType.GUILD_CHAT)},sendChat:function(){if(this._skin){var e=this._skin.editBox.string,t=game.SysTime.curTime;0<game.chat.getCurChatNextChatTime()-t||game.chat.sendChat(e)}},onChatSendSuccess:function(){this._skin&&(this._skin.editBox.string="")},onCurPanelInfoChange:function(){this._refreshTimer&&this._refreshTimer.stop();var e,t=game.chat.getCurChat();if(t.chats){if(this._contentLen=t.chats.length,this._skin.lab_tip.node.active=!(0<this._contentLen),this._skin.systemChatNode.active=!1,this._skin.normalChatNode.active=!1,this._skin.joinGuildNode.active=!1,this._scrollView&&(this._scrollView.node.active=!1),t.type==game.ChatType.SYSTEM_CHAT)this._skin.systemChatNode.active=!0,this._chatItemPool=this._systemItemPool,this._chatItems=this._systemItems,this._content=this._skin.systemContent,this._scrollView=this._skin.systemScrollView,this._scrollToBottom=!1;else if(t.type==game.ChatType.GUILD_CHAT){var i=game.guild.isHasGuild();this._scrollToBottom=!0,i?this._skin.normalChatNode.active=!0:(this._skin.joinGuildNode.active=!0,this._skin.lab_tip.node.active=!1),this._chatItemPool=this._guildItemPool,this._chatItems=this._guildItems,this._content=this._skin.guildContent,this._scrollView=this._skin.guildSrollView}else t.type==game.ChatType.WORLD_CHAT?(this._skin.normalChatNode.active=!0,this._chatItemPool=this._normalItemPool,this._chatItems=this._normalItems,this._content=this._skin.normalContent,this._scrollView=this._skin.normalScrollView,this._scrollToBottom=!0):t.type==game.ChatType.CS_CHAT&&(this._skin.normalChatNode.active=!0,this._chatItemPool=this._csChatItemPool,this._chatItems=this._csChatItems,this._content=this._skin.csContent,this._scrollView=this._skin.csScrollView,this._scrollToBottom=!0);this._selectType=t.type,this._scrollView.node.active=!0,this._contentHeight=20;for(var n=0;n<t.chats.length;n++)e=t.chats[n],this._tempItem.setup(e),this._contentHeight+=this._tempItem.getHeight()+10;this._content.setContentSize(this._tempItem.width,this._contentHeight),this._refreshIndex=t.chats.length-1,this._refreshTimer?(this._refreshTimer.reset(),this._refreshTimer.start()):this._refreshTimer=b8e.Timer.add(this,this._refreshItems,50,0,3),this._scrollToBottom&&this.tryScrollToBottom(),this.onWorldFreeTimeChange()}},_refreshItems:function(){for(var e,t,i,n,s,a=game.chat.getCurChat(),o=1<this._refreshIndex?1:this._refreshIndex,r=this._refreshIndex-o,h=this._refreshIndex;r<=h;h--)(t=a.chats[h])&&((e=this._chatItems[h])||(e=this._getChatItem(),(this._chatItems[h]=e).addToParent(this._content)),e.chatItemIndex=h,e.setup(t),i=e.getHeight(),(n=this._chatItems[h+1])?(s=n.y,e.setPosition(0,s+10+i)):(s=-1*this._contentHeight+10+.5*i,e.setPosition(0,s)),e.show());this._refreshIndex=r-1,this._refreshIndex<=0&&(this._refreshTimer.stop(),this._scrollToBottom&&this.onScrollToBottom())},_onAddChatInfo:function(e){var t,i,n,s,a=game.chat.getCurChat();if(e.data.type==a.type)if(20<=this._chatItems.length){(t=this._chatItems.shift())||(t=new game.ChatItem),t.chatItemIndex=999,t.setup(e.data),this._chatItems.push(t),this._chatItems.sort(this._sortChatItems);a=game.chat.getCurChat();for(var o=this._chatItems.length-1;0<=o;o--)(t=this._chatItems[o])&&(i=t.getHeight(),n=this._chatItems[o+1],t.chatItemIndex=o,n?(s=n.y,t.setPosition(0,s+10+i)):(s=-1*this._contentHeight+10+.5*i,t.setPosition(0,s)),t.show())}else this.onCurPanelInfoChange()},_sortChatItems:function(e,t){return e.chatItemIndex-t.chatItemIndex},tryScrollToBottom:function(e){b8e.Tween.get(this).wait(100).call(this.onScrollToBottom,this)},onScrollToBottom:function(){this._scrollView&&this._scrollView.scrollToBottom(0)},onWorldFreeTimeChange:function(){var e=game.chat.getCurChat();if(e.type==game.ChatType.GUILD_CHAT)return this._skin.chatTimes.string="",void(this._skin.chatCostIcon.node.active=!1);var t,i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_CHAT_FREE_TIME),n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.VIP_FREE_TALK);if(game.vip.getVipLv()<n)if(e.type==game.ChatType.CS_CHAT?t=game.chat.todayCrossChatTimes:e.type==game.ChatType.WORLD_CHAT&&(t=game.chat.todayWroldChatTime),0<t)this._skin.chatTimes.string="免费:"+t+"/"+i,this._skin.chatCostIcon.node.active=!1;else{var s=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_CHAT_COST);this._skin.chatCostIcon.node.active=!0;var a=s.split("|");if(2==a.length){var o=game.ccfg.ItemInfoCfg.getItemInfoById(a[0]),r=game.upgrade.costCheckMoney(o.type,a[1],!1);this._skin.chatTimes.string=r?"       "+a[1]:"       "+game.html.getText(game.html.Q_RED,a[1])}else this._skin.chatTimes.string="配置错误"}else this._skin.chatTimes.string="",this._skin.chatCostIcon.node.active=!1},onWorldChatTimeChange:function(){this._timer&&this._timer.stop();var e=game.SysTime.curTime,t=game.chat.getCurChatNextChatTime()-e;0<t?(this._skin.sendLbl.string=~~(t/1e3)+"",this._timer||(this._timer=b8e.Timer.add(this,this._udpateWorldChatSpeedTime,500)),this._timer.reset(),this._timer.start(),b8e.ShaderUtil.setGray(this._skin.sendBtn)):(b8e.ShaderUtil.reset(this._skin.sendBtn),this._skin.sendLbl.string="发送")},_udpateWorldChatSpeedTime:function(){var e=game.SysTime.curTime,t=game.chat.getCurChatNextChatTime()-e;0<t?this._skin.sendLbl.string=~~(t/1e3)+"":(this._skin.sendLbl.string="发送",b8e.ShaderUtil.reset(this._skin.sendBtn),this._timer&&this._timer.stop())},_clearChatItem:function(){for(var e=0;e<this._chatItems.length;e++){var t=this._chatItems[e];t&&(t.hide(),t.removeFromParent(),this._chatItemPool.push(t))}this._chatItems=[]},_getChatItem:function(){return 0<this._chatItemPool.length?this._chatItemPool.shift():new game.ChatItem}})},{}],220:[function(e,t,i){"use strict";game.MainChat=game.SkinUI.extends({_lastChat:"",_autoHideTimer:null,ctor:function(){this._super("chat/MainChatSkin","MainChatSkin")},onShow:function(){this._skin.bg.node.active=!1,this._skin.chatBtn.width=60,b8e.evt.addG(this,game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,this.onWorldChatAddItem),b8e.evt.onC(this._skin.chatBtn,this.onShowChatPanel,this),this.x=0,this.y=129,b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onHide:function(){this.onResize(),b8e.evt.rmvG(this,game.ChatEvent.CUR_CHAT_ADD_CHAT_ITEM_INFO,this.onWorldChatAddItem),b8e.evt.offC(this._skin.chatBtn,this.onShowChatPanel,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this._autoHideTimer&&this._autoHideTimer.stop()},onSpotAlertChange:function(){this._skin.alert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_CHAT_ALERT)},onShowChatPanel:function(){game.app.show(game.AppConstant.CHAT_PANEL)},onWorldChatAddItem:function(e){var t=e.data;if(t&&t.type!=game.ChatType.GUILD_CHAT){this._skin.chatBtn.width=330,this._skin.bg.node.active=!0,this._skin.content.node.active=!0;var i="",n="";if(""!=this._lastChat&&(i=this._lastChat+"\n"),t.type==game.ChatType.WORLD_CHAT?(i+=n="[世界]"+game.html.getText(game.html.LIGHT_YELLOW,"["+t.roleName+"] ")+game.html.getText(game.html.GRAY_WHITE,t.content),this._skin.content.string=i):t.type==game.ChatType.SYSTEM_CHAT&&(i+=n="[系统]"+game.html.getText(game.html.LIGHT_YELLOW,t.content),this._skin.content.string=i),t.funcType==game.ChatFuncType.CHAT_FUNC_TEAM_BOSS){var s=game.ccfg.DungeonCfg.getDungeonById(t.insId);if(s){var a=s.name;i+=n=game.ccfg.LangCfg.getText(27020,[t.roleName,a]),this._skin.content.string=i}}this._lastChat=n,this._autoHideTimer?(this._autoHideTimer.reset(),this._autoHideTimer.start()):this._autoHideTimer=b8e.Timer.add(this,this.autoHide,25e3)}else this._skin.bg.node.active=!1},autoHide:function(){this._skin.chatBtn.width=60,this._skin.bg.node.active=!1,this._skin.content.node.active=!1,this._autoHideTimer&&this._autoHideTimer.stop()},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0],1<arguments.length&&void 0!==arguments[1]&&arguments[1]}})},{}],221:[function(e,t,i){"use strict";e("./ChatPanel"),e("./ChatItem"),e("./MainChat")},{"./ChatItem":218,"./ChatPanel":219,"./MainChat":220}],222:[function(e,t,i){"use strict";game.ChatSender={},game.ChatSender.initChatType=function(e){var t=game.pbmsg.GetHistoryChatRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Chat.GetHistoryChatRequest;b8e.sendN(i)},game.ChatSender.initChat=function(){var e=game.pbmid.Chat.GetChatModuleRequest;b8e.sendN(e)},game.ChatSender.chatRequest=null,game.ChatSender.chatProto=null,game.ChatSender.sendChat=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];game.ChatSender.chatRequest||(game.ChatSender.chatRequest=game.pbmsg.ChatRequest);var s=game.ChatSender.chatRequest;game.ChatSender.chatProto||(game.ChatSender.chatProto=game.pbmsg.ChatContentProto),game.ChatSender.chatProto.type=e,game.ChatSender.chatProto.content=t,s.chatContent=game.ChatSender.chatProto,s.targetRoleId=i,s.isGeneratedBySystem=n,engine.NetSender.getBytes().writeProtobuf(s);var a=game.pbmid.Chat.ChatRequest;b8e.sendN(a)}},{}],223:[function(e,t,i){"use strict";e("./mgr/ClientSettingMgr"),e("./event/ClientSettingEvt"),e("./panel/ChangeNamePanel"),e("./panel/ClientSettingPage"),e("./panel/ClientSettingPanel"),e("./panel/ClientSettingSelf")},{"./event/ClientSettingEvt":224,"./mgr/ClientSettingMgr":225,"./panel/ChangeNamePanel":226,"./panel/ClientSettingPage":227,"./panel/ClientSettingPanel":228,"./panel/ClientSettingSelf":229}],224:[function(e,t,i){"use strict";game.ClientSettingEvt=b8e.Enum({CHANGE_NAME_SUCCESS:b8e.Event.nextCode()})},{}],225:[function(e,t,i){"use strict";game.ClientSettingMgr=b8e.Object.extends({_setting:null,_tempSetting:null,MAX_NUM:100,nameStr:"",isGetSettingData:!1,ctor:function(){this._super(),this._setting=b8e.HashMap.get(),this._tempSetting=b8e.HashMap.get()},setup:function(e){var t;if(this._setting.set(game.ClientSettingType.BGM_MUSIC,0),this._setting.set(game.ClientSettingType.MUSIC,0),this._setting.set(game.ClientSettingType.WING,0),this._setting.set(game.ClientSettingType.FABAO,0),this._setting.set(game.ClientSettingType.SPELL,1),this._setting.set(game.ClientSettingType.HERO,0),this._setting.set(game.ClientSettingType.QUALITY,game.ClientSettingEnum.Middle),this._setting.set(game.ClientSettingType.AUTO_SHAPE,0),this._setting.set(game.ClientSettingType.SHAPE_ALERT,0),this._setting.set(game.ClientSettingType.HIDE_VIP,0),this._setting.set(game.ClientSettingType.XIANZHEN,0),e)for(var i=0;i<e.length;i++)t=e[i],this._tempSetting.set(t.id,t.value);this.isGetSettingData=!0,this.updateSetting(!1)},getBgmMusicSelect:function(){return this._setting.get(game.ClientSettingType.BGM_MUSIC)},getMusicSelect:function(){return this._setting.get(game.ClientSettingType.MUSIC)},getWingSelect:function(){return this._setting.get(game.ClientSettingType.WING)},getFaBaoSelect:function(){return this._setting.get(game.ClientSettingType.FABAO)},getXianZhenSelect:function(){return this._setting.get(game.ClientSettingType.XIANZHEN)},getSpellSelect:function(){return 0!=b8e.isMobile&&this._setting.get(game.ClientSettingType.SPELL)},getHeroSelect:function(){return this._setting.get(game.ClientSettingType.HERO)},getAutoShapeSelect:function(){return this._setting.get(game.ClientSettingType.AUTO_SHAPE)},getShapeAlertSelect:function(){return this._setting.get(game.ClientSettingType.SHAPE_ALERT)},getQualityEnum:function(){return this._setting.get(game.ClientSettingType.QUALITY)},getHideVipSelect:function(){return this._setting.get(game.ClientSettingType.HIDE_VIP)},changeBgmMusic:function(e){this.getBgmMusicSelect()!=e&&(this._setting.set(game.ClientSettingType.BGM_MUSIC,e?1:0),this._tempSetting.set(game.ClientSettingType.BGM_MUSIC,e?1:0),this.setupBgmMusic(e))},setupBgmMusic:function(e){e?(b8e.sound.pauseBackgroundMusic(),b8e.sound.pauseEnvironmentAudio()):(b8e.sound.resumeBackgroundMusic(),b8e.sound.resumeEnvironmentAudio())},changeMusic:function(e){this.getMusicSelect()!=e&&(this._setting.set(game.ClientSettingType.MUSIC,e?1:0),this._tempSetting.set(game.ClientSettingType.MUSIC,e?1:0),this.setupMusic(e))},setupMusic:function(e){e?b8e.sound.pauseEffectSound():b8e.sound.resumeEffectSound()},changeSetting:function(e,t){e==game.ClientSettingType.SPELL&&0==b8e.isMobile||(e==game.ClientSettingType.QUALITY?(this._tempSetting.set(e,t),this._setting.set(e,t)):(this._tempSetting.set(e,t?1:0),this._setting.set(e,t?1:0)))},updateSetting:function(){for(var e,t,i,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],s=this._tempSetting.keys(),a=0;a<s.length;a++)e=s[a],t=this._tempSetting.get(e),this._setting.set(e,t);i=(t=this._setting.get(game.ClientSettingType.WING))?0:this.MAX_NUM,i=(t=this._setting.get(game.ClientSettingType.FABAO))?0:this.MAX_NUM,i=(t=this._setting.get(game.ClientSettingType.XIANZHEN))?0:this.MAX_NUM,i=(t=this._setting.get(game.ClientSettingType.HERO))?0:this.MAX_NUM;var o=this.getQualityEnum(),r=game.ccfg.ClientSettingCfg.getDataById(o);r?i=Math.min(i,r.heroNum):b8e.log("设置配置存在错误，不存在类型",o),o==game.ClientSettingEnum.High?(game.PerfMgr.inst().setFrameRate(60),b8e.startup.setEnableAntiAlias(!0)):o==game.ClientSettingEnum.Middle?(game.PerfMgr.inst().setFrameRate(30),b8e.startup.setEnableAntiAlias(!0)):(game.PerfMgr.inst().setFrameRate(30),b8e.startup.setEnableAntiAlias(!1)),t=this._setting.get(game.ClientSettingType.BGM_MUSIC),this.setupBgmMusic(t),t=this._setting.get(game.ClientSettingType.MUSIC),this.setupMusic(t),n&&this.isGetSettingData&&game.MiscSender.saveClientSetting(this._tempSetting),this._tempSetting.clear(),b8e.evt.dptG(game.ClientSettingType.AllSOUND)},controlAllSound:function(e){this.setupBgmMusic(e),this.setupMusic(e),this._tempSetting.set(game.ClientSettingType.BGM_MUSIC,e?1:0),this._tempSetting.set(game.ClientSettingType.MUSIC,e?1:0),this.updateSetting()},getSoundSelect:function(){var e=this.getMusicSelect(),t=this.getBgmMusicSelect();return!e||!t},startCheck:function(){this._showMountRes=[],this._showWingRes=[],this._showFaBaoRes=[]},checkFps:function(){var e=b8e.Ticker.getFps();this.getQualityEnum()==game.ClientSettingEnum.High?e<15?this._maxShowCount=0:e<30?this._maxShowCount=1:(40<e&&this._fpsCount++,3<=this._fpsCount&&(this._maxShowCount=3)):e<10||(e<15?this._maxShowCount=0:(20<e&&this._fpsCount++,3<=this._fpsCount&&(this._maxShowCount=2))),b8e.isMobile},_fpsCount:0,_maxShowCount:2,_showMountRes:null,_showWingRes:null,_showFaBaoRes:null,_selfMountRes:null,_selfWingRes:null,_selfFaBaoRes:null,canShowMount:function(e){var t=game.MountMgr().getDataLvCfg();if(t&&game.ClientCfg.getMount(t.res)==e)return!0;return!(!this._showMountRes&&-1==this._showMountRes.indexOf(e))},canShowWing:function(e){var t=game.WingMgr().getDataLvCfg();if(t&&game.ClientCfg.getWing(t.res)==e)return!0;return 0==this._showWingRes||-1!=this._showWingRes.indexOf(e)},canShowFaBao:function(e){var t=game.FaBaoMgr().getDataLvCfg();if(t&&game.ClientCfg.getFaBao(t.res)==e)return!0;return 0==this._showFaBaoRes||-1!=this._showFaBaoRes.indexOf(e)},checkSceneRole:function(){this._showMountRes.length=0,this._showWingRes.length=0,this._showFaBaoRes.length=0;var e=b8e.scene.getDisplayByType(game.RoleType.Hero);if(e&&!(e.length<5)){var t,i,n,a=[],o=[],r=[];for(e.forEach(function(e){if(e.data&&1!=e.data.isSelf){var t=e.data.heroModel;if(t){var i=t.getMountResId(),n=t.getWingResId(),s=t.getFaBaoResId();-1==a.indexOf(i)&&0!=i&&a.push(i),-1==o.indexOf(n)&&0!=n&&o.push(n),-1==r.indexOf(s)&&0!=s&&r.push(s)}}}),a.sort(this.sortLv),i=0;i<a.length&&(!(n=game.ccfg.MountCfg.getDataById(a[i]))||(t=game.ClientCfg.getMount(n.res),-1==this._showMountRes.indexOf(t)&&this._showMountRes.push(t),this._showMountRes.length!=this._maxShowCount));i++);for(o.sort(this.sortLv),i=0;i<o.length&&(!(n=game.ccfg.WingCfg.getDataById(a[i]))||(t=game.ClientCfg.getWing(n.res),-1==this._showWingRes.indexOf(t)&&this._showWingRes.push(t),this._showWingRes.length!=this._maxShowCount));i++);for(r.sort(this.sortLv),i=0;i<r.length&&(!(n=game.ccfg.FaBaoCfg.getDataById(a[i]))||(t=game.ClientCfg.getFaBao(n.res),-1==this._showFaBaoRes.indexOf(t)&&this._showFaBaoRes.push(t),this._showFaBaoRes.length!=this._maxShowCount));i++);e.forEach(function(e){e.data&&1!=e.data.isSelf&&game.AvatarUtil.updateAvatar(e)})}},sortLv:function(e,t){return t-e},saveNs:function(e){this.nameStr=e}}),game.ClientSettingMgr._instance=null,game.ClientSettingMgr.inst=function(){return game.ClientSettingMgr._instance||(game.ClientSettingMgr._instance=new game.ClientSettingMgr),game.ClientSettingMgr._instance}},{}],226:[function(e,t,i){"use strict";game.appModule.ChangeNamePanel=game.SkinUIPanel.extends({_isEnough:null,ctor:function(e){this._super(e)},onShow:function(){this._skin.editBox.string="",this.updateCostInfo(),b8e.evt.onC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.onC(this._skin.btn_ok,this.onSender,this),b8e.evt.addG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.onHidePanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostInfo)},onHide:function(){this._skin.editBox.string="",b8e.evt.offC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.offC(this._skin.btn_ok,this.onSender,this),b8e.evt.rmvG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.onHidePanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostInfo)},onHidePanel:function(){this.hide()},updateCostInfo:function(){var e=game.back.getItemInfoById(120009);this._skin.lab_cost.string=e?game.html.getText(game.html.Q_GREEN,e.num)+"/1":game.html.getText(game.html.Q_RED,"0")+"/1"},onSender:function(){var e=this._skin.editBox.string;if(""!=e){var t=this._skin.editBox.string.trim();if(b8e.SensitiveWords.match(t))game.notice.show(31002);else{var i=game.back.getItemInfoById(120009);i&&1<=i.num?(game.setting.saveNs(e),game.RoleLoginSender.rename(e)):game.notice.show(31003)}}else game.notice.show(31001)}})},{}],227:[function(e,t,i){"use strict";game.ClientSettingPage=game.SkinUI.extends({ctor:function(){this._super("setting/ClientSettingPageSkin","ClientSettingPageSkin")},onShow:function(){this.setData(),b8e.evt.onC(this._skin.bgmMusicClose.node,this.clickBgmMusicClose,this),b8e.evt.onC(this._skin.bgmMusicOpen.node,this.clickBgmMusicOpen,this),b8e.evt.onC(this._skin.musicClose.node,this.clickMusicClose,this),b8e.evt.onC(this._skin.musicOpen.node,this.clickMusicOpen,this),b8e.evt.onC(this._skin.wingToggle.node,this.clickWingToggle,this),b8e.evt.onC(this._skin.fabaoToggle.node,this.clickFabaoToggle,this),b8e.evt.onC(this._skin.xianzhenToggle.node,this.clickXianZhenToggle,this),b8e.evt.onC(this._skin.spellToggle.node,this.clickSpellToggle,this),b8e.evt.onC(this._skin.heroToggle.node,this.clickHeroToggle,this),b8e.evt.onC(this._skin.autoShapeToggle.node,this.clickAutoShapeToggle,this),b8e.evt.onC(this._skin.shapeAlertToggle.node,this.clickShapeAlertToggle,this),b8e.evt.onC(this._skin.qualityToggleLow.node,this.clickQualityToggleLow,this),b8e.evt.onC(this._skin.qualityToggleMiddle.node,this.clickQualityToggleMiddle,this),b8e.evt.onC(this._skin.qualityToggleHigh.node,this.clickQualityToggleHigh,this)},onHide:function(){b8e.evt.offC(this._skin.bgmMusicClose.node,this.clickBgmMusicClose,this),b8e.evt.offC(this._skin.bgmMusicOpen.node,this.clickBgmMusicOpen,this),b8e.evt.offC(this._skin.musicClose.node,this.clickMusicClose,this),b8e.evt.offC(this._skin.musicOpen.node,this.clickMusicOpen,this),b8e.evt.offC(this._skin.wingToggle.node,this.clickWingToggle,this),b8e.evt.offC(this._skin.fabaoToggle.node,this.clickFabaoToggle,this),b8e.evt.offC(this._skin.xianzhenToggle.node,this.clickXianZhenToggle,this),b8e.evt.offC(this._skin.spellToggle.node,this.clickSpellToggle,this),b8e.evt.offC(this._skin.heroToggle.node,this.clickHeroToggle,this),b8e.evt.offC(this._skin.autoShapeToggle.node,this.clickAutoShapeToggle,this),b8e.evt.offC(this._skin.shapeAlertToggle.node,this.clickShapeAlertToggle,this),b8e.evt.offC(this._skin.qualityToggleLow.node,this.clickQualityToggleLow,this),b8e.evt.offC(this._skin.qualityToggleMiddle.node,this.clickQualityToggleMiddle,this),b8e.evt.offC(this._skin.qualityToggleHigh.node,this.clickQualityToggleHigh,this),game.setting.updateSetting()},clickBgmMusicClose:function(){game.setting.changeBgmMusic(!0)},clickBgmMusicOpen:function(){game.setting.changeBgmMusic(!1)},clickMusicClose:function(){game.setting.changeMusic(!0)},clickMusicOpen:function(){game.setting.changeMusic(!1)},clickWingToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.WING,!e.getWingSelect())},clickFabaoToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.FABAO,!e.getFaBaoSelect())},clickXianZhenToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.XIANZHEN,!e.getXianZhenSelect())},clickSpellToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.SPELL,!e.getSpellSelect())},clickHeroToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.HERO,!e.getHeroSelect())},clickAutoShapeToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.AUTO_SHAPE,!e.getAutoShapeSelect())},clickShapeAlertToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.SHAPE_ALERT,!e.getShapeAlertSelect())},clickQualityToggleLow:function(){game.setting.changeSetting(game.ClientSettingType.QUALITY,game.ClientSettingEnum.Low)},clickQualityToggleMiddle:function(){game.setting.changeSetting(game.ClientSettingType.QUALITY,game.ClientSettingEnum.Middle)},clickQualityToggleHigh:function(){game.setting.changeSetting(game.ClientSettingType.QUALITY,game.ClientSettingEnum.High)},setData:function(){var e=game.setting;switch(e.getBgmMusicSelect()?this._skin.bgmMusicClose.check():this._skin.bgmMusicOpen.check(),e.getMusicSelect()?this._skin.musicClose.check():this._skin.musicOpen.check(),e.getWingSelect()?this._skin.wingToggle.check():this._skin.wingToggle.uncheck(),e.getFaBaoSelect()?this._skin.fabaoToggle.check():this._skin.fabaoToggle.uncheck(),e.getXianZhenSelect()?this._skin.xianzhenToggle.check():this._skin.xianzhenToggle.uncheck(),e.getSpellSelect()?this._skin.spellToggle.check():this._skin.spellToggle.uncheck(),e.getHeroSelect()?this._skin.heroToggle.check():this._skin.heroToggle.uncheck(),e.getAutoShapeSelect()?this._skin.autoShapeToggle.check():this._skin.autoShapeToggle.uncheck(),e.getShapeAlertSelect()?this._skin.shapeAlertToggle.check():this._skin.shapeAlertToggle.uncheck(),e.getQualityEnum()){case game.ClientSettingEnum.Low:this._skin.qualityToggleLow.check();break;case game.ClientSettingEnum.Middle:this._skin.qualityToggleMiddle.check();break;case game.ClientSettingEnum.High:this._skin.qualityToggleHigh.check()}}})},{}],228:[function(e,t,i){"use strict";game.appModule.ClientSettingPanel=game.SkinUIPanel.extends({_self:null,_setting:null,_index:-1,onShow:function(){b8e.evt.onC(this._skin.selfInfo,this.clickSelf,this),b8e.evt.onC(this._skin.systemSetting,this.clickSetting,this),this.initPanel()},onHide:function(){this._self.hide(),this._setting.hide(),b8e.evt.offC(this._skin.selfInfo,this.clickSelf,this),b8e.evt.offC(this._skin.systemSetting,this.clickSetting,this)},initPanel:function(){this._self||(this._self=new game.ClientSettingSelf,this._self.addToParent(this._skin.page),this._self.show()),this._setting||(this._setting=new game.ClientSettingPage,this._setting.addToParent(this._skin.page)),-1==this._index?this.showByIndex(0):this.showByIndex(this._index),game.IS_QZONE?this._skin.lab_version.string="官方客服QQ：<color=#00ff00><br/>800185583<br/>3507591922</c>":this._skin.lab_version.string=""},showByIndex:function(e){switch(this._index=e){case 0:this._self.show(),this._setting.hide();break;case 1:this._self.hide(),this._setting.show()}},clickSelf:function(){this.showByIndex(0)},clickSetting:function(){this.showByIndex(1)}})},{}],229:[function(e,t,i){"use strict";game.ClientSettingSelf=game.SkinUI.extends({_head:null,_vipSprite:null,ctor:function(){this._super("setting/ClientSettingSelfSkin","ClientSettingSelfSkin")},init:function(){this._skin.switch_btn.active=game.LoginConfig.isSwitch},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.head)),this._skin.vipBtn.active=!game.shield.isShieldRecharge(),this._skin.vipToggle.node.active=!game.shield.isShieldRecharge(),this._skin.btnSelect.active=!1,b8e.evt.onC(this._skin.vipBtn,this.clickVip,this),b8e.evt.onC(this._skin.cnBtn,this.clickcn,this),b8e.evt.onC(this._skin.vipToggle.node,this.clickHideVipToggle,this),b8e.evt.onC(this._skin.switch_btn,this.clickSwitch,this),b8e.evt.onC(this._skin.btnSelect,this.clickBtnSelect,this),b8e.evt.addG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.refreshName),this.setData(),this._skin.lab_version.string="Ver."+game.VERSION+"."+b8e.res.getVersion()+"."+b8e.res.getResVersion()},onHide:function(){b8e.evt.offC(this._skin.vipBtn,this.clickVip,this),b8e.evt.offC(this._skin.cnBtn,this.clickcn,this),b8e.evt.offC(this._skin.vipToggle.node,this.clickHideVipToggle,this),b8e.evt.offC(this._skin.switch_btn,this.clickSwitch,this),b8e.evt.offC(this._skin.btnSelect,this.clickBtnSelect,this),b8e.evt.rmvG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.refreshName),this._vipSprite&&this._vipSprite.unloadTexture(),game.setting.updateSetting()},clickVip:function(){game.pay.isRechargePanel=!1,game.app.show(game.AppConstant.PAY_PANEL),game.app.hide(game.AppConstant.CLIENT_SETTING_PANEL)},clickHideVipToggle:function(){var e=game.setting;game.setting.changeSetting(game.ClientSettingType.HIDE_VIP,!e.getHideVipSelect())},clickSwitch:function(){game.sdk.switchAccount()},clickBtnSelect:function(){if(b8e.isWeChatGame){var e=new game.GameAlertInfo;e.alertType=game.BaseGameAlertType.OneBtn,e.string="是否退出游戏返回选服界面？",e.isShowTips=!1,game.gameAlert.showAlert(this,this.refreshGame,e)}},refreshGame:function(e,t){switch(t){case game.GameAlertBtnType.CONFIRM:game.sdk.logout()}},setData:function(){var e=game.mainRole.mainRoleData;this._skin.roleName.string=e.getName();var t,i=game.ccfg.HeadCfg.getsmallIcon(e.head);if(""!=i&&i?this._head.loadTexture(game.ClientCfg.getHeadIconUrlByHeadId(i),null,null,{useManifest:!1}):this._head.unloadTexture(),this._skin.lv.string=game.rebirth.getSelfRebirthAndLv(),this._skin.fightAmount.string=e.getZhanLi(),this._skin.selfId.string=e.playerId,t=e.isHasGuild?e.guildName:"暂未加入",this._skin.selfGuild.string=t,this._skin.selfServer.string=game.LoginConfig.serverName,this._skin.vip.string="VIP "+e.getVipLv(),!game.shield.isShieldRecharge()){this._vipSprite||(this._vipSprite=b8e.Sprite.get(),this._vipSprite.setAnchor(0,0),this._vipSprite.setScale(.55,.55),this._vipSprite.addToParent(this._skin.vipNode));var n=game.ClientCfg.getVipImageUrlByLv(e.getVipLv());this._vipSprite.loadTexture(n,null,null,{useManifest:!1}),game.setting.getHideVipSelect()?this._skin.vipToggle.check():this._skin.vipToggle.uncheck()}},clickcn:function(){game.app.show(game.AppConstant.CHANGE_NAME_PANEL)},refreshName:function(){var e=game.mainRole.mainRoleData;this._skin.roleName.string=e.getName()}})},{}],230:[function(e,t,i){"use strict";game.appModule.RulePanel=game.SkinUIPanel.extends({_descBg:null,_ruleId:0,ctor:function(e){this._super(e)},onShow:function(){this.data&&(this._ruleId=this.data);var e=game.ccfg.ClientRuleImgCfg.getDataById(this._ruleId);e&&""!=e.url&&(this._descBg||(this._descBg=b8e.Sprite.get(),this._descBg.addToParent(this._skin.desc_bg_node),this._descBg.setAnchor(.5,1)),this._descBg.loadTexture(e.url,this.onRuleSpriteComplete,this,{useManifest:!1}))},onHide:function(){},onRuleSpriteComplete:function(){this._skin.desc_bg_node.height=this._descBg.height}})},{}],231:[function(e,t,i){"use strict";game.CornucopiaCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Cornucopia.CornucopiaModuleProto,this.onCornucopiaModuleProto,this),b8e.addNH(game.pbmid.Cornucopia.GetCornucopiaAwardResponse,this.onGetCornucopiaAwardResponse,this),b8e.addNH(game.pbmid.Cornucopia.CornucopiaEquipNotify,this.onCornucopiaEquipNotify,this),b8e.addNH(game.pbmid.Cornucopia.CornucopiaLootNotify,this.onCornucopiaLootNotify,this),b8e.addNH(game.pbmid.Cornucopia.CornucopiaBeLootedNotify,this.onCornucopiaBeLootedNotify,this),b8e.addNH(game.pbmid.Cornucopia.CornucopiaLootFailNotify,this.onCornucopiaLootFailNotify,this)},onCornucopiaModuleProto:function(e){var t=game.pbmsg,i=e.readProtobuf(t.CornucopiaModuleProto);i&&game.cornucopia.setupData(i)},onGetCornucopiaAwardResponse:function(e){var t=game.pbmsg;e.readProtobuf(t.GetCornucopiaAwardResponse)&&game.cornucopia.clearEquipCount()},onCornucopiaEquipNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.CornucopiaEquipNotify);i&&(game.cornucopia.accumulateCount=i.count,b8e.evt.dptG(game.CornucopiaEvents.UPDATE_EQUIP_COUNT))},onCornucopiaLootNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.CornucopiaLootNotify);i&&game.cornucopia.setCornucopiaLoot(i)},onCornucopiaBeLootedNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.CornucopiaBeLootedNotify);i&&game.cornucopia.setCornucopiaBeLooted(i)},onCornucopiaLootFailNotify:function(e){var t=game.pbmsg;e.readProtobuf(t.CornucopiaLootFailNotify)&&game.notice.show(game.ccfg.LangCfg.getText(10010))}})},{}],232:[function(e,t,i){"use strict";e("./CornucopiaCmd")},{"./CornucopiaCmd":231}],233:[function(e,t,i){"use strict";e("./manager/managerIndex_22"),e("./panel/panelIndex_33"),e("./event/eventIndex_14"),e("./sender/senderIndex_13"),e("./cmdlistener/cmdlistenerIndex_10")},{"./cmdlistener/cmdlistenerIndex_10":232,"./event/eventIndex_14":235,"./manager/managerIndex_22":237,"./panel/panelIndex_33":241,"./sender/senderIndex_13":243}],234:[function(e,t,i){"use strict";game.CornucopiaEvents=b8e.Enum({LOOT:b8e.Event.nextCode(),LOOTED:b8e.Event.nextCode(),UPDATE_EQUIP_COUNT:b8e.Event.nextCode()})},{}],235:[function(e,t,i){"use strict";e("./CornucopiaEvents")},{"./CornucopiaEvents":234}],236:[function(e,t,i){"use strict";game.CornucopiaMgr=b8e.Object.extends({name:"CornucopiaMgr",logList:null,accumulateCount:0,todayLootTimes:0,logCount:0,isRequest:!1,ctor:function(){if(1==game.CornucopiaMgr._singleton)throw new Error("CornucopiaMgr 只能通过单例方法获取");this._super(),this.logList=[],this.init()},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest)},onMainQuest:function(){game.funcOpen.checkOpen(game.FunctionType.CORNUCOPIA)&&(this.isRequest||(this.isRequest=!0,game.CornucopiaSender.reqCornucopiaModuleRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest))},onMainQuestComplete:function(){game.funcOpen.checkOpen(game.FunctionType.CORNUCOPIA)&&(this.isRequest||(this.isRequest=!0,game.CornucopiaSender.reqCornucopiaModuleRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete))},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.CORNUCOPIA)&&(this.isRequest=!0,game.CornucopiaSender.reqCornucopiaModuleRequest())},setupData:function(e){if(this.accumulateCount=e.accumulateCount,this.todayLootTimes=e.todayLootTimes,this.logList.length=0,e.log&&0<=e.log.length){for(var t=0;t<e.log.length;t++){var i=e.log[t];if(i){var n=new game.CornucopiaLogInfo;n.setData(i),this.logList.push(n)}}this.logList.reverse()}},setCornucopiaLoot:function(e){this.logCount++,this.todayLootTimes=e.times;var t=new game.CornucopiaLogInfo;t.setData(e.log),this.logList.unshift(t),b8e.evt.dptG(game.CornucopiaEvents.LOOT)},setCornucopiaBeLooted:function(e){this.logCount++,this.accumulateCount=e.count;var t=new game.CornucopiaLogInfo;t.setData(e.log),this.logList.unshift(t),b8e.evt.dptG(game.CornucopiaEvents.LOOTED)},resetDaily:function(){this.todayLootTimes=0},resetLogCount:function(){this.logCount=0},clearEquipCount:function(){this.accumulateCount=0,b8e.evt.dptG(game.CornucopiaEvents.UPDATE_EQUIP_COUNT)},sendGetCornucopiaAward:function(){0==this.accumulateCount&&game.notice.show(game.ccfg.LangCfg.getText(10012));var e=game.back.getBackEquipCount(),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_BACK_EQUIP_COUNT);e+this.accumulateCount>t?game.notice.show(game.ccfg.LangCfg.getText(10011)):game.CornucopiaSender.reqEquipSlotUpgrade()},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.BAG_CORNUCOPIA_ALERT,game.SpotAlertChildrens.BAG_CORNUCOPIA_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CORNUCOPIA_GET_PRIZE_ALERT,null,this.accoumlateAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CORNUCOPIA_LOG_ALERT,null,this.logAlert,this)},accoumlateAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.CORNUCOPIA)){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CORNUCOPIA_EQUIP_BOOM_TIMES);if(this.accumulateCount>=e)return!0}return!1},logAlert:function(){return!!game.funcOpen.checkOpen(game.FunctionType.CORNUCOPIA)&&0<this.logCount}}),game.CornucopiaMgr._instance=null,game.CornucopiaMgr._singleton=!0,game.CornucopiaMgr.inst=function(){return game.CornucopiaMgr._instance||(game.CornucopiaMgr._singleton=!1,game.CornucopiaMgr._instance=new game.CornucopiaMgr,game.CornucopiaMgr._singleton=!0),game.CornucopiaMgr._instance}},{}],237:[function(e,t,i){"use strict";e("./CornucopiaMgr")},{"./CornucopiaMgr":236}],238:[function(e,t,i){"use strict";game.CornucopiaLogItem=game.SkinUI.extends({ctor:function(){this._super("cornucopia/CornucopiaLogItemSkin","CornucopiaLogItemSkin")},getWidth:function(){return 450},getHeight:function(){return 48},onShow:function(){this.setData(this.cornucopiaLogInfo)},onHide:function(){},setData:function(e){if(this.cornucopiaLogInfo=e,this.cornucopiaLogInfo&&this._skin){var t,i=b8e.TimeUtil.getLogoutTime(game.SysTime.curTime-e.time);switch(e.type){case game.CornucopiaLogType.LOOT:this.setState(!0),t=10008;break;case game.CornucopiaLogType.LOOTED:this.setState(!1),t=10007}this._skin.lab_log.string=game.ccfg.LangCfg.getText(t,[e.roleName,e.count,i])}},setState:function(e){this._skin.img_state_loot.active=e,this._skin.img_state_looted.active=!e}})},{}],239:[function(e,t,i){"use strict";game.appModule.CornucopiaLogPanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},onShow:function(){game.cornucopia.resetLogCount(),this._list||(this._list=new b8e.List(this._skin.list,game.CornucopiaLogItem)),this._list.show(),this.setData()},onHide:function(){this._list&&this._list.hide(),game.cornucopia.resetLogCount()},setData:function(){var e=game.cornucopia.logList;this._list.setData(e)}})},{}],240:[function(e,t,i){"use strict";game.CornucopiaPanel=game.SkinUI.extends({maxEquipTimes:0,equipBoomTimes:0,maxLootTimes:0,equipTime:0,_bg:null,ctor:function(){this._super("cornucopia/CornucopiaSkin","CornucopiaSkin")},getButtonByName:function(e){switch(e){case"get":return!this._skin||this._skin.btn_get}return null},onShow:function(){this._bg||(this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.img_bg_node)),this.setBg(),this.setData(),b8e.evt.onC(this._skin.btn_log,this.onClickBtnLog,this),b8e.evt.onC(this._skin.btn_get,this.onClickBtnGet,this),b8e.evt.addG(this,game.CornucopiaEvents.UPDATE_EQUIP_COUNT,this.updateEquipCount),b8e.evt.addG(this,game.CornucopiaEvents.LOOTED,this.updateEquipCount),b8e.evt.addG(this,game.CornucopiaEvents.LOOT,this.updateLootCount),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange()},onHide:function(){b8e.evt.offC(this._skin.btn_log,this.onClickBtnLog,this),b8e.evt.offC(this._skin.btn_get,this.onClickBtnGet,this),b8e.evt.rmvG(this,game.CornucopiaEvents.UPDATE_EQUIP_COUNT,this.updateEquipCount),b8e.evt.rmvG(this,game.CornucopiaEvents.LOOTED,this.updateEquipCount),b8e.evt.rmvG(this,game.CornucopiaEvents.LOOT,this.updateLootCount),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onSpotAlertChange:function(){this._skin.getPrizeAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CORNUCOPIA_GET_PRIZE_ALERT),this._skin.logAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CORNUCOPIA_LOG_ALERT)},setData:function(){this.maxEquipTimes=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CORNUCOPIA_MAX_EQUIP_TIMES),this.equipBoomTimes=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CORNUCOPIA_EQUIP_BOOM_TIMES),this.maxLootTimes=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CORNUCOPIA_LOOT_TIMES),this.equipTime=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CORNUCOPIA_EQUIP_TIME),this._skin.img_line.x=this._skin.progress.width*(this.equipBoomTimes/this.maxEquipTimes)-219,this.updateEquipCount(),this.updateLootCount()},onClickBtnLog:function(){game.app.show(game.AppConstant.CORNUCOPIA_LOG_PANEL)},onClickBtnGet:function(){game.cornucopia.sendGetCornucopiaAward()},setBg:function(){var e=game.ClientCfg.getCornucopiaImgUrlByString("bg");this._bg.loadTexture(e,null,null,{useManifest:!1}),this._bg.setSize(543,370),this._bg.setAnchor(0,0)},updateEquipCount:function(){this.accumulateCount=game.cornucopia.accumulateCount;var e=this.equipBoomTimes-this.accumulateCount;if(e<=0)this._skin.lab_bottom_desc.string=game.ccfg.LangCfg.getText(10009,[this.equipBoomTimes]);else{var t=this.formatTime(e*this.equipTime);this._skin.lab_bottom_desc.string=game.ccfg.LangCfg.getText(10005,[this.equipBoomTimes,t])}this._skin.lab_equip_count.string=game.ccfg.LangCfg.getText(10006,[this.accumulateCount]),this._skin.mask.width=this._skin.progress.width*(this.accumulateCount/this.maxEquipTimes)},updateLootCount:function(){var e=this.maxLootTimes-game.cornucopia.todayLootTimes;this._skin.lab_loot_count.string=game.ccfg.LangCfg.getText(10004,[e])},formatTime:function(e){return e<0&&(e=0),3600<=e?b8e.TimeUtil.formatNum(e/3600)+"小时"+b8e.TimeUtil.formatNum(e%3600/60)+"分钟":b8e.TimeUtil.formatNum(e/60)+"分钟"}})},{}],241:[function(e,t,i){"use strict";e("./CornucopiaLogItem"),e("./CornucopiaLogPanel"),e("./CornucopiaPanel")},{"./CornucopiaLogItem":238,"./CornucopiaLogPanel":239,"./CornucopiaPanel":240}],242:[function(e,t,i){"use strict";var n=game.CornucopiaSender=function(){};n.reqCornucopiaModuleRequest=function(){var e=game.pbmid.Cornucopia.CornucopiaModuleRequest;b8e.sendN(e)},n.reqEquipSlotUpgrade=function(){var e=game.pbmid.Cornucopia.GetCornucopiaAwardRequest;b8e.sendN(e)}},{}],243:[function(e,t,i){"use strict";e("./CornucopiaSender")},{"./CornucopiaSender":242}],244:[function(e,t,i){"use strict";e("./cmd/CSArenaCmd"),e("./event/CSArenaEvent"),e("./mgr/CSArenaMgr"),e("./panel/CSArenaLogPanel"),e("./panel/CSArenaVsRight"),e("./panel/CSArenaVsLeft"),e("./panel/CSArenaVsPage"),e("./panel/CSArenaRankItem"),e("./panel/CSArenaRankPanel"),e("./panel/CSArenaLastRankItem"),e("./panel/CSArenaLastRankPanel"),e("./panel/CSArenaResultPanel"),e("./panel/CSArenaFightCountBuyPanel"),e("./panel/CSArenaMainPanel"),e("./panel/CSArenaPanel"),e("./sender/CSArenaSender")},{"./cmd/CSArenaCmd":245,"./event/CSArenaEvent":246,"./mgr/CSArenaMgr":247,"./panel/CSArenaFightCountBuyPanel":250,"./panel/CSArenaLastRankItem":251,"./panel/CSArenaLastRankPanel":252,"./panel/CSArenaLogPanel":253,"./panel/CSArenaMainPanel":254,"./panel/CSArenaPanel":255,"./panel/CSArenaRankItem":256,"./panel/CSArenaRankPanel":257,"./panel/CSArenaResultPanel":258,"./panel/CSArenaVsLeft":259,"./panel/CSArenaVsPage":260,"./panel/CSArenaVsRight":261,"./sender/CSArenaSender":262}],245:[function(e,t,i){"use strict";game.CSArenaCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Arena.CrossServerArenaInfoResponse,this.onCrossServerArenaInfoResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaMatchResponse,this.onCrossServerArenaMatchResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaLogResponse,this.onCrossServerArenaLogResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaQuestAwardResponse,this.onCrossServerArenaQuestAwardResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaLvAwardResponse,this.onCrossServerArenaLvAwardResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaRankResponse,this.onCrossServerArenaRankResponse,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaBattleFinishNotify,this.onCrossServerArenaBattleFinishNotify,this),b8e.addNH(game.pbmid.Arena.CrossServerArenaBuyTimesResponse,this.onCrossServerArenaBuyTimesResponse,this)},onCrossServerArenaBuyTimesResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerBuyTimesResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.buyTimesComplete(t))},onCrossServerArenaBattleFinishNotify:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaBattleFinishNotify);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.onFinish(t))},onCrossServerArenaRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerRankResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.setRankInfo(t))},onCrossServerArenaLvAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaLvAwardResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.getLevelPrizeComplete(t.lv))},onCrossServerArenaQuestAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaQuestAwardResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.getQuestPrizeComplete(t.id))},onCrossServerArenaLogResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaLogResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.setLogs(t))},onCrossServerArenaInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaInfoResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.csArena.setup(t))},onCrossServerArenaMatchResponse:function(e){var t=e.readProtobuf(game.pbmsg.CrossServerArenaMatchResponse);t&&game.csArena.matchComplete(t)}})},{}],246:[function(e,t,i){"use strict";game.CSArenaEvent=b8e.Enum({GET_INFO:b8e.Event.nextCode(),GET_RANK_INFO:b8e.Event.nextCode(),GET_QUEST_PRIZE:b8e.Event.nextCode(),GET_LOGS:b8e.Event.nextCode(),GET_LEVEL_PRIZE:b8e.Event.nextCode(),MATCH_COMPLETE:b8e.Event.nextCode()})},{}],247:[function(e,t,i){"use strict";game.CSArenaMgr=engine.Object.extends({name:"CSArenaMgr",_isInit:!1,csArenaInfo:null,csLevel:1,curStar:0,nextResetTime:0,_recoverTimer:null,_nextGetRankTime:0,lastRankInfo:null,nowRankInfo:null,nowRankInfoMap:null,lastRankInfoMap:null,logs:null,_getPrizeTimer:null,_canGetLevelPrize:!1,ctor:function(){if(1==game.CSArenaMgr._singleton)throw new Error("CSArenaMgr 只能通过单例方法获取");this._super(),this.nowRankInfoMap=b8e.HashMap.get(),this.lastRankInfoMap=b8e.HashMap.get()},setup:function(e){(this.csArenaInfo=e).times<e.maxTimes&&e.recoverTime&&(this._recoverTimer&&(b8e.Timer.remove(this,this._updateRecoverTime),this._recoverTimer=null),this._recoverTimer=b8e.Timer.add(this,this._updateRecoverTime,e.recoverTime,1)),this.csLevel=game.ccfg.CSArenaLevelCfg.getLevelByStart(e.level),this.curStar=game.ccfg.CSArenaLevelCfg.getStar(e.level),this.nextResetTime=game.SysTime.curTime+e.recoverTime,this._updateGetLevelPrize(),b8e.evt.dptG(game.CSArenaEvent.GET_INFO)},_updateGetLevelPrize:function(){this._canGetLevelPrize=!1,game.ccfg.CSArenaLevelCfg.baseCfgData.forEach(function(e){e.dropId&&this.canGetLevelPrize(e.lv)&&0==this.isGetLevelPrize(e.lv)&&(this._canGetLevelPrize=!0)},this)},_updateRecoverTime:function(){this._recoverTimer&&(b8e.Timer.remove(this,this._updateRecoverTime),this._recoverTimer=null),game.CSArenaSender.getInfo()},getCanGetLevelPrize:function(){return this._canGetLevelPrize},getInfo:function(){null!=game.bianshen.getHasBianshenSlotIndex()&&game.CSArenaSender.getInfo()},getCurLvCfg:function(){return game.ccfg.CSArenaLevelCfg.getDataById(this.csLevel)},getCurLvMaxStar:function(){return this.getCurLvCfg().maxStar},getRankInfo:function(){game.SysTime.curTime>this._nextGetRankTime?game.CSArenaSender.getRankInfo():b8e.evt.dptG(game.CSArenaEvent.GET_RANK_INFO)},setRankInfo:function(e){if(e){var t,i;if(this._nextGetRankTime=game.SysTime.curTime,this.lastRankInfo=e.lastRanks,this.nowRankInfo=e.curRanks,this.lastRankInfo&&0<this.lastRankInfo.length)for(this.lastRankInfoMap.clear(),t=0;t<this.lastRankInfo.length;t++)(i=this.lastRankInfo[t])&&this.lastRankInfoMap.set(i.rank,i);if(this.nowRankInfo&&0<this.nowRankInfo.length)for(this.nowRankInfoMap.clear(),t=0;t<this.nowRankInfo.length;t++)(i=this.nowRankInfo[t])&&this.nowRankInfoMap.set(i.rank,i);b8e.evt.dptG(game.CSArenaEvent.GET_RANK_INFO)}},isGetQuestPrize:function(e){var t=this.csArenaInfo.questAwardRecords;return t&&-1!=t.indexOf(e)},canGetQuestPrize:function(e){var t=game.ccfg.CSArenaQuestAwardCfg.getDataById(e);return!!t&&this.csArenaInfo.questPoints>=t.points},getQuestPrize:function(e){this.canGetQuestPrize(e)&&0==this.isGetQuestPrize(e)&&game.CSArenaSender.getQuestPrize(e)},getQuestPrizeComplete:function(e){this.csArenaInfo.questAwardRecords.push(e),b8e.evt.dptG(game.CSArenaEvent.GET_QUEST_PRIZE)},getLogs:function(){game.CSArenaSender.getLogs()},setLogs:function(e){this.logs||(this.logs=new game.ArenaLogs),this.logs.setup(e,!0),b8e.evt.dptG(game.CSArenaEvent.GET_LOGS)},canGetLevelPrize:function(e){return this.csLevel>=e},isGetLevelPrize:function(e){var t=this.csArenaInfo.lvAwardRecords;return t&&-1!=t.indexOf(e)},getLevelPrize:function(e){this.canGetLevelPrize(e)&&0==this.isGetLevelPrize(e)&&game.CSArenaSender.getLevelPrize(e)},getAllLevelPrize:function(){game.ccfg.CSArenaLevelCfg.baseCfgData.forEach(function(e){this.getLevelPrize(e.lv)},this)},isGetAllLevelPrize:function(){var t=!1;return game.ccfg.CSArenaLevelCfg.baseCfgData.forEach(function(e){t||(t=this.canGetLevelPrize(e.lv)&&0==this.isGetLevelPrize(e.lv))},this),t},getLevelPrizeComplete:function(e){this.csArenaInfo.lvAwardRecords.push(e),this._getPrizeTimer||(this._getPrizeTimer=b8e.Timer.add(this,this._getPrizeCompelteUpdate,100,1))},_getPrizeCompelteUpdate:function(){this._updateGetLevelPrize(),b8e.evt.dptG(game.CSArenaEvent.GET_LEVEL_PRIZE),b8e.Timer.remove(this,this._getPrizeCompelteUpdate),this._getPrizeTimer=null},match:function(){game.team.isInTeam?game.notice.show(52e3):this.csArenaInfo.times<=0?game.notice.show(52001):game.CSArenaSender.match()},matchComplete:function(e){if(e.code)return game.notice.show(game.ccfg.ServerCodeCfg.getDesc(e.code)),void b8e.evt.dptG(game.CSArenaEvent.MATCH_COMPLETE,!1);b8e.evt.dptG(game.CSArenaEvent.MATCH_COMPLETE,!0),game.app.hide(game.AppConstant.CSARENA_PANEL)},onFinish:function(e){game.app.show(game.AppConstant.CSARENA_RESULT_PANEL,e)},buyTimes:function(){if(this.csArenaInfo.times!=this.csArenaInfo.maxTimes){var e=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.CS_ARENA,this.csArenaInfo.buyTimes);e&&game.upgrade.costCheck(this,e.upgradeInfo,this.onIsPass,!0)}else game.notice.show(26006)},onIsPass:function(e){e&&game.CSArenaSender.buyTimes()},buyTimesComplete:function(e){game.notice.show("购买成功!"),game.CSArenaSender.getInfo()},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CSARENA_ALERT,null,this.csArenaAlert,this)},csArenaAlert:function(){return!!this.csArenaInfo&&(this._canGetLevelPrize||0<this.csArenaInfo.times)}}),game.CSArenaMgr._instance=null,game.CSArenaMgr._singleton=!0,game.CSArenaMgr.inst=function(){return game.CSArenaMgr._instance||(game.CSArenaMgr._singleton=!1,game.CSArenaMgr._instance=new game.CSArenaMgr,game.CSArenaMgr._singleton=!0),game.CSArenaMgr._instance}},{}],248:[function(e,t,i){"use strict";game.CSArenaDanGradingItem=game.SkinUI.extends({_info:null,_icon:null,_iconName:null,_boxIcon:null,_boxIconEmpty:null,ctor:function(){this._super("csArena/CSArenaDanGradingItemSkin","CSArenaDanGradingItemSkin")},getWidth:function(){return 540},getHeight:function(){return 90},init:function(){this._icon=b8e.Sprite.get(),this._icon.setAnchor(.5,.5),this._icon.setScale(.7,.7),this._icon.addToParent(this._skin.icon),this._iconName=b8e.Sprite.get(),this._iconName.setAnchor(.5,.5),this._iconName.addToParent(this._skin.iconName),this._boxIcon=b8e.Sprite.get(),this._boxIcon.setAnchor(.5,.5),this._boxIcon.addToParent(this._skin.box),this._boxIconEmpty=b8e.Sprite.get(),this._boxIconEmpty.setAnchor(.5,.5),this._boxIconEmpty.addToParent(this._skin.imgGet)},onShow:function(){this.setData(this._info),b8e.evt.onC(this._skin.box,this.onShowAwardsTips,this),b8e.evt.onC(this._skin.imgGet,this.onShowAwardsTips,this)},onHide:function(){b8e.evt.offC(this._skin.box,this.onShowAwardsTips,this),b8e.evt.offC(this._skin.imgGet,this.onShowAwardsTips,this)},onShowAwardsTips:function(e){this._info&&(game.csArena.canGetLevelPrize(this._info.lv)&&0==game.csArena.isGetLevelPrize(this._info.lv)?game.CSArenaSender.getLevelPrize(this._info.lv):game.app.show(game.AppConstant.AWARD_TIPS_PANEL,this._info.dropId))},setData:function(e){if(this._info=e,this._skin&&this._info){this._icon.loadTexture(game.ClientCfg.getCSArenaLvIcon(this._info.lv),null,null,{useManifest:!1}),this._iconName.loadTexture(game.ClientCfg.getCSArenaLvName(this._info.lv),null,null,{useManifest:!1}),this._boxIcon.loadTexture(game.ClientCfg.getImgUrl(this._info.boxUrl),null,null,{useManifest:!1}),this._boxIconEmpty.loadTexture(game.ClientCfg.getImgUrl(this._info.boxUrl+"_empty"),null,null,{useManifest:!1}),this._skin.imgSelect.active=!1;var t=!!game.csArena.isGetLevelPrize(this._info.lv);this._skin.imgGet.active=t,game.csArena.canGetLevelPrize(this._info.lv)&&0==game.csArena.isGetLevelPrize(this._info.lv)?(this._skin.redAlert.active=!0,this._skin.box.active=!0,b8e.ShaderUtil.reset(this._boxIcon)):game.csArena.canGetLevelPrize(this._info.lv)&&game.csArena.isGetLevelPrize(this._info.lv)?(this._skin.box.active=!1,this._skin.redAlert.active=!1):(this._skin.box.active=!0,this._skin.redAlert.active=!1,b8e.ShaderUtil.setGray(this._boxIcon))}}})},{}],249:[function(e,t,i){"use strict";game.CSArenaDanGradingPanel=game.SkinUI.extends({_list:null,_icon:null,_iconName:null,ctor:function(){this._super("csArena/CSArenaDanGradingSkin","CSArenaDanGradingSkin")},init:function(){this._icon=b8e.Sprite.get(),this._icon.setAnchor(.5,.5),this._icon.setScale(.6,.6),this._icon.addToParent(this._skin.icon),this._iconName=b8e.Sprite.get(),this._iconName.setAnchor(.5,.5),this._iconName.addToParent(this._skin.iconName)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.CSArenaDanGradingItem)),this._list.show(),this.onUpdateInfo(),b8e.evt.onC(this._skin.btnGet,this.onGetAwards,this),b8e.evt.addG(this,game.CSArenaEvent.GET_LEVEL_PRIZE,this.onUpdateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btnGet,this.onGetAwards,this),b8e.evt.rmvG(this,game.CSArenaEvent.GET_LEVEL_PRIZE,this.onUpdateInfo)},onUpdateInfo:function(){var e=game.ccfg.CSArenaLevelCfg.getLevelList();this._list.setData(e),game.csArena.getCanGetLevelPrize()?b8e.ShaderUtil.reset(this._skin.btnGet):b8e.ShaderUtil.setGray(this._skin.btnGet),this._icon.loadTexture(game.ClientCfg.getCSArenaLvIcon(game.csArena.csLevel),null,null,{useManifest:!1}),this._iconName.loadTexture(game.ClientCfg.getCSArenaLvName(game.csArena.csLevel),null,null,{useManifest:!1})},onGetAwards:function(){game.csArena.getAllLevelPrize()}})},{}],250:[function(e,t,i){"use strict";game.appModule.CSArenaFightCountBuyPanel=game.SkinUIPanel.extends({_amountInfo:null,str:"",ctor:function(e){this._super(e)},init:function(){this._skin.lab_des.string=game.ccfg.LangCfg.getText(26003)},onShow:function(){this.setData(),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.addG(this,game.CSArenaEvent.GET_INFO,this.setData),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.setData)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.rmvG(this,game.CSArenaEvent.GET_INFO,this.setData),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.setData)},setData:function(){this.setCostItem()},setBuyCount:function(){var e=game.html.Q_GREEN,t=game.csArena.csArenaInfo,i=game.ccfg.CostCfg.getMaxBuyCountById(game.SystemId.CS_ARENA)-t.buyTimes;e=0<i?game.html.Q_GREEN:game.html.Q_RED,this._skin.lab_buyCount.string=game.ccfg.LangCfg.getText(24001,[game.html.getText(e,i)])},setCostItem:function(){var e=game.csArena.csArenaInfo,t=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.CS_ARENA,e.buyTimes);if(t){var i=t.upgradeInfo;if(i&&(this._amountInfo=i.getAmountInfo(),this._amountInfo)){var n=this._amountInfo.getAllTyps();if(n&&0<n.length){var s=this._amountInfo.getFirstAmountType(),a=this._amountInfo.getFirstAmountValue(),o=game.back.getAmountInfo();switch(s){case game.AmountType.SILVER:var r=o.getValue(game.AmountType.SILVER);0<a&&(this.str=a<=r?game.html.getText(game.html.Q_GREEN,a):game.html.getText(game.html.Q_RED,a));break;case game.AmountType.YUAN_BAO:var h=o.getValue(game.AmountType.YUAN_BAO);0<a&&(this.str=a<=h?game.html.getText(game.html.Q_GREEN,a):game.html.getText(game.html.Q_RED,a));break;case game.AmountType.POPULARITY:var g=o.getValue(game.AmountType.POPULARITY);0<a&&(this.str=a<=g?game.html.getText(game.html.Q_GREEN,a):game.html.getText(game.html.Q_RED,a));case game.AmountType.HONOUR:var l=o.getValue(game.AmountType.HONOUR);0<a&&(this.str=a<=l?game.html.getText(game.html.Q_GREEN,a):game.html.getText(game.html.Q_RED,a))}}return(s=this._amountInfo.getFirstAmountType())==game.AmountType.SILVER&&(this._skin.img_yinbi.active=!0,this._skin.img_yuanbao.active=!1),s==game.AmountType.YUAN_BAO&&(this._skin.img_yinbi.active=!1,this._skin.img_yuanbao.active=!0),void(this._skin.lab_cost.string=this.str)}}},onClickBuyBtn:function(){game.csArena.buyTimes()}})},{}],251:[function(e,t,i){"use strict";game.CSArenaLastRankItem=game.SkinUI.extends({_info:null,_boxIcon:null,_rankIcon:null,ctor:function(){this._super("csArena/CSArenaLastRankItemSkin","CSArenaLastRankItemSkin")},getWidth:function(){return 540},getHeight:function(){return 120},init:function(){this._boxIcon=b8e.Sprite.get(),this._boxIcon.setAnchor(.5,.5),this._boxIcon.addToParent(this._skin.box),this._rankIcon=b8e.Sprite.get(),this._rankIcon.setAnchor(.5,.5),this._rankIcon.addToParent(this._skin.labRank.node),this._bsGrids=[]},onShow:function(){this.setData(this._info),b8e.evt.onC(this._skin.box,this.onShowAwardsTips,this)},onHide:function(){b8e.evt.offC(this._skin.box,this.onShowAwardsTips,this)},onShowAwardsTips:function(e){if(this._info){var t=game.ccfg.CSArenaRankAwardCfg.getDataById(this._info.rank);t&&game.app.show(game.AppConstant.AWARD_TIPS_PANEL,t.dropId)}},setData:function(e){if(this._info=e,this._skin&&this._info){this.clearGrids();var t=game.csArena.lastRankInfoMap.get(this._info.rank);if(t){this.setVisibleState(!0),this._skin.labStar.string=game.ccfg.CSArenaLevelCfg.getStar(t.level),this._skin.labName.string=t.name+"\n.s"+t.zone,this._skin.labPower.string=t.power;for(var i,n,s,a=this._bsGrids.length,o=0;o<t.bianshen.length;o++)(n=t.bianshen[o])&&(o<a?s=this._bsGrids[o]:((s=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.CSARENA_RANK_BS_CONTAINER_ID),s.addToParent(this._skin.grid),s.x=85*o,s.setScale(game.IconScale.PERCENT_67,game.IconScale.PERCENT_67),this._bsGrids.push(s)),i=game.ItemInfoUtil.createCSArenaBSInfo(n),game.GridUtil.setBianshenGrid(s,i),s.setName(""),s.sortLayer())}else this.setVisibleState(!1);this._info.rank<4?(this._skin.labRank.string="",this._rankIcon.loadTexture(game.ClientCfg.getImgUrl("csArena/"+this._info.rank),null,null,{useManifest:!1}),this._rankIcon.x=10):(this._rankIcon.unloadTexture(),this._skin.labRank.string=this._info.rank);var r=game.ccfg.CSArenaRankAwardCfg.getDataById(this._info.rank);r&&this._boxIcon.loadTexture(game.ClientCfg.getImgUrl(r.boxUrl),null,null,{useManifest:!1})}},setVisibleState:function(e){this._skin.labXw.active=!e,this._skin.imgXw.active=!e,this._skin.imgStar.active=e,this._skin.imgPower.active=e,this._skin.labStar.node.active=e,this._skin.labName.node.active=e,this._skin.labPower.node.active=e},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setItemGrid(e,null)}})},{}],252:[function(e,t,i){"use strict";game.CSArenaLastRankPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("csArena/CSArenaLastRankSkin","CSArenaLastRankSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.CSArenaLastRankItem)),this._list.show(),game.csArena.getRankInfo(),this.onUpdateInfo(),b8e.evt.addG(this,game.CSArenaEvent.GET_RANK_INFO,this.onUpdateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.CSArenaEvent.GET_RANK_INFO,this.onUpdateInfo)},onUpdateInfo:function(){this._skin.labTip.active=!1;var e=game.ccfg.CSArenaRankAwardCfg.getDatas();this._list.setData(e)}})},{}],253:[function(e,t,i){"use strict";game.appModule.CSArenaLogPanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.addG(this,game.CSArenaEvent.GET_LOGS,this.updateLogs),game.csArena.getLogs(),this._list||(this._list=new b8e.List(this._skin.list,game.ArenaLogItem)),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.CSArenaEvent.GET_LOGS,this.updateLogs)},updateLogs:function(){var e=game.csArena.logs.list;0<e.length?this._skin.tips.node.active=!1:this._skin.tips.node.active=!0,this._list.setData(e)}})},{}],254:[function(e,t,i){"use strict";game.CSArenaMainPanel=game.SkinUI.extends({_listItems:null,_timer:null,_bg:null,_badgeSprite:null,_nameSprite:null,_battleSlotLists:null,_awardCfgs:null,isGet1:!1,isGet2:!1,isCanGet1:!1,isCanGet2:!1,url:"",_starBar:null,_width:0,ctor:function(){this._super("csArena/CSArenaMainSkin","CSArenaMainSkin"),this._battleSlotLists=[],this._awardCfgs=[]},init:function(){this._badgeSprite=b8e.Sprite.get(),this._badgeSprite.setAnchor(.5,.5),this._badgeSprite.addToParent(this._skin.badge_node),this._nameSprite=b8e.Sprite.get(),this._nameSprite.setAnchor(.5,.5),this._nameSprite.addToParent(this._skin.badge_lab_node),this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.bg_node),this._bg.loadTexture(game.ClientCfg.getImgUrl("csArena/csBg",!0),null,null,{useManifest:!1}),this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.star_node),this._starBar.setAnchor(.5,.5),this._awardCfgs=game.ccfg.CSArenaQuestAwardCfg.getDatas(),this._width=this._skin.img_progress.width,this._skin.lab_start_time_desc.string=game.ccfg.LangCfg.getText(26001),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(26002)},onShow:function(){b8e.evt.onC(this._skin.btn_record,this.onClickRecordBtn,this),b8e.evt.onC(this._skin.btn_help,this.onClickHelpBtn,this),b8e.evt.onC(this._skin.btn_jiahao,this.onClickJiahaoBtn,this),b8e.evt.onC(this._skin.btn_match,this.onClickMatchBtn,this),b8e.evt.onC(this._skin.btn_change_f,this.onClickFChangeBtn,this),b8e.evt.onC(this._skin.btn_change_s,this.onClickSChangeBtn,this),b8e.evt.onC(this._skin.img_award_1,this.onClickFAwardBtn,this),b8e.evt.onC(this._skin.img_award_2,this.onClickSAwardBtn,this),b8e.evt.onC(this._skin.img_award_isGet_1,this.onClickFAwardBtn,this),b8e.evt.onC(this._skin.img_award_isGet_2,this.onClickSAwardBtn,this),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updataLockSlotStatus),b8e.evt.addG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.updataLockSlotStatus),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateAllSlot),b8e.evt.addG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.updateAllSlot),b8e.evt.addG(this,game.BianshenEvent.START_BIANSHEN,this.updateAllSlot),b8e.evt.addG(this,game.CSArenaEvent.GET_QUEST_PRIZE,this.updateAward),b8e.evt.addG(this,game.CSArenaEvent.GET_INFO,this.initPanel),b8e.evt.addG(this,game.CSArenaEvent.MATCH_COMPLETE,this.matchComplete),this.setSlot(),game.csArena.getInfo(),!this._awardCfgs||this._awardCfgs.length<2||(this._skin.lab_award_1.string=this._awardCfgs[0].points,this._skin.lab_award_2.string=this._awardCfgs[1].points)},onHide:function(){b8e.evt.offC(this._skin.btn_record,this.onClickRecordBtn,this),b8e.evt.offC(this._skin.btn_help,this.onClickHelpBtn,this),b8e.evt.offC(this._skin.btn_jiahao,this.onClickJiahaoBtn,this),b8e.evt.offC(this._skin.btn_match,this.onClickMatchBtn,this),b8e.evt.offC(this._skin.btn_change_f,this.onClickFChangeBtn,this),b8e.evt.offC(this._skin.btn_change_s,this.onClickSChangeBtn,this),b8e.evt.offC(this._skin.img_award_1,this.onClickFAwardBtn,this),b8e.evt.offC(this._skin.img_award_2,this.onClickSAwardBtn,this),b8e.evt.offC(this._skin.img_award_isGet_1,this.onClickFAwardBtn,this),b8e.evt.offC(this._skin.img_award_isGet_2,this.onClickSAwardBtn,this),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updataLockSlotStatus),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.updataLockSlotStatus),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateAllSlot),b8e.evt.rmvG(this,game.AchievementEvent.ACHIEVEMENT_AWARD_CHANGE,this.updateAllSlot),b8e.evt.rmvG(this,game.BianshenEvent.START_BIANSHEN,this.updateAllSlot),b8e.evt.rmvG(this,game.CSArenaEvent.GET_QUEST_PRIZE,this.updateAward),b8e.evt.rmvG(this,game.CSArenaEvent.GET_INFO,this.initPanel),b8e.evt.rmvG(this,game.CSArenaEvent.MATCH_COMPLETE,this.matchComplete)},initPanel:function(){this.startResetTime(),this.updateAward(),this._skin.lab_match.string=game.ccfg.LangCfg.getText(26005);var e=game.csArena.getCurLvMaxStar(),t=game.csArena.curStar,i=game.csArena.csArenaInfo;if(this._starBar&&(0!=e?(this._skin.lab_star.node.active=!1,this._starBar.setStarGradeData(e,t,game.StarType.CSARENA_MAIN_STAR)):(this._skin.lab_star.node.active=0!=t,this._skin.lab_star.string=t,this._starBar.setStarGradeData(1,1,game.StarType.CSARENA_MAIN_STAR)),this._starBar.x=-.5*this._starBar._starWidth,this.url=game.ClientCfg.getCSArenaLvIcon(game.csArena.csLevel),this._badgeSprite.loadTexture(this.url,null,null,{useManifest:!1}),this.url=game.ClientCfg.getCSArenaLvName(game.csArena.csLevel),this._nameSprite.loadTexture(this.url,null,null,{useManifest:!1}),this._awardCfgs&&1<this._awardCfgs.length)){var n=i.questPoints/this._awardCfgs[1].points;this._skin.mask.width=this._width*n,this._skin.lab_progress.string=i.questPoints+"/"+this._awardCfgs[1].points}},matchComplete:function(e){e&&(e.data?game.app.hide(game.AppConstant.CSARENA_PANEL):this._skin.lab_match.string=game.ccfg.LangCfg.getText(26005))},updateAward:function(){!this._awardCfgs||this._awardCfgs.length<2||(this.isGet1=game.csArena.isGetQuestPrize(this._awardCfgs[0].id),this.isGet2=game.csArena.isGetQuestPrize(this._awardCfgs[1].id),this.isCanGet1=game.csArena.canGetQuestPrize(this._awardCfgs[0].id),this.isCanGet2=game.csArena.canGetQuestPrize(this._awardCfgs[1].id),this._skin.img_award_isGet_1.active=!1,this._skin.img_award_isGet_2.active=!1,this.isGet1?(this._skin.img_award_1.active=!1,this._skin.img_award_isGet_1.active=!0):this.isCanGet1?b8e.ShaderUtil.reset(this._skin.img_award_1):b8e.ShaderUtil.setGray(this._skin.img_award_1),this.isGet2?(this._skin.img_award_2.active=!1,this._skin.img_award_isGet_2.active=!0):this.isCanGet2?b8e.ShaderUtil.reset(this._skin.img_award_2):b8e.ShaderUtil.setGray(this._skin.img_award_2))},setSlot:function(){this.clearSlot();var e,t=0,i=this._battleSlotLists.length,n=game.bianshen.getBattleSlots();if(n&&0<n.length)for(var s=0;s<n.length;s++){var a=n[s];a&&(s<i?e=this._battleSlotLists[s]:(e=new game.BianshenPackSlotGrid,t=10+game.IcoSizeEnum.SIZE_107*game.IconScale.PERCENT_80*(s+.5)+77*s,e.setPosition(t,50),e.addToParent(this._skin.slot_node),this._battleSlotLists.push(e)),e.setData(a))}},updateSlotByIndex:function(e){var t=game.bianshen.getBattleSlots();if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.index==e){var s=this._battleSlotLists[i];s&&(s.setVisible(!0),s.setData(n))}}},updateAllSlot:function(){var e=game.bianshen.getBattleSlots();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._battleSlotLists[t];n&&n.setData(i)}}},updataLockSlotStatus:function(e){e&&e.data&&this.updateSlotByIndex(e.data.slotIndex)},onClickRecordBtn:function(){game.app.show(game.AppConstant.CSARENA_LOG_PANEL)},onClickHelpBtn:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.CS_ARENA_RULE_ID)},onClickJiahaoBtn:function(){game.app.show(game.AppConstant.CSARENA_BUY_PANEL)},onClickMatchBtn:function(){var e=game.csArena.csArenaInfo;game.team.isInTeam?game.notice.show("有队伍不能进行匹配"):e.times<=0?game.notice.show(26007):(this._skin.lab_match.string=game.ccfg.LangCfg.getText(26004),game.csArena.match())},onClickFChangeBtn:function(){game.bianshen.swapBianshenSlot(0,1)},onClickSChangeBtn:function(){game.bianshen.swapBianshenSlot(1,2)},onClickFAwardBtn:function(){this.isCanGet1&&!this.isGet1?game.csArena.getQuestPrize(this._awardCfgs[0].id):this._awardCfgs[0].dropId&&game.app.show(game.AppConstant.AWARD_TIPS_PANEL,this._awardCfgs[0].dropId)},onClickSAwardBtn:function(){this.isCanGet2&&!this.isGet2?game.csArena.getQuestPrize(this._awardCfgs[1].id):this._awardCfgs[1].dropId&&game.app.show(game.AppConstant.AWARD_TIPS_PANEL,this._awardCfgs[1].dropId)},startResetTime:function(){var e=game.csArena,t=e.csArenaInfo;if(t)if(this._skin.lab_have_time.string="<color=#FFC045>剩余参与次数:</c>"+t.times+"/"+t.maxTimes,t.times==t.maxTimes)this._timer&&this._timer.stop(),this._skin.lab_reset_time.string="";else{var i=e.nextResetTime-game.SysTime.curTime;i<0&&(i=0),this._skin.lab_reset_time.string=b8e.TimeUtil.formatTime(i),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateResetTime,500)}},updateResetTime:function(){var e=game.csArena,t=e.csArenaInfo;if(t)if(t.times==t.maxTimes)this._timer&&this._timer.stop(),this._skin.lab_reset_time.string="";else{var i=e.nextResetTime-game.SysTime.curTime;i<0&&(i=0),this._skin.lab_reset_time.string=b8e.TimeUtil.formatTime(i)}},clearSlot:function(){}})},{}],255:[function(e,t,i){"use strict";game.appModule.CSArenaPanel=game.SkinUIPanel.extends({_index:-1,_arenaPage:null,_curRank:null,_lastRank:null,_dangRading:null,_lastPage:null,ctor:function(e){this._super(e)},init:function(){this._arenaPage||(this._arenaPage=new game.CSArenaMainPanel,this._arenaPage.addToParent(this._skin.panel_node)),this._curRank||(this._curRank=new game.CSArenaRankPanel,this._curRank.addToParent(this._skin.panel_node)),this._lastRank||(this._lastRank=new game.CSArenaLastRankPanel,this._lastRank.addToParent(this._skin.panel_node)),this._dangRading||(this._dangRading=new game.CSArenaDanGradingPanel,this._dangRading.addToParent(this._skin.panel_node))},setTab:function(e){return!!this._skin},onShow:function(){-1==this._index&&(this._index=0),this.onSelectPanelByIndex(this._index),this._skin.rewardPoint.active=game.csArena.getCanGetLevelPrize(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onOpenFightPanel,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onOpenDanGradingPanel,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onOpenRankPanel,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onOpenLastRankPanel,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onHide:function(){b8e.evt.offC(this._skin.buttonToggle[0].node,this.onOpenFightPanel,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onOpenDanGradingPanel,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onOpenRankPanel,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onOpenLastRankPanel,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onOpenFightPanel:function(e){0!=this._index&&this.onSelectPanelByIndex(0)},onOpenDanGradingPanel:function(e){1!=this._index&&this.onSelectPanelByIndex(1)},onOpenRankPanel:function(e){2!=this._index&&this.onSelectPanelByIndex(2)},onOpenLastRankPanel:function(e){3!=this._index&&this.onSelectPanelByIndex(3)},onSelectPanelByIndex:function(e){switch(this._lastPage&&this._lastPage.hide(),this._index=e,this._skin.buttonToggle[this._index].check(),this._index){case 0:this._arenaPage.show(),this._lastPage=this._arenaPage;break;case 1:this._dangRading.show(),this._lastPage=this._dangRading;break;case 2:this._curRank.show(),this._lastPage=this._curRank;break;case 3:this._lastRank.show(),this._lastPage=this._lastRank}},onSpotAlertChange:function(){this._skin.rewardPoint.active=game.csArena.getCanGetLevelPrize()}})},{}],256:[function(e,t,i){"use strict";game.CSArenaRankItem=game.SkinUI.extends({_info:null,_boxIcon:null,_bsGrids:null,_rankIcon:null,ctor:function(){this._super("csArena/CSArenaRankItemSkin","CSArenaRankItemSkin")},getWidth:function(){return 540},getHeight:function(){return 120},init:function(){this._boxIcon=b8e.Sprite.get(),this._boxIcon.setAnchor(.5,.5),this._boxIcon.addToParent(this._skin.box),this._rankIcon=b8e.Sprite.get(),this._rankIcon.setAnchor(.5,.5),this._rankIcon.addToParent(this._skin.labRank.node),this._bsGrids=[]},onShow:function(){this.setData(this._info),b8e.evt.onC(this._skin.box,this.onShowAwardsTips,this)},onHide:function(){b8e.evt.offC(this._skin.box,this.onShowAwardsTips,this)},onShowAwardsTips:function(e){if(this._info){var t=game.ccfg.CSArenaRankAwardCfg.getDataById(this._info.rank);t&&game.app.show(game.AppConstant.AWARD_TIPS_PANEL,t.dropId)}},setData:function(e){if(this._info=e,this._skin&&this._info){this.clearGrids();var t=game.csArena.nowRankInfoMap.get(this._info.rank);if(t){this.setVisibleState(!0),this._skin.labStar.string=game.ccfg.CSArenaLevelCfg.getStar(t.level),this._skin.labName.string=t.name+"\n.s"+t.zone,this._skin.labPower.string=t.power;for(var i,n,s,a=this._bsGrids.length,o=0;o<t.bianshen.length;o++)(n=t.bianshen[o])&&(o<a?s=this._bsGrids[o]:((s=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.CSARENA_RANK_BS_CONTAINER_ID),s.addToParent(this._skin.grid),s.x=85*o,s.setScale(game.IconScale.PERCENT_67,game.IconScale.PERCENT_67),this._bsGrids.push(s)),i=game.ItemInfoUtil.createCSArenaBSInfo(n),game.GridUtil.setBianshenGrid(s,i),s.setName(""),s.sortLayer())}else this.setVisibleState(!1);this._info.rank<4?(this._skin.labRank.string="",this._rankIcon.loadTexture(game.ClientCfg.getImgUrl("csArena/"+this._info.rank),null,null,{useManifest:!1}),this._rankIcon.x=10):(this._rankIcon.unloadTexture(),this._skin.labRank.string=this._info.rank);var r=game.ccfg.CSArenaRankAwardCfg.getDataById(this._info.rank);r&&this._boxIcon.loadTexture(game.ClientCfg.getImgUrl(r.boxUrl),null,null,{useManifest:!1})}},setVisibleState:function(e){this._skin.labXw.active=!e,this._skin.imgXw.active=!e,this._skin.imgStar.active=e,this._skin.imgPower.active=e,this._skin.labStar.node.active=e,this._skin.labName.node.active=e,this._skin.labPower.node.active=e},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setItemGrid(e,null)}})},{}],257:[function(e,t,i){"use strict";game.CSArenaRankPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("csArena/CSArenaRankSkin","CSArenaRankSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.CSArenaRankItem)),this._list.show(),game.csArena.getRankInfo(),this.onUpdateInfo(),b8e.evt.addG(this,game.CSArenaEvent.GET_RANK_INFO,this.onUpdateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.CSArenaEvent.GET_RANK_INFO,this.onUpdateInfo)},onUpdateInfo:function(){this._skin.labTip.active=!1;var e=game.ccfg.CSArenaRankAwardCfg.getDatas();this._list.setData(e)}})},{}],258:[function(e,t,i){"use strict";game.appModule.CSArenaResultPanel=game.SkinUIPanel.extends({_badgeSprite:null,_nameSprite:null,url:"",_starBar:null,_effect:null,_anim:null,_badgeEffect:null,_badgeAnim:null,_timer:null,_leaveTime:10,cfg:null,csLevel:0,_isUpgradeBadge:!1,_prizeList:null,_prizeInfo:null,stats:null,curStar:0,effectStarIndex:0,curStarBarMax:0,ctor:function(e){this._super(e)},init:function(){this._badgeSprite=b8e.Sprite.get(),this._badgeSprite.addToParent(this._skin.badge_node),this._badgeSprite.setAnchor(.5,.5),this._nameSprite=b8e.Sprite.get(),this._nameSprite.addToParent(this._skin.badge_lab_node),this._nameSprite.setAnchor(.5,.5),this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.star_node),this._starBar.setAnchor(.5,.5),this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect),this._anim=b8e.Animator.get(game.AnimatorType.CSARENA_STAR_EFFECT,1),this._anim.addFinishCallback(this.starEffectCallback,this),this._effect.addChild(this._anim),this._badgeEffect=b8e.BaseDisplay.get(),this._badgeEffect.addToParent(this._skin.badge_effect),this._badgeAnim=b8e.Animator.get(game.AnimatorType.CSARENA_BADGE_EFFECT,1),this._badgeAnim.addFinishCallback(this.badgeEffectCallback,this),this._badgeEffect.addChild(this._badgeAnim),this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90,game.IconScale.PERCENT_80,5),this._prizeList.addToParent(this._skin.prize),this._prizeInfo=new game.PrizeInfo,this.stats=new game.ArenaLogStat},onShow:function(){this.data&&(this._prizeList.setData(null),this._isUpgradeBadge=!1,this.csLevel=game.ccfg.CSArenaLevelCfg.getLevelByStart(this.data.level),this.cfg=game.ccfg.CSArenaLevelCfg.getDataById(this.csLevel),this.curStar=game.ccfg.CSArenaLevelCfg.getStar(this.data.level),this.cfg&&(this.maxStar=this.cfg.maxStar,this.clearEffect(),this._skin.btn_sure.active=!1,this._skin.btn_record.active=!1,this.initPanel(),this._leaveTime=10,this._skin.lab_sure.string="确定("+this._leaveTime+"s)",b8e.evt.onC(this._skin.btn_record,this.onClickRecordBtn,this),b8e.evt.onC(this._skin.btn_sure,this.onClickSureBtn,this)))},onHide:function(){this.clearEffect(),this._prizeList.setData(null),b8e.evt.offC(this._skin.btn_record,this.onClickRecordBtn,this),b8e.evt.offC(this._skin.btn_sure,this.onClickSureBtn,this)},timeStart:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateSureTime,1e3)),this._timer.reset(),this._timer.start()},setPrize:function(){this.data&&(this._prizeInfo.setup(this.data.userItem),this._prizeList.setData(this._prizeInfo))},initPanel:function(){var e,t,i;this.data&&(1==this.data.State?(this._skin.failure_node.active=!1,this._skin.sucess_node.active=!0,t=game.ccfg.CSArenaLevelCfg.getLevelByStart(this.data.level-1),(i=game.ccfg.CSArenaLevelCfg.getDataById(t))&&this.cfg&&(i.lv<this.cfg.lv?this._isUpgradeBadge=!0:this._isUpgradeBadge=!1),0==this.curStar?(e=i.maxStar-1,this.effectStarIndex=i.maxStar):(e=this.curStar-1,this.effectStarIndex=this.curStar),this.curStarBarMax=i.maxStar):(this._skin.failure_node.active=!0,this._skin.sucess_node.active=!1,this._skin.btn_sure.active=!0,this._skin.btn_record.active=!0,this.timeStart(),this.setPrize(),e=this.curStar,t=this.csLevel,this.curStarBarMax=this.maxStar),this._starBar&&(0!=this.curStarBarMax?(this._skin.lab_star.node.active=!1,this._starBar.setStarGradeData(this.curStarBarMax,e,game.StarType.CSARENA_MAIN_STAR)):(this._skin.lab_star.node.active=0!=e,this._skin.lab_star.string=e,this._starBar.setStarGradeData(1,1,game.StarType.CSARENA_MAIN_STAR)),this._starBar.x=-.5*this._starBar._starWidth,1==this.data.State&&this.playStarEffect(),this.url=game.ClientCfg.getCSArenaLvIcon(t),this._badgeSprite.loadTexture(this.url,null,null,{useManifest:!1}),this.url=game.ClientCfg.getCSArenaLvName(t),this._nameSprite.loadTexture(this.url,null,null,{useManifest:!1})))},playStarEffect:function(){var e=game.ClientCfg.getUIFxs("10075");e?(0!=this.curStarBarMax?this._effect.x=this._starBar._starWidth*(this.effectStarIndex-.5)/this.curStarBarMax-.5*this._starBar._starWidth:this._effect.x=0,b8e.info("this._starBar._starHeigth:"+this._starBar._starHeigth+"this._starBar._starWidth:"+this._starBar._starWidth+"this._effect.x"+this._effect.x+"this.effectStarIndex"+this.effectStarIndex+"this.maxStar"+this.maxStar+"this.curStarBarMax"+this.curStarBarMax),this._effect.y=.5*this._starBar._starHeigth,this._effect.setVisible(!0),this._anim.load(e),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearEffect:function(){this._effect&&this._effect.setVisible(!1),this._badgeEffect&&this._badgeEffect.setVisible(!1)},starEffectCallback:function(){this._effect&&this._effect.setVisible(!1),0!=this.maxStar?(this._skin.lab_star.node.active=!1,this._starBar.setStarGradeData(this.maxStar,this.curStar,game.StarType.CSARENA_MAIN_STAR)):(0==this.curStar?this._skin.lab_star.node.active=!1:this._skin.lab_star.node.active=!0,this._skin.lab_star.string=this.curStar,this._starBar.setStarGradeData(1,1,game.StarType.CSARENA_MAIN_STAR)),this._starBar.x=-.5*this._starBar._starWidth,this._isUpgradeBadge?this.playBadgeEffect():(this.timeStart(),this.setPrize(),this._skin.btn_sure.active=!0,this._skin.btn_record.active=!0)},playBadgeEffect:function(){var e=game.ClientCfg.getUIFxs("10084");e?(this._badgeEffect.setVisible(!0),this._badgeAnim.load(e),this._badgeAnim.play(null,0)):this._badgeAnim&&this._badgeAnim.clear()},badgeEffectCallback:function(){this._badgeEffect&&this._badgeEffect.setVisible(!1),this.timeStart(),this.setPrize(),this.url=game.ClientCfg.getCSArenaLvIcon(this.csLevel),this._badgeSprite.loadTexture(this.url,null,null,{useManifest:!1}),this.url=game.ClientCfg.getCSArenaLvName(this.csLevel),this._nameSprite.loadTexture(this.url,null,null,{useManifest:!1}),this._skin.btn_sure.active=!0,this._skin.btn_record.active=!0},onClickSureBtn:function(){var e=game.SceneMgr.inst().getSceneConfig();e&&(e.type==game.SceneType.ARENA&&game.SceneSender.leaveAloneDungeon(),this._timer&&this._timer.stop(),this.hide())},onClickRecordBtn:function(){this.data&&(this.stats.setup(this.data.stats),game.app.show(game.AppConstant.ARENA_COMBATDATA_PANEL,this.stats))},updateSureTime:function(){0<this._leaveTime?(this._leaveTime--,this._skin.lab_sure.string="确定("+this._leaveTime+"s)"):this.onClickSureBtn()}})},{}],259:[function(e,t,i){"use strict";game.CSArenaVSLeft=game.SkinUI.extends({_vsBg:null,_bianShenIcons:null,_bianshenInfos:null,_levelIcon:null,_levelName:null,_head:null,ctor:function(){this._super("csArena/CSArenaLeftSkin","CSArenaVsSkin")},onShow:function(){this.initPanel();var e=game.arena.arenaLeftPlayerInfo;if(e){var t=game.ccfg.HeadCfg.getbigIcon(e.head);if(""!=e.head){var i=game.ClientCfg.getHeadUrl(t);this._head.loadTexture(i,null,null,{useManifest:!1})}else this._head.unloadTexture();this._skin.roleName.string=e.name;var n=game.ccfg.CSArenaLevelCfg.getLevelByStart(e.arenaLv);this._levelName.loadTexture(game.ClientCfg.getCSArenaLvName(n),null,null,{useManifest:!1}),this._levelIcon.loadTexture(game.ClientCfg.getCSArenaLvIcon(n),null,null,{useManifest:!1}),this._skin.prower.string=e.power;var s=e.getIdList();if(s)for(var a,o=0;o<3;o++){var r=this._bianshenInfos[o],h=this._bianShenIcons[o];if(a=s[o]){var g=e.getBianshenById(a);if(!g)continue;r.id=a,r.level=g.lv,r.jie=g.jie,r.name=game.ccfg.BianshenCfg.getNameById(a),r.iconName=game.ccfg.BianshenCfg.getIconById(a),r.quality=game.ccfg.BianshenCfg.getQualityById(a),r.star=game.ccfg.BianshenCfg.getStarById(a),r.wuxing=game.ccfg.BianshenCfg.getGenreById(a),r.restraintRate=game.ccfg.BianshenCfg.getRestraintRate(a),r.qualityEffect=game.ccfg.BianshenCfg.getQuilatyEffectById(a),h.setVisible(!0),h.setData(r,!1,!1)}else h.setVisible(!1)}}},initPanel:function(){if(this._vsBg||(this._vsBg=b8e.Sprite.get(),this._vsBg.setAnchor(.5,.5),this._vsBg.addToParent(this._skin.vsBg),this._vsBg.loadTexture(game.ClientCfg.getCSVsUrl("VS_left"),null,null,{useManifest:!1})),this._head||(this._head=b8e.Sprite.get(),this._head.setAnchor(.5,.5),this._head.addToParent(this._skin.head)),this._levelIcon||(this._levelIcon=b8e.Sprite.get(),this._levelIcon.setAnchor(.5,.5),this._levelIcon.setScale(.6,.6),this._levelIcon.addToParent(this._skin.levelIcon)),this._levelName||(this._levelName=b8e.Sprite.get(),this._levelName.setAnchor(.5,.5),this._levelName.addToParent(this._skin.levelName)),!this._bianShenIcons&&!this._bianshenInfos){this._bianShenIcons=[],this._bianshenInfos=[];for(var e=0;e<3;e++){var t=new game.BianShenPackGrid;t.addToParent(this._skin.icon),t.setPosition(120*e,0),this._bianShenIcons.push(t),this._bianshenInfos.push(new game.BianshenInfo)}}}})},{}],260:[function(e,t,i){"use strict";game.CSArenaVsPage=engine.BaseDisplay.extends({_bgGraph:null,_isShowing:!1,_isWaitHide:!1,_left:null,_right:null,showPage:function(){if(!this.parent){var e=b8e.layer.getTopLayer();this.addToParent(e),this.setLocalZOrder(999999999),this._isShowing=!0,this.onShow()}},onShow:function(){this._bgGraph||(this._bgGraph=b8e.Graphics.get(),this._bgGraph.setAnchor(.5,.5),this._bgGraph.addToParent(this)),this._left||(this._left=new game.CSArenaVSLeft,this._left.addToParent(this)),this._right||(this._right=new game.CSArenaVsRight,this._right.addToParent(this)),this._vsIcon||(this._vsIcon=b8e.Sprite.get(),this._vsIcon.setAnchor(.5,.5),this._vsIcon.addToParent(this),this._vsIcon.loadTexture(game.ClientCfg.getCSVsUrl("VS"),null,null,{useManifest:!1})),this._vsIcon.alpha=0,b8e.evt.addG(this._node,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.onC(this._bgGraph,this.onClick,this),this.onResize(),this.showTween()},showTween:function(){this._left.show(),this._right.show(),this._left.setPosition(-.5*b8e.stageWidth,-.5*b8e.stageHeight),this._right.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight),b8e.Tween.get(this._left).to({x:0,y:0},200).call(this._showMoveTweenComplete,this),b8e.Tween.get(this._right).to({x:0,y:0},200)},_showMoveTweenComplete:function(){this._vsIcon.alpha=0,this._vsIcon.setScale(1.5,1.5),b8e.Tween.get(this._vsIcon).to({alpha:1,scaleX:1,scaleY:1},200).wait(1e3).call(this._showTweenComplete,this)},_showTweenComplete:function(){this._isShowing=!1,this._isWaitHide&&this._hideTween()},hidePage:function(){this.parent&&(1==this._isShowing?this._isWaitHide=!0:this._hideTween())},_hideTween:function(){b8e.Tween.get(this._vsIcon).to({alpha:0,scaleX:1.5,scaleY:1.5},300).call(this._hideVsIconComplete,this)},_hideVsIconComplete:function(){b8e.Tween.get(this._left).to({x:.5*b8e.stageWidth,y:.5*b8e.stageHeight},200).call(this._hideTweenComplete,this),b8e.Tween.get(this._right).to({x:-.5*b8e.stageWidth,y:-.5*b8e.stageHeight},200)},_hideTweenComplete:function(){this.onHide()},onHide:function(){this._isWaitHide=!1,this.removeFromParent(),this._left.hide(),this._right.hide(),b8e.evt.rmvG(this._node,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.offC(this._bgGraph,this.onClick,this),b8e.Tween.kill(this)},onClick:function(){},onResize:function(){this._bgGraph&&(this._bgGraph.clear(),this._bgGraph.fillColor(4278190080),this._bgGraph.fillRect(0,0,b8e.stageWidth,b8e.stageHeight),this._bgGraph.setSize(b8e.stageWidth,b8e.stageHeight)),this.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight)}}),game.CSArenaVsPage._instance=null,game.CSArenaVsPage._singleton=!0,game.CSArenaVsPage.inst=function(){return null==game.CSArenaVsPage._instance&&(game.CSArenaVsPage._singleton=!1,game.CSArenaVsPage._instance=new game.CSArenaVsPage,game.CSArenaVsPage._singleton=!0),game.CSArenaVsPage._instance}},{}],261:[function(e,t,i){"use strict";game.CSArenaVsRight=game.SkinUI.extends({_vsBg:null,_bianShenIcons:null,_bianshenInfos:null,_levelIcon:null,_levelName:null,_head:null,ctor:function(){this._super("csArena/CSArenaRightSkin","CSArenaVsSkin")},onShow:function(){this.initPanel();var e=game.arena.arenaRightPlayerInfo;if(e){var t=game.ccfg.HeadCfg.getbigIcon(e.head);if(""!=e.head){var i=game.ClientCfg.getHeadUrl(t);this._head.loadTexture(i,null,null,{useManifest:!1})}else this._head.unloadTexture();this._skin.roleName.string=e.name;var n=game.ccfg.CSArenaLevelCfg.getLevelByStart(e.arenaLv);this._levelName.loadTexture(game.ClientCfg.getCSArenaLvName(n),null,null,{useManifest:!1}),this._levelIcon.loadTexture(game.ClientCfg.getCSArenaLvIcon(n),null,null,{useManifest:!1}),this._skin.prower.string=e.power;var s=e.getIdList();if(s)for(var a,o=0;o<3;o++){var r=this._bianshenInfos[o],h=this._bianShenIcons[o];if(a=s[o]){var g=e.getBianshenById(a);if(!g)continue;r.id=a,r.level=g.lv,r.jie=g.jie,r.name=game.ccfg.BianshenCfg.getNameById(a),r.iconName=game.ccfg.BianshenCfg.getIconById(a),r.quality=game.ccfg.BianshenCfg.getQualityById(a),r.star=game.ccfg.BianshenCfg.getStarById(a),r.wuxing=game.ccfg.BianshenCfg.getGenreById(a),r.restraintRate=game.ccfg.BianshenCfg.getRestraintRate(a),r.qualityEffect=game.ccfg.BianshenCfg.getQuilatyEffectById(a),h.setVisible(!0),h.setData(r,!1,!1)}else h.setVisible(!1)}}},initPanel:function(){if(this._vsBg||(this._vsBg=b8e.Sprite.get(),this._vsBg.setAnchor(.5,.5),this._vsBg.addToParent(this._skin.vsBg),this._vsBg.loadTexture(game.ClientCfg.getCSVsUrl("VS_right"),null,null,{useManifest:!1})),this._head||(this._head=b8e.Sprite.get(),this._head.setAnchor(.5,.5),this._head.addToParent(this._skin.head)),this._levelIcon||(this._levelIcon=b8e.Sprite.get(),this._levelIcon.setAnchor(.5,.5),this._levelIcon.setScale(.6,.6),this._levelIcon.addToParent(this._skin.levelIcon)),this._levelName||(this._levelName=b8e.Sprite.get(),this._levelName.setAnchor(.5,.5),this._levelName.addToParent(this._skin.levelName)),!this._bianShenIcons&&!this._bianshenInfos){this._bianShenIcons=[],this._bianshenInfos=[];for(var e=0;e<3;e++){var t=new game.BianShenPackGrid;t.addToParent(this._skin.icon),t.setPosition(-120*e,0),this._bianShenIcons.push(t),this._bianshenInfos.push(new game.BianshenInfo)}}}})},{}],262:[function(e,t,i){"use strict";game.CSArenaSender={},game.CSArenaSender.getInfo=function(){var e=game.pbmid.Arena.CrossServerArenaInfoRequest;b8e.sendN(e)},game.CSArenaSender.getRankInfo=function(){var e=game.pbmid.Arena.CrossServerArenaRankRequest;b8e.sendN(e)},game.CSArenaSender.getLogs=function(){var e=game.pbmid.Arena.CrossServerArenaLogRequest;b8e.sendN(e)},game.CSArenaSender.getQuestPrize=function(e){var t=game.pbmsg.CrossServerArenaQuestAwardRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Arena.CrossServerArenaQuestAwardRequest;b8e.sendN(i)},game.CSArenaSender.getLevelPrize=function(e){var t=game.pbmsg.CrossServerArenaLvAwardRequest;t.lv=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Arena.CrossServerArenaLvAwardRequest;b8e.sendN(i)},game.CSArenaSender.buyTimes=function(){var e=game.pbmid.Arena.CrossServerArenaBuyTimesRequest;b8e.sendN(e)},game.CSArenaSender.match=function(){var e=game.pbmid.Arena.CrossServerArenaMatchRequest;b8e.sendN(e)}},{}],263:[function(e,t,i){},{}],264:[function(e,t,i){"use strict";game.DemoList=game.SkinUI.extends({_data:null,ctor:function(){this._super("demo/DemoList","DemoListSkin")},onShow:function(){this.setData(this._data)},getHeight:function(){return 40},getWidth:function(){return 540},setData:function(e){this._data=e,this._skin&&(this._skin.label.string=e)}})},{}],265:[function(e,t,i){"use strict";game.appModule.DemoPanel=game.SkinUIPanel.extends({_demoIndex:0,list:null,listData:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.scrollView,game.DemoList)),b8e.evt.onC(this._skin.addOne,this.onAddOne,this),b8e.evt.onC(this._skin.removeOne,this.onRmoveOne,this),b8e.evt.onC(this._skin.reset,this.onReset,this),this.onReset(),this._list.show()},onHide:function(){b8e.evt.offC(this._skin.addOne,this.onAddOne,this),b8e.evt.offC(this._skin.removeOne,this.onRmoveOne,this),b8e.evt.offC(this._skin.reset,this.onReset,this),this._list&&this._list.hide()},onAddOne:function(){this._demoIndex++;var e=Math.floor(this._demoIndex*Math.random());this.listData.splice(e,0,"测试list,"+this._demoIndex),b8e.log("添加新的数据",e),this._list.updateIndex(e)},onRmoveOne:function(){this._demoIndex--;var e=Math.floor(this._demoIndex*Math.random());this.listData.splice(e,1),b8e.log("移除数据",e),this._list.removeIndex(e)},onReset:function(){this.listData=[];for(var e=this._demoIndex=0;e<5;e++)this.listData.push("测试list,"+this._demoIndex),this._demoIndex++;this._list.setData(this.listData)}})},{}],266:[function(e,t,i){"use strict";game.appModule.DialogPanel=game.SkinUIPanel.extends({_currDiaCfg:null,_posterSp:null,_dialogTween:null,ctor:function(e){this._super(e),this.modalHideScene=!1},init:function(){this._super(),this._posterSp=b8e.Sprite.get(),this._skin.labPage.node.active=!1},onShow:function(){this._skin.arrowBottom.y=20,b8e.Tween.kill(this._skin.arrowBottom),b8e.Tween.get(this._skin.arrowBottom,{loop:!0}).to({y:30},600).to({y:20},600)},onRefresh:function(){var e=this.data.diaCfg;this.data.npcCfg;this.setDialogContent(e)},setDialogContent:function(e){this._dialogTween&&(this._dialogTween.kill(),this._dialogTween=null),this._posterSp.clear(),this._currDiaCfg=e,this._skin.labContent.string=e.content;for(var t=0,i=0,n=!1,s=this.data.diaCfg;s;)t++,n||i++,s.id==e.id&&(n=!0),s=s.nextDialogId?game.ccfg.DialogCfg.getDialogById(s.nextDialogId):null;this._skin.labPage.string=i+"/"+t;var a=null,o=null;if(!e.name){var r=game.mainRole.mainRoleData;a=r.name;var h=e.poster.split("|");o=r.sex==game.Sex.WOMAN?h[1]:h[0]}else a=e.name,o=e.poster;1==e.showType?(this._skin.labNameLeft.string="",this._skin.labNameRight.string=a,this._posterSp.setFlippedX(!0),this._posterSp.addToParent(this._skin.posterRight)):(this._skin.labNameLeft.string=a,this._skin.labNameRight.string="",this._posterSp.setFlippedX(!1),this._posterSp.addToParent(this._skin.posterLeft)),o?this._posterSp.loadTexture(game.ClientCfg.getPosterUrl(o),null,null,{useManifest:!1}):this._posterSp.clear(),0<e.duration&&(this._dialogTween=b8e.Tween.get(this).wait(e.duration).call(this.gotoNextDialog,this))},onHide:function(){b8e.Tween.kill(this._skin.arrowBottom),this._dialogTween&&(this._dialogTween.kill(),this._dialogTween=null),this._posterSp.clear()},gotoNextDialog:function(){var e=null;if(this._currDiaCfg.nextDialogId&&(e=game.ccfg.DialogCfg.getDialogById(this._currDiaCfg.nextDialogId)),e)this.setDialogContent(e);else{e=this.data.diaCfg;var t=this.data.npcCfg;game.DialogMgr.inst().completeDialog(e,t)}},onModalBgNodeNoHide:function(){this.gotoNextDialog()}})},{}],267:[function(e,t,i){"use strict";e("./DialogPanel")},{"./DialogPanel":266}],268:[function(e,t,i){"use strict";game.DrawCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Raffle.QryRaffleDecksResponse,this.onQryRaffleDecksResponse,this),b8e.addNH(game.pbmid.Raffle.RaffleResponse,this.onRaffleResponse,this),b8e.addNH(game.pbmid.Raffle.NewDecksNotify,this.onNewDecksNotify,this)},onQryRaffleDecksResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryRaffleDecksResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.draw.synDrawInfo(t.decks)},onRaffleResponse:function(e){var t=e.readProtobuf(game.pbmsg.RaffleResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.draw.dealRaffleInfo(t.deckId,t.bianshens,t.pbItem.list,t.freeTimesResetTs)},onNewDecksNotify:function(e){var t=e.readProtobuf(game.pbmsg.NewDecksNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.draw.onNewDecksNotify(t.decks)}})},{}],269:[function(e,t,i){"use strict";e("./DrawCmd")},{"./DrawCmd":268}],270:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_80"),e("./event/eventIndex_80"),e("./manager/managerIndex_80"),e("./panel/panelIndex_80"),e("./sender/senderIndex_80")},{"./cmdlistener/cmdlistenerIndex_80":269,"./event/eventIndex_80":274,"./manager/managerIndex_80":276,"./panel/panelIndex_80":286,"./sender/senderIndex_80":288}],271:[function(e,t,i){"use strict";game.DrawType=b8e.Enum({MINGJIANG_TYPE:1,SHENJIANG_TYPE:2,XIANSHI_SHENJIANG_TYPE:3})},{}],272:[function(e,t,i){"use strict";e("./DrawType")},{"./DrawType":271}],273:[function(e,t,i){"use strict";game.DrawEvents=b8e.Enum({DRAW_UPDATE:b8e.Event.nextCode(),DRAW_REQUEST:b8e.Event.nextCode(),DRAW_QUINTIC_AGAIN_SUCCESS:b8e.Event.nextCode(),DRAW_ONCE_AGAIN_SUCCESS:b8e.Event.nextCode(),HIGH_STAR_CLOSE:b8e.Event.nextCode()})},{}],274:[function(e,t,i){"use strict";e("./DrawEvents")},{"./DrawEvents":273}],275:[function(e,t,i){"use strict";game.DrawMgr=b8e.Object.extends({name:"DrawMgr",_deckArr:null,_curUnFoldIndex:-1,_bianshenArr:null,_isBool:!1,_curDrawInfo:null,_deckMap:null,leftTimesForSureDrop:-1,_deckInfo:null,cardsArr:null,_timer:null,remainTime:0,isArchive:!1,ctor:function(){if(1==game.DrawMgr._singleton)throw new Error("DrawMgr 只能通过单例方法获取");this._deckArr=[],this._bianshenArr=[],this.cardsArr=[],this._deckMap=b8e.HashMap.get()},synDrawInfo:function(e){var t,i;if(e&&0<e.length)for(var n=0;n<e.length;n++)t=e[n],(i=new game.DrawDeckInfo).setup(t),this._deckMap.set(i.id,i);this.leftTimesForSureDrop=e.leftTimesForSureDrop,this.checkFreeTimesReset(),b8e.evt.dptG(game.DrawEvents.DRAW_UPDATE)},checkFreeTimesReset:function(){var e=this._deckMap.values();if(e&&0<e.length)for(var t=0;t<e.length;t++)this._deckInfo=e[t],this._deckInfo.id==game.DrawType.SHENJIANG_TYPE&&0<this._deckInfo.freeTimesResetTs&&(this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3)))},updateTime:function(){var e=game.SysTime.curTime;this.remainTime=this._deckInfo.freeTimesResetTs-e,this.remainTime<=0&&(this._timer&&this._timer.stop(),this.resetFreeTimes(this._deckInfo.id),b8e.evt.dptG(game.DrawEvents.DRAW_UPDATE))},resetFreeTimes:function(e){var t=this._deckMap.get(e);t&&(t.leftFreeTimes=1,t.leftDiscountTimes=1,t.freeTimesResetTs=0,this._deckMap.set(t.id,t))},dealRaffleInfo:function(e,t,i,n){var s;if(this._bianshenArr.length=0,t&&0<t.length)for(var a=0;a<t.length;a++)(s=new game.DrawInfo).type=0,s.data=game.ItemInfoUtil.createBianshenInfo(t[a]),this._bianshenArr.push(s);if(i&&0<i.length)for(a=0;a<i.length;a++)(s=new game.DrawInfo).type=1,s.data=game.ItemInfoUtil.createItemInfo(i[a]),s.data.baseType=game.GoodsType.ITEM_INFO,this._bianshenArr.push(s);if(this.bianshenCount=game.bianshen.getBianshenBackCount(),1==this._bianshenArr.length){var o=this._deckMap.get(e);o&&(1<o.leftTimesForSureDrop?o.leftTimesForSureDrop--:1==o.leftTimesForSureDrop&&(o.leftTimesForSureDrop=5),o.leftFreeTimes<=0&&0<o.leftDiscountTimes&&!game.draw.isHasToken()&&o.leftDiscountTimes--,0<o.leftFreeTimes&&o.leftFreeTimes--,0<o.totalLeftTimes&&o.totalLeftTimes--,0<=n&&(o.freeTimesResetTs=n)),this._deckMap.set(e,o),this.checkFreeTimesReset(),this.isBool=!1,game.app.isShow(game.AppConstant.DRAW_ONCE_PANEL)?b8e.evt.dptG(game.DrawEvents.DRAW_ONCE_AGAIN_SUCCESS):game.app.show(game.AppConstant.DRAW_ONCE_PANEL)}else this.isBool=!0,game.app.isShow(game.AppConstant.DRAW_QUINTIC_PANEL)?b8e.evt.dptG(game.DrawEvents.DRAW_QUINTIC_AGAIN_SUCCESS):game.app.show(game.AppConstant.DRAW_QUINTIC_PANEL);b8e.evt.dptG(game.DrawEvents.DRAW_UPDATE)},getPreviewBianshenCards:function(e){this.cardsArr.length=0;for(var t,i,n=game.ccfg.DrawDecksCfg.getBianshenCards(e),s=0;s<n.length;s++)i=n[s],t=new game.DrawInfo,1==i.type?(t.type=1,t.data=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId)):6==i.type&&(t.type=0,t.data=game.ccfg.BianshenCfg.getBianshenCfgById(i.itemId)),this.cardsArr.push(t);return this.cardsArr},onNewDecksNotify:function(e){if(e&&0<e.length)for(var t,i,n=0;n<e.length;n++)t=e[n],(i=new game.DrawDeckInfo).setup(t),this._deckMap.set(i.id,i)},getAllDeck:function(){return this._deckMap.values()},getDeckInfoById:function(e){if(e)return game.ccfg.DrawDecksCfg.getDataByKey(e)},getDrawDeckInfoById:function(e){if(this._deckMap&&0<this._deckMap.count())return this._deckMap.get(e)},getAllbianshenArr:function(){return this._bianshenArr},isHasToken:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.DRAW_COST_ITEM_ID);return game.back.isHasItemInfoById(e)},isBool:{set:function(e){this._isBool=e},get:function(){return this._isBool}},curUnFoldIndex:{set:function(e){this._curUnFoldIndex=e},get:function(){return this._curUnFoldIndex}},curDrawInfo:{set:function(e){this._curDrawInfo=e},get:function(){return this._curDrawInfo}},isHasFreeDrawTimes:function(){var e=this._deckMap.values();if(e&&0<e.length){for(var t=0;t<e.length;t++){if(0<e[t].leftFreeTimes)return!0}if(this.isHasToken())return!0}return!1},checkCost:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.back.getAmountInfo();if(i){var n=i.getValue(game.AmountType.SILVER),s=i.getValue(game.AmountType.YUAN_BAO),a=this.getDrawDeckInfoById(e),o=this.getDeckInfoById(e);switch(o.id){case game.DrawType.MINGJIANG_TYPE:if(n<o.onceCostItemNumber)return void game.notice.show("您的银币不够");this.curDrawInfo=a,game.DrawSender.reqDrawItem(a.id,t);break;case game.DrawType.SHENJIANG_TYPE:var r;if(t)r=o.batchCostItemNumber;else{if(0<a.leftFreeTimes||game.draw.isHasToken())return this.curDrawInfo=a,void game.DrawSender.reqDrawItem(a.id,t);r=0<a.leftDiscountTimes?.5*o.onceCostItemNumber:o.onceCostItemNumber}if(s<r)return void game.gameAlert.showVipAlert(!0,101);this.curDrawInfo=a,game.DrawSender.reqDrawItem(a.id,t)}}}}),game.DrawMgr._instance=null,game.DrawMgr._singleton=!0,game.DrawMgr.inst=function(){return game.DrawMgr._instance||(game.DrawMgr._singleton=!1,game.DrawMgr._instance=new game.DrawMgr,game.DrawMgr._singleton=!0),game.DrawMgr._instance}},{}],276:[function(e,t,i){"use strict";e("./DrawMgr")},{"./DrawMgr":275}],277:[function(e,t,i){"use strict";game.BianshenPreviewGrid=game.SkinUI.extends({_showInfo:null,_itemGrid:null,_containerId:0,ctor:function(){this._super()},onShow:function(){this.setData(this._showInfo)},onHide:function(){this._itemGrid&&(this._itemGrid.setGridEmpty(),this._itemGrid.removeFromParent())},getWidth:function(){return 120},getHeight:function(){return 140},setContanerId:function(e){this._containerId=e},setData:function(e){this._showInfo=e,this._showInfo&&this.isShow()&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._itemGrid.gridInfo=new game.GridInfo,this._itemGrid.fnOnClick(this,this.onClick)),this.addChild(this._itemGrid),0==e.type?(this._itemGrid.gridInfo.containerId=game.ContainerId.BIANSHEN_ARCHIVE_GRID_CONTAINER_ID,game.GridUtil.setBianshenGrid(this._itemGrid,this._showInfo.data,!0)):(this._itemGrid.gridInfo.containerId=game.ContainerId.REWRADS_CONTAINER_ID,this._itemGrid.faceInfo=this._showInfo.data,game.GridUtil.setItemGrid(this._itemGrid,this._showInfo.data,!0)),this._itemGrid.sortLayer())},getItemGrid:function(){return this._itemGrid?this._itemGrid:null},onClick:function(e){0==this._showInfo.type?game.bianshen.showBianshenDetail(this._showInfo.data):1==this._showInfo.type&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId})}})},{}],278:[function(e,t,i){"use strict";game.appModule.BianshenPreviewPanel=game.SkinUIPanel.extends({_data:null,list:null,ctor:function(e){this._super(e),this._data=[]},onShow:function(){this._data=this.data,this._list||(this._list=new b8e.List(this._skin.list,game.BianshenPreviewGrid,4)),this._list.show(),this.onShowBianshenItem(this._data)},onHide:function(){this._list&&this._list.hide()},onShowBianshenItem:function(e){this._bianshenList=e,this._bianshenList&&0<this._bianshenList.length&&this._bianshenList.sort(this.onSortBianshen),this._list.setData(this._bianshenList)},onSortBianshen:function(e,t){return 0==e.type&&0==t.type?1==e.data.battle?-1:1==t.data.battle?1:e.data.star>t.data.star?-1:e.data.star<t.data.star?1:e.data.level>t.data.level?-1:e.data.level<t.data.level?1:e.data.id>t.data.id?1:e.data.id<t.data.id?-1:0:0==e.type?-1:0==t.type?1:e.data.quality>t.data.quality?-1:e.data.quality<t.data.quality?1:0}})},{}],279:[function(e,t,n){"use strict";game.appModule.CardPreviewPanel=game.SkinUIPanel.extends({_bianshenInfo:null,_firstSkillSprite:null,_secondSkillSprite:null,_nameSprite:null,_bianshenModel:null,_graphicsImg:null,_curSkillList:null,_skillList:null,_bg:null,_list:null,ctor:function(e){this._super(e),this._curSkillList=[],this._skillList=[]},getButtonByName:function(e){switch(e){case"back":return!this._skin||this._skin.closeBtnReturn}return null},onShow:function(){this.clearData(),this._bianshenInfo=this.data.bianshenInfo,this.setBianshenData(),this.showModel(),this._list.show(),this.updateList(),b8e.evt.onC(this._skin.btn_fetter,this.onClickFetter,this),b8e.evt.addG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUnlockFetter)},onHide:function(){this._list&&this._list.hide(),this.clearData(),this.clearSkillIcon();var e=this._bianshenModel.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),this._graphicsImg&&this._graphicsImg.clear(),b8e.evt.offC(this._skin.btn_fetter,this.onClickFetter,this),b8e.evt.rmvG(this,game.BianshenEvent.UNLOCK_BIANSHEN_FETTER,this.onUnlockFetter)},onClickFetter:function(){if(game.funcOpen.checkOpen(game.FunctionType.FETTER))game.app.show(game.AppConstant.BIANSHEN_FETTER_PANEL,this._bianshenInfo);else{var e=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.FETTER);game.notice.show(game.ccfg.LangCfg.getText(27011,[e.minLevel]))}},init:function(){this._bianshenModel=b8e.SceneEntity.get(),this._bianshenModel.addToParent(this._skin.model_node),this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.node_bg);var e=game.ClientCfg.getImgUrl("bianshen/bianshenDetalilsBg",!0);this._bg.loadTexture(e,null,null,{useManifest:!1}),this._bg.setSize(550,383),this._bg.setAnchor(.5,.5);var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.BIANSHEN_LEIDA).split("|");t&&4<t.length&&(this._skin.lab_leida_1.string=t[0],this._skin.lab_leida_2.string=t[1],this._skin.lab_leida_3.string=t[2],this._skin.lab_leida_4.string=t[3],this._skin.lab_leida_5.string=t[4]),this._list=new b8e.List(this._skin.list,game.BianshenTrigger)},clearData:function(){this.clearStar(),this._skin.lab_skill1.string="",this._skin.lab_skill2.string=""},updateList:function(){var e;this._bianshenInfo.goto&&""!=this._bianshenInfo.goto?(e=this._bianshenInfo.goto.split(","),this._skin.lab_desc.string="获取方式"):this._skin.lab_desc.string="",this._list.setData(e)},setBianshenData:function(){this._bianshenInfo&&(this.setWuxing(this._bianshenInfo.wuxing),this.setStarLv(this._bianshenInfo.star,this._bianshenInfo.jie),this.setBianshenName(),this.setSkillDesc(),this.setAttr(),this.setLeidatu(),this.setCombat(),this.setFetterAlert())},onUnlockFetter:function(){this.setFetterAlert()},setFetterAlert:function(){var e=game.ccfg.BianshenCfg.getFetterById(this._bianshenInfo.id);e&&0<e.length?(this._skin.btn_fetter.active=!0,this._skin.fetter_alert.active=game.bianshen.checkFetterHasActiveOrLvUp(this._bianshenInfo.id)):(this._skin.btn_fetter.active=!1,this._skin.fetter_alert.active=!1)},setBianshenName:function(){this._bianshenInfo&&(this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._bianshenInfo.quality),this._bianshenInfo.name))},showModel:function(){var e;if(this._bianshenInfo){var t=game.ccfg.BianshenCfg.getUiPosterById(this._bianshenInfo.id);e=game.ClientCfg.getUiUnits(t);var i=this._bianshenModel.getAnimator(game.AnimatorType.BODY,1);e?(i||(i=this._bianshenModel.addAnimator(game.AnimatorType.BODY,1,-10)),i.load(e),i.play()):i&&i.clear()}},setStarLv:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.star_node)),this._starBar.setStarGradeData(e,t,game.StarType.BIANSHEN_DETAILS_STAR),this._starBar.x=~~(this._skin.star_node.width-this._starBar.starWidth)/2,this._starBar.y=0},clearStar:function(){this._starBar&&this._starBar.clearData()},setWuxing:function(e){var t="icon_wx_jin",i="icon_wx_mu";switch(e){case game.BianshenWuxingType.JIN:t="icon_wx_jin",i="icon_wx_mu";break;case game.BianshenWuxingType.MU:t="icon_wx_mu",i="icon_wx_tu";break;case game.BianshenWuxingType.SHUI:t="icon_wx_shui",i="icon_wx_huo";break;case game.BianshenWuxingType.TU:t="icon_wx_tu",i="icon_wx_shui";break;case game.BianshenWuxingType.HUO:t="icon_wx_huo",i="icon_wx_jin"}game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,t),game.resController.setImgSpriteFrame(this._skin.img_mine_wuxing,game.ClientCfg.Bianshen_ALAST_URL,t),game.resController.setImgSpriteFrame(this._skin.img_restraint_wuxing,game.ClientCfg.Bianshen_ALAST_URL,i),this._bianshenInfo&&(this._skin.lab_restraint.string=game.ccfg.LangCfg.getText(10301,[this._bianshenInfo.restraintRate]))},setAttr:function(){var e=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(this._bianshenInfo.level);this._skin.lab_level.string="等级："+this._bianshenInfo.level;var t=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=e.attrCoef;n*=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie);for(var s="",a=i.getSpriteStats(),o=0;o<a.length;o++){var r=a[o];r&&(s+=this.getAttrStr(r,o,n))}this._skin.lab_attr.string=s},setCombat:function(){if(this._bianshenInfo){var e=this.getBianshenCombatByIdx();this._skin.lab_combat.string=e}},getBianshenCombatByIdx:function(){var e=0;if(this._bianshenInfo){var t=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=game.mainRole.mainRoleData.getLv(),s=game.ccfg.BianshenUpgradeLvCfg.getBianshenAttrCoefByLv(1),a=game.CCommonUtil.getPower(i,n);e=(a*=s)+game.ccfg.BianshenCfg.getAttrBonusCoefById(this._bianshenInfo.id)*game.ccfg.LvPowerCoefCfg.getLvCoefByLv(n)}return~~e},getAttrStr:function(e,t,i){var n=e.value*i;return game.ccfg.AttrRulesCfg.getAttrNameByType(e.type)+" "+Math.round(n)+"<br/>"},setLeidatu:function(){var e=.49*game.ccfg.BianshenCfg.getDtById(this._bianshenInfo.id),t=.49*game.ccfg.BianshenCfg.getQzById(this._bianshenInfo.id),i=.49*game.ccfg.BianshenCfg.getKzById(this._bianshenInfo.id),n=.49*game.ccfg.BianshenCfg.getFzById(this._bianshenInfo.id),s=.49*game.ccfg.BianshenCfg.getScById(this._bianshenInfo.id),a=[];a[0]=cc.v2(-e*Math.cos(Math.PI/180*18),e*Math.sin(Math.PI/180*18)),a[1]=cc.v2(t*Math.cos(Math.PI/180*90),t*Math.sin(Math.PI/180*90)),a[2]=cc.v2(i*Math.cos(Math.PI/180*18),i*Math.sin(Math.PI/180*18)),a[3]=cc.v2(n*Math.cos(Math.PI/180*54),-n*Math.sin(Math.PI/180*54)),a[4]=cc.v2(-s*Math.cos(Math.PI/180*54),-s*Math.sin(Math.PI/180*54)),this._graphicsImg||(this._graphicsImg=b8e.Graphics.get(),this._graphicsImg.addToParent(this._skin.techang_node)),this._graphicsImg.strokeColor(2990660095),this._graphicsImg.fillColor(2990660095),this._graphicsImg.lineWidth(2),this._graphicsImg.moveTo(a[0].x,a[0].y),this._graphicsImg.lineTo(a[1].x,a[1].y),this._graphicsImg.lineTo(a[2].x,a[2].y),this._graphicsImg.lineTo(a[3].x,a[3].y),this._graphicsImg.lineTo(a[4].x,a[4].y),this._graphicsImg.lineTo(a[0].x,a[0].y),this._graphicsImg.fill()},setSkillDesc:function(){this.setFirstSkill(),this.setSecondSkill()},setFirstSkill:function(){var e,t=game.ccfg.HeroCfg.getSpellListById(this._bianshenInfo.id),i=game.ccfg.SpellCfg.getSpellById(t[1]);i&&(this._skillList.length<1?(e=new game.SkillIcon(1),this._skillList.push(e)):e=this._skillList[0],e.setData(i.id,!1),e.setAnchor(.5,.5),e.addToParent(this._skin.icon_skill1),e.show(),this._curSkillList.push(e),this._skin.lab_skill1.string=game.html.getText(game.html.getColorByQuality(i.quality),i.name),this._skin.lab_skill1_desc.string=i.desc)},setSecondSkill:function(){var e,t=game.ccfg.HeroCfg.getPublicSpellList(this._bianshenInfo.id),i=game.ccfg.SpellCfg.getSpellById(t[0]);i&&(this._skillList.length<2?(e=new game.SkillIcon(1),this._skillList.push(e)):e=this._skillList[1],e.setData(i.id,!1),e.setAnchor(.5,.5),e.addToParent(this._skin.icon_skill2),e.show(),this._curSkillList.push(e),this._skin.lab_skill2.string=game.html.getText(game.html.getColorByQuality(i.quality),i.name),this._skin.lab_skill2_desc.string=i.desc)},clearLeida:function(){this._graphicsImg&&this._graphicsImg.removeFromParent()},clearSkillIcon:function(){for(i=0;i<this._curSkillList.length;i++)this._curSkillList[i].hide();this._curSkillList.length=0}})},{}],280:[function(e,t,i){"use strict";game.DrawGrid=game.SkinUI.extends({_cardInfo:null,_itemGrid:null,_sceneLayer:null,ctor:function(){this._super()},setData:function(e){this._cardInfo=e,this._cardInfo?(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)),this.addChild(this._itemGrid),0==e.type?game.GridUtil.setBianshenGrid(this._itemGrid,this._cardInfo.data,!0):1==e.type&&(this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.REWRADS_CONTAINER_ID),game.GridUtil.setItemGrid(this._itemGrid,this._cardInfo.data,!0)),this._itemGrid.sortLayer()):this._itemGrid&&(this._itemGrid.setGridEmpty(),this._itemGrid.removeFromParent())},getGridNode:function(){return this._itemGrid},showAnimation:function(){if(this._cardInfo.star&&this._cardInfo.star<4){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this.getGridNode()));var e=game.ClientCfg.getUIFxs("10017");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.DRAW_NORMAL_EFFECT,1),this._sceneLayer.addChild(this._anim)),this._sceneLayer.setVisible(!0),this._anim.load(e),this._anim.play(null,0)):this._anim&&this._anim.clear()}},clearAnimator:function(){this._anim&&this._anim.clear(),this._sceneLayer&&this._sceneLayer.setVisible(!1)}})},{}],281:[function(e,t,i){"use strict";game.DrawItem=game.SkinUI.extends({_index:-1,isUnFold:!1,_deckInfo:null,_prizeInfo:null,_cardSprite:null,_timer:null,_onceCostSprite:null,ctor:function(e){this._super("draw/DrawItemSkin","DrawItemSkin"),this._deckInfo=e,this._prizeInfo=[]},init:function(){this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.node_icon),this._onceCostSprite.setSize(30,30)},getButtonByName:function(e){switch(e){case"once":return!this._skin||this._skin.btn_once}return null},onShow:function(){this.setData(this._deckInfo),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,1e3),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.btn_preview,this.onClickPreviewBtn,this),b8e.evt.onC(this._skin.btn_once,this.onClickOnceBtn,this),b8e.evt.onC(this._skin.btn_quintic,this.onClickQuinticBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.btn_preview,this.onClickPreviewBtn,this),b8e.evt.offC(this._skin.btn_once,this.onClickOnceBtn,this),b8e.evt.offC(this._skin.btn_quintic,this.onClickQuinticBtn,this),this._cardSprite&&this._cardSprite.unloadTexture(),this._timer&&this._timer.stop()},setData:function(e){if(this._deckInfo=e,this._skin&&this._deckInfo){this._cardSprite||(this._cardSprite=b8e.Sprite.get(),this._cardSprite.addToParent(this._skin.node_bg)),this._skin.lab_freetime.string="";var t=game.draw.getDeckInfoById(this._deckInfo.protoId),i=game.draw.getDrawDeckInfoById(this._deckInfo.id);switch(t.id){case game.DrawType.MINGJIANG_TYPE:this._cardSprite.loadTexture(game.ClientCfg.getImgUrl("draw/img_mingjiang",!0),null,null,{useManifest:!1}),this._skin.lab_lv.string="4星",this._skin.img_yuanbao1.active=!1,this._skin.img_yuanbao5.active=!1,this._skin.img_yinbi1.active=!0,this._skin.img_yinbi5.active=!0,this._skin.btn_yellowbg1.active=!1,this._skin.btn_yellowbg5.active=!1;break;case game.DrawType.SHENJIANG_TYPE:this._cardSprite.loadTexture(game.ClientCfg.getImgUrl("draw/img_shenjiang",!0),null,null,{useManifest:!1}),this._skin.lab_lv.string="4-5星",this._skin.img_yuanbao1.active=!0,this._skin.img_yuanbao5.active=!0,this._skin.img_yinbi1.active=!1,this._skin.img_yinbi5.active=!1,this._skin.btn_yellowbg1.active=!0,this._skin.btn_yellowbg5.active=!0}if(this._skin.lab_price5.string=t.batchCostItemNumber,-1!=this._deckInfo.expireTs?(this._skin.node_display.active=!0,this._skin.lab_time.string=b8e.TimeUtil.formatTime(this._deckInfo.expireTs)):this._skin.node_display.active=!1,this._skin.node_tag.active=!1,this._skin.lab_tokenCount.string="",1==this._deckInfo.leftFreeTimes)this._skin.node_one.active=!1,this._skin.lab_free1.string="此次免费";else if(1<this._deckInfo.leftFreeTimes)this._skin.node_one.active=!1,this._skin.lab_free1.string="免费"+this._deckInfo.leftFreeTimes+"次";else if(this._skin.node_one.active=!0,this._skin.lab_free1.string="",game.draw.isHasToken()&&t.id==game.DrawType.SHENJIANG_TYPE){this._skin.img_yuanbao1.active=!1,this._skin.lab_price1.string="";var n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.DRAW_COST_ITEM_ID),s=game.back.getItemInfoCountById(n);this._skin.lab_tokenCount.string=s+"/1";var a=game.ccfg.ItemInfoCfg.getIconNameById(n);if(a){var o=game.ClientCfg.getImgUrl(a);this._onceCostSprite.loadTexture(o,null,null,{useManifest:!1})}}else this._onceCostSprite&&this._onceCostSprite.unloadTexture(),0<this._deckInfo.leftDiscountTimes?(this._skin.lab_price1.string=.5*t.onceCostItemNumber,this._skin.node_tag.active=!0):this._skin.lab_price1.string=t.onceCostItemNumber;var r,h,g=i.leftTimesForSureDrop;0<g&&(1==g?h=game.ccfg.LangCfg.getText("此次购买必得$变身",[game.html.getText(game.html.Q_GREEN,"4星及以上")]):(r=[game.html.getText(game.html.Q_GREEN,"4星及以上")],h=game.ccfg.LangCfg.getText("再买$次必得"+r+"变身",[game.html.getText(game.html.Q_GREEN,g)])),this._skin.lab_hint.string=h),0==g&&(this._skin.lab_hint.string="")}},onClickWenHao:function(){game.active.openDescPanel(game.active.RAFFLE_DESC)},onClickPreviewBtn:function(){if(game.draw.isArchive=!1,this._deckInfo){var e=game.draw.getPreviewBianshenCards(this._deckInfo.protoId);game.app.show(game.AppConstant.BIANSHEN_PREVIEW_PANEL,e)}},onClickOnceBtn:function(){if(this._deckInfo)if(0<this._deckInfo.leftFreeTimes||game.draw.isHasToken())game.draw.curDrawInfo=this._deckInfo,game.DrawSender.reqDrawItem(this._deckInfo.id,!1);else{var e=game.back.getAmountInfo();if(e){var t,i=e.getValue(game.AmountType.SILVER),n=e.getValue(game.AmountType.YUAN_BAO),s=game.draw.getDeckInfoById(this._deckInfo.protoId);switch(t=0<this._deckInfo.leftDiscountTimes?.5*s.onceCostItemNumber:s.onceCostItemNumber,s.id){case game.DrawType.MINGJIANG_TYPE:if(i<t)return void game.notice.show("您的银币不够");game.draw.curDrawInfo=this._deckInfo,game.DrawSender.reqDrawItem(this._deckInfo.id,!1);break;case game.DrawType.SHENJIANG_TYPE:if(n<t)return void game.gameAlert.showVipAlert(!0,101);game.draw.curDrawInfo=this._deckInfo,game.DrawSender.reqDrawItem(this._deckInfo.id,!1)}}}},onClickQuinticBtn:function(){if(this._deckInfo,this._deckInfo){var e=game.back.getAmountInfo();if(e){var t=e.getValue(game.AmountType.SILVER),i=e.getValue(game.AmountType.YUAN_BAO),n=game.draw.getDeckInfoById(this._deckInfo.protoId);switch(n.id){case game.DrawType.MINGJIANG_TYPE:if(t<n.batchCostItemNumber)return void game.notice.show("您的银币不够");game.draw.curDrawInfo=this._deckInfo,game.DrawSender.reqDrawItem(this._deckInfo.id,!0);break;case game.DrawType.SHENJIANG_TYPE:if(i<n.batchCostItemNumber)return void game.gameAlert.showVipAlert(!0,101);game.draw.curDrawInfo=this._deckInfo,game.DrawSender.reqDrawItem(this._deckInfo.id,!0)}}}},getHeight:function(){return 310},getWidth:function(){return 520},updateTime:function(){0<this._deckInfo.freeTimesResetTs&&0<game.draw.remainTime?this._skin.lab_freetime.string=b8e.TimeUtil.formatTime(game.draw.remainTime)+"后免费":this._skin.lab_freetime.string=""}})},{}],282:[function(e,t,i){"use strict";game.appModule.DrawOncePanel=game.SkinUIPanel.extends({_red:null,_white:null,_bianshenList:null,_bianshenGrid:null,_isEnd:!1,_deckInfo:null,_timer:null,_onceCostSprite:null,ctor:function(e){this._super(e),this._red=b8e.ColorUtil.toCCColor(4294901760),this._white=b8e.ColorUtil.toCCColor(4294967295)},getButtonByName:function(e){switch(e){case"btnyes":return!this._skin||this._skin.btn_yes}return null},init:function(){this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.node_icon),this._onceCostSprite.setSize(30,30)},onShow:function(){this._bianshenList=game.draw.getAllbianshenArr(),this.createOneGrid(),this.setData(),this.setBianshenBagSpace(),b8e.evt.onC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.onC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.addG(this,game.DrawEvents.DRAW_UPDATE,this.setData),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.setData),b8e.evt.addG(this,game.DrawEvents.DRAW_UPDATE,this.setBianshenBagSpace),b8e.evt.addG(this,game.DrawEvents.DRAW_ONCE_AGAIN_SUCCESS,this.buyAgain)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.offC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.rmvG(this,game.DrawEvents.DRAW_UPDATE,this.setData),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.setData),b8e.evt.rmvG(this,game.DrawEvents.DRAW_UPDATE,this.setBianshenBagSpace),b8e.evt.rmvG(this,game.DrawEvents.DRAW_ONCE_AGAIN_SUCCESS,this.buyAgain)},onClickYes:function(){this.hide()},onClickAgain:function(){if(0!=this._isEnd){var e=game.draw.curDrawInfo;game.draw.checkCost(e.id)}},buyAgain:function(){this._bianshenList=game.draw.getAllbianshenArr(),this.createOneGrid()},createOneGrid:function(){var e=game.draw.getAllbianshenArr();if(e&&!(e.length<=0)){var t=e[0];t&&(this._bianshenGrid||(this._bianshenGrid=new game.DrawGrid,this._bianshenGrid.setSize(124,140),this._bianshenGrid.setScale(0,0),this._bianshenGrid.setAnchor(.5,.5),this._bianshenGrid.addToParent(this._skin.gridsNode)),this._bianshenGrid.setData(t),this._bianshenGrid.setVisible(!1),this._index=0,this.gridPlay())}},setData:function(){var e=game.draw.curDrawInfo,t=game.draw.getDeckInfoById(e.protoId);switch(this._deckInfo=t,e.protoId){case game.DrawType.MINGJIANG_TYPE:this.setImg(!1,!0,t),this._skin.lab_price1.string=t.onceCostItemNumber,this._skin.lab_hint.string="",this._skin.lab_freeTime.string="",this._skin.lab_tokenCount.string="",this._skin.node_icon.active=!1;break;case game.DrawType.SHENJIANG_TYPE:if(game.draw.isHasToken()){this._skin.lab_price1.string="",this._skin.node_tag.active=!1,this._skin.img_yuanbao1.active=!1,this._skin.img_yinbi1.active=!1,this._skin.node_icon.active=!0;var i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.DRAW_COST_ITEM_ID),n=game.back.getItemInfoCountById(i);this._skin.lab_tokenCount.string=n+"/1";var s=game.ccfg.ItemInfoCfg.getIconNameById(i);if(s){var a=game.ClientCfg.getImgUrl(s);this._onceCostSprite.loadTexture(a,null,null,{useManifest:!1})}}else this.setImg(!0,!1,t),this._skin.lab_tokenCount.string="",this._onceCostSprite&&this._onceCostSprite.unloadTexture(),0<e.leftDiscountTimes?(this._skin.lab_price1.string=.5*t.onceCostItemNumber,this._skin.node_tag.active=!0):(this._skin.lab_price1.string=t.onceCostItemNumber,this._skin.node_tag.active=!1);0<e.freeTimesResetTs?this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500):this._skin.lab_freeTime.string="";var o=e.leftTimesForSureDrop;this._skin.lab_hint.string="再买"+o+"次必得4星以上变身";break;case game.DrawType.XIANSHI_SHENJIANG_TYPE:this.setImg(!0,!1,t)}},updateTime:function(){0<game.draw.remainTime?this._skin.lab_freeTime.string=b8e.TimeUtil.formatTime(game.draw.remainTime)+"后免费":this._skin.lab_freeTime.string=""},setImg:function(e,t,i){this._skin.img_yuanbao1.active=e,this._skin.img_yinbi1.active=t},gridPlay:function(){this._index<1?(this._isEnd=!1,this._index,this._bianshenGrid.setVisible(!0),this._bianshenGrid.showAnimation(),b8e.Tween.kill(this._bianshenGrid),b8e.Tween.get(this._bianshenGrid).to({scaleX:1.5,scaleY:1.5},150).call(this.scaleAnimation,this).wait(1e3,!1)):this._isEnd=!0},scaleAnimation:function(){b8e.Tween.kill(this._bianshenGrid),b8e.Tween.get(this._bianshenGrid).to({scaleX:1,scaleY:1},150).call(this.highStarPanelPreview,this).wait(1e3,!1)},highStarPanelPreview:function(){b8e.Tween.kill(this._bianshenGrid);var e=game.ItemInfoUtil.createBianshenInfo(this._bianshenList[this._index]);e.cardIndex=this._index,this._index++,e&&(this._isEnd=!0,this._bianshenGrid.clearAnimator(),3<e.star&&game.app.show(game.AppConstant.HIGH_STAR_PANEL,e))},setBianshenBagSpace:function(){var e=game.draw.bianshenCount;this._skin.lab_spaceCount.string=e+1+"/"+game.bianshen.bianshenMaxCount,this.setBianshenBagSpaceColor(e)},setBianshenBagSpaceColor:function(e){e>=game.bianshen.bianshenMaxCount?this._skin.lab_spaceCount.node.color=this._red:this._skin.lab_spaceCount.node.color=this._white}})},{}],283:[function(e,t,i){"use strict";game.appModule.DrawPanel=game.SkinUIPanel.extends({_itemAllArr:null,_curVisibleArr:null,_list:null,ctor:function(e){this._super(e),this._itemAllArr=[],this._curVisibleArr=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.DrawList,game.DrawItem)),this._list.show(),this.onClickDraw(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickDraw,this),b8e.evt.addG(this,game.DrawEvents.DRAW_UPDATE,this.onUpdateDrawList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickDraw,this),b8e.evt.rmvG(this,game.DrawEvents.DRAW_UPDATE,this.onUpdateDrawList)},onClickDraw:function(){this.onUpdateDrawList()},onUpdateDrawList:function(){var e=game.draw.getAllDecks();e&&0<e.length&&this._list.setData(e)}})},{}],284:[function(e,t,i){"use strict";game.appModule.DrawQuinticPanel=game.SkinUIPanel.extends({_gridArr:null,_bianshenGridArr:null,_index:0,_gridPosArr:null,_bianshenList:null,_bianshenBagList:null,_red:null,_white:null,_isEnd:!1,_gridStoreArr:null,ctor:function(e){this._super(e),this._gridArr=[],this._bianshenGridArr=[],this._bianshenBagList=[],this._gridStoreArr=[],this._gridPosArr=[[-160,90],[0,90],[160,90],[-100,-60],[60,-60]],this._red=b8e.ColorUtil.toCCColor(4294901760),this._white=b8e.ColorUtil.toCCColor(4294967295)},onShow:function(){this._bianshenList=game.draw.getAllbianshenArr(),this.createFiveGrids(),this.setData(),this.setBianshenBagSpace(),b8e.evt.onC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.onC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.addG(this,game.DrawEvents.HIGH_STAR_CLOSE,this.gridPlay),b8e.evt.addG(this,game.DrawEvents.DRAW_UPDATE,this.setBianshenBagSpace),b8e.evt.addG(this,game.DrawEvents.DRAW_QUINTIC_AGAIN_SUCCESS,this.buyAgain)},onHide:function(){this.clearGrid(),b8e.evt.offC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.offC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.rmvG(this,game.DrawEvents.HIGH_STAR_CLOSE,this.gridPlay),b8e.evt.rmvG(this,game.DrawEvents.DRAW_UPDATE,this.setBianshenBagSpace),b8e.evt.rmvG(this,game.DrawEvents.DRAW_QUINTIC_AGAIN_SUCCESS,this.buyAgain)},setData:function(){var e=game.draw.curDrawInfo,t=game.draw.getDeckInfoById(e.protoId);switch(1==e.protoId?this._skin.lab_explain.string="":this._skin.lab_explain.string="必得4星变身",e.protoId){case game.DrawType.MINGJIANG_TYPE:this.setImg(!1,!0,t);break;case game.DrawType.SHENJIANG_TYPE:case game.DrawType.XIANSHI_SHENJIANG_TYPE:this.setImg(!0,!1,t)}},setImg:function(e,t,i){this._skin.img_yuanbao5.active=e,this._skin.img_yinbi5.active=t,this._skin.lab_price5.string=i.batchCostItemNumber.toString()},onClickYes:function(){this._isEnd&&this.hide()},onClickAgain:function(){if(this._isEnd){var e=game.draw.curDrawInfo;game.draw.checkCost(e.id,!0)}},buyAgain:function(){this._gridArr.length=0,this.clearGrid(),this._bianshenList=game.draw.getAllbianshenArr(),!this._bianshenList||this._bianshenList.length<=0||this.createFiveGrids()},setBianshenBagSpace:function(){var e=game.draw.bianshenCount;this._skin.lab_spaceCount.string=e+5+"/"+game.bianshen.bianshenMaxCount,this.setBianshenBagSpaceColor(e)},setBianshenBagSpaceColor:function(e){e>=game.bianshen.bianshenMaxCount?this._skin.lab_spaceCount.node.color=this._red:this._skin.lab_spaceCount.node.color=this._white},createFiveGrids:function(){for(var e,t=this._bianshenGridArr.length,i=0;i<this._bianshenList.length;i++){var n=this._bianshenList[i];n&&(i<t?e=this._bianshenGridArr[i]:((e=new game.DrawGrid(n)).setSize(124,140),e.setScale(0,0),e.setAnchor(.5,.5),e.addToParent(this._skin.gridsNode),this._bianshenGridArr.push(e)),e.setData(n))}this._index=0,this.highStarPanelPreview()},highStarPanelPreview:function(){if(this._index<5)if(this._isEnd=!1,this._bianshenList[this._index]&&0==this._bianshenList[this._index].type){var e=this._bianshenList[this._index].data;e.cardIndex=this._index,e&&(3<e.star?game.app.show(game.AppConstant.HIGH_STAR_PANEL,e):this.gridPlay())}else this.gridPlay();else this._isEnd=!0},gridPlay:function(){this._isEnd=!1;var e=this._bianshenGridArr[this._index];if(e){e.showAnimation();var t=this._gridPosArr[this._index][0];t=0|+t;var i=this._gridPosArr[this._index][1];i=0|+i,e.setVisible(!0),b8e.Tween.kill(e),b8e.Tween.get(e).to({x:t,y:i,scaleX:1.5,scaleY:1.5},150).call(this.scaleAnimation,this,[e])}else this._isEnd=!0},scaleAnimation:function(e){b8e.Tween.kill(e),b8e.Tween.get(e).to({scaleX:1,scaleY:1},150).call(this.highStarPanelPreview,this,[e]),this._index++},showAnimation:function(){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this.getGridNode()));var e=game.ClientCfg.getUIFxs("10017");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.DRAW_NORMAL_EFFECT,1),this._sceneLayer.addChild(this._anim)),this._sceneLayer.setVisible(!0),this._anim.load(e),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearAnimator:function(){this._anim&&this._anim.clear(),this._sceneLayer&&this._sceneLayer.setVisible(!1)},clearGrid:function(){if(this._bianshenGridArr&&!(this._bianshenGridArr.length<=0))for(var e=0;e<this._bianshenGridArr.length;e++){var t=this._bianshenGridArr[e];t&&t.setVisible(!1)}}})},{}],285:[function(e,t,i){"use strict";game.appModule.HighStarPanel=game.SkinUIPanel.extends({_bianshenModel:null,_sceneLayerDown:null,_starBar:null,_anim:null,_modalBg:null,_screenOriginPositionition:null,_graphicsModalBg:null,_blackColor:null,_whiteColor:null,_graphics:null,ctor:function(e){this._super(e),this.initColor()},initColor:function(){this._blackColor||(this._blackColor=b8e.ColorUtil.toCCColor(4278190080)),this._whiteColor||(this._whiteColor=b8e.ColorUtil.toCCColor(4294967295))},onShow:function(){this._bianshenInfo=this.data,this._bianshenInfo&&(this._sceneLayerDown||(this._sceneLayerDown=b8e.BaseDisplay.get(),this._sceneLayerDown.addToParent(this._skin.effect_down)),this.showModel(),this.setBianshenName(),this.setWuxing(this._bianshenInfo.wuxing),this.setStarLv(this._bianshenInfo.star),this.addModalBackground())},onHide:function(){this.clearAnimator(),b8e.evt.dptG(game.DrawEvents.HIGH_STAR_CLOSE)},addModalBackground:function(){this._graphicsModalBg||(this._graphicsModalBg=b8e.Graphics.get(),this._graphicsModalBg.addToParent(this._skin.maskNode)),this.setModalBgSize()},setModalBgSize:function(){this._graphicsModalBg.clear(),this._graphics=this._graphicsModalBg.getGraphics(),this._graphics.fillColor=this._blackColor,this._graphics.rect(0,0,this.width,this.height),this._graphics.fill()},setStarLv:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.node_star)),this._starBar.setStarGradeData(e,t,game.StarType.BIANSHEN_STAR),this._starBar.x=~~(this._skin.node_star.width-this._starBar.starWidth)/2,this._starBar.y=0},showModel:function(){var e;if(this._bianshenModel||(this._bianshenModel=b8e.SceneEntity.get(),this._bianshenModel.addToParent(this._skin.model_node)),this._bianshenInfo){var t=game.ccfg.BianshenCfg.getUiPosterById(this._bianshenInfo.id);e=game.ClientCfg.getUiUnits(t);var i=this._bianshenModel.getAnimator(game.AnimatorType.DRAW_BIANSHEN_BODY,1);e?(i||(i=this._bianshenModel.addAnimator(game.AnimatorType.DRAW_BIANSHEN_BODY,1,-10)),i.load(e),i.play()):i&&i.clear()}},setBianshenName:function(){this._bianshenInfo&&(this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._bianshenInfo.quality),this._bianshenInfo.name))},setWuxing:function(e){switch(e){case game.BianshenWuxingType.JIN:game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_jin");break;case game.BianshenWuxingType.MU:game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_mu");break;case game.BianshenWuxingType.SHUI:game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_shui");break;case game.BianshenWuxingType.TU:game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_tu");break;case game.BianshenWuxingType.HUO:game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,"icon_wx_huo")}},clearAnimator:function(){this._anim&&this._anim.clear(),this._sceneLayerDown&&this._sceneLayerDown.setVisible(!1)}})},{}],286:[function(e,t,i){"use strict";e("./BianshenPreviewPanel"),e("./CardPreviewPanel"),e("./DrawGrid"),e("./DrawItem"),e("./DrawPanel"),e("./DrawOncePanel"),e("./DrawQuinticPanel"),e("./HighStarPanel")},{"./BianshenPreviewPanel":278,"./CardPreviewPanel":279,"./DrawGrid":280,"./DrawItem":281,"./DrawOncePanel":282,"./DrawPanel":283,"./DrawQuinticPanel":284,"./HighStarPanel":285}],287:[function(e,t,i){"use strict";var n=game.DrawSender=function(){};n.reqDecksInfo=function(){var e=game.pbmid.Raffle.QryRaffleDecksRequest;b8e.sendN(e)},n.reqDrawItem=function(e,t){var i=game.pbmsg.RaffleRequest;i.deckId=e,i.isBatch=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Raffle.RaffleRequest;b8e.sendN(n)}},{}],288:[function(e,t,i){"use strict";e("./DrawSender")},{"./DrawSender":287}],289:[function(e,t,i){"use strict";game.DujieCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.DuJie.DuJieInfoResponse,this.onDuJieInfoResponse,this),b8e.addNH(game.pbmid.DuJie.EnterDuJieSceneResponse,this.onEnterDuJieSceneResponse,this),b8e.addNH(game.pbmid.DuJie.DuJieUpgradeResponse,this.onDuJieUpgradeResponse,this),b8e.addNH(game.pbmid.DuJie.SceneUnitDujieUpdateNotify,this.onSceneUnitDujieUpdateNotify,this),b8e.addNH(game.pbmid.DuJie.DuJieNotify,this.onDuJieNotify,this)},onDuJieInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.DuJieInfoResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.dujie.setDujieInfo(t)}else b8e.log("渡劫初始化失败！")},onEnterDuJieSceneResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterDuJieSceneResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.dujie.enterScene(t)}else b8e.log("渡劫进入场景失败！")},onDuJieUpgradeResponse:function(e){var t=e.readProtobuf(game.pbmsg.DuJieUpgradeResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.dujie.upgradeSUcceed(t)}else b8e.log("渡劫提升失败！")},onSceneUnitDujieUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.SceneUnitDujieUpdateNotify);t||b8e.log("通知渡劫阶级更变失败");var i=t.code;if(0<i)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i));else{var n=game.sceneRole.getDisplayById(t.sceneUnitId);n?(n.data.dujie=t.lv,game.AvatarUtil.updateDujieSp(n)):b8e.log("角色不存在")}},onDuJieNotify:function(e){var t=e.readProtobuf(game.pbmsg.DujieNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.dujie.setDujieData(t)}else b8e.log("通知数据为空")}})},{}],290:[function(e,t,i){"use strict";e("./cmd/DujieCmd"),e("./enum/DujieEnum"),e("./enum/DujieXianDanType"),e("./event/DujieEvent"),e("./manager/DujieMgr"),e("./panel/DujiePanel"),e("./panel/DujieTaskItem"),e("./panel/DujieSucceedPanel"),e("./sender/DujieSender")},{"./cmd/DujieCmd":289,"./enum/DujieEnum":291,"./enum/DujieXianDanType":292,"./event/DujieEvent":293,"./manager/DujieMgr":294,"./panel/DujiePanel":295,"./panel/DujieSucceedPanel":297,"./panel/DujieTaskItem":298,"./sender/DujieSender":299}],291:[function(e,t,i){"use strict";game.DujieEnum=b8e.Enum({NONE_TYPE:0,JUESHE_LV:1,ATK_LV:2,ZUOJI_LV:3,CHIBAN_LV:4,FABAO_LV:5,ZHUNGBEI_LV:6,ZHUNGBEIALL_LV:7,TONGGUNAG_FUBEN:8,ARENA_RANK:9,ENJOIN_GUILD:10,SHENGWANG:11,BEAUTY:12,DUJIEKILL_TASK:13,XIAN_ZHEN:14,POWER:15,BOOS_TASK:21})},{}],292:[function(e,t,i){"use strict";game.DujieXianDanType=b8e.Enum({PRIMARY:700001,MIDDLE:700002,ADVANCED:700003,AVME:700004})},{}],293:[function(e,t,i){"use strict";game.DujieEvent=b8e.Enum({UPDATE_DUJIE:b8e.Event.nextCode(),DUJIE_SUCCESS:b8e.Event.nextCode(),UPDATE_TASK_NUMB:b8e.Event.nextCode(),BOSSTASK_SUCCESS:b8e.Event.nextCode(),JUESHE_LV:b8e.Event.nextCode(),ATK_LV:b8e.Event.nextCode(),ZUOJI_LV:b8e.Event.nextCode(),CHIBAN_LV:b8e.Event.nextCode(),FABAO_LV:b8e.Event.nextCode(),ZHUNGBEI_LV:b8e.Event.nextCode(),ZHUNGBEIALL_LV:b8e.Event.nextCode(),TONGGUNAG_FUBEN:b8e.Event.nextCode(),ARENA_RANK:b8e.Event.nextCode(),ENJOIN_GUILD:b8e.Event.nextCode(),SHENGWANG:b8e.Event.nextCode(),BEAUTY:b8e.Event.nextCode(),DUJIEKILL_TASK:b8e.Event.nextCode(),DUJIEOPEN:b8e.Event.nextCode(),COMBAT_PLAY_COMPLETE:b8e.Event.nextCode()})},{}],294:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.DujieMgr=b8e.Object.extends((s(n={name:"DujieMgr",dujieInfo:null,numfinished:0,numalltask:3,isInit:!1,isCompleteTask:!1,ctor:function(){if(this._super(),1==this._singleton)throw new Error("DujieMgr 只能通过单例方法获取");b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onDujieOpenCallBack),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onDujieOpenCallBack),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onDujieOpenCallBack)},checkOpen:function(){game.funcOpen.checkOpen(game.FunctionType.JING_JIE)&&this.init()},onDujieOpenCallBack:function(){game.funcOpen.checkOpen(game.FunctionType.JING_JIE)&&(this.init(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onDujieOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onDujieOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_ROLE_LEVEL_UP,this.onDujieOpenCallBack))},init:function(){this.isInit||(this.registerUpdateTaskState(),this.onRequestDujieinfo(),this.isInit=!0)},onRequestDujieinfo:function(){game.DujieSender.DuJieInfoRequest()},getSelfDujieLv:function(){return this.dujieInfo?this.dujieInfo.lv:0},setDujieInfo:function(e){this.dujieInfo||(this.dujieInfo=new game.DujieInfo),this.dujieInfo.setup(e),(e=game.ccfg.DujieCfg.getDataByLevel(this.dujieInfo.lv))?(this.numalltask=e.conditions.length,this.updateTaskState(),b8e.evt.dptG(game.DujieEvent.UPDATE_DUJIE),b8e.evt.dptG(game.DujieEvent.UPDATE_TASK_NUMB)):b8e.log("没有读取到配置表，此等级没有配置")},setDujieData:function(e){this.dujieData||(this.dujieData=new game.DujieData),this.dujieData.setup(e),game.DujieSender.DuJieInfoRequest(),b8e.evt.dptG(game.DujieEvent.DUJIEKILL_TASK)},registerUpdateTaskState:function(){b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateTaskState),b8e.evt.addG(this,game.AccessoryEvent.AccessorySuccees,this.updateTaskState),b8e.evt.addG(this,game.DujieEvent.TONGGUNAG_FUBEN,this.updateTaskState),b8e.evt.addG(this,game.DujieEvent.ARENA_RANK,this.updateTaskState),b8e.evt.addG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.updateTaskState),b8e.evt.addG(this,game.GuildEvt.GUILD_LEAVE_GUILD_SUCCESS,this.updateTaskState),b8e.evt.addG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.updateTaskState),b8e.evt.addG(this,game.DujieEvent.SHENGWANG,this.updateTaskState),b8e.evt.addG(this,game.DujieEvent.DUJIEKILL_TASK,this.updateTaskState),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.updateTaskState),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.updateTaskState)},updateTaskState:function(){game.funcOpen.checkOpen(game.FunctionType.JING_JIE)&&this.isComplete()?this.isCompleteTask=!0:this.isCompleteTask=!1}},"getSelfDujieLv",function(){return this.dujieInfo?this.dujieInfo.lv:0}),s(n,"getfinishedTaskNum",function(){return this.numfinished}),s(n,"isFinishByType",function(e){return!!this.dujieInfo&&(!!game.ccfg.DujieCfg.getDataByLevel(this.dujieInfo.lv)&&this.checkTaskIsFinish(e))}),s(n,"onFinishDuJieInstance",function(e){e&&this.dujieInfo&&(e.state==game.BattleState.Victory?(game.DungeonResultMgr.inst().showResult(!0,e.userItem,game.DungeonType.DUJIE_INSTANCE),b8e.evt.dptG(game.DujieEvent.BOSSTASK_SUCCESS),this.dujieInfo.state=game.DujieState.FINISHED):game.DungeonResultMgr.inst().showResult(!1))}),s(n,"checkTaskIsFinish",function(e){var t=this.getValueByTye(e);return this.getTargetValueByType(e)<=t}),s(n,"getValueByTye",function(e){var t=0,i=game.mainRole.mainRoleData;switch(e){case game.DujieEnum.JUESHE_LV:t=i.getLv();break;case game.DujieEnum.ATK_LV:t=i.getZhanLi();break;case game.DujieEnum.ZUOJI_LV:(r=game.MountMgr().accessoryData)&&(t=r.lv);break;case game.DujieEnum.CHIBAN_LV:(r=game.WingMgr().accessoryData)&&(t=r.lv);break;case game.DujieEnum.FABAO_LV:(r=game.FaBaoMgr().accessoryData)&&(t=r.lv);break;case game.DujieEnum.ZHUNGBEI_LV:t=game.equip.getTotalIntensifyLevel();break;case game.DujieEnum.ZHUNGBEIALL_LV:t=game.equip.getTotalStar();break;case game.DujieEnum.TONGGUNAG_FUBEN:var n=this.getCfgValueByType(game.DujieEnum.TONGGUNAG_FUBEN),s=game.loneyDungeon.getDungeonInfoById(n);if(!s)return 0;t=s.state==game.LoneyDungeonState.FINISH?1:0;break;case game.DujieEnum.ARENA_RANK:var a=game.arena.getSelfRank(),o=this.getCfgValueByType(game.DujieEnum.ARENA_RANK);t=a&&a<=o?1:0;break;case game.DujieEnum.ENJOIN_GUILD:t=game.guild.isHasGuild()?1:0;break;case game.DujieEnum.SHENGWANG:t=game.back.getAmountInfo().getValue(game.AmountType.POPULARITY);break;case game.DujieEnum.BEAUTY:n=this.getCfgValueByType(game.DujieEnum.BEAUTY);t=game.beauty.getBeautyIsGetById(n)?1:0;break;case game.DujieEnum.DUJIEKILL_TASK:var r;(r=game.ccfg.DujieCfg.getTaskByType(this.dujieInfo.lv,game.DujieEnum.DUJIEKILL_TASK)).Ext,t=r.Value;return this.dujieInfo.getListByType(r.Type).num;case game.DujieEnum.POWER:return game.mainRole.mainRoleData.getZhanLi()}return t}),s(n,"getCfgValueByType",function(e){var t=game.ccfg.DujieCfg.getDataByLevel(this.dujieInfo.lv);if(!t)return 0;var i=t.conditions;if(!i||i.length<=0)return 0;for(var n=0;n<i.length;n++){var s=i[n];if(s&&s.Type==e)return s.Value}return 0}),s(n,"getTargetValueByType",function(e){var t=game.ccfg.DujieCfg.getDataByLevel(this.dujieInfo.lv);if(!t)return 0;var i=t.conditions;if(!i||i.length<=0)return 0;for(var n=0;n<i.length;n++){var s=i[n];if(s&&s.Type==e)switch(s.Type){case game.DujieEnum.ENJOIN_GUILD:case game.DujieEnum.BEAUTY:case game.DujieEnum.TONGGUNAG_FUBEN:case game.DujieEnum.ARENA_RANK:return 1;case game.DujieEnum.DUJIEKILL_TASK:if(s.Ext)return s.Ext;default:return s.Value}}return 0}),s(n,"isComplete",function(){var e=!1;if(!this.dujieInfo)return e;var t=game.ccfg.DujieCfg.getDataByLevel(this.dujieInfo.lv);if(!t)return e;var i=t.conditions;if(!i||i.length<=0)return e;for(var n=0;n<i.length;n++){var s=i[n];if(s)if(!(e=this.checkTaskIsFinish(s.Type)))return!1}return e}),s(n,"getTaskDesc",function(e){var t,i=this.getValueByTye(e),n=this.getTargetValueByType(e);switch(e){case game.DujieEnum.JUESHE_LV:t=game.ccfg.LangCfg.getText(10016,[n,i,n]);break;case game.DujieEnum.ATK_LV:var s=game.ValueUtil.formatNumber(i,1),a=game.ValueUtil.formatNumber(n,1);t=game.ccfg.LangCfg.getText(10017,[a,s,a]);break;case game.DujieEnum.ZUOJI_LV:var o=game.MountMgr().getLvString(n);t=game.ccfg.LangCfg.getText(10018,[o,i,n]);break;case game.DujieEnum.CHIBAN_LV:o=game.WingMgr().getLvString(n);t=game.ccfg.LangCfg.getText(10019,[o,i,n]);break;case game.DujieEnum.FABAO_LV:o=game.FaBaoMgr().getLvString(n);t=game.ccfg.LangCfg.getText(10020,[o,i,n]);break;case game.DujieEnum.ZHUNGBEI_LV:t=game.ccfg.LangCfg.getText(10021,[n,i,n]);break;case game.DujieEnum.ZHUNGBEIALL_LV:t=game.ccfg.LangCfg.getText(10022,[n,i,n]);break;case game.DujieEnum.TONGGUNAG_FUBEN:var r=this.getCfgValueByType(game.DujieEnum.TONGGUNAG_FUBEN),h=game.ccfg.DungeonCfg.getDataById(r),g=h.groupName,l=h.name;t=game.ccfg.LangCfg.getText(10023,[g,l,i]);break;case game.DujieEnum.ARENA_RANK:n=this.getCfgValueByType(game.DujieEnum.ARENA_RANK),t=game.ccfg.LangCfg.getText(10024,[n,i]);break;case game.DujieEnum.ENJOIN_GUILD:t=game.ccfg.LangCfg.getText(10025,[i,n]);break;case game.DujieEnum.SHENGWANG:t=game.ccfg.LangCfg.getText(10026,[n,i,n]);break;case game.DujieEnum.BEAUTY:r=this.getCfgValueByType(game.DujieEnum.BEAUTY);var c=game.ccfg.BeautyDataCfg.getBeautyInfoById(r);t=game.ccfg.LangCfg.getText(10027,[c.name,i]);break;case game.DujieEnum.DUJIEKILL_TASK:var u=(d=game.ccfg.DujieCfg.getTaskByType(this.dujieInfo.lv,game.DujieEnum.DUJIEKILL_TASK)).Ext,m=(i=d.Value,game.ccfg.SceneCfg.getSceneById(i).name),_=this.dujieInfo.getListByType(game.DujieEnum.DUJIEKILL_TASK);t=game.ccfg.LangCfg.getText(10029,[m,u,_.num,u]);break;case game.DujieEnum.BOOS_TASK:var d,f=this.dujieInfo.lv;(d=game.ccfg.DujieCfg.getDataByLevel(f+1))||b8e.log("没有读取到配置表，此等级没有配置");m=d.name;this.dujieInfo.state==game.DujieState.FINISHED&&(i=1),t=game.ccfg.LangCfg.getText(10028,[m,i]);break;case game.DujieEnum.POWER:t=game.ccfg.LangCfg.getText(87001,[i,n])}return t}),s(n,"isMaxLevel",function(){if(!this.dujieInfo)return!1;var e=game.ccfg.DujieCfg.getLastLv();return this.dujieInfo.lv>=e}),s(n,"fightBoos",function(){game.DujieSender.EnterDuJieSceneRequest()}),s(n,"enterScene",function(){game.app.hideAllApp();var e=game.SysTime.curTime+parseInt(game.ccfg.GlobalParamCfg.getData(3400));game.leaveDungeon.show(e,game.SceneType.DUJIEBOSS)}),s(n,"upgrade",function(){game.DujieSender.DuJieUpgradeRequest()}),s(n,"upgradeSUcceed",function(){this.numfinished=0,this.dujieInfo&&(this.dujieInfo.lv++,this.dujieInfo.state=game.DujieState.UNFINISHED),b8e.evt.dptG(game.DujieEvent.UPDATE_TASK_NUMB),b8e.evt.dptG(game.DujieEvent.DUJIE_SUCCESS),game.app.show(game.AppConstant.DUJIE_SUCCEED_PANEL),game.TriggerMgr.inst().dujieSucceedTrigger()}),s(n,"showAPPByType",function(e){switch(game.app.hideAllApp(),e){case game.DujieEnum.JUESHE_LV:case game.DujieEnum.ATK_LV:game.app.hideAllApp();break;case game.DujieEnum.ZUOJI_LV:game.funcOpen.checkOpenWithTips(game.FunctionType.MOUNT)&&game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.DujieEnum.CHIBAN_LV:game.funcOpen.checkOpenWithTips(game.FunctionType.WING)&&game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;case game.DujieEnum.FABAO_LV:game.funcOpen.checkOpenWithTips(game.FunctionType.FA_BAO)&&game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.DujieEnum.ZHUNGBEI_LV:game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_QIANG_HUA)&&game.app.show(game.AppConstant.EQUIP_FORGE_PANEL);break;case game.DujieEnum.ZHUNGBEIALL_LV:game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_QIANG_HUA)&&game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1);break;case game.DujieEnum.TONGGUNAG_FUBEN:game.funcOpen.checkOpenWithTips(game.FunctionType.TIAO_ZHAN)&&game.app.show(game.AppConstant.CHALLANGE_DUNGEON_PANEL);break;case game.DujieEnum.ARENA_RANK:game.funcOpen.checkOpenWithTips(game.FunctionType.FENG_SHEN_BANG)&&game.app.show(game.AppConstant.FIGHT_PANEL,0);break;case game.DujieEnum.ENJOIN_GUILD:game.funcOpen.checkOpenWithTips(game.FunctionType.GUILD)&&game.app.showAppHideOtherApp(game.AppConstant.GUILD_PANEL);break;case game.DujieEnum.SHENGWANG:game.app.show(game.AppConstant.STRENGTHEN_PANEL,game.StrengthenAttType.REPUTATION_TYPE);break;case game.DujieEnum.BEAUTY:game.funcOpen.checkOpenWithTips(game.FunctionType.BEAUTY)&&game.app.show(game.AppConstant.BEAUTY_PANEL);break;case game.DujieEnum.DUJIEKILL_TASK:var t=game.ccfg.DujieCfg.getTaskByType(this.dujieInfo.lv,game.DujieEnum.DUJIEKILL_TASK),i=(t.Ext,t.Value),n=game.SceneMgr.inst().sceneId;game.TrusteeshipMgr.inst().start(),i==n||game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,i);break;case game.DujieEnum.POWER:game.app.show(game.AppConstant.STRENGTHEN_PANEL)}}),s(n,"initSpotAlert",function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.REINCARNATION_ALERT,null,this.dujieAlert,this)}),s(n,"dujieAlert",function(){return this.isCompleteTask}),n)),game.DujieMgr._instance=null,game.DujieMgr._singleton=!0,game.DujieMgr.inst=function(){return null==game.DujieMgr._instance&&(game.DujieMgr._singleton=!1,game.DujieMgr._instance=new game.DujieMgr,game.DujieMgr._singleton=!0),game.DujieMgr._instance}},{}],295:[function(e,t,i){"use strict";game.appModule.DujiePanel=game.SkinUIPanel.extends({items:null,_itemPool:null,_dataItems:null,_dataItemPool:null,m_data:null,m_Level:0,_itemVec:null,list:null,_effect:null,_anim:null,_upanim:null,wirteColor:null,greenColor:null,grayColor:null,_curSp:null,_nextSp:null,_maxSp:null,_dujieAnim:null,attrStrLeft:"",attrName:"",attrStrRight:"",maxWidth:525,_progressEffect:null,ctor:function(e){this._super(e),this.items=[],this._itemPool=[],this._dataItems=[],this._dataItemPool=[],this._itemVec=[],this.wirteColor=b8e.ColorUtil.toCCColor(4294967295),this.greenColor=b8e.ColorUtil.toCCColor(4285847056),this.grayColor=b8e.ColorUtil.toCCColor(4291154901)},getButtonByName:function(e){switch(e){case"fight":return!this._skin||this._skin.fight_Btn}return null},init:function(){this._skin.mask&&(this.maxWidth=this._skin.mask.width)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.DujieTaskItem)),this._list.show(),b8e.evt.onC(this._skin.tishengBnt,this.onTiShengTask,this),b8e.evt.onC(this._skin.fight_Btn,this.onFight,this),b8e.evt.onC(this._skin.pre_btn,this.onPreBtnClick,this),b8e.evt.onC(this._skin.shop_btn,this.onShopBtnClick,this),b8e.evt.addG(this,game.DujieEvent.UPDATE_DUJIE,this.updateDujie),b8e.evt.addG(this,game.DujieEvent.DUJIE_SUCCESS,this.dujieSuccess),game.dujie.onRequestDujieinfo()},onHide:function(){this.clearData(),this.clearEffect(),this._list&&this._list.hide(),this._dujieAnim&&this._dujieAnim.clear(),this._progressEffect&&this._progressEffect.clear(),b8e.evt.offC(this._skin.tishengBnt,this.onTiShengTask,this),b8e.evt.offC(this._skin.fight_Btn,this.onFight,this),b8e.evt.offC(this._skin.pre_btn,this.onPreBtnClick,this),b8e.evt.offC(this._skin.shop_btn,this.onShopBtnClick,this),b8e.evt.rmvG(this,game.DujieEvent.UPDATE_DUJIE,this.updateDujie),b8e.evt.rmvG(this,game.DujieEvent.DUJIE_SUCCESS,this.dujieSuccess)},onFight:function(){game.dujie.isComplete()?game.DujieSender.EnterDuJieSceneRequest():game.notice.show("需达成前置条件方可挑战")},onTiShengTask:function(){game.dujie.dujieInfo.state==game.DujieState.FINISHED?game.DujieSender.DuJieUpgradeRequest():game.notice.show("升阶条件未全部达成")},onPreBtnClick:function(){game.app.show(game.AppConstant.DUJIE_PRE_PANEL)},onShopBtnClick:function(){game.app.show(game.AppConstant.SHOP_PANEL,3)},dujieSuccess:function(){this._upgrade_effect||(this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.equipIntensify_effect)),game.DujieSender.DuJieInfoRequest(),this.removeEffect()},playEffect:function(){var e=game.ClientCfg.getUIFxs("10024");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.DUJIE_EFFECT,1),this._upgrade_effect.addChild(this._anim)),this._upgrade_effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)},onCompleteEffect:function(e){},addEffect:function(){var e=game.ClientCfg.getUIFxs("10019");e?(this._upanim||(this._upanim=b8e.Animator.get(game.AnimatorType.DUJIE_UPGRADEEFFECT,1),this._upgrade_effect.addChild(this._upanim)),this._upgrade_effect.setVisible(!0),this._upanim.load(e),this._upanim.play(null,0)):this._upanim&&this._upanim.clear()},removeEffect:function(){this._upanim&&this._upanim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)},updateDujie:function(){var e=game.dujie.dujieInfo.lv;if(this.m_data=game.ccfg.DujieCfg.getDataByLevel(e),this.m_data){var t=game.ccfg.DujieCfg.getattrIDByLevel(game.dujie.dujieInfo.lv),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=game.mainRole.mainRoleData.getLv(),s=game.CCommonUtil.getPower(i,n);this._skin.atklab.string=s;var a=this.m_data.conditions,o=game.ClientCfg.getDujie(this.m_data.resPath);this.m_data.resPath&&""!=this.m_data.resPath?(this._dujieAnim||(this._dujieAnim=b8e.Animator.get(game.AnimatorType.DUJIE,1),this._dujieAnim.addToParent(this._skin.dujie_anim)),this._dujieAnim.load(o),this._dujieAnim.play(),this._dujieAnim.setScale(this.m_data.uiScale,this.m_data.uiScale),this._dujieAnim.setBlendMode(b8e.BlendMode.ADD)):this._dujieAnim&&this._dujieAnim.clear();var r=game.ccfg.DujieCfg.getLastLv();this._skin.normal_Node.active=!(r<=e),this._list.setData(a),this.updateSpriteStat(),this.updateLastTaskState(),this.updataProgress()}},updataProgress:function(){this._progressEffect||(this._progressEffect=b8e.Animator.get(game.AnimatorType.DUJIE_PROGRESS,1),this._progressEffect.addToParent(this._skin.effect));var e=game.ClientCfg.getDujie("uifxs/10095");this._progressEffect.load(e),this._progressEffect.play();var t,i=game.mainRole.mainRoleData.getZhanLi(),n=0,s=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv);0==game.dujie.dujieInfo.lv?0<s.conditions.length&&(n=i/s.conditions[0].Value):(t=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv-1),0<s.conditions.length&&0<t.conditions.length&&(n=(i-t.conditions[0].Value)/(s.conditions[0].Value-t.conditions[0].Value))),1<n&&(n=1),this._skin.effect.x=this.maxWidth*(n-.5)},updateSpriteStat:function(){this.clearData(),this._curSp||(this._curSp=b8e.Sprite.get(),this._curSp.setAnchor(.5,.5),this._curSp.addToParent(this._skin.img_curNode1));var e,t=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv);t&&t.IvIcon&&0<game.dujie.dujieInfo.lv&&this._curSp.loadTexture(game.ClientCfg.getDujieLvIconUrl(t.IvIcon),null,null,{useManifest:!1}),t.desc?this._skin.curLevelDesc.string=t.desc:this._skin.curLevelDesc.string="无",e=0==game.dujie.dujieInfo.lv?game.ccfg.DujieCfg.getattrIDByLevel(game.dujie.dujieInfo.lv+1):game.ccfg.DujieCfg.getattrIDByLevel(game.dujie.dujieInfo.lv);var i,n,s,a=game.ccfg.SpriteStatCfg.getSpriteStatById(e);this.attrStrLeft="",this.attrStrRight="",this.attrName="";var o=a.getSpriteStats();if(o&&0<o.length)for(i=0;i<o.length;i++)(n=o[i])&&(this.attrName=game.ccfg.AttrRulesCfg.getAttrNameByType(n.type),s=Math.round(n.value),0==game.dujie.dujieInfo.lv&&(s=0),i%2?(this.attrStrLeft+=game.ccfg.LangCfg.getText(87002,[this.attrName,s]),this._skin.lab_attr_right.string=this.attrStrLeft):(this.attrStrRight+=game.ccfg.LangCfg.getText(87002,[this.attrName,s]),this._skin.lab_attr_left.string=this.attrStrRight))},updateLastTaskState:function(){this._skin.fight_Btn.active=!0,this._skin.upgradeAlert.active=!1,this._skin.fightAlert.active=!1,b8e.ShaderUtil.setGray(this._skin.tishengBnt),game.dujie.isComplete()?(this._skin.normalTask.active=!0,this._skin.BossTask.active=!1,b8e.ShaderUtil.reset(this._skin.bossIcon),b8e.ShaderUtil.reset(this._skin.fight_Btn),game.dujie.dujieInfo.state!=game.DujieState.FINISHED?(this._skin.taskText.node.color=this.wirteColor,this._skin.fightAlert.active=!0):(this._skin.fight_Btn.active=!1,this._skin.choose_0.active=!0,this._skin.taskText.node.color=this.greenColor,this._skin.upgradeAlert.active=!0,b8e.ShaderUtil.reset(this._skin.tishengBnt),this._upgrade_effect||(this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.tishengBnt)),this.addEffect())):(this._skin.normalTask.active=!1,this._skin.BossTask.active=!0,this._skin.taskText.node.color=this.grayColor,b8e.ShaderUtil.setGray(this._skin.bossIcon),b8e.ShaderUtil.setGray(this._skin.fight_Btn)),this._skin.taskText.string=game.dujie.getTaskDesc(game.DujieEnum.BOOS_TASK)},clearData:function(){this._curSp&&this._curSp.unloadTexture(),this._skin.lab_attr_left.string="",this._skin.lab_attr_right.string=""}})},{}],296:[function(e,t,i){"use strict";game.appModule.DujiePrePanel=game.SkinUIPanel.extends({_anim:null,_dujieSprite:null,_curPreLv:0,attrStrLeft:"",attrStrRight:"",ctor:function(e){this._super(e)},init:function(){this._dujieSprite=b8e.Sprite.get(),this._dujieSprite.setAnchor(.5,.5),this._dujieSprite.addToParent(this._skin.dujie_sprite)},onShow:function(){b8e.evt.onC(this._skin.left_btn,this.onLeftBtn,this),b8e.evt.onC(this._skin.right_btn,this.onRightBtn,this),this._curPreLv=game.dujie.dujieInfo.lv,this.setData()},onHide:function(){this._anim&&this._anim.clear(),b8e.evt.offC(this._skin.left_btn,this.onLeftBtn,this),b8e.evt.offC(this._skin.right_btn,this.onRightBtn,this)},setData:function(){if(this.cfg=game.ccfg.DujieCfg.getDataByLevel(this._curPreLv),this.cfg){this._dujieSprite.loadTexture(game.ClientCfg.getDujieLvIconUrl(this.cfg.IvIcon),null,null,{useManifest:!1});var e=game.ClientCfg.getDujie(this.cfg.resPath);this.cfg.resPath&&""!=this.cfg.resPath?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.ACCESSORY_SKILL,1),this._anim.addToParent(this._skin.anim)),this._anim.load(e),this._anim.play(),this._anim.setScale(this.cfg.uiScale,this.cfg.uiScale),this._anim.setBlendMode(b8e.BlendMode.ADD)):this._anim&&this._anim.clear(),this.cfg.desc?this._skin.desc.string=this.cfg.desc:this._skin.desc.string="无";var t=game.ccfg.DujieCfg.getattrIDByLevel(this._curPreLv);if(0==this._curPreLv)t=game.ccfg.DujieCfg.getattrIDByLevel(this._curPreLv+1);var i,n,s=game.ccfg.SpriteStatCfg.getSpriteStatById(t),a=s.getSpriteStats(),o=a.length;this.attrStrLeft="",this.attrStrRight="";for(var r=0;r<o;r++){var h=a[r];h&&(n=game.ccfg.AttrRulesCfg.getAttrNameByType(h.type),i=Math.round(h.value),0==this._curPreLv&&(i=0),r%2?(this.attrStrLeft+=game.ccfg.LangCfg.getText(87002,[n,i]),this._skin.lab_attr_right.string=this.attrStrLeft):(this.attrStrRight+=game.ccfg.LangCfg.getText(87002,[n,i]),this._skin.lab_attr_left.string=this.attrStrRight))}var g=game.mainRole.mainRoleData.getLv();this._skin.lab_power.string=game.CCommonUtil.getPower(s,g),this._skin.left_btn.active=!(this._curPreLv<=0);var l=game.ccfg.DujieCfg.getLastLv();this._skin.right_btn.active=!(this._curPreLv>=l)}},onLeftBtn:function(){this._curPreLv--,this.setData()},onRightBtn:function(){this._curPreLv++,this.setData()}})},{}],297:[function(e,t,i){"use strict";game.appModule.DujieSucceedPanel=game.SkinUIPanel.extends({_curSp:null,_nextSp:null,xindanTypeList:null,descHeight:40,ctor:function(e){this._super(e)},init:function(){this._curSp=b8e.Sprite.get(),this._curSp.setAnchor(.5,.5),this._curSp.addToParent(this._skin.nowdujieIcon),this._nextSp=b8e.Sprite.get(),this._nextSp.setAnchor(.5,.5),this._nextSp.addToParent(this._skin.lastdujieIcon),this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.effect_Node),this.xindanTypeList=[game.DujieXianDanType.PRIMARY,game.DujieXianDanType.MIDDLE,game.DujieXianDanType.ADVANCED,game.DujieXianDanType.AVME]},onShow:function(){this.updatePanel()},onHide:function(){this._upgrade_effect.setVisible(!1),this.clearEffect()},updatePanel:function(){if(0!=game.dujie.dujieInfo.lv&&this._skin){var e=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv);e&&e.IvIcon&&this._curSp&&this._curSp.loadTexture(game.ClientCfg.getDujieLvIconUrl(e.IvIcon),null,null,{useManifest:!1});var t=game.ccfg.DujieCfg.getattrIDByLevel(game.dujie.dujieInfo.lv),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t);if(i){this._skin.nowattr_str.string=this.getSpriteStatStr(i,!1);var n=game.mainRole.mainRoleData.getLv(),s=game.CCommonUtil.getPower(i,n);this._skin.now_atk.string=s;var a=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv-1);a&&this._nextSp&&this._nextSp.loadTexture(game.ClientCfg.getDujieLvIconUrl(a.IvIcon),null,null,{useManifest:!1});var o=game.ccfg.DujieCfg.getattrIDByLevel(game.dujie.dujieInfo.lv-1),r=game.ccfg.SpriteStatCfg.getSpriteStatById(o);r?(this._skin.lastattr_str.string=this.getSpriteStatStr(r,!0),s=game.CCommonUtil.getPower(r,n),this._skin.last_atk.string=s):this._skin.now_atk.string="0",game.dujie.dujieInfo.lv-1==0&&(this._skin.lastattr_str.string=this.getSpriteStatStr(i,!0));for(var h="",g=0;g<this.xindanTypeList.length;++g){var l=this.getXianDanLimitDescByType(this.xindanTypeList[g]);""!=l&&(h+=l,0)}this._skin.xiandanDesc.string=h}}},getSpriteStatStr:function(e,t){var i,n,s="",a="",o="",r=e.getSpriteStats();if(r&&0<r.length)for(i=0;i<r.length;i++)if(n=r[i]){a=game.ccfg.AttrRulesCfg.getAttrNameByType(n.type),o=i!=r.length-1?"\n":"";var h=n.value;game.dujie.dujieInfo.lv-1==0&&t&&(h="0"),s+=a+"  +"+h+o}return s},playEffect:function(){var e=game.ClientCfg.getUIFxs("10024");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.DUJIE_EFFECT,1),this._upgrade_effect.addChild(this._anim)),this._upgrade_effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)},onCompleteEffect:function(e){this._upgrade_effect.setVisible(!1),this._skin.dujiesucceed.active=!0},getXianDanLimitDescByType:function(e){var t=game.dujie.dujieInfo.lv,i=game.dujie.dujieInfo.lv-1,n=game.ccfg.XiandanCfg.getUseLimitByDujieLv(t,e),s=game.ccfg.XiandanCfg.getUseLimitByDujieLv(i,e),a="";if(n==s)return a;switch(e){case game.DujieXianDanType.PRIMARY:a=game.ccfg.LangCfg.getText(16e3,[s,n]);break;case game.DujieXianDanType.MIDDLE:a=game.ccfg.LangCfg.getText(16001,[s,n]);break;case game.DujieXianDanType.ADVANCED:a=game.ccfg.LangCfg.getText(16002,[s,n]);break;case game.DujieXianDanType.AVME:a=game.ccfg.LangCfg.getText(16003,[s,n])}return a}})},{}],298:[function(e,t,i){"use strict";game.DujieTaskItem=game.SkinUI.extends({wirteColor:null,greenColor:null,_taskData:null,ctor:function(){this._super("dujie/DujieTaskItemSkin","DujieTaskItemSkin"),this.wirteColor=b8e.ColorUtil.toCCColor(4294967295),this.greenColor=b8e.ColorUtil.toCCColor(4285847056)},getWidth:function(){return 530},getHeight:function(){return 50},onShow:function(){this.setData(this._taskData),b8e.evt.onC(this._skin.choose_0,this.onToTask,this)},onHide:function(){b8e.evt.offC(this._skin.choose_0,this.onToTask,this)},onToTask:function(){game.dujie.isFinishByType(this._taskData.Type)?b8e.log("你已经完成此项任务"):game.dujie.showAPPByType(this._taskData.Type)},setData:function(e){if(this._taskData=e,this._taskData&&this._skin){var t=game.dujie.isFinishByType(this._taskData.Type);this._skin.wancheng.active=t,this._skin.choose.active=t,this._skin.openBnt.active=!t,this._skin.taskText.node.color=t?this.greenColor:this.wirteColor,this._skin.taskText.string=game.dujie.getTaskDesc(this._taskData.Type)}}})},{}],299:[function(e,t,i){"use strict";game.DujieSender={},game.DujieSender.DuJieInfoRequest=function(){var e=game.pbmid.DuJie.DuJieInfoRequest;b8e.sendN(e)},game.DujieSender.EnterDuJieSceneRequest=function(){var e=game.pbmid.DuJie.EnterDuJieSceneRequest;b8e.sendN(e)},game.DujieSender.DuJieUpgradeRequest=function(){var e=game.pbmid.DuJie.DuJieUpgradeRequest;b8e.sendN(e)}},{}],300:[function(e,t,i){"use strict";e("./manager/managerIndex_3"),e("./panel/panelIndex_4")},{"./manager/managerIndex_3":302,"./panel/panelIndex_4":308}],301:[function(e,t,i){"use strict";game.DungeonResultMgr=b8e.Object.extends({resultInfo:null,dungeonType:0,_timer:null,showResult:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.DungeonType.NONE_TYPE;this.resultInfo||(this.resultInfo=new game.DungeonResultInfo),this.resultInfo.result=e,this.resultInfo.reward=t,b8e.Tween.get(this).wait(1e3).call(this.showResultInfo,this,[this.resultInfo]),this.dungeonType=i},showResultInfo:function(e){this.resultInfo=e;var t=1500;this._timer?(this._timer.reset(),this._timer.start()):(this.resultInfo.result||(t=200),this._timer=b8e.Timer.add(this,this._showResultPanle,t))},_showResultPanle:function(){this._timer&&this._timer.stop(),game.app.show(game.AppConstant.DUNGEON_RESULT_PANEL)},clearResult:function(){this._timer&&this._timer.stop()}}),game.DungeonResultMgr._instance=null,game.DungeonResultMgr.inst=function(){return null==game.DungeonResultMgr._instance&&(game.DungeonResultMgr._instance=new game.DungeonResultMgr),game.DungeonResultMgr._instance}},{}],302:[function(e,t,i){"use strict";e("./DungeonResultMgr")},{"./DungeonResultMgr":301}],303:[function(e,t,i){"use strict";game.appModule.DungeonFightCountBuyPanel=game.SkinUIPanel.extends({_amountInfo:null,_setDes:!1,ctor:function(e){this._super(e)},onShow:function(){0==this._setDes&&(this._skin.bossDes.string=game.ccfg.LangCfg.getText(10015),this._setDes=!0),this.setData(),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.onC(this._skin.bossDes.node,this.onClickDes,this),b8e.evt.addG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.setData)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.offC(this._skin.bossDes.node,this.onClickDes,this),b8e.evt.rmvG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.setData)},onClickDes:function(){game.TriggerMgr&&game.TriggerMgr.inst().customTriggerById(3137)},setData:function(){this.setBuyCount(),this.setAddFightCount(),this.setCostItem()},setBuyCount:function(){var e="",t=game.vip.getBuyInstanceTimes()-game.loneyDungeon.buyCount;e=0<t?"今日剩余购买次数："+game.html.getText(game.html.Q_GREEN,t):"今日剩余购买次数："+game.html.getText(game.html.Q_RED,t),this._skin.lab_buyCount.string=e},setAddFightCount:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ADD_FIGHT_TIMES);this._skin.lab_add_fight_count.string="BOSS令牌+"+e},setCostItem:function(){var e=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.BUY_TILI_COUNT,game.loneyDungeon.buyCount+1);if(e){var t=e.upgradeInfo;if(t&&(this._amountInfo=t.getAmountInfo(),this._amountInfo)){var i=this.getAmountStr(this._amountInfo),n=this._amountInfo.getFirstAmountType();return n==game.AmountType.SILVER&&(this._skin.img_yinbi.active=!0,this._skin.img_yuanbao.active=!1),n==game.AmountType.YUAN_BAO&&(this._skin.img_yinbi.active=!1,this._skin.img_yuanbao.active=!0),void(this._skin.lab_cost.string=i)}}},getAmountStr:function(e){var t="";if(e){var i=e.getAllTyps();if(i&&0<i.length){var n=e.getFirstAmountType(),s=e.getFirstAmountValue(),a=game.back.getAmountInfo();switch(n){case game.AmountType.SILVER:var o=a.getValue(game.AmountType.SILVER);0<s&&(t=s<=o?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]));break;case game.AmountType.YUAN_BAO:var r=a.getValue(game.AmountType.YUAN_BAO);0<s&&(t=s<=r?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]));break;case game.AmountType.POPULARITY:var h=a.getValue(game.AmountType.POPULARITY);0<s&&(t=s<=h?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]));break;case game.AmountType.HONOUR:var g=a.getValue(game.AmountType.HONOUR);0<s&&(t=s<=g?game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_GREEN,s)]):game.ccfg.LangCfg.getText("$",[game.html.getText(game.html.Q_RED,s)]))}}}return t},onClickBuyBtn:function(){0<game.vip.getBuyInstanceTimes()-game.loneyDungeon.buyCount?game.loneyDungeon.sendBuyInsNum():game.gameAlert.showVipAlert(!1,100)}})},{}],304:[function(e,t,i){"use strict";game.appModule.DungeonPanel=game.SkinUIPanel.extends({_worldBossPanel:null,_nationalBossPanel:null,_teamPanel:null,_neutralBossPanel:null,_index:-1,_curPanel:null,_timer:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"nationalBoss":return!this._skin||!(t=this._skin.buttonToggle[0].node)||t;case"team":return!this._skin||!(t=this._skin.buttonToggle[1].node)||t;case"worldBoss":return!this._skin||!(t=this._skin.buttonToggle[2].node)||t;case"neutralBoss":return!this._skin||!(t=this._skin.buttonToggle[3].node)||t;case"nationalBossFight":return!this._nationalBossPanel||!(t=this._nationalBossPanel.getButtonByName("fight"))||t;case"back":return!this._skin||this._skin.closeBtnReturn}return null},setTab:function(e){return!!this._skin&&("1"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"2"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"3"==e?(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]):"4"!=e||(this._skin.buttonToggle[3].check(),this.onSelectPanelByIndex(3),this._skin.buttonToggle[3]))},initPanel:function(){},onShow:function(){b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickNationalBossBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickTeamBtn,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickWorldBossBtn,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onClickNeutralBossBtn,this),b8e.evt.onC(this._skin.jiahaoBtn,this.onClickJiahaoBtn,this),b8e.evt.addG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.startResetTime),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.startResetTime),this.initPanel(),this.startResetTime(),this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this.onSelectPanelByIndex(this._index),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange(),this._skin.doubleIcon.active=game.team.isShowDoubleIcon()},onHide:function(){this._curPanel&&this._curPanel.hide(),this._index=-1,b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickNationalBossBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickTeamBtn,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickWorldBossBtn,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onClickNeutralBossBtn,this),b8e.evt.offC(this._skin.jiahaoBtn,this.onClickJiahaoBtn,this),b8e.evt.rmvG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.startResetTime),b8e.evt.rmvG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.startResetTime),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this._timer&&this._timer.stop()},onSpotAlertChange:function(){this._skin.worldBossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WORLD_BOSS_ALERT),this._skin.nationalBossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.NATIONAL_BOSS_ALERT),this._skin.neutralBossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.NEUTRAL_BOSS_ALERT)},startResetTime:function(){var e=game.loneyDungeon;if(this._skin.label_have_time.string=e.fightCount+"/"+e.maxFightCount,e.fightCount==e.maxFightCount)this._skin.label_reset_time.string="";else{var t=e.getNextResetTime()-game.SysTime.curTime;t<0&&(t=0),this._skin.label_reset_time.string=b8e.TimeUtil.formatTime(t),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateResetTime,500)}},updateResetTime:function(){var e=game.loneyDungeon;if(this._skin.label_have_time.string=e.fightCount+"/"+e.maxFightCount,e.fightCount==e.maxFightCount)this._timer&&this._timer.stop(),this._skin.label_reset_time.string="";else{var t=e.getNextResetTime()-game.SysTime.curTime;t<0&&(t=0),this._skin.label_reset_time.string=b8e.TimeUtil.formatTime(t)}},onClickJiahaoBtn:function(){game.app.show(game.AppConstant.DUNGEON_BUY_PANEL)},onClickNationalBossBtn:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.NATIONAL_BOSS)){if(1==this._index)return;this.onSelectPanelByIndex(0)}},onClickNeutralBossBtn:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.NEUTRAL_BOSS)){if(4==this._index)return;this.onSelectPanelByIndex(3)}else this._skin.buttonToggle[this._index].check(),this.onSelectPanelByIndex(0)},onClickTeamBtn:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.TEAM_BOSS)){if(2==this._index)return;this.onSelectPanelByIndex(1)}},onClickWorldBossBtn:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.WORLD_BOSS)){if(3==this._index)return;this.onSelectPanelByIndex(2)}},setFightCount:function(e){this._skin.label_have_time.node.active=e,this._skin.label_reset_time.node.active=e,this._skin.jiahaoBtn.active=e},onSelectPanelByIndex:function(e){switch(this._curPanel&&this._curPanel.hide(),this._index=e+1,e){case 0:this._nationalBossPanel||(this._nationalBossPanel=new game.NationalBossPanel(0),this._nationalBossPanel.addToParent(this._skin.dungeonPage)),this._skin.buttonToggle[0].check(),this.setFightCount(!0),this._skin.title.string="全民BOSS",this._nationalBossPanel.show(),this._curPanel=this._nationalBossPanel;break;case 1:this._teamPanel||(this._teamPanel=new game.TeamPanel,this._teamPanel.addToParent(this._skin.dungeonPage)),this._skin.buttonToggle[1].check(),this.setFightCount(!1),this._skin.title.string="组队副本",this._teamPanel.show(),this._curPanel=this._teamPanel;break;case 2:this._worldBossPanel||(this._worldBossPanel=new game.WorldBossPanel,this._worldBossPanel.addToParent(this._skin.dungeonPage)),this._skin.buttonToggle[2].check(),this.setFightCount(!1),this._skin.title.string="世界BOSS",this._worldBossPanel.show(),this._curPanel=this._worldBossPanel;break;case 3:this._neutralBossPanel||(this._neutralBossPanel=new game.NationalBossPanel(1),this._neutralBossPanel.addToParent(this._skin.dungeonPage)),this._skin.buttonToggle[3].check(),this.setFightCount(!0),this._skin.title.string="中立BOSS",this._neutralBossPanel.show(),this._curPanel=this._neutralBossPanel}}})},{}],305:[function(e,t,i){"use strict";game.appModule.DungeonResultPanel=game.SkinUIPanel.extends({_leaveTime:5,_prizeList:null,_prizeInfo:null,_list:null,_result:!1,_curScoreArr:null,_timer:null,ctor:function(e){this._super(e),this._prizeInfo=new game.PrizeInfo,this._curScoreArr=[]},init:function(){this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.img_failue)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list_strengthen,game.StrDefeatedItem,4)),this._list.show(),this.showResult(),b8e.evt.onC(this._skin.sure_btn,this.onSureBtnClick,this),b8e.evt.onC(this._skin.btn_go,this.onClickBtnGo,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateBanner)},onHide:function(){this._list&&this._list.hide(),this._bgSprite&&this._bgSprite.unloadTexture(),this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.sure_btn,this.onSureBtnClick,this),b8e.evt.offC(this._skin.btn_go,this.onClickBtnGo,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateBanner)},showResult:function(){var e=game.DungeonResultMgr.inst().resultInfo;if(e){if(this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90,game.IconScale.PERCENT_80),this._prizeList.containerId=game.ContainerId.DUNGEON_DROP_PRIZE_LIST_ID,this._prizeList.addToParent(this._skin.list_item.content)),this._result=e.result,e.result)switch(this._skin.img_result_sucess.active=!0,this._skin.node_failure.active=!1,this._skin.lab_surcess_reward.active=!0,this._skin.winEffect.active=!0,this._prizeInfo.setup(e.reward),this._prizeList.setData(this._prizeInfo),this._skin.team_success_tiplab.node.active=!1,game.DungeonResultMgr.inst().dungeonType){case game.DungeonType.DUJIE_INSTANCE:this._skin.lab_surcess_reward.active=!1,this._skin.dujielab_surcess_reward.active=!0;break;case game.DungeonType.TYPE_TEAM:this._skin.lab_surcess_reward.active=!1,this._skin.dujielab_surcess_reward.active=!1,e.reward||(this._skin.team_success_tiplab.node.active=!0);break;default:this._skin.lab_surcess_reward.active=!0,this._skin.dujielab_surcess_reward.active=!1}else this._skin.img_result_sucess.active=!1,this._skin.node_failure.active=!0,this._skin.lab_surcess_reward.active=!1,this._skin.list_strengthen.node.active=!0,this._skin.winEffect.active=!1,game.strengthen.setAttInfoArrById(1),this.updateStrengthenContent(),this._prizeInfo.setup(null),this._prizeList.setData(null),this.updateBanner();this._leaveTime=5,this._skin.lab_sure_btn.string="确定("+this._leaveTime+"s)",this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateSureTime,1e3)}else this.hide()},updateBanner:function(){this._bgSprite&&this._bgSprite.unloadTexture();var e=game.pay.getFailueBannerPath();e&&""!=e&&this._bgSprite.loadTexture(game.ClientCfg.getImgUrl(e,!1),null,null,{useManifest:!1})},updateSureTime:function(){0<this._leaveTime?(this._leaveTime--,this._skin.lab_sure_btn.string="确定("+this._leaveTime+"s)"):this.onSureBtnClick()},updateStrengthenContent:function(){var e,t=game.strengthen.getScoreUpArr();t&&0<t.length&&((e=4<(t=game.strengthen.filterScoreArr(t)).length?t.slice(0,[4]):t)&&0<e.length&&this._list&&this._list.setData(e))},onClickBtnGo:function(){game.pay.goFailueTrigger()},onSureBtnClick:function(){this._timer&&this._timer.stop();var e=game.SceneMgr.inst().getSceneConfig();e&&game.leaveDungeon.type&&(game.leaveDungeon.type=e.type);var t=game.leaveDungeon.type;switch(game.leaveDungeon.onKillTween(),t){case game.SceneType.TEAM_BOSS:this._result&&(game.SceneSender.leaveAloneDungeon(),game.DungeonResultMgr.inst().clearResult());break;case game.SceneType.DUJIEBOSS:case game.SceneType.NORMAL:break;case game.SceneType.DUNGEON:this._result||game.quest.changeAuto(!1),game.leaveDungeon.onLeave();break;default:game.leaveDungeon.onLeave()}this.hide()}})},{}],306:[function(e,t,i){"use strict";game.DungeonTabType=b8e.Enum({NATIONAL_BOSS:0,TEAM_BOSS:1,WORLD_BOSS:2})},{}],307:[function(e,t,i){"use strict";game.LoadingDungeonPage=game.SkinUI.extends({_bgGraph:null,_isShowing:!1,_isWaitHide:!1,_head:null,ctor:function(){this._super("dungeon/LoadingDungeonSkin","LoadingDungeonSkin")},showPage:function(){if(!this.parent){var e=b8e.layer.getTopLayer();this.addToParent(e),this.setLocalZOrder(999999999),this.show(),this._isShowing=!0}},onShow:function(){this._script=this._skin,this._bgGraph||(this._bgGraph=b8e.Graphics.get(),this._bgGraph.setAnchor(.5,.5),this._bgGraph.addToParent(this._script.bgNode)),this._head||(this._head=b8e.Sprite.get(),this._head.setAnchor(.5,.5),this._head.addToParent(this._script.head),this._head.loadTexture(game.ClientCfg.getTextureUrl("shizitou.img"),null,null,{useManifest:!1})),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.onC(this._bgGraph,this.onClick,this),this.onResize(),this.showTween()},showTween:function(){this._script.topBar.y=0,this._script.topBar.opacity=255,this._script.bottomBar.y=0,this._script.bottomBar.opacity=255,this._head.opacity=0,b8e.Tween.get(this._head).to({opacity:255},500).call(this._showTweenComplete,this)},_showTweenComplete:function(){this._isShowing=!1,this._head&&b8e.Tween.kill(this._head),b8e.Tween.kill(this._script.topBar),b8e.Tween.kill(this._script.bottomBar),this._isWaitHide&&this._hideTween()},hidePage:function(){1==this._isShowing?this._isWaitHide=!0:this._hideTween()},_hideTween:function(){var e=.4*b8e.stageHeight,t=-.4*b8e.stageHeight;this._script?(b8e.Tween.get(this._head).to({opacity:122},200).call(this._hideTweenComplete,this),b8e.Tween.get(this._script.topBar).to({y:e,opacity:200},200),b8e.Tween.get(this._script.bottomBar).to({y:t,opacity:200},200)):(b8e.log("没有skin"),this._hideTweenComplete())},_hideTweenComplete:function(){this.hide()},onHide:function(){this._isWaitHide=!1,this._script&&(this._head&&b8e.Tween.kill(this._head),b8e.Tween.kill(this._script.topBar),b8e.Tween.kill(this._script.bottomBar)),this.removeFromParent(),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.offC(this._bgGraph,this.onClick,this),b8e.Tween.kill(this)},onClick:function(){},onResize:function(){this._bgGraph&&(this._bgGraph.clear(),this._bgGraph.fillColor(0),this._bgGraph.fillRect(0,0,b8e.stageWidth,b8e.stageHeight),this._bgGraph.setSize(b8e.stageWidth,b8e.stageHeight)),this._script&&(this._script.topBar.setContentSize(b8e.stageWidth,.5*b8e.stageHeight),this._script.topLine.setContentSize(b8e.stageWidth,119),this._script.bottomBar.setContentSize(b8e.stageWidth,.5*b8e.stageHeight),this._script.bottomLine.setContentSize(b8e.stageWidth,119)),this.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight)}}),game.LoadingDungeonPage._instance=null,game.LoadingDungeonPage._singleton=!0,game.LoadingDungeonPage.inst=function(){return null==game.LoadingDungeonPage._instance&&(game.LoadingDungeonPage._singleton=!1,game.LoadingDungeonPage._instance=new game.LoadingDungeonPage,game.LoadingDungeonPage._singleton=!0),game.LoadingDungeonPage._instance}},{}],308:[function(e,t,i){"use strict";e("./DungeonFightCountBuyPanel"),e("./DungeonResultPanel"),e("./DungeonPanel"),e("./LoadingDungeonPage")},{"./DungeonFightCountBuyPanel":303,"./DungeonPanel":304,"./DungeonResultPanel":305,"./LoadingDungeonPage":307}],309:[function(e,t,i){"use strict";game.EquipCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Bag.PutOnEquipResponse,this.onPutOnEqRp,this),b8e.addNH(game.pbmid.Equip.EquipSlotUpgradeResponse,this.onEqSlotRp,this),b8e.addNH(game.pbmid.Equip.EquipSlotBatchUpgradeResponse,this.onEqBatchRp,this),b8e.addNH(game.pbmid.Equip.EquipSlotStarResponse,this.onEqStarRp,this),b8e.addNH(game.pbmid.Equip.EquipRefineResponse,this.onEqRefineRp,this),b8e.addNH(game.pbmid.Equip.EquipCombineResponse,this.onEquipCombineResponse,this),b8e.addNH(game.pbmid.Equip.EquipUpgradeResponse,this.onEquipUpgradeResponse,this),b8e.addNH(game.pbmid.Equip.EquipEnchantResponse,this.onEquipEnchantResponse,this)},onPutOnEqRp:function(e){var t=e.readProtobuf(game.pbmsg.PutOnEquipResponse);0<t.code?(game.equip.lastWearEquipInfo=null,game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))):game.equip.onWearEquipSuccess(t.equip)},onEqSlotRp:function(e){var t=e.readProtobuf(game.pbmsg.EquipSlotUpgradeResponse);game.equip.onEquipSlotUpgradeSuccess(t.slot)},onEqBatchRp:function(e){var t=e.readProtobuf(game.pbmsg.EquipSlotBatchUpgradeResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.equip.onEquipSlotBatchUpgradeSuccess(t.slots)},onEqStarRp:function(e){var t=e.readProtobuf(game.pbmsg.EquipSlotStarResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),b8e.evt.dptG(game.EquipEvt.EQUIP_STOP_UP_STAR)):t.slot&&game.equip.onEquipSlotStarSuccess(t.slot.type,t.slot.rate,t.slot.star,t.state)},onEqRefineRp:function(e){var t=e.readProtobuf(game.pbmsg.EquipRefineResponse);0<t.code?(game.equip.isInRefining=!1,game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))):game.equip.onEquipRefineSuccess(t.srcId,t.srcEquip,t.dstId,t.dstEquip)},onEquipCombineResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.EquipCombineResponse).code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.equip.onCombineEquipSuccess()},onEquipUpgradeResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.EquipUpgradeResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.equip.onEquipUpGradeSuccess(i.item)},onEquipEnchantResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.EquipEnchantResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.equip.onEquipEnchantSuccess(i.slot)}})},{}],310:[function(e,t,i){"use strict";e("./EquipCmd")},{"./EquipCmd":309}],311:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_2"),e("./event/eventIndex_3"),e("./manager/managerIndex_4"),e("./panel/panelIndex_5"),e("./sender/senderIndex_2")},{"./cmdlistener/cmdlistenerIndex_2":310,"./event/eventIndex_3":313,"./manager/managerIndex_4":315,"./panel/panelIndex_5":334,"./sender/senderIndex_2":336}],312:[function(e,t,i){"use strict";game.EquipEvt=b8e.Enum({PUT_ON_EQUIP:b8e.Event.nextCode(),EQUIP_INTENSISY_SUCCESS:b8e.Event.nextCode(),ALL_EQUIP_INTENSISY_SUCCESS:b8e.Event.nextCode(),ON_CLICK_EQUIP_SLOT:b8e.Event.nextCode(),SELECT_UP_STAR_EQUIP:b8e.Event.nextCode(),EQUIP_UPGRADE_STAR_COMPLETE:b8e.Event.nextCode(),EQUIP_STOP_UP_STAR:b8e.Event.nextCode(),EQUIP_REFINE_SUCCESS:b8e.Event.nextCode(),EQUIP_REFINE_SELECT_SPRITE_STAT:b8e.Event.nextCode(),GM_UPDATE:b8e.Event.nextCode(),CLICKCALLBACK_EQUIPGRADE:b8e.Event.nextCode(),UPDATE_HIGHEQUIPPANEL:b8e.Event.nextCode(),PLAY_HIGHEQUIPEFFECT:b8e.Event.nextCode(),HIGHEQUIP_SPORTALERT:b8e.Event.nextCode(),ENCHANT_SPORTALERT:b8e.Event.nextCode(),ENCHANT_SUCCESS:b8e.Event.nextCode()})},{}],313:[function(e,t,i){"use strict";e("./EquipEvt")},{"./EquipEvt":312}],314:[function(e,t,i){"use strict";game.EquipMgr=b8e.Object.extends({name:"EquipMgr",EQUIP_MAX_COUNT:8,QUALITY_SUITS:0,STAR_SUITS:1,maxEquipSlotCount:8,_equipSlotMap:null,curUpStarSlot:null,curUpStarState:!1,curIntensifySlot:null,isAutoUpStar:!1,autoUpStarEnd:!1,_srcEquip:null,dstEquip:null,_leftEquipSpriteStatMap:null,_smeltMap:null,isAutoBuy:!1,lastWearEquipInfo:null,isShowRefineAlert:!1,isInRefining:!1,isIntensifying:!1,isUpStaring:!1,_newEquipSlotMap:null,isShowHighEquipAlert:!1,isShowEnchantAlert:!1,effectSlots:null,_canIntensifyEquipSlots:null,_canIntensifySlots:null,ctor:function(){if(1==game.EquipMgr._singleton)throw new Error("EquipMgr 只能通过单例方法获取");this._super(),this._equipSlotMap=b8e.HashMap.get(),this._smeltMap=b8e.HashMap.get(),this._leftEquipSpriteStatMap=b8e.HashMap.get()},setup:function(){var e=game.mainRole.mainRoleData;e&&e.equipSlotsMap&&e.equipSlotsMap.forEach(function(e,t){this.setEquipSlotInfo(e,t)},this)},setEquipSlotInfo:function(e,t){this._equipSlotMap.set(e,t)},getEquipSlotMap:function(){return this._equipSlotMap},getHasEquipSlotMap:function(){return this._newEquipSlotMap||(this._newEquipSlotMap=b8e.HashMap.get()),this._newEquipSlotMap.clear(),this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&this._newEquipSlotMap.set(e,t)},this),this._newEquipSlotMap},getEquipSlotInfoByType:function(e){return this._equipSlotMap.get(e)},wearEquip:function(e){if(game.mainRole.mainRoleData.getLv()<e.level)game.notice.show(game.ccfg.LangCfg.getText(15e3));else{if(game.funcOpen.checkOpen(game.FunctionType.EQUIP_TI_LIAN)){var t=this.getEquipSlotInfoByType(e.type);t.equip&&(this.lastWearEquipInfo=t.equip)}game.EquipSender.reqPutOnEquip(e.idx)}},onWearEquipSuccess:function(e){e||b8e.error(game.ccfg.LangCfg.getText(15001));var t=game.ItemInfoUtil.createItemInfo(e);if(t){var i,n=this._equipSlotMap.get(t.type);n&&(n.equip=t,n.equip&&(i=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(n.slotStar))?n.upStarPower=game.CCommonUtil.getPower(n.equip.baseSpriteStat,n.equip.level,i.attrRate):n.upStarPowe=0,t.isHighEquip&&b8e.evt.dptG(game.EquipEvt.UPDATE_HIGHEQUIPPANEL),this.setEquipSlotInfo(n.slotType,n),b8e.evt.dptG(game.EquipEvt.PUT_ON_EQUIP,{equipSlotInfo:n}),game.funcOpen.checkOpen(game.FunctionType.EQUIP_TI_LIAN)&&this.lastWearEquipInfo&&!this.isShowRefineAlert&&this.isCanRefine(this.lastWearEquipInfo)&&(game.app.isShow(game.AppConstant.EQUIP_REFINE_ALERT)||(game.app.show(game.AppConstant.EQUIP_REFINE_ALERT,this.lastWearEquipInfo),this.lastWearEquipInfo=null)))}game.back.checkEquipAlert(),game.back.checkItemAlert(),game.app.isShow(game.AppConstant.EQUIP_SELECT_PANEL)&&game.app.hide(game.AppConstant.EQUIP_SELECT_PANEL)},getQualityNameByQuality:function(e){var t="";switch(e){case game.Quality.Q_WHITE:t=game.ccfg.LangCfg.getText(15002);break;case game.Quality.Q_GREEN:t=game.ccfg.LangCfg.getText(15003);break;case game.Quality.Q_BLUE:t=game.ccfg.LangCfg.getText(15004);break;case game.Quality.Q_PURPLE:t=game.ccfg.LangCfg.getText(15005);break;case game.Quality.Q_YELLOW:t=game.ccfg.LangCfg.getText(15006);break;case game.Quality.Q_RED:t=game.ccfg.LangCfg.getText(15007)}return game.html.getText(game.html.getColorByQuality(e),t)},getEquipIconByType:function(e){var t="90001";switch(e){case game.GoodsType.WEAPON:t=game.ImageURLUtil.POS_WEAPON_ICONAME;break;case game.GoodsType.ARMOR:t=game.ImageURLUtil.POS_ARMOR_ICONAME;break;case game.GoodsType.BELT:t=game.ImageURLUtil.POS_BELT_ICONAME;break;case game.GoodsType.RING:t=game.ImageURLUtil.POS_RING_ICONAME;break;case game.GoodsType.HELM:t=game.ImageURLUtil.POS_HELM_ICONAME;break;case game.GoodsType.NECKLACE:t=game.ImageURLUtil.POS_NECKLACE_ICONAME;break;case game.GoodsType.LEGGUARD:t=game.ImageURLUtil.POS_LEGGUARD_ICONAME;break;case game.GoodsType.SHOE:t=game.ImageURLUtil.POS_SHOE_ICONAME}return"item/"+t},getAllEquipSpriteSatatPower:function(){var i=0;return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&(i+=t.totalPower)},this),i},getAllEquipIntensifyPower:function(){var i=0;return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&(i+=t.intensifyPower)},this),i},getAllEquipUpStarPower:function(){var i=0;return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&(i+=t.upStarPower)},this),i},getTotalStar:function(){var i=0;return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&(i+=t.slotStar)},this),i},getTotalIntensifyLevel:function(){var i=0;return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&(i+=t.slotLevel)},this),i},isHasWearEquipByType:function(e){var t=this.getEquipSlotInfoByType(e.type);return!(!t||!t.equip||t.slotType!=e.type)},isCanWear:function(e){return!(game.mainRole.mainRoleData.getLv()<e.level)&&(!this.isHasWearEquipByType(e)||this.isBetterRoleEquip(e))},isBetterRoleEquip:function(e){if(!this.isRoleEquip(e))return!1;var t,i=this.getEquipSlotInfoByType(e.type);return!(!i||i.equip)||(!(t=i.equip.basePower)||t<e.basePower)},isHasBetterEquip:function(e){var t=0;e&&(t=game.CCommonUtil.getPower(e.baseSpriteStat,e.level));var i=game.back.getEquipList();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];if(s){var a=game.CCommonUtil.getPower(s.baseSpriteStat,s.level);if(e.type==s.type&&t<a)return!0}}return!1},isCanSmelting:function(e){if(!e)return!1;var t=game.mainRole.mainRoleData.getLv();if(e.level<=t){if(!this.isCanWear(e)&&!this.isCanRefine(e))return!0}else if(!this.isCanRefine(e)&&!this.isShowRedMask(e))return!0;return!1},isShowRedMask:function(e){if(!e)return!1;if(e.group!=game.GoodsGroup.EQUIP)return!1;var t=game.mainRole.mainRoleData.getLv();return!!(e.level>t&&this.isBetterRoleEquip(e))},isRoleEquip:function(e){return!!e&&e.group==game.GoodsGroup.EQUIP},getEquipTotalPower:function(){return this.getAllEquipSpriteSatatPower()},onEquipSlotUpgradeSuccess:function(e){if(e){var t=e.type,i=e.level,n=this._equipSlotMap.get(t);if(n){n.slotLevel=i,n.attrId=game.ccfg.EquipSlotIntensifyCfg.getIntensifyAttrId(n.slotType,n.slotLevel);var s=game.ccfg.SpriteStatCfg.getSpriteStatById(n.attrId);s&&(n.intensifySpriteStat=s);var a=game.mainRole.mainRoleData.getLv();n.intensifyPower=game.CCommonUtil.getPower(n.intensifySpriteStat,a),this._equipSlotMap.set(t,n),game.notice.show(game.ccfg.LangCfg.getText(15008)),b8e.evt.dptG(game.EquipEvt.EQUIP_INTENSISY_SUCCESS,{equipSlotInfo:n})}}},onEquipSlotBatchUpgradeSuccess:function(e){if(this.effectSlots||(this.effectSlots=[]),this.effectSlots.length=0,e&&0<e.length){this.effectSlots=e;for(var t=game.mainRole.mainRoleData.getLv(),i=0;i<e.length;i++){var n=e[i];if(n){var s=n.type,a=n.level,o=this._equipSlotMap.get(s);if(o){o.slotLevel=a,o.attrId=game.ccfg.EquipSlotIntensifyCfg.getIntensifyAttrId(o.slotType,o.slotLevel);var r=game.ccfg.SpriteStatCfg.getSpriteStatById(o.attrId);r&&(o.intensifySpriteStat=r),o.intensifyPower=game.CCommonUtil.getPower(o.intensifySpriteStat,t),this._equipSlotMap.set(s,o)}}}game.notice.show(game.ccfg.LangCfg.getText(15009)),b8e.evt.dptG(game.EquipEvt.ALL_EQUIP_INTENSISY_SUCCESS)}},minEquipSlotInfo:{get:function(){var e=this._equipSlotMap.values();if(e&&0<e.length){e.sort(this.onSortSlotLevel);var t=e[0];if(t)return t}return null}},onSortSlotLevel:function(e,t){return e.slotLevel>t.slotLevel?1:e.slotLevel<t.slotLevel?-1:e.slotType>t.slotType?1:e.slotType<t.slotType?-1:0},getCanIntensifyEquipSlots:function(){this._canIntensifyEquipSlots||(this._canIntensifyEquipSlots=[]),this._canIntensifyEquipSlots.length=0;var a=game.mainRole.mainRoleData.getLv();return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){if(t){var i=0;i=0==t.slotLevel?1:t.slotLevel;var n=game.ccfg.EquipSlotIntensifyCfg.getIntensifyInfo(t.slotType,i),s=game.ccfg.EquipSlotIntensifyCfg.getMaxIntensifyLevel(t.slotType,i);n&&a>=n.roleLv&&t.slotLevel<=s&&this._canIntensifyEquipSlots.push(t)}},this),this._canIntensifyEquipSlots},isMaxIntensifyLevel:function(e,t){return game.ccfg.EquipSlotIntensifyCfg.getMaxIntensifyLevel(e,t)<=t},isMaxCanIntensifyLevel:function(e){return game.mainRole.mainRoleData.getLv()<=e},getCostMoney:function(){for(var e,t,i,n,s=this.getCanIntensifyEquipSlots(),a=0,o=0;o<s.length;o++)(n=s[o])&&(e=n.slotLevel+1,(t=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(n.slotType,e))&&(i=t.getCostItemList())&&0<i.length&&(a+=i[0].num));return a},getCanIntensifySlots:function(){this._canIntensifySlots?this._canIntensifySlots.length=0:this._canIntensifySlots=[];var e,t,i,n,s=this.getCanIntensifyEquipSlots(),a=0,o=0;s.sort(this.onSort);for(var r=0;r<s.length;r++)if((n=s[r])&&(e=n.slotLevel+1,(t=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(n.slotType,e))&&(i=t.getCostItemList())&&0<i.length)){if(o<=0&&(o=game.back.getItemInfoCountById(i[0].id)),!((a+=i[0].num)<=o))break;this._canIntensifySlots.push(n)}return this._canIntensifySlots},onSort:function(e,t){return e.slotLevel-t.slotLevel},getCanIntensifySlot:function(){var e=this.getCanIntensifyEquipSlots(),i=!1,n=0,t=game.back.getAmountInfo();if(t&&(n=t.getValue(game.AmountType.SILVER)),n<=0)return!1;for(var s=0;s<e.length;s++){var a=e[s];if(a){var o=a.slotLevel+1,r=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(a.slotType,o);if(r){var h=game.upgrade.getCostMap(r);h&&h.forEach(function(e,t){switch(e=parseInt(e)){case game.AmountType.SILVER:t<n&&(i=!0)}},this)}}}return i},onEquipSlotStarSuccess:function(e,t,i,n){this.curUpStarState=n;var s=this._equipSlotMap.get(e);if(s){if(s.slotStar=i,s.rate=t,this._equipSlotMap.set(e,s),game.notice.show(game.ccfg.LangCfg.getText(0==this.curUpStarState?15010:15011)),0==this.curUpStarState?b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE):game.equip.isUpStaring=!1,s.equip){var a=s.equip.level,o=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(s.slotStar);o&&(s.upStarPower=game.CCommonUtil.getPower(s.equip.baseSpriteStat,a,o.attrRate))}b8e.evt.dptG(game.EquipEvt.EQUIP_UPGRADE_STAR_COMPLETE,{equipSlotInfo:s})}},isMaxEquipUpStar:function(e){var t=this._equipSlotMap.get(e);if(t){var i=game.ccfg.EquipSlotStarCfg.getMaxSlotStar();if(t.slotStar>=i)return!0}return!1},isMaxCanUpStarLevel:function(e){var t=game.mainRole.mainRoleData.getLv(),i=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(e);return!!(i&&t<i.roleLv)},minEquipSlotStarInfo:{get:function(){var e=[],t=this.getHasEquipSlotMap();if((e=t&&0<t.count()?t.values():this._equipSlotMap.values())&&0<e.length){e.sort(this.onSortSlotStar);var i=e[0];if(i)return i}return null}},onSortSlotStar:function(e,t){return e.slotStar>t.slotStar?1:e.slotStar<t.slotStar?-1:e.slotType>t.slotType?1:e.slotType<t.slotType?-1:0},onEquipRefineSuccess:function(e,t,i,n){game.back.setItemInfo(e,t),this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.equip.idx==i&&n&&n.attr&&0<n.attr.length&&(t.equip.setEquipAppendInfo(n.attr),t.equip.appendSpriteStat?t.equip.appendPower=game.CCommonUtil.getPower(t.equip.appendSpriteStat,t.equip.level):t.equip.appendPower=0,this.dstEquip.appendSpriteStat?this.dstEquip.appendPower=game.CCommonUtil.getPower(t.equip.appendSpriteStat,t.equip.level):this.dstEquip.appendPower=0,this._equipSlotMap.set(e,t),this.dstEquip=t.equip)},this),game.back.checkEquipAlert(),game.back.checkItemAlert(),game.notice.show(game.ccfg.LangCfg.getText(15048)),b8e.evt.dptG(game.EquipEvt.EQUIP_REFINE_SUCCESS)},setRefineSpriteStat:function(e){this._leftEquipSpriteStatMap.set(e.type,e)},getRefineSpriteStatByIndex:function(e){return this._leftEquipSpriteStatMap.get(e)},clearRefineSpriteStat:function(){this._leftEquipSpriteStatMap.clear()},delRefineSpriteStat:function(e){this._leftEquipSpriteStatMap.del(e)},getRefineSpriteStatMap:function(){return this._leftEquipSpriteStatMap},getRemainNewSpriteStat:function(){var e=this.srcEquip.appendSpriteStat.getSpriteStats();if(!e||e.length<=0)return null;var t=this._leftEquipSpriteStatMap.values();if(!t||t.length<=0)return null;for(var i=[],n=[],s=0;s<t.length;s++){var a=t[s];a&&i.push(a.type)}for(var o=0;o<e.length;o++){var r=e[o];if(r)-1==i.indexOf(r.type)&&n.push(r.type)}return n},isCanRefine:function(e){if(!this.isHasWearEquipByType(e))return!1;var t,i=e,n=this.getEquipSlotInfoByType(i.type);if(n&&n.equip&&(t=n.equip),!t)return!1;if(!i.appendSpriteStat)return!1;var s=i.appendSpriteStat.getSpriteStats();if(!s||s.length<=0)return!1;game.mainRole.mainRoleData.getLv();return this.isMaxAppendSpriteStat(t)?this.isCanRefineAdvancedEquipment(i,t):this.isHasAddSpriteStat(i,t)?i.level<=t.level||!this.isBetterRoleEquip(i):this.isCanRefineAdvancedEquipment(i,t)},isCanRefineAdvancedEquipment:function(e,t){return e.level<=t.level?this.isBetterEquip(e,t):!this.isBetterRoleEquip(e)&&this.isBetterEquip(e,t)},isMaxAppendSpriteStat:function(e){var t=game.ccfg.EquipQualityCfg.getEquipQualityInfoByQuality(e.quality);return!!t&&e.appendSpriteStatLine>=t.max},isSelectMaxSpriteStat:function(){var e=this.dstEquip;if(!e)return!1;var i=0;this._leftEquipSpriteStatMap&&0<this._leftEquipSpriteStatMap.count()&&this._leftEquipSpriteStatMap.forEach(function(e,t){t&&(i+=1)},this);var t=game.ccfg.EquipQualityCfg.getEquipQualityInfoByQuality(e.quality);return!!t&&i>=t.max},isHasSameSpriteStat:function(e,t){if(!e||!t)return!1;var i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();if(!i||i.length<=0)return!1;if(!n||n.length<=0)return!1;i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();for(var s=0;s<i.length;s++){var a=i[s];if(a)for(var o=0;o<n.length;o++){var r=n[o];if(r&&r.type==a.type)return!0}}return!1},isBetterEquip:function(e,t){if(!e||!t)return!1;var i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();if(!i||i.length<=0)return!0;if(!n||n.length<=0)return!1;i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();for(var s=0;s<i.length;s++){var a=i[s];if(a)for(var o=0;o<n.length;o++){var r=n[o];if(r&&r.type==a.type&&r.value>a.value)return!0}}return!1},isHasAddSpriteStat:function(e,t){if(!e||!t)return!1;var i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();if(!i||i.length<=0)return!0;if(!n||n.length<=0)return!1;i=t.appendSpriteStat.getSpriteStats(),n=e.appendSpriteStat.getSpriteStats();for(var s=0;s<n.length;s++){var a=n[s];if(a)if(this.isHasSpriteStat(i,a.type))return!0}return!1},isHasSpriteStat:function(e,t){for(var i=[],n=0;n<e.length;n++){var s=e[n];s&&i.push(s.type)}return!!(i&&0<i.length)&&-1==i.indexOf(t)},contrastSpriteStat:function(e,t,i){if(!e||!t)return!1;var n=t.appendSpriteStat.getSpriteStats(),s=e.appendSpriteStat.getSpriteStats();return!(!n||n.length<=0)&&(!(!s||s.length<=0)&&t.appendSpriteStat.getStatValue(i)<e.appendSpriteStat.getStatValue(i))},isBeingSpriteStat:function(e,t){return!!t&&!(t.appendSpriteStat.getStatValue(e.type)<=0)},isBetterSpriteStat:function(e,t){if(!e)return!1;if(!this.isBeingSpriteStat(e,t))return!0;var i=t.appendSpriteStat.getStatValue(e.type);return e.value>i},isAddAppendSpriteStat:function(e){var t=!1,i=this.dstEquip;if(i&&i.appendSpriteStat){var n=i.appendSpriteStat.getSpriteStats();t=!n||n.length<=0||this.isHasSpriteStat(n,e.type)}return t},getSpriteStatDataLine:function(e){if(!e)return 0;var t=e.appendSpriteStat.getSpriteStats();return t?t.length:0},srcEquip:{set:function(e){this._srcEquip=e;var t=this.getEquipSlotInfoByType(this._srcEquip.type);t&&t.equip&&(this.dstEquip=t.equip)},get:function(){return this._srcEquip}},getMinEquipLevel:function(){var i=[];if(this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&i.push(t.equip)},this),!i||i.length<=0)return 0;i.sort(this.onSortByEquipLv);var e=i[0];return e?e.level:0},onSortByEquipLv:function(e,t){return e.level<t.level?-1:e.level>t.level?1:0},getMinEquipQuality:function(){var i=[];if(this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&i.push(t.equip)},this),!i||i.length<=0)return-1;i.sort(this.onSortByEquipQuality);var e=i[0];return e?e.quality:-1},onSortByEquipQuality:function(e,t){return e.quality<t.quality?-1:e.quality>t.quality?1:0},getCurEquipQualitySuits:function(){var e=this.getMinEquipLevel(),t=this.getMinEquipQuality();return t<game.Quality.Q_PURPLE&&(t=game.Quality.Q_PURPLE),game.ccfg.EquipQualitySuitsCfg.getSuitsInfoByLevelAndQuality(e,t)},getNextEquipQualitySuits:function(){var e,t=this.getCurEquipQualitySuits();if(!t)return null;var i=t.id;return i++,(e=game.ccfg.EquipQualitySuitsCfg.getSuitsInfoById(i))||(i=t.id+10,e=game.ccfg.EquipQualitySuitsCfg.getSuitsInfoById(i)),e},getCurActiveEquipQualitySuits:function(){var i=0,n=this.getCurEquipQualitySuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.equip.quality>=n.quality&&t.equip.level>=n.level&&i++},this)),i},getNextActiveEquipQualitySuits:function(){var i=0,n=this.getNextEquipQualitySuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.equip.quality>=n.quality&&t.equip.level>=n.level&&i++},this)),i},isActiveEquipQualitySuits:function(){return this.getActiveEquipQualitySuits()>=this.EQUIP_MAX_COUNT},getActiveEquipQualitySuits:function(){var i=0,n=this.getCurEquipQualitySuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.equip.quality>=n.quality&&t.equip.level>=n.level&&i++},this)),i},isMaxEquipQualitySuits:function(){return!this.getNextEquipQualitySuits()},getMinEquipStar:function(){var i=[];if(this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&i.push(t)},this),!i||i.length<=0)return 0;i.sort(this.onSortEquipStar);var e=i[0];return e?e.slotStar:0},onSortEquipStar:function(e,t){return e.slotStar>t.slotStar?1:e.slotStar<t.slotStar?-1:0},getCorrEquipStarSuits:function(){var e,t=this.getMinEquipLevel(),i=game.ccfg.EquipStarSuitsCfg.maxEquipLevel();i<t&&(t=i);var n=this.getMinStarEquipSlotInfo();return n?(e=n.slotStar,t>n.equip.level&&(t=n.equip.level)):e=this.getMinEquipStar(),game.ccfg.EquipStarSuitsCfg.getSuitsInfoByLevelAndStar(t,e)},getMinStarEquipSlotInfo:function(){var i=[];return this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&0<t.slotStar&&i.push(t)},this),i&&0<i.length?(i.sort(this.onSortBySlotStar),i[0]):null},onSortBySlotStar:function(e,t){return e.slotStar>t.slotStar?1:e.slotStar<t.slotStar?-1:0},getNextEquipStarSuits:function(){var e,t=this.getCorrEquipStarSuits();if(!t)return null;var i=t.id;return i++,(e=game.ccfg.EquipStarSuitsCfg.getSuitsInfoById(i))||(i=t.id+30,e=game.ccfg.EquipStarSuitsCfg.getSuitsInfoById(i)),e},getCurActiveEquipStarSuits:function(){var i=0,n=this.getCorrEquipStarSuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.slotStar>=n.star&&t.equip.level>=n.level&&i++},this)),i},getNextActiveEquipStarSuits:function(){var i=0,n=this.getNextEquipStarSuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.slotStar>=n.star&&t.equip.level>=n.level&&i++},this)),i},isActiveEquipStarSuits:function(){return this.getActiveEquipStarSuits()>=this.EQUIP_MAX_COUNT},getActiveEquipStarSuits:function(){var i=0,n=this.getCorrEquipStarSuits();return n&&(!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.slotStar>=n.star&&t.equip.level>=n.level&&i++},this)),i},getFullEquipStarSuits:function(i){var n=0;return!this._equipSlotMap||this._equipSlotMap.count()<=0||this._equipSlotMap.forEach(function(e,t){t&&t.equip&&t.slotStar>=i&&n++},this),n},isMaxEquipStarSuits:function(){return!this.getNextEquipStarSuits()},getEquipStarSuits:function(){var e=this.getCorrEquipStarSuits();return e?this.isMaxEquipStarSuits()?game.ccfg.EquipStarSuitsCfg.maxEquipStar():this.isActiveEquipStarSuits()?e.star:0:0},getSmeltEquipsByQuality:function(e){var t=game.back.getEquipList(),i=[];if(t&&0<t.length)for(var n=0;n<t.length;n++){var s=t[n];s&&s.quality<=game.Quality.Q_YELLOW&&s.quality==e&&this.isCanSmelting(s)&&i.push(s)}return i},getSmeltEquipsByQualitys:function(e){var t=game.back.getEquipList(),i=[];if(t&&0<t.length)for(var n=0;n<t.length;n++){var s=t[n];s&&s.quality<=game.Quality.Q_YELLOW&&-1!=e.indexOf(s.quality)&&this.isCanSmelting(s)&&i.push(s)}return i},getSmeltHightEquips:function(){var e=game.back.getEquipList(),t=[];if(e&&0<e.length)for(var i=0;i<e.length;i++){var n=e[i];n&&n.quality==game.Quality.Q_RED&&this.isCanSmeltingHighEquip(n)&&t.push(n)}return t},isCanSmeltingHighEquip:function(e){if(!e)return!1;var t=game.mainRole.mainRoleData.getLv();return!(e.level<=t&&this.isCanWear(e))},isHasCanIntensifyEq:function(){for(var e=this._equipSlotMap.values(),t=0;t<e.length;t++){var i=e[t];if(i&&!this.isMaxCanIntensifyLevel(i.slotLevel))return!0}return!1},isMaxCanBatchUpgrade:function(){for(var e=this._equipSlotMap.values(),t=0;t<e.length;t++){var i=e[t];if(i&&this.isMaxCanIntensifyLevel(i.slotLevel))return!0}return!1},isHasCanUpStarEquip:function(){var i=[];if(this._equipSlotMap&&this._equipSlotMap.forEach(function(e,t){t&&t.equip&&0<=t.slotStar&&i.push(t)},this),!i||i.length<=0)return!1;i.sort(this.onSortBySlotStar);var e=i[0];if(!e)return!1;if(this.isMaxEquipUpStar(e.slotType))return!1;var t=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(e.slotStar);return!!t&&game.upgrade.costCheck(this,t.upgradeInfo)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_0,null,this.equipAlertFilter_0,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_1,null,this.equipAlertFilter_1,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_2,null,this.equipAlertFilter_2,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_3,null,this.equipAlertFilter_3,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_4,null,this.equipAlertFilter_4,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_5,null,this.equipAlertFilter_5,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_6,null,this.equipAlertFilter_6,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_7,null,this.equipAlertFilter_7,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.EQUIP_INTERSIFY_ALL_ALERT,null,this.intensifyAllAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.EQUIP_UP_STAR_ALERT,null,this.upStarAlert,this)},upStarAlert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.EQUIP_SHENG_XING)||!this.isHasCanUpStarEquip())},intensifyAllAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.EQUIP_MAKE)){var e=game.back.getAmountInfo();e&&e.getValue(game.AmountType.SILVER);var t=!1;if(this.curIntensifySlot||(this.curIntensifySlot=this.minEquipSlotInfo),!this.curIntensifySlot)return!1;var i=game.mainRole.mainRoleData.getLv();if(this.curIntensifySlot.slotLevel>=i)return!1;var n=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(this.curIntensifySlot.slotType,this.curIntensifySlot.slotLevel+1);return n&&(t=game.upgrade.isHasEnoughItem(n)),t}return!1},equipAlertFilter_0:function(){return this.checkEquipAlert(game.GoodsType.WEAPON)},equipAlertFilter_1:function(){return this.checkEquipAlert(game.GoodsType.ARMOR)},equipAlertFilter_2:function(){return this.checkEquipAlert(game.GoodsType.BELT)},equipAlertFilter_3:function(){return this.checkEquipAlert(game.GoodsType.RING)},equipAlertFilter_4:function(){return this.checkEquipAlert(game.GoodsType.HELM)},equipAlertFilter_5:function(){return this.checkEquipAlert(game.GoodsType.NECKLACE)},equipAlertFilter_6:function(){return this.checkEquipAlert(game.GoodsType.LEGGUARD)},equipAlertFilter_7:function(){return this.checkEquipAlert(game.GoodsType.SHOE)},checkEquipAlert:function(e){var t=game.back.getItemListByType(e),i=this.getEquipSlotInfoByType(e);if(!t||0==t.length||!i)return!1;for(var n=game.mainRole.mainRoleData.getLv(),s=i.equip,a=null,o=0;o<t.length;o++)if(a=t[o],s){if(a.basePower>s.basePower&&a.level<=n)return!0}else if(a.level<=n)return!0;return!1},isHighEquip:function(e){var t=this.getEquipSlotInfoByType(e);return!(!t||!t.equip)&&t.equip.isHighEquip},isHighestEquipHighest:function(e){var t=this.getEquipSlotInfoByType(e);if(!t||!t.equip)return!1;var i=t.equip,n=game.ccfg.GlobalParamCfg.getNumber(1001);return i.level>=n},getBestHighEquipInfo:function(e){for(var t=null,i=game.mainRole.mainRoleData.getLv(),n=game.ccfg.HighEquipCfg.getDatasByEquipType(e),s=0,a=0;a<n.length;++a)if(!((s=a+1)>=n.length)&&n[s]&&n[a]&&n[a].level<=i){if(n[s].level>=i){t=n[a];continue}if(s==n.length-1&&n[s].level<i){t=n[s];break}}return t},getNextGradeHighEquip:function(e){var t=this.getEquipSlotInfoByType(e);if(!t)return i;var i=null,n=t.equip;if(!n)return i;for(var s=0,a=game.ccfg.HighEquipCfg.getDatasByEquipType(e),o=0;o<a.length;++o)(s=o+1)>=a.length||a[s]&&a[o]&&a[o].level==n.level&&(i=a[s]);return i},getCurEquipInfoByType:function(e){var t=this.getEquipSlotInfoByType(e);return t&&t.equip?t.equip:null},getPawerByEquipId:function(e){var t=game.ccfg.ItemInfoCfg.getLevelById(e),i=game.ccfg.ItemInfoCfg.getBaseAttrId(e),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i);return game.CCommonUtil.getPower(n,t)},onCombineEquipSuccess:function(){b8e.evt.dptG(game.EquipEvt.PLAY_HIGHEQUIPEFFECT,{isUpgrade:!1})},onEquipUpGradeSuccess:function(e){if(e){var t=game.ItemInfoUtil.createItemInfo(e);if(t){var i=this._equipSlotMap.get(t.type);if(i)if(i.equip=t,i.equip){var n=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(i.slotStar);n?i.upStarPower=game.CCommonUtil.getPower(i.equip.baseSpriteStat,i.equip.level,n.attrRate):i.upStarPowe=0}else i.upStarPowe=0;this.setEquipSlotInfo(i.slotType,i),b8e.evt.dptG(game.EquipEvt.PUT_ON_EQUIP,{equipSlotInfo:i}),b8e.evt.dptG(game.EquipEvt.UPDATE_HIGHEQUIPPANEL),b8e.evt.dptG(game.EquipEvt.PLAY_HIGHEQUIPEFFECT,{isUpgrade:!0})}game.back.checkEquipAlert(),game.back.checkItemAlert()}},getHighEquipSpotAlertByType:function(e){var t=this.getEquipSlotInfoByType(e);if(!t)return!1;var i=t.equip;if(!i||!i.isHighEquip){var n=this.getBestHighEquipInfo(e);return!!n&&this.isCanGetHighEquipById(n.itemId,!1)}if(this.isHighestEquipHighest(e))return!1;var s=this.getNextGradeHighEquip(e);return!!s&&this.isCanGetHighEquipById(s.itemId,!0)},isCanGetHighEquipById:function(e){var t=0;t=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?game.ccfg.HighEquipCfg.getupgradeCostByItemId(e):game.ccfg.HighEquipCfg.getobtainCostByItemId(e);var i=game.ccfg.HighEquipCfg.getCostItemId(e),n=game.back.getItemInfoById(i);if(n&&n.num>=t){var s=game.mainRole.mainRoleData.getLv();if(game.ccfg.HighEquipCfg.getLevelByItemId(e)<=s)return!0}return!1},isCanResolveEquip:function(){var e=this.getSmeltHightEquips();return!!(e&&0<e.length)},isCanGetHighEquip:function(){if(!this._equipSlotMap)return!1;var i=!1;return this._equipSlotMap.forEach(function(e,t){i||(i=this.getHighEquipSpotAlertByType(e))},this),i},checkHighEquipSpotAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.HIGHEQUIP)){var e=this.isShowHighEquipAlert;(e=!(!this.isCanGetHighEquip()&&!this.isCanResolveEquip()))!=this.isShowHighEquipAlert&&(this.isShowHighEquipAlert=e,b8e.evt.dptG(game.EquipEvt.HIGHEQUIP_SPORTALERT))}},getHighEquipAllLevel:function(){var i=0;return this._equipSlotMap.forEach(function(e,t){t.equip&&t.equip.isHighEquip&&(i+=t.equip.level)},this),i},isHighEquipSpotAlert:function(){return this.isShowHighEquipAlert},onEquipEnchantSuccess:function(e){if(e){var t=e.type,i=this._equipSlotMap.get(t);if(i){var n=game.mainRole.mainRoleData.getLv();if(i.enchant=e.enchant,i.enchant){var s=game.ccfg.EquipSlotEnchantCfg.getDataId(i.slotType,i.enchant),a=game.ccfg.EquipSlotEnchantCfg.getAttrById(s),o=game.ccfg.SpriteStatCfg.getSpriteStatById(a);o?(i.enchantSpriteStat=o,i.enchantPower=game.CCommonUtil.getPower(i.enchantSpriteStat,n)):i.enchantPower=0}this._equipSlotMap.set(t,i),b8e.evt.dptG(game.EquipEvt.PUT_ON_EQUIP,{equipSlotInfo:i}),b8e.evt.dptG(game.EquipEvt.ENCHANT_SUCCESS)}}},isEquipSlotEnchantByType:function(e){var t=this._equipSlotMap.get(e);return!!t&&t.isenchant},checkisCanEnchantByType:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(this.isEquipSlotEnchantByType(e))return!1;var i=game.ccfg.EquipSlotEnchantCfg.getDataId(e,t),n=game.ccfg.EquipSlotEnchantCfg.getCostItemNum(i),s=game.ccfg.EquipSlotEnchantCfg.getCostItemId(i),a=game.back.getItemInfoById(s);return!!(a&&a.num>=n)},checkEnchantAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.ENCHANT)){var i=!1;this._equipSlotMap.forEach(function(e,t){i||(i=this.checkisCanEnchantByType(e))},this),i!=this.isShowEnchantAlert&&(this.isShowEnchantAlert=i,b8e.evt.dptG(game.EquipEvt.ENCHANT_SPORTALERT))}},getAllEquipSlotEnchantPower:function(){var i=0;return this._equipSlotMap.forEach(function(e,t){i+=t.enchantPower},this),i}}),game.EquipMgr._instance=null,game.EquipMgr._singleton=!0,game.EquipMgr.inst=function(){return game.EquipMgr._instance||(game.EquipMgr._singleton=!1,game.EquipMgr._instance=new game.EquipMgr,game.EquipMgr._singleton=!0),game.EquipMgr._instance}},{}],315:[function(e,t,i){"use strict";e("./EquipMgr")},{"./EquipMgr":314}],316:[function(e,t,i){"use strict";game.EquipEnchantPage=game.SkinUI.extends({_curSlotType:41,_slotgridMap:null,_curgridItem:null,_materialInfoName:"",_enchantEffect:null,ctor:function(){this._super("equip/EquipEnchantPageSkin","EquipEnchantPageSkin"),this._slotgridMap=b8e.HashMap.get()},init:function(){var i,n;game.equip.getEquipSlotMap().forEach(function(e,t){n=this._skin["equipGrids_"+e],(i=game.GridUtil.creatItemGrid(this,n)).gridInfo=new game.GridInfo(game.ContainerId.EQUIP_ENCHAN_ID),i.fnOnClick(this,this.onClickGrid),game.GridUtil.setEquipSlotGrid(i,t),i.sortLayer(),this._slotgridMap.set(e,i)},this),this._curgridItem=game.GridUtil.creatItemGrid(this,this._skin.showEquipNode),this._curgridItem.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_ENCHAN_ID);var e=game.equip.getEquipSlotInfoByType(this._curSlotType);game.GridUtil.setEquipSlotGrid(this._curgridItem,e),this._curgridItem.sortLayer(),this._materialGrid=game.GridUtil.creatItemGrid(this,this._skin.cost_icon),this._materialGrid.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this._materialGrid.fnOnClick(this,this.onClickMaterialGrid)},onClickGrid:function(e){if(e&&e.faceInfo){var t=e.faceInfo;this._curSlotType=t.slotType;var i=game.equip.getEquipSlotInfoByType(this._curSlotType);game.GridUtil.setEquipSlotGrid(this._curgridItem,i);var n=this._skin["equipGrids_"+this._curSlotType];n&&this._skin.imgSeletBg.setPosition(n.x,n.y),this.update()}},onClickMaterialGrid:function(e){e&&e.faceInfo&&""!=e.faceInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e.faceInfo,num:e.faceInfo.num})},onShow:function(){this.update(),b8e.evt.onC(this._skin.enchantBnt,this.onEnchant,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateMaterialData),b8e.evt.addG(this,game.EquipEvt.ENCHANT_SUCCESS,this.onEnchantSuccess)},onHide:function(){b8e.evt.offC(this._skin.enchantBnt,this.onEnchant,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateMaterialData),b8e.evt.rmvG(this,game.EquipEvt.ENCHANT_SUCCESS,this.onEnchantSuccess)},update:function(){if(this._skin&&this._slotgridMap){var i=!1;this._slotgridMap.forEach(function(e,t){i=game.equip.isEquipSlotEnchantByType(e),t.setEqEnchantIcon(i),i?t.setName("已注魂",game.html.Q_YELLOW):t.setName("")},this),this.updateCurSlotInfo(),this.updateMaterialData()}},updateCurSlotInfo:function(){if(this._skin){this._skin.lab_power.string=game.equip.getAllEquipSlotEnchantPower(),this._skin.equipTypeName.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this._curSlotType);var e=game.equip.isEquipSlotEnchantByType(this._curSlotType);this._curgridItem.setEqEnchantIcon(e),this._curgridItem.sortLayer();var t=game.ccfg.EquipSlotEnchantCfg.getDataId(this._curSlotType),i=game.ccfg.EquipSlotEnchantCfg.getAttrById(t),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i),s=this.getSpriteStatStr(n);this._skin.lab_curAttr.string=s}},updateMaterialData:function(){if(this._skin){var e=game.ccfg.EquipSlotEnchantCfg.getDataId(this._curSlotType),t=game.ccfg.EquipSlotEnchantCfg.getCostItemNum(e),i=game.ccfg.EquipSlotEnchantCfg.getCostItemId(e),n=game.ccfg.ItemInfoCfg.getItemInfoById(i),s="",a=0,o=game.back.getItemInfoById(i);o&&(a=o.num);var r=game.equip.isEquipSlotEnchantByType(this._curSlotType);this._skin.enchantCost.string=r?"--/--":t<=a?game.ccfg.LangCfg.getText(3e4,[a,t]):game.ccfg.LangCfg.getText(30003,[a,t]),n&&(game.GridUtil.setItemGrid(this._materialGrid,n),this._materialGrid.sortLayer(),this._materialInfoName=n.name,s=game.html.getText(game.html.getColorByQuality(n.quality),n.name)),this._skin.costName.string=s,this._slotgridMap.forEach(function(e,t){(r=game.equip.isEquipSlotEnchantByType(e))?t.setRedIcon(!1):t.setRedIcon(game.equip.checkisCanEnchantByType(e)),t.sortLayer()},this)}},onEnchantSuccess:function(){this.playEffect(),this.update()},onEnchant:function(){game.equip.isEquipSlotEnchantByType(this._curSlotType)?game.notice.show("此装备槽已经注魂！"):game.equip.checkisCanEnchantByType(this._curSlotType)?game.EquipSender.reqEquipEnchant(this._curSlotType):game.notice.show(game.ccfg.LangCfg.getText(15053,[this._materialInfoName]))},getSpriteStatStr:function(e){var t,i,n="",s="",a="",o=e.getSpriteStats();if(o&&0<o.length)for(t=0;t<o.length&&t<3;t++){if(i=o[t])s=game.ccfg.AttrRulesCfg.getAttrNameByType(i.type),a=t!=o.length-1?"\n":"",n+=s+"  +"+i.value+a}return n},playEffect:function(){this._enchantEffect||(this._enchantEffect=b8e.BaseDisplay.get(),this._enchantEffect.addToParent(this._skin.effect_node));var e=game.ClientCfg.getUIFxs("10083");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.ENCHANT_EFFECT,1),this._enchantEffect.addChild(this._anim)),this._enchantEffect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._enchantEffect&&this._enchantEffect.setVisible(!1)},onCompleteEffect:function(e){this._enchantEffect.setVisible(!1)}})},{}],317:[function(e,t,i){"use strict";game.appModule.EquipForgePanel=game.SkinUIPanel.extends({_intensifyPanel:null,_upStarPanel:null,_enchantPage:null,_index:-1,_curPanel:null,ctor:function(e){this._super(e)},getButtonByName:function(e,t){var i;switch(e){case"qiangHua":return!this._intensifyPanel||!(i=this._intensifyPanel.getButtonByName("btnQiangHua"))||i;case"btnAutoQiangHua":return!this._intensifyPanel||!(i=this._intensifyPanel.getButtonByName("btnAutoQiangHua"))||i;case"back":return!this._skin||this._skin.closeBtnReturn}return null},onShow:function(){this.data?this._index=this.data:-1==this._index&&(this._index=0),this._skin.buttonToggle[this._index].check(),this.onEnchantAlertChange(),this.onSpotAlertChange(),this.onSelectPanelByIndex(this._index),this.updateEquipStarInfo(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickIntensify,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickUpStar,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickEnchant,this),b8e.evt.onC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.EquipEvt.ENCHANT_SPORTALERT,this.onEnchantAlertChange),b8e.evt.addG(this,game.EquipEvt.PUT_ON_EQUIP,this.updateEquipStarInfo)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickIntensify,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickUpStar,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickEnchant,this),b8e.evt.offC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.EquipEvt.ENCHANT_SPORTALERT,this.onEnchantAlertChange),b8e.evt.rmvG(this,game.EquipEvt.PUT_ON_EQUIP,this.updateEquipStarInfo)},onSpotAlertChange:function(){this._skin.intersifyAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.EQUIP_INTERSIFY_ALL_ALERT),this._skin.upStarAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.EQUIP_UP_STAR_ALERT)},onEnchantAlertChange:function(){this._skin.enchantAlert.active=game.equip.isShowEnchantAlert},onClickIntensify:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_QIANG_HUA)){if(0==this._index)return;this.onSelectPanelByIndex(0)}else this._skin.buttonToggle[this._index].check()},onClickUpStar:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_SHENG_XING)){if(1==this._index)return;this.onSelectPanelByIndex(1)}else this._skin.buttonToggle[this._index].check()},onClickEnchant:function(){if(game.funcOpen.checkOpenWithTips(game.FunctionType.ENCHANT)){if(2==this._index)return;this.onSelectPanelByIndex(2)}else this._skin.buttonToggle[this._index].check()},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"1"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"2"!=e||(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]))},onSelectPanelByIndex:function(e){switch(this._curPanel&&this._curPanel.hide(),this._index=e,this._index){case 0:this._intensifyPanel||(this._intensifyPanel=new game.EquipIntensifyPanel(this._skin,this._skin.equipIntensifyGroup),this._intensifyPanel.addToParent(this._skin.panelNode)),this._intensifyPanel.show(),this._curPanel=this._intensifyPanel;break;case 1:this._upStarPanel||(this._upStarPanel=new game.EquipUpStarPanel(this._skin,this._skin.equipUpStarGroup),this._upStarPanel.addToParent(this._skin.panelNode)),this._upStarPanel.show(),this._curPanel=this._upStarPanel;break;case 2:this._enchantPage||(this._enchantPage=new game.EquipEnchantPage,this._enchantPage.addToParent(this._skin.panelNode)),this._enchantPage.show(),this._curPanel=this._enchantPage}},updateEquipStarInfo:function(){var e=game.equip.getEquipStarSuits();this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!1,this._skin.yueliang.active=!1,this._skin.taiyang.active=!1,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!1;var t=game.ccfg.StarCfg.getStarInfo(e,game.StarType.EQUIP_UP_STAR);if(!t)return this._skin.xingxingGray.active=!0,void(this._skin.labStar.string=e);switch(t.iconType){case game.StarIconType.XINGXING:this._skin.xingxing.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.YUELIANG:this._skin.yueliang.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.TAIYANG:this._skin.taiyang.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.HUANGGUANG:this._skin.huangguan.active=!0,this._skin.labStar.node.active=!0;break;default:this._skin.xingxingGray.active=!0}this._skin.labStar.string=e},onOpenEquipStarSuitsTips:function(){game.app.show(game.AppConstant.EQUIP_SUITS_TIPS,game.equip.STAR_SUITS)}})},{}],318:[function(e,t,i){"use strict";game.EquipIntensifyPanel=game.SkinUI.extends({_equipItemArr:null,itemGrid:null,_curSelectSlotType:-1,_curSelectEquipSlotInfo:null,_effectDisplay:null,_anim:null,_effectArr:null,_animArr:null,_materialGrid:null,ctor:function(e,t){this._super(e,"","","",t),this._equipItemArr=[],this._effectArr=[],this._animArr=[]},getButtonByName:function(e){switch(e){case"btnQiangHua":return!this._skin||this._skin.btnStartIntensify;case"btnAutoQiangHua":return!this._skin||this._skin.btnAutoIntensify}return null},onShow:function(){this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.equipIntensifyGroup_imgIcon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_INTENSIFY_CENTER_CONTAINER_ID)),this._effectDisplay||(this._effectDisplay=b8e.BaseDisplay.get(),this._effectDisplay.addToParent(this._skin.equipIntensify_effect)),this._materialGrid||(this._materialGrid=game.GridUtil.creatItemGrid(this,this._skin.material_icon),this._materialGrid.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this._materialGrid.fnOnClick(this,this.onClickMaterialGrid));for(var e=this._effectArr.length,t=0;t<game.equip.EQUIP_MAX_COUNT;t++)if(e<=t){var i=b8e.BaseDisplay.get();i.addToParent(this._skin["effect_"+t]);var n=b8e.Animator.get(game.AnimatorType.EQUIP_INTENSIFY_EFFECT_2,1);i.addChild(n),this._effectArr.push(i),this._animArr.push(n)}game.equip.isIntensifying=!1,this._skin.imgCenterSelect.active=!1,this._skin.imgSelect.opacity=0,this.updateInfo(),this.updatePower(),this.onSpotAlertChange(),this.onCheckEquipTotalAlert(),b8e.evt.onC(this._skin.btnStartIntensify,this.onStartIntensify,this),b8e.evt.onC(this._skin.btnAutoIntensify,this.onAutoIntensify,this),b8e.evt.onC(this._skin.btnStopAutoIntensify,this.onStopAutoIntensify,this),b8e.evt.addG(this,game.EquipEvt.EQUIP_INTENSISY_SUCCESS,this.onEquipIntensifySuccess),b8e.evt.addG(this,game.EquipEvt.ALL_EQUIP_INTENSISY_SUCCESS,this.onAllEquipIntensifySuccess),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateUpgradeInfoByAmount)},onHide:function(){this._skin.imgCenterSelect.active=!1,this._skin.imgSelect.opacity=0,this._skin.equipIntensifyGroup_labSlotType.string="",this._iconSprite&&this._iconSprite.unloadTexture(),game.equip.isIntensifying=!1,this.clearEquipItem(),this._curSelectEquipSlotInfo=null,this.clearEffect(),this.clearEquipInsifyEffect(),game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btnStartIntensify,this.onStartIntensify,this),b8e.evt.offC(this._skin.btnAutoIntensify,this.onAutoIntensify,this),b8e.evt.offC(this._skin.btnStopAutoIntensify,this.onStopAutoIntensify,this),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_INTENSISY_SUCCESS,this.onEquipIntensifySuccess),b8e.evt.rmvG(this,game.EquipEvt.ALL_EQUIP_INTENSISY_SUCCESS,this.onAllEquipIntensifySuccess),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateUpgradeInfoByAmount)},onSpotAlertChange:function(){this._skin.intersifyAllAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.EQUIP_INTERSIFY_ALL_ALERT)},onCheckEquipTotalAlert:function(){if(this._curSelectEquipSlotInfo){var e=game.equip.getCostMoney(),t=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(this._curSelectEquipSlotInfo.slotType,this._curSelectEquipSlotInfo.slotLevel);if(t){var i=t.getCostItemList();if(i&&0<i.length){var n=game.ccfg.ItemInfoCfg.getItemInfoById(i[0].id);if(n){var s=game.back.getItemInfoCountById(n.id);this._skin.intersifyTotalAlert.active=e<=s}}}}else this._skin.intersifyTotalAlert.active=!1},onClickMaterialGrid:function(e){e&&e.faceInfo&&""!=e.faceInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e.faceInfo,num:e.faceInfo.num})},updateInfo:function(){if(!(0<arguments.length&&void 0!==arguments[0]&&arguments[0])){var e=game.equip.minEquipSlotInfo;e&&(game.equip.curIntensifySlot=e,this._curSelectEquipSlotInfo=e)}this._curSelectEquipSlotInfo&&this.updatePanelInfo(this._curSelectEquipSlotInfo),this.updateGridsInfo()},updateUpgradeInfoByAmount:function(){this._curSelectEquipSlotInfo&&(this.updateUpgradeInfo(this._curSelectEquipSlotInfo),this.onCheckEquipTotalAlert())},updatePanelInfo:function(e){e&&(game.equip.isMaxIntensifyLevel(e.slotType,e.slotLevel)?(this.onSetActiveState(!0),this._skin.img_jiantou.active=!1,this._skin.labCurIntensifyLv.node.active=!1,this._skin.lab_curAttr.node.active=!1,this._skin.labMaxIntensifyLv.node.active=!0,this._skin.lab_maxAttr.node.active=!0,this.onUpdateMaxAttrInfo(e),this._skin.equipIntensifyGroup_labMaxDesc.string=game.ccfg.LangCfg.getText(15015)):(this.onSetActiveState(!1),this._skin.labCurIntensifyLv.node.active=!0,this._skin.lab_curAttr.node.active=!0,this._skin.labMaxIntensifyLv.node.active=!1,this._skin.lab_maxAttr.node.active=!1,this.updateAttrInfo(e),this.updateUpgradeInfo(e),this.updateAllUpgradeInfo()),this.onSelectEquipSlot(this._curSelectEquipSlotInfo))},updatePower:function(){var i=0,e=game.equip.getEquipSlotMap();e&&e.forEach(function(e,t){t&&(i+=t.intensifyPower)},this),this._skin.lab_power.string=i},onSetActiveState:function(e){this._skin.intensifyNode.active=!e,this._skin.labMaxIntensifyLv.node.active=e,this._skin.equipIntensifyGroup_labMaxDesc.node.active=e},onEquipIntensifySuccess:function(e){if(e&&e.data&&(this.playEffect(),e.data.equipSlotInfo)){var t=e.data.equipSlotInfo.slotType,i=game.equip.getEquipSlotInfoByType(t);if(i)for(var n=0;n<this._equipItemArr.length;n++){var s=this._equipItemArr[n];s.faceInfo.slotType==i.slotType&&(s.setTRLabel("+"+s.faceInfo.slotLevel,4294967295,game.ClientCfg.digits4_0),s.setTRLPos(-5,-5),this.playEquipInsifyEffectByIndex(n))}this.updatePanelInfo(i),this.updatePower(),this.updateInfo()}},playEffect:function(){var e=game.ClientCfg.getUIFxs("10002");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.EQUIP_INTENSIFY_EFFECT,1),this._effectDisplay.addChild(this._anim)),this._effectDisplay.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteEffect:function(e){game.equip.isIntensifying=!1,this._effectDisplay.setVisible(!1)},clearEffect:function(){this._anim&&this._anim.stop(),this._effectDisplay&&this._effectDisplay.setVisible(!1)},onAllEquipIntensifySuccess:function(e){this.playEffect(),this.updateInfo(!0),this.updatePower(),this.playEquipInsifyEffectByIndex(-1),this.onCheckEquipTotalAlert()},updateGridsInfo:function(){this.clearEquipItem();var e=this._equipItemArr.length,t=game.equip.getEquipSlotMap();if(t){var i=t.values();if(!i||i.length<=0)return;for(var n=0;n<i.length;n++){var s=i[n];if(s){var a,o=this._skin["equipGrids_"+n];n<e?a=this._equipItemArr[n]:((a=game.GridUtil.creatItemGrid(this,o)).gridInfo=new game.GridInfo(game.ContainerId.EQUIP_INTENSIFY_CONTAINER_ID),this._equipItemArr.push(a)),game.GridUtil.setEquipSlotGrid(a,s),a.sortLayer()}}}},playEquipInsifyEffectByIndex:function(e){if(-1==e){var t=game.equip.effectSlots;if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=game.equip.getEquipSlotInfoByType(t[i].type);if(n)game.ccfg.EquipSlotIntensifyCfg.isMaxIntensifyLevel(n.slotType,n.slotLevel)||this.playEffectByIndex(n.slotIndex)}}else this.playEffectByIndex(e)},playEffectByIndex:function(e){var t=game.ClientCfg.getUIFxs("10006"),i=this._effectArr[e];if(i){var n=this._animArr[e];n&&(t?(i.setVisible(!0),n.load(t),n.addFinishCallback(this.onCompleteEffect2,this,[i]),n.play(null,0)):n&&n.clear())}},onCompleteEffect2:function(e,t){t.setVisible(!1)},clearEquipInsifyEffect:function(){var e;for(e=0;e<this._effectArr.length;e++){var t=this._effectArr[e];t&&t.setVisible(!1)}for(e=0;e<this._animArr.length;e++){var i=this._animArr[e];i&&i.stop()}},onClickGrid:function(e){e&&e.faceInfo&&(this._curSelectEquipSlotInfo=e.faceInfo,this._curSelectEquipSlotInfo&&-1!=this._curSelectEquipSlotInfo.slotIndex&&(this._skin.imgSelect.opacity=0,this.onSelectEquipSlot(this._curSelectEquipSlotInfo),this.updatePanelInfo(this._curSelectEquipSlotInfo)))},onSelectEquipSlot:function(e){this._skin.imgCenterSelect.active=!0,b8e.Tween.kill(this._skin.imgSelect),b8e.Tween.get(this._skin.imgSelect).to({opacity:255},50,b8e.Ease.quadIn).call(this.onTweenEnd,this,[e]),this.updateCenterGridsData(e)},onTweenEnd:function(e){b8e.Tween.kill(this._skin.imgSelect);var t=e.slotIndex;-1!=t&&(this._skin.imgSelect.x=this._skin["equipGrids_"+t].x,this._skin.imgSelect.y=this._skin["equipGrids_"+t].y)},updateCenterGridsData:function(e){if(e){game.equip.getEquipTotalPower();this._skin.equipIntensifyGroup_labSlotType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(e.slotType);game.equip.getEquipIconByType(e.slotType);game.GridUtil.setEquipSlotGrid(this.itemGrid,e),this.itemGrid.sortLayer()}},updateAttrInfo:function(e){if(e){this._skin.labCurIntensifyLv.string=game.ccfg.LangCfg.getText(15017,[e.slotLevel]);var t=e.intensifySpriteStat,i=e.slotLevel+1;this._skin.labNextIntensifyLv.string=game.ccfg.LangCfg.getText(15017,[i]);var n=game.ccfg.EquipSlotIntensifyCfg.getIntensifyAttrId(e.slotType,i),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n);if(t&&s&&(this._skin.lab_curAttr.string=this.getSpriteCompare(t,s)),e.slotLevel<=0){var a="",o="",r="";if(s){var h=s.getSpriteStats();if(h&&0<h.length)for(var g=0;g<h.length;g++){var l=h[g];l&&(o=game.ccfg.AttrRulesCfg.getAttrNameByType(l.type),g!=h.length-1&&(r="\n"),game.html.getText(game.html.Q_BLUE,o+":     0"),a+=game.html.getText(game.html.Q_BLUE,o+":     0")+game.html.getText(game.html.Q_GREEN,"  (+"+l.value+")")+r)}}this._skin.lab_curAttr.string=a}}},onUpdateMaxAttrInfo:function(e){if(e){this._skin.labMaxIntensifyLv.string=game.ccfg.LangCfg.getText(15017,[e.slotLevel]);var t=e.intensifySpriteStat;t&&(this._skin.lab_maxAttr.string=this.getSpriteStatAttrStr(t))}},getSpriteStatAttrStr:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i="",n="",s="";if(e){var a=e.getSpriteStats();if(a&&0<a.length)for(var o=0;o<a.length;o++){var r=a[o];r&&(n=game.ccfg.AttrRulesCfg.getAttrNameByType(r.type),o!=a.length-1&&(s="\n"),i+=t?n+"     +"+r.value+s:"+"+r.value+s)}}return i},getSpriteCompare:function(e,t){var i="",n="",s="";if(e&&t){var a=e.getSpriteStats(),o=t.getSpriteStats();if(o&&0<o.length)for(var r=0;r<o.length;r++){var h=a[r],g=o[r];if(h){if(n=game.ccfg.AttrRulesCfg.getAttrNameByType(h.type),g){r!=o.length-1&&(s="\n");var l=game.html.getText(game.html.Q_BLUE,n+":     "+Math.round(h.value)),c=Math.round(g.value-h.value);i+=l+game.html.getText(game.html.Q_GREEN,"  (+"+c+")")+s}}else if(g)n=game.ccfg.AttrRulesCfg.getAttrNameByType(g.type),r!=o.length-1&&(s="\n"),i+=(l=game.html.getText(game.html.Q_BLUE,n+":     0"))+game.html.getText(game.html.Q_GREEN,"  (+"+g.value+")")+s}}return i},updateUpgradeInfo:function(e){if(e){var t="",i="",n=e.slotLevel+1,s=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(e.slotType,n);if(s){var a=s.getCostItemList();if(a&&0<a.length){var o=game.ccfg.ItemInfoCfg.getItemInfoById(a[0].id);if(o)game.GridUtil.setItemGrid(this._materialGrid,o),this._materialGrid.sortLayer(),t=game.upgrade.isHasEnoughItem(s)?[[game.back.getItemInfoCountById(o.id),game.html.Q_GREEN],[" / "+a[0].num,game.html.GRAY_WHITE]]:[[game.back.getItemInfoCountById(o.id),game.html.Q_RED],[" / "+a[0].num,game.html.GRAY_WHITE]],i=game.html.getText(game.html.getColorByQuality(o.quality),o.name)}this._skin.labIntensifyCost.string=game.html.getColorfulText(t),this._skin.material_name.string=i}}},updateAllUpgradeInfo:function(){var e=game.equip.getCostMoney(),t=0,i=game.back.getAmountInfo();i&&(t=i.getValue(game.AmountType.SILVER));game.upgrade.getMoneyNameByType(game.AmountType.SILVER);var n=[];n=e<=t?[game.html.getText(game.html.Q_GREEN,e)]:[game.html.getText(game.html.Q_RED,e)],this._skin.labAutoIntensifyCost.string=game.ccfg.LangCfg.getText("$",n)},clearEquipItem:function(){for(var e=0;e<this._equipItemArr.length;e++){var t=this._equipItemArr[e];t&&game.GridUtil.setEquipSlotGrid(t,null)}},onStartIntensify:function(){this._curSelectEquipSlotInfo?game.equip.isMaxCanIntensifyLevel(this._curSelectEquipSlotInfo.slotLevel)?game.notice.show(15019):this.intensify(this._curSelectEquipSlotInfo):game.notice.show(15018)},intensify:function(e){this._curSelectSlotType=e.slotType;var t=0;t=0==e.slotLevel?1:e.slotLevel;var i=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(e.slotType,t);i&&game.upgrade.costCheck(this,i,this.onIsPass,!0)},onIsPass:function(e){e&&-1!=this._curSelectSlotType&&(game.equip.isIntensifying=!0,game.EquipSender.reqEquipSlotUpgrade(this._curSelectSlotType))},onAutoIntensify:function(){if(this._curSelectEquipSlotInfo){for(var e,t=0;t<this._equipItemArr.length;t++){var i=this._equipItemArr[t];if(i.faceInfo)if(!game.equip.isMaxCanIntensifyLevel(i.faceInfo.slotLevel)){e=i.faceInfo;break}}if(e){var n=game.equip.getCanIntensifySlots();if(n&&0<n.length){var s,a=n.length;if(7<a)game.EquipSender.reqEquipSlotBatchUpgrade();else for(t=0;t<a;t++)(s=n[t])&&this.intensify(s)}else{var o=0;o=0==e.slotLevel?1:e.slotLevel;var r=game.ccfg.EquipSlotIntensifyCfg.getIntensifyUpgradeInfo(e.slotType,o);if(r){var h=r.getCostItemList();if(h&&0<h.length){var g=game.ccfg.ItemInfoCfg.getItemInfoById(h[0].id);if(g)if(game.back.getItemInfoCountById(g.id)<h[0].num){var l=game.ccfg.ItemInfoCfg.getNameById(h[0].id);l=game.html.getText(game.html.Q_RED,l),game.notice.show("消耗的$不足",[l]),game.upgrade.isOpenGoToPanel(h[0].id,h[0].num)}}}}}else game.notice.show(15016)}else game.notice.show(15018)},onStopAutoIntensify:function(){}})},{}],319:[function(e,t,i){"use strict";game.appModule.EquipRefineAlert=game.SkinUIPanel.extends({_equipInfo:null,ctor:function(e){this._super(e)},getButtonByName:function(e){},onShow:function(){this.data&&(this._equipInfo=this.data),this.showInfo(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.fnButtonToggleClick,this),b8e.evt.onC(this._skin.btnOk,this.onBtnOkClick,this),b8e.evt.onC(this._skin.btnNo,this.onBtnNoClick,this)},onHide:function(){b8e.evt.offC(this._skin.buttonToggle[0].node,this.fnButtonToggleClick,this),b8e.evt.offC(this._skin.btnOk,this.onBtnOkClick,this),b8e.evt.offC(this._skin.btnNo,this.onBtnNoClick,this)},showInfo:function(){},onBtnOkClick:function(){this._equipInfo&&(game.equip.srcEquip=this._equipInfo,game.app.show(game.AppConstant.EQUIP_REFINE_PANEL)),this.hide()},onBtnNoClick:function(){this.hide()},fnButtonToggleClick:function(){game.equip.isShowRefineAlert=this._skin.buttonToggle[0].isChecked}})},{}],320:[function(e,t,i){"use strict";game.EquipRefineItem=game.SkinUI.extends({isChecked:!1,_clickFun:null,_thisArg:null,statData:null,isLeft:!1,index:-1,_isLeftChecked:!1,_isRightChecked:!1,ctor:function(e){this._super("equip/EquipRefineItemSkin","EquipRefineItemSkin"),this.isLeft=e},onShow:function(){this._skin.img_bg_1.active=!1,this.isLeft?(this.setLeftEquipData(this.index,this.statData),this.setIsSelectLeftItem(this._isLeftChecked)):(this.setRightEquipData(this.index,this.statData),this.setIsSelectRightItem(this._isRightChecked),null!=this._isRightImgBgGray&&this.setRightImgBgGray(this._isRightImgBgGray),b8e.evt.onC(this._skin.img_bg,this.onClick,this),b8e.evt.onC(this._skin.img_gou,this.onClick,this),b8e.evt.onC(this._skin.lab_content.node,this.onClick,this),b8e.evt.onC(this._skin.imgSelect,this.onClick,this))},onHide:function(){this.isLeft||(b8e.evt.offC(this._skin.img_bg,this.onClick,this),b8e.evt.offC(this._skin.img_gou,this.onClick,this),b8e.evt.offC(this._skin.lab_content.node,this.onClick,this),b8e.evt.offC(this._skin.imgSelect,this.onClick,this))},fnOnClick:function(e,t){this._thisArg=e,this._clickFun=t},onClick:function(e){game.equip.isInRefining?game.notice.show(15021):this._clickFun&&(this.isChecked?this.isChecked=!1:this.isChecked=!0,b8e.Tween.kill(this),b8e.Tween.get(this).to({scaleX:.95,scaleY:.95},80).call(this.onTweenComplete,this),this._clickFun.call(this._thisArg,this,!0))},onTweenComplete:function(){b8e.Tween.kill(this),b8e.Tween.get(this).to({scaleX:1,scaleY:1},80)},setData:function(e){this.data=e},setLeftEquipData:function(e,t){if(this.index=e,this.statData=t,this._skin){this._skin.img_bg.active=!1,this._skin.img_gou.active=!1;var i=game.equip.dstEquip;if(t){var n=game.ccfg.AttrRulesCfg.getAttrNameByType(t.type);n=game.ccfg.EquipRefineColorCfg.getColorStr(i.level,t.type,t.value,n+" +"+t.value),this._skin.lab_content.string=n}else game.equip.isMaxAppendSpriteStat(i)?this._skin.lab_content.string="":e<i.appendMax?this._skin.lab_content.string=game.ccfg.LangCfg.getText(15022):this._skin.lab_content.string=""}},setIsSelectLeftItem:function(e){this._isLeftChecked=e,this._skin&&(this._skin.imgSelect.opacity=this._isLeftChecked?255:0,this._skin.img_gou.active=this._isLeftChecked)},setRightEquipData:function(e,t){if(this.index=e,this.statData=t,this._skin)if(this._skin.img_bg.active=!1,this._skin.img_gou.active=!1,t){var i=game.equip.srcEquip,n=game.equip.dstEquip;game.equip.isHasSameSpriteStat(i,n)?game.equip.contrastSpriteStat(i,n,t.type)?this._skin.img_bg.active=!0:this._skin.img_bg.active=!1:this._skin.img_bg.active=!0;var s=game.ccfg.AttrRulesCfg.getAttrNameByType(t.type);s=game.ccfg.EquipRefineColorCfg.getColorStr(i.level,t.type,t.value,s+" +"+t.value),this._skin.lab_content.string=s}else this._skin.lab_content.string=""},setIsSelectRightItem:function(e){this._isRightChecked=e,this.isChecked=e,this._skin&&(this._skin.img_gou.active=this._isRightChecked)},setRightImgBgGray:function(e){this._isRightImgBgGray=e,this._skin&&(this._skin.img_bg_1.active=this._isRightImgBgGray,this._skin.img_bg.active=!this._isRightImgBgGray)}})},{}],321:[function(e,t,i){"use strict";game.appModule.EquipRefinePanel=game.SkinUIPanel.extends({MAX_LINE:6,_leftItemGrid:null,_rightItemGrid:null,_leftItemVec:null,_rightItemVec:null,_effectDisplay:null,_anim:null,_rightEffectDisplay:null,_rightAnim:null,_upgradeInfo:null,ctor:function(e){this._super(e)},init:function(){this._upgradeInfo=new game.UpgradeInfo,this._leftItemVec=[],this._rightItemVec=[],this._leftItemGrid=game.GridUtil.creatItemGrid(this,this._skin.left_img_icon),this._leftItemGrid.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_REFINE_LEFT_CONTAINER_ID),this._rightItemGrid=game.GridUtil.creatItemGrid(this,this._skin.right_img_icon),this._rightItemGrid.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_REFINE_RIGHT_CONTAINER_ID),this._effectDisplay=b8e.BaseDisplay.get(),this._effectDisplay.addToParent(this._skin.effect),this._anim=b8e.Animator.get(game.AnimatorType.EQUIP_REFINE_EFFECT,1),this._effectDisplay.addChild(this._anim),this._rightEffectDisplay=b8e.BaseDisplay.get(),this._rightEffectDisplay.addToParent(this._skin.right_effect),this._rightAnim=b8e.Animator.get(game.AnimatorType.EQUIP_REFINE_RIGHT_EFFECT,1),this._rightEffectDisplay.addChild(this._rightAnim),this.initEquipList()},initEquipList:function(){var e,t,i;for(t=0;t<this.MAX_LINE;t++)(e=new game.EquipRefineItem(!0)).addToParent(this._skin.itemNode),e.fnOnClick(this,this.fnOnClickLeftItem),i=485-60*t,e.setPosition(20,i),e.show(),this._leftItemVec.push(e);for(this._leftItemVec&&this._leftItemVec.length&&this._leftItemVec.sort(this.onSortByIndex),t=0;t<this.MAX_LINE;t++)(e=new game.EquipRefineItem(!1)).addToParent(this._skin.itemNode),e.fnOnClick(this,this.fnOnClickRightItem),i=485-60*t,e.setPosition(308,i),e.show(),this._rightItemVec.push(e);this._rightItemVec&&this._rightItemVec.length&&this._rightItemVec.sort(this.onSortByIndex)},onSortByIndex:function(e,t){return e.index>t.index?1:e.index<t.index?-1:0},onShow:function(){this._skin.left_diff_lab_fight.string="";var e=game.upgrade.getMoneyNameByType(game.AmountType.SILVER);this._skin.lab_cost.string=game.ccfg.LangCfg.getText(15024,[e,0]),this.updateInfo(),b8e.evt.onC(this._skin.btn_refine,this.onStartRefine,this),b8e.evt.addG(this,game.EquipEvt.EQUIP_REFINE_SUCCESS,this.onRefineSuccess)},onHide:function(){game.equip.isInRefining=!1,this.clearData(),this.resetLeftItem(),this.resetRightItem(),this.clearEffect(),this.clearRightEffect(),b8e.evt.offC(this._skin.btn_refine,this.onStartRefine,this),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_REFINE_SUCCESS,this.onRefineSuccess)},updateInfo:function(){this.onUpdateLeftEquipinfo(),this.onUpdateRightEquipinfo(),this.onSelectDefault()},onSelectDefault:function(){if(this._rightItemVec&&!(this._rightItemVec.length<=0))for(var e=0;e<this._rightItemVec.length;e++){var t=this._rightItemVec[e];t&&(t.isChecked=!0,this.fnOnClickRightItem(t,!1))}},onUpdateLeftEquipinfo:function(){var e=game.equip.dstEquip;e?(this._skin.left_lab_name.string=game.ccfg.ItemInfoCfg.getQualityNameById(e.id),game.GridUtil.setItemGrid(this._leftItemGrid,e),this._leftItemGrid.sortLayer(),this._skin.left_lab_fight.string=e.appendPower,this.setLeftEquipInfo()):game.GridUtil.setItemGrid(this._leftItemGrid,null)},setLeftEquipInfo:function(){var e=game.equip.dstEquip;if(e){if(e.appendSpriteStat)var t=e.appendSpriteStat.getSpriteStats();for(var i=0;i<this.MAX_LINE;i++){var n,s=this._leftItemVec[i];if(s)n=!t||t.length-1<i?null:t[i],s.setLeftEquipData(i,n),s.setData(n),n&&game.equip.setRefineSpriteStat(n)}}},fnOnClickLeftItem:function(e){},onUpdateRightEquipinfo:function(){var e=game.equip.srcEquip;e?(this._skin.right_lab_name.string=game.ccfg.ItemInfoCfg.getQualityNameById(e.id),game.GridUtil.setItemGrid(this._rightItemGrid,e),this._rightItemGrid.sortLayer(),this._skin.right_lab_fight.string=e.appendPower,this.setRightEquipInfo()):game.GridUtil.setItemGrid(this._rightItemGrid,null)},setRightEquipInfo:function(){var e=game.equip.srcEquip;if(e){if(e.appendSpriteStat)var t=e.appendSpriteStat.getSpriteStats();for(var i=0;i<this.MAX_LINE;i++){var n,s=this._rightItemVec[i];if(s)n=!t||t.length-1<i?null:t[i],s.setRightEquipData(i,n),s.setData(n)}}},fnOnClickRightItem:function(e,t){if(e&&e.statData){var i=game.equip.dstEquip;if(game.equip.isBetterSpriteStat(e.statData,i)){var n,s;if(e.isChecked)if(game.equip.isSelectMaxSpriteStat()){if(game.equip.isAddAppendSpriteStat(e.statData))return e.isChecked=!1,t&&game.notice.show(15025),void this.setMaxSelectState(e);game.equip.isBetterSpriteStat(e.statData,i)&&((s=this.getLeftSameItem(e.statData)).setIsSelectLeftItem(e.isChecked),s.setData(e.statData),e.setIsSelectRightItem(e.isChecked),game.equip.setRefineSpriteStat(e.statData))}else{if(game.equip.isAddAppendSpriteStat(e.statData)){var a=this.getFirstNoStatDataItem();a.setIsSelectLeftItem(e.isChecked),a.setData(e.statData),e.setIsSelectRightItem(e.isChecked),game.equip.setRefineSpriteStat(e.statData)}else(s=this.getLeftSameItem(e.statData)).setIsSelectLeftItem(e.isChecked),s.setData(e.statData),e.setIsSelectRightItem(e.isChecked),game.equip.setRefineSpriteStat(e.statData);this.setMaxSelectState(e)}else{if(game.equip.isSelectMaxSpriteStat()&&!game.equip.getRefineSpriteStatByIndex(e.statData.type)&&game.equip.isAddAppendSpriteStat(e.statData))return e.isChecked=!1,void game.notice.show(15025);if(s=this.getLeftSameItem(e.statData))if(s.setIsSelectLeftItem(e.isChecked),e.setIsSelectRightItem(e.isChecked),game.equip.isAddAppendSpriteStat(e.statData)){for(s.setData(null),game.equip.delRefineSpriteStat(e.statData.type),n=0;n<this._rightItemVec.length;n++){var o=this._rightItemVec[n];o&&(o.statData&&game.equip.isAddAppendSpriteStat(o.statData)&&o.setRightImgBgGray(!1))}this.layoutLeftAttr()}else{var r=i.appendSpriteStat.getStatDataByType(e.statData.type);game.equip.setRefineSpriteStat(r),s.setData(r)}}this.updateNextPower(),this.updateAmountInfo()}else e.isChecked=!1}else e.isChecked=!1},setMaxSelectState:function(e){if(game.equip.isAddAppendSpriteStat(e.statData)&&game.equip.isSelectMaxSpriteStat())for(var t=game.equip.getRemainNewSpriteStat(),i=0;i<t.length;i++)for(var n=t[i],s=0;s<this._rightItemVec.length;s++)(e=this._rightItemVec[s])&&e.statData&&game.equip.isAddAppendSpriteStat(e.statData)&&(e.statData.type==n?e.setRightImgBgGray(!0):e.setRightImgBgGray(!1))},isMaxLeftData:function(){var e=game.equip.dstEquip;if(!e)return!1;if(!this._leftItemVec||this._leftItemVec.length<=0)return!1;for(var t=0,i=0;i<this._leftItemVec.length;i++)this._leftItemVec[i].data&&(t+=1);var n=game.ccfg.EquipQualityCfg.getEquipQualityInfoByQuality(e.quality);return!!n&&t>=n.max},getFirstNoStatDataItem:function(){if(!this._leftItemVec||this._leftItemVec.length<=0)return null;for(var e,t=0;t<this._leftItemVec.length;t++)if(!(e=this._leftItemVec[t]).data)return e;return null},getLeftSameItem:function(e){if(this._leftItemVec&&0<this._leftItemVec.length)for(var t=0;t<this._leftItemVec.length;t++){var i=this._leftItemVec[t];if(i&&i.data&&e.type==i.data.type)return i}return null},layoutLeftAttr:function(){if(this._leftItemVec&&!(this._leftItemVec.length<=0))for(var e,t,i=0;i<this._leftItemVec.length;i++){var n=this._leftItemVec[i];n&&(e||n.data||(e=n),e&&!t&&n.data&&(t=n,e.setIsSelectLeftItem(!0),e.setData(n.data),t.setIsSelectLeftItem(!1),t.setData(null)))}},onRefineSuccess:function(){this.playRightEffect()},updateEquipPower:function(){var e=game.equip.srcEquip,t=game.equip.dstEquip;e&&(this._skin.right_lab_fight.string=e.appendPower),t&&(this._skin.left_lab_fight.string=t.appendPower)},updateNextPower:function(){var a=0,o=game.equip.dstEquip,e=game.equip.getRefineSpriteStatMap();if(e&&!(e.count()<=0)){e.forEach(function(e,t){if(t){var i=game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(t.type);if(i){var n=game.ccfg.LvPowerCoefCfg.getLvCoefByLv(o.level),s=game.ValueUtil.getDigitsValueByNum(i.coef,4);switch(i.type){case game.AttrPowerCoefType.TYPE_0:a+=t.value*s;break;case game.AttrPowerCoefType.TYPE_1:a+=t.value*s*n}}}},this);var t=Math.round(a)-o.appendPower;this._skin.left_diff_lab_fight.string=0<t?"+"+t:""}},playEffect:function(){var e=game.ClientCfg.getUIFxs("10026");e?(this._effectDisplay.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteEffect:function(e){this._effectDisplay.setVisible(!1),game.equip.isInRefining=!1;var t=game.equip.srcEquip;game.equip.isCanRefine(t)||this.hide()},delayHidePanel:function(){this.hide()},clearEffect:function(){this._anim&&this._anim.stop(),this._effectDisplay&&this._effectDisplay.setVisible(!1)},getConfIds:function(){for(var e=[],t=game.equip.srcEquip,i=0;i<this._rightItemVec.length;i++){var n=this._rightItemVec[i];if(n&&n.isChecked&&n.statData){var s=t.getConfId(n.statData);e.push(s)}}return e},getRefineCostMoney:function(){for(var e=this.getConfIds(),i=0,t=0;t<e.length;t++){var n=e[t];if(n){var s=game.ccfg.EquipRefineCfg.getDataById(n);if(s&&s.costItems&&(this._upgradeInfo.setUpgradeInfo(s.costItems),this._upgradeInfo)){var a=game.upgrade.getCostMap(this._upgradeInfo);if(!a)continue;a.forEach(function(e,t){switch(e=parseInt(e)){case game.AmountType.SILVER:i+=t}},this)}}}return i},updateAmountInfo:function(){var e=this.getRefineCostMoney(),t=0,i=game.back.getAmountInfo();i&&(t=i.getValue(game.AmountType.SILVER));var n=game.upgrade.getMoneyNameByType(game.AmountType.SILVER),s=[];s=e<=t?[game.html.getText(game.html.Q_GREEN,n),game.html.getText(game.html.Q_GREEN,e)]:[game.html.getText(game.html.Q_RED,n),game.html.getText(game.html.Q_RED,e)],this._skin.lab_cost.string=game.ccfg.LangCfg.getText(15024,s)},onStartRefine:function(){if(game.equip.isInRefining)game.notice.show(15021);else if(!(i=this.getConfIds())||i.length<=0)game.notice.show(15026);else{var e=game.equip.srcEquip;if(e){var t=game.equip.dstEquip;if(t){var i,n=this.getRefineCostMoney();if(game.upgrade.costCheckMoney(game.AmountType.SILVER,n,!0,!1))(i=this.getConfIds())&&0<i.length&&(game.equip.isInRefining=!0,game.EquipSender.reqEquipRefine(e.idx,t.idx,i))}}}},clearData:function(){game.GridUtil.setItemGrid(this._leftItemGrid,null),game.GridUtil.setItemGrid(this._rightItemGrid,null),game.equip.clearRefineSpriteStat()},resetLeftItem:function(){if(this._leftItemVec&&!(this._leftItemVec.length<=0))for(var e=0;e<this._leftItemVec.length;e++){var t=this._leftItemVec[e];t&&(t.setIsSelectLeftItem(!1),t.setData(null))}},resetRightItem:function(){if(this._rightItemVec&&!(this._rightItemVec.length<=0))for(var e=0;e<this._rightItemVec.length;e++){var t=this._rightItemVec[e];t&&(t.isChecked=!1,t.setRightImgBgGray(!1))}},playRightEffect:function(){var e=game.ClientCfg.getUIFxs("10085");e?(this._rightEffectDisplay.setVisible(!0),this._rightAnim.load(e),this._rightAnim.addFinishCallback(this.onCompleteRightEffect,this),this._rightAnim.play(null,0)):this._rightAnim&&this._rightAnim.clear()},onCompleteRightEffect:function(e){this._rightEffectDisplay.setVisible(!1),game.equip.clearRefineSpriteStat(),this.resetLeftItem(),this.resetRightItem(),this.updateInfo(),this.updateNextPower(),this.updateAmountInfo(),this.playEffect()},clearRightEffect:function(){this._rightAnim&&this._rightAnim.stop(),this._rightEffectDisplay&&this._rightEffectDisplay.setVisible(!1)}})},{}],322:[function(e,t,i){"use strict";game.EquipSelectItem=game.SkinUI.extends({_curEquipInfo:null,itemGrid:null,ctor:function(){this._super("equip/EquipSelectItemSkin","EquipSelectItemSkin")},getWidth:function(){return 530},getHeight:function(){return 150},getButtonByName:function(e){switch(e){case"btn_change":return!this._skin||this._skin.btn_change}return null},onShow:function(){this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_SELECT_WEAR_CONTAINER_ID)),this.setData(this._curEquipInfo),b8e.evt.onC(this._skin.btn_change,this.onChangeEquip,this)},onHide:function(){game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btn_change,this.onChangeEquip,this)},setData:function(e){if((this._curEquipInfo=e)&&this._skin){this.clearData(),game.GridUtil.setItemGrid(this.itemGrid,this._curEquipInfo),this.itemGrid.sortLayer(),this._skin.img_equipIcon.active=!1,game.equip.isCanWear(this._curEquipInfo)?this._skin.img_redPoint.active=!0:this._skin.img_redPoint.active=!1;var t=game.ccfg.ItemInfoCfg.getQualityColorById(this._curEquipInfo.id);this._skin.lab_name.string=game.html.getText(t,this._curEquipInfo.name),this._skin.lab_level.string=game.ccfg.LangCfg.getText(15027,[e.level]),this._skin.lab_curEquip.node.active=!1,this._skin.lab_fight.string=e.basePower,this.onUpdateEquipAttr(e)}},onUpdateEquipAttr:function(e){var t="",i="",n="";if(e.baseSpriteStat){var s=e.baseSpriteStat.getSpriteStats();if(s&&0<s.length)for(var a=0;a<s.length;a++){var o=s[a];o&&(i=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type),a!=s.length-1&&(n="\n"),t+=i+"  +"+o.value+n)}}this._skin.lab_attr.string=t},onChangeEquip:function(){this._curEquipInfo&&game.equip.wearEquip(this._curEquipInfo)},clearData:function(){this._skin.lab_name.string="",this._skin.lab_level.string="",this._skin.img_equipIcon.active=!1,this._skin.img_redPoint.active=!1,this._skin.lab_curEquip.node.active=!1,this._skin.lab_fight.string="",this._skin.lab_attr.string=""}})},{}],323:[function(e,t,i){"use strict";game.appModule.EquipSelectPanel=game.SkinUIPanel.extends({_curType:null,itemGrid:null,_listPos1:0,_listPos2:0,_view1:0,_view2:0,list:null,_equipList:null,ctor:function(e){this._super(e),this._equipList=[],this._listPos1=770,this._view1=640,this._listPos2=605,this._view2=480},getButtonByName:function(e){var t;switch(e){case"equipItemChangeBtn":if(this._list){var i=this._list.getItemRender(0);if(i&&(t=i.getButtonByName("btn_change")))return t}return!0}return null},onShow:function(){this.data&&(this._curType=this.data),this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon)),this._list||(this._list=new b8e.List(this._skin.list,game.EquipSelectItem)),this._list.show(),this._skin.lab_desc.string="",this._skin.cur_equip_node.active=!1;var e=game.equip.getEquipSlotInfoByType(this._curType);e.equip?(this._skin.cur_equip_node.active=!0,this._skin.list.node.y=this._listPos2,this._skin.list.node.height=this._view2,this._skin.view.height=this._view2,this.setCurEquipData(e.equip)):(this._skin.list.node.y=this._listPos1,this._skin.list.node.height=this._view1,this._skin.view.height=this._view1),this.updateInfo(),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},onHide:function(){this.clearData(),this._list&&this._list.hide(),game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},setCurEquipData:function(e){if(!e)return this._skin.lab_name.string="--",this._skin.lab_level.string=game.ccfg.LangCfg.getText(15028),this._skin.lab_fight.string="--",this._skin.lab_attr.string="--",void game.GridUtil.setItemGrid(this.itemGrid,null);game.GridUtil.setItemGrid(this.itemGrid,e),this.itemGrid.sortLayer();var t=game.ccfg.ItemInfoCfg.getQualityColorById(e.id);this._skin.lab_name.string=game.html.getText(t,e.name),this._skin.lab_level.string=game.ccfg.LangCfg.getText(15027,[e.level]),this._skin.lab_fight.string=e.basePower,this.onUpdateEquipAttr(e)},onUpdateEquipAttr:function(e){var t="",i="",n="";if(e.baseSpriteStat){var s=e.baseSpriteStat.getSpriteStats();if(s&&0<s.length)for(var a=0;a<s.length;a++){var o=s[a];o&&(i=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type),a!=s.length-1&&(n="\n"),t+=i+"  +"+o.value+n)}}this._skin.lab_attr.string=t},clearData:function(){this._skin.lab_name.string="",this._skin.lab_level.string="",this._skin.lab_fight.string="",this._skin.lab_attr.string="",this._iconSprite&&this._iconSprite.unloadTexture()},updateInfo:function(){this._equipList.length=0,this._curType&&(this._equipList=game.back.getFitEquipByType(this._curType),this._equipList&&0<this._equipList.length?(this._skin.lab_desc.string="",this._equipList.sort(this.onSortByPowers)):this._skin.lab_desc.string=game.ccfg.LangCfg.getText(15029)),this._list.setData(this._equipList)},onSortByPowers:function(e,t){return e.basePower>t.basePower?-1:e.basePower<t.basePower?1:e.quality>t.quality?-1:e.quality<t.quality?1:0}})},{}],324:[function(e,t,i){"use strict";game.appModule.EquipTips=game.SkinUIPanel.extends({_equipInfo:null,itemGrid:null,_btn_wearDefaultX:0,_btn_wearCenterX:0,_btn_sellDefaultX:0,_btn_sellCenterX:0,_btn_refinDefaultX:0,_btn_refinCenterX:0,ctor:function(e){this._super(e),this._btn_wearDefaultX=70,this._btn_wearCenterX=120,this._btn_sellDefaultX=276,this._btn_sellCenterX=195,this._btn_refinDefaultX=110,this._btn_refinCenterX=195},getButtonByName:function(e){switch(e){case"refining":return!this._skin||this._skin.btn_refining}return null},onShow:function(){this._equipInfo=this.data,this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID)),this._skin.btn_refining.active=!1,this.updateInfo(),b8e.evt.onC(this._skin.btn_wear,this.onWearEquip,this),b8e.evt.onC(this._skin.btn_refining,this.onRefiningEquip,this),b8e.evt.onC(this._skin.btn_sell,this.onSellEquip,this)},onHide:function(){this._skin.lab_itemName.string="",this._skin.lab_itemType.string="",this._skin.lab_desc.string="",this._skin.lab_lv.string="",this._skin.img_redPoint.active=!1,this._skin.btn_refining.active=!1,this._skin.lab_fight.string="",game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btn_wear,this.onWearEquip,this),b8e.evt.offC(this._skin.btn_refining,this.onRefiningEquip,this),b8e.evt.offC(this._skin.btn_sell,this.onSellEquip,this)},onWearEquip:function(){this._equipInfo&&game.equip.wearEquip(this._equipInfo),this.hide()},onRefiningEquip:function(){game.equip.srcEquip=this._equipInfo,game.app.show(game.AppConstant.EQUIP_REFINE_PANEL),this.hide()},onSellEquip:function(){if(this._equipInfo)if(game.equip.isCanSmelting(this._equipInfo)||!game.equip.isRoleEquip(this._equipInfo))game.back.reqSellEquip([this._equipInfo.idx]),this.hide();else{var e=new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoBtn,e.string=game.ccfg.LangCfg.getText(15030),e.confirmString="确 认",e.cancelString="取 消",e.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,e)}},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:this._equipInfo&&(game.back.reqSellEquip([this._equipInfo.idx]),this.hide())}},updateInfo:function(){if(this._equipInfo){this._skin.lab_itemName.string=game.ccfg.ItemInfoCfg.getQualityNameById(this._equipInfo.id),this._skin.lab_itemType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this._equipInfo.type);var e="";e=game.mainRole.mainRoleData.getLv()>=this._equipInfo.level?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(15027,[this._equipInfo.level])):game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(15027,[this._equipInfo.level])),this._skin.lab_lv.string=e,game.equip.isCanWear(this._equipInfo)?(this._skin.img_redPoint.active=!0,this._skin.btn_refining.active=!1,this._skin.btn_wear.x=this._btn_wearCenterX,this._skin.btn_sell.x=this._btn_sellCenterX):(game.equip.isBetterEquip(this._equipInfo)?this._skin.img_redPoint.active=!0:this._skin.img_redPoint.active=!1,game.funcOpen.checkOpen(game.FunctionType.EQUIP_TI_LIAN)&&game.equip.isCanRefine(this._equipInfo)?(this._skin.btn_refining.active=!0,this._skin.btn_wear.x=this._btn_wearDefaultX,this._skin.btn_sell.x=this._btn_sellDefaultX,this._skin.btn_refining.x=this._btn_refinDefaultX):(this._skin.btn_refining.active=!1,this._skin.btn_wear.x=this._btn_wearCenterX,this._skin.btn_sell.x=this._btn_sellCenterX)),this._skin.lab_fight.string=this._equipInfo.power,game.GridUtil.setItemGrid(this.itemGrid,this._equipInfo),this.itemGrid.clearEffect(),this.itemGrid.sortLayer(),this.onUpdateEquipAttr()}},onUpdateEquipAttr:function(){var e=game.ccfg.LangCfg.getText(15031),t=this.getEquipSpriteStatStr(this._equipInfo.baseSpriteStat,!1);this._equipInfo.isHighEquip&&this._equipInfo.highSpriteStat&&(t+=game.ccfg.LangCfg.getText(15049),t+=this.getEquipSpriteStatStr(this._equipInfo.highSpriteStat,!0,!0)),this._equipInfo.appendSpriteStat&&0<this._equipInfo.appendSpriteStatLine&&(t+=game.ccfg.LangCfg.getText(15032),t+=this.getEquipSpriteStatStr(this._equipInfo.appendSpriteStat,!0)),this._skin.lab_desc.string=e+t;var i=this._skin.lab_desc.node.height+30;this._skin.bg_2.height=i,this._skin.top_node.y=this._skin.bg_2.y+this._skin.bg_2.height+40,this.height=this._skin.bg.node.height=this._skin.top_node.y+this._skin.top_node.height+20,this.resetPosition()},getEquipSpriteStatStr:function(e,t){var i,n,s=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a="",o="",r="",h=e.getSpriteStats();if(h&&0<h.length)for(i=0;i<h.length;i++)if(n=h[i]){o=game.ccfg.AttrRulesCfg.getAttrNameByType(n.type),r=i!=h.length-1?"\n":"";var g=n.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(n.type).format){case game.AttrRulesFormat.FORMAT_1:g=n.value;break;case game.AttrRulesFormat.FORMAT_2:g=game.ValueUtil.getDigitsValueByNum(100*n.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:g=game.ValueUtil.getDigitsValueByNum(100*n.value,2)}if(s){a+=game.html.getText(game.html.Q_RED,"    "+o+" "+g);continue}a+=t?"    "+(o=game.ccfg.EquipRefineColorCfg.getColorStr(this._equipInfo.level,n.type,g,o+" "+g))+r:"    "+o+" "+g+r}return a}})},{}],325:[function(e,t,i){"use strict";game.EquipUpStarPanel=game.SkinUI.extends({_curSelectEquipSlotInfo:null,_costItemGrid:null,_itemInfo:null,_effectDisplay:null,_anim:null,_timer:null,_equipItemArr:null,itemGrid:null,_curSelectSlotType:-1,ctor:function(e,t){this._super(e,"","","",t),this._equipItemArr=[]},onShow:function(){if(this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.equipUpGroup_imgIcon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.EQUIP_UP_STAR_CENTER_CONTAINER_ID)),this._costItemGrid||(this._costItemGrid=game.GridUtil.creatItemGrid(this,this._skin.equipUpStarGroup_imgIcon),this._costItemGrid.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this._costItemGrid.fnOnClick(this,this.onClick)),this._effectDisplay||(this._effectDisplay=b8e.BaseDisplay.get(),this._effectDisplay.addToParent(this._skin.equipUpStar_effect)),game.equip.isUpStaring=!1,this._skin.lab_no_equip.node.active=!1,this._skin.imgCenterSelect.active=!1,this._skin.imgSelect1.opacity=0,this._skin.img_checkmark.active=game.equip.isAutoBuy,game.equip.curUpStarSlot)this._curSelectEquipSlotInfo=game.equip.curUpStarSlot;else{var e=game.equip.minEquipSlotStarInfo;e&&(game.equip.curUpStarSlot=e,this._curSelectEquipSlotInfo=e)}this.onSetPanelState(),this.updateGridsInfo(),this._curSelectEquipSlotInfo&&(this.updateInfo(),this.updatePower()),this.onSelectEquipSlot(this._curSelectEquipSlotInfo),b8e.evt.onC(this._skin.btnStartUpStar,this.onUpStar,this),b8e.evt.onC(this._skin.btnAutoUpStar,this.onAutoUpStar,this),b8e.evt.onC(this._skin.btnStopAutoUpStar,this.onAutoStopAutoUpStar,this),b8e.evt.onC(this._skin.autoBuyNode,this.onUpdateIsAutoBuy,this),b8e.evt.addG(this,game.EquipEvt.SELECT_UP_STAR_EQUIP,this.onSelectUpStarEquip),b8e.evt.addG(this,game.EquipEvt.EQUIP_UPGRADE_STAR_COMPLETE,this.onEquipUpgradeStarComplete),b8e.evt.addG(this,game.EquipEvt.EQUIP_STOP_UP_STAR,this.onStopUpStar),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateUpgradeInfo),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateUpgradeInfo)},onHide:function(){game.equip.isUpStaring=!1,this.onAutoStopAutoUpStar(),this.clearData(),this.clearEffect(),b8e.evt.offC(this._skin.btnStartUpStar,this.onUpStar,this),b8e.evt.offC(this._skin.btnAutoUpStar,this.onAutoUpStar,this),b8e.evt.offC(this._skin.btnStopAutoUpStar,this.onAutoStopAutoUpStar,this),b8e.evt.offC(this._skin.autoBuyNode,this.onUpdateIsAutoBuy,this),b8e.evt.rmvG(this,game.EquipEvt.SELECT_UP_STAR_EQUIP,this.onSelectUpStarEquip),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_UPGRADE_STAR_COMPLETE,this.onEquipUpgradeStarComplete),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_STOP_UP_STAR,this.onStopUpStar),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateUpgradeInfo),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateUpgradeInfo)},updateGridsInfo:function(){this.clearEquipItem();var e=this._equipItemArr.length,t=game.equip.getEquipSlotMap();if(t){var i=t.values();if(!i||i.length<=0)return;for(var n=0;n<i.length;n++){var s=i[n];if(s){var a,o=this._skin["equipUpGrids_"+n];n<e?a=this._equipItemArr[n]:((a=game.GridUtil.creatItemGrid(this,o)).gridInfo=new game.GridInfo(game.ContainerId.EQUIP_UP_STAR_CONTAINER_ID),a.fnOnClick(this,this.onClickGrid),this._equipItemArr.push(a)),game.GridUtil.setEquipSlotGrid(a,s,!0,!1,!1,s.slotStar),a.setStarBarPos(0,-5),a.sortLayer()}}}},clearEquipItem:function(){for(var e=0;e<this._equipItemArr.length;e++){var t=this._equipItemArr[e];t&&game.GridUtil.setEquipSlotGrid(t,null)}},onSetPanelState:function(){this._skin.max_lab_level.node.active=!1,this._skin.max_lab_attr.node.active=!1,this._skin.lab_rate_desc.node.active=!1,this._skin.equipUpStarGroup_labMaxDesc.node.active=!1,this._skin.btnStartUpStar.active=!0,this._skin.btnAutoUpStar.active=!0,this._skin.btnStopAutoUpStar.active=!1},onClickGrid:function(e){e&&e.faceInfo&&(game.equip.isAutoUpStar&&this.onAutoStopAutoUpStar(),this._curSelectEquipSlotInfo&&this._curSelectEquipSlotInfo.slotType==e.faceInfo.slotType||(this._curSelectEquipSlotInfo=e.faceInfo,this._curSelectEquipSlotInfo&&-1!=this._curSelectEquipSlotInfo.slotIndex&&(this._skin.imgSelect1.opacity=0,this.onSelectEquipSlot(this._curSelectEquipSlotInfo),this.updateInfo())))},onSelectEquipSlot:function(e){this._skin.imgCenterSelect.active=!0,b8e.Tween.kill(this._skin.imgSelect1),b8e.Tween.get(this._skin.imgSelect1).to({opacity:255},50,b8e.Ease.quadIn).call(this.onTweenEnd,this,[e]),this.updateCenterGridsData(e)},onTweenEnd:function(e){b8e.Tween.kill(this._skin.imgSelect1);var t=e.slotIndex;-1!=t&&(this._skin.imgSelect1.x=this._skin["equipUpGrids_"+t].x,this._skin.imgSelect1.y=this._skin["equipUpGrids_"+t].y)},updateCenterGridsData:function(e){if(e){this._curSelectSlotType=e.slotType;game.equip.getEquipTotalPower();this._skin.equipUpGroup_labSlotType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(e.slotType);game.equip.getEquipIconByType(e.slotType);game.GridUtil.setEquipSlotGrid(this.itemGrid,e,!0,!1,!1,e.slotStar),this.itemGrid.setStarBarPos(0,-30),this.itemGrid.sortLayer()}},onUpdateIsAutoBuy:function(){this._skin.img_checkmark.active?(this._skin.img_checkmark.active=!1,game.equip.isAutoBuy=!1):(this._skin.img_checkmark.active=!0,game.equip.isAutoBuy=!0)},clearData:function(){game.equip.isAutoUpStar&&this.onAutoStopAutoUpStar(),this._curSelectEquipSlotInfo=null,game.equip.curUpStarSlot=null},onSelectUpStarEquip:function(e){e&&(this._curSelectEquipSlotInfo=game.equip.curUpStarSlot,this._curSelectEquipSlotInfo&&this.updateInfo())},playEffect:function(){var e=game.ClientCfg.getUIFxs("10012");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.EQUIP_UPSTAR_EFFECT,1),this._effectDisplay.addChild(this._anim)),this._effectDisplay.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteEffect:function(e){game.equip.isUpStaring=!1,this._effectDisplay.setVisible(!1)},clearEffect:function(){this._anim&&this._anim.stop(),this._effectDisplay&&this._effectDisplay.setVisible(!1)},onEquipUpgradeStarComplete:function(e){if(e&&e.data){if(e.data.equipSlotInfo){var t=e.data.equipSlotInfo.slotType,i=game.equip.getEquipSlotInfoByType(t);if(i)for(var n=0;n<this._equipItemArr.length;n++){var s=this._equipItemArr[n];s.faceInfo.slotType==i.slotType&&(game.GridUtil.setEquipSlotGrid(s,i,!0,!1,!1,i.slotStar),s.setStarBarPos(0,-5),s.sortLayer())}this._curSelectEquipSlotInfo=e.data.equipSlotInfo,this.updateCenterGridsData(this._curSelectEquipSlotInfo)}this.updateInfo(!0),this.updatePower(),game.equip.isAutoUpStar&&(game.equip.autoUpStarEnd=!0)}},updateInfo:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(game.equip.isMaxEquipUpStar(this._curSelectEquipSlotInfo.slotType))this.onSetUpStarState(!0),this._skin.lab_rate.string=game.ccfg.LangCfg.getText(15033),this.onUpdateMaxEquipSlotInfo(),this._skin.btnStartUpStar.active=!1,this._skin.btnAutoUpStar.active=!1;else{this.onSetUpStarState(!1),game.equip.isAutoUpStar||(this._skin.btnStartUpStar.active=!0,this._skin.btnAutoUpStar.active=!0);var t=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curSelectEquipSlotInfo.slotStar);if(e)if(0==game.equip.curUpStarState)this.updateDefaultUpStarRate(),this.playEffect(),this.onAutoStopAutoUpStar();else{if(t){var i=100*t.failAddRate;this._skin.lab_rate_desc.string=game.ccfg.LangCfg.getText(15034,[game.ValueUtil.getDigitsValueByNum(i,1)])}var n=0,s=game.equip.getEquipSlotInfoByType(this._curSelectEquipSlotInfo.slotType);s&&0!=s.rate&&(n=s.rate/10),this._skin.lab_rate.string=game.ccfg.LangCfg.getText(15035,[game.ValueUtil.getDigitsValueByNum(n,1)])}else this.updateDefaultUpStarRate();this.onUpdateLeftEquipSlotInfo(),this.onUpdateRgithEquipSlotInfo(),this._curSelectEquipSlotInfo.equip?this.updateUpgradeInfo():(this._skin.upStarNode.active=!1,this._skin.btnAutoUpStar.active=!1,this._skin.btnStartUpStar.active=!1,this._skin.btnStopAutoUpStar.active=!1,this._skin.btnStopAutoUpStar.active=!1,this._skin.lab_rate_desc.node.active=!1,this._skin.lab_no_equip.node.active=!0,this._skin.lab_rate.string=game.ccfg.LangCfg.getText(15033))}},updateDefaultUpStarRate:function(){if(this._curSelectEquipSlotInfo){var e=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curSelectEquipSlotInfo.slotStar);if(e){var t,i=100*e.failAddRate;this._skin.lab_rate_desc.string=game.ccfg.LangCfg.getText(15034,[game.ValueUtil.getDigitsValueByNum(i,1)]);var n=game.equip.getEquipSlotInfoByType(this._curSelectEquipSlotInfo.slotType);t=n&&0!=n.rate?n.rate/10:100*e.rate,this._skin.lab_rate.string=game.ccfg.LangCfg.getText(15035,[game.ValueUtil.getDigitsValueByNum(t,1)])}else this._skin.lab_rate.string=game.ccfg.LangCfg.getText(15033)}},onUpdateLeftEquipSlotInfo:function(){var e=this._curSelectEquipSlotInfo.slotStar;this._skin.left_lab_level.string=game.ccfg.LangCfg.getText(15036,[e]);var t=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(e),i=0;t&&(i=game.ValueUtil.getDigitsValueByNum(100*t.attrRate,2)),this._skin.left_lab_attr.string=game.ccfg.LangCfg.getText(15037,[i])},onUpdateRgithEquipSlotInfo:function(){var e=this._curSelectEquipSlotInfo.slotStar+1;this._skin.right_lab_level.string=game.ccfg.LangCfg.getText(15036,[e]);var t=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(e),i=0;t&&(i=game.ValueUtil.getDigitsValueByNum(100*t.attrRate,2)),this._skin.right_lab_attr.string=game.ccfg.LangCfg.getText(15037,[i])},onUpdateMaxEquipSlotInfo:function(){var e=this._curSelectEquipSlotInfo.slotStar;this._skin.max_lab_level.string=game.ccfg.LangCfg.getText(15036,[e]);var t=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(e),i=0;t&&(i=game.ValueUtil.getDigitsValueByNum(100*t.attrRate,2)),this._skin.max_lab_attr.string=game.ccfg.LangCfg.getText(15037,[i])},onSetUpStarState:function(e){this._skin.max_lab_level.node.active=e,this._skin.max_lab_attr.node.active=e,this._skin.right_lab_level.node.active=!e,this._skin.right_lab_attr.node.active=!e,this._skin.left_lab_level.node.active=!e,this._skin.left_lab_attr.node.active=!e,this._skin.icon_jiantou2.active=!e,this._skin.upStarNode.active=!e,this._skin.equipUpStarGroup_labMaxDesc.node.active=e,this._skin.lab_rate_desc.node.active=!e,this._skin.lab_no_equip.node.active=!1},updatePower:function(){this._skin.lab_power2.string=game.equip.getAllEquipUpStarPower()},updateUpgradeInfo:function(){if(this._curSelectEquipSlotInfo){if(!game.equip.isMaxEquipUpStar(this._curSelectEquipSlotInfo.slotType)){var e=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curSelectEquipSlotInfo.slotStar);if(e){var t=e.upgradeInfo,i=t.getFirstUpgradeInfoName(),n=t.getFirstUpgradeInfoNum(),s=t.getFirstUpgradeInfoId(),a=game.back.getItemInfoCountById(s);this._curNum=n;var o=game.ccfg.ItemInfoCfg.getQualityColorById(s);this._skin.equipUpStarGroup_labSlotType.string=game.html.getText(o,i);var r="";r=n<=game.back.getItemInfoCountById(s)?game.html.getText(game.html.Q_GREEN,a):game.html.getText(game.html.Q_RED,a),this._skin.lab_num.string=r+"/"+n;var h=game.ccfg.ItemInfoCfg.getItemInfoById(s);this._itemInfo=h,game.GridUtil.setItemGrid(this._costItemGrid,h),this._costItemGrid.sortLayer();var g="",l=game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO),c=game.shop.getItemInfoPrice(s),u=n-a;if(u<0)g=c<=l?game.html.getText(game.html.Q_GREEN,c):game.html.getText(game.html.Q_RED,c);else{var m=u*c;g=m<=l?game.html.getText(game.html.Q_GREEN,m):game.html.getText(game.html.Q_RED,m)}this._skin.lab_cost.string=g}}}else game.GridUtil.setItemGrid(this._costItemGrid,null)},onUpStar:function(){this._curSelectEquipSlotInfo?this.onStarUpStar():game.notice.show(15038)},onAutoUpStar:function(){this._curSelectEquipSlotInfo?(this._skin.btnStartUpStar.active=!1,this._skin.btnAutoUpStar.active=!1,this._skin.btnStopAutoUpStar.active=!0,game.equip.autoUpStarEnd=!0,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.onUpdate,1e3)):game.notice.show(15038)},onUpdate:function(){if(game.equip.autoUpStarEnd){game.equip.isAutoUpStar=!0,game.equip.autoUpStarEnd=!1,this.onStarUpStar();var e=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curSelectEquipSlotInfo.slotStar);game.upgrade.isHasEnoughItem(e.upgradeInfo)||game.equip.isAutoBuy||this.onAutoStopAutoUpStar()}},onStarUpStar:function(){if(game.equip.isMaxEquipUpStar(this._curSelectEquipSlotInfo.slotType))return game.notice.show(15039),void(game.equip.isAutoUpStar&&this.onAutoStopAutoUpStar());if(game.equip.isMaxCanUpStarLevel(this._curSelectEquipSlotInfo.slotStar))return game.notice.show(15040),void(game.equip.isAutoUpStar&&this.onAutoStopAutoUpStar());var e=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curSelectEquipSlotInfo.slotStar);e&&game.upgrade.costCheck(this,e.upgradeInfo,this.onIsPass,!0,game.equip.isAutoBuy)},onIsPass:function(e){e?(game.equip.isUpStaring=!0,this._curSelectEquipSlotInfo&&-1!=this._curSelectEquipSlotInfo.slotType&&game.EquipSender.reqEquipSlotStar(this._curSelectEquipSlotInfo.slotType)):game.equip.isAutoUpStar&&this.onAutoStopAutoUpStar()},onAutoStopAutoUpStar:function(){this._curSelectEquipSlotInfo&&(game.equip.isMaxEquipUpStar(this._curSelectEquipSlotInfo.slotType)?(this._skin.btnStartUpStar.active=!1,this._skin.btnAutoUpStar.active=!1):(this._skin.btnStartUpStar.active=!0,this._skin.btnAutoUpStar.active=!0));this._skin.btnStopAutoUpStar.active=!1,game.equip.isAutoUpStar=!1,this._timer&&this._timer.stop()},onStopUpStar:function(){game.equip.isAutoUpStar=!0,this.onAutoStopAutoUpStar()},onOpenSelectEquipPanel:function(){game.app.show(game.AppConstant.EQUIP_UP_STAR_SELECT_PANEL)},onClick:function(e){e&&e.faceInfo&&""!=e.faceInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e.faceInfo,num:e.faceInfo.num})}})},{}],326:[function(e,t,i){"use strict";game.EquipUpStarSelectItem=game.SkinUI.extends({itemGrid:null,_curEquipSlotInfo:null,ctor:function(){this._super("equip/EquipUpStarSelectItemSkin","EquipUpStarSelectItemSkin")},getWidth:function(){return 530},getHeight:function(){return 150},onShow:function(){this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon)),this.setData(this._curEquipSlotInfo),b8e.evt.onC(this._skin.btn_select,this.onSelectEquipSlot,this)},onHide:function(){game.GridUtil.setEquipSlotGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btn_select,this.onSelectEquipSlot,this)},setData:function(e){if((this._curEquipSlotInfo=e)&&this._skin){var t;if(this.clearData(),this._curEquipSlotInfo.equip){this._curEquipSlotInfo.equip.quality,this._curEquipSlotInfo.equip.iconName;var i=game.ccfg.ItemInfoCfg.getQualityColorById(this._curEquipSlotInfo.equip.id);t=game.html.getText(i,this._curEquipSlotInfo.equip.name+"("+this._curEquipSlotInfo.slotStar+"星)")}else 0,game.equip.getEquipIconByType(this._curEquipSlotInfo.slotType),t=game.ccfg.LangCfg.getText(15042);game.GridUtil.setEquipSlotGrid(this.itemGrid,this._curEquipSlotInfo,!1,!1,!1,this._curEquipSlotInfo.slotStar),this.itemGrid.sortLayer();var n=game.equip.isMaxEquipUpStar(this._curEquipSlotInfo.slotType);this._skin.img_max.active=n,this._skin.img_redPoint.active=!n,this._skin.btn_select.active=!n,this._skin.lab_name.string=t;var s=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._curEquipSlotInfo.slotStar),a=0;s&&(a=100*s.attrRate),this._skin.lab_level.string=game.ccfg.LangCfg.getText(15043,[game.html.getText(game.html.Q_GREEN," +"+Math.round(a)+"%")]),this._skin.lab_fight.string=this._curEquipSlotInfo.upStarPower,this.onUpdateEquipAttr(a)}},onUpdateEquipAttr:function(e){var t="",i="",n="";if(this._curEquipSlotInfo.equip){if(this._curEquipSlotInfo.equip.baseSpriteStat){var s=this._curEquipSlotInfo.equip.baseSpriteStat.getSpriteStats();if(s&&0<s.length)for(var a=0;a<s.length;a++){var o=s[a];o&&(i=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type),a!=s.length-1&&(n="\n"),t+=i+"  +"+Math.round(o.value+o.value*e/100)+n)}}}else t="无";this._skin.lab_attr.string=t},onSelectEquipSlot:function(){if(this._curEquipSlotInfo){if(game.equip.isMaxCanUpStarLevel(this._curEquipSlotInfo.slotStar))return void game.notice.show(15041);game.equip.curUpStarSlot=this._curEquipSlotInfo,b8e.evt.dptG(game.EquipEvt.SELECT_UP_STAR_EQUIP),game.app.hide(game.AppConstant.EQUIP_UP_STAR_SELECT_PANEL)}},clearData:function(){this._skin.lab_name.string="",this._skin.lab_level.string="",this._skin.img_redPoint.active=!1,this._skin.lab_fight.string="",this._skin.lab_attr.string="",game.GridUtil.setEquipSlotGrid(this.itemGrid,null)}})},{}],327:[function(e,t,i){"use strict";game.appModule.EquipUpStarSelectPanel=game.SkinUIPanel.extends({list:null,_equipList:null,ctor:function(e){this._super(e),this._itemVec=[],this._equipList=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.EquipUpStarSelectItem)),this._list.show(),this.updateInfo()},onHide:function(){this._list&&this._list.hide()},updateInfo:function(){this._equipList.length=0;var e=game.equip.getHasEquipSlotMap();e&&(this._equipList=e.values()),this._list.setData(this._equipList)}})},{}],328:[function(e,t,i){"use strict";game.HighEquipGradItem=game.SkinUI.extends({_curEquipId:null,equipType:43,_equipIcon:null,_isClick:!1,_isHighEquip:!1,_isRedIcon:!1,_isCanClick:!1,ctor:function(){this._super("equip/HighEquipGradItemSkin","HighEquipGradItemSkin")},getButtonByName:function(e){switch(e){case"equipIcon":return!this._skin||this._skin.equipIcon}return null},init:function(){this._equipIcon=engine.Sprite.get(),this._equipIcon.setAnchor(.5,.5),this._equipIcon.addToParent(this._skin.equipIcon)},onShow:function(){this._isCanClick&&b8e.evt.onC(this._skin.equipIcon,this.onShowEquipInfo,this),this.setDataByEquipInfo(this._curEquipId)},onHide:function(){this._isCanClick&&b8e.evt.offC(this._skin.equipIcon,this.onShowEquipInfo,this)},setDataByEquipInfo:function(e){if(this._curEquipId=e,this._skin)if(this.setRedIconVisibel(this._isRedIcon),this.setEquipIconByType(this.equipType),this.setClickBgVisibel(this._isClick),this.setIconKuangVisibel(this._isHighEquip),e){var t=game.ccfg.ItemInfoCfg.getLevelById(this._curEquipId),i=game.ccfg.ItemInfoCfg.getIconNameById(this._curEquipId);this._skin.equipLevel.string="Lv."+t,this._equipIcon.loadTexture(game.ClientCfg.getImgUrl(i),null,null,{useManifest:!1}),this._skin.equipLevel.node.active=!0,this._skin.iconKuang.active=!0}else this.setNoneEquip()},onShowEquipInfo:function(){this.setClickBgVisibel(!0),b8e.evt.dptG(game.EquipEvt.CLICKCALLBACK_EQUIPGRADE,this.equipType)},setEquipIconByType:function(e){this.equipType=e,this._skin&&this.equipType&&this._equipIcon.loadTexture(game.ClientCfg.getHighEquipBg(this.equipType),null,null,{useManifest:!1})},setRedIconVisibel:function(e){this._isRedIcon=e,this._skin&&(this._skin.redNode.active=e)},setClickBgVisibel:function(e){this._isClick=e,this._skin&&(this._skin.clickBg.active=e)},setIconKuangVisibel:function(e){this._isHighEquip=e,this._skin&&(this._skin.iconKuang.active=e)},setNoneEquip:function(){this._skin&&(this._skin.redNode.active=!1,this._skin.equipLevel.node.active=!1,this._skin.iconKuang.active=!1,this._equipIcon.loadTexture(game.ClientCfg.getHighEquipBg(this.equipType),null,null,{useManifest:!1}))},setCaoClick:function(e){this._isCanClick=e}})},{}],329:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.appModule.HighEquipPanel=game.SkinUIPanel.extends((s(n={_curHighEquipInfo:null,_costNum:0,_costInfo:null,_maxCount:8,_curSlotType:41,_equipGradItemMap:null,_bestEquipItem:null,_curEquipItem:null,_nextEquipItem:null,_isUpGradeNode:!1,_isCanGetEquip:!0},"_isCanGetEquip",!0),s(n,"_isHighest",!1),s(n,"_nextLevel",0),s(n,"ctor",function(e){this._super(e),this._equipGradItemMap=b8e.HashMap.get()}),s(n,"init",function(){var e=game.equip.getEquipSlotMap();this._curHighEquipInfo=e.values(),this.addHighEquipGradItem()}),s(n,"addHighEquipGradItem",function(){if(this._curHighEquipInfo){for(var e=0;e<this._curHighEquipInfo.length;++e){var t=this._curHighEquipInfo[e],i=new game.HighEquipGradItem;i.setCaoClick(!0),this._equipGradItemMap.set(t.slotType,i),i.addToParent(this._skin["equip_"+e]),i.setEquipIconByType(t.slotType),i.show()}this._bestEquipItem=new game.HighEquipGradItem,this._bestEquipItem.addToParent(this._skin.equipItem),this._bestEquipItem.show(),this._curEquipItem=new game.HighEquipGradItem,this._curEquipItem.addToParent(this._skin.curequipItem),this._curEquipItem.show(),this._nextEquipItem=new game.HighEquipGradItem,this._nextEquipItem.addToParent(this._skin.nextequipItem),this._nextEquipItem.show()}}),s(n,"onShow",function(){var e=this._equipGradItemMap.get(this._curSlotType);e.setClickBgVisibel(!1),this._curSlotType=game.GoodsType.WEAPON,(e=this._equipGradItemMap.get(this._curSlotType)).setClickBgVisibel(!0),b8e.evt.onC(this._skin.getItemBtn,this.onGetItems,this),b8e.evt.onC(this._skin.upGradeBtn,this.onReqEquip,this),b8e.evt.addG(this,game.EquipEvt.CLICKCALLBACK_EQUIPGRADE,this.onEquipGradeClickBack),b8e.evt.addG(this,game.EquipEvt.UPDATE_HIGHEQUIPPANEL,this.updataEquipItems),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataCardsNum),b8e.evt.addG(this,game.EquipEvt.PLAY_HIGHEQUIPEFFECT,this.playHighEquipEffect),this.updataEquipItems(),this.updataCardsNum()}),s(n,"onHide",function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.getItemBtn,this.onGetItems,this),b8e.evt.offC(this._skin.upGradeBtn,this.onReqEquip,this),b8e.evt.rmvG(this,game.EquipEvt.CLICKCALLBACK_EQUIPGRADE,this.onEquipGradeClickBack),b8e.evt.rmvG(this,game.EquipEvt.UPDATE_HIGHEQUIPPANEL,this.updataEquipItems),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataCardsNum),b8e.evt.rmvG(this,game.EquipEvt.PLAY_HIGHEQUIPEFFECT,this.playHighEquipEffect),this.clearEffect()}),s(n,"updataEquipItems",function(){var n;this._equipGradItemMap.forEach(function(e,t){game.equip.isHighEquip(e)?(n=game.equip.getCurEquipInfoByType(e),t.setDataByEquipInfo(n.id)):t.setDataByEquipInfo(0);var i=game.equip.getHighEquipSpotAlertByType(e);t.setRedIconVisibel(i)},this),this.updateEquipInfo()}),s(n,"updateEquipInfo",function(){if(this._skin){this._isUpGradeNode=!1;var e=0,t=0,i=0,n=30004,s=game.equip.isHighEquip(this._curSlotType),a=!1;if(s)if(a=game.equip.isHighestEquipHighest(this._curSlotType)){var o=game.equip.getCurEquipInfoByType(this._curSlotType);o&&(i=o.id)}else{this._isUpGradeNode=!0,this.updateEquipGradeNode();var r=game.equip.getNextGradeHighEquip(this._curSlotType);if(!r)return;e=game.ccfg.HighEquipCfg.getupgradeCostByItemId(r.itemId);var h=game.ccfg.HighEquipCfg.getCostItemId(r.itemId);this._costInfo=game.back.getItemInfoById(h),this._costInfo&&(t=this._costInfo.num)}else{var g=game.equip.getBestHighEquipInfo(this._curSlotType);if(!g)return;i=g.itemId,e=game.ccfg.HighEquipCfg.getobtainCostByItemId(i),n=30004}if(i){var l=game.ccfg.ItemInfoCfg.getNameById(i),c=(game.ccfg.ItemInfoCfg.getLevelById(i),this.getDecsById(i)),u=game.equip.getPawerByEquipId(i);this._skin.labAtk.string="战力:"+u,this._skin.equipName.string=l,this._skin.SpDesc.string=game.ccfg.LangCfg.getText(n,[c]),this._bestEquipItem.setDataByEquipInfo(i);h=game.ccfg.HighEquipCfg.getCostItemId(i);this._costInfo=game.back.getItemInfoById(h),this._costInfo&&(t=this._costInfo.num)}this._skin.spHighestEquip.active=a,this._skin.upgradeLevelNode.active=!(a||!s),this._skin.normaltLevelNode.active=a||!s,(this._costNum=e)<=t?(this._isCanGetEquip=!0,this._skin.equipcardDesc.string=game.ccfg.LangCfg.getText(3e4,[t,e])):(this._isCanGetEquip=!1,this._skin.equipcardDesc.string=game.ccfg.LangCfg.getText(30003,[t,e])),(this._isHighest=a)&&(this._skin.equipcardDesc.string="--/--"),this._skin.upGradeBtn.active=!a,this._skin.btnTitle.string=s?"升  级":"合  成"}}),s(n,"updateEquipGradeNode",function(){var e=0,t=game.equip.getCurEquipInfoByType(this._curSlotType);t&&(e=t.id);var i=game.equip.getNextGradeHighEquip(this._curSlotType);e&&i&&(this.setCurEquipItem(e),this.setNextEquipItem(i.itemId))}),s(n,"setCurEquipItem",function(e){var t=game.ccfg.ItemInfoCfg.getNameById(e),i=(game.ccfg.ItemInfoCfg.getLevelById(e),this.getDecsById(e)),n=game.equip.getPawerByEquipId(e);this._skin.curequipAtk.string="战力:"+n,this._skin.curequipName.string=t,this._skin.curSpDesc.string=game.ccfg.LangCfg.getText(30005,[i]),this._curEquipItem.setDataByEquipInfo(e)}),s(n,"setNextEquipItem",function(e){var t=game.ccfg.ItemInfoCfg.getNameById(e),i=game.ccfg.ItemInfoCfg.getLevelById(e),n=this.getDecsById(e),s=game.equip.getPawerByEquipId(e);this._skin.nextequipAtk.string="战力:"+s,this._skin.nextequipName.string=t,this._skin.nextSpDesc.string=game.ccfg.LangCfg.getText(30004,[n]),this._nextLevel=i,this._nextEquipItem.setDataByEquipInfo(e)}),s(n,"updataCardsNum",function(){if(this._skin){if(this._isHighest)this._skin.equipcardDesc.string="--/--";else{var e=0,t=this._costNum;this._costInfo&&(e=this._costInfo.num),t<=e?(this._isCanGetEquip=!0,this._skin.equipcardDesc.string=game.ccfg.LangCfg.getText(3e4,[e,t])):(this._isCanGetEquip=!1,this._skin.equipcardDesc.string=game.ccfg.LangCfg.getText(30003,[e,t]))}this._equipGradItemMap.forEach(function(e,t){var i=game.equip.getHighEquipSpotAlertByType(e);t.setRedIconVisibel(i)},this),this._skin.getEquipAlert.active=game.equip.isCanResolveEquip()}}),s(n,"getDecsById",function(e){var t=game.ccfg.ItemInfoCfg.getBaseAttrId(e),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=game.ccfg.ItemInfoCfg.getHighEquipAttrId(e),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n),a=this.getSpriteStatStr(i)+"<br/>";return a+=this.getSpriteStatStr(s,!0)}),s(n,"onGetItems",function(){game.app.show(game.AppConstant.RESOLVE_HIGHEQUIP_PANEL)}),s(n,"onEquipGradeClickBack",function(e){if(e&&e.data){var t=e.data;if(this._curSlotType!=t)this._equipGradItemMap.get(this._curSlotType).setClickBgVisibel(!1),this._curSlotType=t,this.updateEquipInfo()}}),s(n,"getSpriteStatStr",function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],s="",a="",o="",r=e.getSpriteStats();if(r&&0<r.length)for(t=0;t<r.length;t++)if(i=r[t]){a=game.ccfg.AttrRulesCfg.getAttrNameByType(i.type),o=t!=r.length-1?"<br/>":"";var h=i.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(i.type).format){case game.AttrRulesFormat.FORMAT_1:h=i.value;break;case game.AttrRulesFormat.FORMAT_2:h=game.ValueUtil.getDigitsValueByNum(100*i.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:h=game.ValueUtil.getDigitsValueByNum(100*i.value,2)}if(n){s+=game.html.getText(game.html.Q_RED,a+" "+h);continue}s+=a+"  +"+h+o}return s}),s(n,"onReqEquip",function(){if(this._isHighest)game.notice.show(game.ccfg.LangCfg.getText(30010));else if(this._isCanGetEquip){if(this._isUpGradeNode)return game.mainRole.mainRoleData.getLv()<this._nextLevel?void game.notice.show(game.ccfg.LangCfg.getText(30011)):void game.EquipSender.reqEquipUpgrade(this._curSlotType);if(game.back.isMaxBackEquipNum())return void game.notice.show(game.ccfg.LangCfg.getText(30009));game.EquipSender.reqEquipCombine(this._curSlotType)}else game.notice.show(game.ccfg.LangCfg.getText(30008))}),s(n,"playGetEquipCardEffect",function(){var e=game.ClientCfg.getUIFxs(10056);this.getCardsEffect.load(e),this.getCardsEffect.play(0)}),s(n,"playHighEquipEffect",function(e){if(e&&e.data){var t="10028";e.data.isUpgrade||(t="10082"),this._upgrade_effect||(this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.upgradeEffect)),this.playEffect(t)}}),s(n,"playEffect",function(e){var t=game.ClientCfg.getUIFxs(e);t?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.HIGHEQUIP_EFFECT,1),this._upgrade_effect.addChild(this._anim)),this._upgrade_effect.setVisible(!0),this._anim.load(t),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()}),s(n,"clearEffect",function(){this._anim&&this._anim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)}),s(n,"onCompleteEffect",function(e){this._upgrade_effect.setVisible(!1)}),n))},{}],330:[function(e,t,i){"use strict";game.appModule.OtherRoleEquipTips=game.SkinUIPanel.extends({_equipSlotInfo:null,itemGrid:null,ctor:function(e){this._super(e)},onShow:function(){this._equipSlotInfo=this.data,this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID)),this.updateInfo()},onHide:function(){this._skin.lab_itemName.string="",this._skin.lab_itemType.string="",this._skin.lab_desc.string="",this._skin.lab_lv.string="",this._skin.lab_fight.string="",game.GridUtil.setItemGrid(this.itemGrid,null)},onWearEquip:function(){game.app.show(game.AppConstant.EQUIP_SELECT_PANEL,this._equipSlotInfo.equip.type),this.hide()},onUpgradeStarEquip:function(){game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1),game.equip.curUpStarSlot=this._equipSlotInfo,b8e.evt.dptG(game.EquipEvt.SELECT_UP_STAR_EQUIP),this.hide(),game.app.hide(game.AppConstant.ROLE_PANEL)},updateInfo:function(){if(this._equipSlotInfo&&this._equipSlotInfo.equip){game.GridUtil.setEquipSlotGrid(this.itemGrid,this._equipSlotInfo,!0,!1,!1,this._equipSlotInfo.slotStar),this.itemGrid.sortLayer();var e="";if(0<this._equipSlotInfo.slotLevel){var t=game.html.getColorByQuality(this._equipSlotInfo.equip.quality);e=game.html.getText(t,"  +"+this._equipSlotInfo.slotLevel)}this._skin.lab_itemName.string=game.ccfg.ItemInfoCfg.getQualityNameById(this._equipSlotInfo.equip.id)+e,this._skin.lab_itemType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this._equipSlotInfo.equip.type);var i="";i=game.mainRole.mainRoleData.getLv()>=this._equipSlotInfo.equip.level?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(15027,[this._equipSlotInfo.equip.level])):game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(15027,[this._equipSlotInfo.equip.level])),this._skin.lab_lv.string=i,this._skin.lab_fight.string=this._equipSlotInfo.totalPower,this.onUpdateEquipAttr()}},onUpdateEquipAttr:function(){var e="",t=!1;if(0<this._equipSlotInfo.slotStar){var i=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._equipSlotInfo.slotStar),n=0;if(i){n=100*i.attrRate;var s=game.html.getText(game.html.Q_YELLOW,game.ccfg.LangCfg.getText(15046,[this._equipSlotInfo.slotStar,Math.round(n)]));e=game.ccfg.LangCfg.getText(15044,[s]),t=!0}}else e=game.ccfg.LangCfg.getText(15031);var a=this.getEquipSpriteStatStr(this._equipSlotInfo.equip.baseSpriteStat,!1,t);this._equipSlotInfo.equip.isHighEquip&&this._equipSlotInfo.equip.highSpriteStat&&(a+=game.ccfg.LangCfg.getText(15049),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.equip.highSpriteStat,!0,!1,!0)),this._equipSlotInfo.isenchant&&(a+=game.ccfg.LangCfg.getText(15052),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.enchantSpriteStat,!1,!1,!1,!0)),0<this._equipSlotInfo.slotLevel&&(a+=game.ccfg.LangCfg.getText(15045),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.intensifySpriteStat,!1,!1)),this._equipSlotInfo.equip.appendSpriteStat&&0<this._equipSlotInfo.equip.appendSpriteStatLine&&(a+=game.ccfg.LangCfg.getText(15032),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.equip.appendSpriteStat,!0,!1)),this._skin.lab_desc.string=e+a;var o=this._skin.lab_desc.node.height+30;this._skin.bg_2.height=o,this._skin.top_node.y=this._skin.bg_2.y+this._skin.bg_2.height+40,this.height=this._skin.bg.node.height=this._skin.top_node.y+this._skin.top_node.height+20,this.resetPosition()},getEquipSpriteStatStr:function(e,t,i){var n,s,a,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],h="",g="",l="",c="",u="",m=e.getSpriteStats();if(m&&0<m.length)for(n=0;n<m.length;n++)if(s=m[n]){g=game.ccfg.AttrRulesCfg.getAttrNameByType(s.type),l=n!=m.length-1?"\n":"";var _=s.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(s.type).format){case game.AttrRulesFormat.FORMAT_1:_=s.value;break;case game.AttrRulesFormat.FORMAT_2:_=game.ValueUtil.getDigitsValueByNum(100*s.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:_=game.ValueUtil.getDigitsValueByNum(100*s.value,2)}if(r){h+=game.html.getText(game.html.Q_YELLOW,"    "+g+" "+_+l);continue}if(o){h+=game.html.getText(game.html.Q_RED,"    "+g+" "+_);continue}i?((a=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._equipSlotInfo.slotStar))&&(c=" (+"+Math.round(_*a.attrRate)+")",u=game.html.getText(game.html.Q_YELLOW,c)),h+="    "+g+" "+_+u+l):t?(g=game.ccfg.AttrRulesCfg.getAttrNameByType(s.type),h+="    "+(g=game.ccfg.EquipRefineColorCfg.getColorStr(this._equipSlotInfo.equip.level,s.type,_,g+" "+_))+l):h+="    "+g+" "+_+l}return h}})},{}],331:[function(e,t,i){"use strict";game.ResolveHighEquipItem=game.SkinUI.extends({_curEquipInfo:null,_equipIcon:null,ctor:function(){this._super("equip/ResolveHighEquipItemSkin","ResolveHighEquipItemSkin")},init:function(){this._equipIcon=b8e.Sprite.get(),this._equipIcon.setAnchor(.5,.5),this._equipIcon.addToParent(this._skin.equipIcon)},getWidth:function(){return 540},getHeight:function(){return 125},getButtonByName:function(e){switch(e){case"resolvebtn":return!this._skin||this._skin.btn_change}return null},onShow:function(){this.setData(this._curEquipInfo),b8e.evt.onC(this._skin.resolvebtn,this.onResolveEquip,this)},onHide:function(){b8e.evt.offC(this._skin.resolvebtn,this.onResolveEquip,this)},setData:function(e){if((this._curEquipInfo=e)&&this._skin){var t=game.ccfg.ItemInfoCfg.getNameById(e.id),i=game.ccfg.HighEquipCfg.getobtainCostByItemId(e.id),n=game.ccfg.ItemInfoCfg.getLevelById(e.id),s=game.ccfg.ItemInfoCfg.getIconNameById(e.id);this._equipIcon.loadTexture(game.ClientCfg.getImgUrl(s),null,null,{useManifest:!1}),this._skin.equipname.string=game.ccfg.LangCfg.getText(30006,[t]),this._skin.getItemsDesc.string=game.ccfg.LangCfg.getText(30007,[i]),this._skin.equipLevel.string="Lv."+n}},onResolveEquip:function(){this._curEquipInfo&&game.back.reqSellEquip([this._curEquipInfo.idx])}})},{}],332:[function(e,t,i){"use strict";game.appModule.ResolveHighEquipPanel=game.SkinUIPanel.extends({_list:null,_equipList:null,ctor:function(e){this._super(e),this._itemVec=[],this._equipList=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.ResolveHighEquipItem)),this._list.show(),this._skin.btn_3.active=!game.IS_SHIELD_IOS_RECHARGE,this.updateInfo(),b8e.evt.onC(this._skin.btn_1,this.onGetItemPath_1,this),b8e.evt.onC(this._skin.btn_2,this.onGetItemPath_2,this),b8e.evt.onC(this._skin.btn_3,this.onGetItemPath_3,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_1,this.onGetItemPath_1,this),b8e.evt.offC(this._skin.btn_2,this.onGetItemPath_2,this),b8e.evt.offC(this._skin.btn_3,this.onGetItemPath_3,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo)},updateInfo:function(){var e=game.equip.getSmeltHightEquips();!e||e.length<=0?this._skin.noneTips.node.active=!0:this._skin.noneTips.node.active=!1,this._list&&this._list.setData(e)},onGetItemPath_1:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.NATIONAL_BOSS)&&game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.NATIONAL_BOSS)},onGetItemPath_2:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.WORLD_BOSS)&&game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.WORLD_BOSS)},onGetItemPath_3:function(){game.welfare.selectSubType=game.WelfareType.ROULETTE,game.app.show(game.AppConstant.WELFARE_PANEL)}})},{}],333:[function(e,t,i){"use strict";game.appModule.RoleEquipTips=game.SkinUIPanel.extends({_equipSlotInfo:null,itemGrid:null,_btn_DefaultX:0,_btn_CenterX:0,ctor:function(e){this._super(e),this._btn_DefaultX=270,this._btn_CenterX=195},getButtonByName:function(e){switch(e){case"change":return!this._skin||this._skin.btn_change}return null},onShow:function(){this._equipSlotInfo=this.data,this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID)),this._skin.btn_upgradeStar.active=!1,this.updateInfo(),b8e.evt.onC(this._skin.btn_upgradeStar,this.onUpgradeStarEquip,this),b8e.evt.onC(this._skin.btn_change,this.onWearEquip,this)},onHide:function(){this._skin.lab_itemName.string="",this._skin.lab_itemType.string="",this._skin.lab_desc.string="",this._skin.lab_lv.string="",this._skin.btn_upgradeStar.active=!1,this._skin.img_redPoint.active=!1,this._skin.btn_change.active=!1,this._skin.lab_fight.string="",game.GridUtil.setEquipSlotGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btn_upgradeStar,this.onUpgradeStarEquip,this),b8e.evt.offC(this._skin.btn_change,this.onWearEquip,this)},onWearEquip:function(){game.app.show(game.AppConstant.EQUIP_SELECT_PANEL,this._equipSlotInfo.equip.type),this.hide()},onUpgradeStarEquip:function(){game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1),game.equip.curUpStarSlot=this._equipSlotInfo,b8e.evt.dptG(game.EquipEvt.SELECT_UP_STAR_EQUIP),this.hide(),game.app.hide(game.AppConstant.ROLE_PANEL)},updateInfo:function(){if(this._equipSlotInfo&&this._equipSlotInfo.equip){game.GridUtil.setEquipSlotGrid(this.itemGrid,this._equipSlotInfo,!0,!1,!1,this._equipSlotInfo.slotStar),this.itemGrid.clearEffect(),this.itemGrid.sortLayer();var e="";if(0<this._equipSlotInfo.slotLevel){var t=game.html.getColorByQuality(this._equipSlotInfo.equip.quality);e=game.html.getText(t,"  +"+this._equipSlotInfo.slotLevel)}this._skin.lab_itemName.string=game.ccfg.ItemInfoCfg.getQualityNameById(this._equipSlotInfo.equip.id)+e,this._skin.lab_itemType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this._equipSlotInfo.equip.type);var i="";i=game.mainRole.mainRoleData.getLv()>=this._equipSlotInfo.equip.level?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(15027,[this._equipSlotInfo.equip.level])):game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(15027,[this._equipSlotInfo.equip.level])),this._skin.lab_lv.string=i,this._skin.lab_fight.string=this._equipSlotInfo.totalPower;var n=!1;switch(this._equipSlotInfo.equip.type){case game.GoodsType.WEAPON:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_0);break;case game.GoodsType.ARMOR:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_1);break;case game.GoodsType.BELT:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_2);break;case game.GoodsType.RING:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_3);break;case game.GoodsType.HELM:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_4);break;case game.GoodsType.NECKLACE:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_5);break;case game.GoodsType.LEGGUARD:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_6);break;case game.GoodsType.SHOE:n=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_7)}this._skin.img_redPoint.active=n,this.onUpdateEquipAttr()}},onUpdateEquipAttr:function(){var e="",t=!1;if(0<this._equipSlotInfo.slotStar){var i=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._equipSlotInfo.slotStar),n=0;if(i){n=100*i.attrRate;var s=game.html.getText(game.html.Q_YELLOW,game.ccfg.LangCfg.getText(15046,[this._equipSlotInfo.slotStar,Math.round(n)]));e=game.ccfg.LangCfg.getText(15044,[s]),t=!0}}else e=game.ccfg.LangCfg.getText(15031);var a=this.getEquipSpriteStatStr(this._equipSlotInfo.equip.baseSpriteStat,!1,t),o=this._equipSlotInfo.equip;o.isHighEquip&&o.highSpriteStat&&(a+=game.ccfg.LangCfg.getText(15049),a+=this.getEquipSpriteStatStr(o.highSpriteStat,!0,!1,!0)),this._equipSlotInfo.isenchant&&(a+=game.ccfg.LangCfg.getText(15052),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.enchantSpriteStat,!1,!1,!1,!0)),0<this._equipSlotInfo.slotLevel&&(a+=game.ccfg.LangCfg.getText(15045),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.intensifySpriteStat,!1,!1)),this._equipSlotInfo.equip.appendSpriteStat&&0<this._equipSlotInfo.equip.appendSpriteStatLine&&(a+=game.ccfg.LangCfg.getText(15032),a+=this.getEquipSpriteStatStr(this._equipSlotInfo.equip.appendSpriteStat,!0,!1)),this._skin.lab_desc.string=e+a;var r=this._skin.lab_desc.node.height+30;this._skin.bg_2.height=r,this._skin.top_node.y=this._skin.bg_2.y+this._skin.bg_2.height+40,this.height=this._skin.bg.node.height=this._skin.top_node.y+this._skin.top_node.height+20,game.funcOpen.checkOpen(game.FunctionType.EQUIP_SHENG_XING)?(this._skin.btn_upgradeStar.active=!0,this._skin.btn_change.x=this._btn_DefaultX=270):this._skin.btn_change.x=this._btn_CenterX=195,this._skin.btn_change.active=!0,this.resetPosition()},getEquipSpriteStatStr:function(e,t,i){var n,s,a,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],h="",g="",l="",c="",u="",m=e.getSpriteStats();if(m&&0<m.length)for(n=0;n<m.length;n++)if(s=m[n]){g=game.ccfg.AttrRulesCfg.getAttrNameByType(s.type),l=n!=m.length-1?"\n":"";var _=s.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(s.type).format){case game.AttrRulesFormat.FORMAT_1:_=s.value;break;case game.AttrRulesFormat.FORMAT_2:_=game.ValueUtil.getDigitsValueByNum(100*s.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:_=game.ValueUtil.getDigitsValueByNum(100*s.value,2)}if(r){h+=game.html.getText(game.html.Q_YELLOW,"    "+g+" "+_+l);continue}if(o){h+=game.html.getText(game.html.Q_RED,"    "+g+" "+_);continue}i?((a=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(this._equipSlotInfo.slotStar))&&(c=" (+"+Math.round(_*a.attrRate)+")",u=game.html.getText(game.html.Q_YELLOW,c)),h+="    "+g+" "+_+u+l):t?(g=game.ccfg.AttrRulesCfg.getAttrNameByType(s.type),h+="    "+(g=game.ccfg.EquipRefineColorCfg.getColorStr(this._equipSlotInfo.equip.level,s.type,_,g+" "+_))+l):h+="    "+g+" "+_+l}return h}})},{}],334:[function(e,t,i){"use strict";e("./EquipSelectItem"),e("./EquipSelectPanel"),e("./EquipTips"),e("./RoleEquipTips"),e("./EquipForgePanel"),e("./EquipIntensifyPanel"),e("./EquipUpStarPanel"),e("./EquipUpStarSelectItem"),e("./EquipUpStarSelectPanel"),e("./EquipRefinePanel"),e("./OtherRoleEquipTips"),e("./HighEquipGradItem"),e("./ResolveHighEquipItem"),e("./ResolveHighEquipPanel"),e("./HighEquipPanel"),e("./EquipEnchantPage")},{"./EquipEnchantPage":316,"./EquipForgePanel":317,"./EquipIntensifyPanel":318,"./EquipRefinePanel":321,"./EquipSelectItem":322,"./EquipSelectPanel":323,"./EquipTips":324,"./EquipUpStarPanel":325,"./EquipUpStarSelectItem":326,"./EquipUpStarSelectPanel":327,"./HighEquipGradItem":328,"./HighEquipPanel":329,"./OtherRoleEquipTips":330,"./ResolveHighEquipItem":331,"./ResolveHighEquipPanel":332,"./RoleEquipTips":333}],335:[function(e,t,i){"use strict";var n=game.EquipSender=function(){};n.reqPutOnEquip=function(e){var t=game.pbmsg.PutOnEquipRequest;t.idx=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Bag.PutOnEquipRequest;b8e.sendN(i)},n.reqEquipSlotUpgrade=function(e){var t=game.pbmsg.EquipSlotUpgradeRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Equip.EquipSlotUpgradeRequest;b8e.sendN(i)},n.reqEquipSlotBatchUpgrade=function(){var e=game.pbmid.Equip.EquipSlotBatchUpgradeRequest;b8e.sendN(e)},n.reqEquipSlotStar=function(e){var t=game.pbmsg.EquipSlotStarRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Equip.EquipSlotStarRequest;b8e.sendN(i)},n.reqEquipRefine=function(e,t,i){var n=game.pbmsg.EquipRefineRequest;n.srcId=e,n.dstId=t,n.cfgIds=i,engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Equip.EquipRefineRequest;b8e.sendN(s)},n.reqEquipCombine=function(e){var t=game.pbmsg.EquipCombineRequest;t.equipType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Equip.EquipCombineRequest;b8e.sendN(i)},n.reqEquipUpgrade=function(e){var t=game.pbmsg.EquipUpgradeRequest;t.equipType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Equip.EquipUpgradeRequest;b8e.sendN(i)},n.reqEquipEnchant=function(e){var t=game.pbmsg.EquipUpgradeRequest;t.equipType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Equip.EquipEnchantRequest;b8e.sendN(i)}},{}],336:[function(e,t,i){"use strict";e("./EquipSender")},{"./EquipSender":335}],337:[function(e,t,i){"use strict";game.EscortCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Escort.EscortInfoResponse,this.onEscortInfoResponse,this),b8e.addNH(game.pbmid.Escort.EscortStartResponse,this.onEscortStartResponse,this),b8e.addNH(game.pbmid.Escort.EscortRewardResponse,this.onEscortRewardResponse,this),b8e.addNH(game.pbmid.Escort.EscortFinishResponse,this.onEscortFinishResponse,this),b8e.addNH(game.pbmid.Escort.EscortRefreshFairyResponse,this.onEscortRefreshFairyResponse,this),b8e.addNH(game.pbmid.Escort.EscortRefreshListResponse,this.onEscortRefreshListResponse,this),b8e.addNH(game.pbmid.Escort.EscortInviteResponse,this.onEscortInviteResponse,this),b8e.addNH(game.pbmid.Escort.EscortRobResponse,this.onEscortRobResponse,this),b8e.addNH(game.pbmid.Escort.EscortLogResponse,this.onEscortLogResponse,this),b8e.addNH(game.pbmid.Escort.EscortRevengeResponse,this.onEscortRevengeResponse,this),b8e.addNH(game.pbmid.Escort.EscortBattleFinishNotify,this.onEscortBattleFinishNotify,this),b8e.addNH(game.pbmid.Escort.EscortAcceptInviteResponse,this.onEscortAcceptInviteResponse,this),b8e.addNH(game.pbmid.Escort.EscortHelperNotify,this.onEscortHelperNotify,this)},onEscortInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortInfoResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.synEscortInfo(t)}},onEscortStartResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortStartResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortStartResponse(t)}},onEscortRewardResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortRewardResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortRewardResponse()}},onEscortFinishResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortFinishResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortFinishResponse()}},onEscortRefreshFairyResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortRefreshFairyResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortRefreshFairyResponse(t)}},onEscortRefreshListResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortRefreshListResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortRefreshListResponse(t)}},onEscortInviteResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortInviteResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.notice.show(game.ccfg.LangCfg.getText(79022))}},onEscortRobResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortRobResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortRobResponse()}},onEscortLogResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortLogResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortLogResponse(t)}},onEscortRevengeResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortRevengeResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortRevengeResponse()}},onEscortBattleFinishNotify:function(e){var t=e.readProtobuf(game.pbmsg.EscortBattleFinishNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortBattleFinish(t)}},onEscortAcceptInviteResponse:function(e){var t=e.readProtobuf(game.pbmsg.EscortAcceptInviteResponse);if(t){var i=t.code;0<i&&game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i))}},onEscortHelperNotify:function(e){var t=e.readProtobuf(game.pbmsg.EscortHelperNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.escort.escortHelperNotify(t)}}})},{}],338:[function(e,t,i){"use strict";game.EscortEvent=b8e.Enum({ESCORT_SYN_INFO:b8e.Event.nextCode(),ESCORT_REFRESH_RESULT:b8e.Event.nextCode(),ESCORT_FINISH_REQUEST:b8e.Event.nextCode(),ESCORT_START:b8e.Event.nextCode(),ESCORT_LOG_INFO:b8e.Event.nextCode(),ESCORT_REFRESH_LIST_RESULT:b8e.Event.nextCode(),ESCORT_HELPER_NOTIFY:b8e.Event.nextCode()})},{}],339:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.EscortMgr=b8e.Object.extends((s(n={name:"EscortMgr",_escortInfo:null,_escortLog:null,_pillageData:null,_pillageLog:null,tmpSelectFriendId:0,tmpSelectFriendName:"",battleFinishInfo:null,isEscort:!1,beginTime:0,endTime:0,todayZoneTime:0,beginTotalMillisecond:0,endTotalMillisecond:0,fariyShowCount:0,ctor:function(){if(1==game.EscortMgr._singleton)throw new Error("EscortMgr 只能通过单例方法获取");this._super(),this._escortInfo=new game.EscortInfo,this._escortLog=new game.EscortLog,this.battleFinishInfo=new game.ArenaFinishInfo,this._pillageLog=b8e.HashMap.get()},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.ESCORT)&&this.escortInfoRequest(),this.calOpenTime()},calOpenTime:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ESCORT_BEGIN_TIME).split(":"),t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ESCORT_END_TIME).split(":"),i=Number(e[0]),n=Number(e[1]),s=Number(t[0]),a=Number(t[1]);this.beginTotalMillisecond=60*i*60*1e3+60*n*1e3,this.endTotalMillisecond=60*s*60*1e3+60*a*1e3},escortInfoRequest:function(){game.EscortSender.EscortLogRequest(),game.EscortSender.EscortInfoRequest()},synEscortInfo:function(e){e&&(this._escortInfo||(this._escortInfo=new game.EscortInfo),this._escortInfo.setup(e),this.insertSelfEscort(),b8e.evt.dptG(game.EscortEvent.ESCORT_SYN_INFO))},insertSelfEscort:function(){this.getEscortRemainingTime()<=0||this._escortInfo.myEscort&&this._escortInfo.escortList.splice(0,0,this._escortInfo.myEscort)},deleteSelfEscort:function(){if(this._escortInfo.myEscort){for(var e=this._escortInfo.escortList.length,t=0;t<e;t++)if(this._escortInfo.escortList[t].roleId==game.mainRole.mainRoleData.playerId)return void this._escortInfo.escortList.remove(t);this._escortInfo.myEscort=null}},escortLogRequest:function(){game.EscortSender.EscortLogRequest()},escortLogResponse:function(e){this.setEscortLog(e),b8e.evt.dptG(game.EscortEvent.ESCORT_LOG_INFO)},escortRefreshFairyRequest:function(e){this.isMaxFairyQuality()?game.notice.show(game.ccfg.LangCfg.getText(79016)):game.EscortSender.EscortRefreshFairyRequest(e)},isMaxFairyQuality:function(){return 4<=this.getFairyQuality(this.getFairyId())},escortRefreshFairyResponse:function(e){var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_FREE_REFRESH_COUNT);if(this._escortInfo.free=e.free>t?t:e.free,this._escortInfo.fairyId==e.fairyId)return game.notice.show(game.ccfg.LangCfg.getText(79015)),void b8e.evt.dptG(game.EscortEvent.ESCORT_REFRESH_RESULT);this._escortInfo.fairyId=e.fairyId,b8e.evt.dptG(game.EscortEvent.ESCORT_REFRESH_RESULT)},escortStartRequest:function(){this.isEscortOpen()?this.canEscort()?game.EscortSender.EscortStartRequest(this.getFriendId()):game.notice.show(game.ccfg.LangCfg.getText(79012)):game.notice.show(game.ccfg.LangCfg.getText(79032,[game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ESCORT_BEGIN_TIME),game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ESCORT_END_TIME)]))},escortStartResponse:function(e){this._escortInfo.myEscort=e.escort,this._escortInfo.escorts++,this.insertSelfEscort(),b8e.evt.dptG(game.EscortEvent.ESCORT_START),game.app.isShow(game.AppConstant.ESCORT_SELECT_PANEL)&&game.app.hide(game.AppConstant.ESCORT_SELECT_PANEL)},escortInviteRequest:function(e){game.EscortSender.EscortInviteRequest(e),game.app.isShow(game.AppConstant.ESCORT_FRIEND_INVITE_PANEL)&&game.app.hide(game.AppConstant.ESCORT_FRIEND_INVITE_PANEL)},escortHelperNotify:function(e){this.setFriendId(e.roleId),this.setFriendName(e.name),b8e.evt.dptG(game.EscortEvent.ESCORT_HELPER_NOTIFY)},escortAcceptInviteRequest:function(e){game.EscortSender.EscortAcceptInviteRequest(e)},escortRewardRequest:function(){var e=this.getEscortData();e?e.time?game.notice.show(game.ccfg.LangCfg.getText(79010)):game.EscortSender.EscortRewardRequest():game.notice.show(game.ccfg.LangCfg.getText(79009))},escortFinishRequest:function(){game.EscortSender.EscortFinishRequest()},escortFinishResponse:function(){b8e.evt.dptG(game.EscortEvent.ESCORT_FINISH_REQUEST),this.setFriendId(0),this.setFriendName(""),this.escortInfoRequest()},escortRefreshListRequest:function(){4<this._escortInfo.escortList.length?(this._escortInfo.escortList.splice(0,4),this._escortInfo.escortList.length<4&&this.insertSelfEscort(),b8e.evt.dptG(game.EscortEvent.ESCORT_REFRESH_LIST_RESULT)):game.EscortSender.EscortRefreshListRequest()},escortRefreshListResponse:function(e){this._escortInfo.refreshList(e),this._escortInfo.escortList.length<4&&this.insertSelfEscort(),b8e.evt.dptG(game.EscortEvent.ESCORT_REFRESH_LIST_RESULT)},escortRobRequest:function(e){game.EscortSender.EscortRobRequest(e)},escortRobResponse:function(){game.app.isShow(game.AppConstant.ESCORT_MAIN_PANEL)&&game.app.hide(game.AppConstant.ESCORT_MAIN_PANEL),game.app.isShow(game.AppConstant.ESCORT_PILLAGE_PANEL)&&game.app.hide(game.AppConstant.ESCORT_PILLAGE_PANEL),game.app.isShow(game.AppConstant.WANFA_ARENA_PANEL)&&game.app.hide(game.AppConstant.WANFA_ARENA_PANEL)},escortBattleFinish:function(e){e&&(this.battleFinishInfo||(this.battleFinishInfo=new game.ArenaFinishInfo),this.battleFinishInfo.setup(e),this.battleFinishInfo.state=e.stats.State,game.app.show(game.AppConstant.ESCORT_BATTLE_RESULT_PANEL),this.escortInfoRequest())},onExitBattle:function(){game.SceneMgr.inst().sceneId;var e=game.SceneMgr.inst().getSceneConfig();e&&e.type==game.SceneType.ARENA&&(this.isEscort=!0,game.SceneSender.leaveAloneDungeon())}},"escortRewardRequest",function(){game.EscortSender.EscortRewardRequest()}),s(n,"escortRewardResponse",function(){game.app.isShow(game.AppConstant.ESCORT_FINISH_PANEL)&&game.app.hide(game.AppConstant.ESCORT_FINISH_PANEL),this.escortInfoRequest()}),s(n,"escortRevengeRequest",function(e,t,i,n){game.EscortSender.EscortRevengeRequest(e,t,i,n)}),s(n,"escortRevengeResponse",function(){game.app.isShow(game.AppConstant.ESCORT_MAIN_PANEL)&&game.app.hide(game.AppConstant.ESCORT_MAIN_PANEL),game.app.isShow(game.AppConstant.ESCORT_LOG_PANEL)&&game.app.hide(game.AppConstant.ESCORT_LOG_PANEL),game.app.isShow(game.AppConstant.ESCORT_REVENGE_PANEL)&&game.app.hide(game.AppConstant.ESCORT_REVENGE_PANEL),game.app.isShow(game.AppConstant.WANFA_ARENA_PANEL)&&game.app.hide(game.AppConstant.WANFA_ARENA_PANEL)}),s(n,"setFriendId",function(e){this.tmpSelectFriendId=e}),s(n,"setFriendName",function(e){this.tmpSelectFriendName=e}),s(n,"getFriendId",function(){return this.tmpSelectFriendId}),s(n,"getFriendName",function(){return this.tmpSelectFriendName}),s(n,"getOnlineFriendDatas",function(){if(game.relation&&game.relation.friend){var e=game.relation.friend.getDatas();if(e&&!(e.length<=0)){var t=game.mainRole.getMainRoleData();if(t){for(var i,n=t.getZhanLi()?t.getZhanLi():0,s=[],a=0;a<e.length;a++)(i=e[a])&&i.isOnline&&i.fightAmount>n&&!this._escortInfo.isFriendInList(i.roleId)&&s.push(i);return s}}}}),s(n,"getEscortData",function(){return this._escortInfo?this._escortInfo.myEscort:null}),s(n,"getEscorts",function(){return this._escortInfo?this._escortInfo.escorts:0}),s(n,"getRobs",function(){return this._escortInfo?this._escortInfo.robs:0}),s(n,"getHelps",function(){return this._escortInfo?this._escortInfo.helps:0}),s(n,"getRefreshFreeCount",function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_FREE_REFRESH_COUNT);return this._escortInfo?e-this._escortInfo.free:0}),s(n,"getCurEscortId",function(){return this._escortInfo&&this._escortInfo.myEscort?this._escortInfo.myEscort.id:0}),s(n,"getCurFairyId",function(){return this._escortInfo&&this._escortInfo.myEscort?this._escortInfo.myEscort.fairyId:101}),s(n,"getFairyId",function(){return this._escortInfo?this._escortInfo.fairyId:101}),s(n,"getPillageList",function(){return this._escortInfo?this._escortInfo.escortList:[]}),s(n,"setEscortLog",function(e){e&&(this._escortLog||(this._escortLog=new game.EscortLog),this._escortLog.setup(e))}),s(n,"getEscortInfo",function(){return this._escortInfo}),s(n,"getEscortLog",function(){return this._escortLog?this._escortLog.getDatas():null}),s(n,"getEscortPillagedLog",function(){return this._escortLog?this._escortLog.getPillagedLogs():null}),s(n,"getCurPillagedLog",function(e){return this._escortLog?this._escortLog.getCurPillagedLogs(e):null}),s(n,"getRewardId",function(e){var t=game.ccfg.EscortCfg.getDataById(e);return t?t.reward:0}),s(n,"getPillagedCount",function(){return this._escortInfo?this._escortInfo.robs:0}),s(n,"getFairyQuality",function(e){var t=game.ccfg.EscortCfg.getDataById(e);return t?t.quality:1}),s(n,"getFairyName",function(e){var t=game.ccfg.EscortCfg.getDataById(e);return t?1==t.quality?game.html.getText(game.html.Q_GREEN,t.name):2==t.quality?game.html.getText(game.html.Q_BLUE,t.name):3==t.quality?game.html.getText(game.html.Q_PURPLE,t.name):4==t.quality?game.html.getText(game.html.Q_YELLOW,t.name):"":""}),s(n,"getEscortEndTime",function(){if(!this._escortInfo)return game.SysTime.curTime+36e5;if(!this._escortInfo.myEscort)return game.SysTime.curTime+36e5;var e=game.ccfg.EscortCfg.getDataById(this._escortInfo.myEscort.fairyId);return e?this._escortInfo.myEscort.startTime+1e3*e.seconds:game.SysTime.curTime+36e5}),s(n,"getEscortRemainingTime",function(){var e=this.getEscortEndTime()-game.SysTime.curTime>>0;return 0<e?e:0}),s(n,"getFinishCost",function(){if(!this._escortInfo||!this._escortInfo.myEscort)return 0;var e=game.ccfg.EscortCfg.getDataById(this._escortInfo.myEscort.fairyId);return e?e.cost:0}),s(n,"getFairyCfgDatas",function(){var e=game.ccfg.EscortCfg.getDatas();if(!e)return null;for(var t,i=game.mainRole.mainRoleData.getLv(),n=[],s=0;s<e.length;s++)(t=e[s]).lv<=i&&n.unshift(t);var a=[];for(s=0;s<4;s++)t=n[s],a.unshift(t);return a}),s(n,"selectPillage",function(e){this._pillageData=e,game.app.show(game.AppConstant.ESCORT_PILLAGE_PANEL)}),s(n,"getPillageData",function(){return this._pillageData}),s(n,"isEscortOpen",function(){return this.todayZoneTime=b8e.TimeUtil.getTodayTime(game.SysTime.curTime),this.beginTime=this.todayZoneTime+this.beginTotalMillisecond,this.endTime=this.todayZoneTime+this.endTotalMillisecond,!(game.SysTime.curTime<this.beginTime||game.SysTime.curTime>this.endTime)}),s(n,"canEscort",function(){return!!this._escortInfo&&(!(this._escortInfo.escorts>=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_DAILY_COUNT))&&!(this._escortInfo.myEscort&&0<this.getEscortRemainingTime()))}),s(n,"canFreeRefresh",function(){return!!this._escortInfo&&!(this._escortInfo.free>=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_FREE_REFRESH_COUNT))}),s(n,"canRevenge",function(){var e,t=this.getEscortLog();if(!t||t.length<=0)return!1;for(var i=t.length-1;0<=i;i--)if(2==(e=t[i]).type&&!e.win&&!e.revenge)return!0;return!1}),s(n,"initSpotAlert",function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ESCORT_ALERT,null,this.escortAlert,this)}),s(n,"escortAlert",function(){return!!game.funcOpen.checkOpen(game.FunctionType.ESCORT)&&(!!this.isOpen()&&(!!this.isEscortOpen()&&(!!this.canEscort()||(this.getEscortRemainingTime()<=0||!!this.canRevenge()))))}),s(n,"isOpen",function(){return!!this._escortInfo&&!(this._escortInfo.openTime>game.SysTime.curTime)}),n)),game.EscortMgr._instance=null,game.EscortMgr._singleton=!0,game.EscortMgr.inst=function(){return game.EscortMgr._instance||(game.EscortMgr._singleton=!1,game.EscortMgr._instance=new game.EscortMgr,game.EscortMgr._singleton=!0),game.EscortMgr._instance}},{}],340:[function(e,t,i){"use strict";game.appModule.EscortBattleResultPanel=game.SkinUIPanel.extends({_prizeList:null,countDown:0,_timer:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.look_result,this.onshowDetail,this),b8e.evt.onC(this._skin.share_btn,this.onShare,this),b8e.evt.onC(this._skin.exit_btn,this.onEixtBtnClick,this),this.setData(),this.countDown=10,this._timer||(this._timer=b8e.Timer.add(this,this.waitTimeBack,1e3)),this._timer.reset(),this._timer.start()},waitTimeBack:function(){this.countDown<=0&&(this._timer&&this._timer.stop(),game.app.isShow(game.AppConstant.ESCORT_BATTLE_RESULT_PANEL)&&(game.escort.onExitBattle(),this.hide())),--this.countDown},onHide:function(){b8e.evt.offC(this._skin.look_result,this.onshowDetail,this),b8e.evt.offC(this._skin.share_btn,this.onShare,this),b8e.evt.offC(this._skin.exit_btn,this.onEixtBtnClick,this)},onshowDetail:function(){var e=game.escort.battleFinishInfo;1==e.type?game.notice.show("对方没有上阵变身，你不战而胜"):(game.app.show(game.AppConstant.ARENA_COMBATDATA_PANEL,e.stats),this._timer&&this._timer.stop())},onShare:function(){},onEixtBtnClick:function(){this._timer&&this._timer.stop(),game.escort.onExitBattle(),game.app.show(game.AppConstant.ESCORT_MAIN_PANEL),this.hide()},setData:function(){var e=game.escort.battleFinishInfo;switch(e.state){case 1:this._skin.lose.active=!1,this._skin.victory.active=!0,this._skin.winEffect.active=!0,b8e.ShaderUtil.reset(this._skin.win_bg);break;default:this._skin.lose.active=!0,this._skin.victory.active=!1,this._skin.winEffect.active=!1,b8e.ShaderUtil.setGray(this._skin.win_bg)}this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_90),this._prizeList.addToParent(this._skin.prize_conten)),this._prizeList.setData(e.prizeInfo)}})},{}],341:[function(e,t,i){"use strict";game.EscortFairyItem=game.SkinUI.extends({_data:null,_anim:null,_timer:null,_index:0,ctor:function(e){this._super("escort/FairySkin","EscortFairySkin"),this._data=e},init:function(){this._anim=b8e.Animator.get(game.AnimatorType.ESCORT_FAIRY,1),this._anim.addToParent(this._skin.fairy_node)},onShow:function(){this.setData(this._data),this.createTimer(),b8e.evt.onC(this._skin.btn_pillage,this.onClick,this)},calPosition:function(e,t){var i=260+e%2*260,n=340-290*Math.floor(e/2);this.setPosition(i,n)},onHide:function(){b8e.evt.offC(this._skin.btn_pillage,this.onClick,this),this.clearAnimator(),this.clearTimer()},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.EscortCfg.getDataById(e.fairyId);if(t){if(this._skin.fairy_owner.string=e.roleName+".s"+e.zone,e.roleId==game.mainRole.mainRoleData.playerId?(this._skin.img_escort.active=!0,this._skin.img_pillage.active=!1):(this._skin.img_escort.active=!1,e.robs<game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_PILLAGE_COUNT)?this._skin.img_pillage.active=!0:this._skin.img_pillage.active=!1),this._anim){var i=game.ClientCfg.getUIFxs(t.res);this._anim.setPosition(0,15),this._anim.load(i),this._anim.play()}this.updateTime()}}},onClick:function(){this._data&&game.escort.selectPillage(this._data)},updateTime:function(){if(this._skin&&this._data){var e=game.ccfg.EscortCfg.getDataById(this._data.fairyId);if(e){var t=this._data.startTime+1e3*e.seconds-game.SysTime.curTime>>0;t=0<=t?t:0,this._skin.fairy_time.string=b8e.TimeUtil.formatTime(t)}}},clearAnimator:function(){this._anim&&this._anim.clear()},createTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3),this._timer.start())},clearTimer:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},getHeight:function(){return 290},getWidth:function(){return 240}})},{}],342:[function(e,t,i){"use strict";game.appModule.EscortFinishPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_list:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.ESCORT_PRIZE_CONTAINER_ID,this._prizeList.setPosition(10,110),this._prizeList.addToParent(this._skin.img_prize_bg),this._list=new b8e.List(this._skin.list,game.EscortMiniLogItem)},onShow:function(){this._list.show(),this.updateShow(),this.createPrize(),b8e.evt.onC(this._skin.btn_receive,this.onReceive,this)},onHide:function(){b8e.evt.offC(this._skin.btn_receive,this.onReceive,this),this._list&&this._list.hide()},updateLogInfo:function(){var e=game.escort.getCurPillagedLog(game.escort.getCurEscortId());e&&0<e.length?(this._skin.lb_info.node.active=!1,this._list.setData(e)):this._skin.lb_info.node.active=!0},onReceive:function(){game.escort.escortRewardRequest()},updateShow:function(){var e=game.escort.getCurFairyId();this._skin.fairy_name.string=game.escort.getFairyName(e);for(var t=game.escort.getFairyQuality(e),i=0;i<4;i++)this._skin.img_select_status[i].active=i==t-1;this.updateLogInfo()},createPrize:function(){var e=game.escort.getCurFairyId();this._prizeInfo.setupById(game.escort.getRewardId(e)),this._prizeInfo&&this._prizeList.setData(this._prizeInfo)}})},{}],343:[function(e,t,i){"use strict";game.appModule.EscortFriendInvitePanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.EscortFriendItem))},onShow:function(){this.updateFriendInfo(),this._list.show()},onHide:function(){this._list&&this._list.hide()},updateFriendInfo:function(){var e=game.escort.getOnlineFriendDatas();!e||e.length<=0?this._skin.noneTips.active=!0:this._skin.noneTips.active=!1,this._list.setData(e)}})},{}],344:[function(e,t,i){"use strict";game.EscortFriendItem=game.SkinUI.extends({_friendInfo:null,_head:null,ctor:function(e){this._super("escort/EscortFriendItemSkin","EscortFriendItemSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.friend_icon)),b8e.evt.onC(this._skin.btn_invite,this.onInvite,this),this.setData(this._friendInfo)},onHide:function(){b8e.evt.offC(this._skin.btn_invite,this.onInvite,this)},setData:function(e){if(this._friendInfo=e,this._friendInfo&&this._skin){this._skin.lab_name.string=e.roleName,this._skin.lab_level.string=game.rebirth.getRebirthAndLv(e.rebirthLevel,e.lv),this._skin.lab_power.string=e.fightAmount+"";var t=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=t&&t?this._head.loadTexture(game.ClientCfg.getHeadUrl(t),null,null,{useManifest:!1}):this._head.unloadTexture()}},onInvite:function(){this._friendInfo&&game.escort.escortInviteRequest(this._friendInfo.roleId)},getHeight:function(){return 80},getWidth:function(){return 540}})},{}],345:[function(e,t,i){"use strict";game.EscortLogItem=game.SkinUI.extends({_logInfo:null,_battleFinishInfo:null,_revengeData:null,ctor:function(e){this._super("escort/EscortLogItemSkin","EscortLogItemSkin"),this._logInfo=e},init:function(){this._battleFinishInfo||(this._battleFinishInfo=new game.ArenaFinishInfo),this._revengeData||(this._revengeData={id:0,targetId:0,time:0,stats:null})},onShow:function(){b8e.evt.onC(this._skin.btn_revenge,this.onRevenge,this),b8e.evt.onC(this._skin.lb_look.node,this.onshowDetail,this),this.setData(this._logInfo)},onHide:function(){b8e.evt.offC(this._skin.btn_revenge,this.onRevenge,this),b8e.evt.offC(this._skin.lb_look.node,this.onshowDetail,this)},setData:function(e){if(this._logInfo=e,this._skin&&this._logInfo){this._skin.btn_revenge.active=!1;var t=game.escort.getFairyName(this._logInfo.fairyId),i=game.html.getText(game.html.Q_YELLOW,this._logInfo.targetName),n="";if(0==this._logInfo.type)this._skin.lb_content.string=game.ccfg.LangCfg.getText(79001,[t]),this._skin.lb_look.string=b8e.TimeUtil.formatTimestamp(this._logInfo.time),this._skin.lb_status.node.active=!1;else if(1==this._logInfo.type)n=this._logInfo.win?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(79003)):game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(79004)),this._skin.lb_status.node.active=!0,this._skin.lb_status.string=n,this._skin.lb_content.string=game.ccfg.LangCfg.getText(79e3,[i,t]),this._skin.lb_look.string=game.ccfg.LangCfg.getText(79002,[b8e.TimeUtil.formatTimestamp(this._logInfo.time)]);else if(2==this._logInfo.type){this._battleFinishInfo.setup(this._logInfo);var s=this._battleFinishInfo.stats.Attacker.name;this._logInfo.win?(n=game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(79004)),this._skin.lb_status.node.active=!0,this._skin.lb_status.string=n):this._logInfo.revenge?(n=this._logInfo.revengeWin?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(79006)):game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(79007)),this._skin.lb_status.node.active=!0,this._skin.lb_status.string=n):(this._skin.btn_revenge.active=!0,this._skin.lb_status.node.active=!1),this._skin.lb_content.string=game.ccfg.LangCfg.getText(79005,[s,t]),this._skin.lb_look.string=game.ccfg.LangCfg.getText(79002,[b8e.TimeUtil.formatTimestamp(this._logInfo.time)])}}},onshowDetail:function(){this._logInfo&&this._logInfo.stats&&(this._battleFinishInfo.setup(this._logInfo),game.app.show(game.AppConstant.ARENA_COMBATDATA_PANEL,this._battleFinishInfo.stats))},onRevenge:function(){this._logInfo&&(this._revengeData.id=this._logInfo.id,this._revengeData.targetId=this._battleFinishInfo.stats.Attacker.id,this._revengeData.fairyId=this._logInfo.fairyId,this._revengeData.time=this._logInfo.time,this._revengeData.stats=this._battleFinishInfo.stats,game.app.show(game.AppConstant.ESCORT_REVENGE_PANEL,this._revengeData))},getHeight:function(){return 75},getWidth:function(){return 540}})},{}],346:[function(e,t,i){"use strict";game.appModule.EscortLogPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},init:function(){this._list||(this._list=new b8e.List(this._skin.logList,game.EscortLogItem))},onShow:function(){b8e.evt.addG(this,game.EscortEvent.ESCORT_LOG_INFO,this.updateLogInfo),this._list.show(),game.escort.escortLogRequest()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_LOG_INFO,this.updateLogInfo)},updateLogInfo:function(){var e=game.escort.getEscortLog();!e||e.length<=0?this._skin.lb_tips.node.active=!0:this._skin.lb_tips.node.active=!1,this._list.setData(e)}})},{}],347:[function(e,t,i){"use strict";game.appModule.EscortMainPanel=game.SkinUIPanel.extends({_timerObj:null,_gameAlertInfo:null,_refreshTime:0,_fairyModels:null,ctor:function(e){this._super(e)},init:function(){var e;this._fairyModels=[];for(var t=0;t<4;t++)(e=new game.EscortFairyItem).addToParent(this._skin.mask_node),this._fairyModels.push(e);this._gameAlertInfo=new game.GameAlertInfo,this._gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this._gameAlertInfo.isShowTips=!0},onShow:function(){game.escort.escortInfoRequest(),b8e.evt.onC(this._skin.btn_select_fairy,this.onSelectEscort,this),b8e.evt.onC(this._skin.btn_promptly,this.onPromptly,this),b8e.evt.onC(this._skin.btn_other,this.onOther,this),b8e.evt.onC(this._skin.btn_log,this.onShowLog,this),b8e.evt.onC(this._skin.help_btn,this.onClickHelpBtn,this),b8e.evt.addG(this,game.EscortEvent.ESCORT_SYN_INFO,this.sysEscortInfo),b8e.evt.addG(this,game.EscortEvent.ESCORT_FINISH_REQUEST,this.onFinishResult),b8e.evt.addG(this,game.EscortEvent.ESCORT_START,this.updataInfo),b8e.evt.addG(this,game.EscortEvent.ESCORT_REFRESH_LIST_RESULT,this.createPillage),this._timerObj||(this._timerObj=b8e.Timer.add(this,this.updateTime,1e3)),this._timerObj.start(),0<game.escort.getEscortRemainingTime()&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(game.escort.getEscortRemainingTime()).call(function(){this.updataInfo(),b8e.Tween.kill(this)},this))},onHide:function(){this.pillageHide(),b8e.evt.offC(this._skin.btn_select_fairy,this.onSelectEscort,this),b8e.evt.offC(this._skin.btn_promptly,this.onPromptly,this),b8e.evt.offC(this._skin.btn_other,this.onOther,this),b8e.evt.offC(this._skin.btn_log,this.onShowLog,this),b8e.evt.offC(this._skin.help_btn,this.onClickHelpBtn,this),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_SYN_INFO,this.sysEscortInfo),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_FINISH_REQUEST,this.onFinishResult),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_START,this.updataInfo),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_REFRESH_LIST_RESULT,this.createPillage),this._timerObj&&(b8e.Timer.remove(this,this.updateTime),this._timerObj=null),b8e.Tween.kill(this)},sysEscortInfo:function(){this.updataInfo(),game.escort.getEscortRemainingTime()<=0&&game.app.show(game.AppConstant.ESCORT_FINISH_PANEL)},onFinishResult:function(){this.updataInfo()},updataInfo:function(){var e=game.escort.getEscorts(),t=game.escort.getRobs(),i=game.escort.getHelps();this._skin.lb_info.string=game.ccfg.LangCfg.getText(79008,[e,game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_DAILY_COUNT),t,game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_ROBS_COUNT),i,game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_HELPS_COUNT)]),game.escort.getEscortData()?(this._skin.btn_select_fairy.active=!1,this._skin.promptly_panel.active=!0,this._skin.lb_time.string=b8e.TimeUtil.formatTime(game.escort.getEscortRemainingTime()),game.escort.getEscortRemainingTime()<=0?this._skin.lb_promptly.string=game.ccfg.LangCfg.getText(79018):this._skin.lb_promptly.string=game.ccfg.LangCfg.getText(79017)):(this._skin.btn_select_fairy.active=!0,this._skin.promptly_panel.active=!1),this.createPillage(),this.updateSpotAlert()},pillageShow:function(){for(var e=0;e<4;e++)this._fairyModels[e].show()},pillageHide:function(){for(var e=0;e<4;e++)this._fairyModels[e].hide()},createPillage:function(){var e=game.escort.getPillageList(),t=e.length;t=4<=t?4:t;for(var i,n,s=e.slice(0,t),a=s.length,o=game.escort.fariyShowCount=0;o<4;o++)i=s[o],n=this._fairyModels[o],i?n&&(n.setData(i),n.calPosition(o,a),n.show()):n&&n.hide()},updateTime:function(){0<this._refreshTime&&this._refreshTime--,this._skin.lb_time.string=game.ccfg.LangCfg.getText(79013,[b8e.TimeUtil.formatTime(game.escort.getEscortRemainingTime())])},updateSpotAlert:function(){this._skin.img_escort_alert.active=game.escort.canEscort()&&game.escort.isEscortOpen(),this._skin.img_log_alert.active=game.escort.canRevenge(),this._skin.img_award_alert.active=game.escort.getEscortRemainingTime()<=0},onSelectEscort:function(){game.app.show(game.AppConstant.ESCORT_SELECT_PANEL)},onClickHelpBtn:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.ESCORT_RULE_ID)},onPromptly:function(){game.escort.getEscortRemainingTime()<=0?game.app.show(game.AppConstant.ESCORT_FINISH_PANEL):(this._gameAlertInfo.string=game.ccfg.LangCfg.getText(79014,[game.escort.getFinishCost()]),game.gameAlert.showAlert(this,this.onClosePanelAlert,this._gameAlertInfo))},onClosePanelAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.escort.escortFinishRequest();break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},onOther:function(){0<this._refreshTime?game.notice.show(game.ccfg.LangCfg.getText(79029)):(this._refreshTime=10,game.escort.escortRefreshListRequest())},onShowLog:function(){game.app.show(game.AppConstant.ESCORT_LOG_PANEL)}})},{}],348:[function(e,t,i){"use strict";game.EscortMiniLogItem=game.SkinUI.extends({_logInfo:null,_battleFinishInfo:null,ctor:function(e){this._super("escort/EscortMiniLogItemSkin","EscortMiniLogItemSkin"),this._logInfo=e,this._battleFinishInfo||(this._battleFinishInfo=new game.ArenaFinishInfo)},onShow:function(){this.setData(this._logInfo)},onHide:function(){},setData:function(e){if(this._logInfo=e,this._skin&&this._logInfo){this._logInfo.index%2==0?this._skin.img_content_bg.active=!0:this._skin.img_content_bg.active=!1,this._battleFinishInfo.setup(this._logInfo);var t=this._battleFinishInfo.stats.Attacker.name;this._skin.lb_content.string=game.ccfg.LangCfg.getText(79020,[t])}},getHeight:function(){return 36},getWidth:function(){return 386}})},{}],349:[function(e,t,i){"use strict";game.appModule.EscortPillagePanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_pillageData:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.ESCORT_PRIZE_CONTAINER_ID,this._prizeList.setPosition(10,110),this._prizeList.addToParent(this._skin.img_prize_bg)},onShow:function(){this._pillageData=game.escort.getPillageData(),this._pillageData&&(this.crateInfo(),this.createPrize(),b8e.evt.onC(this._skin.btn_pillage,this.onPillage,this))},onHide:function(){b8e.evt.offC(this._skin.btn_pillage,this.onPillage,this)},onPillage:function(){var e=game.mainRole.getMainRoleData();e?this._pillageData.roleId!=e.playerId?this._pillageData.robs>=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_PILLAGE_COUNT)?game.notice.show(game.ccfg.LangCfg.getText(79031)):game.escort.escortRobRequest(this._pillageData.id):game.notice.show(game.ccfg.LangCfg.getText(79030)):b8e.warn("onPillage 获取不到自己的数据！！！")},crateInfo:function(){this._skin.lb_name.string=this._pillageData.roleName,this._skin.lb_pow.string=this._pillageData.rolePower,this._skin.lb_level.string=this._pillageData.roleLv,this._skin.lb_guild.string=this._pillageData.guildName,this._skin.lb_friend_name.string=this._pillageData.friendName?this._pillageData.friendName:"无",this._skin.lb_friend_pow.string=this._pillageData.friendPower;var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_PILLAGE_COUNT),t=e-this._pillageData.robs;t=0<=t?t:0,this._skin.lb_count.string=game.ccfg.LangCfg.getText(79019,[t,e])},createPrize:function(){this._prizeInfo.setupById(game.escort.getRewardId(this._pillageData.fairyId)),this._prizeInfo.setPercent(.1),this._prizeList.setData(this._prizeInfo)}})},{}],350:[function(e,t,i){"use strict";game.appModule.EscortRevengePanel=game.SkinUIPanel.extends({_data:null,_head:null,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.ESCORT_PRIZE_CONTAINER_ID,this._prizeList.setPosition(10,110),this._prizeList.addToParent(this._skin.img_prize_bg)},onShow:function(){this._data=this.data,this.updateShow(),this.createPrize(),b8e.evt.onC(this._skin.btn_perfect_revenge,this.onPerfectRevenge,this),b8e.evt.onC(this._skin.btn_general_revenge,this.onGeneralRevenge,this)},onHide:function(){b8e.evt.offC(this._skin.btn_perfect_revenge,this.onPerfectRevenge,this),b8e.evt.offC(this._skin.btn_general_revenge,this.onGeneralRevenge,this)},updateShow:function(){this._skin.lb_name.string=this._data.stats.Attacker.name,this._skin.lb_level.string=this._data.stats.Attacker.lv,this._skin.lb_pow.string=this._data.stats.Attacker.power,this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.friend_icon));var e=game.ccfg.HeadCfg.getsmallIcon(this._data.stats.Attacker.head);""!=e&&e?this._head.loadTexture(game.ClientCfg.getHeadUrl(e),null,null,{useManifest:!1}):this._head.unloadTexture()},onPerfectRevenge:function(){this._data&&game.escort.escortRevengeRequest(this._data.id,this._data.targetId,this._data.time,2)},onGeneralRevenge:function(){this._data&&game.escort.escortRevengeRequest(this._data.id,this._data.targetId,this._data.time,1)},createPrize:function(){this._prizeInfo.setupById(game.escort.getRewardId(this._data.fairyId)),this._prizeInfo.setPercent(.2),this._prizeList.setData(this._prizeInfo)}})},{}],351:[function(e,t,i){"use strict";game.appModule.EscortSelectPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_gameAlertInfo:null,ctor:function(e){this._super(e),this._gameAlertInfo=new game.GameAlertInfo,this._gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this._gameAlertInfo.isShowTips=!0},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.ESCORT_PRIZE_CONTAINER_ID,this._prizeList.setPosition(10,110),this._prizeList.addToParent(this._skin.img_prize_bg)},onShow:function(){this.onRefreshResult(),this.updateShow(),b8e.evt.onC(this._skin.btn_begin,this.onBegin,this),b8e.evt.onC(this._skin.btn_once,this.onOnceQuality,this),b8e.evt.onC(this._skin.btn_refresh,this.onRefreshQuality,this),b8e.evt.onC(this._skin.btn_invite,this.onInvite,this),b8e.evt.onC(this._skin.btn_cancel,this.onCancelHelper,this),b8e.evt.addG(this,game.EscortEvent.ESCORT_REFRESH_RESULT,this.onRefreshResult),b8e.evt.addG(this,game.EscortEvent.ESCORT_HELPER_NOTIFY,this.onHelperNotify),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateShow)},onHide:function(){b8e.evt.offC(this._skin.btn_begin,this.onBegin,this),b8e.evt.offC(this._skin.btn_once,this.onOnceQuality,this),b8e.evt.offC(this._skin.btn_refresh,this.onRefreshQuality,this),b8e.evt.offC(this._skin.btn_invite,this.onInvite,this),b8e.evt.offC(this._skin.btn_cancel,this.onCancelHelper,this),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_REFRESH_RESULT,this.onRefreshResult),b8e.evt.rmvG(this,game.EscortEvent.ESCORT_HELPER_NOTIFY,this.onHelperNotify),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateShow)},onHelperNotify:function(){this._skin.lb_friend_name.string=game.escort.getFriendName(),this._skin.btn_cancel.active=!0,this._skin.btn_invite.active=!1},onRefreshResult:function(){this.setSelect(game.escort.getFairyQuality(game.escort.getFairyId())-1),this.updateShow()},updateShow:function(){var e=game.escort.getFairyCfgDatas();if(e)for(var t,i=0;i<4;i++)t=e[i],this._skin.fairy_name[i].string=t.name;var n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_ADV_REFRESH_COST),s=n+"";s=game.BackMgr.inst().getAmountValue(game.AmountType.YUAN_BAO)<n?game.html.getText(game.html.Q_RED,s):game.html.getText(game.html.Q_WHITE,s),this._skin.lb_once_cost.string=s,this._skin.lb_info.string=game.ccfg.LangCfg.getText(79025,[game.escort.getEscorts(),game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_DAILY_COUNT)]),this.updateFreeCount()},updateFreeCount:function(){var e=game.escort.getRefreshFreeCount();if(0<e)this._skin.lb_refresh_cost.node.anchorX=.5,this._skin.lb_refresh_cost.node.setPosition(418,173),this._skin.lb_refresh_cost.string=game.ccfg.LangCfg.getText(79027,[e]),this._skin.img_refresh_icon.active=!1;else{this._skin.lb_refresh_cost.node.anchorX=0,this._skin.lb_refresh_cost.node.setPosition(412,173);var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ESCORT_COM_REFRESH_COST),i=t+"";i=game.BackMgr.inst().getAmountValue(game.AmountType.YUAN_BAO)<t?game.html.getText(game.html.Q_RED,i):game.html.getText(game.html.Q_WHITE,i),this._skin.lb_refresh_cost.string=i,this._skin.img_refresh_icon.active=!0}},setSelect:function(e){for(var t=this._skin.img_select_status.length,i=0;i<t;i++)this._skin.img_select_status[i].active=i==e;this.updatePrize()},onBegin:function(){game.escort.isMaxFairyQuality()?game.escort.escortStartRequest():(this._gameAlertInfo.string=game.ccfg.LangCfg.getText(79028,[game.escort.getFairyName(game.escort.getFairyId())]),game.gameAlert.showAlert(this,this.onClosePanelAlert,this._gameAlertInfo))},onClosePanelAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.escort.escortStartRequest();break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},onOnceQuality:function(){game.escort.escortRefreshFairyRequest(1)},onRefreshQuality:function(){game.escort.escortRefreshFairyRequest(2)},onInvite:function(){game.app.show(game.AppConstant.ESCORT_FRIEND_INVITE_PANEL)},onCancelHelper:function(){game.escort.setFriendId(0),game.escort.setFriendName(""),this._skin.lb_friend_name.string=game.html.getText(game.html.Q_RED,"无"),this._skin.btn_cancel.active=!1,this._skin.btn_invite.active=!0},updatePrize:function(){this._prizeInfo.setupById(game.escort.getRewardId(game.escort.getFairyId())),this._prizeInfo&&this._prizeList.setData(this._prizeInfo)}})},{}],352:[function(e,t,i){"use strict";game.EscortSender={},game.EscortSender.EscortInfoRequest=function(){var e=game.pbmid.Escort.EscortInfoRequest;b8e.sendN(e)},game.EscortSender.EscortStartRequest=function(e){var t=game.pbmsg.EscortStartRequest;t.friendId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Escort.EscortStartRequest;b8e.sendN(i)},game.EscortSender.EscortRewardRequest=function(){var e=game.pbmid.Escort.EscortRewardRequest;b8e.sendN(e)},game.EscortSender.EscortFinishRequest=function(){var e=game.pbmid.Escort.EscortFinishRequest;b8e.sendN(e)},game.EscortSender.EscortRefreshFairyRequest=function(e){var t=game.pbmsg.EscortRefreshFairyRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Escort.EscortRefreshFairyRequest;b8e.sendN(i)},game.EscortSender.EscortRefreshListRequest=function(){var e=game.pbmid.Escort.EscortRefreshListRequest;b8e.sendN(e)},game.EscortSender.EscortInviteRequest=function(e){var t=game.pbmsg.EscortInviteRequest;t.friendId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Escort.EscortInviteRequest;b8e.sendN(i)},game.EscortSender.EscortAcceptInviteRequest=function(e){var t=game.pbmsg.EscortAcceptInviteRequest;t.friendId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Escort.EscortAcceptInviteRequest;b8e.sendN(i)},game.EscortSender.EscortRobRequest=function(e){var t=game.pbmsg.EscortRobRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Escort.EscortRobRequest;b8e.sendN(i)},game.EscortSender.EscortLogRequest=function(){var e=game.pbmid.Escort.EscortLogRequest;b8e.sendN(e)},game.EscortSender.EscortRevengeRequest=function(e,t,i,n){var s=game.pbmsg.EscortRevengeRequest;s.id=e,s.targetId=t,s.time=i,s.type=n,engine.NetSender.getBytes().writeProtobuf(s);var a=game.pbmid.Escort.EscortRevengeRequest;b8e.sendN(a)}},{}],353:[function(e,t,i){"use strict";game.FightAmountSprite=game.SkinUI.extends({_last:0,_curLast:0,_now:0,_space:0,_onComplete:null,_thisArg:null,_playTime:1200,_isPlaying:!1,ctor:function(){this._super("fightAmount/FightAmountSkin","FightAmountSkin")},onShow:function(){this._playFightAmount(),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize)},onHide:function(){b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onResize)},play:function(e,t,i,n){if(this._last=e,this._curLast=e,this._now=t,this._last!=this._now){this._onComplete=i,this._skin&&(this._skin.add.node.active=!1);var s=100+30*(t+"").length;this.width=s,b8e.layer.getTopLayer().addChild(this),this.show(),this._playFightAmount()}},_playFightAmount:function(){this._skin&&(this._skin.bg.node.width=this.width,this._skin.add.node.active=!1,this._skin.amount.string=this._last+"",this._space=Math.floor((this._now-this._last)/15),this._space<=0&&(this._space=1),this.onResize(),b8e.Tween.kill(this._skin.add.node),this._isPlaying||b8e.Ticker.add(this,this._onUpdate),this._isPlaying=!0)},_onUpdate:function(){this._last+=this._space,this._last>this._now&&(this._last=this._now,this._onupdateComplete()),this._skin.amount.string=this._last+""},_onupdateComplete:function(){var e=this._skin.amount.node.x,t="+"+(this._now-this._curLast);e+=30*((this._now+"").length-t.length),this._skin.add.string=t,this._skin.add.node.setPosition(e,0),this._skin.add.node.active=!0,this._isPlaying=!1,b8e.Ticker.remove(this,this._onUpdate),b8e.Tween.kill(this._skin.add.node),b8e.Tween.get(this._skin.add.node).to({y:50},600).call(this._onTweenUpComplete,this)},_onTweenUpComplete:function(){this._onComplete&&this._onComplete.call(this._thisArg),b8e.Tween.kill(this._skin.add.node),game.funcOpen.checkOpen(game.FunctionType.JING_JIE)&&b8e.evt.dptG(game.DujieEvent.COMBAT_PLAY_COMPLETE),this.removeFromParent()},onResize:function(){var e=0==this.width?300:this.width,t=.5*(b8e.stageWidth-e);this.setPosition(t,200)}}),game.FightAmountSprite._instance=null,game.FightAmountSprite.inst=function(){return game.FightAmountSprite._instance||(game.FightAmountSprite._instance=new game.FightAmountSprite),game.FightAmountSprite._instance}},{}],354:[function(e,t,i){"use strict";e("./panel/panelIndex_89")},{"./panel/panelIndex_89":357}],355:[function(e,t,i){"use strict";game.FirstRechargeItem=game.SkinUI.extends({_firstRechargeInfo:null,_gameAlertInfo:null,ctor:function(){this._super("firstRecharge/FirstRechargeItemSkin","FirstRechargeItemSkin")},getHeight:function(){return 80},getWidth:function(){return 240},onShow:function(){this.setData(this._firstRechargeInfo),b8e.evt.onC(this._skin.btn_recharge,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.btn_recharge,this.onClickItem,this)},setData:function(e){if(this._firstRechargeInfo=e,this._skin&&this._firstRechargeInfo){var t=game.pay.getFirstRechargeMaxMoney();if(this._skin.node_tag.active=e.money==t,game.IS_HUO_SHU){var i=game.HuoShuSDK.getAppId();("2038"==i||"2066"==i)&&game.LoginConfig.isExchangeType?this._skin.lab_btn.string="充值<size=24>"+e.money*game.LoginConfig.exchange_num+"</>"+game.LoginConfig.exchange_name:this._skin.lab_btn.string="充值<size=24>"+e.money+"</>元"}else this._skin.lab_btn.string="充值<size=24>"+e.money+"</>元";this._skin.lab_recharge.string="获得<size=24>"+[game.html.getText(game.html.REWARD_COLOR,e.firstExtraDiamond+e.diamond)]+"</>元宝"}},onClickItem:function(){if(game.pay.isGetSeverData){var e={itemId:this._firstRechargeInfo.itemId};if(game.IS_HUO_SHU){var t=game.HuoShuSDK.getAppId();if(("2038"==t||"2066"==t)&&game.LoginConfig.isExchangeType){var i=game.html.getText(game.html.REWARD_COLOR,this._firstRechargeInfo.money*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name),n=game.html.getText(game.html.REWARD_COLOR,this._firstRechargeInfo.money*game.LoginConfig.exchange_num+"元宝"),s=game.html.getText(game.html.REWARD_COLOR,"赠送"+this._firstRechargeInfo.firstExtraDiamond+"元宝");this._gameAlertInfo||(this._gameAlertInfo=new game.GameAlertInfo,this._gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this._gameAlertInfo.string=game.ccfg.LangCfg.getText("您是否花费$兑换$？<br/>"+s,[i,n]),this._gameAlertInfo.isShowTips=!1),this._gameAlertInfo.obj={params:e},game.gameAlert.showAlert(this,this.onClickPay,this._gameAlertInfo)}else game.sdk.pay(e)}else game.sdk.pay(e)}else game.notice.show("数据发生错误，请重新登陆！")},onClickPay:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.sdk.pay(e.obj.params);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}}})},{}],356:[function(e,t,i){"use strict";game.appModule.FirstRechargePanel=game.SkinUIPanel.extends({_Model:null,_prizeList:null,_prizeInfo:null,_rechargeDiamond:-1,_list:null,_bgSprite:null,ctor:function(e){this._super(e),this._prizeInfo=new game.PrizeInfo},init:function(){this._list=new b8e.List(this._skin.list,game.FirstRechargeItem,2),this._Model=b8e.SceneEntity.get(),this._Model.addToParent(this._skin.node_model),this._prizeList=new game.PrizeList(10,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize);var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FIRST_RECHARGE_PRIZE);this._prizeInfo.setupById(e),this._prizeList.setData(this._prizeInfo),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.bg_node)},onShow:function(){this.updateCoinRemain(),this.showModel(),this.updatePanel(),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("firstRecharge/firstRecharge",!0),null,null,{useManifest:!1}),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.rechargeSuccess),b8e.evt.addG(this,game.PayEvents.PAY_EVENT_XIAN_LAI_UPDATE_COIN_REMAIN,this.updateCoinRemain)},onHide:function(){this._list&&this._list.hide(),this._bgSprite&&this._bgSprite.unloadTexture(),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.rechargeSuccess),b8e.evt.rmvG(this,game.PayEvents.PAY_EVENT_XIAN_LAI_UPDATE_COIN_REMAIN,this.updateCoinRemain)},updateCoinRemain:function(){if(game.IS_HUO_SHU){var e=game.HuoShuSDK.getAppId();if("2038"==e||"2066"==e){this._skin.xlNode.active=!0;var t="",i=game.LoginConfig.coinRemain;1e8<=i?(i=i/1e8-.005,t=game.ValueUtil.getDigitsValueByNum(i,2)+"亿"):1e4<=i?(i=i/1e4-.005,t=game.ValueUtil.getDigitsValueByNum(i,2)+"万"):t=i+"",b8e.log("闲徕updateCoinRemain（首充）：_coinRemainNum："+i+"_coinRemainString："+t),b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e3).call(this.delayShow,this,[t])}else this._skin.xlNode.active=!1}else this._skin.xlNode.active=!1},delayShow:function(e){this._skin.lab_num.string=e},updatePanel:function(){this._list.show();var e=game.ccfg.NormalRechargeCfg.getFirstRechargeArr();this._list.setData(e)},rechargeSuccess:function(){this.hide()},showModel:function(){var e,t=game.ccfg.BianshenCfg.getUiPosterById(2546);e=game.ClientCfg.getUiUnits(t);var i=this._Model.getAnimator(game.AnimatorType.BODY,1);e?(i||(i=this._Model.addAnimator(game.AnimatorType.BODY,1,-10)),i.load(e),i.setScale(1.2,1.2),i.play()):i&&i.clear()},clearAnimator:function(){this._anim&&this._anim.clear()}})},{}],357:[function(e,t,i){"use strict";e("./FirstRechargePanel")},{"./FirstRechargePanel":356}],358:[function(e,t,i){"use strict";e("./panel/FunctionPreparePanel"),e("./panel/FunctionOpenPanel")},{"./panel/FunctionOpenPanel":360,"./panel/FunctionPreparePanel":361}],359:[function(e,t,i){"use strict";game.appModule.FunctionActivationPanel=game.SkinUIPanel.extends({_spriteName:null,mount_type:"mount",wing_type:"wing",fabao_type:"fabao",beauty_type:"beauty",_accessoryModel:null,activationType:"",_beautyId:0,_skillIcon:null,ctor:function(e){this._super(e)},init:function(){this._super(),this._skin.power_num.string="",this._spriteName||(this._spriteName=b8e.Sprite.get(),this._spriteName.addToParent(this._skin.img_name)),this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.model_node)),this._skillIcon||(this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_D),this._skillIcon.addToParent(this._skin.skill_icon))},getButtonByName:function(e){switch(e){case"btnSure":return!this._skin||this._skin.sure_btn}return null},onShow:function(){b8e.evt.onC(this._skin.sure_btn,this.onSureBtn,this)},onRefresh:function(){},onHide:function(){if(this._skin.power_num.string=0,this._beautyId=0,this._spriteName&&this._spriteName.unloadTexture(),this._accessoryModel){var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.clear(),(e=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1))&&e.clear()}b8e.evt.offC(this._skin.sure_btn,this.onSureBtn,this)},setBeautyId:function(e){return this._beautyId=0|e,[]},setDataByType:function(e){var t,i,n,s,a,o=!1;switch(this.activationType=e,this._skin.unlock_skill_node.active=!1,this._skin.sure_btn.setPosition(320,280),this.activationType){case this.mount_type:t=game.AccessoryType.Mount,i=game.Direction.getRadian(game.Direction.DownRight);break;case this.wing_type:t=game.AccessoryType.Wing,i=game.Direction.getRadian(game.Direction.Down);break;case this.fabao_type:t=game.AccessoryType.FaBao,i=game.Direction.getRadian(game.Direction.Down);break;case this.beauty_type:o=!0,i=game.Direction.getRadian(game.Direction.None)}if(o)r=game.ccfg.BeautyDataCfg.getBeautyInfoById(this._beautyId),s=game.ClientCfg.getBeautyNameUrlByIconName(r.nameRes),this._skin.power_num.string=game.ccfg.BeautyFavorCfg.getBeautyFightAmountById(this._beautyId,1);else if(this._mgr=game.AccessoryMgr.getMgrByType(t),this._mgr){this._mgr.onInit();var r=this._mgr.getMinStageLvCfg(1);if(s=game.ClientCfg.getAccessoryUrl(r.name1),r){if(r.unlockedSpell){this._skin.unlock_skill_node.active=!0;var h=game.ccfg.SpellCfg.getSpellById(r.unlockedSpell);this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_D),this._skillIcon.setData(r.unlockedSpell,!1),this._skillIcon.setAnchor(.5,.5),this._skillIcon.setScale(1.2,1.2),this._skillIcon.show(),this._skin.skill_desc.string=game.html.getText(game.html.getColorByQuality(h.quality),h.name)+"\n"+h.desc,this._skin.sure_btn.setPosition(320,160)}this._skin.power_num.string=r.power}}if(r){switch(n=o?1:r.uiScale,this._spriteName&&this._spriteName.loadTexture(s,null,null,{useManifest:!1}),this.activationType){case this.mount_type:a=game.ClientCfg.getMount(r.res);break;case this.wing_type:a=game.ClientCfg.getWing(r.res);break;case this.fabao_type:a=game.ClientCfg.getFaBao(r.res);break;case this.beauty_type:a=game.ClientCfg.getBeauty(r.res)}this._accessoryModel.setFaceRadian(i);var g=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);a?(g||(g=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),g.load(a),g.play(),g.setScale(n,n)):g&&g.clear(),g=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1),!o&&t==game.AccessoryType.Mount&&r.head?(g||(g=this._accessoryModel.addAnimator(game.AnimatorType.MOUNT_HEAD,1,10)),a=game.ClientCfg.getMount(r.head),g.load(a),g.play(),g.setScale(n,n)):g&&g.clear(),r.posY?this._accessoryModel.setPosition(0,r.posY):this._accessoryModel.setPosition(0,0)}return[]},onSureBtn:function(){if(this.activationType){switch(this.activationType){case this.mount_type:case this.wing_type:case this.fabao_type:this._mgr&&this._mgr.addExpAccessoryOnce();break;case this.beauty_type:game.beauty.sendGetBeauty(this._beautyId)}this.hide()}else this.hide()}})},{}],360:[function(e,t,i){"use strict";game.appModule.FunctionOpenPanel=game.SkinUIPanel.extends({_iconUrl:null,ctor:function(e){this._super(e)},init:function(){this._super(),this._skin.labDesc.string="",this._skin.icon.spriteFrame=null},getButtonByName:function(e){switch(e){case"btnClose":return!this._skin||this._skin.closeBtn}return null},onShow:function(){},onRefresh:function(){},onHide:function(){this._skin.labDesc.string="",this._skin.icon.spriteFrame=null},setDescription:function(e){return this._skin.labDesc.string=e,[]},setIcon:function(e){return this._skin.icon.spriteFrame=null,this._iconUrl&&(b8e.res.unloadRes(this._iconUrl,this.onIconComplete,this),this._iconUrl=null),this._iconUrl=game.ClientCfg.getImgUrl(e),b8e.res.loadRes(this._iconUrl,b8e.SpriteFrame,this.onIconComplete,this,null,{useManifest:!1}),[]},onIconComplete:function(e,t){e?b8e.error(e):this._skin.icon.spriteFrame=t.getFrame()}})},{}],361:[function(e,t,i){"use strict";game.appModule.FunctionPreparePanel=game.SkinUIPanel.extends({_iconUrl:null,_triggerData:null,_desc:null,ctor:function(e){this._super(e)},init:function(){this._super(),this._skin.labDesc.string="",this._skin.icon.spriteFrame=null},onShow:function(){b8e.evt.onC(this._skin.previewBtn,this.onOpenFucntionPreveiw,this)},onRefresh:function(){},onHide:function(){this._skin.labDesc.string="",this._skin.icon.spriteFrame=null,this._triggerData=null,this._desc=null,b8e.evt.offC(this._skin.previewBtn,this.onOpenFucntionPreveiw,this)},onOpenFucntionPreveiw:function(){game.app.show(game.AppConstant.FUNCTION_PREVIEW_PANEL)},setTriggerData:function(e){return!!this._skin&&(this._triggerData=e,this.updateDescription(),!0)},setDescription:function(e){return this._desc=e,this.updateDescription(),[]},updateDescription:function(){if(this._desc){var e="";if(-1<(e=this._desc).indexOf("{TaskDiffSeq}")&&this._triggerData){var t,i=0,n=game.quest.questInfo;n&&(i=n.sequence),t=this._triggerData.maxTaskSequence-i+1,e=e.replace("{TaskDiffSeq}",t)}this._skin.labDesc.string=e}},setIcon:function(e){return this._skin.icon.spriteFrame=null,this._iconUrl&&(b8e.res.unloadRes(this._iconUrl,this.onIconComplete,this),this._iconUrl=null),this._iconUrl=game.ClientCfg.getImgUrl(e),b8e.res.loadRes(this._iconUrl,b8e.SpriteFrame,this.onIconComplete,this,null,{useManifest:!1}),[]},onIconComplete:function(e,t){e?b8e.error(e):this._skin.icon.spriteFrame=t.getFrame()}})},{}],362:[function(e,t,i){"use strict";game.FunctionPreviewItem=game.SkinUI.extends({m_data:null,_iconSp:null,ctor:function(){this._super("funcs/FunctionPreviewItemSkin","FunctionPreviewItemSkin")},init:function(){this._iconSp=b8e.Sprite.get(),this._iconSp.setAnchor(.5,.5),this._iconSp.addToParent(this._skin.icon)},getWidth:function(){return 270},getHeight:function(){return 110},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){if((this.m_data=e)&&this._skin)if(this._iconSp&&this._iconSp.loadTexture(game.ClientCfg.getImgUrl(e.Icon),null,null,{useManifest:!1}),this._skin.funcopenDesc.string=e.Desc,game.funcOpen.checkOpen(e.FuncId))this._skin.sp_yikaiqi.active=!0,this._skin.functaskDecs_node.active=!1;else{this._skin.sp_yikaiqi.active=!1,this._skin.functaskDecs_node.active=!0;var t=game.ccfg.ClientFunctionOpenCfg.getDataById(e.FuncId);this._skin.functaskDecs.string=this.updateDescription(t)}},updateDescription:function(e){var t=game.ccfg.MainQuestCfg.getQuestById(e.questId),i=e.closeTips;if(i){if(-1<i.indexOf("{TaskDiffSeq}")&&t){var n,s=0,a=game.quest.questInfo;a&&(s=a.sequence),n=t.sequence-s+1,i=i.replace("{TaskDiffSeq}",n)}return i}}})},{}],363:[function(e,t,i){"use strict";game.appModule.FunctionPreviewPanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},init:function(){this.list||(this.list=new b8e.List(this._skin.list,game.FunctionPreviewItem))},onShow:function(){this.list.show();var e=game.ccfg.FunctionPreviewCfg.getDatas();this.list.setData(e)},onHide:function(){this.list&&this.list.hide()}})},{}],364:[function(e,t,i){"use strict";game.FundEvents=b8e.Enum({FUND_BUY_SUCCESS:b8e.Event.nextCode(),FUND_COLLECT_SUCCESS:b8e.Event.nextCode()})},{}],365:[function(e,t,i){"use strict";e("./manager/FundMgr"),e("./event/FundEvents"),e("./panel/FundItem")},{"./event/FundEvents":364,"./manager/FundMgr":366,"./panel/FundItem":367}],366:[function(e,t,i){"use strict";game.FundMgr=b8e.Object.extends({isBuyFund:!1,collectStatesArr:null,ctor:function(){this._super(),this.collectStatesArr=[]},synFundInfo:function(e){this.collectStatesArr=e},synFundBuyResponse:function(){this.isBuyFund=!0,b8e.evt.dptG(game.FundEvents.FUND_BUY_SUCCESS)},synFundCollectResponse:function(e){this.collectStatesArr.push(e),this.isDisappear()&&b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.FundEvents.FUND_COLLECT_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},getFundArr:function(){return game.ccfg.FundRechargeCfg.getFundRechargeArr()},isDisappear:function(){var e=game.ccfg.FundRechargeCfg.getDatasCount();if(this.collectStatesArr)return this.collectStatesArr.length>=e},isFundCollect:function(){if(this.isBuyFund){for(var e=this.getFundArr(),t=game.mainRole.mainRoleData.getLv(),i=0,n=0;n<e.length;n++){t>=e[n].level&&i++}if(i>this.collectStatesArr.length)return!0}return!1},isAlertFund:function(){return!!this.isFundCollect()}}),game.FundMgr._instance=null,game.FundMgr.inst=function(){return game.FundMgr._instance||(game.FundMgr._instance=new game.FundMgr),game.FundMgr._instance}},{}],367:[function(e,t,i){"use strict";game.FundItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super("fund/FundItemSkin","FundItemSkin"),this._prizeInfo=new game.PrizeInfo,this._data=e},onShow:function(){this.initItem(),this.setData(this._data),b8e.evt.onC(this._skin.btn_receive,this.onClickReceiveBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_receive,this.onClickReceiveBtn,this)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize))},setData:function(e){if(this._data=e,this._skin&&this._data){this._skin.lab_desc.string="等级达到"+e.level+"级",this._prizeInfo.setupById(e.prize),this._prizeList.setData(this._prizeInfo);var t=game.mainRole.mainRoleData.getLv();game.fund.isBuyFund&&t>=e.level?b8e.ShaderUtil.reset(this._skin.btn_receive):b8e.ShaderUtil.setGray(this._skin.btn_receive);for(var i=game.fund.collectStatesArr,n=!0,s=0;s<i.length;s++){var a=i[s];e.level==a&&(n=!1)}this._skin.btn_receive.active=n}},onClickReceiveBtn:function(){var e=game.mainRole.mainRoleData.getLv();game.fund.isBuyFund&&e>=this._data.level&&game.PaySender.reqCollectFund(this._data.level),game.fund.isBuyFund&&e<this._data.level&&game.notice.show("您的等级还未达到")},getWidth:function(){return 535},getHeight:function(){return 105}})},{}],368:[function(e,t,i){"use strict";game.GameAlertBtnType=b8e.Enum({CONFIRM:0,CANCEL:1,CLOSE:2})},{}],369:[function(e,t,i){"use strict";game.GameAlertInfo=b8e.Object.extends({alertType:0,string:"",isShow:!0,obj:null,isShowTips:!0,confirmString:"确认",cancelString:"取消",oneTimeCount:0,allclearCount:0,desc:"",descFunc:null,isSelectTips:!0,ctor:function(){this._super()},clearInfo:function(){this.alertType=0,this.string="",this.isShow=!0,this.obj=null,this.isShowTips=!0,this.confirmString="确认",this.cancelString="取消",this.oneTimeCount=0,this.allclearCount=0,this.desc="",this.descFunc=null,this.isSelectTips=!0}})},{}],370:[function(e,t,i){"use strict";game.GameAlertType=b8e.Enum({None:0,OneBtn:1,TwoBtn:2,TwoYuanBaoBtn:3})},{}],371:[function(e,t,i){"use strict";game.GameAlertMgr=b8e.Object.extends({name:"GameAlertMgr",_gamAlertGUI:null,_gameAlertInfoMap:null,_map:null,ctor:function(){if(1==game.GameAlertMgr._singleton)throw new Error("GameAlertMgr 只能通过单例方法获取");this._super(),this._gameAlertInfoMap=b8e.HashMap.get(),this._map=b8e.HashMap.get(),this._map.set(100,{string:"次数不足\n提升VIP等级可增加次数",confirmString:"VIP特权",cancelString:"取 消"}),this._map.set(101,{string:"当前元宝不足,请前往充值",confirmString:"充 值",cancelString:"取 消"}),this._map.set(102,{string:"VIP等级不足，请前往提升",confirmString:"VIP特权",cancelString:"取 消"}),this._map.set(103,{string:"提升VIP等级可获得更多购买次数",confirmString:"VIP特权",cancelString:"取 消"})},gameAlertGUI:{get:function(){return this._gamAlertGUI||(this._gamAlertGUI=new game.GameAlertGUI),this._gamAlertGUI}},showAlert:function(e,t,i){this.gameAlertGUI.showAlert(e,t,i)},hideGameAlertUI:function(e){this.isNeedShowGameAlert(e)||this.gameAlertGUI.hideAlert(e)},setGameAlertInfoMap:function(e){this._gameAlertInfoMap.set(e.string,e)},isNeedShowGameAlert:function(e){return!!this._gameAlertInfoMap.get(e)},showVipAlert:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:101,i=this._map.get(t);if(i)if(game.shield.isShieldRecharge())switch(t){case 100:case 103:game.notice.show(game.html.getText(game.html.Q_RED,"次数不足"));break;case 101:game.notice.show("$不足",[game.html.getText(game.html.Q_RED,"元宝")])}else{var n=new game.GameAlertInfo;n.alertType=game.GameAlertType.TwoBtn,n.string=i.string,n.confirmString=i.confirmString,n.cancelString=i.cancelString,n.isShowTips=!1,e?this.showAlert(this,this.onShowRechargePanel,n):this.showAlert(this,this.onShowVipPanel,n)}},onShowVipPanel:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.TriggerMgr&&game.TriggerMgr.inst().customTriggerById(3137)}},onShowRechargePanel:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.pay.showPayPanel()}}}),game.GameAlertMgr._instance=null,game.GameAlertMgr._singleton=!0,game.GameAlertMgr.inst=function(){return game.GameAlertMgr._instance||(game.GameAlertMgr._singleton=!1,game.GameAlertMgr._instance=new game.GameAlertMgr,game.GameAlertMgr._singleton=!0),game.GameAlertMgr._instance}},{}],372:[function(e,t,i){"use strict";game.GameAlert=game.GameWidget.extends({_type:null,_callback:null,_string:null,_thisArg:null,_obj:null,_modalBgNode:null,_screenOriginPos:null,_graphicsModalImg:null,_modalBgColor:null,_tipsIsSelect:!0,gameAlertData:null,_gameAlertInfo:null,ctor:function(e,t,i){this._super("app/prefabs/app_module_skin/gameAlert/GameAlertSkin","GameAlertSkin"),this._gameAlertInfo=i,this._callback=t,this._thisArg=e,this._gameAlertInfo&&(this._string=this._gameAlertInfo.string,this._type=this._gameAlertInfo.type,this._obj=this._gameAlertInfo.obj)},onShow:function(){b8e.evt.onC(this._skin.one_btn,this.onClickOneBtn,this),b8e.evt.onC(this._skin.two_btn_one,this.onClickTwoBtnOneBtn,this),b8e.evt.onC(this._skin.two_btn_two,this.onClickTwoBtnTwoBtn,this),b8e.evt.onC(this._skin.closeBtn,this.onClickCloseBtn,this),b8e.evt.onC(this._skin.tips_btn,this.onClickTipsBtn,this),b8e.evt.onC(this._skin.lab_desc.node,this.onClickDesc,this),this.onShowWnd(),this.onResize(),this._addModalBg(),this.registerEvent()},onHide:function(){this._skin.lab_confirm1.string="确认",this._skin.lab_cancel.string="取消",this._skin.lab_string.string="",this._skin.lab_confirm2.string="确认",null!=this._graphicsModalImg&&this._graphicsModalImg.clear(),this._modalBgNode&&this._modalBgNode.removeFromParent(),b8e.evt.offC(this._skin.one_btn,this.onClickOneBtn,this),b8e.evt.offC(this._skin.two_btn_one,this.onClickTwoBtnOneBtn,this),b8e.evt.offC(this._skin.two_btn_two,this.onClickTwoBtnTwoBtn,this),b8e.evt.offC(this._skin.closeBtn,this.onClickCloseBtn,this),b8e.evt.offC(this._skin.tips_btn,this.onClickTipsBtn,this),b8e.evt.offC(this._skin.lab_desc.node,this.onClickDesc,this)},onShowWnd:function(){if(this._gameAlertInfo){switch(this._skin.two_node.active=!1,this._skin.one_node.active=!1,this._skin.coin_root.active=!1,this._gameAlertInfo.alertType){case game.GameAlertType.OneBtn:this._skin.one_node.active=!0,this._skin.lab_confirm2.string=this._gameAlertInfo.confirmString;break;case game.GameAlertType.TwoBtn:this._skin.two_node.active=!0,this._skin.lab_confirm1.string=this._gameAlertInfo.confirmString,this._skin.lab_cancel.string=this._gameAlertInfo.cancelString;break;case game.GameAlertType.TwoYuanBaoBtn:this._skin.coin_root.active=!0,this._skin.two_node.active=!0,this._skin.lab_confirm1.string=this._gameAlertInfo.confirmString,this._skin.lab_cancel.string=this._gameAlertInfo.cancelString,this._skin.lab_yuanbao1.string=this._gameAlertInfo.oneTimeCount,this._skin.lab_yuanbao2.string=this._gameAlertInfo.allclearCount}this._gameAlertInfo.isShowTips?(this._tipsIsSelect=this._gameAlertInfo.isSelectTips,this._skin.img_tips_select.active=this._tipsIsSelect,this._skin.tips_node.active=!0):this._skin.tips_node.active=!1,this._skin.lab_string.string=this._string,""!=this._gameAlertInfo.desc?(this._skin.lab_desc.string=this._gameAlertInfo.desc,this._skin.lab_desc.node.y=this._skin.lab_string.node.y-this._skin.lab_string.node.height-8):this._skin.lab_desc.string=""}},onClickOneBtn:function(){this._gameAlertInfo.isShowTips&&this._tipsIsSelect&&game.gameAlert.setGameAlertInfoMap(this._gameAlertInfo),this.hide(),this._callback&&this._callback.call(this._thisArg,this._gameAlertInfo,game.GameAlertBtnType.CONFIRM)},onClickTwoBtnOneBtn:function(){this._gameAlertInfo.isShowTips&&this._tipsIsSelect&&game.gameAlert.setGameAlertInfoMap(this._gameAlertInfo),this.hide(),this._callback&&this._callback.call(this._thisArg,this._gameAlertInfo,game.GameAlertBtnType.CONFIRM)},onClickTwoBtnTwoBtn:function(){this.hide(),this._callback&&this._callback.call(this._thisArg,this._gameAlertInfo,game.GameAlertBtnType.CANCEL)},onClickTipsBtn:function(){this._tipsIsSelect?(this._tipsIsSelect=!1,this._skin.img_tips_select.active=!1):(this._tipsIsSelect=!0,this._skin.img_tips_select.active=!0)},onClickCloseBtn:function(){this.hide(),this._callback&&this._callback.call(this._thisArg,this._gameAlertInfo,game.GameAlertBtnType.CLOSE)},onResize:function(){this._skin&&(this.x=(b8e.stageWidth-this._skin.node.width)/2,this.y=(b8e.stageHeight-this._skin.node.height)/2)},onClickDesc:function(){this.hide(),this._gameAlertInfo&&this._gameAlertInfo.descFunc&&this._gameAlertInfo.descFunc.call(this._thisArg)},_addModalBg:function(){if(null==this._modalBgNode){var e=b8e.BaseDisplay.get();this._modalBgNode=e.getNode()}this.addChild(this._modalBgNode),null==this._screenOriginPos&&(this._screenOriginPos=this.convertToNodeSpaceAR(cc.Vec2.ZERO)),this._modalBgNode.setAnchorPoint(0,0),this._modalBgNode.setPosition(this._screenOriginPos),this.setBgNodeSize(this._modalBgNode)},setBgNodeSize:function(e){e.setContentSize(b8e.stageWidth,b8e.stageHeight),this._graphicsModalImg||(this._graphicsModalImg=b8e.Graphics.get(),this._graphicsModalImg.addToParent(e)),this._graphicsModalImg.clear();var t=this.x,i=this.y;this._modalBgNode.x=-t,this._modalBgNode.y=-i,this._modalBgNode.width=b8e.stageWidth+t,this._modalBgNode.height=b8e.stageHeight+i;var n=this._graphicsModalImg.getGraphics();this._modalBgColor||(this._modalBgColor=b8e.ColorUtil.toCCColor(3003121664)),n.fillColor=this._modalBgColor,n.rect(-t,-i,b8e.stageWidth+t,b8e.stageHeight+i),n.fill(),e.setLocalZOrder(-999999999)},registerEvent:function(){this._modalBgNode&&(this._modalBgNode.touchEffectDisabled=!1,b8e.evt.onC(this._modalBgNode,this.onModalBgNode,this))},unregisterEvent:function(){this._modalBgNode&&b8e.evt.offC(this._modalBgNode,this.onModalBgNode,this)},onModalBgNode:function(){},hide:function(){this._modalBgNode&&this._modalBgNode.removeFromParent(),this.unregisterEvent(),this._super()}})},{}],373:[function(e,t,i){"use strict";game.GameAlertGUI=b8e.BaseDisplay.extends({_gameAlertMap:null,_gameAlertInfoMap:null,ctor:function(){this._super(),this._gameAlertMap=b8e.HashMap.get(),this._gameAlertInfoMap=b8e.HashMap.get()},show:function(){},hide:function(){},showAlert:function(e,t,i){if(i){var n=i.string;if(game.gameAlert.isNeedShowGameAlert(n))t.call(e,i,game.GameAlertBtnType.CONFIRM);else{var s=b8e.layer.getTopLayer();this._gameAlert=new game.GameAlert(e,t,i),this._gameAlertMap.set(n,this._gameAlert),s.addChild(this._gameAlert),this._gameAlert.setLocalZOrder(999999999),this._gameAlert.show()}}},hideAlert:function(e){this._gameAlertMap.has(e)&&(this._gameAlertMap.get(e).hide(),this._gameAlert.del(e))}})},{}],374:[function(e,t,i){"use strict";game.GMCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Cmd.ExecGmCmdResponse,this.onExecGmCmdResponse,this)},onExecGmCmdResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ExecGmCmdResponse).code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.notice.show("GM指令发送成功！")}})},{}],375:[function(e,t,i){"use strict";e("./GMCmd")},{"./GMCmd":374}],376:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_6"),e("./manager/managerIndex_14"),e("./panel/panelIndex_25"),e("./sender/senderIndex_8")},{"./cmdlistener/cmdlistenerIndex_6":375,"./manager/managerIndex_14":378,"./panel/panelIndex_25":382,"./sender/senderIndex_8":384}],377:[function(e,t,i){"use strict";game.GMMgr=b8e.Object.extends({name:"GMMgr",ctor:function(){if(1==game.GMMgr._singleton)throw new Error("GMMgr 只能通过单例方法获取");this._super()}}),game.GMMgr._instance=null,game.GMMgr._singleton=!0,game.GMMgr.inst=function(){return game.GMMgr._instance||(game.GMMgr._singleton=!1,game.GMMgr._instance=new game.GMMgr,game.GMMgr._singleton=!0),game.GMMgr._instance}},{}],378:[function(e,t,i){"use strict";e("./GMMgr")},{"./GMMgr":377}],379:[function(e,t,i){"use strict";game.appModule.GMDescPanel=game.SkinUIPanel.extends({_skin:null,_labArr:null,ctor:function(e){this._super(e),this._skin=this._skin,this._labArr=[]},onShow:function(){this.onUpdateInfo()},onHide:function(){},onUpdateInfo:function(){var e=game.ccfg.GmCmdCfg.getDatas(),t="";if(e&&0<e.length){for(var i=0;i<e.length;i++){var n=e[i];n&&(t+="<color=#00ff00>"+n.format+"("+n.desc+")<br/></c>")}this._skin.lab_node.string=t}}})},{}],380:[function(e,t,i){"use strict";game.GMItem=game.SkinUI.extends({_gmData:null,ctor:function(e){this._super("gm/GMItemSkin","GMItemSkin"),this._gmData=e},onShow:function(){this.setData(this._gmData),b8e.evt.onC(this._skin.btn_gm,this.onClick,this)},onHide:function(){b8e.evt.offC(this._skin.btn_gm,this.onClick,this),this._skin.lab_desc.string=""},setData:function(e){e&&(this._gmData=e,this._skin.lab_desc.string=e.desc)},onClick:function(){b8e.evt.dptG(game.EquipEvt.GM_UPDATE,{gmData:this._gmData})}})},{}],381:[function(e,t,i){"use strict";game.appModule.GMPanel=game.SkinUIPanel.extends({_skin:null,_GMPOrder:"",_GMParameter:"",_itemArr:null,ctor:function(e){this._super(e),this._itemArr=[]},onShow:function(){this.onUpdateInfo(),b8e.evt.onC(this._skin.btn_ok,this.onOk,this),b8e.evt.onC(this._skin.btn_desc,this.onOpenPanel,this),b8e.evt.addG(this,game.EquipEvt.GM_UPDATE,this.onUpdateGMDesc)},onHide:function(){b8e.evt.offC(this._skin.btn_ok,this.onOk,this),b8e.evt.offC(this._skin.btn_desc,this.onOpenPanel,this),b8e.evt.rmvG(this,game.EquipEvt.GM_UPDATE,this.onUpdateGMDesc)},onUpdateInfo:function(){this.clearItem();var e=game.ccfg.GmCmdShortCutCfg.getAllCmdShortCutList();if(e&&0<e.length)for(var t,i,n=this._itemArr.length,s=0;s<e.length;s++)(t=e[s])&&(s<n?(i=this._itemArr[s]).setData(t):(i=new game.GMItem(t),this._itemArr.push(i)),i.setVisible(!0),i.setAnchor(.5,.5),i.setSize(150,40),i.addToParent(this._skin.list.content),i.show())},onUpdateGMDesc:function(e){if(e&&e.data){var t=e.data.gmData;t&&(this._GMPOrder=t.desc,this._GMParameter=t.cmdLine,this._skin.editbox_order.string=t.desc,this._skin.editbox_parameter.string=t.cmdLine)}},clearItem:function(){for(var e=0;e<this._itemArr.length;e++){var t=this._itemArr[e];t&&t.hide()}},onOk:function(){var e=this._skin.editbox_parameter.string;this._GMParameter=e,game.GMSender.gmRequest(this._GMParameter)},onOpenPanel:function(){game.app.show(game.AppConstant.GM_DESC_PANEL)}})},{}],382:[function(e,t,i){"use strict";e("./GMItem"),e("./GMPanel"),e("./GMDescPanel")},{"./GMDescPanel":379,"./GMItem":380,"./GMPanel":381}],383:[function(e,t,i){"use strict";(game.GMSender=function(){}).gmRequest=function(e){var t=game.pbmsg.ExecGmCmdRequest;t.cmd=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Cmd.ExecGmCmdRequest;b8e.sendN(i)}},{}],384:[function(e,t,i){"use strict";e("./GMSender")},{"./GMSender":383}],385:[function(e,t,i){arguments[4][263][0].apply(i,arguments)},{dup:263}],386:[function(e,t,i){"use strict";game.GoldedPigPage=game.SkinUI.extends({_timesItemGrids:null,_bg:null,_title:null,_iconList:null,_imgGet:null,_imgDesc:null,ctor:function(){this._super("goldedPig/GoldedPigSkin","GoldedPigSkin"),this._iconList=[]},init:function(){var e,t,i,n,s,a,o=game.ccfg.CountAwardCfg.getCountAwardListByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST),r=o.length;r=3<r?r=3:r;for(var h=this._iconList.length=0;h<r;h++)(e=o[h])&&(t=h+1,this._skin["timesDes_"+t].string=e.count+"次可领",this._skin["timesPrizeAlert_"+t].active=!1,(s=game.ccfg.PrizeCfg.getPrizeById(e.dropId))&&0!=s.length&&(n=s[0],i=new game.ItemInfo,game.ItemInfoUtil.createCfgItemInfo(i,n.itemId),i.num=n.num,(a=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.GOLDED_PIG_CONTAINER_ID),a.addToParent(this._skin["timesPrize_"+t]),a.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(a,i,!1),a.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),a.iconSize=game.IcoSizeEnum.SIZE_90,a.setImgSelect(!1,1),a.sortLayer(),this._iconList.push(a)));var g=game.RouletteMgr.inst().getZhuanPanArr();for(r=g.length,h=0;h<r;h++)(e=g[h])&&(i=new game.ItemInfo,game.ItemInfoUtil.createCfgItemInfo(i,e.itemId),i.num=e.itemNum,(a=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.GOLDED_PIG_CONTAINER_ID),a.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(a,i,!1),a.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),a.iconSize=game.IcoSizeEnum.SIZE_90,a.sortLayer(),a.setPosition(80*h,0),a.addToParent(this._skin.prizeNode));e=game.ccfg.ZhuanPanCostCfg.getCostByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST),this.moneyCost=e.money,this._title||(this._title=b8e.Sprite.get(),this._title.setAnchor(.5,.5),this._title.addToParent(this._skin.bigTitle),this._title.loadTexture(game.ClientCfg.getImgUrl("goldedPig/advertisement",!0),null,null,{useManifest:!1})),this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(.5,.5),this._bg.addToParent(this._skin.bigBg),this._bg.loadTexture(game.ClientCfg.getImgUrl("goldedPig/bg",!0),null,null,{useManifest:!1})),this._imgGet=b8e.Sprite.get(),this._imgGet.setAnchor(.5,.5),this._imgGet.addToParent(this._skin.img_get),this._imgGet.loadTexture(game.ClientCfg.getImgUrl("goldedPig/img_get"),null,null,{useManifest:!1}),this._imgDesc=b8e.Sprite.get(),this._imgDesc.setAnchor(.5,.5),this._imgDesc.addToParent(this._skin.img_desc),this._imgDesc.loadTexture(game.ClientCfg.getImgUrl("goldedPig/img_desc"),null,null,{useManifest:!1})},onClick:function(e){e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:game.ContainerId.GOLDED_PIG_CONTAINER_ID})},onShow:function(){b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.getCountAwardSuccess),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshAll),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.refreshAll),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.showPrize),b8e.evt.onC(this._skin.timesPrizeTouch_1,this.getTimesPrize1,this),b8e.evt.onC(this._skin.timesPrizeTouch_2,this.getTimesPrize2,this),b8e.evt.onC(this._skin.timesPrizeTouch_3,this.getTimesPrize3,this),b8e.evt.onC(this._skin.chouJiang_1,this.chouJiang1,this),b8e.evt.onC(this._skin.chouJiang_10,this.chouJiang10,this),b8e.evt.onC(this._skin.rechargeNode,this.recharge,this),this.refreshAll()},onHide:function(){b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.getCountAwardSuccess),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.refreshAll),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.refreshAll),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.showPrize),b8e.evt.offC(this._skin.timesPrizeTouch_1,this.getTimesPrize1,this),b8e.evt.offC(this._skin.timesPrizeTouch_2,this.getTimesPrize2,this),b8e.evt.offC(this._skin.timesPrizeTouch_3,this.getTimesPrize3,this),b8e.evt.offC(this._skin.chouJiang_1,this.chouJiang1,this),b8e.evt.offC(this._skin.chouJiang_10,this.chouJiang10,this),b8e.evt.offC(this._skin.rechargeNode,this.recharge,this),this._timer&&this._timer.stop()},updateTime:function(){var e=game.active.getSubTypeInfo(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);if(e){var t=e.endTime-game.SysTime.curTime;0<t?this._skin.endTime.string=b8e.TimeUtil.formatTime(t):(this._skin.endTime.string="已结束",this._timer.stop())}},showPrize:function(){this.refreshAll(),game.roulette.zhuanPanCallBack()},refreshAll:function(){var e=game.PayMgr.inst().getConditionsInfo(game.ActivityConditionType.MIDDLE_COST_RECHARGE);if(e){var t=game.RouletteMgr.inst().getZhuanPanInfoByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);if(t){var i=e.value/this.moneyCost>>0;i-=t.zhuanPanCount;var n=e.value%this.moneyCost,s=this.moneyCost-n;this._skin.haveTimes.string="剩余次数:"+i,this._skin.moneyDes.string="再充值<color=#00ff00>"+s+"</c>元可获得1次抽奖机会",this._skin.moneyCount.string=n+"/"+this.moneyCost,this._skin.progress.x=this._skin.progress.width*(n/this.moneyCost-1),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500),this.getCountAwardSuccess(),t.zhuanPanCount<3||t.zhuanPanCount%15==14?this._skin.img_get.active=!0:this._skin.img_get.active=!1}}},chouJiang1:function(){game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST)},chouJiang10:function(){game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST)},getTimesPrize1:function(){this.getTimesPrize(0)},getTimesPrize2:function(){this.getTimesPrize(1)},getTimesPrize3:function(){this.getTimesPrize(2)},getTimesPrize:function(e){var t=game.ccfg.CountAwardCfg.getCountAwardListByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);if(t&&t.length>=e+1){var i=t[e];game.ActiveSender.collectZhuanPanCountAward(i.count,game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST)}},getCountAwardSuccess:function(){var e=game.RouletteMgr.inst().getZhuanPanInfoByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);if(e&&e.awardRecord){var t,i,n,s=game.ccfg.CountAwardCfg.getCountAwardListByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST),a=s.length;a=3<a?a=3:a;for(var o=0;o<a;o++)(t=s[o])&&(i=o+1,n=this._skin["timesPrizeAlert_"+i],-1!=e.awardRecord.indexOf(t.count)&&this._iconList[o]&&this._iconList[o].setImgSelect(!0,1),-1==e.awardRecord.indexOf(t.count)&&e.zhuanPanCount>=t.count?n.active=!0:n.active=!1)}},recharge:function(){game.pay.showPayPanel()}})},{}],387:[function(e,t,i){"use strict";e("./panel/panelIndex_85")},{"./panel/panelIndex_85":390}],388:[function(e,t,i){"use strict";game.GotoItem=game.SkinUI.extends({_gotoInfo:null,_turnInfo:null,_gotoPanel:"",ctor:function(){this._super("goto/GotoItemSkin","GotoItemSkin")},getWidth:function(){return 320},getHeight:function(){return 56},onShow:function(){this.setData(this._gotoInfo),b8e.evt.onC(this._skin.node_click,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClickItem,this)},setData:function(e){if(this._gotoInfo=e,this._skin&&this._gotoInfo){var t=parseInt(e.id);this._turnInfo=game.ccfg.GotoCfg.getDataByKey(t),this._turnInfo&&(this._skin.lab_goto.string=this._turnInfo.title)}},onClickItem:function(){if(this._turnInfo){var e=game.ccfg.ClientTriggerCfg.getDataById(this._turnInfo.triggerId);if(e){var t=game.ccfg.ClientCommandCfg.getDataById(e.triggerCommandIds);if(t)switch(parseInt(e.triggerCommandIds)){case game.GotoType.MOUNT_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.GotoType.FABAO_UP:game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.GotoType.WING_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;default:game.funcOpen.checkOpenWithTips(t.functionOpenId)&&game.TriggerMgr.inst().triggerById(e.triggerCommandIds)}game.app.isShow(game.AppConstant.GOTO_PANEL)&&game.app.hide(game.AppConstant.GOTO_PANEL)}}}})},{}],389:[function(e,t,i){"use strict";game.appModule.GotoPanel=game.SkinUIPanel.extends({_itemGrid:null,_itemInfo:null,_gotoArr:null,_list:null,_curNum:0,ctor:function(e){this._super(e),this._gotoArr=[]},onShow:function(){this.data&&(this._list||(this._list=new b8e.List(this._skin.list,game.GotoItem)),this._list.show(),this._itemGrid||(this._itemGrid=game.GridUtil.creatItemGrid(this,this._skin.node_icon),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID)),this._itemInfo=this.data.info,this._curNum=this.data.num?this.data.num:0,this.updataItem())},onHide:function(){this._list&&this._list.hide(),game.GridUtil.setItemGrid(this._itemGrid,null)},updataItem:function(){this._itemInfo?(game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo),this._itemGrid.sortLayer(),this._skin.lab_name.string=this._itemInfo.name,this._skin.lab_haveNum.string="数量："+this._curNum,this._skin.lab_desc.string="材料不足，请通过以下途径获取",this._skin.lab_lvNum.string="等级："+this._itemInfo.level,this.synGotoInfo(this._itemInfo)):game.GridUtil.setItemGrid(this._itemGrid,null)},synGotoInfo:function(e){this._gotoArr.length=0;var t=e.goto.split(",");if(t){for(var i=0;i<t.length;i++){var n=new game.GotoInfo;n.id=t[i],this._gotoArr.push(n)}this._list.setData(this._gotoArr)}else this._list&&this._list.setData(null)}})},{}],390:[function(e,t,i){"use strict";e("./GotoPanel"),e("./GotoItem")},{"./GotoItem":388,"./GotoPanel":389}],391:[function(e,t,i){"use strict";e("./panel/panelIndex_6")},{"./panel/panelIndex_6":395}],392:[function(e,t,i){"use strict";game.BackPackGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 92},getWidth:function(){return 92},setData:function(e){this._itemInfo=e,this._itemInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo,!1),this._itemGrid.sortLayer())},onClick:function(e){if(this._itemInfo){this._itemInfo.isEquip?game.app.show(game.AppConstant.EQUIP_TIPS,this._itemInfo):this._itemInfo.type==game.GoodsType.SELF_SELECTION?game.app.show(game.AppConstant.SELECT_REWARD_PANEL,{itemInfo:this._itemInfo,containerId:game.ContainerId.BACK_CONTAINER_ID}):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.BACK_CONTAINER_ID})}}})},{}],393:[function(e,t,i){"use strict";game.BaseGrid=b8e.PrefabDisplay.extends({_skin:null,_containerId:-1,_type:0,_iconType:0,_baseData:null,_iconSprite:null,_index:-1,_data:null,_effect:null,_anim:null,_quality:-1,_iconName:"",_otherEffect:null,_otherAnim:null,_qualityEffect:"",ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1;this._super(),this.initialize(e,t,i)},initialize:function(e,t,i){this.iconType=e,this.containerId=i,this.baseData=t;var n="",s="";switch(this.iconType){case 0:n="app/prefabs/app_module_skin/uiCtr/icon/BaseIconSkin",s="BaseIconSkin";break;case 1:n="app/prefabs/app_module_skin/bianshen/BianshenGridSkin",s="BianshenGridSkin";break;case 2:n="app/prefabs/app_module_skin/bianshen/BianshenSlotSkin",s="BianshenSlotSkin"}this.loadPrefab(n,s,this.onComplete,this)},onComplete:function(){this._skin=this._script,this.commitData()},commitData:function(){},_setImgQuality:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(this._quality!=e){this._quality=e;var t="";switch(this.containerId){case game.ContainerId.BIANSHEN_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_SHOW_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_CARD_CONTAINER_ID:case game.ContainerId.BIANSHEN_BATTLE_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_BATTLE_LIST_ITEM_CONTAINER_ID:case game.ContainerId.BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_SLOT_CONTAINER_ID:t=game.ClientCfg.Bianshen_ALAST_URL;break;default:t=game.ClientCfg.GRIDS_ALAST_URL,game.resController.setQualitySpriteFrame(this._script.img_quality.node,e,t,this.containerId)}}},playOtherEffect:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;this._otherEffect||(this._otherEffect=b8e.BaseDisplay.get(),this._otherEffect.addToParent(this._skin.otherEffect)),e?(this._otherAnim||(this._otherAnim=b8e.Animator.get(t,1),this._otherEffect.addChild(this._otherAnim)),this._otherEffect.setVisible(!0),this._otherEffect.setScale(i,n),this._otherAnim.load(e),this._otherAnim.addFinishCallback(this.onCompleteOtherEffect,this),this._otherAnim.play()):this._otherAnim&&this._otherAnim.clear()},onCompleteOtherEffect:function(e){this._otherEffect.setVisible(!1)},clearOtherEffect:function(){this._otherAnim&&this._otherAnim.clear(),this._otherEffect&&this._otherEffect.setVisible(!1)},clearIcon:function(){this._iconSprite&&this._iconSprite.unloadTexture(),this._iconName=""},_setImgIcon:function(e){if(this._iconName!=e&&(this.clearIcon(),""!=(this._iconName=e)&&e&&(this._iconSprite||(this._iconSprite=b8e.Sprite.get()),this._script.img_icon&&this._iconSprite.addToParent(this._script.img_icon),e))){var t=game.ClientCfg.getImgUrl(e);this._iconSprite.loadTexture(t,null,null,{useManifest:!1}),this.baseData&&this.baseData.type==game.GoodsType.BIAN_SHEN_CARD?this._iconSprite.setScale(.8,.8):this._iconSprite.setScale(1,1)}},_setEffect:function(e){if(""!=e)switch(this._qualityEffect=e,this.containerId){case game.ContainerId.BIANSHEN_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_CARD_CONTAINER_ID:case game.ContainerId.BIANSHEN_BATTLE_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_SHOW_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:this.playQualityEffect(e,1.2,1.2);break;default:this.playQualityEffect(e,1,1)}else this.clearEffect()},playQualityEffect:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e){var n=game.ClientCfg.getUIFxs(e);this.addEffect(n,t,i)}},addEffect:function(e,t,i){this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.ITEM_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._effect.setScale(t,i),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.clear(),this._effect&&this._effect.setVisible(!1)},_setLeftTopImgIcon:function(e){if(this._script.img_leftTop.node.active=!1,e){this._script.img_leftTop.node.active=!0;var t="",i="";e.atlasUrl&&(t=e.atlasUrl),e.iconName&&(i=e.iconName),game.resController.setImgSpriteFrame(this._script.img_leftTop.node,t,i)}},_setRightTopImgIcon:function(e){if(this._script.img_rightTop.node.active=!1,e){this._script.img_leftTop.node.active=!0;var t="",i="";e.atlasUrl&&(t=e.atlasUrl),e.iconName&&(i=e.iconName),game.resController.setImgSpriteFrame(this._script.img_rightTop.node,t,i)}},_setImgLock:function(e){if(this._script.img_lock.node.active=!1,e){this._script.img_lock.node.active=!0;var t="",i="";e.atlasUrl&&(t=e.atlasUrl),e.iconName&&(i=e.iconName),game.resController.setImgSpriteFrame(this._script.img_lock.node,t,i)}},_setLabNum:function(e){this._script.lab_num.node.active=!1,e?(this._script.lab_num.node.active=!0,this._script.lab_num.string=e):this._script.lab_num.string=""},_setLeftTopNum:function(e){this._script.lab_leftTop.node.active=!1,0<e?(this._script.lab_leftTop.node.active=!0,this._script.lab_leftTop.string=e):this._script.lab_leftTop.string=""},_setRightTopNum:function(e){this._script.lab_rightTop.node.active=!1,0<e?(this._script.lab_rightTop.node.active=!0,this._script.lab_rightTop.string=e):this._script.lab_rightTop.string=""},_setName:function(e){this._script.lab_name.node.active=!1,e?(this._script.lab_name.node.active=!0,this._script.lab_name.string=e):this._script.lab_name.string=""},_setImgWear:function(e){this._script.img_wear.active=e},_setImgRefine:function(e){this._script.img_refine.active=e},_setMaskNode:function(e){this._script.maskNode.active=e},_setImgMask:function(e){this._script.img_mask.active=e},_setToggleBtn:function(e){this._script.toggle_btn.isChecked=e},_setImgExpire:function(e){this._script.img_expire.active=e},_setRedIcon:function(e){this._script.red_icon.active=e},imgQuality:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.callProp("_setImgQuality",e,this)}},imgIcon:{set:function(e){this.callProp("_setImgIcon",e,this)}},effect:{set:function(e){this.callProp("_setEffect",e,this)}},leftTopImgIcon:{set:function(e){this.callProp("_setLeftTopImgIcon",e,this)}},rightTopImgIcon:{set:function(e){this.callProp("_setRightTopImgIcon",e,this)}},imgLock:{set:function(e){this.callProp("_setImgLock",e,this)}},name:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.callProp("_setName",e,this)}},num:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.callProp("_setLabNum",e,this)}},leftTopNum:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.callProp("_setLeftTopNum",e,this)}},rigthTopNum:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.callProp("_setRightTopNum",e,this)}},imgWear:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setImgWear",e,this)}},imgRefine:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setImgRefine",e,this)}},maskNode:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setMaskNode",e,this)}},img_mask:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setImgMask",e,this)}},toggle_btn:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setToggleBtn",e,this)}},imgExpire:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setImgExpire",e,this)}},red_icon:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.callProp("_setRedIcon",e,this)}},baseData:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._baseData=e},get:function(){return this._baseData}},type:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;this._type=e},get:function(){return this._type}},index:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;this._index=e},get:function(){return this._index}},iconType:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;this._iconType=e},get:function(){return this._iconType}},containerId:{set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;this._containerId=e},get:function(){return this._containerId}}})},{}],394:[function(e,t,i){"use strict";game.RewardsGrid=b8e.BaseDisplay.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getHeight:function(){return 92},getWidth:function(){return 92},setData:function(e){if(this._itemInfo=e,this._itemInfo){if(!this._itemGrid){switch(this._itemInfo.baseType){case game.GoodsType.ITEM_INFO:this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90);break;case game.GoodsType.BIAN_SHEN_CARD:this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107);break;case game.GoodsType.RUNE:default:this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)}this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.REWRADS_CONTAINER_ID),this.addChild(this._itemGrid)}switch(this._itemGrid.fnOnClick(this,this.onClick),this._itemInfo.baseType){case game.GoodsType.ITEM_INFO:this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_90,game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo,!0);break;case game.GoodsType.BIAN_SHEN_CARD:this._itemGrid.setScale(game.IconScale.PERCENT_67,game.IconScale.PERCENT_67),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_107,game.GridUtil.setBianshenGrid(this._itemGrid,this._itemInfo,!0);break;case game.GoodsType.RUNE:this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_90,game.GridUtil.setRuneGrid(this._itemGrid,this._itemInfo,!0,!0);break;default:this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.iconSize=game.IcoSizeEnum.SIZE_90,game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo,!0)}this._itemGrid.sortLayer()}},onClick:function(e){if(this._itemInfo)switch(this._itemInfo.baseType){case game.GoodsType.ITEM_INFO:this._itemInfo.isEquip?game.app.show(game.AppConstant.EQUIP_TIPS,this._itemInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.REWRADS_CONTAINER_ID});break;case game.GoodsType.BIAN_SHEN_CARD:game.bianshen.showBianshenDetail(this._itemInfo);break;case game.GoodsType.RUNE:game.app.show(game.AppConstant.RUNE_TIPS_PANEL,{runeInfo:this._itemInfo,containerId:game.ContainerId.REWRADS_CONTAINER_ID});break;default:this._itemInfo.isEquip?game.app.show(game.AppConstant.EQUIP_TIPS,this._itemInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.REWRADS_CONTAINER_ID})}}})},{}],395:[function(e,t,i){"use strict";e("./BaseGrid"),e("./BackPackGrid"),e("./RewardsGrid")},{"./BackPackGrid":392,"./BaseGrid":393,"./RewardsGrid":394}],396:[function(e,t,i){"use strict";game.appModule.DressEquipPanel=game.SkinUIPanel.extends({_itemGrid:null,_itemInfo:null,_durationTime:0,_triggerData:null,_useButtonLabel:null,_timer:null,ctor:function(e){this._super(e)},init:function(){this._super(),this._itemGrid||(this._itemGrid=game.GridUtil.creatItemGrid(this,this._skin.imgIcon),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.AOTU_EQUIP_CONTAINER_ID))},onShow:function(){b8e.evt.onC(this._skin.btn_dress,this.onClickDress,this)},onHide:function(){b8e.evt.offC(this._skin.btn_dress,this.onClickDress,this),this._timer&&this._timer.stop(),this._durationTime=0,game.GridUtil.setItemGrid(this._itemGrid,null)},onClickDress:function(){if(this._triggerData){var e=this._triggerData;this._triggerData=null,game.TriggerMgr.inst().completeTrigger(e),e=null}},onUpdate:function(){this._durationTime-=1e3,this._durationTime<0&&(this._durationTime=0),this.updateLabDress()},updateLabDress:function(){0==this._durationTime?this._skin.lab_dress.string=this._useButtonLabel:this._skin.lab_dress.string=this._useButtonLabel+"("+(.001*this._durationTime>>0)+")"},setTriggerData:function(e){if(this._skin){this._triggerData=e;var t=this._triggerData.goodsId,i=null;if((this._triggerData.equipType||this._triggerData.goodsType)&&(i=game.back.getItemInfoById(t)),i){if(game.mainRole.mainRoleData.getLv()<i.level)return this.hide(),!1;this._triggerData.equipType?(this._useButtonLabel="穿戴",this._skin.node_power.active=!0,this._skin.closeBtn.active=!1):(this._useButtonLabel="使用",this._skin.node_power.active=!1,this._skin.closeBtn.active=!0),this._skin.lab_equip_name.string=i.name;var n=game.html.getColorByQuality(i.quality);this._skin.lab_equip_name.node.color=b8e.ColorUtil.toCCColor(n),this._skin.lab_power.string=i.power,game.GridUtil.setItemGrid(this._itemGrid,i),this._itemGrid.sortLayer(),this._itemInfo=i}else this._skin.lab_equip_name.string="",this._skin.lab_power.string="0",game.GridUtil.setItemGrid(this._itemGrid,null),this._useButtonLabel="",this._skin.node_power.active=!1,this._itemInfo=null;return this._durationTime=this._triggerData.duration,this.updateLabDress(),0<this._durationTime?this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.onUpdate,1e3):this._timer&&this._timer.stop(),!0}return!1},onRefresh:function(){this._skin.lab_equip_name.string="",this._skin.lab_power.string="0",this._skin.lab_dress.string="",this._skin.node_power.active=!1,game.GridUtil.setItemGrid(this._itemGrid,null),this._itemInfo=null,this._durationTime=0,this._useButtonLabel="",this.updateLabDress()},onClickCloseBtn:function(){this._triggerData&&game.TriggerMgr.inst().cancelTrigger(this._triggerData,!0)}})},{}],397:[function(e,t,i){"use strict";game.GuideBubbleView=game.SkinUI.extends({ctor:function(){this._super("guide/GuideBubbleSkin","GuideBubbleSkin")},init:function(){this._lab=b8e.Label.get(),this._lab.setFontSize(20),this._lab.setLineHeight(28),this._lab.setColor(4293384103),this.addChild(this._lab),this._lab.setLocalZOrder(1),this._lab.setPosition(22,10)},onShow:function(){},onRefresh:function(){switch(this._lab.setText(this.data.content),this.setSize(this._lab.width+20,this._lab.height+20),this._skin.left_bg.active=!1,this._skin.right_bg.active=!1,this._skin.top_bg.active=!1,this._skin.bottom_bg.active=!1,this._skin.labBg.active=!1,this.data.direction){case"left":this._skin.left_bg.active=!0,this._lab.setPosition(8,15),this._skin.left_bg.setContentSize(this.width,this.height);break;case"right":this._skin.right_bg.active=!0,this._lab.setPosition(22,10),this._skin.right_bg.setContentSize(this.width,this.height);break;case"top":this._skin.top_bg.active=!0,this._lab.setPosition(8,15),this._skin.top_bg.setContentSize(this.width,this.height);break;case"bottom":this._skin.bottom_bg.active=!0,this._lab.setPosition(8,15),this._skin.bottom_bg.setContentSize(this.width,this.height);break;case"left_top":case"right_top":this._skin.top_bg.active=!0,this._lab.setPosition(8,15),this._skin.top_bg.setContentSize(this.width,this.height);break;case"left_bottom":case"right_bottom":this._skin.bottom_bg.active=!0,this._lab.setPosition(8,15),this._skin.bottom_bg.setContentSize(this.width,this.height);break;default:this._skin.labBg.active=!0,this._lab.setPosition(8,15),this._skin.labBg.setContentSize(this.width,this.height)}},onHide:function(){}})},{}],398:[function(e,t,i){"use strict";game.GuideDialogView=game.SkinUI.extends({ctor:function(){this._super("guide/GuideDialogSkin","GuideDialogSkin")},init:function(){this._super()},onShow:function(){},onRefresh:function(){this._skin.labContent.string=this.data.content},onHide:function(){}})},{}],399:[function(e,t,i){"use strict";game.GuideFirstRechargeView=game.SkinUI.extends({ctor:function(){this._super("guide/GuideFirstRechargeSkin","GuideFirstRechargeSkin")},init:function(){this._super()},onShow:function(){},onRefresh:function(){},onHide:function(){}})},{}],400:[function(e,t,i){"use strict";game.GuideView=game.SkinUI.extends({_lab:null,ctor:function(){this._super("guide/GuideSkin","GuideSkin")},init:function(){this._lab=b8e.Label.get(),this._lab.setFontSize(20),this._lab.setLineHeight(28),this._lab.setColor(4278190080),this.addChild(this._lab),this._lab.setLocalZOrder(1),this._lab.setPosition(10,10)},onShow:function(){},onRefresh:function(){this._lab.setText(this.data.content),this.setSize(this._lab.width+20,this._lab.height+20),this._skin.labBg.setContentSize(this.width,this.height)},onHide:function(){}})},{}],401:[function(e,t,i){"use strict";e("./GuideView"),e("./GuideDialogView"),e("./DressEquipPanel")},{"./DressEquipPanel":396,"./GuideDialogView":398,"./GuideView":400}],402:[function(e,t,i){"use strict";game.appModule.GuildBoss=game.SkinUIPanel.extends({modelSp:null,nameSp:null,boosBgSp:null,_hpRate:0,_maskWidth:300,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super(e)},init:function(){this.boosBgSp=b8e.Sprite.get(),this.boosBgSp.setAnchor(.5,.5),this.boosBgSp.addToParent(this._skin.boosBg),this.boosBgSp.loadTexture(game.ClientCfg.guildBossBg,null,null,{useManifest:!1}),this.modelSp=b8e.Sprite.get(),this.modelSp.setAnchor(.5,.5),this.modelSp.addToParent(this._skin.bossModel),this.nameSp=b8e.Sprite.get(),this.nameSp.setAnchor(.5,.5),this.nameSp.addToParent(this._skin.bossNameNode),this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,8),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.GUILD_BOOS_GRID,this._prizeInfo=new game.PrizeInfo},onShow:function(){this.upDatePanel(),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATE_BOSSPANEL,this.upDatePanel),b8e.evt.onC(this._skin.damageBtn,this.onOpenDamagePanel,this),b8e.evt.onC(this._skin.openPrizeBtn,this.onOpenBossPrizePeriview,this),b8e.evt.onC(this._skin.fightBtn,this.onFightGuildBoss,this)},onHide:function(){b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATE_BOSSPANEL,this.upDatePanel),b8e.evt.offC(this._skin.damageBtn,this.onOpenDamagePanel,this),b8e.evt.offC(this._skin.openPrizeBtn,this.onOpenBossPrizePeriview,this),b8e.evt.offC(this._skin.fightBtn,this.onFightGuildBoss,this)},upDatePanel:function(){if(this._skin){var e=game.guild.getGuildBossInfo();if(e){var t=e.days,i=game.ccfg.GuildBossCfg.getData(e.bossId,game.worldBoss.getServerByCurServerDate(t));if(i){this._skin.timeTips.string=game.ccfg.LangCfg.getText(57002,[i.reviceTime]);var n=game.ClientCfg.getWorldBossImgUrlByString(i.poster),s=game.ClientCfg.getWorldBossImgUrlByString(i.name);switch(this.modelSp.loadTexture(n,null,null,{useManifest:!1}),this.nameSp.loadTexture(s,null,null,{useManifest:!1}),this._skin.modelMask.active=e.state==game.WorldBossStateType.OVER,this._skin.damageBtn.active=!1,this._skin.clooseTips.active=!0,this._skin.fightBtn.active=!1,this._hpRate=Math.round(e.hp/e.maxhp*100),this._hpRate<0&&(this._hpRate=0),e.state){case game.WorldBossStateType.NO_OPEN:this._skin.hpLab.string="100%",this._skin.hpNode.width=this._maskWidth;break;case game.WorldBossStateType.OVER:this._skin.hpLab.string="0%",this._skin.hpNode.width=0,this._skin.damageBtn.active=!0;break;case game.WorldBossStateType.OPENING:var a=e.endTime-game.SysTime.curTime;this._skin.hpLab.string=this._hpRate+"%",0<this._hpRate?(this._skin.hpNode.width=this._maskWidth*(this._hpRate/100),b8e.Tween.kill(this._skin.hpNode),b8e.Tween.get(this._skin.hpNode).to({width:1},a).call(this.bossDead,this),this._skin.fightBtn.active=!0,this._skin.clooseTips.active=!1,this._hpRateTimer||(this._hpRateTimer=b8e.Timer.add(this,this.updateBossHpRate,500)),this._hpRateTimer.reset(),this._hpRateTimer.start()):this._skin.damageBtn.active=!0}var o=game.ccfg.GuildBossAwardCfg.getCfgByLevel();o&&(this._prizeInfo.setupById(o.showPrize),this._prizeList.setData(this._prizeInfo))}}}},bossDead:function(){this._skin.fightBtn.active=!1,this._skin.modelMask.active=!0,this._skin.clooseTips.active=!0,game.guild.setGuildBossDie()},updateBossHpRate:function(){var e=game.guild.getGuildBossInfo();if(e)if(e.endTime>game.SysTime.curTime){var t=e.maxhp*((e.endTime-game.SysTime.curTime)/(e.endTime-e.startTime));this._hpRate=Math.round(t/e.maxhp*100),this._hpRate<0&&(this._hpRate=0),this._skin.hpLab.string=this._hpRate+"%"}else this._skin.hpLab.string="0%",this._hpRate=0,game.guild.setGuildBossHp(0),this._hpRateTimer&&this._hpRateTimer.stop()},onOpenDamagePanel:function(){game.app.show(game.AppConstant.GUILDBOSS_DAMAGERANKCHECK)},onOpenBossPrizePeriview:function(){game.guild.getGuildBossInfo()&&game.app.show(game.AppConstant.GUILDBOSS_DROPPREVIEW,11001)},onFightGuildBoss:function(){var e=game.guild.getGuildBossInfo();e&&game.guild.onEnterSceneByBoosId(e.bossId)}})},{}],403:[function(e,t,i){"use strict";game.GuildBossDamageRank=game.SkinUI.extends({_list:null,_isShow:!0,ctor:function(){this._super("guildBoss/GuildBossDamageRankSkin","GuildBossDamageRankSkin")},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildBossDamageRankItem))},onShow:function(){this.onResize(),this.onSwitchPanel(),this._list.show(),b8e.evt.onC(this._skin.switchBtn,this.onSwitchPanel,this),b8e.evt.onC(this._skin.img_inspire,this.onClickInspire,this),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATE_DAMAGERANK,this.upDateGuildRank)},onHide:function(){b8e.evt.offC(this._skin.switchBtn,this.onSwitchPanel,this),b8e.evt.offC(this._skin.img_inspire,this.onClickInspire,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATE_DAMAGERANK,this.upDateGuildRank),this._list&&this._list.hide()},onSwitchPanel:function(){this._skin.imgOn.active=this._isShow,this._skin.imgOff.active=!this._isShow,this._skin.show_rank_node.active=this._isShow,this._skin.no_show_rand_node.active=!this._isShow,this._isShow=!this._isShow,this.upDateGuildRank()},upDateGuildRank:function(){if(this._skin){var e=game.guild.getGuildBossDamageRank();if(e){var t=e.getDamageRank();this._list.setData(t),this.upDateSelfData(),this.setInspire()}}},upDateSelfData:function(){var e=game.guild.getGuildBossDamageRank();if(e&&e.myRank){var t,i,n="";t=game.ValueUtil.formatNumber(e.myRank.score,1),e.myRank.rank<=10&&(n=e.myRank.rank),i=game.ValueUtil.formatNumber(e.myDmg,1),this._skin.mineGuildRnak_1.string=n,this._skin.mineGuildDamage_1.string=t,this._skin.mineDamage_1.string=i,this._skin.mineGuildRnak_2.string=n,this._skin.mineGuildDamage_2.string=t,this._skin.mineDamage_2.string=i}},setInspire:function(){var e=game.worldBoss.damage+"%";e&&(this._skin.lab_inspire.string="伤害  "+game.html.getText(game.html.Q_GREEN,"+"+e))},onClickInspire:function(){game.app.show(game.AppConstant.INSPIRE_PANEL)},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._skin&&(this.x=b8e.stageWidth-this.width+e,this.y=b8e.stageHeight-this.height-221)}})},{}],404:[function(e,t,i){"use strict";game.appModule.GuildBossDamageRankCheck=game.SkinUIPanel.extends({_index:-1,guildRankList:null,selfGuildRankList:null,ctor:function(e){this._super(e)},init:function(){this.guildtList=new b8e.List(this._skin.guildList,game.GuildBossDamageRankCheckItem),this.selfList=new b8e.List(this._skin.selfGuildList,game.GuildBossDamageRankCheckItem)},onShow:function(){-1==this._index&&(this._index=0),b8e.evt.onC(this._skin.guildRankBtn,this.guildRankBtnClick,this),b8e.evt.onC(this._skin.selfGuildRankBtn,this.selfGuildNodeClick,this);var e=game.guild.getGuildBossInfo();if(e){this._skin.mine_rank_node.active=0<e.selfGuildDamage,this._skin.no_rank_node.active=!(0<e.selfGuildDamage),this._skin.lab_mine_damage.string=game.ValueUtil.formatNumber(e.selfGuildDamage,1);var t=e.getRanks(),i=e.getMembers();this.guildtList.setData(t),this.guildtList.show(),this.selfList.setData(i),this.selfList.show(),this.onShowByIndex(this._index)}},onShowByIndex:function(e){if(this._skin)switch(e){case 0:this._skin.guildNode.active=!0,this._skin.selfGuildNode.active=!1;break;case 1:this._skin.guildNode.active=!1,this._skin.selfGuildNode.active=!0}},guildRankBtnClick:function(){this.onShowByIndex(0)},selfGuildNodeClick:function(){this.onShowByIndex(1)},onHide:function(){this.guildtList&&this.guildtList.hide(),this.selfList&&this.selfList.hide(),b8e.evt.offC(this._skin.guildRankBtn,this.guildRankBtnClick,this),b8e.evt.offC(this._skin.selfGuildRankBtn,this.selfGuildNodeClick,this)}})},{}],405:[function(e,t,i){"use strict";game.GuildBossDamageRankCheckItem=game.SkinUI.extends({m_data:null,m_xinfaIcon:null,ctor:function(){this._super("guildBoss/GuildBossDamageRankCheckItemSkin","GuildBossDamageRankCheckItemSkin")},getHeight:function(){return 46},getWidth:function(){return 460},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){if(this.m_data=e,this._skin&&e)switch(e.type){case game.GuildRankType.GUILD_BOSS_RANK:this.updateGuildRank(e);break;case game.GuildRankType.GUILD_BOSS_SELFRANK:this.updateSelfGuildRank(e)}},updateGuildRank:function(e){this._skin&&e&&(this._skin.lab_name.string="",this._skin.lab_master.string=e.masterName,this._skin.lab_guild_name.string=e.name,this._skin.lab_rank.string=e.rank,this._skin.lab_damage.string=game.ValueUtil.formatNumber(e.score,1))},updateSelfGuildRank:function(e){this._skin&&e&&(this._skin.lab_name.string=e.name,this._skin.lab_master.string="",this._skin.lab_guild_name.string="",this._skin.lab_rank.string=e.rank,this._skin.lab_damage.string=game.ValueUtil.formatNumber(e.score,1))}})},{}],406:[function(e,t,i){"use strict";game.GuildBossDamageRankItem=game.SkinUI.extends({m_data:null,m_xinfaIcon:null,ctor:function(){this._super("guildBoss/GuildBossDamageRankItemSkin","GuildBossDamageRankItemSkin")},getHeight:function(){return 22},getWidth:function(){return 200},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){this.m_data=e,this._skin&&this.m_data&&(this._skin.lab_rank.string=e.rank,this._skin.lab_name.string=e.name,this._skin.lab_damage.string=game.ValueUtil.formatNumber(e.score,1))}})},{}],407:[function(e,t,i){"use strict";game.appModule.GuildBossDropPreview=game.SkinUIPanel.extends({_id:0,_list:null,_showList:null,bossRankList:null,ctor:function(e){this._super(e),this._showList=[]},onShow:function(){this.data&&(this._id=this.data.id),this._list||(this._list=new b8e.List(this._skin.list,game.GuildBossDropPreviewItem)),this._list.show(),this.setWorldBossList()},onHide:function(){this._list&&this._list.hide()},init:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_RANK);this.bossRankList=e.split("|")},setWorldBossList:function(){if(!this._showList||this._showList.length<=0?this._showList=[]:this._showList.length=0,this.bossRankList&&!(this.bossRankList.length<=0)){var e=game.ccfg.GuildBossAwardCfg.getCfgByLevel();if(e){for(var t=e.dropIds,i=0;i<this.bossRankList.length;i++){var n=this.bossRankList[i].split(",");if(n&&2==n.length)var s=parseInt(n[0]),a=parseInt(n[1]);else s=a=parseInt(this.bossRankList[i]);if(t[s-1]){var o={startRank:s,endRank:a,prizeId:t[s-1]};this._showList.push(o)}}this._list.setData(this._showList)}}}})},{}],408:[function(e,t,i){"use strict";game.GuildBossDropPreviewItem=game.SkinUI.extends({_prizeId:0,_prizeList:null,_prizeInfo:null,bossRankList:null,pRank:21,ctor:function(){this._super("guildBoss/GuildBossDropPreviewItemSkin","GuildBossDropPreviewItemSkin")},getHeight:function(){return 100},getWidth:function(){return 500},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this.setData(this._obj)},onHide:function(){},setData:function(e){if(this._obj=e,this._obj){this._obj.startRank,this._obj.endRank;if(this._skin){if(this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prizeList)),0!=this._obj.prizeId&&(this._prizeInfo.setupById(this._obj.prizeId),this._prizeList.setData(this._prizeInfo)),!this.bossRankList){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_RANK);this.bossRankList=t.split("|")}this.pRank=21,this.bossRankList&&0<this.bossRankList.length&&(this.pRank=parseInt(this.bossRankList[this.bossRankList.length-1])),this._obj.startRank>=this.pRank?this._skin.lab_rank.string="参与奖":this._obj.startRank==this._obj.endRank?this._skin.lab_rank.string="第"+this._obj.startRank+"名":this._skin.lab_rank.string="第"+this._obj.startRank+"-"+this._obj.endRank+"名"}}}})},{}],409:[function(e,t,i){"use strict";game.appModule.GuildBossEnterShowPanel=game.SkinUIPanel.extends({_bossId:0,_poster:null,_leaveTime:0,_worldBossInfo:null,ctor:function(e){this._super(e)},onShow:function(){if(this._poster||(this._poster=b8e.Sprite.get(),this._poster.addToParent(this._skin.img_boss_head)),b8e.evt.onC(this._skin.btn_challenge,this.onClickBtnChallenge,this),this.data){this._bossId=this.data;var e=game.mainRole.mainRoleData.miscData.openServerDay;if(this._worldBossInfo=game.ccfg.GuildBossCfg.getData(this._bossId,game.worldBoss.getServerByCurServerDate(e)),this._worldBossInfo){var t=game.ClientCfg.getLoneyDungeonHead(this._worldBossInfo.head);this._poster.loadTexture(t,null,null,{useManifest:!1}),this._poster.setAnchor(.5,.5),this._poster.setSize(70,70),this._skin.title.string=this._worldBossInfo.title}}},onHide:function(){b8e.evt.offC(this._skin.btn_challenge,this.onClickBtnChallenge,this)},onClickBtnChallenge:function(){this._worldBossInfo&&game.guild.onRqGuildBossInfo(),this.hide()}})},{}],410:[function(e,t,i){"use strict";game.appModule.GuildBossResult=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){},onHide:function(){}})},{}],411:[function(e,t,i){"use strict";game.GuildCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Guild.GuildInfoResponse,this.onGuildInfoResponse,this),b8e.addNH(game.pbmid.Guild.GuildCreateResponse,this.onGuildCreateResponse,this),b8e.addNH(game.pbmid.Guild.GuildJoinResponse,this.onGuildJoinResponse,this),b8e.addNH(game.pbmid.Guild.GuildLeaveResponse,this.onGuildLeaveResponse,this),b8e.addNH(game.pbmid.Guild.GuildKickMemberResponse,this.onGuildKickMemberResponse,this),b8e.addNH(game.pbmid.Guild.GuildChangeRankResponse,this.onGuildChangeRankResponse,this),b8e.addNH(game.pbmid.Guild.GuildSetNoticeResponse,this.onGuildSetNoticeResponse,this),b8e.addNH(game.pbmid.Guild.GuildReqListResponse,this.onGuildReqListResponse,this),b8e.addNH(game.pbmid.Guild.GuildHandleReqResponse,this.onGuildHandleReqResponse,this),b8e.addNH(game.pbmid.Guild.GuildTransferMasterResponse,this.onGuildTransferMasterResponse,this),b8e.addNH(game.pbmid.Guild.GuildLogResponse,this.onGuildLogResponse,this),b8e.addNH(game.pbmid.Guild.GuildSettingResponse,this.onGuildSettingResponse,this),b8e.addNH(game.pbmid.Guild.GuildRecommendResponse,this.onGuildRecommendResponse,this),b8e.addNH(game.pbmid.Guild.GuildRankdResponse,this.onGuildRankResponse,this),b8e.addNH(game.pbmid.Guild.GuildQuestResponse,this.onGuildQuestResponse,this),b8e.addNH(game.pbmid.Guild.GuildQuestFinishResponse,this.onGuildQuestFinishResponse,this),b8e.addNH(game.pbmid.Guild.GuildQuestAwardResponse,this.onGuildQuestAwardResponse,this),b8e.addNH(game.pbmid.Guild.GuildQuestFinishNotify,this.onGuildQuestFinishNotify,this),b8e.addNH(game.pbmid.Guild.GuildKickNotify,this.onGuildKickNotify,this),b8e.addNH(game.pbmid.Guild.GuildJoinNotify,this.onGuildJoinNotify,this),b8e.addNH(game.pbmid.Guild.GuildDisbandResponse,this.onGuildDisbandResponse,this),b8e.addNH(game.pbmid.Guild.SceneUnitGuildUpdateNotify,this.onSceneUnitGuildUpdateNotify,this),b8e.addNH(game.pbmid.Guild.GuildModuleResponse,this.onGuildModuleResponse,this),b8e.addNH(game.pbmid.Guild.GuildShaoxiangResponse,this.onGuildShaoxiangResponse,this),b8e.addNH(game.pbmid.Guild.GuildShaoxiangLogResponse,this.onGuildShaoxiangLogResponse,this),b8e.addNH(game.pbmid.Guild.GuildXinfaResponse,this.onGuildXinfaResponse,this),b8e.addNH(game.pbmid.Guild.GuildBossListResponse,this.onGuildBossListResponse,this),b8e.addNH(game.pbmid.Guild.GuildBossNotify,this.onGuildBossNotify,this),b8e.addNH(game.pbmid.Guild.EnterGuildBossSceneResponse,this.onEnterGuildBossSceneResponse,this),b8e.addNH(game.pbmid.Guild.GuildBossStateNotify,this.onGuildBossStateNotify,this),b8e.addNH(game.pbmid.Guild.GuildExpCureInviteResponse,this.onGuildExpCureInviteResponse,this),b8e.addNH(game.pbmid.Guild.GuildExpCureConfirmResponse,this.onGuildExpCureConfirmResponse,this),b8e.addNH(game.pbmid.Guild.GuildExpCureAwardResponse,this.onGuildExpCureAwardResponse,this),b8e.evt.addG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.setXinfaAlert),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.setXinfaAlert)},setXinfaAlert:function(){game.guild.setXinfaAlert()},onGuildExpCureAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildExpCureAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.getGuildExpCurePrizeComplete(t.targetRoleId)},onGuildExpCureConfirmResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildExpCureConfirmResponse);0<t.code?(b8e.log("onGuildExpCureConfirmResponse",t.code),game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))):game.guild.startGuildExpCure(t.endTime)},onGuildExpCureInviteResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildExpCureInviteResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.guildInviteExpCureRp(t.roleId)},onGuildInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildInfoResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.synGuildInfo(t.data)},onGuildCreateResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildCreateResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.guild.createGuildSuccess(t.data),game.guild.sendChatContent(),game.TriggerMgr.inst().joinGuildTrigger())},onGuildJoinResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildJoinResponse);if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else switch(t.state){case game.GuildState.OPEN:game.guild.sendChatContent(),b8e.log("加入帮会成功"),game.notice.show("加入帮会成功"),game.GuildSender.isJoinGuild=!0,game.GuildSender.reqGuildInfo(),game.TriggerMgr.inst().joinGuildTrigger(),b8e.evt.dptG(game.GuildEvt.GUILD_JOIN_GUILD_SUCCESS),game.chat.addSystemChat(game.ccfg.LangCfg.getText(10407));break;case game.GuildState.CLOSED:game.notice.show("帮会禁止加入");break;case game.GuildState.CHECK:b8e.log("申请成功，等会审核通过"),game.notice.show("申请成功，等会审核通过"),game.GuildSender.reqGuildRecommend()}},onGuildLeaveResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildLeaveResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(b8e.log("离开公会成功"),game.guild.leavelGuilSuccess())},onGuildKickMemberResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildKickMemberResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.removeGuildMember(t.memberId)},onGuildChangeRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildChangeRankResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.changeGuildMemberRank(t.memberId,t.rank)},onGuildSetNoticeResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildSetNoticeResponse);if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{b8e.log("修改公告成功");var i=game.guild.getSelfGuildInfo();i&&(i.notice=game.guild.guildNotice,game.guild.guildNotice=""),b8e.evt.dptG(game.GuildEvt.GUILD_SET_GUILD_NOTICE_SUCCESS)}},onGuildReqListResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildReqListResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildApplyList(t.players)},onGuildHandleReqResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildHandleReqResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.onHandleApply(t.type,t.playerIds)},onGuildTransferMasterResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildTransferMasterResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.transferMasterSuccess(t.memberId)},onGuildLogResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildLogResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.updateGuildLog(t.logs)},onGuildSettingResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildSettingResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.onSetJoinGuildConditonds(t.power,t.state)},onGuildRecommendResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildRecommendResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setRecommendGuildList(t.list,t.reqs)},onGuildRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildRankResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.onGuildRank(t.list)},onGuildQuestResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildQuestResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildQuestInfo(t.list,t.score,t.awardIds,t.weeklyScore,t.weeklyAwardIds)},onGuildQuestFinishResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildQuestFinishResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.onCompleteGuildQuest(t.id,t.level,t.exp,t.addexp,t.score)},onGuildQuestAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildQuestAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.guild.curGuildQueatInfo&&game.guild.curGuildQueatInfo.setGetAwardIds(t.id),b8e.evt.dptG(game.GuildEvt.GUILD_GET_AWARDS_SUCCESS))},onGuildQuestFinishNotify:function(e){var t=e.readProtobuf(game.pbmsg.GuildQuestFinishNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.updateGuildTaskState(t.id)},onGuildKickNotify:function(e){game.notice.show("你被逐出帮会了"),game.guild.leavelGuilSuccess(),game.chat.addSystemChat(game.ccfg.LangCfg.getText(10404))},onGuildJoinNotify:function(e){var t=e.readProtobuf(game.pbmsg.GuildJoinNotify);if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{var i=game.mainRole.mainRoleData;i.guildId=t.id,i.guildName=t.name,game.notice.show("你加入了$帮派",[t.name]),game.GuildSender.isJoinGuild=!0,game.GuildSender.reqGuildInfo(),game.TriggerMgr.inst().joinGuildTrigger(),game.guild.sendChatContent(),b8e.evt.dptG(game.GuildEvt.GUILD_JOIN_GUILD_SUCCESS),game.chat.addSystemChat(game.ccfg.LangCfg.getText(10403,[t.name]))}},onGuildDisbandResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildDisbandResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.notice.show("帮会解散了"),game.guild.leavelGuilSuccess(),game.chat.addSystemChat(game.ccfg.LangCfg.getText(10405)))},onSceneUnitGuildUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.SceneUnitGuildUpdateNotify);if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{var i=game.sceneRole.getDisplayById(t.sceneUnitId);if(!i)return void b8e.log("角色不存在");i.data.guildId=t.guildId,i.data.guildName=t.guildName,game.AvatarUtil.updateGuildName(i)}},onGuildModuleResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildModuleResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildModuleData(t)},onGuildShaoxiangResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildShaoxiangResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.updataGuildModuleData(t)},onGuildShaoxiangLogResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildShaoxiangLogResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildShangXiangLogs(t)},onGuildXinfaResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildXinfaResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.updataXinFaInfo(t)},onGuildBossListResponse:function(e){var t=e.readProtobuf(game.pbmsg.GuildBossListResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildBossInfo(t)},onGuildBossNotify:function(e){var t=e.readProtobuf(game.pbmsg.GuildBossNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildBossNotify(t)},onEnterGuildBossSceneResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterGuildBossSceneResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.enterGuildBossSuccessful(t)},onGuildBossStateNotify:function(e){var t=e.readProtobuf(game.pbmsg.GuildBossStateNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.guild.setGuildBossInfoState(t.id,t.state)}})},{}],412:[function(e,t,i){"use strict";e("./GuildCmd")},{"./GuildCmd":411}],413:[function(e,t,i){"use strict";game.GuildRankType=b8e.Enum({GUILD_BOSS_RANK:0,GUILD_BOSS_SELFRANK:1})},{}],414:[function(e,t,i){"use strict";game.GuildEvt=b8e.Enum({GUILD_SYN_GUILD_INFO:b8e.Event.nextCode(),GUILD_CREATE_GUILD_SUCCESS:b8e.Event.nextCode(),GUILD_REMOVE_GUILD_MEMBER:b8e.Event.nextCode(),GUILD_LEAVE_GUILD_SUCCESS:b8e.Event.nextCode(),GUILD_CHANGE_GUILD_MEMBER_RANK:b8e.Event.nextCode(),GUILD_SET_GUILD_NOTICE_SUCCESS:b8e.Event.nextCode(),GUILD_JOIN_GUILD_SUCCESS:b8e.Event.nextCode(),GUILD_JOIN_GUILD_FAIL:b8e.Event.nextCode(),GUILD_WAIT_AGREE:b8e.Event.nextCode(),GUILD_APPLY_LIST:b8e.Event.nextCode(),GUILD_HANDLE_APPLY_LIST_SUCCESS:b8e.Event.nextCode(),GUILD_TRANSFER_MASTER_SUCCESS:b8e.Event.nextCode(),GUILD_UPDATE_GUILD_LOGS:b8e.Event.nextCode(),GUILD_SET_JOIN_GUILD_CONDITIONS:b8e.Event.nextCode(),GUILD_RECOMMEND_LIST:b8e.Event.nextCode(),GUILD_RANK_LIST:b8e.Event.nextCode(),GUILD_COMPELTE_QUEST:b8e.Event.nextCode(),GUILD_QUEST_RESPONSE:b8e.Event.nextCode(),GUILD_GET_AWARDS_SUCCESS:b8e.Event.nextCode(),GUILD_UPDATESHANGXIANGPANEL:b8e.Event.nextCode(),GUILD_UPDATESHANGXIANGLOGS:b8e.Event.nextCode(),GUILD_UPDATEXINFAPANEL:b8e.Event.nextCode(),GUILD_UPDATEXINFADESC:b8e.Event.nextCode(),GUILD_UPGRADE_EFFCT_SHOW:b8e.Event.nextCode(),GUILD_UPDATE_BOSSPANEL:b8e.Event.nextCode(),GUILD_UPDATE_DAMAGERANK:b8e.Event.nextCode(),GUILD_INVITE_EXP_CURE_CHANGE:b8e.Event.nextCode()})},{}],415:[function(e,t,i){"use strict";e("./GuildEvt")},{"./GuildEvt":414}],416:[function(e,t,i){"use strict";e("./panel/guildPanelIndex_0"),e("./event/guildEventIndex_0"),e("./sender/GuildSender"),e("./cmdlistener/guildCmdlistenerIndex_0"),e("./manager/guildMgrIndex_0")},{"./cmdlistener/guildCmdlistenerIndex_0":412,"./event/guildEventIndex_0":415,"./manager/guildMgrIndex_0":418,"./panel/guildPanelIndex_0":452,"./sender/GuildSender":453}],417:[function(e,t,i){"use strict";game.GuildMgr=b8e.Object.extends({name:"GuildMgr",_guildList:null,_applyList:null,_guildLogList:null,_recommendGuildList:null,_reqs:null,_guildRankList:null,_selfGuildInfo:null,_guildNotice:"",_isJoinGuild:!1,isHasTaskReceive:!1,guildModuleInfo:null,guildShaoxiangLogs:null,isreqGuildModule:!1,_chatContent:null,isShangXiangAlert:!1,_isXinFaAlert:!1,guildBossInfo:null,guildBossNotify:null,ctor:function(){if(1==game.GuildMgr._singleton)throw new Error("GuildMgr 只能通过单例方法获取");this._super(),this._guildList=[],this._applyList=[],this._guildLogList=[],this._recommendGuildList=[],this._reqs=[],this._guildRankList=[],this._chatContent=[],this.guildModuleInfo=new game.GuildModuleInfo,this.guildShaoxiangLogs=new game.GuildShaoxiangLogs,this.guildBossInfo=new game.GuildBossInfo,this.guildBossNotify=new game.GuildBossNotify},init:function(){game.mainRole.mainRoleData.guildName&&(game.TriggerMgr.inst().joinGuildTrigger(),game.GuildSender.reqGuildInfo(),game.GuildSender.reqGuildQuest())},synGuildInfo:function(e){var t=this.createCuild(e);this._guildList.push(t),this._selfGuildInfo=t,this.isCanApply()&&game.GuildSender.reqGuildReqList(),this.onReqGuildModule(),b8e.evt.dptG(game.GuildEvt.GUILD_SYN_GUILD_INFO)},createGuildSuccess:function(e){var t=this.createCuild(e);this._guildList.push(t),this._selfGuildInfo=t,b8e.evt.dptG(game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS)},createCuild:function(e){var t=new game.GuildInfo;return t.id=e.id,t.name=e.name,0==e.level&&(e.level=1),t.level=e.level,t.master=e.master,t.masterName=e.masterName,t.setMembers(e.members),t.state=e.state,t.powerLimit=e.powerLimit,t.createTime=e.createTime,t.count=e.count,t.notice=e.notice,t.exp=e.exp,t},removeGuildMember:function(e){if(this.isHasGuild()){var t=this.getSelfGuildInfo();if(t){if(t.memberList&&!(t.memberList.length<=0))for(var i=0;i<t.memberList.length;i++){var n=t.memberList[i];n&&(n.id==e&&(t.memberList.splice(i,1),b8e.evt.dptG(game.GuildEvt.GUILD_REMOVE_GUILD_MEMBER)))}}else b8e.log("自己的帮会没数据，怎么移除成员！！！！")}else b8e.log("没有帮会数据-----removeGuildMember")},changeGuildMemberRank:function(e,t){var i=this.getSelfGuildInfo();if(i){if(i.memberList&&!(i.memberList.length<=0))for(var n=0;n<i.memberList.length;n++){var s=i.memberList[n];s&&(s.id==e&&(s.rank=t,b8e.evt.dptG(game.GuildEvt.GUILD_CHANGE_GUILD_MEMBER_RANK)))}}else b8e.log("自己的帮会没数据，怎么更改成员职位！！！！")},leavelGuilSuccess:function(){this._selfGuildInfo=null;var e=game.mainRole.mainRoleData;e.guildId=0,e.guildName="",e.isHasGuild=!1,this.isJoinGuild=!1,b8e.evt.dptG(game.GuildEvt.GUILD_LEAVE_GUILD_SUCCESS)},setGuildApplyList:function(e){if(e&&!(e.length<=0)){for(var t=this._applyList.length=0;t<e.length;t++){var i=e[t];if(i){var n=new game.GuildMemberInfo;n.id=i.id,n.name=i.name,n.head=i.head,n.level=i.level,n.power=i.power,n.rank=i.rank,n.logoutTime=i.logoutTime,this._applyList.push(n)}}b8e.evt.dptG(game.GuildEvt.GUILD_APPLY_LIST)}},getGuildLevel:function(){if(!this.isHasGuild())return b8e.log("没有帮会数据-----getGuildLevel"),0;var e=this.getSelfGuildInfo();return e?e.level:0},isHasGuild:function(){var e=game.mainRole.mainRoleData;return!(!this.getSelfGuildInfo()&&!e.isHasGuild)},isHasApply:function(){return!!(this._applyList&&0<this._applyList.length)},reqHandleGuild:function(e,t){this.isHasApply()?game.GuildSender.reqHandleGuild(e,t):game.notice.show("当前没有要处理的申请消息")},removeApplyPlayers:function(e){if(e&&!(e.length<=0))for(var t=0;t<e.length;t++){var i=e[t];this.removeApplyInfo(i)}},removeApplyInfo:function(e){if(this._applyList&&!(this._applyList.length<=0)){for(var t=0;t<this._applyList.length;t++){var i=this._applyList[t];i&&i.id==e&&this._applyList.splice(t,1)}b8e.evt.dptG(game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS)}},removeAllApplyInfo:function(){!this._applyList||this._applyList.length<=0||(this._applyList.length=0,b8e.evt.dptG(game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS))},onHandleApply:function(e,t){switch(e){case game.GuildApplyType.REFUSED:case game.GuildApplyType.AGREE:this.removeApplyPlayers(t);break;case game.GuildApplyType.ALL_REFUSED:this.removeAllApplyInfo();break;case game.GuildApplyType.ALL_AGREE:this.removeApplyPlayers(t)}t&&t.length},transferMasterSuccess:function(e){var t=this.getSelfGuildInfo();if(t){if(t.memberList&&!(t.memberList.length<=0)){for(var i=0;i<t.memberList.length;i++){var n=t.memberList[i];n&&(n.id==e&&(n.rank=game.GuildRank.MASTER,b8e.evt.dptG(game.GuildEvt.GUILD_TRANSFER_MASTER_SUCCESS)))}this.isHasGuild()&&game.GuildSender.reqGuildInfo()}}else b8e.log("自己的帮会没数据，怎么转让帮主！！！！")},updateGuildLog:function(e){if(e&&!(e.length<=0)){for(var t=this._guildLogList.length=0;t<e.length;t++){var i=e[t];if(i){var n=new game.GuildLogInfo;switch(n.type=i.type,n.time=i.time,n.type){case game.GuildLog.JOIN_TYPE:n.name=i.join.name;break;case game.GuildLog.LEVEA_TYPE:n.name=i.leave.name;break;case game.GuildLog.LEVEL_UP_TYPE:n.level=i.levelUp.level;break;case game.GuildLog.CHANGE_RANK_TYPE:n.setChangeRankInfo(i.changeRank)}this._guildLogList.push(n)}}b8e.evt.dptG(game.GuildEvt.GUILD_UPDATE_GUILD_LOGS)}},onSetJoinGuildConditonds:function(e,t){if(this.isHasGuild()){var i=this.getSelfGuildInfo();i?(i.powerLimit=e,i.state=t,b8e.evt.dptG(game.GuildEvt.GUILD_SET_JOIN_GUILD_CONDITIONS)):b8e.log("自己的帮会没数据，怎么转让帮主！！！！")}else b8e.log("没有帮会数据-----onSetJoinGuildConditonds")},setRecommendGuildList:function(e,t){if(this._recommendGuildList.length=0,e&&0<e.length)for(s=0;s<e.length;s++){var i=e[s];if(i){var n=this.createCuild(i);this._recommendGuildList.push(n)}}this._recommendGuildList.sort(this.onSortByLevel);for(var s=0;s<this._recommendGuildList.length;s++){(n=this._recommendGuildList[s])&&(n.index=s+1)}if(this._reqs.length=0,t&&0<t.length)for(s=0;s<t.length;s++){var a=t[s];this._reqs.push(a)}b8e.evt.dptG(game.GuildEvt.GUILD_RECOMMEND_LIST)},onGuildRank:function(e){if(e&&!(e.length<=0)){for(n=this._guildRankList.length=0;n<e.length;n++){var t=e[n];if(!t)return;var i=this.createCuild(t);this._guildRankList.push(i)}this._guildRankList.sort(this.onSortByLevel);for(var n=0;n<this._guildRankList.length;n++){(i=this._guildRankList[n])&&(i.index=n+1)}b8e.evt.dptG(game.GuildEvt.GUILD_RANK_LIST)}},onSortByLevel:function(e,t){return e.level>t.level?-1:e.level<t.level?1:0},setGuildQuestInfo:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;this._curGuildQueatInfo||(this._curGuildQueatInfo=new game.GuildQueatInfo),this._curGuildQueatInfo.score=t,this._curGuildQueatInfo.weeklyScore=n,this._curGuildQueatInfo.setGuildQuestInfo(e),this._curGuildQueatInfo.setAwardIds(i),this._curGuildQueatInfo.setWeeklyAwardIds(s),b8e.evt.dptG(game.GuildEvt.GUILD_QUEST_RESPONSE)},onCompleteGuildQuest:function(e,t,i,n,s){if(this._curGuildQueatInfo){var a=this.getSelfGuildInfo();a&&(a.level=t,a.exp=i),game.notice.show("完成帮会任务，帮会经验 +$",[n]),game.notice.show("完成帮会任务，活跃度 +$",[s]),this._curGuildQueatInfo.score+=s,this._curGuildQueatInfo.weeklyScore+=s;var o=this._curGuildQueatInfo.guildQuestList;if(o&&0<o.length){for(var r=0;r<o.length;r++){var h=o[r];h&&(h.id==e&&(h.state=game.GuildQuestType.RECEIVE))}this.hasGetGuildTask(),b8e.evt.dptG(game.GuildEvt.GUILD_COMPELTE_QUEST)}}},updateGuildTaskState:function(e){if(this._curGuildQueatInfo){var t=this._curGuildQueatInfo.guildQuestList;if(t&&0<t.length){for(var i,n=0,s=0;s<t.length;s++){var a=t[s];a&&(a.id==e&&((i=game.ccfg.GuildQuestCfg.getGuildDailyQuestInfoById(e))&&(n=i.param),a.num=n,a.state=game.GuildQuestType.CAN_RECEIVE))}this.hasGetGuildTask(),b8e.evt.dptG(game.GuildEvt.GUILD_COMPELTE_QUEST)}}},hasGetGuildTask:function(){if(this._curGuildQueatInfo){var e=this._curGuildQueatInfo.guildQuestList;if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i&&i.state==game.GuildQuestType.CAN_RECEIVE)return!0}}return!1},isGetActiveAwards:function(e){if(this._curGuildQueatInfo){var t=this._curGuildQueatInfo.awardIds;return!!(t&&0<t.length)&&-1!=t.indexOf(e)}},isCanGetActiveAwards:function(e){if(this.isGetActiveAwards(e))return!1;if(!this._curGuildQueatInfo)return!1;var t=game.ccfg.GuildQuestAwardCfg.getQuestAwardById(e);return!!t&&this._curGuildQueatInfo.score>=t.score},isHasActiveAwards:function(){var e=game.ccfg.GuildQuestAwardCfg.getQuestAwardList();if(!e||e.length<=0)return!1;if(!this._curGuildQueatInfo)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(i)if(!this.isGetActiveAwards(i.id)&&this._curGuildQueatInfo.score>=i.score)return!0}return!1},isCanGetWeekAwards:function(e){if(this.isGetWeekAwardById(e))return!1;if(!this._curGuildQueatInfo)return!1;var t=game.ccfg.GuildQuestAwardCfg.getWeekAwardById(e);return!!t&&this._curGuildQueatInfo.weeklyScore>=t.score},isGetWeekAwardById:function(e){if(this._curGuildQueatInfo){var t=this._curGuildQueatInfo.weeklyIds;return!!(t&&0<t.length)&&-1!=t.indexOf(e)}},isHasWeekAwards:function(){var e=game.ccfg.GuildQuestAwardCfg.getWeekAwardList();if(!e||e.length<=0)return!1;if(!this._curGuildQueatInfo)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(i)if(!this.isGetWeekAwardById(i.id)&&this._curGuildQueatInfo.weeklyScore>=i.score)return!0}return!1},reqLeaveGuild:function(){this.isHasGuild()?this.isMaster()?game.notice.show("必须转让帮主后才可离开帮会"):game.GuildSender.reqLeaveGuild():game.notice.show("没有帮会，怎么离开帮会")},reqGuildDisband:function(){var e=new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoBtn,e.string="确认要解散帮会吗？",e.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,e)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.GuildSender.reqGuildDisband();break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sendChatContent:function(){game.chat.sendGuildChatContent(this.getRandomChatContent(),!0)},getRandomChatContent:function(){if(this._chatContent&&0<this._chatContent.length)return this.getChatContent(this._chatContent);var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CREATE_GUILD_CHAT);return this._chatContent=e.split("|"),this._chatContent&&this._chatContent.length?this.getChatContent(this._chatContent):game.ccfg.LangCfg.getText(10407)},getChatContent:function(e){var t=e[Math.floor(Math.random()*(e.length-1))];return t||game.ccfg.LangCfg.getText(10407)},reqTransGuildMaster:function(e){var t=new game.GameAlertInfo;t.alertType=game.GameAlertType.TwoBtn,t.string="确认要转让帮主吗？",t.obj={id:e},t.isShowTips=!1,game.gameAlert.showAlert(this,this.onCompleteCallblack,t)},onCompleteCallblack:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.GuildSender.reqTransGuildMaster(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},getSelfGuildInfo:function(){return this._selfGuildInfo},getApplyList:function(){return this._applyList},getGuildLogList:function(){return this._guildLogList},geRecommendGuildList:function(){return this._recommendGuildList},getReqs:function(){return this._reqs},getGuildRankList:function(){return this._guildRankList},getSelfMemberInfo:function(){if(!this.getSelfGuildInfo())return null;var e=game.mainRole.mainRoleData;return this.getMemberInfo(e.playerId)},getMemberInfo:function(e){var t=this.getSelfGuildInfo();if(!t)return null;if(!t.memberList||t.memberList.length<=0)return null;for(var i=0;i<t.memberList.length;i++){var n=t.memberList[i];if(n&&n.id==e)return n}return null},isMaster:function(){if(!this.isHasGuild())return b8e.log("没有帮会数据-----isMaster"),!1;var e=this.getSelfGuildInfo();if(!e)return!1;var t=game.mainRole.mainRoleData;return e.master==t.playerId},isMasterById:function(e,t){return!!e&&e.master==t},isZhanglao:function(){return this.getSelfGuildRank()==game.GuildRank.ZHANG_LAO},isCanApply:function(){return!(!this.isMaster()&&!this.isZhanglao())},isMaxZhangLao:function(){var e=this.getSelfGuildInfo();if(!e)return!1;if(!e.memberList||e.memberList.length<=0)return!1;for(var t=0,i=0;i<e.memberList.length;i++){var n=e.memberList[i];n&&(n.rank==game.GuildRank.ZHANG_LAO&&t++)}return 3<=t},isInReq:function(e){var t=this.getReqs();return!(!t||t.length<=0)&&-1!=t.indexOf(e)},getSelfGuildRank:function(){var e=this.getSelfMemberInfo();return e?e.rank:-1},getGuildMembers:function(e){return e?e.count:0},getGuildMemberLimit:function(e){if(!e)return 0;var t=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(e.level);return t?t.memberLimit:0},getRankName:function(e){var t="";switch(e){case game.GuildRank.MASTER:t="帮主";break;case game.GuildRank.ZHANG_LAO:t="长老";break;case game.GuildRank.MEMBER:t="普通成员"}return t},isMaxMember:function(e){var t=this.getGuildMembers(e);return this.getGuildMemberLimit(e)<=t},isSelfGuildById:function(e){return e==game.mainRole.mainRoleData.guildId},curGuildQueatInfo:{get:function(){return this._curGuildQueatInfo}},guildNotice:{set:function(e){this._guildNotice=e},get:function(){return this._guildNotice}},selfGuildInfo:{set:function(e){this._selfGuildInfo=e},get:function(){return this._selfGuildInfo}},isJoinGuild:{set:function(e){this._isJoinGuild=e},get:function(){return this._isJoinGuild}},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_TASK,null,this.guildTaskAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_ACTIVE,null,this.guildActiveAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_MANAGER,null,this.guildAnimt,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_OPEN_ALERT,null,this.guildOpenAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_XINFA,null,this.xinfaAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_SHAOXIAO,null,this.shaoxiangAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_GUILDBOSS,null,this.isGuildSpotAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.GUILD_EXP_CURE,null,this.alertGuildExpCure,this)},guildActiveAlert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!this.isHasActiveAwards()&&!this.isHasWeekAwards())},guildOpenAlert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||this.isHasGuild()&&!this.guildActiveAlert()&&!this.guildAnimt())},guildTaskAlert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!this.hasGetGuildTask())},guildAnimt:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!this.isHasApply())},onReqGuildModule:function(){this.isreqGuildModule||(game.GuildSender.reqGuildModule(),this.isreqGuildModule=!0)},getGuildModuleInfo:function(){return this.guildModuleInfo?this.guildModuleInfo:new game.GuildModuleInfo},setGuildModuleData:function(e){e&&(this.guildModuleInfo.setup(e),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL),this.setShaoxiangAlert())},resetDaily:function(){this.guildModuleInfo.expCureCount=0,this.guildModuleInfo.shaoxiangDone=!1,b8e.evt.dptG(game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL),this.setShaoxiangAlert()},getGuildShaoXiangLogs:function(){return this.guildShaoxiangLogs?this.guildShaoxiangLogs:new game.GuildShaoxiangLogs},setGuildShangXiangLogs:function(e){e&&(this.guildShaoxiangLogs.setup(e),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL),this.setShaoxiangAlert())},onShangXiang:function(e){if(this.guildModuleInfo&&e)if(this.guildModuleInfo.shaoxiangDone)game.notice.show("每天仅可上一次香");else{var t=game.ccfg.ItemInfoCfg.getTypeById(e.items[0].Id);if(game.mainRole.mainRoleData.vipLevel<e.vip)game.vip.vipTips();else game.upgrade.costCheckMoney(t,e.items[0].Num,!0,!0)&&game.GuildSender.reqShaoXiang(e.id)}},updataGuildModuleData:function(e){if(e){this.guildModuleInfo.shaoxiangDone=!0,this.guildModuleInfo.contribution=this.guildModuleInfo.contribution+game.ccfg.GuildShaoxiangCfg.getShaoxiangcontributionById(e.id);var t=game.ccfg.GuildShaoxiangCfg.getShaoxiangcontributionById(e.id),i=game.ccfg.GuildShaoxiangCfg.getShaoxiangExpById(e.id);game.notice.show("帮贡 +$",[t]),game.notice.show("帮会经验 +$",[i]),this._selfGuildInfo.level=e.guildLevel,this._selfGuildInfo.exp=e.guildExp,b8e.evt.dptG(game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL),this.setShaoxiangAlert(),b8e.evt.dptG(game.GuildEvt.GUILD_SYN_GUILD_INFO),game.GuildSender.reqShaoXiangLog()}},setNowShowXinFaType:function(e){this.guildModuleInfo.setNowXinfaType(e)},onreqXinfa:function(e){game.GuildSender.reqXianFa(e)},updataXinFaInfo:function(e){e&&(this.guildModuleInfo.setXinFaInfo(e),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATEXINFAPANEL),b8e.evt.dptG(game.GuildEvt.GUILD_UPGRADE_EFFCT_SHOW),this.setXinfaAlert())},shaoxiangAlert:function(){return this.isShangXiangAlert},xinfaAlert:function(){return this.isXinFaAlert},setShaoxiangAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.GUILD)){if(!this.isHasGuild())return void(this.isShangXiangAlert=!1);if(this.guildModuleInfo&&this.isCanShaoXiang())return void(this.isShangXiangAlert=!this.guildModuleInfo.shaoxiangDone)}this.isShangXiangAlert=!1},isCanShaoXiang:function(){var e=game.ccfg.GuildShaoxiangCfg.getShaoxiangDatas();if(!e)return!1;var t=game.back.getAmountInfo();if(!t)return!1;for(var i=0;i<e.length;++i){var n=e[i];if(game.ccfg.ItemInfoCfg.getTypeById(n.items[0].Id)==game.AmountType.SILVER&&t.getValue(game.AmountType.SILVER)>=n.items[0].Num)return!0}return!1},setXinfaAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.GUILD)){if(!this.isHasGuild())return void(this.isXinFaAlert=!1);var e=this.getGuildModuleInfo();if(!e)return void(this.isXinFaAlert=!1);var t=e.getXinFaList();if(!t||0==t.length)return void(this.isXinFaAlert=!1);for(var i=0;i<t.length;++i)if(this.checkXinFa(t[i]))return void(this.isXinFaAlert=!0)}this.isXinFaAlert=!1},checkXinFa:function(e){var t=!1,i=this.getSelfGuildInfo();if(!i)return t;var n=game.back.getAmountInfo();if(!n)return t;var s=n.getValue(game.AmountType.CONTRIBUTION),a=game.ccfg.GuildXinfaCfg.getXinFaMaxLevleByType(e.xinfaType);if(e.level==a)t=!1;else{var o=e.level+1,r=game.ccfg.GuildXinfaCfg.getXinFaDataByType(e.xinfaType,o);if(!r)return t;t=i.level>=r.guildLevel&&s>=r.costContribution&&0!=r.costContribution&&0!=r.guildLevel}return t},onRqGuildBossInfo:function(){game.GuildSender.rqGuildBossList()},setGuildBossInfo:function(e){if(this.guildBossInfo)if(e.openTime>game.SysTime.curTime){var t=b8e.TimeUtil.formatTimestamp(e.openTime,"<color=#00ff00>Y-M-D h:m</c> 开启");game.notice.show(t)}else e.list&&0!=e.list.length?(this.guildBossInfo.setup(e.list[0]),game.app.show(game.AppConstant.GUILDBOSS),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATE_BOSSPANEL),game.app.isShow(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL)&&game.app.hide(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL)):game.notice.show("未开启")},setGuildBossHp:function(e){this.guildBossInfo&&(this.guildBossInfo.hp=e,b8e.evt.dptG(game.GuildEvt.GUILD_UPDATE_BOSSPANEL))},setGuildBossDie:function(){this.guildBossInfo&&(this.guildBossInfo.hp=0,this.guildBossInfo.state=game.WorldBossStateType.OVER)},getGuildBossInfo:function(){if(this.guildBossInfo)return this.guildBossInfo},setGuildBossNotify:function(e){this.guildBossNotify&&(this.guildBossNotify.setup(e),this.setSceneWorldBoss(e.unitId,e.hp),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATE_DAMAGERANK))},setSceneWorldBoss:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(0!=e){var n,s=game.sceneRole.getDisplayById(e),a=t;s&&s.data&&(s.data.spriteStat.setStatValue(game.SpriteStatType.HP,a),n=s.data.spriteStat.getStatValue(game.SpriteStatType.HP),i?this.setSceneBossDead(s):n<=0&&this.setSceneBossDead(s),b8e.evt.dptG(game.AttributesEvents.ATTR_UPDATA),s.updateHpBar())}},setSceneBossDead:function(e){e.usable&&!e.getStateMachine().isDeadState()&&(e.transitionState(game.RoleStateType.ACTION_DEATH,null,!0),this.stopTimer())},getGuildBossDamageRank:function(){if(this.guildBossNotify)return this.guildBossNotify},onEnterSceneByBoosId:function(e){game.GuildSender.rqEnterGuildBossScene(e)},enterGuildBossSuccessful:function(e){game.worldBoss.damage=e.damage,game.worldBoss.yinbiInspire=e.inspireCount1,game.worldBoss.yuanbaoInspire=e.inspireCount2,game.worldBoss.setisCsWorldBoss(!0),game.mainGui.setStrengthenVisibel(!1),game.mainGui.hideMainMenu(),game.leaveDungeon.show(0,game.SceneType.WORLDBOSS),game.app.hide(game.AppConstant.GUILDBOSS),game.app.hide(game.AppConstant.GUILD_PANEL)},setGuildBossInfoState:function(e,t){if(this.guildBossInfo){if(this.guildBossInfo.state=t,this.guildBossInfo.state==game.WorldBossStateType.OPENING)game.app.isShow(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL)||game.app.show(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL,e);else{var i=game.SceneMgr.inst().getSceneConfig();i&&i.type==game.SceneType.WORLDBOSS&&this.endGuildBoss(),game.app.isShow(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL)&&game.app.hide(game.AppConstant.GUILD_BOSS_ENTER_SHOW_PANEL)}b8e.evt.dptG(game.GuildEvt.GUILD_UPDATE_BOSSPANEL)}},endGuildBoss:function(){var e=new game.GameAlertInfo;e.alertType=game.GameAlertType.OneBtn,e.string=game.ccfg.LangCfg.getText(57001),e.isShowTips=!1,game.gameAlert.showAlert(this,this.onEndClick,e)},onEndClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CANCEL:break;case game.GameAlertBtnType.CONFIRM:game.sura.quitSuraScene()}},isGuildSpotAlert:function(){return!!this.guildBossInfo&&this.guildBossInfo.state==game.WorldBossStateType.OPENING},EXP_CURE_INVITE_CD:3e4,GUILD_EXP_CURE_LEVEL:5,GUILD_EXP_CURE_MAX_TIMES:10,expCureTime:null,_tempDate:null,isExpCure:!1,isClickGuildExpCure:!1,initExpCureCfg:function(){this.GUILD_EXP_CURE_LEVEL=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.GUILD_EXP_CURE_LEVEL),this.EXP_CURE_INVITE_CD=1e3*game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.GUILD_EXP_CURE_CD),this.GUILD_EXP_CURE_MAX_TIMES=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.GUILD_EXP_CURE_MAX_TIMES);var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.GUILD_EXP_CURE_TIME);this.expCureTime=e.split(",")},getTodayStartTime:function(){this._tempDate||(this._tempDate=new Date);var e=game.SysTime.curTime;return this._tempDate.setTime(e),this._tempDate.setHours(parseInt(this.expCureTime[0])),this._tempDate.setMinutes(0),this._tempDate.setSeconds(0),this._tempDate.getTime()},reqGuildExpCure:function(e){if(this.guildModuleInfo.expCureCount>=this.GUILD_EXP_CURE_MAX_TIMES){var t=game.ccfg.LangCfg.getText(77005),i=new game.GameAlertInfo;i.alertType=game.BaseGameAlertType.TwoBtn,i.string=t,i.isShowTips=!0,game.gameAlert.showAlert(this,function(){game.GuildSender.reqGuildExpCure(e)},i)}else game.GuildSender.reqGuildExpCure(e)},reqGuildInviteExpCure:function(e){var t=this.getMemberInfo(e),i=game.SysTime.curTime;if(t&&t.reqExpCoreTime<=i)if(this.guildModuleInfo.expCureCount>=this.GUILD_EXP_CURE_MAX_TIMES){var n=game.ccfg.LangCfg.getText(77005),s=new game.GameAlertInfo;s.alertType=game.BaseGameAlertType.TwoBtn,s.string=n,s.isShowTips=!0,game.gameAlert.showAlert(this,function(){game.GuildSender.reqInviteGuildExpCure(e)},s)}else game.GuildSender.reqInviteGuildExpCure(e)},guildInviteExpCureRp:function(e){var t=this.getMemberInfo(e);t&&(t.reqExpCoreTime=game.SysTime.curTime+this.EXP_CURE_INVITE_CD,b8e.evt.dptG(game.GuildEvt.GUILD_INVITE_EXP_CURE_CHANGE))},getGuildInviteExpCureExpList:function(){var e=[],t=this.getSelfGuildInfo();if(!t)return e;if(!t.memberList||t.memberList.length<=0)return e;for(var i=game.MainRoleMgr.inst().mainRoleData.getLv(),n=0;n<t.memberList.length;n++){var s=t.memberList[n];if(s&&s.id!=game.MainRoleMgr.inst().mainRoleData.mainRoleId&&0==s.logoutTime)game.relation.isBlack(s.id)||Math.abs(i-s.level)<this.GUILD_EXP_CURE_LEVEL||e.push(s)}return e},getGuildExpCurePrizeByLevel:function(e){var t=e-game.MainRoleMgr.inst().mainRoleData.getLv(),i=0<=t,n=game.ccfg.GuildExpCureCfg.getCfgByLevelDiff(Math.abs(t));return n?i?n.expCoef:n.award:null},_guildExpCurePrizeInfo:null,getGuildExpCurePrizeString:function(e){if(this.guildModuleInfo.expCureCount>=this.GUILD_EXP_CURE_MAX_TIMES)return"无";var t=game.MainRoleMgr.inst().mainRoleData.getLv(),i=e-t,n=0<=i,s=game.ccfg.GuildExpCureCfg.getCfgByLevelDiff(Math.abs(i));if(s){if(n){var a=game.ccfg.ExpCfg.getCfgByLevel(t);return"经验 * "+(s.expCoef*a.guildCure>>0)}return this._guildExpCurePrizeInfo||(this._guildExpCurePrizeInfo=new game.PrizeInfo),this._guildExpCurePrizeInfo.setupById(s.award),this._guildExpCurePrizeInfo.getFristPrizeString()}return"无"},startGuildExpCure:function(e){game.app.hide(game.AppConstant.GUILD_EXP_CURE_PANEL),game.app.hide(game.AppConstant.GUILD_PANEL),game.app.hide(game.AppConstant.GUILD_PANEL),this.isExpCure=!0;var t=e-game.SysTime.curTime;game.CollectMgr.inst().show(3,t,!1,this.getGuildExpCurePrize,this)},getGuildExpCurePrize:function(){this.isExpCure=!1,game.GuildSender.reqGuildExpCureComplete()},getGuildExpCurePrizeComplete:function(e){this.guildModuleInfo.expCureCount++;var t=this.getMemberInfo(e),i=game.relation.isFriend(e),n=game.relation.isBlack(e);if(t&&!i&&!n){var s={};s.id=e,s.name=t.name,s.head=t.head,s.level=t.level,s.power=t.power,s.relation=game.MemberRelationType.GUILD,game.RelationMgr.inst().showFriendsRecommend("成功传功！交个好友下次再一起传功吧！",[s])}},alertGuildExpCure:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!game.funcOpen.checkOpen(game.FunctionType.GUILD_EXP_CURE))&&(this.guildModuleInfo&&this.guildModuleInfo.expCureCount<this.GUILD_EXP_CURE_MAX_TIMES&&0==this.isClickGuildExpCure)}}),game.GuildMgr._instance=null,game.GuildMgr._singleton=!0,game.GuildMgr.inst=function(){return game.GuildMgr._instance||(game.GuildMgr._singleton=!1,game.GuildMgr._instance=new game.GuildMgr,game.GuildMgr._singleton=!0),game.GuildMgr._instance}},{}],418:[function(e,t,i){"use strict";e("./GuildMgr")},{"./GuildMgr":417}],419:[function(e,t,i){"use strict";game.GuildActiveItem=game.SkinUI.extends({_guildTaskInfo:null,_guildDailyQuestInfo:null,ctor:function(){this._super("guild/GuildActiveItemSkin","GuildActiveItemSkin")},getHeight:function(){return 110},getWidth:function(){return 505},onShow:function(){this.setData(this._guildTaskInfo),b8e.evt.onC(this._skin.btn_complete,this.onCompleteTask,this),b8e.evt.onC(this._skin.btn_goto,this.onGotoTask,this)},onHide:function(){b8e.evt.offC(this._skin.btn_complete,this.onCompleteTask,this),b8e.evt.offC(this._skin.btn_goto,this.onGotoTask,this)},setData:function(e){if(this._guildTaskInfo=e,this._skin&&(this.clearData(),this._guildTaskInfo)){if(this._guildDailyQuestInfo=game.ccfg.GuildQuestCfg.getGuildDailyQuestInfoById(this._guildTaskInfo.id),!this._guildDailyQuestInfo)return this._skin.lab_num.string="",this._skin.lab_name.string="",void(this._skin.lab_desc.string="");this._skin.lab_num.string=this._guildDailyQuestInfo.score;var t=" ("+this._guildTaskInfo.num+"/"+this._guildDailyQuestInfo.param+")";t=this._guildTaskInfo.num>=this._guildDailyQuestInfo.param?game.html.getText(game.html.Q_GREEN,t):game.html.getText(game.html.LIGHT_YELLOW,t),this._skin.lab_name.string=this._guildDailyQuestInfo.desc+t;var i=game.html.getText(game.html.Q_WHITE,"帮会经验"),n=game.html.getText(game.html.Q_GREEN," +"+this._guildDailyQuestInfo.exp),s=game.html.getText(game.html.Q_WHITE," 帮贡"),a=game.html.getText(game.html.Q_GREEN," +"+this._guildDailyQuestInfo.contribution);switch(this._skin.lab_desc.string="奖励:"+i+n+s+a,this._guildTaskInfo.state){case game.GuildQuestType.CAN_RECEIVE:this._skin.btn_complete.active=!0;break;case game.GuildQuestType.RECEIVE:this._skin.img_complete.active=!0;break;default:this._skin.btn_goto.active=!0}}},clearData:function(){this._skin.img_complete.active=!1,this._skin.btn_complete.active=!1,this._skin.btn_goto.active=!1},onCompleteTask:function(){this._guildTaskInfo&&game.GuildSender.reqFinishGuildQuest(this._guildTaskInfo.id)},onGotoTask:function(){this._guildTaskInfo&&(this._guildDailyQuestInfo&&this._guildDailyQuestInfo.conditionParam?game.TriggerMgr.inst().customTriggerById(this._guildDailyQuestInfo.conditionParam):game.quest.getTrusteeshipLocation(),game.app.isShow(game.AppConstant.GUILD_ACTIVE_PANEL)&&game.app.hide(game.AppConstant.GUILD_ACTIVE_PANEL))}})},{}],420:[function(e,t,i){"use strict";game.GuildActivePanel=game.SkinUI.extends({_list:null,_curGuildQueatInfo:null,_activeItemVec:null,weekgridSp_0:null,weekgridSp_1:null,ctor:function(){this._super("guild/GuildActiveSkin","GuildActiveSkin"),this._activeItemVec=[]},init:function(){this.weekgridSp_0=b8e.Sprite.get(),this.weekgridSp_0.setAnchor(.5,.5),this.weekgridSp_0.addToParent(this._skin.weekgrid_0),this.weekgridSp_1=b8e.Sprite.get(),this.weekgridSp_1.setAnchor(.5,.5),this.weekgridSp_1.addToParent(this._skin.weekgrid_1)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildActiveItem)),this._list.show(),game.GuildSender.reqGuildQuest(),b8e.evt.onC(this._skin.weekgrid_0,this.onWeelAwardClick_0,this),b8e.evt.onC(this._skin.weekgrid_1,this.onWeelAwardClick_1,this),b8e.evt.addG(this,game.GuildEvt.GUILD_QUEST_RESPONSE,this.updateInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_COMPELTE_QUEST,this.updateInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_GET_AWARDS_SUCCESS,this.updateGridInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_GET_AWARDS_SUCCESS,this.updateWeekGridInfo)},onHide:function(){this.clearGrid(),this._list&&this._list.hide(),b8e.evt.offC(this._skin.weekgrid_0,this.onWeelAwardClick_0,this),b8e.evt.offC(this._skin.weekgrid_1,this.onWeelAwardClick_1,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_QUEST_RESPONSE,this.updateInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_COMPELTE_QUEST,this.updateInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_GET_AWARDS_SUCCESS,this.updateGridInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_GET_AWARDS_SUCCESS,this.updateWeekGridInfo)},_taskArr:null,updateInfo:function(){if(this._curGuildQueatInfo=game.guild.curGuildQueatInfo,this._curGuildQueatInfo){var e=this._curGuildQueatInfo.guildQuestList;if(e&&0<e.length){var t;this._taskArr||(this._taskArr=[]);for(var i=this._taskArr.length=0;i<e.length;i++)(t=e[i])&&game.ccfg.GuildQuestCfg.getGuildDailyQuestInfoById(t.id)&&this._taskArr.push(t);this._taskArr&&0<this._taskArr.length&&this._taskArr.sort(this.onSort)}this._list.setData(this._taskArr),this.updateActiveAwards()}},onSort:function(e,t){if(e.state==game.GuildQuestType.CAN_RECEIVE&&t.state==game.GuildQuestType.CAN_RECEIVE){if(e.id>t.id)return 1;if(e.id<t.id)return-1}else{if(e.state==game.GuildQuestType.CAN_RECEIVE&&t.state!=game.GuildQuestType.CAN_RECEIVE)return-1;if(e.state!=game.GuildQuestType.CAN_RECEIVE&&t.state==game.GuildQuestType.CAN_RECEIVE)return 1;if(0==e.state&&0==t.state){if(e.id>t.id)return 1;if(e.id<t.id)return-1}else{if(0==e.state&&0!=t.state)return-1;if(0!=e.state&&0==t.state)return 1;if(e.state==game.GuildQuestType.RECEIVE&&t.state==game.GuildQuestType.RECEIVE){if(e.id>t.id)return 1;if(e.id<t.id)return-1}else{if(e.state==game.GuildQuestType.RECEIVE&&t.state!=game.GuildQuestType.RECEIVE)return-1;if(e.state!=game.GuildQuestType.RECEIVE&&t.state==game.GuildQuestType.RECEIVE)return 1}}}return 0},updateActiveAwards:function(){if(this._curGuildQueatInfo){this._skin.lab_num.string=this._curGuildQueatInfo.score,this._skin.weeklabNum.string=this._curGuildQueatInfo.weeklyScore;var e=game.ccfg.GuildQuestAwardCfg.getMaxScore(),t=this._curGuildQueatInfo.score/e*this._skin.progressBarNode.width;this._skin.maskNode.width=t,this.updateGridInfo(),this.updateWeekGridInfo()}},updateGridInfo:function(){var e=this._activeItemVec.length,t=game.ccfg.GuildQuestAwardCfg.getQuestAwardList();if(t&&!(t.length<=0))for(var i,n,s=new game.PrizeInfo,a=0;a<t.length;a++){var o=t[a];if(o){o.itemInfo=n;var r=this._skin["grid_"+a];a<e?i=this._activeItemVec[a]:(i=game.GridUtil.creatItemGrid(this,r,null,game.ContainerId.GUILD_ACTIVE_CONTAINER_ID,this.onClick),this._activeItemVec.push(i)),s.setupById(o.award);var h=s._prizeArr[0];h&&(n=game.ccfg.ItemInfoCfg.getItemInfoById(h.itemId),i.setNum(h.num)),game.GridUtil.setItemGrid(i,n),this.updateGuildActiveGrids(i,o),i.faceInfo=o,i.sortLayer();var g=game.guild.isCanGetActiveAwards(o.id);this._skin["redIcon_"+a].active=g}}},updateGuildActiveGrids:function(e,t){var i;game.guild.isCanGetActiveAwards(t.id)?(i=game.html.Q_GREEN,e.setEffect("10009",game.AnimatorType.GUILD_SCORE_EFFECT)):(i=game.html.Q_WHITE,e.clearEffect()),game.guild.isGetActiveAwards(t.id)?(i=game.html.Q_GREEN,e.setIsReceive(!0)):e.setIsReceive(!1),e.setName(game.ccfg.LangCfg.getText(53001,[t.score]),i),e.sortLayer()},onClick:function(e){e&&e.faceInfo&&(game.guild.isCanGetActiveAwards(e.faceInfo.id)?game.guild.isGetActiveAwards(e.faceInfo.id)?game.notice.show(53004):game.GuildSender.reqGetGuildQuestAward(e.faceInfo.id):game.notice.show(53003))},updateWeekGridInfo:function(){var e=game.ccfg.GuildQuestAwardCfg.getWeekAwardList();if(e&&!(e.length<=0))for(var t,i=0;i<e.length;i++){var n=e[i];if(n){t=game.guild.isGetWeekAwardById(n.id)?n.receivedBg:n.normalBg,0==i?this.weekgridSp_0.loadTexture(game.ClientCfg.getImgUrl(t,!1),null,null,{useManifest:!1}):this.weekgridSp_1.loadTexture(game.ClientCfg.getImgUrl(t,!1),null,null,{useManifest:!1});var s=game.guild.isCanGetWeekAwards(n.id);this._skin["weeklyRedIcon_"+i].active=s,this._skin["target_"+i].string=game.ccfg.LangCfg.getText(53002,[n.score])}}},onWeelAwardClick_0:function(){var e=game.ccfg.GuildQuestAwardCfg.getWeekAwardList();if(e&&!(e.length<=0)){var t=e[0].id;this.clickWeekBack(t,e[0].award)}},onWeelAwardClick_1:function(){var e=game.ccfg.GuildQuestAwardCfg.getWeekAwardList();if(e&&!(e.length<=1)){var t=e[1].id;this.clickWeekBack(t,e[1].award)}},clickWeekBack:function(e,t){game.guild.isCanGetWeekAwards(e)&&!game.guild.isGetWeekAwardById(e)?game.GuildSender.reqGetGuildQuestAward(e):game.app.show(game.AppConstant.AWARD_TIPS_PANEL,t)},clearGrid:function(){for(var e=0;e<this._activeItemVec.length;e++){var t=this._activeItemVec[e];t&&game.GridUtil.setItemGrid(t,null)}}})},{}],421:[function(e,t,i){"use strict";game.GuildAdministerItem=game.SkinUI.extends({_memberInfo:null,_headSprite:null,ctor:function(){this._super("guild/GuildAdministerItemSkin","GuildAdministerItemSkin")},getHeight:function(){return 105},getWidth:function(){return 540},onShow:function(){this.setData(this._memberInfo),b8e.evt.onC(this._skin.btn_no,this.onNo,this),b8e.evt.onC(this._skin.btn_ok,this.onAgree,this)},onHide:function(){this._headSprite&&this._headSprite.unloadTexture(),b8e.evt.offC(this._skin.btn_no,this.onNo,this),b8e.evt.offC(this._skin.btn_ok,this.onAgree,this)},setData:function(e){if(this._memberInfo=e,this._skin&&(this.clearData(),this._memberInfo)){this._headSprite||(this._headSprite=b8e.Sprite.get(),this._headSprite.addToParent(this._skin.img_icon));var t="";t=""!=this._memberInfo.head?this._memberInfo.head:"0";t=game.ClientCfg.getHeadIconUrlByHeadId(t);this._headSprite.setScale(1.5),this._headSprite.loadTexture(t,null,null,{useManifest:!1}),this._skin.lab_name.string=this._memberInfo.name+"Lv."+this._memberInfo.level,this._skin.lab_fight.string=this._memberInfo.power}},clearData:function(){this._headSprite&&this._headSprite.unloadTexture(),this._skin.lab_name.string="",this._skin.lab_fight.string=""},onAgree:function(){this._memberInfo&&game.guild.reqHandleGuild(this._memberInfo.id,game.GuildApplyType.AGREE)},onNo:function(){this._memberInfo&&game.guild.reqHandleGuild(this._memberInfo.id,game.GuildApplyType.REFUSED)}})},{}],422:[function(e,t,i){"use strict";game.appModule.GuildAdministerPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildAdministerItem)),this._list.show(),this._skin.lab_tip.string="",this.updateInfo(),b8e.evt.onC(this._skin.btn_setting,this.onSetting,this),b8e.evt.onC(this._skin.btn_allJujue,this.onAllJuJue,this),b8e.evt.onC(this._skin.btn_allOk,this.onAllAgree,this),b8e.evt.addG(this,game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS,this.updateInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_setting,this.onSetting,this),b8e.evt.offC(this._skin.btn_allJujue,this.onAllJuJue,this),b8e.evt.offC(this._skin.btn_allOk,this.onAllAgree,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS,this.updateInfo)},updateInfo:function(){var e=game.guild.getSelfGuildInfo();if(e){var t=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(e.level);t&&(this._skin.lab_num.string="帮会人数:"+e.count+"/"+t.memberLimit)}var i=game.guild.getApplyList();this._list.setData(i),i&&0<i.length?this._skin.lab_tip.string="":this._skin.lab_tip.string="无申请信息"},onSetting:function(){game.app.show(game.AppConstant.GUILD_SETTING_PANEL)},onAllJuJue:function(){game.guild.reqHandleGuild(0,game.GuildApplyType.ALL_REFUSED)},onAllAgree:function(){game.guild.reqHandleGuild(0,game.GuildApplyType.ALL_AGREE)}})},{}],423:[function(e,t,i){"use strict";game.GuildApplyItem=game.SkinUI.extends({ctor:function(){this._super("guild/GuildApplyItemSkin","GuildApplyItemSkin")},getHeight:function(){return 85},getWidth:function(){return 540},onShow:function(){this.setData(this._guildInfo),b8e.evt.onC(this._skin.btn_apply,this.onApply,this),b8e.evt.onC(this._skin.btn_join,this.onJoin,this),b8e.evt.onC(this._skin.lab_guildName.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.btn_apply,this.onApply,this),b8e.evt.offC(this._skin.btn_join,this.onJoin,this),b8e.evt.offC(this._skin.lab_guildName.node,this.onShowMenu,this)},setData:function(e){if(this._guildInfo=e,this._skin&&(this.clearData(),this._guildInfo)){this._skin.lab_index.string=this._guildInfo.index,this._skin.lab_guildName.string=game.html.getText(game.html.LIGHT_YELLOW,this._guildInfo.name),this._skin.lab_guildLv.string="(Lv."+this._guildInfo.level+")",this._skin.lab_guildLv.node.x=this._skin.lab_guildName.node.x+this._skin.lab_guildName.node.width+5;var t=game.html.getText(game.html.GRAY_WHITE,this._guildInfo.masterName),i=game.ccfg.LangCfg.getText("帮主:$",[t]);this._skin.lab_name.string=i;var n=game.guild.getGuildMembers(this._guildInfo),s=game.guild.getGuildMemberLimit(this._guildInfo),a=game.html.getText(game.html.GRAY_WHITE,n+"/"+s),o=game.ccfg.LangCfg.getText("人数:$",[a]);if(this._skin.lab_num.string=o,this._skin.lab_conditions.node.active=!1,this._skin.btn_apply.active=!1,this._skin.btn_join.active=!1,game.guild.isInReq(this._guildInfo.id))this._skin.lab_conditions.node.active=!0,this._skin.lab_conditions.string=game.html.getText(game.html.Q_GREEN,"申请中");else if(game.mainRole.mainRoleData.getZhanLi()<this._guildInfo.powerLimit){this._skin.lab_conditions.node.active=!0;var r="";r=1e4<=this._guildInfo.powerLimit?this._guildInfo.powerLimit/1e4+"万":this._guildInfo.powerLimit/1e4;var h=game.html.getText(game.html.Q_YELLOW,r),g=game.ccfg.LangCfg.getText("战力\n$",[h]);this._skin.lab_conditions.string=g}else this._guildInfo.state==game.GuildState.OPEN?this._skin.btn_join.active=!0:this._skin.btn_apply.active=!0}},onShowMenu:function(e){var t=new game.MenuData;t.roleId=this._guildInfo.master,t.roleName=this._guildInfo.masterName,game.menu.show(this,e,game.MenuList.GUILD_VIEW_GUILD_MASTER_MENU,t)},onApply:function(){this._guildInfo&&(game.guild.isMaxMember(this._guildInfo)?game.notice.show("帮会成员已满"):game.GuildSender.reqGuildJoin(this._guildInfo.id))},onJoin:function(){this._guildInfo&&(game.guild.isMaxMember(this._guildInfo)?game.notice.show("帮会成员已满"):game.GuildSender.reqGuildJoin(this._guildInfo.id))},clearData:function(){this._skin.lab_index.string="",this._skin.lab_guildName.string="",this._skin.lab_guildLv.string="",this._skin.lab_name.string="",this._skin.lab_num.string=""}})},{}],424:[function(e,t,i){"use strict";game.appModule.GuildCreateTip=game.SkinUIPanel.extends({_isEnough:null,ctor:function(e){this._super(e)},onShow:function(){this._skin.editBox.string="",this.updateCostInfo(),b8e.evt.onC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.onC(this._skin.btn_ok,this.onSender,this),b8e.evt.addG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.onHidePanel),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateCostInfo)},onHide:function(){this._skin.editBox.string="",b8e.evt.offC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.offC(this._skin.btn_ok,this.onSender,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.onHidePanel),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateCostInfo)},onHidePanel:function(){this.hide()},updateCostInfo:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CREATE_GUILD_COST).split("|");if(2==e.length){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e[0]);game.upgrade.costCheckMoney(t.type,e[1])?(this._isEnough=!0,this._skin.lab_cost.string="       "+e[1]):(this._isEnough=!1,this._skin.lab_cost.string="       "+game.html.getText(game.html.Q_RED,e[1]))}else this._isEnough=!1,this._skin.lab_cost.string="配置错误"},onSender:function(){var e=this._skin.editBox.string;if(""!=e){var t=!1,i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CREATE_GUILD_COST).split("|");if(2==i.length){var n=game.ccfg.ItemInfoCfg.getItemInfoById(i[0]);t=game.upgrade.costCheckMoney(n.type,i[1],!0,!0)}t&&game.GuildSender.reqCreateGuild(e)}else game.notice.show("请输入帮会名字！")}})},{}],425:[function(e,t,i){"use strict";game.appModule.GuildEditNoticePanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.onC(this._skin.btn_ok,this.onSender,this)},onHide:function(){b8e.evt.offC(this._skin.btn_no,this.onHidePanel,this),b8e.evt.offC(this._skin.btn_ok,this.onSender,this)},onHidePanel:function(){this.hide()},onSender:function(){var e=b8e.SensitiveWords.filter(this._skin.editBox.string,"*");""!=e?(game.guild.guildNotice=e,game.GuildSender.reqSetGuildNotice(e),this.hide()):game.notice.show("请输入内容！")}})},{}],426:[function(e,t,i){"use strict";game.GuildExpCureItem=game.SkinUI.extends({_timer:null,_head:null,_data:null,ctor:function(){this._super("guild/GuildExpCureItemSkin","GuildExpCureItemSkin")},init:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.setAnchor(.5,.5),this._head.addToParent(this._skin.head))},onShow:function(){b8e.evt.onC(this._skin.inviteBtn,this.onInviteBtn,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.inviteBtn,this.onInviteBtn,this),this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},setData:function(e){if(this._data=e,this._skin){switch(this._data.rank){case game.GuildRank.MASTER:this._skin.pos_leader.active=!0,this._skin.pos_zhanglao.active=!1;break;case game.GuildRank.ZHANG_LAO:this._skin.pos_leader.active=!1,this._skin.pos_zhanglao.active=!0;break;case game.GuildRank.MEMBER:this._skin.pos_leader.active=!1,this._skin.pos_zhanglao.active=!1}this._skin.roleName.string=e.name;var t=game.guild.getGuildExpCurePrizeString(this._data.level);this._skin.prize.string="传功奖励:"+t,this._skin.level.string="Lv."+e.level,0!=e.reqExpCoreTime&&e.reqExpCoreTime>game.SysTime.curTime?(this._skin.invitingTime.node.active=!0,this._skin.inviteBtn.active=!1,this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500))):(this._skin.inviteBtn.active=!0,this._skin.invitingTime.node.active=!1);var i=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=i&&i?this._head.loadTexture(game.ClientCfg.getHeadUrl(i),null,null,{useManifest:!1}):this._head.unloadTexture()}},updateTime:function(){if(this._data){var e=this._data.reqExpCoreTime-game.SysTime.curTime;0<=e?this._skin.invitingTime.string="邀请中 "+(e/1e3>>0):(this._skin.inviteBtn.active=!0,this._skin.invitingTime.node.active=!1,this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null))}},onInviteBtn:function(){this._data&&game.guild.reqGuildInviteExpCure(this._data.id)},getHeight:function(){return 90},getWidth:function(){return 545}})},{}],427:[function(e,t,i){"use strict";game.appModule.GuildExpCurePanel=game.SkinUIPanel.extends({_list:null,_bg:null,_title:null,init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildExpCureItem)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(.5,.5),this._bg.addToParent(this._skin.listBg),this._bg.loadTexture(game.ClientCfg.guildExpCureBg,null,null,{useManifest:!1})),this.titleBg||(this.titleBg=b8e.Sprite.get(),this.titleBg.setAnchor(.5,.5),this.titleBg.addToParent(this._skin.titleBg),this.titleBg.loadTexture(game.ClientCfg.guildExpCureTitle,null,null,{useManifest:!1}));var e=game.guild.expCureTime;e&&(this._skin.time.string=game.ccfg.LangCfg.getText(77004,e))},onShow:function(){b8e.evt.onC(this._skin.help,this.onHelp,this),b8e.evt.addG(this,game.GuildEvt.GUILD_INVITE_EXP_CURE_CHANGE,this.onPanelChange),this._list&&this._list.show(),this.onPanelChange()},onHide:function(){b8e.evt.offC(this._skin.help,this.onHelp,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_INVITE_EXP_CURE_CHANGE,this.onPanelChange),this._list&&this._list.hide()},onPanelChange:function(){var e=game.guild.GUILD_EXP_CURE_MAX_TIMES,t=e-game.guild.getGuildModuleInfo().expCureCount;t<0&&(t=0),this._skin.times.string=t+"/"+e;var i=game.guild.getGuildInviteExpCureExpList();if(!i||0==i.length)return this._skin.dontHave.active=!0,void this._list.setData([]);this._skin.dontHave.active=!1,this._list.setData(i)},onHelp:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.GUILD_EXP_CURE_RULE_ID)}})},{}],428:[function(e,t,i){"use strict";game.GuildInfoPanel=game.SkinUI.extends({_guilfInfo:null,_list:null,ctor:function(){this._super("guild/GuildInfoSkin","GuildInfoSkin")},getButtonByName:function(e){switch(e){case"guildTaskItem0":if(this._list){var t=this._list.getItemRender(0);if(t)return t}return!0}return null},onShow:function(){game.guild.isHasGuild()&&game.GuildSender.reqGuildInfo(),this._list||(this._list=new b8e.List(this._skin.list,game.GuildTaskItem,2)),this._list.show(),b8e.evt.onC(this._skin.btn_administer,this.onOpenGuildAdministerPanel,this),b8e.evt.onC(this._skin.btn_bianji,this.onOpenGuildEditNoticePanel,this),b8e.evt.onC(this._skin.previewBtn,this.openLevelTipsPanel,this),b8e.evt.addG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.updateGuildInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_APPLY_LIST,this.updateBtnAdministerState),b8e.evt.addG(this,game.GuildEvt.GUILD_SET_GUILD_NOTICE_SUCCESS,this.updateGuildNotice),b8e.evt.addG(this,game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS,this.updateBtnAdministerState),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange()},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_administer,this.onOpenGuildAdministerPanel,this),b8e.evt.offC(this._skin.btn_bianji,this.onOpenGuildEditNoticePanel,this),b8e.evt.offC(this._skin.previewBtn,this.openLevelTipsPanel,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.updateGuildInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_APPLY_LIST,this.updateBtnAdministerState),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SET_GUILD_NOTICE_SUCCESS,this.updateGuildNotice),b8e.evt.rmvG(this,game.GuildEvt.GUILD_HANDLE_APPLY_LIST_SUCCESS,this.updateBtnAdministerState),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onSpotAlertChange:function(){this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_MANAGER)},updateBtnAdministerState:function(){var e=game.guild.isHasApply();this._skin.img_redPoint.active=e},updateGuildInfo:function(){if(this.clearData(),this._guilfInfo=game.guild.getSelfGuildInfo(),this._guilfInfo){game.guild.isCanApply()&&game.GuildSender.reqGuildReqList(),this._skin.lab_guildName.string=this._guilfInfo.name,this._skin.lab_name.string=this._guilfInfo.masterName;var e=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(this._guilfInfo.level);if(e){var t=e.memberLimit;this._skin.lab_members.string=this._guilfInfo.count+"/"+t;var i=e.exp;this._skin.lab_guildExp.string=this._guilfInfo.exp+"/"+i,this._skin.progressBar.progress=this._guilfInfo.exp/i}var n=game.guild.getSelfGuildRank()<game.GuildRank.ZHANG_LAO;this._skin.btn_administer.active=n,this._skin.btn_bianji.active=n,this._skin.lab_guildLv.string=this._guilfInfo.level+"级",this.updateGuildNotice(),this.updateGuildTask()}},updateGuildNotice:function(){if(this._guilfInfo){var e="";e=""==this._guilfInfo.notice?"暂无公告":this._guilfInfo.notice,this._skin.lab_gonggao.string=b8e.SensitiveWords.filter(e,"*")}},updateGuildTask:function(){var e=game.ccfg.GuildActivityCfg.getAllGuildActivityInfoList();e&&0<e.length&&e.sort(this.onSort),this._list.setData(e)},onSort:function(e,t){return e.sort>t.sort?1:e.sort<t.sort?-1:0},onOpenGuildAdministerPanel:function(){game.app.show(game.AppConstant.GUILD_ADMINISTER_PANEL)},onOpenGuildEditNoticePanel:function(){game.app.show(game.AppConstant.GUILD_EDIT_NOTICE_PANEL)},openLevelTipsPanel:function(){game.app.show(game.AppConstant.GUILD_LEVEL_TIPS)},clearData:function(){this._skin.btn_administer.active=!1,this._skin.lab_guildName.string="",this._skin.lab_name.string="",this._skin.lab_members.string="",this._skin.lab_guildLv.string="",this._skin.lab_guildExp.string="",this._skin.progressBar.progress=0,this._skin.lab_gonggao.string=""}})},{}],429:[function(e,t,i){"use strict";game.appModule.GuildLevelTips=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this.updateInfo(),b8e.evt.onC(this._skin.btn_ok,this.onHidePanel,this),b8e.evt.onC(this._skin.lab_ok,this.onHidePanel,this)},onHide:function(){b8e.evt.offC(this._skin.btn_ok,this.onHidePanel,this),b8e.evt.offC(this._skin.lab_ok,this.onHidePanel,this)},updateInfo:function(){this._skin.lab_content.node.active=!1;var e=game.guild.getSelfGuildInfo();if(e){this._skin.lab_content.node.active=!0;var t=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(e.level),i=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(e.level+1);i?t&&(this._skin.lab_content.string=game.ccfg.LangCfg.getText(10408,[e.level,game.html.getText(game.html.Q_GREEN,t.memberLimit),game.html.getText(game.html.Q_GREEN,t.xinfaLimit),e.level+1,game.html.getText(game.html.Q_GREEN,i.memberLimit),game.html.getText(game.html.Q_GREEN,i.xinfaLimit)])):t&&(this._skin.lab_content.string=game.ccfg.LangCfg.getText(10409,[e.level,game.html.getText(game.html.Q_GREEN,t.memberLimit),game.html.getText(game.html.Q_GREEN,t.xinfaLimit)]))}},onHidePanel:function(){this.hide()}})},{}],430:[function(e,t,i){"use strict";game.GuildListItem=game.SkinUI.extends({_guildInfo:null,ctor:function(){this._super("guild/GuildListItemSkin","GuildListItemSkin")},getHeight:function(){return 85},getWidth:function(){return 540},onShow:function(){this.setData(this._guildInfo),b8e.evt.onC(this._skin.lab_name.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.lab_name.node,this.onShowMenu,this)},onShowMenu:function(e){var t=this._guildInfo.master;if(game.mainRole.mainRoleData.playerId!=t){var i=new game.MenuData;i.roleId=t,i.roleName=this._guildInfo.masterName,game.relation.isFriend(t)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,i):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,i)}else b8e.log("你点击了你自己")},setData:function(e){if(this._guildInfo=e,this._skin&&(this.clearData(),this._guildInfo)){this._skin.lab_index.string=this._guildInfo.index;var t=game.ccfg.LangCfg.getText("$$",[game.html.getText(game.html.LIGHT_YELLOW,this._guildInfo.name),game.html.getText(game.html.Q_GREEN,"(Lv."+this._guildInfo.level+")")]);this._skin.lab_guildName.string=t;var i=game.html.getText(game.html.GRAY_WHITE,this._guildInfo.masterName),n=game.ccfg.LangCfg.getText("帮主:$",[i]);this._skin.lab_name.string=n;var s=game.guild.getGuildMembers(this._guildInfo),a=game.guild.getGuildMemberLimit(this._guildInfo),o=game.html.getText(game.html.GRAY_WHITE,s+"/"+a),r=game.ccfg.LangCfg.getText("人数:$",[o]);this._skin.lab_num.string=r}},clearData:function(){this._skin.lab_index.string="",this._skin.lab_guildName.string="",this._skin.lab_name.string="",this._skin.lab_num.string=""}})},{}],431:[function(e,t,i){"use strict";game.GuildListPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("guild/GuildListSkin","GuildListSkin")},onShow:function(){this._skin.lab_tip.string="",game.GuildSender.reqGuildRank(),this._list||(this._list=new b8e.List(this._skin.list,game.GuildListItem)),this._list.show(),b8e.evt.addG(this,game.GuildEvt.GUILD_RANK_LIST,this.updateList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.GuildEvt.GUILD_RANK_LIST,this.updateList)},updateList:function(){var e=game.guild.getGuildRankList();this._list.setData(e),e&&0<e.length?this._skin.lab_tip.string="":this._skin.lab_tip.string="未建立任何帮会"},onSort:function(e,t){return e.level>t.level?-1:e.level<t.level?1:e.createTime>t.createTime?1:e.createTime<t.createTime?-1:0}})},{}],432:[function(e,t,i){"use strict";game.GuildLogItem=game.SkinUI.extends({_guildLogInfo:null,ctor:function(){this._super("guild/GuildLogItemSkin","GuildLogItemSkin")},getHeight:function(){return 60},getWidth:function(){return 540},onShow:function(){this.setData(this._guildLogInfo)},onHide:function(){this._skin.lab_log.string=""},setData:function(e){if(this._guildLogInfo=e,this._skin&&(this.clearData(),this._guildLogInfo)){this._skin.img_xitong.active=!0;var t="",i="",n="";i="("+b8e.TimeUtil.formatTimestamp(this._guildLogInfo.time,"h:m")+")";switch(i=game.html.getText(game.html.GRAY,i),this._guildLogInfo.type){case game.GuildLog.JOIN_TYPE:t=game.html.getText(game.html.Q_BLUE,this._guildLogInfo.name),n=game.ccfg.LangCfg.getText("$加入了帮会$",[t,i]);break;case game.GuildLog.LEVEA_TYPE:t=game.html.getText(game.html.Q_BLUE,this._guildLogInfo.name),n=game.ccfg.LangCfg.getText("$离开了帮会$",[t,i]);break;case game.GuildLog.LEVEL_UP_TYPE:t=game.html.getText(game.html.Q_BLUE,this._guildLogInfo.level),n=game.ccfg.LangCfg.getText("帮会升至$级$",[t,i]);break;case game.GuildLog.CHANGE_RANK_TYPE:if(this._guildLogInfo.changeRankInfo){var s=game.html.getText(game.html.Q_BLUE,this._guildLogInfo.changeRankInfo.name),a=game.html.getText(game.html.Q_BLUE,game.guild.getRankName(this._guildLogInfo.changeRankInfo.rank));n=game.ccfg.LangCfg.getText("$成为了$$",[s,a,i])}}this._skin.lab_log.string=n}},clearData:function(){this._skin.img_xitong.active=!1,this._skin.lab_log.string=""}})},{}],433:[function(e,t,i){"use strict";game.GuildLogPanel=game.SkinUI.extends({_list:null,_logs:null,ctor:function(){this._super("guild/GuildLogSkin","GuildLogSkin")},onShow:function(){game.GuildSender.reqGuildLog(),this._list||(this._list=new b8e.List(this._skin.list,game.GuildLogItem)),this._list.show(),this.updateGuildLog(),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATE_GUILD_LOGS,this.updateGuildLog)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATE_GUILD_LOGS,this.updateGuildLog)},updateGuildLog:function(){var e=game.guild.getGuildLogList();!e||e.length<=0||this._list.setData(e)}})},{}],434:[function(e,t,i){"use strict";game.GuildMemberItem=game.SkinUI.extends({_memberInfo:null,ctor:function(){this._super("guild/GuildMemberItemSkin","GuildMemberItemSkin")},getHeight:function(){return 70},getWidth:function(){return 540},onShow:function(){this.setData(this._memberInfo),b8e.evt.onC(this._skin.btn_shezhi,this.onSetting,this),b8e.evt.onC(this._skin.lab_name.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.btn_shezhi,this.onSetting,this),b8e.evt.offC(this._skin.lab_name.node,this.onShowMenu,this)},onShowMenu:function(e){var t=this._memberInfo.id;if(game.mainRole.mainRoleData.playerId!=t){var i=new game.MenuData;i.roleId=t,i.roleName=this._memberInfo.name,game.relation.isFriend(t)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,i):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,i)}else b8e.log("你点击了你自己，sb")},setData:function(e){if(this._memberInfo=e,this._skin&&(this.clearData(),this._memberInfo)){switch(this._memberInfo.rank){case game.GuildRank.MASTER:this._skin.icon_master.active=!0;break;case game.GuildRank.ZHANG_LAO:this._skin.icon_zhanglao.active=!0;break;case game.GuildRank.MEMBER:}game.mainRole.mainRoleData.playerId==this._memberInfo.id?(this._skin.img_select_di.active=!0,this._skin.btn_shezhi.active=!0):(this._skin.img_select_di.active=!1,this._skin.btn_shezhi.active=game.guild.isCanApply()),this._skin.lab_name.string=this._memberInfo.name,this._skin.lab_power.string=this._memberInfo.power;var t="";if(0<this._memberInfo.logoutTime){var i=game.SysTime.curTime-this._memberInfo.logoutTime;t=game.html.getText(game.html.OLD_TIME_COLOR,b8e.TimeUtil.getLogoutTime(i))}else t=game.html.getText(game.html.ON_LINE_COLOR,"在线");this._skin.lab_state.string=t}},onSetting:function(e){var t=game.mainRole.mainRoleData,i=game.guild.getSelfGuildInfo(),n=new game.MenuData;game.guild.isMaster()?t.playerId==this._memberInfo.id?(n.roleId=t.playerId,n.roleName=t.name,game.menu.show(this,e,game.MenuList.GUILD_MASTER_CLICK_SELF_MENU,n)):(n.roleId=this._memberInfo.id,n.roleName=this._memberInfo.name,game.menu.show(this,e,game.MenuList.GUILD_MASTER_CLICK_OTHER_MENU,n)):game.guild.isZhanglao()?game.guild.isMasterById(i,this._memberInfo.id)?(n.roleId=this._memberInfo.id,n.roleName=this._memberInfo.name,game.menu.show(this,e,game.MenuList.GUILD_MEMBER_CLICK_OTHER_MENU,n)):t.playerId==this._memberInfo.id?(n.roleId=t.playerId,n.roleName=t.name,game.menu.show(this,e,game.MenuList.GUILD_ZHANG_LAO_CLICK_SELF_MENU,n)):(n.roleId=this._memberInfo.id,n.roleName=this._memberInfo.name,game.menu.show(this,e,game.MenuList.GUILD_ZHANG_LAO_CLICK_OTHER_MENU,n)):t.playerId==this._memberInfo.id?(n.roleId=t.playerId,n.roleName=t.name,game.menu.show(this,e,game.MenuList.GUILD_MEMBER_CLICK_SELF_MENU,n)):(n.roleId=this._memberInfo.id,n.roleName=this._memberInfo.name,game.menu.show(this,e,game.MenuList.GUILD_MEMBER_CLICK_OTHER_MENU,n))},clearData:function(){this._skin.img_select_di.active=!1,this._skin.icon_master.active=!1,this._skin.icon_zhanglao.active=!1,this._skin.icon_nan.active=!1,this._skin.icon_nv.active=!1,this._skin.btn_shezhi.active=!1,this._skin.lab_name.string="",this._skin.lab_state.string="",this._skin.lab_power.string=""}})},{}],435:[function(e,t,i){"use strict";game.GuildMemberPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("guild/GuildMemberSkin","GuildMemberSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildMemberItem)),this._list.show(),this.updateInfo(),b8e.evt.onC(this._skin.icon_jinggao,this.onOpenGuildStatePanel,this),b8e.evt.addG(this,game.GuildEvt.GUILD_REMOVE_GUILD_MEMBER,this.synGuildInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_CHANGE_GUILD_MEMBER_RANK,this.synGuildInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_TRANSFER_MASTER_SUCCESS,this.synGuildInfo),b8e.evt.addG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.synGuildInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.icon_jinggao,this.onOpenGuildStatePanel,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_REMOVE_GUILD_MEMBER,this.synGuildInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_CHANGE_GUILD_MEMBER_RANK,this.synGuildInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_TRANSFER_MASTER_SUCCESS,this.synGuildInfo),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.synGuildInfo)},updateInfo:function(){game.guild.isHasGuild()&&game.GuildSender.reqGuildInfo()},synGuildInfo:function(){var e=game.guild.getSelfGuildInfo();e&&(!e.memberList||e.memberList.length<=0||this._list.setData(e.memberList))},onOpenGuildStatePanel:function(){game.app.show(game.AppConstant.GUILD_STATE_DESC_PANEL)}})},{}],436:[function(e,t,i){"use strict";game.appModule.GuildPanel=game.SkinUIPanel.extends({_guildInfoPanel:null,_guildMemberPanel:null,_guildLogPanel:null,_guildListPanel:null,_curPanel:null,_index:-1,_guilfInfo:null,_list:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"guildInfoTaskItem0":return!this._guildInfoPanel||!(t=this._guildInfoPanel.getButtonByName("guildTaskItem0"))||t}return null},onShow:function(){this._index=0,this._skin.lab_tip.string="",this.updateInfo(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onOpenGuildInfoPanel,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onOpenGuildMemberPanel,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onOpenGuildLogPanel,this),b8e.evt.onC(this._skin.buttonToggle[3].node,this.onOpenGuildListPanel,this),b8e.evt.onC(this._skin.btn_create,this.onOpenCreateGuildPanel,this),b8e.evt.addG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.onJoinGuild),b8e.evt.addG(this,game.GuildEvt.GUILD_RECOMMEND_LIST,this.onUpdateRecommendLidt),b8e.evt.addG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.createGuildSuccess),b8e.evt.addG(this,game.GuildEvt.GUILD_LEAVE_GUILD_SUCCESS,this.synGuildInfo),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onHide:function(){this._index=0,this._curPanel&&this._curPanel.hide(),this._list&&this._list.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onOpenGuildInfoPanel,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onOpenGuildMemberPanel,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onOpenGuildLogPanel,this),b8e.evt.offC(this._skin.buttonToggle[3].node,this.onOpenGuildListPanel,this),b8e.evt.offC(this._skin.btn_create,this.onOpenCreateGuildPanel,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.onJoinGuild),b8e.evt.rmvG(this,game.GuildEvt.GUILD_RECOMMEND_LIST,this.onUpdateRecommendLidt),b8e.evt.rmvG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.createGuildSuccess),b8e.evt.rmvG(this,game.GuildEvt.GUILD_LEAVE_GUILD_SUCCESS,this.synGuildInfo),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},updateInfo:function(){this._index=0,this.synGuildInfo()},createGuildSuccess:function(){this.synGuildInfo()},onJoinGuild:function(){game.GuildSender.isJoinGuild&&(game.GuildSender.isJoinGuild=!1,this.synGuildInfo())},synGuildInfo:function(){this._index=0,this._skin.list.node.active=!1,this.setButtonToggleState(!1),this._skin.create_node.active=!1,this._guilfInfo=game.guild.getSelfGuildInfo(),game.guild.isHasGuild()?this.updateSelfGuildInfo():this.updateCreateGuilfInfo()},setButtonToggleState:function(e){if(this._skin.buttonToggle&&0<this._skin.buttonToggle.length)for(var t=0;t<this._skin.buttonToggle.length;t++){var i=this._skin.buttonToggle[t];i&&(i.node.active=e)}},updateCreateGuilfInfo:function(){this._list||(this._list=new b8e.List(this._skin.list,game.GuildApplyItem)),this._list.show(),this._skin.panel_node.active=!1,this._skin.list.node.active=!0,this._skin.create_node.active=!0,game.GuildSender.reqGuildRecommend(),game.app.show(game.AppConstant.GUILD_TIP_PANEL)},updateSelfGuildInfo:function(){this._skin.panel_node.active=!0,this.setButtonToggleState(!0),this._skin.buttonToggle[this._index].check(),this.onSelectPanelByIndex(this._index)},onUpdateRecommendLidt:function(){var e=game.guild.geRecommendGuildList();this._list.setData(e),e&&0<e.length?this._skin.lab_tip.string="":this._skin.lab_tip.string="未建立任何帮会"},onOpenCreateGuildPanel:function(){game.app.show(game.AppConstant.GUILD_CREATE_TIP)},onOpenGuildInfoPanel:function(e){0!=this._index&&this.onSelectPanelByIndex(0)},onOpenGuildMemberPanel:function(e){1!=this._index&&this.onSelectPanelByIndex(1)},onOpenGuildLogPanel:function(e){2!=this._index&&this.onSelectPanelByIndex(2)},onOpenGuildListPanel:function(e){3!=this._index&&this.onSelectPanelByIndex(3)},onSelectPanelByIndex:function(e){switch(this._curPanel&&this._curPanel.hide(),this._index=e,this._index){case 0:this._guildInfoPanel||(this._guildInfoPanel=new game.GuildInfoPanel,this._guildInfoPanel.addToParent(this._skin.panel_node)),this._guildInfoPanel.show(),this._curPanel=this._guildInfoPanel;break;case 1:this._guildMemberPanel||(this._guildMemberPanel=new game.GuildMemberPanel,this._guildMemberPanel.addToParent(this._skin.panel_node)),this._guildMemberPanel.show(),this._curPanel=this._guildMemberPanel;break;case 2:this._guildLogPanel||(this._guildLogPanel=new game.GuildLogPanel,this._guildLogPanel.addToParent(this._skin.panel_node)),this._guildLogPanel.show(),this._curPanel=this._guildLogPanel;break;case 3:this._guildListPanel||(this._guildListPanel=new game.GuildListPanel,this._guildListPanel.addToParent(this._skin.panel_node)),this._guildListPanel.show(),this._curPanel=this._guildListPanel}}})},{}],437:[function(e,t,i){"use strict";game.appModule.GuildSettingPanel=game.SkinUIPanel.extends({_guilfInfo:null,_isToggleAgreed:!1,_isToggleRefuse:!1,ctor:function(e){this._super(e)},onShow:function(){this.updateInfo(),b8e.evt.onC(this._skin.toggle_agreed.node,this.onOpenSender,this),b8e.evt.onC(this._skin.toggle_refuse.node,this.onCloseSender,this),b8e.evt.addG(this,game.GuildEvt.GUILD_SET_JOIN_GUILD_CONDITIONS,this.updateInfo)},onHide:function(){this.onCheckSender(),b8e.evt.offC(this._skin.toggle_agreed.node,this.onOpenSender,this),b8e.evt.offC(this._skin.toggle_refuse.node,this.onCloseSender,this),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SET_JOIN_GUILD_CONDITIONS,this.updateInfo)},updateInfo:function(){if(this._guilfInfo=game.guild.getSelfGuildInfo(),this._guilfInfo)switch(b8e.ShaderUtil.reset(this._skin.toggle_agreed.node),0<this._guilfInfo.powerLimit?this._skin.editBox.string=this._guilfInfo.powerLimit/1e4:this._skin.editBox.string=0,this._guilfInfo.state){case game.GuildState.CHECK:this._isToggleAgreed=!1,this._isToggleRefuse=!1,this._skin.toggle_agreed.interactable=!0;break;case game.GuildState.OPEN:this._skin.toggle_agreed.isChecked=!0,this._skin.toggle_agreed.interactable=!0,this._isToggleAgreed=!0,this._isToggleRefuse=!1;break;case game.GuildState.CLOSED:this._skin.toggle_agreed.isChecked=!1,this._skin.toggle_refuse.isChecked=!0,this._isToggleAgreed=!1,this._isToggleRefuse=!0,this._skin.toggle_agreed.interactable=!1}},onCheckSender:function(){if(this._guilfInfo){var e=1e4*Number(this._skin.editBox.string);this._skin.toggle_refuse.isChecked?game.GuildSender.reqSettingGuild(e,game.GuildState.CLOSED):this._skin.toggle_agreed.isChecked?game.GuildSender.reqSettingGuild(e,game.GuildState.OPEN):game.GuildSender.reqSettingGuild(e,game.GuildState.CHECK)}},onOpenSender:function(){if(this._isToggleRefuse)return this._isToggleAgreed?this._skin.toggle_agreed.isChecked=!0:this._skin.toggle_agreed.isChecked=!1,void game.notice.show("请先取消拒绝所有人入帮申请");var e=1e4*Number(this._skin.editBox.string);this._skin.toggle_agreed.isChecked?game.GuildSender.reqSettingGuild(e,game.GuildState.OPEN):game.GuildSender.reqSettingGuild(e,game.GuildState.CHECK)},onCloseSender:function(){var e=1e4*Number(this._skin.editBox.string);this._skin.toggle_refuse.isChecked?game.GuildSender.reqSettingGuild(e,game.GuildState.CLOSED):game.GuildSender.reqSettingGuild(e,game.GuildState.CHECK)}})},{}],438:[function(e,t,i){"use strict";game.GuildShaoXiangLog=game.SkinUI.extends({m_data:null,ctor:function(){this._super("guild/GuildShaoXiangLogSkin","GuildShaoXiangLogSkin")},getHeight:function(){return 50},getWidth:function(){return 300},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){if(this.m_data=e,this._skin&&e){this.clearData();var t,i=b8e.TimeUtil.formatTimestamp(e.time,"(M-D h:m)");t=game.ccfg.GuildShaoxiangCfg.getShaoxiangNameById(e.id);var n;n=game.ccfg.GuildShaoxiangCfg.getShaoxiangExpById(e.id);var s="#E7D7A7";switch(e.id){case game.GuildShaoxiangLogItemType.BAITANXIANG:s="#FFFFFF";break;case game.GuildShaoxiangLogItemType.SUHEXIANG:s="#6FB2EB";break;case game.GuildShaoxiangLogItemType.TIANMUXIANG:s="#FFC045"}this._skin.shangxiangLog.string="<color=#C5D3D5>"+i+"</c><color=#6FB2EB>"+e.name+"</c><color=#E7D7A7>点上</c><color="+s+">"+t+"</c><color=#E7D7A7>，帮会经验+"+n+"</color>"}},clearData:function(){this._skin.shangxiangLog.string=""}})},{}],439:[function(e,t,i){"use strict";game.appModule.GuildShaoXiangPanel=game.SkinUIPanel.extends({_loglist:null,_itemlist:null,ctor:function(e){this._super(e)},onShow:function(){this._loglist||(this._loglist=new b8e.List(this._skin.loglist,game.GuildShaoXiangLog)),this._loglist.show(),this._itemlist||(this._itemlist=new b8e.List(this._skin.itemlist,game.GuildShaoxiangItem)),this._itemlist.show(),game.GuildSender.reqShaoXiangLog(),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL,this.updatePanel)},onHide:function(){this._itemlist&&this._loglist.hide(),this._loglist&&this._loglist.hide(),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATESHANGXIANGPANEL,this.updatePanel)},updatePanel:function(){if(this._skin&&game.guild.getGuildModuleInfo()){var e=game.guild.getGuildShaoXiangLogs();this._loglist.setData(e.LogList);var t=game.ccfg.GuildShaoxiangCfg.getShaoxiangDatas();this._itemlist.setData(t);var i=game.guild.getSelfGuildInfo();if(i){var n=game.ccfg.GuildExpCfg.getGuildExpInfoByLevel(i.level),s=0;if(n)s=n.exp;this._skin.guildlevel.string="<color=#C5D3D5>帮会等级:</c><color=#C5D3D5>"+i.level+"级</color>",this._skin.guildexp.string="<color=#C5D3D5>帮会经验:</c><color=#C5D3D5>"+i.exp+"/"+s+"</color>"}}},clearData:function(){}})},{}],440:[function(e,t,i){"use strict";game.GuildShaoxiangItem=game.SkinUI.extends({m_data:null,ctor:function(){this._super("guild/GuildShaoxiangItemSkin","GuildShaoxiangItemSkin")},getHeight:function(){return 400},getWidth:function(){return 180},onShow:function(){this.m_data&&this.setData(this.m_data),b8e.evt.onC(this._skin.shangxiangBnt,this.shangxiangClickBack,this)},onHide:function(){b8e.evt.offC(this._skin.shangxiangBnt,this.shangxiangClickBack,this)},setData:function(e){if(this.m_data=e,this._skin&&e){this.clearData();var t=game.ccfg.ItemInfoCfg.getTypeById(e.items[0].Id),i=0,n=game.back.getAmountInfo();if(n){t==game.AmountType.SILVER?(this._skin.yinibiBg.active=!0,this._skin.goldBg.active=!1,i=n.getValue(game.AmountType.SILVER)):t==game.AmountType.YUAN_BAO&&(this._skin.yinibiBg.active=!1,this._skin.goldBg.active=!0,i=n.getValue(game.AmountType.YUAN_BAO));var s="<color=#C5D3D5>";i<e.items[0].Num&&(s="<color=#DD3333>"),this._skin.goldCost.string=s+e.items[0].Num+"</c><color=#74D610></color>",this._skin.yinbiCost.string=s+e.items[0].Num+"</c><color=#74D610></color>";var a="<color=#E7D7A7>";switch(e.id){case game.GuildShaoxiangLogItemType.BAITANXIANG:this._skin.baitanXiangBg.active=!0,a="#FFFFFF";break;case game.GuildShaoxiangLogItemType.SUHEXIANG:this._skin.suhexiang.active=!0,a="#6FB2EB";break;case game.GuildShaoxiangLogItemType.TIANMUXIANG:this._skin.tianmuxiang.active=!0,a="#FFC045"}this._skin.bangGong.string="<color=#C5D3D5>帮贡</c><color=#74D610>+"+e.contribution+"</color>",this._skin.bangExp.string="<color=#C5D3D5>帮会经验</c><color=#74D610>+"+e.exp+"</color>",this._skin.itemName.string="<color="+a+">"+e.name+"</c><color=#0fffff></color>",0<e.vip?this._skin.viptask.string="<color=#FFC045>VIP"+e.vip+"可上香</c><color=#0fffff></color>":this._skin.viptask.string="";var o=game.guild.getGuildModuleInfo();o&&(o.shaoxiangDone?(this._skin.shangxiangBnt_0.active=!0,this._skin.btnName.string="<color=#C5D3D5>已上香</c><color=#0fffff ></color>"):(this._skin.btnName.string="<color=#C5D3D5>上香</c><color=#0fffff ></color>",0<e.vip?this._skin.shangxiangBnt_2.active=!0:this._skin.shangxiangBnt_1.active=!0))}}},shangxiangClickBack:function(){this.m_data&&game.guild.onShangXiang(this.m_data)},clearData:function(){this._skin.baitanXiangBg.active=!1,this._skin.suhexiang.active=!1,this._skin.tianmuxiang.active=!1,this._skin.shangxiangBnt_0.active=!1,this._skin.shangxiangBnt_1.active=!1,this._skin.shangxiangBnt_2.active=!1}})},{}],441:[function(e,t,i){"use strict";game.appModule.GuildStateDescPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){},onHide:function(){}})},{}],442:[function(e,t,i){"use strict";game.GuildTaskItem=game.SkinUI.extends({_guildActivityInfo:null,_bgSprite:null,_titleSprite:null,_nanTianMenSceneId:0,_lingXiaoDianSceneId:0,_csNanTianMenSceneId:0,_csLingXiaoDianSceneId:0,ctor:function(){this._super("guild/GuildTaskItemSkin","GuildTaskItemSkin")},getHeight:function(){return 125},getWidth:function(){return 261},onShow:function(){this._bgSprite||(this._bgSprite=b8e.Sprite.get(),this._bgSprite.setAnchor(.5,.5),this._bgSprite.addToParent(this._skin.img_bg)),this._titleSprite||(this._titleSprite=b8e.Sprite.get(),this._titleSprite.addToParent(this._skin.img_title)),this.setData(this._guildActivityInfo),b8e.evt.onC(this,this.onClick,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange()},onHide:function(){this._bgSprite.unloadTexture(),this._titleSprite.unloadTexture(),b8e.evt.offC(this,this.onClick,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onSpotAlertChange:function(){if(game.guild.getGuildModuleInfo())switch(this._guildActivityInfo.id){case game.GuildActiveType.GUILD_TASK:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.DAILY_TASK);break;case game.GuildActiveType.GUILD_WAR:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.TIAN_GONG_WORSHIPALERT);break;case game.GuildActiveType.CS_WAR:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CS_TIAN_GONG_WORSHIPALERT);break;case game.GuildActiveType.GUILD_SHAO_XIANG:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_SHAOXIAO);break;case game.GuildActiveType.CHECK_XIN_FA:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_XINFA);break;case game.GuildActiveType.GUILD_BOSS:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_GUILDBOSS);break;case game.GuildActiveType.GUILD_CHUAN_GONG:this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.GUILD_EXP_CURE)}},setData:function(e){if(this._guildActivityInfo=e,this._skin&&(this.clearData(),this._guildActivityInfo)){this._guildActivityInfo=e;var t=game.ClientCfg.getImgUrl(this._guildActivityInfo.title);this._titleSprite.loadTexture(t,null,null,{useManifest:!1});var i=game.ClientCfg.getImgUrl(this._guildActivityInfo.bg),n=game.guild.getSelfGuildInfo();if(n)if(n.level>=this._guildActivityInfo.guildLvLimit)this._skin.img_noOpen.active=!1,i=game.ClientCfg.getImgUrl(this._guildActivityInfo.bg);else game.mainRole.mainRoleData.getLv()>=this._guildActivityInfo.roleLvLimit?(this._skin.img_noOpen.active=!1,i=game.ClientCfg.getImgUrl(this._guildActivityInfo.bg)):(this._skin.img_noOpen.active=!0,i=game.ClientCfg.getImgUrl(this._guildActivityInfo.grayBg));this._bgSprite.loadTexture(i,null,null,{useManifest:!1})}},clearData:function(){this._skin.img_noOpen.active=!1},onClick:function(e){var t=game.SceneMgr.inst().sceneId;switch(0==this._nanTianMenSceneId&&(this._nanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NAN_TIAN_MEN_SCENE_ID)),0==this._lingXiaoDianSceneId&&(this._lingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_LING_XIAO_DIAN_SCENE_ID)),0==this._csNanTianMenSceneId&&(this._csNanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID)),0==this._csLingXiaoDianSceneId&&(this._csLingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID)),this._guildActivityInfo.id){case game.GuildActiveType.GUILD_TASK:game.TriggerMgr.inst().customTriggerById(3141),game.app.isShow(game.AppConstant.GUILD_PANEL)&&game.app.hide(game.AppConstant.GUILD_PANEL);break;case game.GuildActiveType.GUILD_WAR:if(game.tianGong.isCrossServer&&(t==this._nanTianMenSceneId||t==this._lingXiaoDianSceneId))return void game.notice.show(11051);game.tianGong.isLoging=!1,game.app.show(game.AppConstant.TIAN_GONG_PANEL,!1);break;case game.GuildActiveType.CS_WAR:if(!game.tianGong.isOpenServerThirdWeek())return void game.notice.show(11053);if(game.shield.isShield(game.ShieldEnum.SAN_JIE))return void game.notice.show(11054);if(!game.tianGong.isCrossServer&&(t==this._csNanTianMenSceneId||t==this._csLingXiaoDianSceneId))return void game.notice.show(11052);game.tianGong.isLoging=!1,game.TianGongSender.reqTianGongInfo(!0);break;case game.GuildActiveType.GUILD_SHAO_XIANG:game.app.show(game.AppConstant.GUILD_SHAOXIANG_PANEL);break;case game.GuildActiveType.CHECK_XIN_FA:game.app.show(game.AppConstant.GUILD_XINFA_PANEL);break;case game.GuildActiveType.GUILD_BOSS:game.guild.onRqGuildBossInfo();break;case game.GuildActiveType.GUILD_CHUAN_GONG:game.funcOpen.checkOpenWithTips(game.FunctionType.GUILD_EXP_CURE)&&(game.app.show(game.AppConstant.GUILD_EXP_CURE_PANEL),game.guild.isClickGuildExpCure=!0)}}})},{}],443:[function(e,t,i){"use strict";game.appModule.GuildTipPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.btn_ok,this.onOpenPanel,this),b8e.evt.onC(this._skin.btn_ok_txt,this.onOpenPanel,this)},onHide:function(){b8e.evt.offC(this._skin.btn_ok,this.onOpenPanel,this),b8e.evt.offC(this._skin.btn_ok_txt,this.onOpenPanel,this)},onOpenPanel:function(){this.hide()}})},{}],444:[function(e,t,i){"use strict";game.GuildXinFaItem=game.SkinUI.extends({m_data:null,m_xinfaIcon:null,ctor:function(){this._super("guild/GuildXinFaItemSkin","GuildXinFaItemSkin")},getHeight:function(){return 86},getWidth:function(){return 188},onShow:function(){this.m_data&&this.setData(this.m_data),b8e.evt.onC(this._skin.btnNode,this.btnClickBack,this)},onHide:function(){b8e.evt.offC(this._skin.btnNode,this.btnClickBack,this)},setData:function(e){var t;if((this.m_data=e,this._skin)&&(t=game.ccfg.GuildXinfaCfg.getXinFaDataByType(e.xinfaType,e.level))){this._skin.xinfaName.string=t.name,this._skin.xinfaLv.string="Lv."+e.level,this.m_xinfaIcon||(this.m_xinfaIcon=b8e.Sprite.get(),this.m_xinfaIcon.setAnchor(.5,.5),this.m_xinfaIcon.addToParent(this._skin.xinfaIcon)),this.m_xinfaIcon.loadTexture(game.ClientCfg.getXinFaIcon(e.xinfaType),null,null,{useManifest:!1});var i=game.guild.getGuildModuleInfo();if(i)i.getNowXinfaType()==this.m_data.xinfaType?(this._skin.bgNode.active=!1,this._skin.checkNode.active=!0):(this._skin.bgNode.active=!0,this._skin.checkNode.active=!1),this.updateRedIcon()}},updateRedIcon:function(){var e=game.guild.getSelfGuildInfo(),t=game.back.getAmountInfo().getValue(game.AmountType.CONTRIBUTION),i=game.ccfg.GuildXinfaCfg.getXinFaMaxLevleByType(this.m_data.xinfaType);if(this.m_data.level==i)this._skin.red_Icon.active=!1;else{var n=this.m_data.level+1,s=game.ccfg.GuildXinfaCfg.getXinFaDataByType(this.m_data.xinfaType,n);if(!s)return;e.level>=s.guildLevel&&t>=s.costContribution?this._skin.red_Icon.active=!0:this._skin.red_Icon.active=!1}},btnClickBack:function(){if(this.m_data){var e=game.guild.getGuildModuleInfo();if(e)e.getNowXinfaType()!=this.m_data.xinfaType&&(game.guild.setNowShowXinFaType(this.m_data.xinfaType),b8e.evt.dptG(game.GuildEvt.GUILD_UPDATEXINFADESC,this.m_data))}},clearData:function(){}})},{}],445:[function(e,t,i){"use strict";game.appModule.GuildXinFaPanel=game.SkinUIPanel.extends({_list:null,m_data:null,m_xinfaIcon:null,m_xinfaBg:null,isxiulian:!1,_effect:null,_anim:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.itemlist,game.GuildXinFaItem)),this._list.show(),this.updatePanel(),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATEXINFAPANEL,this.updatePanel),b8e.evt.addG(this,game.GuildEvt.GUILD_UPDATEXINFADESC,this.updateXinfaDesc),b8e.evt.onC(this._skin.xianlianBtn,this.btnClickBack,this),b8e.evt.addG(this,game.GuildEvt.GUILD_UPGRADE_EFFCT_SHOW,this.playEffect)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATEXINFAPANEL,this.updatePanel),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPDATEXINFADESC,this.updateXinfaDesc),b8e.evt.rmvG(this,game.GuildEvt.GUILD_UPGRADE_EFFCT_SHOW,this.playEffect),b8e.evt.offC(this._skin.xianlianBtn,this.btnClickBack,this),this._anim&&this._anim.clear()},updatePanel:function(){if(this._skin){var e=game.guild.getGuildModuleInfo();if(e){var t=e.getXinFaList();if(t&&0!=t.length){this._list.setData(t);var i=game.guild.getSelfGuildInfo();if(i){this._skin.guildLevel.string="<color=#E7D7A7>帮会等级:</c><color=#E7D7A7>"+i.level+"级</color>";var n=game.back.getAmountInfo().getValue(game.AmountType.CONTRIBUTION);this._skin.guildGold.string="<color=#E7D7A7>当前帮贡:</c><color=#E7D7A7>"+n+"</color>";var s=e.getXinFaAtk();if(this._skin.atkLabel.string=s,this.m_data){var a=e.getXinFaByType(this.m_data.xinfaType);a&&(this.m_data.level=a.level)}else this.m_data=t[0];var o=game.ccfg.GuildXinfaCfg.getXinFaDataByType(this.m_data.xinfaType,this.m_data.level);o&&(this._skin.xinfaName.string=o.name,this._skin.xinfaLevel.string="Lv."+this.m_data.level,this.m_xinfaIcon||(this.m_xinfaIcon=b8e.Sprite.get(),this.m_xinfaIcon.setAnchor(.5,.5),this.m_xinfaIcon.addToParent(this._skin.xinfaIcon)),this.m_xinfaIcon.loadTexture(game.ClientCfg.getXinFaIcon(this.m_data.xinfaType),null,null,{useManifest:!1}),this.m_xinfaBg||(this.m_xinfaBg=b8e.Sprite.get(),this.m_xinfaBg.setAnchor(.5,.5),this.m_xinfaBg.addToParent(this._skin.bgNode),this.m_xinfaBg.loadTexture("images/image/xinfaIcon/xinfaBg.jpg",null,null,{useManifest:!1})),this.updateDescPanel())}}}}},updateDescPanel:function(){var e=game.guild.getSelfGuildInfo(),t=game.back.getAmountInfo().getValue(game.AmountType.CONTRIBUTION),i=game.ccfg.GuildXinfaCfg.getXinFaDataByType(this.m_data.xinfaType,this.m_data.level);if(i){0==this.m_data.level?this._skin.nowbeiDongDesc.string="未激活":this._skin.nowbeiDongDesc.string=i.desc;var n=game.ccfg.GuildXinfaCfg.getXinFaMaxLevleByType(this.m_data.xinfaType);if(this.m_data.level==n)this._skin.nextShuxingNode.active=!1,this._skin.maxBeiDongDesc.node.active=!0;else{var s=this.m_data.level+1,a=game.ccfg.GuildXinfaCfg.getXinFaDataByType(this.m_data.xinfaType,s);if(!a)return;this._skin.nextBeiDongDesc.string=a.desc,this._skin.nextShuxingNode.active=!0,this._skin.maxBeiDongDesc.node.active=!1,e.level>=a.guildLevel?this._skin.guildNeedLevel.string="<color=#E7D7A7>需要帮会等级:</c><color=#74D610>"+a.guildLevel+"级</color>":this._skin.guildNeedLevel.string="<color=#E7D7A7>需要帮会等级:</c><color=#DD3333>"+a.guildLevel+"级</color>",t>=a.costContribution?this._skin.guidlNeedexp.string="<color=#E7D7A7>需要消耗帮贡:</c><color=#74D610>"+a.costContribution+"</color>":this._skin.guidlNeedexp.string="<color=#E7D7A7>需要消耗帮贡:</c><color=#DD3333>"+a.costContribution+"</color>",e.level>=a.guildLevel&&t>=a.costContribution?this.isxiulian=!0:this.isxiulian=!1}}},updateXinfaDesc:function(e){var t=null;e&&(t=e.data),this.m_data=t,this.updatePanel()},btnClickBack:function(){this.m_data&&(this.isxiulian?game.guild.onreqXinfa(this.m_data.xinfaType):game.notice.show("未满足修炼条件"))},playEffect:function(){var e=game.ClientCfg.getUIFxs("10028");this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.GUILD_UPGRADE_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._effect.setVisible(!1)},clearData:function(){}})},{}],446:[function(e,t,i){"use strict";game.TianGongGuildRewardItem=game.SkinUI.extends({_prizeList1:null,_prizeInfo1:null,_prizeList2:null,_prizeInfo2:null,_prizeList3:null,_prizeInfo3:null,ctor:function(){this._super("tiangong/TianGongGuildRewardItemSkin","TianGongGuildRewardItemSkin")},getHeight:function(){return 150},getWidth:function(){return 540},init:function(){this._prizeList1=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,2),this._prizeList1.addToParent(this._skin.master),this._prizeInfo1=new game.PrizeInfo,this._prizeList2=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,2),this._prizeList2.addToParent(this._skin.elder),this._prizeInfo2=new game.PrizeInfo,this._prizeList3=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,2),this._prizeList3.addToParent(this._skin.member),this._prizeInfo3=new game.PrizeInfo},onShow:function(){this.setData(this.data)},onHide:function(){},setData:function(e){var t;e&&(this.data=e,this._skin&&(t=game.tianGong.isCrossServer?game.ccfg.CSTianGongGuildAwardCfg.getDataById(this.data):game.ccfg.TianGongGuildAwardCfg.getDataById(this.data),this._prizeInfo1.setupById(t.dropId0),this._prizeList1.setData(this._prizeInfo1),this._prizeInfo2.setupById(t.dropId1),this._prizeList2.setData(this._prizeInfo2),this._prizeInfo3.setupById(t.dropId2),this._prizeList3.setData(this._prizeInfo3),0==Number(this.data)?game.tianGong.isCrossServer?this._skin.title.string=game.ccfg.LangCfg.getText(11042):this._skin.title.string=game.ccfg.LangCfg.getText(11041):this._skin.title.string="积分第"+Number(this.data)+"帮会",game.tianGong.isCrossServer?this._skin.lab_member.string=game.ccfg.LangCfg.getText(11044):this._skin.lab_member.string=game.ccfg.LangCfg.getText(11043)))}})},{}],447:[function(e,t,i){"use strict";game.TianGongGuildRewardPanel=game.SkinUI.extends({_list:null,_victoryReward:null,ctor:function(){this._super("tiangong/TianGongGuildRewardSkin","TianGongGuildRewardSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.TianGongGuildRewardItem)},onShow:function(){var e;if(this._list.show(),game.tianGong.isCrossServer?(e=game.ccfg.CSTianGongGuildAwardCfg.getList(),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(11040)):(e=game.ccfg.TianGongGuildAwardCfg.getList(),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(11039)),e&&!(e.length<=0)){var t=e.indexOf("0");-1!=t&&e.splice(t,1),this._list.setData(e),this._victoryReward||(this._victoryReward=new game.TianGongGuildRewardItem,this._victoryReward.addToParent(this._skin.victory_reward)),this._victoryReward.setData("0"),this._victoryReward.show()}},onHide:function(){this._list&&this._list.hide(),this._victoryReward&&this._victoryReward.hide()},onSort:function(e,t){return e-t}})},{}],448:[function(e,t,i){"use strict";game.TianGongPersonalRewardItem=game.SkinUI.extends({awardInfo:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("tiangong/TianGongPersonalRewardItemSkin","TianGongPersonalRewardItemSkin")},getHeight:function(){return 120},getWidth:function(){return 540},init:function(){this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize),this._prizeInfo=new game.PrizeInfo},onShow:function(){this.setData(this.data)},onHide:function(){},setData:function(e){var t,i;e&&(this.data=e,this._skin&&(game.tianGong.isCrossServer?(t=game.ccfg.CSTianGongPlayerAwardCfg.getDataById(this.data),i=game.ccfg.CSTianGongPlayerAwardCfg.getNextScore(this.data)):(t=game.ccfg.TianGongPlayerAwardCfg.getDataById(this.data),i=game.ccfg.TianGongPlayerAwardCfg.getNextScore(this.data)),this._prizeInfo.setupById(t.dropId),this._prizeList.setData(this._prizeInfo),this._skin.title.string=i?t.score+"-"+i+"积分":t.score+"积分以上"))}})},{}],449:[function(e,t,i){"use strict";game.TianGongPersonalRewardPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("tiangong/TianGongPersonalRewardSkin","TianGongPersonalRewardSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.TianGongPersonalRewardItem)},onShow:function(){var e;this._list.show(),!(e=game.tianGong.isCrossServer?game.ccfg.CSTianGongPlayerAwardCfg.getList():game.ccfg.TianGongPlayerAwardCfg.getList())||e.length<=0||this._list.setData(e)},onHide:function(){this._list&&this._list.hide()}})},{}],450:[function(e,t,i){"use strict";game.appModule.TianGongRuleDescPanel=game.SkinUIPanel.extends({_tianGongRulePanel:null,_tianGongGuildRewardPanel:null,_tianGongPersonalRewardPanel:null,_index:-1,ctor:function(e){this._super(e)},init:function(){this._tianGongRulePanel=new game.TianGongRulePanel,this._tianGongRulePanel.addToParent(this._skin.page),this._tianGongGuildRewardPanel=new game.TianGongGuildRewardPanel,this._tianGongGuildRewardPanel.addToParent(this._skin.page),this._tianGongPersonalRewardPanel=new game.TianGongPersonalRewardPanel,this._tianGongPersonalRewardPanel.addToParent(this._skin.page)},onShow:function(){b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickRuleBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickGuildRewardBtn,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickPersonalRewardBtn,this),this.data&&(this._index=this.data),-1==this._index&&(this._index=0),game.tianGong.isCrossServer?this._skin.lab2.string=game.ccfg.LangCfg.getText(11046):this._skin.lab2.string=game.ccfg.LangCfg.getText(11045),this.onSelectPanelByIndex(this._index)},onHide:function(){this.hidePanel(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickRuleBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickGuildRewardBtn,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickPersonalRewardBtn,this)},onClickRuleBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickGuildRewardBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onClickPersonalRewardBtn:function(){2!=this._index&&this.onSelectPanelByIndex(2)},onClickNationalBossBtn:function(){3!=this._index&&this.onSelectPanelByIndex(3)},hidePanel:function(){this._tianGongRulePanel.hide(),this._tianGongGuildRewardPanel.hide(),this._tianGongPersonalRewardPanel.hide(),this._index=-1},onSelectPanelByIndex:function(e){switch(this.hidePanel(),this._index=e){case 0:this._skin.buttonToggle[0].check(),this._skin.title.string="规则说明",this._tianGongRulePanel.show();break;case 1:this._skin.buttonToggle[1].check(),this._skin.title.string="规则说明",this._tianGongGuildRewardPanel.show();break;case 2:this._skin.buttonToggle[2].check(),this._skin.title.string="规则说明",this._tianGongPersonalRewardPanel.show()}}})},{}],451:[function(e,t,i){"use strict";game.TianGongRulePanel=game.SkinUI.extends({ctor:function(){this._super("tiangong/TianGongRuleSkin","TianGongRuleSkin")},onShow:function(){this._skin.desc.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11036:11e3)},onHide:function(){}})},{}],452:[function(e,t,i){"use strict";e("./GuildAdministerItem"),e("./GuildApplyItem"),e("./GuildListItem"),e("./GuildLogItem"),e("./GuildMemberItem"),e("./GuildTaskItem"),e("./GuildInfoPanel"),e("./GuildListPanel"),e("./GuildLogPanel"),e("./GuildMemberPanel"),e("./GuildAdministerPanel"),e("./GuildCreateTip"),e("./GuildPanel"),e("./GuildEditNoticePanel"),e("./GuildSettingPanel"),e("./GuildStateDescPanel"),e("./GuildXinFaItem"),e("./GuildXinFaPanel"),e("./GuildShaoxiangItem"),e("./GuildShaoXiangLog"),e("./GuildShaoXiangPanel"),e("./GuildTipPanel")},{"./GuildAdministerItem":421,"./GuildAdministerPanel":422,"./GuildApplyItem":423,"./GuildCreateTip":424,"./GuildEditNoticePanel":425,"./GuildInfoPanel":428,"./GuildListItem":430,"./GuildListPanel":431,"./GuildLogItem":432,"./GuildLogPanel":433,"./GuildMemberItem":434,"./GuildMemberPanel":435,"./GuildPanel":436,"./GuildSettingPanel":437,"./GuildShaoXiangLog":438,"./GuildShaoXiangPanel":439,"./GuildShaoxiangItem":440,"./GuildStateDescPanel":441,"./GuildTaskItem":442,"./GuildTipPanel":443,"./GuildXinFaItem":444,"./GuildXinFaPanel":445}],453:[function(e,t,i){"use strict";var n=game.GuildSender=function(){};n.reqCreateGuild=function(e){var t=b8e.ProtobufUtil.createMessage(game.pbmsg.GuildCreateRequest);t.name=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildCreateRequest;b8e.sendN(i)},n.reqGuildInfo=function(){var e=game.pbmid.Guild.GuildInfoRequest;b8e.sendN(e)},n.reqGuildJoin=function(e){var t=game.pbmsg.GuildJoinRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildJoinRequest;b8e.sendN(i)},n.reqLeaveGuild=function(){var e=game.pbmid.Guild.GuildLeaveRequest;b8e.sendN(e)},n.reqKickGuildMember=function(e){var t=game.pbmsg.GuildKickMemberRequest;t.memberId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildKickMemberRequest;b8e.sendN(i)},n.reqChangeGuildRank=function(e,t){var i=game.pbmsg.GuildChangeRankRequest;i.memberId=e,i.rank=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Guild.GuildChangeRankRequest;b8e.sendN(n)},n.reqSetGuildNotice=function(e){var t=game.pbmsg.GuildSetNoticeRequest;t.notice=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildSetNoticeRequest;b8e.sendN(i)},n.reqGuildReqList=function(){var e=game.pbmid.Guild.GuildReqListRequest;b8e.sendN(e)},n.reqHandleGuild=function(e,t){var i=game.pbmsg.GuildHandleReqRequest;i.playerId=e,i.type=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Guild.GuildHandleReqRequest;b8e.sendN(n)},n.reqTransGuildMaster=function(e){var t=game.pbmsg.GuildTransferMasterRequest;t.memberId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildTransferMasterRequest;b8e.sendN(i)},n.reqGuildLog=function(){var e=game.pbmid.Guild.GuildLogRequest;b8e.sendN(e)},n.reqSettingGuild=function(e,t){var i=game.pbmsg.GuildSettingRequest;i.power=e,i.state=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Guild.GuildSettingRequest;b8e.sendN(n)},n.reqGuildRecommend=function(){var e=game.pbmid.Guild.GuildRecommendRequest;b8e.sendN(e)},n.reqGuildRank=function(){var e=game.pbmid.Guild.GuildRankRequest;b8e.sendN(e)},n.reqGuildQuest=function(){var e=game.pbmid.Guild.GuildQuestRequest;b8e.sendN(e)},n.reqFinishGuildQuest=function(e){var t=game.pbmsg.GuildQuestFinishRequest;t.id=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildQuestFinishRequest;b8e.sendN(i)},n.reqGetGuildQuestAward=function(e){var t=game.pbmsg.GuildQuestAwardRequest;t.id=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildQuestAwardRequest;b8e.sendN(i)},n.reqGuildDisband=function(){var e=game.pbmid.Guild.GuildDisbandRequest;b8e.sendN(e)},n.reqGuildModule=function(){var e=game.pbmid.Guild.GuildModuleRequest;b8e.sendN(e)},n.reqShaoXiang=function(e){var t=game.pbmsg.GuildShaoxiangRequest;t.id=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildShaoxiangRequest;b8e.sendN(i)},n.reqShaoXiangLog=function(){var e=game.pbmid.Guild.GuildShaoxiangLogRequest;b8e.sendN(e)},n.reqXianFa=function(e){var t=game.pbmsg.GuildXinfaRequest;t.xinfaType=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildXinfaRequest;b8e.sendN(i)},n.rqGuildBossList=function(){var e=game.pbmid.Guild.GuildBossListRequest;b8e.sendN(e)},n.rqEnterGuildBossScene=function(e){var t=game.pbmsg.EnterGuildBossSceneRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.EnterGuildBossSceneRequest;b8e.sendN(i)},n.reqGuildExpCure=function(e){var t=game.pbmsg.GuildExpCureConfirmRequest;t.roleId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildExpCureConfirmRequest;b8e.sendN(i)},n.reqInviteGuildExpCure=function(e){var t=game.pbmsg.GuildExpCureInviteRequest;t.roleId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Guild.GuildExpCureInviteRequest;b8e.sendN(i)},n.reqGuildExpCureComplete=function(){var e=game.pbmid.Guild.GuildExpCureAwardRequest;b8e.sendN(e)}},{}],454:[function(e,t,i){"use strict";e("./GuildSender")},{"./GuildSender":453}],455:[function(e,t,i){"use strict";game.appModule.Jd618GiftBagPanel=game.SkinUIPanel.extends({_bgImg:null,_prizeList:null,ctor:function(e){this._super(e)},init:function(){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this._prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.JD_PRIZE);e.setupById(t),this._prizeList.setData(e)},onShow:function(){this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.setAnchor(.5,.5),this._bgImg.addToParent(this._skin.bgImg)),this._bgImg.loadTexture(game.ClientCfg.jdImgUrl,null,null,{useManifest:!1}),this.onUpdatePanel(),b8e.evt.onC(this._skin.btnGet,this.clickBtn,this),b8e.evt.addG(this,game.WelfareEvents.COLLECT_JD_AWARD,this.onUpdatePanel)},onHide:function(){b8e.evt.offC(this._skin.btnGet,this.clickBtn,this),b8e.evt.rmvG(this,game.WelfareEvents.COLLECT_JD_AWARD,this.onUpdatePanel)},onRefresh:function(){this.onUpdatePanel()},onUpdatePanel:function(){this._skin.btnGet.active=!game.welfare.isCollectedJDPrize,this._skin.isGetPrize.active=game.welfare.isCollectedJDPrize},clickBtn:function(){game.WelfareSender.sendJDAwardRequest()}})},{}],456:[function(e,t,i){"use strict";e("./Jd618GiftBagPanel")},{"./Jd618GiftBagPanel":455}],457:[function(e,t,i){"use strict";e("./manager/managerIndex_5"),e("./panel/panelIndex_7")},{"./manager/managerIndex_5":459,"./panel/panelIndex_7":461}],458:[function(e,t,i){"use strict";game.LeaveDungeonMgr=b8e.Object.extends({leaveTime:0,type:game.SceneType.DUNGEON,show:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.SceneType.DUNGEON;switch(this.leaveTime=e,this.type=t){case game.SceneType.DUNGEON:case game.SceneType.DUJIEBOSS:case game.SceneType.TOWER:case game.SceneType.TIANGONG:case game.SceneType.TEAM_BOSS:this.showAutoLeaveTime();break;case game.SceneType.WORLDBOSS:case game.SceneType.NATIONALBOSS:case game.SceneType.MAIN_QUEST_DUNGEON:}},showAutoLeaveTime:function(){switch(0==this.leaveTime&&(this.leaveTime=game.SysTime.curTime+108e4),this.type){case game.SceneType.TIANGONG:break;default:var e=this.leaveTime-game.SysTime.curTime;b8e.Tween.kill(this),b8e.Tween.get(this).wait(e).call(this.onLeave)}},onLeave:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch(b8e.Tween.kill(this),this.type){case game.SceneType.DUNGEON:game.SceneSender.leaveAloneDungeon(),game.DungeonResultMgr.inst().clearResult();break;case game.SceneType.WORLDBOSS:if(e)(t=new game.GameAlertInfo).alertType=game.GameAlertType.TwoBtn,game.worldBoss.isCsWorldBoss?t.string="退出"+game.html.getText(game.html.Q_RED,"帮会BOSS地图")+"\n是否退出？":t.string="退出"+game.html.getText(game.html.Q_RED,"世界BOSS地图")+"\n是否退出？",t.obj=null,t.isShowTips=!1,t.confirmString="取消",t.cancelString="退出",game.gameAlert.showAlert(this,this.onClick,t);else game.worldBoss.onLeaveScene();break;case game.SceneType.NATIONALBOSS:if(e)(t=new game.GameAlertInfo).alertType=game.GameAlertType.TwoBtn,t.string=game.ccfg.LangCfg.getText(1037),t.obj=null,t.isShowTips=!1,t.confirmString="取消",t.cancelString="退出",game.gameAlert.showAlert(this,this.onClick,t);else game.nationalBoss.onLeaveScene();break;case game.SceneType.MAIN_QUEST_DUNGEON:game.SceneSender.leaveAloneDungeon();break;case game.SceneType.DUJIEBOSS:case game.SceneType.TOWER:e?(game.SceneSender.leaveAloneDungeon(),game.DungeonResultMgr.inst().clearResult()):(game.TrusteeshipMgr.inst().stop(),game.DungeonResultMgr.inst().showResult(!1));break;case game.SceneType.TIANGONG:game.tianGong.leave();break;case game.SceneType.TEAM_BOSS:var t;if(e)(t=new game.GameAlertInfo).alertType=game.GameAlertType.TwoBtn,t.string=game.ccfg.LangCfg.getText(27004),t.obj=null,t.isShowTips=!1,t.confirmString="取消",t.cancelString="退出",game.gameAlert.showAlert(this,this.onClick,t);else game.DungeonResultMgr.inst().showResult(!1),game.team.setShowFriendPanel(!1),game.TrusteeshipMgr.inst().stop(),game.SceneSender.leaveAloneDungeon()}game.quest.isAuto=!1},onKillTween:function(){b8e.Tween.kill(this)},onClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CANCEL:switch(this.type){case game.SceneType.WORLDBOSS:game.worldBoss.onLeaveScene();break;case game.SceneType.NATIONALBOSS:game.nationalBoss.onLeaveScene();break;case game.SceneType.TEAM_BOSS:game.SceneSender.leaveAloneDungeon(),game.TeamSender.rqTeamLeave(),game.DungeonResultMgr.inst().clearResult(),game.team.setShowFriendPanel(!1),game.app.isShow(game.AppConstant.RELIVE_PANEL)&&game.app.hide(game.AppConstant.RELIVE_PANEL)}break;case game.GameAlertBtnType.CONFIRM:case game.GameAlertBtnType.CLOSE:}}}),game.LeaveDungeonMgr._instance=null,game.LeaveDungeonMgr.inst=function(){return game.LeaveDungeonMgr._instance||(game.LeaveDungeonMgr._instance=new game.LeaveDungeonMgr),game.LeaveDungeonMgr._instance}},{}],459:[function(e,t,i){"use strict";e("./LeaveDungeonMgr")},{"./LeaveDungeonMgr":458}],460:[function(e,t,i){"use strict";game.LeaveDungeonPanel=game.SkinUI.extends({_timer:null,_type:game.SceneType.DUNGEON,ctor:function(){this._super("dungeon/LeaveDungeonSkin","LeaveDungeonSkin"),this._showList=[]},onShow:function(){switch(this.onResize(),this._type=game.leaveDungeon.type,this._type){case game.SceneType.DUNGEON:case game.SceneType.DUJIEBOSS:case game.SceneType.TOWER:case game.SceneType.TIANGONG:case game.SceneType.TEAM_BOSS:this.showTimer();break;case game.SceneType.WORLDBOSS:case game.SceneType.NATIONALBOSS:case game.SceneType.MAIN_QUEST_DUNGEON:this._skin.time.node.active=!1,this._skin.bg.node.active=!1}b8e.evt.onC(this._skin.leave,this.onLeave,this)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.leave,this.onLeave,this)},showTimer:function(){this._skin.time.node.active=!0,this._skin.bg.node.active=!0,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500)},updateTime:function(){var e=game.leaveDungeon.leaveTime-game.SysTime.curTime;0<=e?this._skin.time.string=b8e.TimeUtil.formatTime(e):this._timer&&this._timer.stop()},onLeave:function(){switch(this._type=game.leaveDungeon.type,this._type){case game.SceneType.WORLDBOSS:case game.SceneType.DUJIEBOSS:case game.SceneType.TOWER:case game.SceneType.NATIONALBOSS:case game.SceneType.TEAM_BOSS:game.leaveDungeon.onLeave(!0);break;case game.SceneType.MAIN_QUEST_DUNGEON:game.quest.changeAuto(!1),game.leaveDungeon.onLeave();break;default:game.leaveDungeon.onLeave()}},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=10+e,this.y=200+t)}})},{}],461:[function(e,t,i){"use strict";e("./LeaveDungeonPanel")},{"./LeaveDungeonPanel":460}],462:[function(e,t,i){"use strict";game.LoginCmdListener=game.BaseBean.extends({start:function(){}})},{}],463:[function(e,t,i){"use strict";game.LoneyDungeonCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Instance.InstanceInfoResponse,this.onInstanceInfoResponse,this),b8e.addNH(game.pbmid.Instance.EnterMainInsResponse,this.onEnterMainInsResponse,this),b8e.addNH(game.pbmid.Instance.UnlockInstanceNotify,this.onUnlockInstanceNotify,this),b8e.addNH(game.pbmid.Instance.FinishQuestInstanceNotify,this.onFinishQuestInstanceNotify,this),b8e.addNH(game.pbmid.Instance.FinishMainInstanceNotify,this.onFinishMainInstanceNotify,this),b8e.addNH(game.pbmid.Instance.QuickChallengeResponse,this.onQuickChallengeResponse,this),b8e.addNH(game.pbmid.Instance.BuyInsNumResponse,this.onBuyInsNumResponse,this),b8e.addNH(game.pbmid.Instance.FinishDuJieInstanceNotify,this.onFinishDuJieInstanceNotify,this)},onInstanceInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.InstanceInfoResponse);t&&game.loneyDungeon.setupDungeonInfo(t)},onEnterMainInsResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterMainInsResponse);t&&0==t.code?(b8e.log("进入副本成功"),game.loneyDungeon.enterDungeonComplete(t)):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))},onUnlockInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.UnlockInstanceNotify);t&&game.loneyDungeon.unLockDungeon(t)},onFinishQuestInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.FinishQuestInstanceNotify);t&&game.loneyDungeon.onFinishQuestInstaceDungeon(t)},onFinishMainInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.FinishMainInstanceNotify);t&&game.loneyDungeon.onFinishDungeon(t)},onQuickChallengeResponse:function(e){var t=e.readProtobuf(game.pbmsg.QuickChallengeResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.loneyDungeon.onSaoDangDungeon(t)}},onBuyInsNumResponse:function(e){var t=e.readProtobuf(game.pbmsg.BuyInsNumResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.loneyDungeon.onFinishBuyInsNum(t)},onFinishDuJieInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.FinishDuJieInstanceNotify),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.dujie.onFinishDuJieInstance(t)}})},{}],464:[function(e,t,i){"use strict";e("./LoneyDungeonCmd")},{"./LoneyDungeonCmd":463}],465:[function(e,t,i){"use strict";game.LoneyDungeonEvent=b8e.Enum({CUR_SELECT_PAGE_CHANGE:b8e.Event.nextCode(),UPDATE_CUR_SELECT_PAGE:b8e.Event.nextCode(),UPDATE_FIGHT_TIMES:b8e.Event.nextCode()})},{}],466:[function(e,t,i){"use strict";e("./LoneyDungeonEvent")},{"./LoneyDungeonEvent":465}],467:[function(e,t,i){"use strict";e("./cmd/cmdIndex_0"),e("./event/eventIndex_4"),e("./manager/managerIndex_6"),e("./panel/panelIndex_9"),e("./sender/senderIndex_3")},{"./cmd/cmdIndex_0":464,"./event/eventIndex_4":466,"./manager/managerIndex_6":469,"./panel/panelIndex_9":473,"./sender/senderIndex_3":475}],468:[function(e,t,i){"use strict";game.LoneyDungeonMgr=b8e.Object.extends({isInit:!1,selectIndex:0,maxFightCount:0,fightCount:0,pay_maxnum:0,free_maxnum:0,buyCount:0,dungeonInfos:null,unLockGroup:null,unLockId:0,finishDungeonId:0,recoverInterval:0,_nextRecoverTime:0,COST_ID:2,_selectSaoDangId:0,nextRecoverTime:{set:function(e){this._nextRecoverTime=e},get:function(){return this._nextRecoverTime}},enterDungeonId:0,enterDungeonLimitTime:0,timer:null,_registered:!1,setupDungeonInfo:function(e){if(this.maxFightCount=e.maxNum,this.fightCount=e.num,this.buyCount=e.buyNum,this.pay_maxnum=e.payMaxnum,this.free_maxnum=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.LONEY_DUNGEON_MAX_FIGHT_COUNT),this.dungeonInfos=b8e.HashMap.get(),this.unLockGroup=[],this.unLockId=0,this.finishDungeonId=0,e.instances)for(var t=0;t<e.instances.length;t++){var i=e.instances[t],n=new game.LoneyDungeonInfo;n.setup(i),n.state==game.LoneyDungeonState.UNLOCK&&(0==this.unLockId||this.unLockId>n.id)&&(this.unLockId=n.id),n.state==game.LoneyDungeonState.FINISH&&(0==this.finishDungeonId||this.finishDungeonId<n.id)&&(this.finishDungeonId=n.id),this.dungeonInfos.set(n.id,n);var s=game.ccfg.DungeonCfg.getDataById(n.id);s&&-1==this.unLockGroup.indexOf(s.group)&&this.unLockGroup.push(s.group)}(this.unLockGroup.sort(this.sortUnLockGroup),s=game.ccfg.DungeonCfg.getDataById(this.unLockId))?this.selectIndex=this.unLockGroup.indexOf(s.group):game.ccfg.DungeonCfg.getMaxGroupIndex()==this.unLockGroup.length-1?this.selectIndex=this.unLockGroup.indexOf(this.unLockGroup.length):this.selectIndex=0;if(this.recoverInterval=1e3*e.recoverInterval,this.fightCount<this.maxFightCount&&(this.nextRecoverTime=1e3*e.recoverTime+game.SysTime.curTime),b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE),this.fightCount<this.maxFightCount){var a=1e3*e.recoverTime;b8e.Tween.kill(this),b8e.Tween.get(this).wait(a).call(this.startRecover)}},sortUnLockGroup:function(e,t){return e-t},startRecover:function(){this.fightCount<this.maxFightCount&&this.fightCount++,this.startRecoverFightTime(),b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE)},startRecoverFightTime:function(){this.fightCount>=this.maxFightCount||(this.nextRecoverTime<game.SysTime.curTime&&(this.nextRecoverTime=game.SysTime.curTime+this.recoverInterval),this._timer||(this._timer=b8e.Timer.add(this,this.recoverFightTime,this.recoverInterval)),this._timer.reset(),this._timer.start())},recoverFightTime:function(){if(this.fightCount<this.maxFightCount&&this.fightCount++,this.fightCount==this.maxFightCount)return this._timer&&this._timer.stop(),void b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE);this.nextRecoverTime=game.SysTime.curTime+this.recoverInterval,b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE)},getLoneyDungeonInfo:function(){game.LoneyDungeonSender.inst().getLoneyDungeonInfo()},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.TIAO_ZHAN)&&this.getLoneyDungeonInfo(),this._registered||(this._registered=!0,b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onDungeonOpenCallBack),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onDungeonOpenCallBack),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onDungeonOpenCallBack))},onDungeonOpenCallBack:function(){game.funcOpen.checkOpen(game.FunctionType.TIAO_ZHAN)&&(this.getLoneyDungeonInfo(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onDungeonOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onDungeonOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_ROLE_LEVEL_UP,this.onDungeonOpenCallBack))},enterDungeonComplete:function(e){e&&(b8e.log("进入副本成功"),this.enterDungeonId=e.id,this.enterDungeonLimitTime=e.limitTime,game.leaveDungeon.show(e.limitTime,game.SceneType.DUNGEON))},unLockDungeon:function(e){if(this.dungeonInfos){var t=new game.LoneyDungeonInfo;t.setup(e.instance),this.dungeonInfos.set(t.id,t);var i=game.ccfg.DungeonCfg.getDataById(t.id);i&&(-1==this.unLockGroup.indexOf(i.group)&&this.unLockGroup.push(i.group),this.selectIndex=this.unLockGroup.length-1,b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE))}},onFinishDungeon:function(e){if(this.dungeonInfos&&e)if(e.state==game.BattleState.Victory){var t=this.dungeonInfos.get(e.id);if(!t)return;t.freeNum<this.free_maxnum&&t.freeNum++,t.state==game.LoneyDungeonState.UNLOCK?t.state=game.LoneyDungeonState.FINISH:this.fightCount--,this.startRecoverFightTime(),b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE),b8e.evt.dptG(game.DujieEvent.TONGGUNAG_FUBEN),game.DungeonResultMgr.inst().showResult(!0,e.userItem)}else game.DungeonResultMgr.inst().showResult(!1)},onFinishQuestInstaceDungeon:function(e){e&&(e.state==game.BattleState.Victory?game.DungeonResultMgr.inst().showResult(!0,e.userItem):game.DungeonResultMgr.inst().showResult(!1))},onFinishBuyInsNum:function(e){if(this.fightCount=e.num,this.fightCount<this.maxFightCount&&(this.nextRecoverTime=1e3*e.recoverTime+game.SysTime.curTime),this.fightCount<this.maxFightCount){var t=1e3*e.recoverTime;b8e.Tween.kill(this),b8e.Tween.get(this).wait(t).call(this.startRecover)}this.buyCount++,b8e.evt.dptG(game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES)},onSaoDangDungeon:function(e){var t=this.dungeonInfos.get(e.id);t&&(t.state=game.LoneyDungeonState.FINISH,t.freeNum<this.free_maxnum?t.freeNum++:t.payNum++,this.fightCount--,this.startRecoverFightTime(),b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE))},getCurDungeonList:function(){var e=game.ccfg.DungeonCfg.getGroupIdByIndex(this.selectIndex);return game.ccfg.DungeonCfg.getGroupById(e)},getMaxSelectIndex:function(){return this.unLockGroup.length-1},getMaxGruopId:function(){return this.unLockGroup[this.unLockGroup.length-1]},getDungeonInfoById:function(e){return this.dungeonInfos?this.dungeonInfos.get(e):0},getNextResetTime:function(){return this.fightCount==this.maxFightCount?0:this.nextRecoverTime>game.SysTime.curTime?this.nextRecoverTime:(this.nextRecoverTime+=this.recoverInterval,this.getNextResetTime())},getFightCount:function(){return this.fightCount},getDungeonRank:function(e){var t="未闯关",i=game.ccfg.DungeonCfg.getDataById(e);if(!i)return t;for(var n=game.ccfg.DungeonCfg.getGroupById(i.group),s=0,a=0;a<n.length;a++){var o=n[a];o&&o.id==e&&(s=a+1)}return t=i.group+"章"+s+"关"},getFinishDungeonId:function(){return this.finishDungeonId},getGroupById:function(e){var t=game.ccfg.DungeonCfg.getDataById(e);return t?t.group:0},getGroupLevelById:function(e){var t=game.ccfg.DungeonCfg.getDataById(e);if(!t)return 0;var i=game.ccfg.DungeonCfg.getGroupById(t.group);if(!i||i.length<0)return 0;for(var n=0,s=0;s<i.length;s++){var a=i[s];if(a&&a.id==e){n=s+1;break}}return n},clickLeft:function(){0!=this.selectIndex&&(this.selectIndex-=1,b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE))},clickRight:function(){var e=game.ccfg.DungeonCfg.getMaxGroupIndex();if(this.selectIndex>=e)game.notice.show("新的精英正在路上");else{var t=game.ccfg.DungeonCfg.getDataById(this.unLockId);if(t){if(this.selectIndex>=this.unLockGroup.indexOf(t.group))return void game.notice.show("请先通关当前章节")}else if(this.selectIndex==this.unLockGroup.length-1)return void game.notice.show("暂未解锁新的章节");this.selectIndex+=1,b8e.evt.dptG(game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE)}},saoDangDungeon:function(e){if(0!=this.fightCount){var t=this.getDungeonInfoById(e);if(t.state!=game.LoneyDungeonState.UNLOCK)if(t.freeNum<this.free_maxnum)game.LoneyDungeonSender.inst().saoDangDungeon(e);else if(game.vip.getQuickPassTimes()-t.payNum<=0)game.gameAlert.showVipAlert(!1,100);else{var i=game.ccfg.CostCfg.getCostInfoByIdAndNum(this.COST_ID,t.payNum+1);i&&(this._selectSaoDangId=e,game.upgrade.costCheck(this,i.upgradeInfo,this.costCheckComplete,!0))}else game.notice.show("首通之后才能扫荡")}else game.notice.show("令牌个数为0无法扫荡")},costCheckComplete:function(e){e&&game.LoneyDungeonSender.inst().saoDangDungeon(this._selectSaoDangId)},fightDungeon:function(e){var t=game.loneyDungeon.getDungeonInfoById(e);if(t){var i=game.ccfg.DungeonCfg.getDataById(e);if(i)if(game.mainRole.mainRoleData.getLv()<i.limitLv)game.notice.show("等级不足，挑战需要:$级",[i.limitLv]);else if(0!=this.fightCount||t.state!=game.LoneyDungeonState.FINISH)if(this.unLockId<e){var n=game.ccfg.DungeonCfg.getDataById(this.unLockId);n&&game.notice.show("请先通关精英--"+n.name)}else game.app.hide(game.AppConstant.CHALLANGE_DUNGEON_PANEL),game.LoneyDungeonSender.inst().enterLoneyDungeon(e);else game.notice.show("BOSS令牌不足")}},sendBuyInsNum:function(){if(this.fightCount>=this.maxFightCount)game.notice.show("令牌数量已满");else{var e=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.BUY_TILI_COUNT,this.buyCount+1);e&&game.upgrade.costCheck(this,e.upgradeInfo,this.onIsPass,!0)}},onIsPass:function(e){e&&game.LoneyDungeonSender.inst().buyInsNumRequest()},getLoneyDungeonIsAlert:function(){if(!this.unLockGroup)return!1;if(game.ccfg.DungeonCfg.getMaxGroupIndex()==this.unLockGroup.length-1)return!1;if(0==this.unLockId)return!0;var e=game.ccfg.DungeonCfg.getDataById(this.unLockId);if(!e)return!1;var t=game.mainRole.mainRoleData,i=t.getLv(),n=t.getZhanLi();return i>=e.limitLv&&n>=e.recommendPower},getLvString:function(e){var t,i=1+~~(e/3);e%3==0?(i-=1,t=3):t=e%3;var n=game.ccfg.DungeonCfg.getGroupIdByIndex(i),s="";if(n&&-1<n)s=i+"章第"+t+"关";return s},getPassLayer:function(){var e=0;if(this.unLockGroup&&0<this.unLockGroup.length)if(game.ccfg.DungeonCfg.getMaxGroupIndex()==this.unLockGroup.length-1){var t=game.ccfg.DungeonCfg.getDungeonMapByType(game.DungeonType.TYPE_LONEY);t&&0<t.count()&&(e=t.count())}else{var i=game.ccfg.DungeonCfg.getGroupById(this.unLockGroup[this.unLockGroup.length-1]);if(i&&0<i.length){for(var n,s,a=0,o=0;o<i.length;o++)(n=i[o])&&((s=game.loneyDungeon.getDungeonInfoById(n.id))&&s.state==game.LoneyDungeonState.LOCK||s.state==game.LoneyDungeonState.UNLOCK)&&a++;e=this.unLockGroup.length*i.length-(0==a?1:a)}}return e}}),game.LoneyDungeonMgr._instance=null,game.LoneyDungeonMgr.inst=function(){return game.LoneyDungeonMgr._instance||(game.LoneyDungeonMgr._instance=new game.LoneyDungeonMgr),game.LoneyDungeonMgr._instance}},{}],469:[function(e,t,i){"use strict";e("./LoneyDungeonMgr")},{"./LoneyDungeonMgr":468}],470:[function(e,t,i){"use strict";game.appModule.ChallangeDungeonPanel=game.SkinUIPanel.extends({_loneyDungeonPanel:null,_timer:null,ctor:function(e){this._super(e)},initPanel:function(){this._loneyDungeonPanel||(this._loneyDungeonPanel=new game.LoneyDungeonPanel,this._loneyDungeonPanel.addToParent(this._skin.dungeonPage))},getButtonByName:function(e){switch(e){case"loney":return this._loneyDungeonPanel.getButtonByName("loney")||!0;case"fight":return this._loneyDungeonPanel.getButtonByName("fight")||!0}},onShow:function(){b8e.evt.addG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.startResetTime),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.startResetTime),b8e.evt.onC(this._skin.jiahaoBtn,this.onClickJiahaoBtn,this),this.initPanel(),this.setFightCount(!0),this._skin.title.string="精英BOSS",this._loneyDungeonPanel.show(),this.startResetTime(),this.data&&(this._index=this.data),-1==this._index&&(this._index=0)},onHide:function(){this.hidePanel(),b8e.evt.rmvG(this,game.LoneyDungeonEvent.UPDATE_FIGHT_TIMES,this.startResetTime),b8e.evt.rmvG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.startResetTime),b8e.evt.offC(this._skin.jiahaoBtn,this.onClickJiahaoBtn,this),this._timer&&this._timer.stop()},onSpotAlertChange:function(){this._skin.worldBossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WORLD_BOSS_ALERT),this._skin.nationalBossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.NATIONAL_BOSS_ALERT)},startResetTime:function(){var e=game.loneyDungeon;if(this._skin.label_have_time.string=e.fightCount+"/"+e.maxFightCount,e.fightCount==e.maxFightCount)this._skin.label_reset_time.string="";else{var t=e.getNextResetTime()-game.SysTime.curTime;t<0&&(t=0),this._skin.label_reset_time.string=b8e.TimeUtil.formatTime(t),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateResetTime,500)}},updateResetTime:function(){var e=game.loneyDungeon;if(this._skin.label_have_time.string=e.fightCount+"/"+e.maxFightCount,e.fightCount==e.maxFightCount)this._timer&&this._timer.stop(),this._skin.label_reset_time.string="";else{var t=e.getNextResetTime()-game.SysTime.curTime;t<0&&(t=0),this._skin.label_reset_time.string=b8e.TimeUtil.formatTime(t)}},onClickJiahaoBtn:function(){game.app.show(game.AppConstant.DUNGEON_BUY_PANEL)},hidePanel:function(){this._loneyDungeonPanel.hide()},setFightCount:function(e){this._skin.label_have_time.node.active=e,this._skin.label_reset_time.node.active=e,this._skin.jiahaoBtn.active=e}})},{}],471:[function(e,t,i){"use strict";var n=game.SkinUI.extends({data:null,_prizeList:null,_prizeInfo:null,_head:null,ctor:function(){this._super("loneyDungeon/LoneyDungeonListSkin","LoneyDungeonListSkin"),this._prizeInfo=new game.PrizeInfo},getButtonByName:function(e){switch(e){case"go":return!this._skin||this._skin.goBtn}return null},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.addToParent(this._skin.img_head)),this.setData(this.data),this.addEvent()},onHide:function(){this.removeEvent()},addEvent:function(){this._skin&&(b8e.evt.onC(this._skin.goBtn,this.onFight,this),b8e.evt.onC(this._skin.saodangBtn,this.onSaoDang,this),b8e.evt.onC(this._skin.coastSaoDang,this.onSaoDang,this))},removeEvent:function(){this._skin&&(b8e.evt.offC(this._skin.goBtn,this.onFight,this),b8e.evt.offC(this._skin.saodangBtn,this.onSaoDang,this),b8e.evt.offC(this._skin.coastSaoDang,this.onSaoDang,this))},setData:function(e){if(e&&(this.data=e,null!=this._skin)){if(this._skin.goBtn.active=!1,this._skin.saodangBtn.active=!1,this._skin.coastSaoDang.active=!1,this._skin.icon_yjb.active=!1,this._skin.cost.active=!1,this._skin.unLockLevel.string="",this._skin.bossNameLabel.string=e.name,this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.DUNGEON_SHOW_PRIZE_CONTAINER_ID,this._prizeList.addToParent(this._skin.prizeList)),e.monster){var t=e.monster[0];if(t){var i=game.ccfg.MonsterCfg.getMonsterModelById(t.Id);this._prizeInfo.setupById(i.dropId),this._prizeList.setData(this._prizeInfo)}}var n=game.ClientCfg.getLoneyDungeonHead(e.head);this._head.loadTexture(n,null,null,{useManifest:!1}),this._head.setSize(113,105);var s=game.loneyDungeon.getDungeonInfoById(e.id);if(s){var a,o,r=game.mainRole.mainRoleData,h=r.getLv(),g=r.getZhanLi();switch(g>=this.data.recommendPower?this._skin.lab_recommend_power.string=game.html.getText(game.html.Q_GREEN,this.data.recommendPower):this._skin.lab_recommend_power.string=game.html.getText(game.html.Q_RED,this.data.recommendPower),s.state){case game.LoneyDungeonState.LOCK:this._skin.unLockLevel.string=e.limitLv+"解锁";break;case game.LoneyDungeonState.UNLOCK:o=(a=game.loneyDungeon.free_maxnum)-s.freeNum,this._skin.timesLbl.string="今日挑战次数：",this._skin.timesCount.string=o+"",s.freeNum>=a?this._skin.icon_yjb.active=!0:this._skin.goBtn.active=!0,e.dropId&&(this._prizeInfo.setupById(e.dropId),this._prizeList.setData(this._prizeInfo)),this._skin.rewardTypeLab.string=game.html.getText(game.html.Q_YELLOW,"首通奖励"),game.ccfg.DungeonCfg.getMaxGroupIndex()==game.loneyDungeon.getMaxSelectIndex()?this._skin.fightAlert.active=!1:h>=e.limitLv&&this.data.id==game.loneyDungeon.unLockId?this._skin.fightAlert.active=g>=this.data.recommendPower:this._skin.fightAlert.active=!1;break;case game.LoneyDungeonState.FINISH:if(this._skin.icon_yjb.active=!0,this._skin.rewardTypeLab.string=game.html.getText(game.html.GRAY_WHITE,"掉落奖励"),s.freeNum<game.loneyDungeon.free_maxnum)return o=(a=game.loneyDungeon.free_maxnum)-s.freeNum,this._skin.timesLbl.string="今日挑战次数：",this._skin.timesCount.string=o+"",void(this._skin.saodangBtn.active=!0);this._skin.timesLbl.string="额外扫荡次数：",(o=game.vip.getQuickPassTimes()-s.payNum)<0&&(o=0),this._skin.timesCount.string=o+"";var l=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.loneyDungeon.COST_ID,s.payNum+1);if(l){this._skin.cost.active=!0;var c=l.upgradeInfo.getAmountInfo();this._skin.costLbl.string=c.getFirstAmountValue()+"",this._skin.coastSaoDang.active=!0}else this._skin.saodangBtn.active=!0}}else this._skin.unLockLevel.string=e.limitLv+"解锁"}},onFight:function(){game.loneyDungeon.fightDungeon(this.data.id)},onSaoDang:function(){game.loneyDungeon.saoDangDungeon(this.data.id)},getHeight:function(){return 193},getWidth:function(){return 542}});game.LoneyDungeonListItem=n},{}],472:[function(e,t,i){"use strict";game.LoneyDungeonPanel=game.SkinUI.extends({_listItems:null,_timer:null,ctor:function(){this._super("loneyDungeon/LoneyDungeonSkin","LoneyDungeonSkin")},getButtonByName:function(e){var t;switch(e){case"fight":case"loneyFight":if(this._listItems&&0<this._listItems.length){var i=this._listItems[0];if(i&&(t=i.getButtonByName("go")))return t}return!0}return null},init:function(){this._listItems=[];for(var e=0,t=0;t<3;t++){var i=new game.LoneyDungeonListItem;i.setAnchor(.5,.5),i.addToParent(this._skin.itemNode),i.show(),e=193*t,i.setPosition(0,-e-96),this._listItems.push(i)}},onShow:function(){b8e.evt.onC(this._skin.btn_left,this.onLeftClick,this),b8e.evt.onC(this._skin.btn_right,this.onRightClick,this),b8e.evt.onC(this._skin.gotoRankNode,this.onGotoRankNodeClick,this),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.onCurSelectPageChange),game.loneyDungeon.getLoneyDungeonInfo()},onHide:function(){b8e.evt.offC(this._skin.btn_left,this.onLeftClick,this),b8e.evt.offC(this._skin.btn_right,this.onRightClick,this),b8e.evt.offC(this._skin.gotoRankNode,this.onGotoRankNodeClick,this),b8e.evt.rmvG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.onCurSelectPageChange)},onCurSelectPageChange:function(){this._skin.list_item.scrollToTop(.1),this._skin.list_item.content.removeAllChildren();var e,t,i=game.loneyDungeon.selectIndex,n=game.ccfg.DungeonCfg.getMaxGroupIndex();0==i?(this._skin.btn_left.active=!1,this._skin.label_left.string=""):(this._skin.btn_left.active=!0,e=game.ccfg.DungeonCfg.getGroupIdByIndex(i-1),t=game.ccfg.DungeonCfg.getGroupNameByGroupId(e),this._skin.label_left.string=t),i==n?(this._skin.btn_right.active=!1,this._skin.label_right.string=""):(this._skin.btn_right.active=!0,e=game.ccfg.DungeonCfg.getGroupIdByIndex(i+1),t=game.ccfg.DungeonCfg.getGroupNameByGroupId(e),this._skin.label_right.string=t),e=game.ccfg.DungeonCfg.getGroupIdByIndex(i),t=game.ccfg.DungeonCfg.getGroupNameByGroupId(e),this._skin.label_cur.string=t;var s=game.loneyDungeon.getCurDungeonList();if(s)for(var a=0;a<this._listItems.length;a++){var o=this._listItems[a],r=s[a];o.setData(r)}},onLeftClick:function(){game.loneyDungeon.clickLeft()},onRightClick:function(){game.loneyDungeon.clickRight()},onGotoRankNodeClick:function(){game.app.show(game.AppConstant.RANK_PANEL,game.RankType.RANK_DUNGEON)}})},{}],473:[function(e,t,i){"use strict";e("./LoneyDungeonListItem"),e("./LoneyDungeonPanel")},{"./LoneyDungeonListItem":471,"./LoneyDungeonPanel":472}],474:[function(e,t,i){"use strict";game.LoneyDungeonSender=game.BaseSender.extends({getLoneyDungeonInfo:function(){var e=game.pbmid.Instance.InstanceInfoRequest;this.send(e)},enterLoneyDungeon:function(e){var t=game.pbmsg.EnterMainInsRequest;t.id=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Instance.EnterMainInsRequest;this.send(i)},saoDangDungeon:function(e){var t=game.pbmsg.QuickChallengeRequest;t.id=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Instance.QuickChallengeRequest;this.send(i)},buyInsNumRequest:function(){var e=game.pbmid.Instance.BuyInsNumRequest;this.send(e)}}),game.LoneyDungeonSender._instance=null,game.LoneyDungeonSender.inst=function(){return null==game.LoneyDungeonSender._instance&&(game.LoneyDungeonSender._instance=new game.LoneyDungeonSender),game.LoneyDungeonSender._instance}},{}],475:[function(e,t,i){"use strict";e("./LoneyDungeonSender")},{"./LoneyDungeonSender":474}],476:[function(e,t,i){"use strict";game.MailCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Mail.MailResponse,this.onMailResponse,this),b8e.addNH(game.pbmid.Mail.GetMailItemResponse,this.onGetMailItemResponse,this),b8e.addNH(game.pbmid.Mail.ReadMailResponse,this.onReadMailResponse,this),b8e.addNH(game.pbmid.Mail.RemoveMailResponse,this.onRemoveMailResponse,this),b8e.addNH(game.pbmid.Mail.MailNotify,this.onMailNotify,this)},onMailResponse:function(e){var t=e.readProtobuf(game.pbmsg.MailResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.mail.synMailInfo(t.list)},onGetMailItemResponse:function(e){var t=e.readProtobuf(game.pbmsg.GetMailItemResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.mail.onGetMailItemSuccess(t.id)},onReadMailResponse:function(e){var t=e.readProtobuf(game.pbmsg.ReadMailResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.mail.onReadMailSuccess(t.ids)},onRemoveMailResponse:function(e){var t=e.readProtobuf(game.pbmsg.RemoveMailResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.mail.onRemoveMailSuccess(t.ids)},onMailNotify:function(e){var t=e.readProtobuf(game.pbmsg.MailNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.mail.onMailNotify(t.mail)}})},{}],477:[function(e,t,i){"use strict";e("./MailCmd")},{"./MailCmd":476}],478:[function(e,t,i){"use strict";game.MailEvents=b8e.Enum({MAIL_UPDATE:b8e.Event.nextCode(),MAIL_DEL_SUCCESS:b8e.Event.nextCode()})},{}],479:[function(e,t,i){"use strict";e("./MailEvents")},{"./MailEvents":478}],480:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_8"),e("./event/eventIndex_11"),e("./manager/managerIndex_16"),e("./panel/panelIndex_10"),e("./sender/senderIndex_12")},{"./cmdlistener/cmdlistenerIndex_8":477,"./event/eventIndex_11":479,"./manager/managerIndex_16":482,"./panel/panelIndex_10":486,"./sender/senderIndex_12":488}],481:[function(e,t,i){"use strict";game.MailMgr=b8e.Object.extends({name:"MailMgr",_newMailCount:0,_mailsMap:null,_removeArr:null,_timer:null,ctor:function(){if(1==game.MailMgr._singleton)throw new Error("MailMgr 只能通过单例方法获取");this._mailsMap=b8e.HashMap.get(),this._removeArr=[]},synMailInfo:function(e){if(this.newMailCount=0,this._mailsMap.clear(),e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];i&&this.addMail(i)}this._timer||(this._timer=b8e.Timer.add(this,this.checkExpiredMail,1e3)),b8e.evt.dptG(game.MailEvents.MAIL_UPDATE)},checkExpiredMail:function(){var e,t=this._mailsMap.values();if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i];if(0<n.expire)if(e=game.SysTime.curTime,n.expire-e<0)0==n.prizeInfo.getPrizeList().length?0==n.isRead&&0<this.newMailCount&&(this.newMailCount-=1):0==n.isGet&&0<this.newMailCount&&(this.newMailCount-=1),this._mailsMap.del(n.id),b8e.evt.dptG(game.MailEvents.MAIL_DEL_SUCCESS)}else this._timer&&(b8e.Timer.remove(this,this.checkExpiredMail),this._timer=null)},onReadMailSuccess:function(e){if(e&&!(e.length<=0))for(var t=0;t<e.length;t++){var i=e[t];if(i&&this._mailsMap&&0<this._mailsMap.count()){var n=this._mailsMap.get(i);if(n)n.isRead=!0,0==n.prizeInfo.getPrizeList().length&&0<this.newMailCount&&(this.newMailCount-=1),this._mailsMap.set(i,n),b8e.evt.dptG(game.MailEvents.MAIL_UPDATE)}}},onGetMailItemSuccess:function(e){if(this._mailsMap&&0<this._mailsMap.count()){var t=this._mailsMap.get(e);t&&(t.isGet=!0,this._mailsMap.set(e,t),0<this.newMailCount&&(this.newMailCount-=1),b8e.evt.dptG(game.MailEvents.MAIL_UPDATE))}},onRemoveMailSuccess:function(e){e&&e.length},onMailNotify:function(e){e&&(this._mailsMap.get(e.id)||(this.addMail(e),this._timer||(this._timer=b8e.Timer.add(this,this.checkExpiredMail,1e3)),b8e.evt.dptG(game.MailEvents.MAIL_UPDATE)))},addMail:function(e){var t=new game.MailInfo;t.setup(e),0==t.prizeInfo.getPrizeList().length?0==t.isRead&&this.newMailCount++:0==t.isGet&&this.newMailCount++,this._mailsMap.set(t.id,t)},getAllMail:function(){return this._mailsMap.values()},newMailCount:{set:function(e){this._newMailCount=e},get:function(){return this._newMailCount}},mailAlert:function(){if(!this._mailsMap||0==this._mailsMap.count())return!1;for(var e=this._mailsMap.values(),t=0;t<e.length;t++)if(0==e[t].isRead)return!0;return!1}}),game.MailMgr._instance=null,game.MailMgr._singleton=!0,game.MailMgr.inst=function(){return game.MailMgr._instance||(game.MailMgr._singleton=!1,game.MailMgr._instance=new game.MailMgr,game.MailMgr._singleton=!0),game.MailMgr._instance}},{}],482:[function(e,t,i){"use strict";e("./MailMgr")},{"./MailMgr":481}],483:[function(e,t,i){"use strict";game.appModule.MailDetailsPanel=game.SkinUIPanel.extends({_mailInfo:null,_labTime:null,_prizeList:null,_sendArr:null,ctor:function(e){this._super(e),this._sendArr=[]},onShow:function(){this.data&&(this._mailInfo=this.data,this.onUpdateMailInfo()),b8e.evt.addG(this,game.MailEvents.MAIL_UPDATE,this.onUpdateMailInfo),b8e.evt.onC(this._skin.btn_reward,this.onClickGetItem,this)},onHide:function(){b8e.evt.rmvG(this,game.MailEvents.MAIL_UPDATE,this.onUpdateMailInfo),b8e.evt.offC(this._skin.btn_reward,this.onClickGetItem,this)},onClickGetItem:function(){this._mailInfo&&!this._mailInfo.isGet&&(this._sendArr.length=0,this._sendArr.push(this._mailInfo.id),game.MailSender.reqReadMail(this._sendArr),game.MailSender.reqMailItem(this._mailInfo.id))},onUpdateMailInfo:function(){if(this._mailInfo&&this._mailInfo.prizeInfo){this._skin.content.x=-235;var e,t=this._mailInfo.prizeInfo.getPrizeList(),i=t.length,n=!!(t&&0<i);if(this._skin.msgHaveItem.active=n,this._skin.msgNoneItem.active=!n,this._skin.btn_reward.active=n)this._prizeList||(this._prizeList=new game.PrizeList(i,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize)),this._prizeList.setpPrameter(i,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.setData(this._mailInfo.prizeInfo),this._skin.lab_title.string=this._mailInfo.title,this._skin.lab_content.string=this._mailInfo.content+"\n\n"+this._mailInfo.sender+"\n"+b8e.TimeUtil.formatTimestamp(this._mailInfo.time,"Y/M/D/ h:m"),this._skin.lab_have.string=this._mailInfo.content,this._skin.reward_content.width=90*i,this._mailInfo.isGet?(e="已领取",b8e.ShaderUtil.setGray(this._skin.btn_reward),b8e.ShaderUtil.setGray(this._skin.lab_reward.node)):(e="领取附件",b8e.ShaderUtil.reset(this._skin.btn_reward),b8e.ShaderUtil.reset(this._skin.lab_reward.node)),this._skin.lab_reward.string=e;else this._skin.lab_title2.string=this._mailInfo.title,this._skin.lab_content2.string=this._mailInfo.content+"\n\n"+this._mailInfo.sender+"\n"+b8e.TimeUtil.formatTimestamp(this._mailInfo.time,"Y/M/D/ h:m"),this._skin.lab_none.string=this._mailInfo.content}}})},{}],484:[function(e,t,i){"use strict";game.MailItem=game.SkinUI.extends({_mailInfo:null,_sendArr:null,ctor:function(e){this._super("mail/MailItemSkin","MailItemSkin"),this._mailInfo=e,this._sendArr=[]},onShow:function(){this.setData(this._mailInfo),b8e.evt.onC(this,this.onClickMailItem,this)},onHide:function(){b8e.evt.offC(this,this.onClickMailItem,this)},setData:function(e){if(this._mailInfo=e,this._skin&&this._mailInfo){if(0==e.expire)this._skin.lab_time.string="永不过期";else{var t=game.SysTime.curTime,i=e.expire-t;i>b8e.TimeUtil.DAY_MICRO_SECONDS?this._skin.lab_time.string=(i/b8e.TimeUtil.DAY_MICRO_SECONDS>>0)+"天后删除":this._skin.lab_time.string=b8e.TimeUtil.formatTime(i)+"后删除"}this._skin.lab_name.string=e.title,this._skin.lab_msgSender.string=e.sender,0<e.prizeInfo.getPrizeList().length?(this._skin.img_reward.active=!0,this._skin.black_mask.active=e.isGet,this._skin.img_off.active=!e.isGet,this._skin.img_on.active=e.isGet):(this._skin.img_reward.active=!1,this._skin.black_mask.active=e.isRead,this._skin.img_off.active=!e.isRead,this._skin.img_on.active=e.isRead)}},onClickMailItem:function(){if(this._mailInfo){if(!this._mailInfo.isRead)0==this._mailInfo.prizeInfo.getPrizeList().length&&(this._sendArr.length=0,this._sendArr.push(this._mailInfo.id),game.MailSender.reqReadMail(this._sendArr));game.app.show(game.AppConstant.MAIL_DETAILS_PANEL,this._mailInfo)}},getHeight:function(){return 92},getWidth:function(){return 520}})},{}],485:[function(e,t,i){"use strict";game.MailPanel=game.SkinUI.extends({_list:null,_timer:null,ctor:function(){this._super("mail/MailSkin","MailSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.mailMsgList,game.MailItem)),this._list.show(),this.onUpdateMailInfo(),this._timer||(this._timer=b8e.Timer.add(this,this.onUpdateMailInfo,1e3)),this._timer.reset(),this._timer.start(),b8e.evt.addG(this,game.MailEvents.MAIL_UPDATE,this.onUpdateMailInfo)},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.evt.rmvG(this,game.MailEvents.MAIL_UPDATE,this.onUpdateMailInfo)},onUpdateMailInfo:function(){var e=game.mail.getAllMail(),t=e.length;e&&0<t?(e.sort(this.onSortByTime),this._skin.notice.string=""):this._skin.notice.string="无邮件通知",this._list.setData(e)},onSortByTime:function(e,t){var i=0<e.prizeInfo.getPrizeList().length,n=0<t.prizeInfo.getPrizeList().length;if(1==i&&1==n)if(e.isGet&&t.isGet){if(e.time>t.time)return-1;if(e.time<t.time)return 1}else{if(e.isGet&&!t.isGet)return 1;if(!e.isGet&&t.isGet)return-1;if(e.time>t.time)return-1;if(e.time<t.time)return 1}else{if(1==i&&0==n)return-1;if(0==i&&1==n)return 1;if(e.isGet&&t.isGet){if(e.time>t.time)return-1;if(e.time<t.time)return 1}else{if(e.isGet&&!t.isGet)return 1;if(!e.isGet&&t.isGet)return-1;if(e.time>t.time)return-1;if(e.time<t.time)return 1}}return 0}})},{}],486:[function(e,t,i){"use strict";e("./MailDetailsPanel"),e("./MailPanel"),e("./MailItem")},{"./MailDetailsPanel":483,"./MailItem":484,"./MailPanel":485}],487:[function(e,t,i){"use strict";var n=game.MailSender=function(){};n.reqMailInfo=function(){var e=game.pbmid.Mail.MailRequest;b8e.sendN(e)},n.reqMailItem=function(e){var t=game.pbmsg.GetMailItemRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Mail.GetMailItemRequest;b8e.sendN(i)},n.reqremoveMail=function(e){var t=game.pbmsg.RemoveMailRequest;t.ids=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Mail.RemoveMailRequest;b8e.sendN(i)},n.reqReadMail=function(e){var t=game.pbmsg.ReadMailRequest;t.ids=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Mail.ReadMailRequest;b8e.sendN(i)}},{}],488:[function(e,t,i){"use strict";e("./MailSender")},{"./MailSender":487}],489:[function(e,t,i){"use strict";e("./manager/managerIndex_7"),e("./panel/panelIndex_11")},{"./manager/managerIndex_7":492,"./panel/panelIndex_11":512}],490:[function(e,t,i){"use strict";game.MainUIMgr=b8e.Object.extends({name:"MainUIMgr",_mainGui:null,_isShowMainUI:!1,ctor:function(){if(1==game.MainUIMgr._singleton)throw new Error("MainUIMgr 只能通过单例方法获取");this._super()},mainui:{get:function(){return this._mainGui||(this._mainGui=new game.MainGUI),this._mainGui}},showMainUI:function(){this._isShowMainUI||(this._isShowMainUI=!0,this.mainui.show())},hideMainUI:function(){this._isShowMainUI&&(this._isShowMainUI=!1,this.mainui.hide())},showAppHideOther:function(){this.mainui.showAppHideOther()},hideAppShowOther:function(){this.mainui.hideAppShowOther()},hideMainMenu:function(){this.mainui.hideMainMenu()},setStrengthenVisibel:function(e){this.mainui.setStrengthenVisibel(e)}}),game.MainUIMgr._instance=null,game.MainUIMgr._singleton=!0,game.MainUIMgr.inst=function(){return game.MainUIMgr._instance||(game.MainUIMgr._singleton=!1,game.MainUIMgr._instance=new game.MainUIMgr,game.MainUIMgr._singleton=!0),game.MainUIMgr._instance}},{}],491:[function(e,t,i){"use strict";game.ShapeShiftMgr=b8e.Object.extends({root:{type:cc.Node,get:function(){return game.PlotMgr.inst().isPlaying()?b8e.layer.getTopLayer():b8e.layer.getGuiLayer()}},_shapeRestoreTime:15,_shapeId:0,ctor:function(){if(1==game.ShapeShiftMgr._singleton)throw new Error("SpellReleaseHelper 只能通过单例方法获取")},_bodyFxRoot:null,sendShapeShift:function(e){var t=game.mainRole.mainRoleData;if(t&&e&&!(e.misoperationTime>game.SysTime.curTime)){var i=e.bianshenId,n=game.bianshen.getBianshenCdTime(i);if(0==this._shapeId&&(this._shapeId=t.heroModel.getBodyResId()),this._shapeId!=i){if(e.cdFinishTs>game.SysTime.curTime){var s=~~((e.cdFinishTs-game.SysTime.curTime)/1e3);return void game.notice.show("变身槽位冷却时间:"+s+"秒")}if(n>game.SysTime.curTime){var a=~~((n-game.SysTime.curTime)/1e3);return void game.notice.show("使用变身冷却时间:"+a+"秒")}this.changeChar(i)}else e.isIn=!1,this.changeChar(t.defaultModelId)}},serverShape:function(e){if(e){var t=e.currShapeId;if(0!=t){if(b8e.log("服务器发送变身:",t),this._shapeId=t,e.slotCdStates)for(var i,n,s=0;s<e.slotCdStates.length;s++)i=e.slotCdStates[s],(n=game.bianshen.getBattleSlotsByIndex(i.index))?(n.bianshenId==t?n.isIn=!0:n.isIn=!1,n.shapeRestoreTs=i.shapeRestoreTs,n.cdFinishTs=i.cdFinishTs):b8e.log("找不到对应的槽位数据:",i.index);game.skill.initSpell();var a=game.mainRole.mainRoleEntity;if(game.mainRole.mainRoleData.defaultModelId!=t){var o=game.bianshen.getBianshenSlotInfoByid(t);if(!o)return void b8e.log("变身id不在槽位上，变身id:",t);game.bianshen.updateBianshenSlot(o),this.showShapeShiftFx(a),b8e.evt.dptG(game.BianshenEvent.START_BIANSHEN,{id:t})}b8e.evt.dptG(game.BianshenEvent.START_BIANSHEN)}else b8e.log("变身id是0")}},selfShape:function(e){this._shapeId=e;var t=game.mainRole.mainRoleEntity,i=game.mainRole.mainRoleData;if(i){var n=game.ccfg.HeroCfg.getResIdById(this._shapeId);i.avatarInfo.bodyResId=this._shapeId,i.avatarInfo.bodyRes=n,this.showShapeShiftFx(t),game.AvatarUtil.updateAvatar(t),game.skill.initSpell()}},defaultShape:function(){b8e.Tween.kill(this);var e=game.mainRole.mainRoleEntity,t=game.mainRole.mainRoleData;if(t){this._shapeId=0;var i=game.ccfg.HeroCfg.getResIdById(t.defaultModelId);t.avatarInfo.bodyResId=t.defaultModelId,t.avatarInfo.bodyRes=i,game.AvatarUtil.updateAvatar(e),game.skill.initSpell()}},shapeComplete:function(e){if(e){var t=e.newShapeId;if(0!=t){this._shapeId=t;var i=game.bianshen.getBattleSlots();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];s.isIn=!1,s.misoperationTime=0}var a=game.mainRole.mainRoleEntity,o=game.mainRole.mainRoleData;if(game.skill.initSpell(),o.defaultModelId!=t){var r=game.bianshen.getBianshenSlotInfoByid(t);if(!r)return void b8e.log("变身id不在槽位上，变身id:",t);r.shapeRestoreTs=e.restoreTs,r.cdFinishTs=e.nextChangeTs,this._nextAutoShapeTime=r.shapeRestoreTs+1e3,r.isIn=!0,r.misoperationTime=game.SysTime.curTime+3e3,game.bianshen.updateBianshenSlot(r),game.bianshen.updataBianshenCdTime(t,e.bianshenCdFinishTs),this.showShapeShiftFx(a),b8e.evt.dptG(game.BianshenEvent.START_BIANSHEN,{id:t})}}else b8e.log("变身id是0")}},unShape:function(){b8e.Tween.kill(this);var e=game.mainRole.mainRoleData;if(e){var t=game.bianshen.getBianshenSlotInfoByid(this._shapeId);t&&(t.isIn=!1,b8e.log("变身结束时间戳",game.SysTime.curTime),this.changeChar(e.defaultModelId),b8e.evt.dptG(game.BianshenEvent.START_BIANSHEN))}},_nextAutoShapeTime:0,_lockSend:!1,autoShapeToNext:function(){return!1},unlockSend:function(){this._lockSend=!1},changeChar:function(e){this._lockSend||(this._lockSend=!0,b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e3).call(this.unlockSend,this),game.SceneSender.changeChar(e))},getShapeId:function(){if(this._shapeId)return this._shapeId;var e=game.mainRole.mainRoleData;return 0==this._shapeId?(this._shapeId=e.heroModel.getBodyResId(),this._shapeId):(0==e.defaultModelId&&b8e.error("默认模型id居然是0!!!"),e.defaultModelId)},showShapeShiftFx:function(e,t){var n=this;if(e&&e.data&&!game.setting.getShapeAlertSelect()){if(!this._bodyFxRoot){var i=b8e.BaseDisplay.get();this._bodyFxRoot=i.getNode(),this.root.addChild(this._bodyFxRoot)}var s=this.root.convertToNodeSpaceAR(cc.Vec2.ZERO);this._bodyFxRoot.setPosition(s),this.playEffect(e);var a=game.ccfg.HeroCfg.getHeroCfgById(t||this._shapeId);if(a){var o=a.sceneResID;if(o&&0!=o){var r="app/animations/shapeshift-fxs/"+o+"/"+o;b8e.res.loadRes(r,b8e.Prefab,function(e,t){if(!e){var i=cc.instantiate(t.getPrefab());n._bodyFxRoot.addChild(i)}},this)}}}},playEffect:function(e){if(e){var t=game.ClientCfg.getSceneFx("10002"),i=e.getAnimator(game.AnimatorType.BIANSHEN_EFFECT,1);i||(i=e.addAnimator(game.AnimatorType.BIANSHEN_EFFECT,1,50)),i.load(t),i.play(),i.autoRelease()}}}),game.ShapeShiftMgr._instance=null,game.ShapeShiftMgr._singleton=!0,game.ShapeShiftMgr.inst=function(){return null==game.ShapeShiftMgr._instance&&(game.ShapeShiftMgr._singleton=!1,game.ShapeShiftMgr._instance=new game.ShapeShiftMgr,game.ShapeShiftMgr._singleton=!0),game.ShapeShiftMgr._instance}},{}],492:[function(e,t,i){"use strict";e("./MainUIMgr"),e("./ShapeShiftMgr")},{"./MainUIMgr":490,"./ShapeShiftMgr":491}],493:[function(e,t,i){"use strict";game.MainActivity=game.SkinUI.extends({_pool:null,_items:null,_clickAgain:!1,_timer:null,_activtyBtnMap:null,ctor:function(){this._super("mainui/MainActivitySkin","MainActivitySkin"),game.CommandMgr.inst().registerSkinUI("MAIN_ACTIVITY",this),this._pool=[],this._items=[],this._activtyBtnMap=b8e.HashMap.get()},getButtonByName:function(e){var t;switch(e){case"loginAward":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.LOGIN))||!t._skin||t._skin.touch;case"openServer":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.OPEN_SERVER))||!t._skin||t._skin.touch;case"micro":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.MICRO))||!t._skin||t._skin.touch;case"share":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.SHARE))||!t._skin||t._skin.touch;case"addShortCut":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.ADD_SHORTCUT))||!t._skin||t._skin.touch;case"focus":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.FOCUS))||!t._skin||t._skin.touch;case"festivalActives":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.FESTIVAL_LOGIN))||!t._skin||t._skin.touch;case"wanbaVIP":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.WANBAGAME_VIP))||!t._skin||t._skin.touch;case"millionAward":return!(t=this._activtyBtnMap.get(game.ActiveBarItemType.MILLIONAWARD))||!t._skin||t._skin.touch}return null},onShow:function(){this.onResize(),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.showBar),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.showBar),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.showBar),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.showBar),b8e.evt.onC(this._skin.btn_boon,this.onClickBoonBtn,this),this._skin.bg_boonRight.active=!0,this._skin.bg_boonLeft.active=!1,this._skin.img_node.active=!0,this._clickAgain=!1,this.showBar()},onHide:function(){b8e.evt.offC(this._skin.btn_boon,this.onClickBoonBtn,this),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.showBar),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.showBar),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.showBar),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.showBar)},showBar:function(){this._clickAgain?this._skin.alert.active=game.activeBar.getActiveBarAlert():this._timer?(this._timer.reset(),this._timer.start()):this._timer=engine.Timer.add(this,this._showBar,1e3,1)},_showBar:function(){this._skin.alert.active=!1;var e=game.activeBar.getActiveItems();if(e&&0<e.length){for(var t,i,n=0;n<e.length;n++){this._skin.btn_boon.active=!0,t=e[n],(i=this._items[n])||(i=this.getActiveItem(),(this._items[n]=i).addToParent(this._skin.img_node));var s=n%8*75,a=-90*Math.floor(n/8);i.setPosition(s,a),i.setData(t),i.show(),this._activtyBtnMap.set(t.id,i)}for(;n<this._items.length;)(i=this._items.pop()).removeFromParent(),this._pool.push(i)}else this._skin.btn_boon.active=!1},getActiveItem:function(){return 0<this._pool.length?this._pool.shift():new game.ActiveBarItem},onClickBoonBtn:function(){this._clickAgain?(this._skin.bg_boonRight.active=!0,this._skin.bg_boonLeft.active=!1,this._skin.img_node.active=!0,this._clickAgain=!1):(this._skin.bg_boonRight.active=!1,this._skin.bg_boonLeft.active=!0,this._skin.img_node.active=!1,this._clickAgain=!0),this.showBar()},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=b8e.stageHeight-this.height+t)}})},{}],494:[function(e,t,i){"use strict";game.MainGUI=b8e.Object.extends({_mainMenu:null,_bossUI:null,_mainTop:null,_mainTopLeft:null,_shapeBar:null,_mainQuest:null,_pkMode:null,_chat:null,_mainMenuRight:null,_worldBossDamageRankPanel:null,_mainActivity:null,_mainTopRight:null,_mainMiddleLeft:null,_mainMiniMap:null,_mainTransferNotice:null,_nationalBossLeft:null,_mainRedPacket:null,_tianGongTrackBar:null,_scoreTrackBar:null,_tianGongIcon:null,_tianGongSanJieIcon:null,_leaveDungeon:null,_teamIcon:null,_guildBossDamageRankPanel:null,_neutralBossAwardUI:null,ctor:function(){this._super(),this.init()},init:function(){this._mainMenu=new game.MainMenu,this._bossUI=new game.BossUI,this._mainTopLeft=new game.MainTopLeft,this._mainTop=new game.MainTop,this._shapeBar=new game.ShapeBar,this._mainQuest=new game.MainQuest,this._pkMode=new game.PkModePanel,this._chat=new game.MainChat,this._mainMenuRight=new game.MainMenuRight,this._worldBossDamageRankPanel=new game.WorldBossDamageRankPanel,game.IS_SHIELD_IOS_RECHARGE||(this._mainActivity=new game.MainActivity),this._mainTopRight=new game.MainTopRight,this._mainMiddleLeft=new game.MainMiddleLeft,this._mainMiniMap=new game.MainMiniMap,this._mainTransferNotice=new game.MainTransferNotice,this._nationalBossLeft=new game.NationalBossLeft,this._mainRedPacket=new game.MainRedPacket,this._tianGongTrackBar=new game.TianGongTracBar,this._scoreTrackBar=new game.ScoreTrackBar,this._tianGongIcon=new game.TianGongIcon,this._neutralBossAwardUI=new game.NeutralBossAwardPanel,game.shield.isShield(game.ShieldEnum.SAN_JIE)||(this._tianGongSanJieIcon=new game.TianGongSanJieIcon),this._leaveDungeon=new game.LeaveDungeonPanel,this._teamIcon=new game.MainTeam,this._guildBossDamageRankPanel=new game.GuildBossDamageRank;var e=b8e.layer.getGuiLayer();e.addChild(this._mainMenu),e.addChild(this._chat),e.addChild(this._bossUI),e.addChild(this._mainTop),e.addChild(this._mainTopLeft),e.addChild(this._shapeBar),e.addChild(this._mainQuest),e.addChild(this._pkMode),e.addChild(this._mainMenuRight),e.addChild(this._worldBossDamageRankPanel),game.IS_SHIELD_IOS_RECHARGE||e.addChild(this._mainActivity),e.addChild(this._mainTopRight),e.addChild(this._mainMiddleLeft),e.addChild(this._mainMiniMap),e.addChild(this._mainTransferNotice),e.addChild(this._nationalBossLeft),e.addChild(this._mainRedPacket),e.addChild(this._tianGongTrackBar),e.addChild(this._scoreTrackBar),e.addChild(this._tianGongIcon),e.addChild(this._neutralBossAwardUI),game.shield.isShield(game.ShieldEnum.SAN_JIE)||e.addChild(this._tianGongSanJieIcon),e.addChild(this._leaveDungeon),e.addChild(this._teamIcon),e.addChild(this._guildBossDamageRankPanel),this._mainMenu.setLocalZOrder(99999e3),this._mainTop.setLocalZOrder(99999e3),this._mainTransferNotice.setLocalZOrder(99999e3),this._mainRedPacket.setLocalZOrder(99999e3)},show:function(){this._mainMenu.show(),this._chat.show(),this._mainTopLeft.show(),this._mainTop.show(),this._shapeBar.show(),this._pkMode.show(),this._mainMenuRight.show(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.show(),this._mainTopRight.show(),this._mainMiddleLeft.show(),this._mainMiniMap.show(),this.__onResize(),this.registerEvent()},hide:function(){this._mainMenu.hide(),this._chat.hide(),this._mainTopLeft.hide(),this._mainTop.hide(),this._shapeBar.hide(),this._pkMode.hide(),this._mainMenuRight.hide(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.hide(),this._mainTopRight.hide(),this._mainMiddleLeft.hide(),this._mainMiniMap.hide(),this._neutralBossAwardUI.hide(),this.unregisterEvent()},registerEvent:function(){b8e.evt.addG(this,game.BossEvents.BOSS_EMERGE,this.showBossUI),b8e.evt.addG(this,game.BossEvents.BOSS_CLEAR,this.hideBossUI),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.showMainQuestUI),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.hideMainQuestUI),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.loadSceneComplete),b8e.evt.addG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.showTransferNotice),b8e.evt.addG(this,game.NationalBossEvents.ENTER_SCENE_FINISH,this.showNeutralBossAward),b8e.evt.addG(this,game.NationalBossEvents.LEAVE_SCENE_FINISH,this.hideNationalBossLeft),b8e.evt.addG(this,game.RedPacketEvents.RED_PACKET_UPDATE,this.showRedPacket),b8e.evt.addG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.showRedPacket),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SYN_INFO,this.showTianGongIconState),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_OPEN_STATE,this.tianGongOpenState),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_ICON_STATE,this.showTianGongIconState),b8e.evt.addG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.showTianGongIconState),b8e.evt.addG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.showTianGongIconState),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.__onResize),b8e.evt.addG(this,game.TeamEvent.CHANGE_TEAMMEMBERS,this.showTeamIcon)},unregisterEvent:function(){b8e.evt.rmvG(this,game.BossEvents.BOSS_EMERGE,this.showBossUI),b8e.evt.rmvG(this,game.BossEvents.BOSS_CLEAR,this.hideBossUI),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.showMainQuestUI),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.hideMainQuestUI),b8e.evt.rmvG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.loadSceneComplete),b8e.evt.rmvG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.showTransferNotice),b8e.evt.rmvG(this,game.NationalBossEvents.ENTER_SCENE_FINISH,this.showNeutralAward),b8e.evt.rmvG(this,game.NationalBossEvents.LEAVE_SCENE_FINISH,this.hideNationalBossLeft),b8e.evt.rmvG(this,game.RedPacketEvents.RED_PACKET_UPDATE,this.showRedPacket),b8e.evt.rmvG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.showRedPacket),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SYN_INFO,this.showTianGongIconState),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_OPEN_STATE,this.tianGongOpenState),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_ICON_STATE,this.showTianGongIconState),b8e.evt.rmvG(this,game.GuildEvt.GUILD_CREATE_GUILD_SUCCESS,this.showTianGongIconState),b8e.evt.rmvG(this,game.GuildEvt.GUILD_SYN_GUILD_INFO,this.showTianGongIconState),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.__onResize),b8e.evt.rmvG(this,game.TeamEvent.CHANGE_TEAMMEMBERS,this.showTeamIcon)},loadSceneComplete:function(){this.hideBossUI(),this.checkMainUIState()},showBossUI:function(){var e=game.ScenePickMgr.inst().getTarget();e&&e.data&&(this._bossUI.data=e.data,this._bossUI.show(),this._bossUI&&this._bossUI.onResize())},hideBossUI:function(){this._bossUI.isShow&&this._bossUI.hide()},checkMainUIState:function(){this.hideTianGongIcon(),this.hideTianGongSanJieIcon();var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.NORMAL:game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.show(),this._mainTopRight.show(),this._mainMiddleLeft.show(),this._shapeBar.show(),this._mainMenuRight.show(),this._pkMode.show(),this._mainTopLeft.show(),this._mainTop.show(),this._mainMiniMap.show(),this._worldBossDamageRankPanel.hide(),this._guildBossDamageRankPanel.hide(),this._mainMenu.show(),this.setStrengthenVisibel(!0),this.showMainQuestUI(),this.showTransferNotice(),this.showRedPacket(),this.showTianGongIcon(),this.showTianGongSanJieIcon(),this.hideTianGongTrackBar(),this.hideScoreTrackBar(),this.hideNationalBossLeft(),this.hideNeutralBossAward(),this.hideLeaveDungeon(),this.hideWorldBoss(),this.__onResize(),this.showTeamIcon();break;case game.SceneType.DUNGEON:this.showLeaveDungeon(),this.setHide();break;case game.SceneType.WORLDBOSS:this.showWorldBoss(),this.showLeaveDungeon(),this.setHide();break;case game.SceneType.SURA:this.hideLeaveDungeon(),this.setHide();break;case game.SceneType.NATIONALBOSS:this.setHide(),this.showNationalBossLeft(),this.showLeaveDungeon();break;case game.SceneType.ARENA:this.setHide(),this._mainTopLeft.hide(),this._mainTop.hide(),this._pkMode.hide(),this._mainMenuRight.hide(),this._shapeBar.hide(),this._mainMiniMap.hide(),this.hideLeaveDungeon();break;case game.SceneType.TIANGONG:this.setHide(),this.showTianGongTrackBar(),this.showLeaveDungeon();break;case game.SceneType.TEAM_BOSS:game.leaveDungeon.type=game.SceneType.TEAM_BOSS,this._teamIcon.hide(),this.showLeaveDungeon(),this.setHide()}},setHide:function(){this._mainMiddleLeft.hide(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.hide(),this._mainTopRight.hide(),this._mainQuest.hide()},showAppHideOther:function(){b8e.isMobile&&(this._chat.hide(),this._mainTopLeft.hide(),this._shapeBar.hide(),this._mainQuest.hide(),this._pkMode.hide(),this._mainMenuRight.hide(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.hide(),this._mainTopRight.hide(),this._mainMiddleLeft.hide(),this._mainMiniMap.hide())},hideAppShowOther:function(){b8e.isMobile&&(this._chat.show(),this._mainTopLeft.show(),this._shapeBar.show(),this._mainQuest.show(),this._pkMode.show(),this._mainMenuRight.show(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity.show(),this._mainTopRight.show(),this._mainMiddleLeft.show(),this._mainMiniMap.show(),this.checkMainUIState())},showTianGongTrackBar:function(){this._tianGongTrackBar.show(),this._tianGongTrackBar&&this._tianGongTrackBar.onResize(),this.showScoreTrackBar()},hideTianGongTrackBar:function(){this._tianGongTrackBar.hide()},showScoreTrackBar:function(){var e=game.SceneMgr.inst().sceneId,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),s=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID);switch(e){case t:case n:this.hideScoreTrackBar();break;case i:case s:this._scoreTrackBar.show(),this._scoreTrackBar&&this._scoreTrackBar.onResize()}},hideScoreTrackBar:function(){this._scoreTrackBar.hide()},showMainQuestUI:function(){if(game.quest.isHasQuest){var e=game.SceneMgr.inst().getSceneConfig();e&&e.type==game.SceneType.NORMAL&&(this._mainQuest.show(),this._mainQuest.isShow&&this._mainQuest.setQuestInfo(),this._mainQuest&&this._mainQuest.onResize())}},hideMainQuestUI:function(){this._mainQuest.hide()},showWorldBoss:function(){game.worldBoss.isCsWorldBoss?(this._guildBossDamageRankPanel.show(),this._guildBossDamageRankPanel&&this._guildBossDamageRankPanel.onResize()):(this._worldBossDamageRankPanel.show(),this._worldBossDamageRankPanel&&this._worldBossDamageRankPanel.onResize())},hideWorldBoss:function(){this._worldBossDamageRankPanel.hide()},showNationalBossLeft:function(){this._nationalBossLeft.show(),this._nationalBossLeft&&this._nationalBossLeft.onResize()},hideNationalBossLeft:function(){this._nationalBossLeft.hide()},showNeutralBossAward:function(e){e.data.cross&&(this.hideMainMenu(),this._neutralBossAwardUI.show())},hideNeutralBossAward:function(){this._neutralBossAwardUI.hide()},showTransferNotice:function(){this._mainTransferNotice.show(),this._mainTransferNotice&&this._mainTransferNotice.onResize()},showTeamIcon:function(){var e=game.SceneMgr.inst().getSceneConfig();e&&e.type==game.SceneType.TEAM_BOSS||(0<game.team.getRoomMembersCount()?(this._teamIcon.show(),this._teamIcon.onResize()):this._teamIcon.hide())},showRedPacket:function(){0<game.redPacket.redPacketNum?(this._mainRedPacket.show(),this._mainRedPacket&&this._mainRedPacket.onResize()):this._mainRedPacket.hide()},showTianGongIconState:function(){this.showTianGongIcon(),this.showTianGongSanJieIcon()},showTianGongIcon:function(){if(game.funcOpen.checkOpen(game.FunctionType.GUILD)){var e=game.SceneMgr.inst().getSceneConfig();if(e&&e.type==game.SceneType.TIANGONG||e.type!=game.SceneType.NORMAL)this.hideTianGongIcon();else if(game.tianGong.getTGInfoByIsCS(!1))if(-1<game.tianGong.getRemainDay(!1)){if(game.tianGong.isOpened(!1))return void this._tianGongIcon.hide();this._tianGongIcon&&(this._tianGongIcon.show(),this._tianGongIcon.onResize())}else this._tianGongIcon.hide();else this.hideTianGongIcon()}},hideTianGongIcon:function(){this._tianGongIcon&&this._tianGongIcon.hide()},tianGongOpenState:function(){game.tianGong.isOpening?game.tianGong.isCrossServer?game.shield.isShield(game.ShieldEnum.SAN_JIE)||game.tianGong.isOpenServerThirdWeek()&&this._tianGongSanJieIcon&&(this._tianGongSanJieIcon.isShow()||this._tianGongSanJieIcon.show(),this._tianGongSanJieIcon&&this._tianGongSanJieIcon.onResize()):this._tianGongIcon&&(this._tianGongIcon.isShow()||this._tianGongIcon.show(),this._tianGongIcon&&this._tianGongIcon.onResize()):game.tianGong.isCrossServer?this.hideTianGongSanJieIcon():this.hideTianGongIcon()},showTianGongSanJieIcon:function(){if(!game.shield.isShield(game.ShieldEnum.SAN_JIE)&&game.funcOpen.checkOpen(game.FunctionType.GUILD)&&game.tianGong.isOpenServerThirdWeek()){var e=game.SceneMgr.inst().getSceneConfig();if(e&&e.type==game.SceneType.TIANGONG||e.type!=game.SceneType.NORMAL)this.hideTianGongSanJieIcon();else if(game.tianGong.getTGInfoByIsCS(!0))if(-1<game.tianGong.getRemainDay(!0)){if(game.tianGong.isOpened(!0))return void this._tianGongSanJieIcon.hide();this._tianGongSanJieIcon&&(this._tianGongSanJieIcon.show(),this._tianGongSanJieIcon.onResize())}else this._tianGongSanJieIcon.hide();else this.hideTianGongSanJieIcon()}},hideTianGongSanJieIcon:function(){game.shield.isShield(game.ShieldEnum.SAN_JIE)||this._tianGongSanJieIcon&&this._tianGongSanJieIcon.hide()},showLeaveDungeon:function(){this._leaveDungeon.show(),this._leaveDungeon&&this._leaveDungeon.onResize()},hideLeaveDungeon:function(){this._leaveDungeon.hide()},hideMainMenu:function(){this._mainMenu&&this._mainMenu.hide()},setStrengthenVisibel:function(e){this._mainTopLeft&&this._mainTopLeft.setStrengthenVisibel(e)},__onResize:function(){this._mainMenu&&this._mainMenu.onResize(),this._chat&&this._chat.onResize(),this._bossUI&&this._bossUI.onResize(),this._mainTopLeft&&this._mainTopLeft.onResize(),this._mainTop&&this._mainTop.onResize(),this._shapeBar&&this._shapeBar.onResize(),this._mainQuest&&this._mainQuest.onResize(),this._pkMode&&this._pkMode.onResize(),this._mainMenuRight&&this._mainMenuRight.onResize(),this._worldBossDamageRankPanel&&this._worldBossDamageRankPanel.onResize(),game.IS_SHIELD_IOS_RECHARGE||this._mainActivity&&this._mainActivity.onResize(),this._mainTopRight&&this._mainTopRight.onResize(),this._mainMiddleLeft&&this._mainMiddleLeft.onResize(),this._mainMiniMap&&this._mainMiniMap.onResize(),this._tianGongTrackBar&&this._tianGongTrackBar.onResize(),this._tianGongIcon&&this._tianGongIcon.onResize(),game.shield.isShield(game.ShieldEnum.SAN_JIE)||this._tianGongSanJieIcon&&this._tianGongSanJieIcon.onResize(),this._scoreTrackBar&&this._scoreTrackBar.onResize(),this._leaveDungeon&&this._leaveDungeon.onResize(),this._teamIcon&&this._teamIcon.onResize(),this._mainTransferNotice&&this._mainTransferNotice.onResize(),this._nationalBossLeft&&this._nationalBossLeft.onResize(),this._mainRedPacket&&this._mainRedPacket.onResize(),this._guildBossDamageRankPanel&&this._guildBossDamageRankPanel.onResize()},getShapeBar:function(){return this._shapeBar}})},{}],495:[function(e,t,i){"use strict";game.MainMenu=game.SkinUI.extends({_tabIndex:-1,maxHeight:100,_progressEffect:null,_upCombatEffects:null,dujieLvIcon:null,_effectIndex:0,_enoughEffect:null,_upCombatEffect2:null,ctor:function(){this._super("mainui/MainMenuSkin","MainMenuSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_MENU",this)},getButtonByName:function(e){switch(e){case"role":return!this._skin||this._skin.charBtn;case"bag":return!this._skin||this._skin.bagBtn;case"bianShen":return!this._skin||this._skin.skillBtn;case"friend":return!0;case"guild":return!this._skin||this._skin.guildBtn;case"equip":return!this._skin||this._skin.forgingBtn;case"shop":return!this._skin||this._skin.shopBtn;case"dujie":return!this._skin||this._skin.dujieBtn}return null},setButtonSkin:function(e){var t=e.split(","),i=t[0],n=t[1],s=this.getButtonByName(i);if(s){var a=game.ClientCfg.getImgUrl(n);return s.skinUrl==a||(s.getComponent(cc.Sprite).spriteFrame=null,s.skinUrl&&s.onSkinComplete&&(b8e.res.unloadRes(s.skinUrl,s.onSkinComplete,s),s.skinUrl=null,s.onSkinComplete=null),s.skinUrl=a,s.onSkinComplete=function(e,t){e?b8e.error(e):this.getComponent(cc.Sprite).spriteFrame=t.getFrame()},b8e.res.loadRes(s.skinUrl,b8e.SpriteFrame,s.onSkinComplete,s,{useManifest:!1})),!0}return!1},init:function(){this._skin.mask&&(this.maxHeight=this._skin.mask.height),this.dujieLvIcon=b8e.Sprite.get(),this.dujieLvIcon.addToParent(this._skin.dujie_lv_icon),this.dujieLvIcon.setAnchor(.5,.5),this.dujieLvIcon.setScale(.7,.7)},onShow:function(){b8e.evt.onC(this._skin.charBtn,this.onClickCharBtn,this),b8e.evt.onC(this._skin.bagBtn,this.onClickBagBtn,this),b8e.evt.onC(this._skin.skillBtn,this.onClickSkillBtn,this),b8e.evt.onC(this._skin.guildBtn,this.onClickGuildBtn,this),b8e.evt.onC(this._skin.shopBtn,this.onClickShopBtn,this),b8e.evt.onC(this._skin.forgingBtn,this.onClickHomeBtn,this),b8e.evt.onC(this._skin.dujieBtn,this.onClickDujieBtn,this),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_EXP_CHANGE,this.updateExp),b8e.evt.addG(this,game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE,this.onUpdateBtnState),b8e.evt.addG(this,game.EquipEvt.HIGHEQUIP_SPORTALERT,this.updateRoleAlert),b8e.evt.addG(this,game.EquipEvt.ENCHANT_SPORTALERT,this.onEnchantAlertChange),this.onUpdateBtnState(),this.updateExp(),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange(),this.onResize(),this.onShapeAlertChange(),this.updateRoleAlert(),this.onEnchantAlertChange(),this.updateShowAlert(),this.updateFightAmount(),this.onOrnamentRefreshAlert(),b8e.evt.addG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.onShapeAlertChange),b8e.evt.addG(this,game.BackEvt.BACK_ITEM_ALERT,this.updateShowAlert),b8e.evt.addG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowAlert),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.addG(this,game.DujieEvent.UPDATE_DUJIE,this.updateFightAmount),b8e.evt.addG(this,game.DujieEvent.COMBAT_PLAY_COMPLETE,this.onPlayDujieEffect),b8e.evt.addG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert)},onHide:function(){this._progressEffect||this._progressEffect.clear(),b8e.evt.offC(this._skin.charBtn,this.onClickCharBtn,this),b8e.evt.offC(this._skin.bagBtn,this.onClickBagBtn,this),b8e.evt.offC(this._skin.skillBtn,this.onClickSkillBtn,this),b8e.evt.offC(this._skin.guildBtn,this.onClickGuildBtn,this),b8e.evt.offC(this._skin.shopBtn,this.onClickShopBtn,this),b8e.evt.offC(this._skin.forgingBtn,this.onClickHomeBtn,this),b8e.evt.offC(this._skin.dujieBtn,this.onClickDujieBtn,this),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_EXP_CHANGE,this.updateExp),b8e.evt.rmvG(this,game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE,this.onUpdateBtnState),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.BianshenEvent.SPOT_ALERT_STATE_CHANGE,this.onShapeAlertChange),b8e.evt.rmvG(this,game.BackEvt.BACK_ITEM_ALERT,this.updateShowAlert),b8e.evt.rmvG(this,game.BackEvt.BACK_EQUIP_ALERT,this.updateShowAlert),b8e.evt.rmvG(this,game.EquipEvt.HIGHEQUIP_SPORTALERT,this.updateRoleAlert),b8e.evt.rmvG(this,game.EquipEvt.ENCHANT_SPORTALERT,this.onEnchantAlertChange),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.rmvG(this,game.DujieEvent.UPDATE_DUJIE,this.updateFightAmount),b8e.evt.rmvG(this,game.DujieEvent.COMBAT_PLAY_COMPLETE,this.onPlayDujieEffect),b8e.evt.rmvG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert)},onUpdateBtnState:function(){game.app.isShow(game.AppConstant.ROLE_PANEL)?this._skin.buttonToggle[0].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[0].isChecked=!1),game.app.isShow(game.AppConstant.BACK_PANEL)?this._skin.buttonToggle[1].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[1].isChecked=!1),game.app.isShow(game.AppConstant.BIANSHEN_DETAILS_PANEL)?this._skin.buttonToggle[2].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[2].isChecked=!1),game.app.isShow(game.AppConstant.EQUIP_FORGE_PANEL)?this._skin.buttonToggle[3].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[3].isChecked=!1),game.app.isShow(game.AppConstant.GUILD_PANEL)?this._skin.buttonToggle[5].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[5].isChecked=!1),game.app.isShow(game.AppConstant.SHOP_PANEL)?this._skin.buttonToggle[6].isChecked=!0:(this._tabIndex=-1,this._skin.buttonToggle[6].isChecked=!1)},onClickDujieBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.JING_JIE)&&game.app.show(game.AppConstant.DUJIE_PANEL)},updateExp:function(){var e=game.mainRole.mainRoleData,t=e.getExp(),i=e.getLv(),n=game.ccfg.ExpCfg.getExpByLevel(i),s=t/n;this._skin.expProgress.progress=s,this._skin.labExp.string=t+"/"+n},onSpotAlertChange:function(){this._skin.charAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_ROLE_ALERT)||game.equip.isHighEquipSpotAlert()||game.ornament.checkShowAlert(),this._skin.equipAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_EQUIP_ALERT)||game.equip.isShowEnchantAlert,this._skin.relationAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_RELATION_ALERT),this._skin.guildAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_GUILD_ALERT),this._skin.shopAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_SHOP_ALERT),this._shapeAlert?this._skin.shapeAlert.active=this._shapeAlert:this._skin.shapeAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_SHAPE_ALERT)},onOrnamentRefreshAlert:function(){this.updateRoleAlert()},onEnchantAlertChange:function(){this._skin.equipAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_EQUIP_ALERT)||game.equip.isShowEnchantAlert},updateShowAlert:function(){this._skin.bagAlert.active=game.back.isShowEquipAlert||game.back.isShowItemAlert},updateRoleAlert:function(){this._skin.charAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_ROLE_ALERT)||game.equip.isHighEquipSpotAlert()||game.mountequip.isShowMountEquipAlert||game.ornament.checkShowAlert()},onShapeAlertChange:function(){this._shapeAlert=game.bianshen.getSpotAlertState(),this._skin.shapeAlert.active=this._shapeAlert},updateFightAmount:function(){if(game.dujie.dujieInfo){this._skin.dujie_lock.active=!1,this._progressEffect||(this._progressEffect=b8e.Animator.get(game.AnimatorType.DUJIE_PROGRESS,1),this._progressEffect.addToParent(this._skin.effect));var e=game.ClientCfg.getDujie("uifxs/10096");this._progressEffect.load(e),this._progressEffect.play();var t,i=game.mainRole.mainRoleData.getZhanLi(),n=0,s=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv);if(s&&this.dujieLvIcon&&s.IvIcon&&0<game.dujie.dujieInfo.lv&&this.dujieLvIcon.loadTexture(game.ClientCfg.getDujieLvIconUrl(s.IvIcon),null,null,{useManifest:!1}),0==game.dujie.dujieInfo.lv?0<s.conditions.length&&(n=i/s.conditions[0].Value):(t=game.ccfg.DujieCfg.getDataByLevel(game.dujie.dujieInfo.lv-1),0<s.conditions.length&&0<t.conditions.length&&(n=(i-t.conditions[0].Value)/(s.conditions[0].Value-t.conditions[0].Value))),1<=n){n=1,this._enoughEffect||(this._enoughEffect=b8e.Animator.get(game.AnimatorType.DUJIE_PROGRESS,2),this._enoughEffect.addToParent(this._skin.dujieBtn));e=game.ClientCfg.getDujie("uifxs/10098");this._enoughEffect.load(e),this._enoughEffect.play(null,0)}else this._enoughEffect&&this._enoughEffect.clear();this._progressEffect.y=this.maxHeight*(n-.5)}else game.funcOpen.checkOpen(game.FunctionType.JING_JIE)?(game.dujie.onRequestDujieinfo(),this._skin.dujie_lock.active=!1):this._skin.dujie_lock.active=!0},onPlayDujieEffect:function(){var e,t=game.ClientCfg.getUIFxs(10037);if(this._upCombatEffects||(this._upCombatEffects=[]),this._upCombatEffects.length<5)(e=b8e.Animator.get(game.AnimatorType.DUJIE_UP_COMBAT,this._effectIndex)).addToParent(this._skin.up_effect),this._upCombatEffects.push(e);else{var i=this._effectIndex%5;e=this._upCombatEffects[i]}this._effectIndex++,e.load(t),e.play(),e.setPosition(0,0);var n=this._skin.dujieBtn.x-this._skin.up_effect.x,s=this._skin.dujieBtn.y-this._skin.up_effect.y;b8e.Tween.get(e).to({x:n,y:s},500).call(this.tweenEnd,this,[e])},tweenEnd:function(e){e.setPosition(0,0),e.clear(),this._upCombatEffect2||(this._upCombatEffect2=b8e.Animator.get(game.AnimatorType.DUJIE_UP_COMBAT,10),this._upCombatEffect2.addToParent(this._skin.dujieBtn)),this._upCombatEffect2.setVisible(!0);var t=game.ClientCfg.getDujie("uifxs/10097");this._upCombatEffect2.load(t),this._upCombatEffect2.addFinishCallback(this.onCompleteEffect,this),this._upCombatEffect2.play(null,0)},onCompleteEffect:function(){this._upCombatEffect2.setVisible(!1)},onClickChat:function(){game.app.show(game.AppConstant.CHAT_PANEL)},onClickCharBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.ROLE)?(this.closeOtherPanel(game.AppConstant.ROLE_PANEL),this._tabIndex=0):(this._skin.buttonToggle[0].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},onClickBagBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.BACK_PACK)?(this.closeOtherPanel(game.AppConstant.BACK_PANEL),this._tabIndex=1):(this._skin.buttonToggle[1].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},onClickSkillBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.BIAN_SHEN)?(this.closeOtherPanel(game.AppConstant.BIANSHEN_DETAILS_PANEL),this._tabIndex=2):(this._skin.buttonToggle[2].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},onClickHomeBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_MAKE)?(this.closeOtherPanel(game.AppConstant.EQUIP_FORGE_PANEL),this._tabIndex=3):(this._skin.buttonToggle[3].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},onClickFriendBtn:function(){},onClickGuildBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.GUILD)?(this.closeOtherPanel(game.AppConstant.GUILD_PANEL),this._tabIndex=5):(this._skin.buttonToggle[5].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},onClickShopBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.SHOP)?(this.closeOtherPanel(game.AppConstant.SHOP_PANEL),this._tabIndex=6):(this._skin.buttonToggle[6].isChecked=!1,-1!=this._tabIndex&&(this._skin.buttonToggle[this._tabIndex].isChecked=!0))},closeOtherPanel:function(e){game.app.isShow(game.AppConstant.ROLE_PANEL)&&(e==game.AppConstant.ROLE_PANEL?game.app.showAppHideOtherApp(game.AppConstant.ROLE_PANEL):game.app.hide(game.AppConstant.ROLE_PANEL)),game.app.isShow(game.AppConstant.BACK_PANEL)&&(e==game.AppConstant.BACK_PANEL?game.app.showAppHideOtherApp(game.AppConstant.BACK_PANEL):game.app.hide(game.AppConstant.BACK_PANEL)),game.app.isShow(game.AppConstant.BIANSHEN_DETAILS_PANEL)&&(e==game.AppConstant.BIANSHEN_DETAILS_PANEL?game.app.showAppHideOtherApp(game.AppConstant.BIANSHEN_DETAILS_PANEL):game.app.hide(game.AppConstant.BIANSHEN_DETAILS_PANEL)),game.app.isShow(game.AppConstant.EQUIP_FORGE_PANEL)&&(e==game.AppConstant.EQUIP_FORGE_PANEL?game.app.showAppHideOtherApp(game.AppConstant.EQUIP_FORGE_PANEL):game.app.hide(game.AppConstant.EQUIP_FORGE_PANEL)),game.app.isShow(game.AppConstant.RELATION_PANEL)&&(e==game.AppConstant.RELATION_PANEL?game.app.showAppHideOtherApp(game.AppConstant.RELATION_PANEL):game.app.hide(game.AppConstant.RELATION_PANEL)),game.app.isShow(game.AppConstant.GUILD_PANEL)&&(e==game.AppConstant.GUILD_PANEL?game.app.showAppHideOtherApp(game.AppConstant.GUILD_PANEL):game.app.hide(game.AppConstant.GUILD_PANEL)),game.app.isShow(game.AppConstant.GUILD_TIP_PANEL)&&game.app.hide(game.AppConstant.GUILD_TIP_PANEL),game.app.isShow(game.AppConstant.SHOP_PANEL)&&(e==game.AppConstant.SHOP_PANEL?game.app.showAppHideOtherApp(game.AppConstant.SHOP_PANEL):game.app.hide(game.AppConstant.SHOP_PANEL)),game.app.isShow(e)||game.app.showAppHideOtherApp(e)},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0],1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._skin&&(this.x=b8e.stageWidth-this._skin.node.width>>1,this.y=0)}})},{}],496:[function(e,t,i){"use strict";game.MainMenuRight=game.SkinUI.extends({ctor:function(){this._super("mainui/MainMenuRightSkin","MainMenuRightSkin")},onShow:function(){this.onResize(),b8e.evt.onC(this._skin.fightNodes,this.onClickZiDonfZhanDouBtn,this),b8e.evt.addG(this,game.TrusteeshipEvent.AUTO_FIGHT_STATE_CHANGE,this.onAutoFightStateChange),this.onAutoFightStateChange()},onHide:function(){b8e.evt.offC(this._skin.fightNodes,this.onClickZiDonfZhanDouBtn,this),b8e.evt.rmvG(this,game.TrusteeshipEvent.AUTO_FIGHT_STATE_CHANGE,this.onAutoFightStateChange)},onAutoFightStateChange:function(){this._skin&&(this._skin.fightNodesOn.active=game.TrusteeshipMgr.inst().autoFight)},onClickZiDonfZhanDouBtn:function(){var e=game.SceneMgr.inst().getSceneConfig(),t=game.mainRole.mainRoleData,i=game.pkMode.lastPkMode;game.TrusteeshipMgr.inst().autoFight?(game.TrusteeshipMgr.inst().stop(),e.isField&&i&&t.pkMode!=i&&1==game.pkMode.pkModeInfo.getAvailableModesByMode(i)&&game.PkSender.swichPkModeRequest(i)):(game.TrusteeshipMgr.inst().start(),e.isField&&t.pkMode!=game.PkModeType.PEACE&&(game.pkMode.lastPkMode=t.pkMode,1==game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.PEACE)&&game.PkSender.swichPkModeRequest(game.PkModeType.PEACE)))},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth+e,this.y=230+t)}})},{}],497:[function(e,t,i){"use strict";game.MainMiddleLeft=game.SkinUI.extends({moduleName:"MAIN_MIDDLE_LEFT",max_width:66.3,_effect:null,_dujieanim:null,_timer:null,_activeBarItem:null,_rotateEffect:null,_rotateEffect2:null,_rotateEffect3:null,_rotateEffect4:null,_millioneffect:null,ctor:function(){this._super("mainui/MainMiddleLeftSkin","MainMiddleLeftSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_MIDDLE_LEFT",this)},getButtonByName:function(e){switch(e){case"dujie":return!0;case"btn_cardRecharge":return!this._skin||this._skin.btn_cardRecharge;case"btn_firstRecharge":return!this._skin||this._skin.btn_firstRecharge;case"btn_recharge":return!this._skin||this._skin.btn_recharge;case"btn_rank_node":return!this._skin||this._skin.btn_rank_node}return null},onShow:function(){this.initEffect(),this.onResize(),this.showModel(),this.hideFirstBtn(),this.updateActiveBarItem(),this.updateRechargeAlert(),b8e.evt.onC(this._skin.btn_vipShow,this.onClickVipShowBtn,this),b8e.evt.onC(this._skin.btn_recharge,this.onClickActivesBtn,this),b8e.evt.onC(this._skin.btn_cardRecharge,this.onClickCardRechargeBtn,this),b8e.evt.onC(this._skin.btn_firstRecharge,this.onClickFirstRechargeBtn,this),b8e.evt.onC(this._skin.dujieRecharge,this.onClickdujieRecharge,this),b8e.evt.onC(this._skin.millionIcon,this.onMillionAward,this),b8e.evt.onC(this._skin.btn_discountDaily,this.onClickDiscount,this),b8e.evt.addG(this,game.PayEvents.GET_FIRST_RECHARGE_AWARD_SUCCESS,this.hideFirstBtn),b8e.evt.addG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.hideFirstBtn),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.updateActiveBarItem),b8e.evt.addG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.initEffect),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.hideFirstBtn),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.hideFirstBtn),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.hideFirstBtn),b8e.evt.addG(this,game.PayEvents.UPDATE_DISCOUNT_BTN,this.hideFirstBtn),b8e.evt.addG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateRechargeAlert),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateRechargeAlert),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateVipShowBtn),b8e.evt.addG(this,game.PayEvents.COLLECT_CARD_AWARD_SUCCESS,this.updateRechargeAlert),b8e.evt.addG(this,game.PayEvents.COLLECT_AWARD_SUCCESS,this.updateRechargeAlert),b8e.evt.addG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.updateRechargeAlert),b8e.evt.addG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateRechargeAlert)},onHide:function(){b8e.evt.offC(this._skin.btn_vipShow,this.onClickVipShowBtn,this),b8e.evt.offC(this._skin.btn_recharge,this.onClickActivesBtn,this),b8e.evt.offC(this._skin.btn_cardRecharge,this.onClickCardRechargeBtn,this),b8e.evt.offC(this._skin.btn_firstRecharge,this.onClickFirstRechargeBtn,this),b8e.evt.offC(this._skin.dujieRecharge,this.onClickdujieRecharge,this),b8e.evt.offC(this._skin.millionIcon,this.onMillionAward,this),b8e.evt.offC(this._skin.btn_discountDaily,this.onClickDiscount,this),b8e.evt.rmvG(this,game.PayEvents.GET_FIRST_RECHARGE_AWARD_SUCCESS,this.hideFirstBtn),b8e.evt.rmvG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.hideFirstBtn),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.ActiveBarEvent.ACTIVE_BAR_CHANGE,this.updateActiveBarItem),b8e.evt.rmvG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.initEffect),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.hideFirstBtn),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.hideFirstBtn),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.hideFirstBtn),b8e.evt.rmvG(this,game.PayEvents.UPDATE_DISCOUNT_BTN,this.hideFirstBtn),b8e.evt.rmvG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateRechargeAlert),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateRechargeAlert),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateVipShowBtn),b8e.evt.rmvG(this,game.PayEvents.COLLECT_CARD_AWARD_SUCCESS,this.updateRechargeAlert),b8e.evt.rmvG(this,game.PayEvents.COLLECT_AWARD_SUCCESS,this.updateRechargeAlert),b8e.evt.rmvG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.updateRechargeAlert),b8e.evt.rmvG(this,game.ActiveEvent.COST_MAP_CHANGE,this.updateRechargeAlert)},initEffect:function(){game.shield.isShieldRecharge()||(this._rotateEffect||(this._rotateEffect=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._rotateEffect.setAnchor(.5,.5),this._rotateEffect.addToParent(this._skin.firstEffect)),this._rotateEffect2||(this._rotateEffect2=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._rotateEffect2.setAnchor(.5,.5),this._rotateEffect2.addToParent(this._skin.cardEffect)),this._rotateEffect3||(this._rotateEffect3=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._rotateEffect3.setAnchor(.5,.5),this._rotateEffect3.addToParent(this._skin.discountEffect)),this._rotateEffect4||(this._rotateEffect4=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._rotateEffect4.setAnchor(.5,.5),this._rotateEffect4.addToParent(this._skin.vipEffect)),this.addRotateEffect(game.RechargeType.FIRST_RECHARGE,this._rotateEffect),this.addRotateEffect(game.RechargeType.CARD_RECHARGE,this._rotateEffect2),this.addRotateEffect(game.RechargeType.DISCOUNT_RECHARGE,this._rotateEffect3),this.addRotateEffect(game.RechargeType.VIP_SHOW,this._rotateEffect4))},onSpotAlertChange:function(){this._skin.millionAlert.active=game.activeBar.getTypeIsAlert(game.ActiveBarItemType.MILLIONAWARD)},init:function(){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.effect_firstRecharge)),this._millioneffect||(this._millioneffect=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._millioneffect.setAnchor(.5,.5),this._millioneffect.setPosition(0,0),this._millioneffect.addToParent(this._skin.millionIcon))},updateRechargeAlert:function(){game.shield.isShieldRecharge()||(this._skin.cardRechargeAlert.active=game.pay.cardRechargeAlert(),this._skin.rechargeActivesAlert.active=1==game.pay.isAlertRechargeActive()||this.getActiveCostIsAlert())},getActiveCostIsAlert:function(){var e=!1;return game.active.hasActiveSubType(game.ActiveSubType.SINGLE_RECHARGE)&&(e=game.active.getTargetIsAlert(game.ActiveSubType.SINGLE_RECHARGE))||game.active.hasActiveSubType(game.ActiveSubType.ST_SINGLE_RECHARGE_2)&&(e=game.active.getTargetIsAlert(game.ActiveSubType.ST_SINGLE_RECHARGE_2))||game.active.hasActiveSubType(game.ActiveSubType.ST_SINGLE_RECHARGE_3)&&(e=game.active.getTargetIsAlert(game.ActiveSubType.ST_SINGLE_RECHARGE_3))||game.active.hasActiveSubType(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1)&&(e=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1))||game.active.hasActiveSubType(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2)&&(e=game.active.getTargetIsAlert(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2)),e},updateActiveBarItem:function(){if(!game.shield.isShieldRecharge()&&(this._activeBarItem||game.funcOpen.checkOpen(game.FunctionType.COMPETION_BTN)&&(this._activeBarItem=new game.ActiveBarItem,this._activeBarItem.addToParent(this._skin.btn_rank_node)),this._activeBarItem)){var e=game.active.getActiveBarInfo();e?(this._activeBarItem.setData(e),this._activeBarItem.show()):this._activeBarItem.hide()}},onClickVipShowBtn:function(){this.firstClickEffect(game.RechargeType.VIP_SHOW),game.app.show(game.AppConstant.VIP_SHOW_PANEL)},onClickActivesBtn:function(){game.app.show(game.AppConstant.RECHARGE_ACTIVE_PANEL)},onClickCardRechargeBtn:function(){this.firstClickEffect(game.RechargeType.CARD_RECHARGE),game.app.show(game.AppConstant.CARD_RECHARGE_PANEL)},onClickFirstRechargeBtn:function(){this.firstClickEffect(game.RechargeType.FIRST_RECHARGE),game.app.show(game.AppConstant.FIRST_RECHARGE_PANEL)},onClickdujieRecharge:function(){},onMillionAward:function(){game.activeBar.clickActive(game.ActiveBarItemType.MILLIONAWARD)},onClickDiscount:function(){this.firstClickEffect(game.RechargeType.DISCOUNT_RECHARGE),game.app.show(game.AppConstant.RECHARGE_ACTIVE_PANEL)},firstClickEffect:function(e){-1==game.pay.firstClickArr.indexOf(e)&&(game.pay.firstClickArr.push(e),this.initEffect())},addRotateEffect:function(e,t){t&&(game.pay.getIsShowEffect(e)?(t.load(game.ClientCfg.getUIFxs(10054)),t.play()):t.clear())},hideFirstBtn:function(){(this._skin.btn_vipShow.active=!1,this._skin.btn_recharge.active=!1,this._skin.btn_firstRecharge.active=!1,this._skin.btn_cardRecharge.active=!1,this._skin.btn_discountDaily.active=!1,game.shield.isShieldRecharge())||game.pay.isGetSeverData&&game.funcOpen.checkOpen(game.FunctionType.FIRST_RECHARGE)&&(this._skin.btn_recharge.active=!0,game.pay.getIsCollectedFirstRecharge()?(this.clearAnimator(),this._skin.btn_firstRecharge.active=!1,this.updateDiscountBtn(),game.funcOpen.checkOpen(game.FunctionType.CARD_RECHARGE)&&(this._skin.btn_cardRecharge.active=!0),this.updateVipShowBtn()):this._skin.btn_firstRecharge.active=!0)},updateDiscountBtn:function(){game.shield.isShieldRecharge()||(this._skin.btn_discountDaily.active=game.pay.isShowDiscount,game.pay.isShowDiscount?this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,1e3):this._timer&&this._timer.stop())},updateVipShowBtn:function(){game.shield.isShieldRecharge()||(this._skin.btn_vipShow.active=game.vip.isShowVipBtn())},updateTime:function(){var e=game.SysTime.curTime,t=b8e.TimeUtil.getNextDateTime(e,1)-e;this._skin.endTime.string=b8e.TimeUtil.formatTime(t)},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=530+t)},showModel:function(){var e;game.shield.isShieldRecharge()||((e=game.ClientCfg.getUIFxs("10018"))?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.FIRST_RECHARGE_EFFECT_2,1),this._sceneLayer.addChild(this._anim)),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear())},clearAnimator:function(){this._anim&&this._anim.stop()}})},{}],498:[function(e,t,i){"use strict";game.MainMiniMap=game.SkinUI.extends({moduleName:"MAIN_MINE_MAP",_mainCharSyncInfo:null,_scene:null,_sceneLayer:null,_mainChar:null,ctor:function(){this._super("mainui/MainMiniMapSkin","MainMiniMapSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_MINE_MAP",this)},getButtonByName:function(e){switch(e){case"sceneName":return!this._skin||this._skin.labSceneName.node}return null},onShow:function(){this.updateLine(),this.onResize(),b8e.evt.onC(this._skin.labSceneName.node,this.onClickSceneName,this),b8e.evt.onC(this._skin.labLine.node,this.onClickSceneName,this),b8e.evt.onC(this._skin.mapBg1,this.onClickSceneName,this),b8e.evt.onC(this._skin.prize,this.onPrizeBtn,this),b8e.evt.addG(this,game.SceneEvent.UPDATE_LINE,this.updateLine),b8e.evt.addG(this,game.SceneDesEvent.CHANGE_SCENE,this.onshowSceneDesc),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.onLoadSceneComplete)},onHide:function(){b8e.evt.offC(this._skin.labSceneName.node,this.onClickSceneName,this),b8e.evt.offC(this._skin.labLine.node,this.onClickSceneName,this),b8e.evt.offC(this._skin.mapBg1,this.onClickSceneName,this),b8e.evt.offC(this._skin.prize,this.onPrizeBtn,this),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_LINE,this.updateLine),b8e.evt.rmvG(this,game.SceneDesEvent.CHANGE_SCENE,this.onshowSceneDesc),b8e.evt.rmvG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.onLoadSceneComplete)},onPrizeBtn:function(){"ios_client"!=game.VERSION_NAME&&game.app.show(game.AppConstant.SCENE_PRIZE_DES_PANEL)},onLoadSceneComplete:function(){this.setVisibleState(!1),this.updateSceneName()},onshowSceneDesc:function(){this.setVisibleState(!0);var e=game.SceneDesMgr.inst();this._skin.prize_god.string=e.nowGold+"\n"+e.nowExp;var t=game.mainRole.mainRoleData,i=t.getExp(),n=t.getLv(),s=game.ccfg.ExpCfg.getExpByLevel(n),a="",o=0;0==e.nowExp?a="99+":a=99<=(o=(i<s?s-i:0)/e.nowExp)?"99+":o=o.toFixed(1);this._skin.prize_upgrade.string=a,this.updateSceneName()},setVisibleState:function(e){this._skin.mapBg2.active=e,this._skin.prize.active=e,this._skin.prize_god.node.active=e,this._skin.prize_upgrade.node.active=e,this._skin.mainPlayer.node.active=e},updateSceneName:function(){var e=game.SceneMgr.inst().getSceneConfig(),t="???";e&&(t=e.name),this._skin.labSceneName.string=t},updateLine:function(){var e=game.mainRole.mainRoleData;this._skin.labLine.string=e.line+"线"},onClickSceneName:function(e){this.showworldMapBtn()},showworldMapBtn:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.NORMAL:case game.SceneType.DUNGEON:case game.SceneType.WORLDBOSS:case game.SceneType.SURA:game.app.show(game.AppConstant.MAP_PANEL)}},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width+e,this.y=b8e.stageHeight-this.height+t)}})},{}],499:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.MainQuest=game.SkinUI.extends((s(n={_questInfo:null,_sceneLayer:null,_anim:null,_guildAnim:null,_prizeInfo:null,_orgPosY:65,_effect:null,_str1:"",_str2:"",_rewardName:"",_rewardNum:0,ctor:function(){this._super("mainui/MainQuestSkin","MainQuestSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_QUEST",this)},init:function(){this._orgPosY=this._skin.weakGuideNode.y},getButtonByName:function(e){switch(e){case"mail":return!this._skin||this._skin.mail_group;case"item":return!this._skin||this._skin.task_node;case"achievement":return!this._skin||this._skin.achievement}return null},onShow:function(){this.setQuestInfo(),this.autoQuest(),this.updateMailIcon(),this.onResize(),b8e.evt.onC(this._skin.btn_mail,this.onClickNewMail,this),b8e.evt.onC(this._skin.task_node,this.onClickQuest,this),b8e.evt.onC(this._skin.achievement,this.onClickAchievement,this),b8e.evt.onC(this._skin.auto_btn,this.onClickAuto,this),b8e.evt.addG(this,game.MailEvents.MAIL_UPDATE,this.updateMailIcon),b8e.evt.addG(this,game.MailEvents.MAIL_DEL_SUCCESS,this.updateMailIcon),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.onLoadSceneComplete),b8e.evt.addG(this,game.QuestEvents.AUTO_MAIN_QUEST,this.showAuto)},onHide:function(){this.clearAnimator(),b8e.Tween.kill(this),b8e.evt.offC(this._skin.btn_mail,this.onClickNewMail,this),b8e.evt.offC(this._skin.task_node,this.onClickQuest,this),b8e.evt.offC(this._skin.achievement,this.onClickAchievement,this),b8e.evt.offC(this._skin.auto_btn,this.onClickAuto,this),b8e.evt.rmvG(this,game.MailEvents.MAIL_UPDATE,this.updateMailIcon),b8e.evt.rmvG(this,game.MailEvents.MAIL_DEL_SUCCESS,this.updateMailIcon),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.onLoadSceneComplete),b8e.evt.rmvG(this,game.QuestEvents.AUTO_MAIN_QUEST,this.showAuto)}},"init",function(){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.img_complete)),this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACHIEVEMENT_EFFECT,100),this._effect.addToParent(this._skin.achievement),this._effect.setAnchor(.5,.5))}),s(n,"onLoadSceneComplete",function(){this.updateMailIcon()}),s(n,"_isPlayEffect",!1),s(n,"onSpotAlertChange",function(){var e=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_ACHIEVEMENT_ALERT);if(this._skin.achievementAlert.active=e){if(0==this._isPlayEffect){var t=game.ClientCfg.getUIFxs(10052);this._effect.load(t),this._effect.play(),this._skin.achievementIcon.active=!1,this._isPlayEffect=!0}}else this._isPlayEffect=!1,this._skin.achievementIcon.active=!0,this._effect.clear();var i=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_RELATION_ALERT);this._skin.img_red.active=0<game.mail.newMailCount||i}),s(n,"updateMailIcon",function(){var e=game.mail.newMailCount;this._skin.mail_num.string=e}),s(n,"onClickNewMail",function(){game.funcOpen.checkOpenWithTips(game.FunctionType.MAIL)&&game.app.show(game.AppConstant.RELATION_PANEL,2)}),s(n,"onClickAchievement",function(){game.app.show(game.AppConstant.ACHIEVEMENT_PANEL)}),s(n,"setQuestInfo",function(){this._questInfo=game.quest.questInfo,this._questInfo&&this._skin&&(this.updateQuestInfoByQuestType(this._questInfo.conditionType),this.setWeakGuide())}),s(n,"autoQuest",function(){game.quest.isOpenAuto?(this._skin.auto_btn.active=!0,game.quest.autoQuest(),this.showAuto()):this._skin.auto_btn.active=!1}),s(n,"updateQuestInfoByQuestType",function(e){this._skin.node.active=!0,this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeInfo.setupById(this._questInfo.dropId);var t,i=this._prizeInfo.getPrizeList();i&&0<i.length&&((t=game.ccfg.BianshenCfg.getBianshenCfgById(i[0].itemId))||(t=game.ccfg.ItemInfoCfg.getItemInfoById(i[0].itemId)),t&&(this._rewardName=t.name,this._rewardNum=i[0].num));switch(this._str1=game.html.getText(game.html.DESC_COLOR,this._questInfo.desc),this._str2="",e){case game.MainQuestType.ROLE_LV:case game.MainQuestType.ARENA_CHALLENGE:case game.MainQuestType.UPGRADE_EQUIP_SLOT:case game.MainQuestType.SMELT_EQUIP:case game.MainQuestType.RAFFLE:this._skin.lab_desc.string=game.ccfg.LangCfg.getText(18005,[this._questInfo.desc,this._questInfo.progress,this._questInfo.conditionParam1,this._rewardName,this._rewardNum]);break;case game.MainQuestType.KILL_MONSTER:case game.MainQuestType.KILL_SCENE_MONSTER:this._skin.lab_desc.string=game.ccfg.LangCfg.getText(18005,[this._questInfo.desc,this._questInfo.progress,this._questInfo.conditionParam2,this._rewardName,this._rewardNum]);break;case game.MainQuestType.COMPLETE_INSTANCE:case game.MainQuestType.TALK_WITH_NPC:case game.MainQuestType.COMPLETE_TYPE_INSTANCE:this._skin.lab_desc.string=game.ccfg.LangCfg.getText(18005,[this._questInfo.desc,this._questInfo.progress,1,this._rewardName,this._rewardNum]);break;default:this._skin.node.active=!1}this.isComplete()}),s(n,"showModel",function(){var e;(e=game.ClientCfg.getUIFxs("10003"))?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.MAIN_QUEST_COMPLETE_EFFECT,1),this._sceneLayer.addChild(this._anim)),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}),s(n,"clearAnimator",function(){this._anim&&this._anim.stop()}),s(n,"setWeakGuide",function(){if(this._skin.weakGuideNode.active=!1,this._questInfo){var e;e=this._questInfo.completed?game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.COMPLETE_TASK_WEAK_GUIDE_TIME):game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TASK_WEAK_GUIDE_TIME);var t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WEAK_GUIDE_MAX_LEVEL);game.mainRole.mainRoleData.getLv()<t&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(e).call(this.startWeakGuide))}}),s(n,"startWeakGuide",function(){this._skin&&(this._questInfo&&(1==this._questInfo.completed?this._skin.weakGuideLab.string=game.ccfg.LangCfg.getText(18003):this._skin.weakGuideLab.string=game.ccfg.LangCfg.getText(18004)),this._skin.weakGuideNode.y=this._orgPosY,this._skin.weakGuideNode.active=!0,b8e.Tween.kill(this._skin.weakGuideNode),b8e.Tween.get(this._skin.weakGuideNode,{loop:!0}).to({y:this._orgPosY+20},600).to({y:this._orgPosY},600))}),s(n,"isComplete",function(){if(this._questInfo)if(this._questInfo.completed){this._skin.img_complete.active=!0,this.showModel(),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeInfo.setupById(this._questInfo.dropId);var e,t=this._prizeInfo.getPrizeList();if(t&&0<t.length)(e=game.ccfg.BianshenCfg.getBianshenCfgById(t[0].itemId))||(e=game.ccfg.ItemInfoCfg.getItemInfoById(t[0].itemId)),e&&(this._rewardName=e.name,this._rewardNum=t[0].num);this._skin.lab_desc.string=game.ccfg.LangCfg.getText(18006,[this._questInfo.desc,this._rewardName,this._rewardNum])}else this._skin.img_complete.active=!1;else b8e.log("主线任务为空！！！")}),s(n,"onClickAuto",function(){var e=game.quest.isCanAuto;game.quest.isCanAuto=!e,game.quest.isAuto=!1,game.quest.isCanAuto?game.quest.startQuestTimer():game.quest.stopQuestTimer(),this.showAuto(),game.quest.autoQuest()}),s(n,"showAuto",function(){this._skin.btn_auto_select.active=game.quest.isCanAuto}),s(n,"onClickQuest",function(){this._questInfo&&(game.quest.onClickQuest(),1==this._questInfo.completed?this._skin.weakGuideNode.active=!1:this.setWeakGuide())}),s(n,"onResize",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=210+t,this._skin.task_node.x=b8e.stageWidth/2+e)}),n))},{}],500:[function(e,t,i){"use strict";game.MainRedPacket=game.SkinUI.extends({ctor:function(){this._super("mainui/MainRedPacketSkin","MainRedPacketSkin")},init:function(){this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.node_redPacket)},onShow:function(){this.onResize(),b8e.evt.onC(this._skin.node_redPacket,this.onClick,this),b8e.evt.addG(this,game.RedPacketEvents.RED_PACKET_UPDATE,this.updateNum),b8e.evt.addG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.updateNum),this.setData()},onHide:function(){this.clearAnimator(),b8e.evt.offC(this._skin.node_redPacket,this.onClick,this),b8e.evt.rmvG(this,game.RedPacketEvents.RED_PACKET_UPDATE,this.updateNum),b8e.evt.rmvG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.updateNum)},setData:function(){this.showModel(),this.updateNum()},onClick:function(){game.app.show(game.AppConstant.RED_PACKET_PANEL)},updateNum:function(){this._skin.lab_num.string=game.redPacket.redPacketNum},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this._skin.node.width+160>>1,this.y=310+e)},showModel:function(){var e;(e=game.ClientCfg.getUIFxs("10071"))?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.RED_PACKET_EFFECT,1),this._sceneLayer.addChild(this._anim)),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearAnimator:function(){this._anim&&this._anim.stop()}})},{}],501:[function(e,t,i){"use strict";game.MainTeam=game.SkinUI.extends({_anim:null,ctor:function(){this._super("mainui/MainTeamSkin","MainTeamSkin")},init:function(){},onShow:function(){if(this.onResize(),b8e.evt.onC(this._skin.teamIcon,this.onClick,this),b8e.evt.addG(this,game.TeamEvent.CHANGE_TEAMMEMBERS,this.updateNum),this.updateNum(),this._anim){var e=game.ClientCfg.getUIFxs("10053");this._anim.load(e),this._anim.play()}},onHide:function(){this._anim&&this._anim.clear(),b8e.evt.offC(this._skin.teamIcon,this.onClick,this),b8e.evt.rmvG(this,game.TeamEvent.CHANGE_TEAMMEMBERS,this.updateNum)},onClick:function(){game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.TEAM_BOSS)},updateNum:function(){var e=game.team.getRoomMembersCount();0==e?this.hide():this._skin.num.string=e},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-3*this._skin.node.width>>1,this.y=310+e)}})},{}],502:[function(e,t,i){"use strict";game.MainTop=game.SkinUI.extends({ctor:function(){this._super("mainui/MainTopSkin","MainTopSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_TOP",this)},getButtonByName:function(e){return null},onShow:function(){this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this._skin.bgNode),this._bgImg.setAnchor(.5,.5)),"ios_client"==game.VERSION_NAME?this._bgImg.loadTexture(game.ClientCfg.mainTopIosImgUrl,null,null,{useManifest:!1}):this._bgImg.loadTexture(game.ClientCfg.mainTopImgUrl,null,null,{useManifest:!1}),this.undateAmountInfo(),this.onResize(),b8e.evt.onC(this._skin.btn_recharge,this.onClickRechargeBtn,this),b8e.evt.onC(this._skin.btn_coverGold,this.onClickWelfareBtn,this),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.undateAmountInfo),b8e.evt.addG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.undateAmountInfo),b8e.evt.addG(this,game.SceneEvent.PING_CHANGE,this.pingChange)},onHide:function(){b8e.evt.offC(this._skin.btn_recharge,this.onClickRechargeBtn,this),b8e.evt.offC(this._skin.btn_coverGold,this.onClickWelfareBtn,this),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.undateAmountInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_SYN_BACK_INFO,this.undateAmountInfo),b8e.evt.rmvG(this,game.SceneEvent.PING_CHANGE,this.pingChange)},pingChange:function(){var e,t=game.SysTime.ping>>0;this._skin.pingRed.active=!1,this._skin.pingYellow.active=!1,this._skin.pingGreen.active=!1,t<100?(e=game.html.Q_GREEN,this._skin.pingGreen.active=!0):t<200?(e=game.html.LIGHT_YELLOW,this._skin.pingYellow.active=!0):(e=game.html.Q_RED,this._skin.pingRed.active=!0),this._skin.ping.string=game.html.getText(e,t+"ms")},undateAmountInfo:function(){var e=game.back.getAmountInfo();if(e){var t=e.getValue(game.AmountType.SILVER),i=e.getValue(game.AmountType.YUAN_BAO);this._skin.lab_gold.string=game.ValueUtil.formatNumber(t,0,!1,!1,!1,!1),this._skin.lab_yinbi.string=game.ValueUtil.formatNumber(i,0,!1,!1,!1,!1)}},onClickWelfareBtn:function(){game.shield.isShieldRecharge()||game.TriggerMgr.inst().customTriggerById(3118)},onClickRechargeBtn:function(){game.pay.showPayPanel()},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=b8e.stageHeight-this.height+t)}})},{}],503:[function(e,t,i){"use strict";game.MainTopLeft=game.SkinUI.extends({_headSprite:null,_vipSprite:null,_clickAgain:!1,_hpWidth:0,_timer:null,_locked:!1,ctor:function(){this._super("mainui/MainTopLeftSkin","MainTopLeftSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_TOP_LEFT",this),this._hpWidth=72},getButtonByName:function(e){switch(e){case"rank":return!this._skin||this._skin.btn_rank}return null},init:function(){0<this._skin.img_hp.width?this._hpWidth=this._skin.img_hp.width:this._hpWidth=72},onShow:function(){if(game.IS_HUO_SHU){var e=game.HuoShuSDK.getAppId(),t="2038"==e||"2066"==e;this._skin.btn_fanhui.active=t}this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this._skin.bgNode),this._bgImg.setAnchor(0,0)),"ios_client"==game.VERSION_NAME?this._bgImg.loadTexture(game.ClientCfg.mainTopbgIosImgUrl,null,null,{useManifest:!1}):this._bgImg.loadTexture(game.ClientCfg.mainTopbgImgUrl,null,null,{useManifest:!1}),this._locked=!1;var i=game.mainRole.mainRoleData;this._skin.btn_gm.active=i.gmPrivilege,this._skin.lab_gm.node.active=i.gmPrivilege,this.updateLv(),this.updatePlayerName(),this.updatePlayerHp(),this.updateVipLv(),this.updateFightAmount(),this.setHeadIcon(),this.onResize(),this.updateSoundState(),b8e.evt.onC(this._skin.img_head,this.onClickHead,this),b8e.evt.onC(this._skin.btn_gm,this.openGMPanel,this),b8e.evt.onC(this._skin.lab_gm.node,this.openGMPanel,this),b8e.evt.onC(this._skin.btn_rank,this.openRankPanel,this),b8e.evt.onC(this._skin.soundBtn,this.onClickSoundBtn,this),b8e.evt.onC(this._skin.btn_vip,this.onClickVipBtn,this),b8e.evt.onC(this._skin.btn_fanhui,this.onClickReturn,this),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.onC(this._skin.btn_strengthen,this.onClickStrengthenBtn,this),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateLv),b8e.evt.addG(this,game.RebirthEvent.UPGRAD_LEVEL_SUCCESS,this.updateLv),b8e.evt.addG(this,game.RebirthEvent.INIT_DATA,this.updateLv),b8e.evt.addG(this,game.ClientSettingType.AllSOUND,this.updateSoundState),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateVipLv),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateVipLv),b8e.evt.addG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.updatePlayerName),b8e.evt.addG(this,game.AttributesEvents.ATTR_UPDATA,this.updatePlayerHp),b8e.evt.addG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateVipAlert),b8e.evt.addG(this,game.VipEvents.RES_VIP_PRIZE_SUCCESS,this.updateVipAlert),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateVipAlert)},onHide:function(){b8e.evt.offC(this._skin.img_head,this.onClickHead,this),b8e.evt.offC(this._skin.btn_gm,this.openGMPanel,this),b8e.evt.offC(this._skin.lab_gm.node,this.openGMPanel,this),b8e.evt.offC(this._skin.btn_rank,this.openRankPanel,this),b8e.evt.offC(this._skin.soundBtn,this.onClickSoundBtn,this),b8e.evt.offC(this._skin.btn_strengthen,this.onClickStrengthenBtn,this),b8e.evt.offC(this._skin.btn_vip,this.onClickVipBtn,this),b8e.evt.offC(this._skin.btn_fanhui,this.onClickReturn,this),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateLv),b8e.evt.rmvG(this,game.RebirthEvent.INIT_DATA,this.updateLv),b8e.evt.rmvG(this,game.RebirthEvent.UPGRAD_LEVEL_SUCCESS,this.updateLv),b8e.evt.rmvG(this,game.ClientSettingType.AllSOUND,this.updateSoundState),b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateVipLv),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateVipLv),b8e.evt.rmvG(this,game.ClientSettingEvt.CHANGE_NAME_SUCCESS,this.updatePlayerName),b8e.evt.rmvG(this,game.AttributesEvents.ATTR_UPDATA,this.updatePlayerHp),b8e.evt.rmvG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateVipAlert),b8e.evt.rmvG(this,game.VipEvents.RES_VIP_PRIZE_SUCCESS,this.updateVipAlert),b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.updateVipAlert),this._vipSprite&&this._vipSprite.unloadTexture(),this._timer&&this._timer.stop(),this._locked=!1},onClickReturn:function(){if(game.IS_HUO_SHU){var e=game.HuoShuSDK.getAppId();if("2038"==e||"2066"==e){var t=new game.GameAlertInfo;t.alertType=game.GameAlertType.TwoBtn,t.string="是否返回至游戏大厅",t.isShowTips=!1,game.gameAlert.showAlert(this,this.onSwitchAccount,t)}}},onSwitchAccount:function(e,t){switch(t){case game.GameAlertBtnType.CONFIRM:game.IS_HUO_SHU&&game.HuoShuSDK.switchAccount()}},updateVipAlert:function(){this._skin.vipAlert.active=game.vip.vipAlert()},onClickVipBtn:function(){game.shield.isShieldRecharge()||(game.pay.isRechargePanel=!1,game.app.show(game.AppConstant.PAY_PANEL))},updateVipLv:function(){if(!game.shield.isShieldRecharge()){var e=game.vip.getVipLv();if(e<0)return;this._vipSprite||(this._vipSprite=b8e.Sprite.get(),this._vipSprite.setAnchor(.5,.5),this._vipSprite.setScale(.55,.55),this._vipSprite.addToParent(this._skin.vipNode));var t=game.ClientCfg.getVipImageUrlByLv(e);this._vipSprite.loadTexture(t,null,null,{useManifest:!1})}},updateSoundState:function(){game.setting.getSoundSelect()?this._skin.soundSelect.active=!1:this._skin.soundSelect.active=!0},onClickSoundBtn:function(){game.setting.controlAllSound(game.setting.getSoundSelect())},updateLv:function(){this._skin.lvLabel.string=game.rebirth.getSelfRebirthAndLv()},updateFightAmount:function(){var e=game.mainRole.mainRoleData.getZhanLi();e&&(this._skin.zhanliLabel.string=e)},updatePlayerName:function(){var e=game.mainRole.mainRoleData.getName();e&&(this._skin.nameLabel.string=e)},updatePlayerHp:function(){if(!this._locked){var e=game.mainRole.mainRoleData,t=e.spriteStat.getStatDataByType(game.SpriteStatType.HP),i=e.spriteStat.getStatDataByType(game.SpriteStatType.MAXHP);t&&i&&(this._skin.img_hp.width=this._hpWidth*(~~t.value/~~i.value)),this.setLockTime()}},setLockTime:function(){this._locked=!0,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateResetTime,1e3,1)},updateResetTime:function(){this._locked=!1},setHeadIcon:function(){var e=game.mainRole.mainRoleData.head,t=game.ccfg.HeadCfg.getbigIcon(e);if(this._headSprite||(this._headSprite=b8e.Sprite.get(),this._headSprite.setAnchor(.5,.5),this._headSprite.addToParent(this._skin.img_head)),""!=e){var i=game.ClientCfg.getHeadUrl(t);this._headSprite.loadTexture(i,null,null,{useManifest:!1})}else this._headSprite.unloadTexture()},onClickHead:function(){game.app.show(game.AppConstant.CLIENT_SETTING_PANEL)},onClickStrengthenBtn:function(){game.app.show(game.AppConstant.STRENGTHEN_PANEL)},openGMPanel:function(e){game.funcOpen.checkOpenWithTips(game.FunctionType.GM)&&game.app.show(game.AppConstant.GM_PANEL)},openRankPanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.RANK)&&game.app.show(game.AppConstant.RANK_PANEL)},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=b8e.stageHeight-this.height+t)},setStrengthenVisibel:function(e){this._skin&&(this._skin.btn_strengthen.active=e)}})},{}],504:[function(e,t,i){"use strict";game.MainTopRight=game.SkinUI.extends({moduleName:"MAIN_TOP_RIGHT",_loneyDungeonIsAlert:!1,ctor:function(){this._super("mainui/MainTopRightSkin","MainTopRightSkin"),game.CommandMgr.inst().registerSkinUI("MAIN_TOP_RIGHT",this)},getButtonByName:function(e){switch(e){case"challenge":return!this._skin||this._skin.challangeBtn;case"competition":return!this._skin||this._skin.arenaBtn;case"bossButton":return!this._skin||this._skin.bossBtn}return null},onShow:function(){this.onResize(),this._skin.notice.active=!1,this._loneyDungeonIsAlert=game.loneyDungeon.getLoneyDungeonIsAlert(),b8e.evt.onC(this._skin.challangeBtn,this.onClickChallangeBtn,this),b8e.evt.onC(this._skin.arenaBtn,this.onClickWanfaArenaBtn,this),b8e.evt.onC(this._skin.bossBtn,this.onClickBoss,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE,this.nationalBossRelive),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAlert),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateAlert),b8e.evt.addG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.updateAlert),this.onSpotAlertChange()},onHide:function(){b8e.Tween.kill(this),b8e.evt.offC(this._skin.challangeBtn,this.onClickChallangeBtn,this),b8e.evt.offC(this._skin.arenaBtn,this.onClickWanfaArenaBtn,this),b8e.evt.offC(this._skin.bossBtn,this.onClickBoss,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE,this.nationalBossRelive),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAlert),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateAlert),b8e.evt.rmvG(this,game.LoneyDungeonEvent.CUR_SELECT_PAGE_CHANGE,this.updateAlert)},onSpotAlertChange:function(){this._skin.challangeAlert.active=!!this._loneyDungeonIsAlert||game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_CHALLANGE_ALERT),this._skin.arenaAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_WANFA_ARENA_ALERT),this._skin.bossAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_DAILY_ALERT)},updateAlert:function(){this._loneyDungeonIsAlert=game.loneyDungeon.getLoneyDungeonIsAlert()},onClickChallangeBtn:function(){game.app.show(game.AppConstant.CHALLANGE_PANEL)},onClickWanfaArenaBtn:function(){game.app.show(game.AppConstant.WANFA_ARENA_PANEL)},onClickBoss:function(){game.app.show(game.AppConstant.DUNGEON_PANEL)},nationalBossRelive:function(e){if(e&&e.data){var t=e.data.sceneId,i=game.nationalBoss.getBossInfoBySceneId(t);if(i)if(i.notifyState)if(!(game.mainRole.mainRoleData.getLv()<i.unlockLevel)){var n=game.ccfg.NationalBossCfg.getNationalBossById(t);n&&(this._skin.notice.active=!0,this._skin.lab_notice.string=n.name,b8e.Tween.kill(this),b8e.Tween.get(this).wait(5e3).call(this.updateBossName,this))}}},updateBossName:function(){this._skin.notice.active=!1},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width,this.y=530+e)}})},{}],505:[function(e,t,i){"use strict";game.MainTransferNotice=game.SkinUI.extends({_anim:null,ctor:function(){this._super("mainui/MainTransferNoticeSkin","MainTransferNoticeSkin")},getButtonByName:function(e){switch(e){case"transferNotice":return!this._skin||this._skin.transferNoticeBtn}return null},init:function(){this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.TRANSFER,100),this._anim.addToParent(this._skin.transferNoticeBtn),this._anim.setAnchor(.5,.5))},onShow:function(){this.onResize(),b8e.evt.onC(this._skin.transferNoticeBtn,this.onClick,this),b8e.evt.addG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.updateNum),b8e.evt.addG(this,game.TransferNoticeEvents.DEL_TRANSGER,this.updateNum),this.setData();var e=game.ClientCfg.getUIFxs("10053");this._anim&&(this._anim.load(e),this._anim.play())},onHide:function(){this._anim&&this._anim.clear(),b8e.evt.offC(this._skin.transferNoticeBtn,this.onClick,this),b8e.evt.rmvG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.updateNum),b8e.evt.rmvG(this,game.TransferNoticeEvents.DEL_TRANSGER,this.updateNum)},setData:function(){this.updateNum()},onClick:function(){game.app.show(game.AppConstant.TRANSFER_NOTICE_PANEL)},updateNum:function(){var e=game.transferNotice.getNoticeCount();0==e?this.hide():this._skin.num.string=e},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this._skin.node.width>>1,this.y=310+e)}})},{}],506:[function(e,t,i){"use strict";game.ScoreItem=game.SkinUI.extends({_rankInfo:null,ctor:function(){this._super("mainui/ScoreItemSkin","ScoreItemSkin")},getWidth:function(){return 200},getHeight:function(){return 20},onShow:function(){this.setData(this._rankInfo)},onHide:function(){},setData:function(e){if(this._rankInfo=e,this._skin&&this._rankInfo){var t;switch(this._rankInfo.rank){case 1:t=game.html.Q_YELLOW;break;case 2:t=game.html.Q_PURPLE;break;case 3:t=game.html.Q_BLUE;break;default:t=game.html.Q_WHITE}this._skin.labRank.string=this._rankInfo.rank,game.tianGong.isCrossServer?this._skin.labName.string=this._rankInfo.name2+".s"+this._rankInfo.zone:this._skin.labName.string=this._rankInfo.name2,this._skin.labNum.string=this._rankInfo.score,this._skin.labRank.node.color=b8e.ColorUtil.toCCColor(t),this._skin.labName.node.color=b8e.ColorUtil.toCCColor(t),this._skin.labNum.node.color=b8e.ColorUtil.toCCColor(t),this._skin.imgSelect.active=!1}}})},{}],507:[function(e,t,i){"use strict";game.ScoreTrackBar=game.SkinUI.extends({_curSceneId:0,_selfRankOldY1:40,_selfRankOldY2:142,ctor:function(){this._super("mainui/ScoreSkin","ScoreSkin")},onShow:function(){this.onResize(),this._list||(this._list=new b8e.List(this._skin.list,game.ScoreItem)),this._list.show(),this.offPanel(),this.updateInfo(),this.updateSelfGuildRankInfo(),this.updateSelfScore(),b8e.evt.onC(this._skin.btn_on,this.openPanel,this),b8e.evt.onC(this._skin.btn_off,this.offPanel,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_GUILD_RANK,this.updateInfo),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_GUILD_RANK,this.updateSelfGuildRankInfo),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_SCORE,this.updateSelfScore)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_on,this.openPanel,this),b8e.evt.offC(this._skin.btn_off,this.offPanel,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_GUILD_RANK,this.updateInfo),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_GUILD_RANK,this.updateSelfGuildRankInfo),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_SCORE,this.updateSelfScore)},openPanel:function(){this._skin.btn_on.active=!1,this._skin.btn_off.active=!0,this._skin.rankNode.active=!0,this._skin.selfRankNode.active=!0,this._skin.selfRankNode.y=this._selfRankOldY1},offPanel:function(){this._skin.btn_on.active=!0,this._skin.btn_off.active=!1,this._skin.rankNode.active=!1,this._skin.selfRankNode.active=!0,this._skin.selfRankNode.y=this._selfRankOldY2},updateInfo:function(){var e=game.tianGong.getRanks();this._list.setData(e)},updateSelfGuildRankInfo:function(){var e=game.tianGong.getSelfGuildRank();if(e)this._skin.labRank.string=0==e.rank?"无":e.rank,this._skin.labName.string=e.name2,this._skin.labNum.string=0==e.score?"无":e.score;else{this._skin.labRank.string="无";var t=game.mainRole.mainRoleData;this._skin.labName.string=t.guildName,this._skin.labNum.string="无"}},updateSelfScore:function(){var e=game.tianGong.selfScore;this._skin.labNum2.string=e},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width,this.y=b8e.stageHeight-this.height-130-e)}})},{}],508:[function(e,t,i){"use strict";game.ShapeBar=game.SkinUI.extends({_isSelected:!1,_battleSlotLists:null,_protoId1:0,_protoId2:0,_protoId3:0,ctor:function(){this._super("mainui/ShapeSkin","ShapeSkin"),game.CommandMgr.inst().registerSkinUI("SHAPE",this),this._battleSlotLists=[]},getGridByName:function(e){var t,i;switch(e){case"grid0":return!this._battleSlotLists||!(t=this._battleSlotLists[0])||t;case"grid1":return!this._battleSlotLists||!(t=this._battleSlotLists[1])||t;case"grid2":return!this._battleSlotLists||!(t=this._battleSlotLists[2])||t;case"gridHasBianshen":return i=game.bianshen.getHasBianshenSlotIndex(),!this._battleSlotLists||null==i||!(t=this._battleSlotLists[i])||t;case"otherBianshen":return 0<(i=game.bianshen.getEmptyBattleSlot())?this._battleSlotLists[i-1]:this._battleSlotLists[0]}return null},show:function(){(game.PlotMgr.inst().isPlaying()?b8e.layer.getTopLayer():b8e.layer.getGuiLayer()).addChild(this),this._super()},onShow:function(){this.setSlot(),this.onResize(),b8e.evt.addG(this,game.BianshenEvent.START_BIANSHEN,this.setTick),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updateSlotByIndex),b8e.evt.addG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.updateSlotByIndex),b8e.evt.addG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.unlockSlot),b8e.evt.addG(this,game.BianshenEvent.SET_BIANSHEN_SLOT,this.setSlot),b8e.evt.addG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateSlot)},onHide:function(){this.clearGrid(),b8e.evt.rmvG(this,game.BianshenEvent.START_BIANSHEN,this.setTick),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updateSlotByIndex),b8e.evt.rmvG(this,game.BianshenEvent.OFF_BATTLE_SLOT,this.updateSlotByIndex),b8e.evt.rmvG(this,game.BianshenEvent.UPDATE_LOCK_SLOT_STATUS,this.unlockSlot),b8e.evt.rmvG(this,game.BianshenEvent.SET_BIANSHEN_SLOT,this.setSlot),b8e.evt.rmvG(this,game.BianshenEvent.SWAP_BIANSHEN,this.updateSlot)},setSlot:function(){var e=game.bianshen.getBattleSlots();this.setSlotInfos(e)},setSlotInfos:function(e){var t,i;if(this.clearGrid(),e&&0<e.length)for(var n=0;n<e.length;n++)(i=e[n])&&((t=this._battleSlotLists[n])?t.setBianshenSlotData(i):((t=game.BianshenSlotGrid.get(i,!0,game.IconType.BianshenSlotSkin,game.ContainerId.BIANSHEN_SLOT_CONTAINER_ID)).addToParent(this._skin.slots),t.setSize(79,79),t.setPosition(97*n,0),this._battleSlotLists.push(t)),t.setVisible(i.isUnlocked))},unlockSlot:function(){this.setSlot()},setTick:function(e){if(e&&e.data){var t=game.bianshen.getBattleSlots();if(t&&!(t.length<=0))for(var i=0;i<t.length;i++){if(t[i].bianshenId==e.data.id){var n=this._battleSlotLists[i];n&&n.tick()}}}},updateSlotByIndex:function(e){if(e&&e.data){var t=game.bianshen.getBattleSlots();if(t&&0<t.length)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.index==e.data.slotIndex){var s=this._battleSlotLists[i];s&&s.setBianshenSlotData(n)}}}},updateSlot:function(){var e=game.bianshen.getBattleSlots();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._battleSlotLists[t];n&&n.setBianshenSlotData(i)}}},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=45+(b8e.stageWidth>>1)+e,this.y=115+t)},clearGrid:function(){if(this._battleSlotLists&&!(this._battleSlotLists.length<=0))for(var e=0;e<this._battleSlotLists.length;e++){var t=this._battleSlotLists[e];t&&t.setVisible(!1)}}})},{}],509:[function(e,t,i){"use strict";game.TianGongIcon=game.SkinUI.extends({_effectDisplay:null,_anim:null,ctor:function(){this._super("mainui/TianGongIconSkin","TianGongIconSkin")},onShow:function(){this.onResize(),this._effectDisplay||(this._effectDisplay=b8e.BaseDisplay.get(),this._effectDisplay.addToParent(this._skin.effect)),this.updateInfo(),b8e.evt.onC(this._skin.icon,this.onOpenPanel,this)},onRefresh:function(){this.updateInfo()},onHide:function(){this.clearEffect(),b8e.evt.offC(this._skin.icon,this.onOpenPanel,this)},updateInfo:function(){this._skin.lab_state.string="",this.clearEffect();var e=game.tianGong.getTGInfoByIsCS(!1),t=game.tianGong.getRemainDay(!1),i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TIAN_GONG_OPEN_TIME);switch(t){case 0:e&&e.isOpen?(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11023),this.playEffect()):this._skin.lab_state.string=game.ccfg.LangCfg.getText(11020,[i]);break;case 1:this._skin.lab_state.string=game.ccfg.LangCfg.getText(11021,[i]);break;case 2:this._skin.lab_state.string=game.ccfg.LangCfg.getText(11022,[i])}},playEffect:function(){var e=game.ClientCfg.getUIFxs("10054");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.TIAN_GONG_ICON_EFFECT,1),this._effectDisplay.addChild(this._anim)),this._effectDisplay.setVisible(!0),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._effectDisplay&&this._effectDisplay.setVisible(!1)},onOpenPanel:function(){game.app.show(game.AppConstant.TIAN_GONG_PANEL)},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width+20,this.y=450-this.height+e+5)}})},{}],510:[function(e,t,i){"use strict";game.TianGongSanJieIcon=game.SkinUI.extends({_effectDisplay:null,_anim:null,ctor:function(){this._super("mainui/TianGongSanJieIconSkin","TianGongSanJieIconSkin")},onShow:function(){this.onResize(),this._effectDisplay||(this._effectDisplay=b8e.BaseDisplay.get(),this._effectDisplay.addToParent(this._skin.effect)),this.updateInfo(),b8e.evt.onC(this._skin.icon,this.onOpenPanel,this)},onRefresh:function(){this.updateInfo()},onHide:function(){this.clearEffect(),b8e.evt.offC(this._skin.icon,this.onOpenPanel,this)},updateInfo:function(){this._skin.lab_state.string="",this.clearEffect();var e=game.tianGong.getTGInfoByIsCS(!0),t=game.tianGong.getRemainDay(!0),i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CS_TIAN_GONG_OPEN_TIME);switch(t){case 0:e&&e.isOpen?(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11023),this.playEffect()):this._skin.lab_state.string=game.ccfg.LangCfg.getText(11020,[i]);break;case 1:this._skin.lab_state.string=game.ccfg.LangCfg.getText(11021,[i]);break;case 2:this._skin.lab_state.string=game.ccfg.LangCfg.getText(11022,[i])}},playEffect:function(){var e=game.ClientCfg.getUIFxs("10054");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.TIAN_GONG_SAN_JIE_ICON_EFFECT,1),this._effectDisplay.addChild(this._anim)),this._effectDisplay.setVisible(!0),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._effectDisplay&&this._effectDisplay.setVisible(!1)},onOpenPanel:function(){game.TianGongSender.reqTianGongInfo(!0)},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width+20,this.y=450-this.height+e+5)}})},{}],511:[function(e,t,i){"use strict";game.TianGongTracBar=game.SkinUI.extends({TOTAL_PROGRESS:204,_curSceneId:0,_battleInfo:null,_robTimeObj:null,_collectEndTime:0,_isSelfGuild:!1,_isCollector:!1,_anim:null,_nanTianMenSceneId:0,_lingXiaoDianSceneId:0,_csNanTianMenSceneId:0,_csLingXiaoDianSceneId:0,ctor:function(){this._super("mainui/TianGongTracBarSkin","TianGongTracBarSkin")},onShow:function(){this.onResize(),this._skin.tiangong_yuxi.active=!game.tianGong.isCrossServer,this._skin.sjzb_ds.active=game.tianGong.isCrossServer,this.onShowTrackInfo(),b8e.evt.onC(this._skin.btn_sh,this.onClickSH,this),b8e.evt.onC(this._skin.btn_gj,this.onClickGJ,this),b8e.evt.onC(this._skin.btn_qd,this.onClickQD,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_SCORE,this.updateNanTianMenInfo),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SYNC_BATTLE_INFO,this.onSyncBattleInfo)},onHide:function(){this._robTimeObj&&(b8e.Timer.remove(this,this.updateRobTime),this._robTimeObj=null),b8e.evt.offC(this._skin.btn_sh,this.onClickSH,this),b8e.evt.offC(this._skin.btn_gj,this.onClickGJ,this),b8e.evt.offC(this._skin.btn_qd,this.onClickQD,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_SELF_SCORE,this.updateNanTianMenInfo),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SYNC_BATTLE_INFO,this.onSyncBattleInfo)},onShowTrackInfo:function(){switch(this._curSceneId=game.SceneMgr.inst().sceneId,this._nanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._lingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._csNanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._csLingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._curSceneId){case this._nanTianMenSceneId:case this._csNanTianMenSceneId:this.updateNanTianMenInfo();break;case this._lingXiaoDianSceneId:case this._csLingXiaoDianSceneId:this.updateLingXiaoDiannInfo()}},updateNanTianMenInfo:function(){if(this._curSceneId=game.SceneMgr.inst().sceneId,this._nanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._lingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._csNanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._csLingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._curSceneId==this._nanTianMenSceneId||this._curSceneId==this._csNanTianMenSceneId){this.uiShowState(!1),this.playEffect();var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NEED_SCORE),t=game.tianGong.selfScore;this._skin.lab_state.string=game.ccfg.LangCfg.getText(11013,[t,e])}else this.clearEffect(),this._skin.lab_desc.node.active=!1},playEffect:function(){var e=game.ClientCfg.getUIFxs("10076");e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.TIAN_GONG_TRACK_BAR_EFFECT,1),this._anim.addToParent(this._skin.effect)),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.clear()},updateLingXiaoDiannInfo:function(){this.uiShowState(!0),this.clearEffect(),this.onSyncBattleInfo()},uiShowState:function(e){this._skin.btn_sh.active=e,this._skin.btn_gj.active=e,this._skin.btn_qd.active=e,this._skin.progressBar.node.active=e,this._skin.lab_desc.node.active=!e},onSyncBattleInfo:function(){if(this._curSceneId=game.SceneMgr.inst().sceneId,this._nanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._lingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._csNanTianMenSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID),this._csLingXiaoDianSceneId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID),this._curSceneId!=this._nanTianMenSceneId&&this._curSceneId!=this._csNanTianMenSceneId&&(this.clearEffect(),this._skin.lab_desc.node.active=!1,this._battleInfo=game.tianGong.getTianGongBattleInfo(),this._battleInfo))switch(this._battleInfo.state){case 0:this.resetCollectState(),this.onShowRobTime();break;case 1:this._robTimeObj&&this._robTimeObj.stop(),this.resetCollectState(),this.onUpdateOccupyInfo();break;case 2:this.onUpdateCollectorInfo()}},onShowRobTime:function(){this._robTimeObj||(this._robTimeObj=b8e.Timer.add(this,this.updateRobTime,1e3)),this._robTimeObj.reset(),this._robTimeObj.start()},updateRobTime:function(){var e=game.SysTime.curTime,t=~~((this._battleInfo.collectionOpenTime-e)/1e3);t<0?(b8e.Timer.remove(this,this.updateRobTime),this._robTimeObj=null,this._skin.btn_sh.active=!1,this._skin.btn_gj.active=!1,this._skin.btn_qd.active=!0,this._skin.progressBar.node.active=!1):this._skin.lab_state.string=game.ccfg.LangCfg.getText(11015,[t])},onUpdateOccupyInfo:function(){if(this._battleInfo&&this._battleInfo.guildInfo)return 0==this._battleInfo.guildInfo.id?(this._skin.btn_sh.active=!1,this._skin.btn_gj.active=!1,this._skin.btn_qd.active=!0,this._skin.progressBar.node.active=!1,void(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11014))):(game.guild.isSelfGuildById(this._battleInfo.guildInfo.id)?(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11016,[this._battleInfo.guildInfo.name]),this._skin.btn_sh.active=!0,this._skin.btn_gj.active=!1,this._skin.btn_qd.active=!1):(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11017,[this._battleInfo.guildInfo.name]),this._skin.btn_sh.active=!1,this._skin.btn_gj.active=!1,this._skin.btn_qd.active=!0),void(this._skin.progressBar.node.active=!1))},onUpdateCollectorInfo:function(){if(this._battleInfo&&this._battleInfo.collector){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_COLLECT_TIME),t=this._battleInfo.collector.startTime+e,i=Math.ceil(t-game.SysTime.curTime);if(!(i<0))game.mainRole.mainRoleData.playerId==this._battleInfo.collector.roleId&&game.collect.show(game.CollectId.TIAN_GONG_COLLECT_ID,i,!0),this._skin.progressBar.node.active=!0,this._isSelfGuild=game.guild.isSelfGuildById(this._battleInfo.collector.guildId),this._isCollector=game.tianGong.isCollector(),b8e.Tween.kill(this._skin.bar),b8e.Tween.get(this._skin.bar,{onUpdate:this.onUpdateFunc,onUpdateThis:this}).to({width:this.TOTAL_PROGRESS},i).call(this.onCompleteFunc,this)}},onUpdateFunc:function(){var e=game.ValueUtil.getDigitsValueByNum(this._skin.bar.width/this.TOTAL_PROGRESS*100,0);this._isSelfGuild?(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11018,[this._battleInfo.collector.name,e]),this._skin.btn_sh.active=!0,this._skin.btn_gj.active=!1):(this._skin.lab_state.string=game.ccfg.LangCfg.getText(11019,[this._battleInfo.collector.name,e]),this._skin.btn_sh.active=!1,this._skin.btn_gj.active=!0),this._skin.btn_qd.active=!1,this._isCollector&&(this._skin.btn_sh.active=!1,this._skin.btn_gj.active=!1,this._skin.btn_qd.active=!1)},onCompleteFunc:function(){},resetCollectState:function(){b8e.Tween.kill(this._skin.bar),this._skin.bar.width=0},onClickSH:function(){game.tianGong.moveToTarget()},onClickQD:function(){game.tianGong.collect()},onClickGJ:function(){if(this._battleInfo&&this._battleInfo.collector){var e=game.sceneRole.getDisplayById(this._battleInfo.collector.unitId);e?game.ScenePickMgr.inst().pickTarget(e):this.onClickQD()}},onResize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0,this.y=b8e.stageHeight-this.height-130-e)}})},{}],512:[function(e,t,i){"use strict";e("./MainGUI"),e("./MainMenu"),e("./MainQuest"),e("./MainTopLeft"),e("./ShapeBar"),e("./MainMenuRight"),e("./MainActivity"),e("./MainMiniMap"),e("./MainTopRight"),e("./MainTransferNotice"),e("./TianGongTracBar"),e("./ScoreItem"),e("./ScoreTrackBar"),e("./TianGongIcon"),e("./TianGongSanJieIcon")},{"./MainActivity":493,"./MainGUI":494,"./MainMenu":495,"./MainMenuRight":496,"./MainMiniMap":498,"./MainQuest":499,"./MainTopLeft":503,"./MainTopRight":504,"./MainTransferNotice":505,"./ScoreItem":506,"./ScoreTrackBar":507,"./ShapeBar":508,"./TianGongIcon":509,"./TianGongSanJieIcon":510,"./TianGongTracBar":511}],513:[function(e,t,i){"use strict";game.MainQuestAwardMgr=b8e.Object.extends({name:"MainQuestAwardMgr",_mapQuestData:null,ctor:function(){if(1==game.MainQuestAwardMgr._singleton)throw new Error("MainQuestAwardMgr 只能通过单例方法获取");this._super(),this._mapQuestData=b8e.HashMap.get(),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuestNotify),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete)},onMainQuestNotify:function(){this.categoricalData(),game.QuestSender.reqProgressAwardState(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuestNotify)},onMainQuestComplete:function(){var i,n=game.quest.questInfo;n&&this._mapQuestData.forEach(function(e,t){(i=t.ids)&&0<i.length&&-1!=i.indexOf(n.id)&&t.complete++},this)},onProgressAwardState:function(e){this.calAwardState(e),b8e.evt.dptG(game.QuestEvents.MAIN_QUEST_AWARD)},reqProgressAward:function(e){game.QuestSender.reqProgressAward(e)},onProgressAward:function(e){this.calAwardState(e),b8e.evt.dptG(game.QuestEvents.MAIN_QUEST_AWARD)},calAwardState:function(e){if(this.mapQuestData){var t=this.mapQuestData.values();if(t&&!(t.length<=0))for(var i,n,s=t.length,a=0;a<s;a++)i=(i=e)>>(n=t[a]).index-1&1,n.isGet=1==i?1:0}},categoricalData:function(){var e=game.ccfg.MainQuestCfg.data?game.ccfg.MainQuestCfg.data.values():null;if(e){var t,i;e.sort(function(e,t){return e.sequence-t.sequence});for(var n=1,s=0,a=0,o=[],r=game.quest.questInfo?game.quest.questInfo.sequence:0,h=0;h<e.length;h++)if((i=e[h])&&(a=i.sequence<r?a+1:a,s++,o.push(i.id),i.awardId)){if(!i.nameRes||!i.bgRes){a=s=0;continue}t={index:n,count:s,complete:a,sceneId:i.transMapId,id:i.id,awardId:i.awardId,nameRes:i.nameRes,bgRes:i.bgRes,isGet:0,ids:o},this._mapQuestData.set(t.index,t),n++,a=s=0,o=[]}}},mapQuestData:{get:function(){return this._mapQuestData}},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MAINQUEST_AWARD_ALERT,null,this.awardAlert,this)},awardAlert:function(){var e,t=this.mapQuestData.values();if(!t)return!1;for(var i=0;i<t.length;i++)if(!(e=t[i]).isGet&&e.complete==e.count)return!0;return!1}}),game.MainQuestAwardMgr._instance=null,game.MainQuestAwardMgr._singleton=!0,game.MainQuestAwardMgr.inst=function(){return game.MainQuestAwardMgr._instance||(game.MainQuestAwardMgr._singleton=!1,game.MainQuestAwardMgr._instance=new game.MainQuestAwardMgr,game.MainQuestAwardMgr._singleton=!0),game.MainQuestAwardMgr._instance}},{}],514:[function(e,t,i){"use strict";game.MainQuestAwardItem=game.SkinUI.extends({_data:null,_prizeInfo:null,_questBg:null,_questName:null,_maskWidth:0,_effect:null,ctor:function(e){this._super("mainQuestAward/MainQuestAwardItem","MainQuestAwardItemSkin"),this._data=e},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(1,game.IcoSizeEnum.SIZE_100,game.IcoSizeEnum.SIZE_100,game.IconScale.PERCENT_100,1),this._prizeList.containerId=game.ContainerId.TOWER_NOTICE_ID,this._prizeList.setPosition(0,0),this._prizeList.addToParent(this._skin.prize_node),this._questBg=b8e.Sprite.get(),this._questBg.addToParent(this._skin.img_bg),this._questName=b8e.Sprite.get(),this._questName.addToParent(this._skin.img_name),this._maskWidth=this._skin.mask_node.width},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.btn_prize,this.onClickPrize,this),b8e.evt.onC(this._skin.btn_goto,this.onGoto,this)},onHide:function(){this._questBg&&this._questBg.unloadTexture(),this._questName&&this._questName.unloadTexture(),b8e.evt.offC(this._skin.btn_goto,this.onGoto,this),b8e.evt.offC(this._skin.btn_prize,this.onClickPrize,this),this.clearEffect()},setData:function(e){if(this._data=e,this._skin&&this._data){e.bgRes&&""!=e.bgRes&&this._questBg.loadTexture(game.ClientCfg.getImgUrl(e.bgRes,!0),null,null,{useManifest:!1}),e.nameRes&&""!=e.nameRes&&this._questName.loadTexture(game.ClientCfg.getImgUrl(e.nameRes),null,null,{useManifest:!1});var t=e.complete/e.count;if(t=t<=1?t:1,this._skin.mask_node.width=this._maskWidth*t,this._skin.lb_progress.string=e.complete+"/"+e.count,this.createPrize(e.awardId),this._skin.node_select.active=e.isGet,this._data.isGet||this._data.complete!=this._data.count)this.clearEffect(),this._skin.btn_prize.active=!1;else{this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ITEM_EFFECT,1),this._effect.addToParent(this._skin.prize_node));var i=game.ClientCfg.getUIFxs("10009");this._effect.setPosition(50,-50),this._effect.load(i),this._effect.play(),this._skin.btn_prize.active=!0}this._data.sceneId?this._skin.btn_goto.active=!0:this._skin.btn_goto.active=!1}},clearEffect:function(){this._effect&&this._effect.clear()},createPrize:function(e){this._prizeInfo.setupById(e),this._prizeInfo&&this._prizeList.setData(this._prizeInfo)},onClickPrize:function(){this._data&&(0<this._data.isGet||this._data.complete==this._data.count&&game.questAward.reqProgressAward(this._data.index))},onGoto:function(){if(this._data)if(this._data.sceneId!=game.SceneMgr.inst().sceneId){var e=game.ccfg.SceneCfg.getDataById(this._data.sceneId);if(e)game.mainRole.mainRoleData.getLv()>=e.unlocklevel?(game.app.isShow(game.AppConstant.ACHIEVEMENT_PANEL)&&game.app.hide(game.AppConstant.ACHIEVEMENT_PANEL),game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,this._data.sceneId),game.quest.changeAuto(!1)):game.notice.show(game.ccfg.LangCfg.getText(79100))}else game.notice.show(game.ccfg.LangCfg.getText(79101))},getHeight:function(){return 144},getWidth:function(){return 543}})},{}],515:[function(e,t,i){"use strict";game.MainQuestAwardPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("mainQuestAward/MainQuestAwardSkin","MainQuestAwardSkin")},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.MainQuestAwardItem))},onShow:function(){this._list.show(),this.updateShow(),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.updateShow),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_AWARD,this.updateShow)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.updateShow),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_AWARD,this.updateShow)},updateShow:function(){var e=game.questAward.mapQuestData.values();e&&(1<e.length&&e.sort(this._sortData),this._list.setData(e))},_sortData:function(e,t){return e.isGet-t.isGet||e.index-t.index}})},{}],516:[function(e,t,i){"use strict";e("./panel/MapPanel"),e("./panel/UIMapItem"),e("./panel/WorldMapPanel")},{"./panel/MapPanel":517,"./panel/UIMapItem":518,"./panel/WorldMapPanel":519}],517:[function(e,t,i){"use strict";game.appModule.MapPanel=game.SkinUIPanel.extends({_mainCharSyncInfo:null,_scene:null,_sceneLayer:null,_mainChar:null,_mapPanelSync:null,_lineEvt:null,ctor:function(e){this._super(e),this._mapPanelSync=new game.MapPanelSync(this.updateMiniPos,this)},onShow:function(){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.currentMap),this._scene=b8e.SceneMgr.inst().createScene("panorama",this._sceneLayer),this._scene.setSize(this._skin.currentMap.width,this._skin.currentMap.height),this._mainChar=new b8e.SceneDisplay,this._skin.player.node.setPosition(0,0),this._mainChar.addChild(this._skin.player.node),this._mainChar.clearDisabled=!0,this._scene.addDisplay(this._mainChar),this._scene.getCamera().setFocusTarget(this._mainChar),this._mainCharSyncInfo=new b8e.DisplaySyncInfo(this._mapPanelSync,!0),game.mainRole.mainRoleEntity.addSyncInfo(this._mainCharSyncInfo));this.registerOrUnregisterEvent(!0),this.updateMiniMap(),this.updateLine(),this.showworldMapBtn(),this.onshowSceneDesc()},onHide:function(){this._scene.stopRender(),this.registerOrUnregisterEvent(!1)},registerOrUnregisterEvent:function(e){e?(this._scene.addEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.addEventListener(b8e.SceneEvent.SCENE_MAP_LOAD_COMPLETE,this.onSceneMapLoadComplete,this),b8e.evt.onC(this._skin.worldMapBtn,this.onWorldMapBtnClick,this),b8e.evt.onC(this._skin.lineSelect,this.onReqLine,this),b8e.evt.addG(this,game.SceneEvent.SHOW_LINE_MENU,this.onShowLineMenu),b8e.evt.addG(this,game.SceneEvent.UPDATE_LINE,this.updateLine),b8e.evt.addG(this,game.SceneDesEvent.CHANGE_SCENE,this.onshowSceneDesc)):(this._scene.removeEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.removeEventListener(b8e.SceneEvent.SCENE_MAP_LOAD_COMPLETE,this.onSceneMapLoadComplete,this),b8e.evt.offC(this._skin.worldMapBtn,this.onWorldMapBtnClick,this),b8e.evt.offC(this._skin.lineSelect,this.onReqLine,this),b8e.evt.rmvG(this,game.SceneEvent.SHOW_LINE_MENU,this.onShowLineMenu),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_LINE,this.updateLine),b8e.evt.rmvG(this,game.SceneDesEvent.CHANGE_SCENE,this.onshowSceneDesc))},onClickMap:function(e){var t=b8e.scene.getPanoramaRatio();game.MoveToHelper.inst().moveTo({x:e.data.x*t,y:e.data.y*t})},onshowSceneDesc:function(){var e=game.SceneDesMgr.inst(),t=this._skin,i=game.SceneMgr.inst().getSceneConfig();if(i&&i.name,e.showPrize){this._skin.tipNode.active=!0,t.nowExp.string=game.html.getText(game.html.Q_GREEN,e.nowExp)+"/小时",t.nowGold.string=game.html.getText(game.html.Q_GREEN,e.nowGold)+"/小时";var n=game.mainRole.mainRoleData,s=n.getExp(),a=n.getLv(),o=game.ccfg.ExpCfg.getExpByLevel(a),r="",h=0;if(0==e.nowExp)r="99+";else r=99<=(h=(s<o?o-s:0)/e.nowExp)?"99+":h=h.toFixed(1);this._skin.levelUptimerichtext.string="约"+game.html.getText(game.html.Q_GREEN,r)+"小时后升级"}else this._skin.tipNode.active=!1},onSceneMapLoadComplete:function(e){this.updateMiniMap()},showworldMapBtn:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.NORMAL:this._skin.worldMapBtn.active=!0;break;case game.SceneType.DUNGEON:case game.SceneType.WORLDBOSS:case game.SceneType.ARENA:case game.SceneType.SURA:this._skin.worldMapBtn.active=!1;break;default:this._skin.worldMapBtn.active=!0}},updateMiniMap:function(){var e=b8e.scene.getPanoramaRatio(),t=b8e.scene.getSceneSize(),i=b8e.scene.getMapUrl(),n={};n.mapWidth=t.width/e,n.mapHeight=t.height/e,n.thumbFileName="panorama.jpg",this._scene.setMapConfig(i,n),this._scene.startRender(),this.updateMiniPos(),this.setMiniMapPosition()},updateLine:function(){var e=game.mainRole.mainRoleData;this._skin.labLine.string=e.line+"线"},onReqLine:function(e){this._lineEvt=e,game.SceneSender.reqLine()},_line:-1,onShowLineMenu:function(){for(var e=[],t=new game.MenuData,i=game.sceneRole.getLines(),n=0;n<i.length;n++){var s=i[n];if(-1!=s){var a=new game.MuneUnit;a.index=n,a.data=s,t.datas.push(a);var o=s+"线";e.push(o)}}e&&0<e.length&&(t.isCallBack=!0,game.menu.show(this,this._lineEvt,e,t,this.onClick))},onClick:function(e,t){if(e.datas&&!(e.datas.length<=0)){var i=-1;for(t=0;t<e.datas.length;t++){var n=e.datas[t];n&&(n.index==t&&(i=n.data))}-1!=i&&game.SceneSender.transferRequest(i)}},setMiniMapPosition:function(){var e=0,t=0,i=b8e.scene.getPanoramaRatio(),n=b8e.scene.getSceneSize(),s=n.width/i,a=n.height/i;s<this._skin.currentMap.width&&(e=~~((this._skin.currentMap.width-s)/2)),a<this._skin.currentMap.height&&(t=~~((this._skin.currentMap.height-a)/2)),this._sceneLayer.setPosition(e,-t)},updateMiniPos:function(){var e=b8e.scene.getPanoramaRatio(),t=game.mainRole.mainRoleEntity;this._mainChar.setPosition(t.x/e,t.y/e),this._mainChar.rotation=t.getDirection()?270-b8e.CommonUtil.getAngleByDirection(t.getDirection()):0;var i=t.getGridPosition();this._skin.labPoint.string=i?"当前位置：("+i.x+","+i.y+")":"";var n=game.SceneMgr.inst().getSceneConfig(),s="";n&&(s=n.name),this._skin.labName.string=s},onWorldMapBtnClick:function(){game.app.show(game.AppConstant.WORLD_MAP_PANEL)}}),game.MapPanelSync=b8e.Object.extends({_callback:null,_thisArg:null,ctor:function(e,t){this._callback=e,this._thisArg=t},syncInfo:function(e,t,i){this._callback.call(this._thisArg)}})},{}],518:[function(e,t,i){"use strict";game.UIMapItem=game.SkinUI.extends({_image:null,id:-1,data:null,ctor:function(){this._super("map/UIMapItemSkin","UIMapItemSkin")},onShow:function(){this.loadImage(this.data),b8e.evt.onC(this._skin.node_click,this.onClick,this)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClick,this)},onClick:function(){var e=game.ccfg.SceneCfg.getDataById(this.id);e&&(game.mainRole.mainRoleData.getLv()>=e.unlocklevel?(game.app.hide(game.AppConstant.WORLD_MAP_PANEL),game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,this.id),game.quest.changeAuto(!1)):game.notice.show("暂时还去不了这里哟"))},loadImage:function(e){if(this.data=e,this.data&&this._skin){this._skin.labSceneName.string=e.name,this._skin.infoGroup.active=!0;var t=game.ClientCfg.getWordMapItem(this.data.iconname);this.id=e.id,this._image||(this._image=b8e.Sprite.get(),this._image.setAnchor(.5,.5),this._image.addToParent(this._skin.node),this._image.setLocalZOrder(-1e3),this._skin.infoGroup.setLocalZOrder(1e3));var i=game.ccfg.SceneCfg.getDataById(this.id);if(i){var n,s=game.mainRole.mainRoleData.getLv();this._image.loadTexture(t,function(e){n=s>=i.unlocklevel?i.tipsString:s>=i.openinglevel&&s<i.unlocklevel?i.tipsString:i.unlocklevel+"",this._skin.lab_lv.string=n,this._skin.infoGroup.x=0,this._skin.infoGroup.y=.3*-e.height},this,{useManifest:!1})}}}})},{}],519:[function(e,t,i){"use strict";game.appModule.WorldMapPanel=game.SkinUIPanel.extends({_mapItems:null,_mapSp:null,_curPage:-1,_maxPage:0,_mapWidth:0,ctor:function(e){this._super(e)},init:function(){this._mapItems=b8e.HashMap.get(),this._mapSp||(this._mapSp=b8e.Sprite.get(),this._mapSp.addToParent(this._skin.mapNode)),this._mapSp.loadTexture(game.ClientCfg.newMapBg,null,null,{useManifest:!1})},getItemByName:function(e){var t=this._mapItems.get(e);return t?!t._skin||t._skin.node_click:null},onShow:function(){this.updateItems(),-1==this._curPage&&(this._curPage=1),this._isScrollStop=!0,this._mapWidth=0==this._mapSp.width?this._skin.mapWidth:this._mapSp.width,this._maxPage=~~(this._mapWidth/this._skin.moveDistance),this._skin.mapNode.x=~this._mapWidth+this._curPage*this._skin.moveDistance,this._curPage>=this._maxPage?(this._skin.rightButton.active=!0,this._skin.leftButton.active=!1):this._curPage<=1&&(this._skin.rightButton.active=!1,this._skin.leftButton.active=!0),b8e.evt.onC(this._skin.leftButton,this.onLeftTurnPage,this),b8e.evt.onC(this._skin.rightButton,this.onRightTurnPage,this),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateItems)},onHide:function(){b8e.evt.offC(this._skin.leftButton,this.onLeftTurnPage,this),b8e.evt.offC(this._skin.rightButton,this.onRightTurnPage,this),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.updateItems)},onLeftTurnPage:function(){this._isScrollStop&&(this._isScrollStop=!1,this._curPage++,this._skin.rightButton.active=!0,this._curPage>=this._maxPage?(this._curPage=this._maxPage,this._skin.leftButton.active=!1):this._skin.leftButton.active=!0,b8e.Tween.kill(this._skin.mapNode),b8e.Tween.get(this._skin.mapNode).to({x:this._skin.mapNode.x+this._skin.moveDistance},500).call(this.onCompleteFunc,this))},onRightTurnPage:function(){this._isScrollStop&&(this._isScrollStop=!1,this._curPage--,this._skin.leftButton.active=!0,this._curPage<=1?(this._curPage=1,this._skin.rightButton.active=!1):this._skin.rightButton.active=!0,b8e.Tween.kill(this._skin.mapNode),b8e.Tween.get(this._skin.mapNode).to({x:this._skin.mapNode.x-this._skin.moveDistance},500).call(this.onCompleteFunc,this))},onCompleteFunc:function(){this._isScrollStop=!0},updateItems:function(){if(game.ccfg.SceneCfg.data){var n=game.mainRole.mainRoleData.getLv();game.ccfg.SceneCfg.data.forEach(function(e,t){if(!this._mapItems.get(t.id)&&n>=t.openinglevel&&t.mapPos){var i=new game.UIMapItem;i.addToParent(this._mapSp),i.setPosition(t.mapPos.X,this._skin.mapHeight-t.mapPos.Y),i.loadImage(t),i.show(),this._mapItems.set(t.id,i)}},this)}else b8e.error("配置为什么是空的？")}})},{}],520:[function(e,t,i){"use strict";game.MaterialCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Instance.MaterialInsInfoResponse,this.onMaterialInsInfoResponse,this),b8e.addNH(game.pbmid.Instance.EnterMaterialInsResponse,this.onEnterMaterialInsResponse,this),b8e.addNH(game.pbmid.Instance.QuickChallengeMaterialInsResponse,this.onQuickChallengeMaterialInsResponse,this),b8e.addNH(game.pbmid.Instance.FinishMaterialInstanceNotify,this.onFinishMaterialInstanceNotify,this)},onEnterMaterialInsResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterMaterialInsResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.material.enterMaterialDungeonSuccess(t.type))},onQuickChallengeMaterialInsResponse:function(e){var t=e.readProtobuf(game.pbmsg.QuickChallengeMaterialInsResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.material.quickChallengeMaterialSuccess(t.type,t.isFree))},onFinishMaterialInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.FinishMaterialInstanceNotify);t&&game.material.finishMaterialDungeon(t)},onMaterialInsInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.MaterialInsInfoResponse);t&&game.material.setup(t)}})},{}],521:[function(e,t,i){"use strict";game.MaterialEvent=b8e.Enum({MATERIAL_CHANGE:b8e.Event.nextCode()})},{}],522:[function(e,t,i){arguments[4][263][0].apply(i,arguments)},{dup:263}],523:[function(e,t,i){"use strict";game.MaterialMgr=b8e.Object.extends({_materialMap:null,_curType:null,COST_ID:9,isInit:!1,freeLevel:0,freeVip:0,isInitFree:!1,setup:function(e){if(this._materialMap=b8e.HashMap.get(),e){for(var t,i=0;i<e.list.length;i++){var n=e.list[i];(t=new game.MaterialInfo).setup(n),this._materialMap.set(t.type,t)}b8e.evt.dptG(game.MaterialEvent.MATERIAL_CHANGE)}},getAllMaterials:function(){if(!this._materialMap)return null;var e=this._materialMap.values();return e.sort(this.sortMaterialDungeon),e},sortMaterialDungeon:function(e,t){var i=game.material.getMinDungeonByType(e.type),n=game.material.getMinDungeonByType(t.type);return i.limitLv-n.limitLv},getMaterialInfo:function(){0==this.isInit?game.MaterialSender.initData():b8e.evt.dptG(game.MaterialEvent.MATERIAL_CHANGE)},getMinDungeonByType:function(e){var t=game.ccfg.DungeonCfg.getDungeonMapByType(e);if(!t||0==t.count)return null;var i=t.values();return i.sort(this.sortDungeon),i[0]},getCurDungeonByType:function(e){var t=game.mainRole.mainRoleData.getLv(),i=game.ccfg.DungeonCfg.getDungeonMapByType(e);if(!i||0==i.count)return null;var n,s=i.values();s.sort(this.sortDungeon);for(var a=s.length-1;0<=a;a--)if(t>=(n=s[a]).limitLv)return n;return null},sortDungeon:function(e,t){return e.limitLv-t.limitLv},getNextDungeon:function(e){return game.ccfg.DungeonCfg.getDataById(e+1)},clickMaterial:function(e){var t=this._materialMap.get(e);if(t){var i=this.getIsFree(),n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_MAX_FIGHT_COUNT);if(t.challegeCount<n)i?this.quickChallengeMaterial(e):this.enterMaterialDungeon(e);else if(game.vip.getBuyMaterialTimes()<=t.qulickCount)game.gameAlert.showVipAlert(!1,100);else{var s=game.ccfg.CostCfg.getCostInfoByIdAndNum(this.COST_ID,t.qulickCount+1);s?(this._curType=e,game.upgrade.costCheck(this,s.upgradeInfo,this.costCheckComplete,!0)):b8e.warn("未查询到材料副本次数",t.qulickCount+1,"消耗")}}},costCheckComplete:function(e){e&&this.quickChallengeMaterial(this._curType)},enterMaterialDungeon:function(e){game.MaterialSender.enterMaterialDungeon(e)},enterMaterialDungeonSuccess:function(e){this._curType=e,game.app.hide(game.AppConstant.FIGHT_PANEL);var t=game.SysTime.curTime+3e5;game.leaveDungeon.show(t,game.SceneType.DUNGEON)},quickChallengeMaterial:function(e){game.MaterialSender.quickChallengeMaterial(e)},quickChallengeMaterialSuccess:function(e,t){var i=this._materialMap.get(e);i&&(t?i.challegeCount++:i.qulickCount++,b8e.evt.dptG(game.MaterialEvent.MATERIAL_CHANGE))},finishMaterialDungeon:function(e){if(e)if(e.state==game.BattleState.Victory){var t=this._materialMap.get(this._curType);if(!t)return;t.challegeCount++,game.DungeonResultMgr.inst().showResult(!0,e.userItem),b8e.evt.dptG(game.MaterialEvent.MATERIAL_CHANGE)}else game.DungeonResultMgr.inst().showResult(!1)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.MATERIAL_ALERT,null,this.materialAlert,this)},materialAlert:function(){if(!this._materialMap)return!1;if(0==game.funcOpen.checkOpen(game.FunctionType.MATERIAL))return!1;for(var e,t=this._materialMap.values(),i=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_MAX_FIGHT_COUNT),n=0;n<t.length;n++){if((e=t[n]).challegeCount<i)if(this.getCurDungeonByType(e.type)&&this.getisOpenByType(e.type))return!0}return!1},getisOpenByType:function(e){var t=!1;switch(e){case game.DungeonType.TYPE_MATERIAL_MOUNT:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_MOUNT);break;case game.DungeonType.TYPE_MATERIAL_WING:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_WING);break;case game.DungeonType.TYPE_MATERIAL_FABAO:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_FABAO);break;case game.DungeonType.TYPE_MATERIAL_EQUIP:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_EQUIP);break;case game.DungeonType.TYPE_MATERIAL_EXP:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_EXP);break;case game.DungeonType.TYPE_MATERIAL_GLOD:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_GLOD);break;case game.DungeonType.TYPE_MATERIAL_XIANZHEN:t=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_XIANZHEN)}return t},getIsFree:function(){this.isInitFree||(this.freeLevel=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_FREE_LEVEL),this.freeVip=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_FREE_VIP),this.isInitFree=!0);var e=game.mainRole.mainRoleData.getLv(),t=game.vip.getVipLv();return this.freeLevel<=e||this.freeVip<=t}}),game.MaterialMgr._instance=null,game.MaterialMgr.inst=function(){return game.MaterialMgr._instance||(game.MaterialMgr._instance=new game.MaterialMgr),game.MaterialMgr._instance}},{}],524:[function(e,t,i){"use strict";game.MaterialItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,_isOpen:!1,_str:"",ctor:function(){this._super("material/MaterialItemSkin","MaterialItemSkin"),this._prizeInfo=new game.PrizeInfo},getButtonByName:function(e){switch(e){case"fight":return!this._skin||this._skin.fight}return null},onShow:function(){b8e.evt.onC(this._skin.fight,this.fightBtnClick,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.fight,this.fightBtnClick,this)},fightBtnClick:function(){this._data&&game.material.clickMaterial(this._data.type)},init:function(){this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_100,1),this._prizeList.addToParent(this._skin.prize))},setData:function(e){var t;if(this._data=e,this._skin&&e){this.updateCardInfo();var i=game.mainRole.mainRoleData,n=game.material.getCurDungeonByType(e.type);n||(n=game.material.getMinDungeonByType(e.type));var s=i.getLv();if(n){if(n.monster){var a=n.monster[0];if(a){var o=game.ccfg.MonsterCfg.getMonsterModelById(a.Id);this._prizeInfo.setupById(o.dropId),this._prizeList.setData(this._prizeInfo)}}switch(this._skin.titleWing.active=!1,this._skin.titleMount.active=!1,this._skin.titleEquip.active=!1,this._skin.titleFabao.active=!1,this._skin.titleExp.active=!1,this._skin.titleGlod.active=!1,this._skin.titleXianZhen.active=!1,e.type){case game.DungeonType.TYPE_MATERIAL_MOUNT:this._skin.titleMount.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_MOUNT),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_MOUNT);break;case game.DungeonType.TYPE_MATERIAL_WING:this._skin.titleWing.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_WING),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_WING);break;case game.DungeonType.TYPE_MATERIAL_FABAO:this._skin.titleFabao.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_FABAO),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_FABAO);break;case game.DungeonType.TYPE_MATERIAL_EQUIP:this._skin.titleEquip.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_EQUIP),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_EQUIP);break;case game.DungeonType.TYPE_MATERIAL_EXP:this._skin.titleExp.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_EXP),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_EXP);break;case game.DungeonType.TYPE_MATERIAL_GLOD:this._skin.titleGlod.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_GLOD),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_GLOD);break;case game.DungeonType.TYPE_MATERIAL_XIANZHEN:this._skin.titleXianZhen.active=!0,this._isOpen=game.funcOpen.checkOpen(game.FunctionType.MATERIAL_XIANZHEN),t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.MATERIAL_XIANZHEN)}if(this._skin.floor.string="第"+n.group+"层",this._skin.alert.active=!1,this._skin.nextFloor.string="",!this._isOpen&&t){var r="";r=t.closeTips;var h=i.miscData.openServerDay;if(g=t.openServerDay-h,0!=t.openServerDay&&0<g)r=game.ccfg.LangCfg.getText(25001,[g]);else if(-1<r.indexOf("{TaskDiffSeq}")){var g=0,l=0,c=game.quest.questInfo;c&&(l=c.sequence);var u=t.questId;g=((c=0<u?game.ccfg.MainQuestCfg.getQuestById(u):null)?c.sequence:0)-l+1,r=r.replace("{TaskDiffSeq}",g)}return this._skin.fightNode.active=!1,this._skin.openNode.active=!0,void(this._skin.openLv.string=r)}if(s<n.limitLv)return this._skin.fightNode.active=!1,this._skin.openNode.active=!0,void(this._skin.openLv.string=n.limitLv+"级开启");this._skin.fightNode.active=!0,this._skin.openNode.active=!1;var m=game.material.getNextDungeon(n.id);m&&(this._skin.nextFloor.string=m.limitLv+"级可进入第"+m.group+"层收益提高"),this._skin.costNode.active=!1;var _,d=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_MAX_FIGHT_COUNT),f=game.material.getIsFree();if(e.challegeCount<d)f?(this._skin.fightLbl.string="扫 荡",this._skin.canFight.string="今日可免费扫荡次数:"):(this._skin.fightLbl.string="挑 战",this._skin.canFight.string="今日可挑战次数:"),_=d-e.challegeCount,this._skin.canFightTime.string=_+"",this._skin.btn_blue.active=!0,this._skin.alert.active=!0;else{var p=game.vip.getBuyMaterialTimes();this._skin.fightLbl.string="扫 荡";var S=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.material.COST_ID,e.qulickCount+1);if(S){this._skin.costNode.active=!0;var T=S.upgradeInfo.getAmountInfo();this._skin.cost.string=T.getFirstAmountValue()+""}_=p-e.qulickCount,this._skin.canFight.string="今日可额外扫荡次数:",this._skin.canFightTime.string=_+"",this._skin.btn_blue.active=!1,p>=e.qulickCount?(this._skin.fight.active=!0,this._skin.cantFight.active=!1):(this._skin.fight.active=!1,this._skin.cantFight.active=!0)}}}},updateCardInfo:function(){if(game.shield.isShieldRecharge())this._skin.addMaterialRate.string="";else{var e=game.ccfg.CardRechargeCfg.getCardRechargeArr();if(this._str="",!e||e.length<=0)this._skin.addMaterialRate.string="";else{for(var t,i,n,s=0;s<e.length;s++)t=e[s].cardType,i=e[s],n=game.pay.getPayInfoIdByType(t)?game.html.getText(game.html.Q_GREEN,game.ccfg.LangCfg.getText(76e3,[i.addMaterialRate,i.name])):game.html.getText(game.html.GRAY,game.ccfg.LangCfg.getText(76e3,[i.addMaterialRate,i.name])),this._str+=n;this._skin.addMaterialRate.string=this._str}}},getHeight:function(){return 193},getWidth:function(){return 540}})},{}],525:[function(e,t,i){"use strict";game.MaterialPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("material/MaterialSkin","MaterialSkin")},init:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_FREE_LEVEL),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_FREE_VIP);this._skin.lab_free_desc.string=game.ccfg.LangCfg.getText(76001,[t,e])},getButtonByName:function(e){var t;switch(e){case"fight":if(this._list)if((i=this._list.getItemRender(0))&&(t=i.getButtonByName("fight")))return t;return!0;case"fight_2":var i;if(this._list)if((i=this._list.getItemRender(2))&&(t=i.getButtonByName("fight")))return t;return!0}return!1},onShow:function(){this._skin.vipNode.active=!game.shield.isShieldRecharge(),this.initPanel(),b8e.evt.addG(this,game.MaterialEvent.MATERIAL_CHANGE,this.onUpdateMailInfo),game.material.getMaterialInfo(),this._list.show(),b8e.evt.onC(this._skin.buy,this.buyBtnClick,this),b8e.evt.onC(this._skin.active_vip,this.activeVipClick,this)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.MaterialEvent.MATERIAL_CHANGE,this.onUpdateMailInfo),b8e.evt.offC(this._skin.active_vip,this.activeVipClick,this),b8e.evt.offC(this._skin.buy,this.buyBtnClick,this)},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.MaterialItem))},onUpdateMailInfo:function(){var e=game.material.getAllMaterials();this._list.setData(e)},activeVipClick:function(){game.pay.showPayPanel()},buyBtnClick:function(){game.app.show(game.AppConstant.CARD_RECHARGE_PANEL)}})},{}],526:[function(e,t,i){"use strict";game.MaterialSender={},game.MaterialSender.initData=function(){var e=game.pbmid.Instance.MaterialInsInfoRequest;b8e.sendN(e)},game.MaterialSender.enterMaterialDungeon=function(e){var t=game.pbmsg.EnterMaterialInsRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.EnterMaterialInsRequest;b8e.sendN(i)},game.MaterialSender.quickChallengeMaterial=function(e){var t=game.pbmsg.QuickChallengeMaterialInsRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.QuickChallengeMaterialInsRequest;b8e.sendN(i)}},{}],527:[function(e,t,i){"use strict";game.MicroMgr=b8e.Object.extends({ctor:function(){if(1==game.MicroMgr._singleton)throw new Error("MicroMgr 只能通过单例方法获取")},downLoad:function(){game.sdk.downloadMicroClient()}}),game.MicroMgr._instance=null,game.MicroMgr._singleton=!0,game.MicroMgr.inst=function(){return null==game.MicroMgr._instance&&(game.MicroMgr._singleton=!1,game.MicroMgr._instance=new game.MicroMgr,game.MicroMgr._singleton=!0),game.MicroMgr._instance}},{}],528:[function(e,t,i){"use strict";e("./manager/MicroMgr"),e("./panel/MicroPanel")},{"./manager/MicroMgr":527,"./panel/MicroPanel":529}],529:[function(e,t,i){"use strict";game.appModule.MicroPanel=game.SkinUIPanel.extends({prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.onC(this._skin.prizeBtn,this.clickBtn,this),this.onUpdatePanel()},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.offC(this._skin.prizeBtn,this.clickBtn,this)},onUpdatePanel:function(){game.LoginConfig.isMicroLogin?(this._skin.btn.active=!1,this._skin.prizeBtn.active=!0):(this._skin.btn.active=!0,this._skin.prizeBtn.active=!1)},initPanel:function(){if(!this.prizeList){this.prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this.prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MICRO_PRIZE);e.setupById(t),this.prizeList.setData(e)}},clickBtn:function(){game.LoginConfig.isMicroLogin?(b8e.Toast.launch("奖励领取成功，请到背包查看！"),this.hide()):game.MicroMgr.inst().downLoad()}})},{}],530:[function(e,t,i){"use strict";game.MiscSender={},game.MiscSender.clientDataRequest=function(){var e=game.pbmid.Misc.ClientDataRequest;b8e.sendN(e)},game.MiscSender.saveClientTriggerRequest=function(e,t){var i=game.pbmsg.SaveClientTriggerRequest;i.id=e,i.triggerTimes=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Misc.SaveClientTriggerRequest;b8e.sendN(n)},game.MiscSender.saveClientSetting=function(e){if(e&&0!=e.count){for(var t,i,n,s=e.keys(),a=[],o=game.pbmsg.SaveClientSettingRequest,r=0;r<s.length;++r)t=s[r],i=e.get(t),(n=b8e.ProtobufUtil.createMessage(game.pbmsg.ClientSettingProto)).id=0|t,n.value=i,a.push(n);o.settingData=a,engine.NetSender.getBytes().writeProtobuf(o);var h=game.pbmid.Misc.SaveClientSettingRequest;b8e.sendN(h)}}},{}],531:[function(e,t,i){"use strict";e("./MiscSender")},{"./MiscSender":530}],532:[function(e,t,i){"use strict";e("./panel/panelIndex_13")},{"./panel/panelIndex_13":534}],533:[function(e,t,i){"use strict";game.appModule.MountPanel=game.SkinUIPanel.extends({_skin:null,_model:null,_protoId:0,ctor:function(e){this._super(e),this._skin=this._skin,this.init()},init:function(){if(0==this._protoId){var e=game.mainRole.mainRoleData.mountModuleData;0<e.defaultProtoId?this.setProtoId(e.defaultProtoId):this.setProtoId(30001)}},setProtoId:function(e){if(0<e){if(this._protoId==e)return;this._protoId=e,this._loadModel()}},onShow:function(){this.registerOrUnregisterEvent(!0),b8e.log("this mount skin is open!!!!")},onHide:function(){this.registerOrUnregisterEvent(!1)},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.onC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.onC(this._skin.useBtn,this._onClickUseBtn,this)):(b8e.evt.offC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.offC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.offC(this._skin.useBtn,this._onClickUseBtn,this))},_loadModel:function(){var n=this;this._model?this._model.show(this._protoId):b8e.res.loadRes("UIMountModel","UIMountModel",function(e,t){var i=cc.instantiate(t);n._skin.modelRoot.addChild(i),n._model=i.getComponent("UIMountModel"),n._loadModel()},this)},_onClickPrevBtn:function(){if(0<this._protoId){var e=cc.clampf(this._protoId-1,30001,30012);e!=this._protoId&&this.setProtoId(e)}},_onClickNextBtn:function(){if(0<this._protoId){var e=cc.clampf(this._protoId+1,30001,30012);e!=this._protoId&&this.setProtoId(e)}},_onClickUseBtn:function(){0<this._protoId&&(game.mainRole.mainRoleData.mountModuleData.defaultProtoId=this._protoId)}})},{}],534:[function(e,t,i){"use strict";e("./MountPanel")},{"./MountPanel":533}],535:[function(e,t,i){"use strict";game.MountEquipCmd=game.BaseBean.extends({start:function(){b8e.NetHandler.addHandler(game.pbmid.Accessory.AccessoryEquipUpgradeResponse,this.onAccessoryEquipUpgradeRp,this)},onAccessoryEquipUpgradeRp:function(e){var t=e.readProtobuf(game.pbmsg.AccessoryEquipUpgradeResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.mountequip.onEquipUpGradeSuccess(t.slotInfo)}})},{}],536:[function(e,t,i){"use strict";game.MountEquipSlotType=b8e.Enum({ZUOAN:1,GUAJIAN:3,JIANGSHENG:2,JIAODENG:4})},{}],537:[function(e,t,i){"use strict";game.MountEquipEvents=b8e.Enum({UPDATE_MOUNTEQUIPPANEL:b8e.Event.nextCode(),CLICK_EQUIP_CALLBACK:b8e.Event.nextCode(),PLAY_HIGHEQUIPEFFECT:b8e.Event.nextCode(),EQUIP_SPORTALERT:b8e.Event.nextCode()})},{}],538:[function(e,t,i){"use strict";game.MountEquipMgr=b8e.Object.extends({isShowMountEquipAlert:!1,curShowEquipSlot:1,mountEquipSlotMap:null,mountEquipMap:null,equipTypeList:null,ctor:function(){if(1==game.MountEquipMgr._singleton)throw new Error("MountEquipMgr 只能通过单例方法获取");this._super(),this.mountEquipSlotMap=b8e.HashMap.get(),this.mountEquipMap=b8e.HashMap.get(),this.equipTypeList=[81,82,84,83]},setMountEquipSlotInfo:function(e){var t,i,n,s,a;if(e)for(s=e.length,a=0;a<s;a++)t=e[a],this.mountEquipMap.set(t.index,t);for(i=1;i<=4;++i)(n=this.mountEquipSlotMap.get(i))||(n=new game.AccSlotInfo,this.mountEquipSlotMap.set(i,n)),(t=this.mountEquipMap.get(i))?n.setup(t):n.setSlotType(i);this.checkMountEquipSportAlert()},getMountEquipSlotMap:function(){return this.mountEquipSlotMap?this.mountEquipSlotMap:null},getMountEquipSlotInfo:function(){var e=this.getMountEquipSlotMap();if(!e)return null;var t=e.values();return t&&0<t.length?t.sort(this.sortBySlotType):void 0},sortBySlotType:function(e,t){return e.index-t.index},getSlotInfoByType:function(e){var t=this.getMountEquipSlotMap();if(t){var i=t.get(e);if(i)return i}return null},getResolveMountEquips:function(){return game.back.getMountEquipList()},isHasMountEquip:function(e){var t=this.getSlotInfoByType(e);return!!t&&t.isHasEquip},isHighestMountEquip:function(e){var t=this.getSlotInfoByType(e);if(t){var i=game.ccfg.ItemInfoCfg.getLevelById(t.itemId);if(game.ccfg.AccessoryEquipCfg.getHeightEquipLevel(e)<=i)return!0}return!1},getBestMountEquip:function(e){var t=game.ccfg.AccessoryEquipCfg.getCompoundEquipInfo(e);return t||null},getCurMountEquip:function(e){var t=this.getSlotInfoByType(e);return t?game.ccfg.AccessoryEquipCfg.getItemInfoById(t.itemId):null},getNextMountEquip:function(e){var t=this.getSlotInfoByType(e);if(t){for(var i=game.ccfg.ItemInfoCfg.getLevelById(t.itemId),n=0,s=null,a=game.ccfg.AccessoryEquipCfg.getDatasByEquipType(e),o=0;o<a.length;++o)if((n=o+1)<a.length&&a[o].level==i){s=a[n];break}return s}return null},getPowerByEquipId:function(e){var t=game.ccfg.ItemInfoCfg.getLevelById(e),i=game.ccfg.ItemInfoCfg.getBaseAttrId(e),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i);return game.CCommonUtil.getPower(n,t)},getItemIdByEquipType:function(e){if(!this.isHasMountEquip(e)){var t=this.getBestMountEquip(e);return!!t&&t.itemId}if(this.isHighestMountEquip(e))return 0;var i=this.getNextMountEquip(e);return i?i.itemId:0},isCanGetMountEquipByType:function(e){var t=this.getItemIdByEquipType(e);return!!this.isEnoughDujieLevel(t)&&(!!t&&this.isCanGetMountEquipById(t))},isCanGetMountEquipById:function(e){var t;t=game.ccfg.AccessoryEquipCfg.getupgradeCostByItemId(e);var i=game.ccfg.AccessoryEquipCfg.getCostItemId(e),n=game.back.getItemInfoById(i);return!!(n&&n.num>=t)},isEnoughDujieLevel:function(e){return!(game.dujie.getSelfDujieLv()<game.ccfg.AccessoryEquipCfg.getDujieLevelByItemId(e))},isHasResolveMountEquip:function(){var e=game.back.getMountEquipList();return e&&0<e.length},isCanGetMountEquip:function(){var e=this.getMountEquipSlotMap();if(!e)return!1;var i=!1;return e.forEach(function(e,t){i||(i=this.isCanGetMountEquipByType(e))},this),i},checkMountEquipSportAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.MOUNT_EQUIP)){var e=this.isShowMountEquipAlert;(e=!(!this.isCanGetMountEquip()&&!this.isHasResolveMountEquip()))!=this.isShowMountEquipAlert&&(this.isShowMountEquipAlert=e,b8e.evt.dptG(game.MountEquipEvents.EQUIP_SPORTALERT))}},setCurShowEquipSlot:function(e){this.curShowEquipSlot=e},getEquipIconByType:function(e){var t="90001";switch(e){case game.MountEquipSlotType.ZUOAN:t=game.ImageURLUtil.POS_ZUOAN_ICONAME;break;case game.MountEquipSlotType.GUAJIAN:t=game.ImageURLUtil.POS_GUAJIAN_ICONAME;break;case game.MountEquipSlotType.JIANGSHENG:t=game.ImageURLUtil.POS_JIANGSHENG_ICONAME;break;case game.MountEquipSlotType.JIAODENG:t=game.ImageURLUtil.POS_JIAODENG_ICONAME}return t},getEquipNameByType:function(e){var t="";return this.equipTypeList&&this.equipTypeList.length>=e&&(t=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this.equipTypeList[e-1])),t},onEquipUpgrade:function(e){var t=this.getItemIdByEquipType(e);this.isEnoughDujieLevel(t)?this.isCanGetMountEquipById(t)?game.MountEquipSender.rqAccessoryEquipUpgrade(e):game.notice.show(90004):game.notice.show(90003)},onEquipUpGradeSuccess:function(e){if(e){var t=this.mountEquipSlotMap.get(e.index);t&&t.setup(e),game.ccfg.AccessoryEquipCfg.getLevelByItemId(e.itemId)<2?b8e.evt.dptG(game.MountEquipEvents.PLAY_HIGHEQUIPEFFECT,!1):b8e.evt.dptG(game.MountEquipEvents.PLAY_HIGHEQUIPEFFECT,!0),b8e.evt.dptG(game.MountEquipEvents.UPDATE_MOUNTEQUIPPANEL)}}}),game.MountEquipMgr._instance=null,game.MountEquipMgr._singleton=!0,game.MountEquipMgr.inst=function(){return game.MountEquipMgr._instance||(game.MountEquipMgr._singleton=!1,game.MountEquipMgr._instance=new game.MountEquipMgr,game.MountEquipMgr._singleton=!0),game.MountEquipMgr._instance}},{}],539:[function(e,t,i){},{}],540:[function(e,t,i){"use strict";game.MountEquipItem=game.SkinUI.extends({_spBg:null,_equipInfo:null,ctor:function(){this._super("mountEquip/MountEquipItemSkin","MountEquipItemSkin")},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.itemBg)},getHeight:function(){return 140},getWidth:function(){return 100},onShow:function(){this.setData(this._equipInfo),this.updataRedIcon(),b8e.evt.onC(this._skin.itemClickNode,this.onClickBack,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataRedIcon)},onHide:function(){b8e.evt.offC(this._skin.itemClickNode,this.onClickBack,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataRedIcon)},onClickBack:function(){this._equipInfo&&this._skin&&game.mountequip.curShowEquipSlot!=this._equipInfo.index&&b8e.evt.dptG(game.MountEquipEvents.CLICK_EQUIP_CALLBACK,this._equipInfo.index)},setData:function(e){if(this._equipInfo=e,this._equipInfo&&this._skin)if(this._skin.chooseIcon.active=game.mountequip.curShowEquipSlot==e.index,this._skin.slotName.string=game.mountequip.getEquipNameByType(e.index),e.isHasEquip){var t=game.ccfg.ItemInfoCfg.getIconNameById(e.itemId);t&&this._spBg.loadTexture(game.ClientCfg.getImgUrl(t),null,null,{useManifest:!1});var i=game.ccfg.ItemInfoCfg.getLevelById(e.itemId);this._skin.itemName.string=i+"阶",this._skin.quatityNode.active=!0}else this._spBg.loadTexture(game.ClientCfg.getItemIconUrlByIconName(game.mountequip.getEquipIconByType(e.index)),null,null,{useManifest:!1}),this._skin.itemName.string="",this._skin.quatityNode.active=!1},updataRedIcon:function(){this._equipInfo&&this._skin&&(this._skin.redIcon.active=game.mountequip.isCanGetMountEquipByType(this._equipInfo.index))}})},{}],541:[function(e,t,i){"use strict";game.appModule.MountEquipPanel=game.SkinUIPanel.extends({_spBg:null,_list:null,_curSlotType:1,_costInfo:null,_isCanGetEquip:!1,_normalEquipIcon:null,_nextEquipIcon:null,_curEquipIcon:null,_isHighest:!1,_costNum:0,ctor:function(e){this._super(e)},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.equipBg),this._spBg.loadTexture(game.ClientCfg.mountEquipBg,null,null,{useManifest:!1}),this._list=new b8e.List(this._skin.equipList,game.MountEquipItem),this._normalEquipIcon=b8e.Sprite.get(),this._normalEquipIcon.setAnchor(.5,.5),this._normalEquipIcon.addToParent(this._skin.normalEquipIcon),this._curEquipIcon=b8e.Sprite.get(),this._curEquipIcon.setAnchor(.5,.5),this._curEquipIcon.addToParent(this._skin.curEquipIcon),this._nextEquipIcon=b8e.Sprite.get(),this._nextEquipIcon.setAnchor(.5,.5),this._nextEquipIcon.addToParent(this._skin.nextEquipIcon)},onShow:function(){this._skin.resolveBtn.active=!game.IS_SHIELD_IOS_RECHARGE,this._curSlotType=1,game.mountequip.setCurShowEquipSlot(this._curSlotType),this._list.show(),this.updataPanel(),this.updataCostNum(),b8e.evt.onC(this._skin.upgradeLevelBtn,this.onUpgradeEquip,this),b8e.evt.onC(this._skin.compoundBtn,this.onCompoundEquip,this),b8e.evt.onC(this._skin.resolveBtn,this.onResolveEquip,this),b8e.evt.addG(this,game.MountEquipEvents.UPDATE_MOUNTEQUIPPANEL,this.updataPanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataCostNum),b8e.evt.addG(this,game.MountEquipEvents.CLICK_EQUIP_CALLBACK,this.onEquipGradeClickBack),b8e.evt.addG(this,game.MountEquipEvents.PLAY_HIGHEQUIPEFFECT,this.playHighEquipEffect)},onHide:function(){this._list&&(this._list.setData(null),this._list.hide()),b8e.evt.offC(this._skin.upgradeLevelBtn,this.onUpgradeEquip,this),b8e.evt.offC(this._skin.compoundBtn,this.onCompoundEquip,this),b8e.evt.offC(this._skin.resolveBtn,this.onResolveEquip,this),b8e.evt.rmvG(this,game.MountEquipEvents.UPDATE_MOUNTEQUIPPANEL,this.updataPanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updataCostNum),b8e.evt.rmvG(this,game.MountEquipEvents.CLICK_EQUIP_CALLBACK,this.onEquipGradeClickBack),b8e.evt.rmvG(this,game.MountEquipEvents.PLAY_HIGHEQUIPEFFECT,this.playHighEquipEffect)},onEquipGradeClickBack:function(e){if(e&&e.data){var t=e.data;this._curSlotType!=t&&(this._curSlotType=t,game.mountequip.setCurShowEquipSlot(this._curSlotType),this.updataPanel())}},updataPanel:function(){var e=game.mountequip.getMountEquipSlotInfo();this._list.setData(e);var t=0,i=0,n=0,s=30004,a=!1;if(this._isUpGradeNode=!1,game.mountequip.isHasMountEquip(this._curSlotType))if(a=game.mountequip.isHighestMountEquip(this._curSlotType)){var o=game.mountequip.getSlotInfoByType(this._curSlotType);o&&(t=o.itemId)}else{this._isUpGradeNode=!0,this.updateEquipGradeNode();var r=game.mountequip.getNextMountEquip(this._curSlotType);if(!r)return;i=game.ccfg.AccessoryEquipCfg.getupgradeCostByItemId(r.itemId);var h=game.ccfg.AccessoryEquipCfg.getCostItemId(r.itemId);this._costInfo=game.back.getItemInfoById(h),this._costInfo&&(n=this._costInfo.num)}else{var g=game.mountequip.getBestMountEquip(this._curSlotType);if(!g)return;t=g.itemId,i=game.ccfg.AccessoryEquipCfg.getupgradeCostByItemId(t),s=30004}if(t){var l=game.ccfg.ItemInfoCfg.getLevelById(t),c=game.ccfg.ItemInfoCfg.getBaseAttrId(t),u=(game.ccfg.SpriteStatCfg.getSpriteStatById(c),game.ccfg.ItemInfoCfg.getHighEquipAttrId(t)),m=(game.ccfg.SpriteStatCfg.getSpriteStatById(u),this.getDecsById(t)),_=game.equip.getPawerByEquipId(t);h=game.ccfg.AccessoryEquipCfg.getCostItemId(t);if(this._costInfo=game.back.getItemInfoById(h),this._costInfo&&(n=this._costInfo.num),this._skin.normalEquipName.string=l+"阶",this._skin.normalAtk.string="战力:"+_,this._skin.normalAtr.string=game.ccfg.LangCfg.getText(s,[m]),!a){var d=game.ccfg.AccessoryEquipCfg.getDujieLevelByItemId(t),f=game.ccfg.DujieCfg.getNameByLevel(d);game.mountequip.isEnoughDujieLevel(t)?this._skin.upgradeLevelDes.string=game.html.getText(game.html.Q_GREEN,f):this._skin.upgradeLevelDes.string=game.html.getText(game.html.Q_RED,f)}var p=game.ccfg.ItemInfoCfg.getIconNameById(t);p&&this._normalEquipIcon.loadTexture(game.ClientCfg.getImgUrl(p),null,null,{useManifest:!1})}this._skin.upgradeLevelNode.active=this._isUpGradeNode,this._skin.normalLevelNode.active=!this._isUpGradeNode,this._skin.highestTips.active=a,this._skin.levelDesNode.active=!a,this._skin.upgradeLevelBtn.active=!a,this._skin.compoundBtn.active=!a,(this._isHighest=a)?this._skin.costItemDes.string="--/--":(this._costNum=i)<=n?(this._isCanGetEquip=!0,this._skin.costItemDes.string=game.ccfg.LangCfg.getText(3e4,[n,i])):(this._isCanGetEquip=!1,this._skin.costItemDes.string=game.ccfg.LangCfg.getText(30003,[n,i]))},updateEquipGradeNode:function(){var e=0,t=game.mountequip.getSlotInfoByType(this._curSlotType);t&&(e=t.itemId);var i=game.mountequip.getNextMountEquip(this._curSlotType);e&&i&&(this.setCurEquipItem(e),this.setNextEquipItem(i.itemId))},setCurEquipItem:function(e){var t=game.ccfg.ItemInfoCfg.getLevelById(e),i=this.getDecsById(e),n=game.equip.getPawerByEquipId(e);this._skin.nowAtk.string="战力:"+n,this._skin.nowAtr.string=game.ccfg.LangCfg.getText(30005,[i]),this._skin.curEquipName.string=t+"阶";var s=game.ccfg.ItemInfoCfg.getIconNameById(e);s&&this._curEquipIcon.loadTexture(game.ClientCfg.getImgUrl(s),null,null,{useManifest:!1})},setNextEquipItem:function(e){game.ccfg.ItemInfoCfg.getNameById(e);var t=game.ccfg.ItemInfoCfg.getLevelById(e),i=this.getDecsById(e),n=game.equip.getPawerByEquipId(e);this._skin.nextAtk.string="战力:"+n,this._skin.nextAtr.string=game.ccfg.LangCfg.getText(30004,[i]),this._skin.nextEquipName.string=t+"阶";var s=game.ccfg.ItemInfoCfg.getIconNameById(e);s&&this._nextEquipIcon.loadTexture(game.ClientCfg.getImgUrl(s),null,null,{useManifest:!1});var a=game.ccfg.AccessoryEquipCfg.getDujieLevelByItemId(e),o=game.ccfg.DujieCfg.getNameByLevel(a);game.mountequip.isEnoughDujieLevel(e)?this._skin.upgradeLevelDes.string=game.html.getText(game.html.Q_GREEN,o):this._skin.upgradeLevelDes.string=game.html.getText(game.html.Q_RED,o)},getDecsById:function(e){var t=game.ccfg.ItemInfoCfg.getBaseAttrId(e),i=game.ccfg.SpriteStatCfg.getSpriteStatById(t),n=game.ccfg.ItemInfoCfg.getHighEquipAttrId(e),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n),a=this.getSpriteStatStr(i)+"<br/>";return a+=this.getSpriteStatStr(s,!0)},updataCostNum:function(){if(this._skin){if(this._isHighest)this._skin.costItemDes.string="--/--";else{var e=0,t=this._costNum;this._costInfo&&(e=this._costInfo.num),t<=e?(this._isCanGetEquip=!0,this._skin.costItemDes.string=game.ccfg.LangCfg.getText(3e4,[e,t])):(this._isCanGetEquip=!1,this._skin.costItemDes.string=game.ccfg.LangCfg.getText(30003,[e,t]))}this._skin.resolveRedIcon.active=game.mountequip.isHasResolveMountEquip()}},onUpgradeEquip:function(){game.mountequip.onEquipUpgrade(this._curSlotType)},onCompoundEquip:function(){game.mountequip.onEquipUpgrade(this._curSlotType)},onResolveEquip:function(){game.app.show(game.AppConstant.MOUNTRESOLVEEQUIP_PANEL)},getSpriteStatStr:function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],s="",a="",o="",r=e.getSpriteStats();if(r&&0<r.length)for(t=0;t<r.length;t++)if(i=r[t]){a=game.ccfg.AttrRulesCfg.getAttrNameByType(i.type),o=t!=r.length-1?"<br/>":"";var h=i.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(i.type).format){case game.AttrRulesFormat.FORMAT_1:h=i.value;break;case game.AttrRulesFormat.FORMAT_2:h=game.ValueUtil.getDigitsValueByNum(100*i.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:h=game.ValueUtil.getDigitsValueByNum(100*i.value,2)}if(n){s+=game.html.getText(game.html.Q_RED,a+" "+h);continue}s+=a+"  +"+h+o}return s},playHighEquipEffect:function(e){if(e&&e.data){var t="10082";e.data.isUpgrade||(t="10028"),this._upgrade_effect||(this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.effecNode)),this.playEffect(t)}},playEffect:function(e){var t=game.ClientCfg.getUIFxs(e);t?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.HIGHEQUIP_EFFECT,1),this._upgrade_effect.addChild(this._anim)),this._upgrade_effect.setVisible(!0),this._anim.load(t),this._anim.addFinishCallback(this.onCompleteEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)},onCompleteEffect:function(e){this._upgrade_effect.setVisible(!1)}})},{}],542:[function(e,t,i){"use strict";game.MountEquipResolveItem=game.SkinUI.extends({_icon:null,_equipInfo:null,ctor:function(){this._super("mountEquip/MountEquipResolveItemSkin","MountEquipResolveItemSkin")},init:function(){this._icon=b8e.Sprite.get(),this._icon.setAnchor(.5,.5),this._icon.addToParent(this._skin.itemBg)},getHeight:function(){return 125},getWidth:function(){return 540},onShow:function(){this.setData(this._equipInfo),b8e.evt.onC(this._skin.equipResolveBtn,this.onResolveEquip,this)},onHide:function(){b8e.evt.offC(this._skin.equipResolveBtn,this.onResolveEquip,this)},setData:function(e){if(this._equipInfo=e,this._equipInfo&&this._skin){this._skin.itemName.string=e.level+"阶",e.iconName&&this._icon.loadTexture(game.ClientCfg.getImgUrl(e.iconName),null,null,{useManifest:!1}),this._skin.equipNameTips.string=game.ccfg.LangCfg.getText(90001,[e.name]);var t=game.ccfg.ItemInfoCfg.getEquipGetItemsById(e.id),i=0;t&&0<t.length&&(i=t[0].Num),this._skin.equipGetItemTips.string=game.ccfg.LangCfg.getText(90002,[i])}},onResolveEquip:function(){this._equipInfo&&game.back.reqSellEquip([this._equipInfo.idx])}})},{}],543:[function(e,t,i){"use strict";game.appModule.MountResolveEquipPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.equipResolveList,game.MountEquipResolveItem)},onShow:function(){this._list.show(),this.upDataList(),b8e.evt.onC(this._skin.gotoBtn[0],this.onFirstGoto,this),b8e.evt.onC(this._skin.gotoBtn[1],this.onSecondGoto,this),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.upDataList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.gotoBtn[0],this.onFirstGoto,this),b8e.evt.offC(this._skin.gotoBtn[1],this.onSecondGoto,this),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.upDataList)},upDataList:function(){var e=game.mountequip.getResolveMountEquips();this._list.setData(e),this._skin.noneTips.node.active=!e},onFirstGoto:function(){game.app.hide(game.AppConstant.MOUNTRESOLVEEQUIP_PANEL),game.app.hide(game.AppConstant.MOUNTEQUIP_PANEL),game.app.hide(game.AppConstant.ROLE_PANEL),game.app.show(game.AppConstant.DUNGEON_PANEL,3)},onSecondGoto:function(){game.guild.isHasGuild()?game.guild.onRqGuildBossInfo():game.notice.show(90005)}})},{}],544:[function(e,t,i){"use strict";(game.MountEquipSender=function(){}).rqAccessoryEquipUpgrade=function(e){var t=game.pbmsg.AccessoryEquipUpgradeRequest;t.index=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Accessory.AccessoryEquipUpgradeRequest;engine.NetSender.send(i)}},{}],545:[function(e,t,i){"use strict";game.NationalBossCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Instance.AllNationalBossInfoResponse,this.onAllNationalBossInfoResponse,this),b8e.addNH(game.pbmid.Instance.NationalBossInfoResponse,this.onNationalBossInfoResponse,this),b8e.addNH(game.pbmid.Instance.SetNationalBossNotifyStateResponse,this.onSetNationalBossNotifyStateResponse,this),b8e.addNH(game.pbmid.Instance.EnterNationalSceneResponse,this.onEnterNationalSceneResponse,this),b8e.addNH(game.pbmid.Instance.LeaveNationalSceneResponse,this.onLeaveNationalSceneResponse,this),b8e.addNH(game.pbmid.Instance.NationalBossKillListResponse,this.onNationalBossKillListResponse,this),b8e.addNH(game.pbmid.Instance.NationalBossAwardNotify,this.onNationalBossAwardNotify,this),b8e.addNH(game.pbmid.Instance.NationalBossKillInfoNotify,this.onNationalBossKillInfoNotify,this),b8e.addNH(game.pbmid.Scene.NationalBossOwnerNotify,this.onNationalBossOwnerNotify,this),b8e.addNH(game.pbmid.Instance.ChuMoAwardCollectResponse,this.onChuMoAwardCollectResponse,this),b8e.addNH(game.pbmid.Instance.ChuMoQuickCompleteResponse,this.onChuMoQuickCompleteResponse,this),b8e.addNH(game.pbmid.Instance.CrossNationalBossInfoResponse,this.onCrossNationalBossInfoResponse,this)},onAllNationalBossInfoResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.AllNationalBossInfoResponse),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.unNotifySceneIds,a=i.bossInfo;game.nationalBoss.setAllNationalBossInfoMap(a,s),game.nationalBoss.setNationalBossDailyQuest(i),s=i.crossUnNotifySceneIds,a=i.crossBossInfo,game.nationalBoss.setAllNeutralBossInfoMap(a,s)}},onNationalBossInfoResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NationalBossInfoResponse),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.bossInfo,a=i.cross;game.nationalBoss.setNationalBossInfo(a,s)}},onSetNationalBossNotifyStateResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.SetNationalBossNotifyStateResponse),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.id,a=i.state;game.nationalBoss.setNationalBossNotifyState(s,a)}},onEnterNationalSceneResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.EnterNationalSceneResponse),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.id,a=i.cross;game.nationalBoss.enterNationalSceneFinish(a,s)}},onLeaveNationalSceneResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.LeaveNationalSceneResponse).code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.nationalBoss.leaveNationalSceneFinish()},onNationalBossKillListResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NationalBossKillListResponse),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.record;game.nationalBoss.setNationalBossKillListInfo(s)}},onNationalBossAwardNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NationalBossAwardNotify),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.guildId,a=i.userItem,o=i.ownerId;game.nationalBoss.setNationalBossAward(o,s,a)}},onNationalBossKillInfoNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NationalBossKillInfoNotify),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.time,a=i.sceneId,o=i.cross;game.nationalBoss.setNationalBossKillInfo(o,s,a)}},onNationalBossOwnerNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.NationalBossOwnerNotify),n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{i.ownerId,i.ownerName;game.nationalBoss.setOwner(i)}},onChuMoAwardCollectResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ChuMoAwardCollectResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.nationalBoss.setNationalBossAwardId(i)},onChuMoQuickCompleteResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ChuMoQuickCompleteResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.nationalBoss.updateBatchChumoResult(i.score)},onCrossNationalBossInfoResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.CrossNationalBossInfoResponse),n=i.code;if(0<n)game.nationalBoss.setAllNeutralBossInfoMap(null,null),game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=i.crossUnNotifySceneIds,a=i.crossBossInfo;game.nationalBoss.setAllNeutralBossInfoMap(a,s)}}})},{}],546:[function(e,t,i){"use strict";e("./NationalBossCmd")},{"./NationalBossCmd":545}],547:[function(e,t,i){"use strict";game.NationalBossEvents=b8e.Enum({ENTER_SCENE_FINISH:b8e.Event.nextCode(),LEAVE_SCENE_FINISH:b8e.Event.nextCode(),UPDATE_NATIONAL_BOSS:b8e.Event.nextCode(),NATIONAL_BOSS_RELIVE:b8e.Event.nextCode(),NATIONAL_BOSS_RELIVE_TIPS:b8e.Event.nextCode(),UPDATE_NATIONAL_BOSS_FIGHT_POPULATION:b8e.Event.nextCode(),KILL_NATIONAL_BOSS:b8e.Event.nextCode(),NATIONAL_BOSS_OWNER_CHANGE:b8e.Event.nextCode(),NATIONAL_BOSS_INIT:b8e.Event.nextCode(),UPDATE_CHUMO_SCORE:b8e.Event.nextCode()})},{}],548:[function(e,t,i){"use strict";e("./NationalBossEvents")},{"./NationalBossEvents":547}],549:[function(e,t,i){"use strict";game.NationalBossMgr=b8e.Object.extends({name:"NationalBossMgr",nationalBossInfoMap:null,neutralBossInfoMap:null,killerInfos:null,nearRelivetime:0,nearReliveSceneId:0,curNationalBossSceneId:0,reliveBossList:null,curSceneOwnerId:0,curSceneOwnerName:"",isRequest:!1,_isTransferGo:!1,nationalBossScore:0,awardScoreList:null,curSelectAwardScore:0,isFirst:!0,_timer:null,_gameAlertInfo:null,isGetAllAward:!1,ctor:function(){if(1==game.NationalBossMgr._singleton)throw new Error("NationalBossMgr 只能通过单例方法获取");this._super(),this.nationalBossInfoMap=b8e.HashMap.get(),this.neutralBossInfoMap=b8e.HashMap.get(),this.killerInfos=[],this.reliveBossList=[],this.awardScoreList=[],this.init()},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onLevelUp),b8e.evt.addG(this,game.DujieEvent.DUJIE_SUCCESS,this.onDujieSuccess)},firstEnterScene:function(){(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)||game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS))&&(this.isRequest=!0,game.NationalBossSender.AllNationalBossInfoRequest())},setAllNationalBossInfoMap:function(e,t){if(e&&!(e.length<=0)){this.nationalBossInfoMap.clear();for(var i,n,s,a=game.SysTime.curTime,o=game.mainRole.mainRoleData.getLv(),r=0;r<e.length;r++)i=e[r],(n=game.ccfg.NationalBossCfg.getNationalBossById(i.id))?((s=new game.NationalBossInfo).setData(i),s.isRelive=!(i.time>a),s.unlockLevel=n.unlockLevel,s.isUnlock=!(o<n.unlockLevel),this.nationalBossInfoMap.set(s.sceneId,s),s.isRelive||(this.nearRelivetime<=a||this.nearRelivetime>s.time)&&(this.nearRelivetime=s.time,this.nearReliveSceneId=s.sceneId)):b8e.error("全民boss cfg为空！！！");if(this.nearRelivetime>a&&0<this.nearReliveSceneId){var h=this.nearRelivetime-game.SysTime.curTime;this._timer&&(b8e.Timer.remove(this,this.updateReliveTime),this._timer=null),this._timer=b8e.Timer.add(this,this.updateReliveTime,h)}if(t&&!(t.length<=0)){for(var g,l=0;l<t.length;l++)g=t[l],(s=this.nationalBossInfoMap.get(g))&&(s.notifyState=!1);b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS)}}},setAllNeutralBossInfoMap:function(e,t){if(game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS))if(this.neutralBossInfoMap.clear(),!e||e.length<=0)b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS);else{for(var i,n,s,a=game.SysTime.curTime,o=(game.mainRole.mainRoleData.getLv(),game.dujie.getSelfDujieLv()),r=0;r<e.length;r++)i=e[r],(n=game.ccfg.NationalBossCfg.getNationalBossById(i.id))?((s=new game.NationalBossInfo).setData(i),s.bossType=1,s.isRelive=!(i.time>a),s.unlockLevel=n.unlockLevel,s.unlockDJLevel=n.dujieLevel,s.isUnlock=!(o<n.dujieLevel),t&&0<t.length&&-1!=t.indexOf(s.sceneId)&&(s.notifyState=!1),this.neutralBossInfoMap.set(s.sceneId,s),s.isRelive||(this.nearRelivetime<=a||this.nearRelivetime>s.time)&&(this.nearRelivetime=s.time,this.nearReliveSceneId=s.sceneId)):b8e.error("中立boss cfg为空！！！");if(this.nearRelivetime>a&&0<this.nearReliveSceneId){var h=this.nearRelivetime-game.SysTime.curTime;this._timer&&(b8e.Timer.remove(this,this.updateReliveTime),this._timer=null),this._timer=b8e.Timer.add(this,this.updateReliveTime,h)}b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS)}},onLevelUp:function(){if(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)){var e=this.getAllNationalBossInfo();if(!e||e.length<0)return;for(var t=game.mainRole.mainRoleData.getLv(),i=0;i<e.length;i++){var n=e[i];!n.isUnlock&&n.unlockLevel<=t&&(n.isUnlock=!0,this.changeRelive(n.sceneId,!0))}b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS)}},onDujieSuccess:function(){if(game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS)){var e=this.getAllNeutralBossInfo();if(!e||e.length<0)return;for(var t=game.dujie.getSelfDujieLv(),i=0;i<e.length;i++){var n=e[i];!n.isUnlock&&n.unlockDJLevel<=t&&(n.isUnlock=!0,this.changeRelive(n.sceneId,!0))}b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS)}},onMainQuestComplete:function(){(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)||game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS))&&(this.isRequest||(this.isRequest=!0,game.NationalBossSender.AllNationalBossInfoRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete))},onMainQuest:function(){(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)||game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS))&&(this.isRequest||(this.isRequest=!0,game.NationalBossSender.AllNationalBossInfoRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest))},setNationalBossInfo:function(e,t){if(t||!(t.length<=0)){for(var i,n,s=0;s<t.length;s++)i=t[s],(n=1==e?this.neutralBossInfoMap.get(i.id):this.nationalBossInfoMap.get(i.id))&&n.setData(i);b8e.evt.dptG(game.NationalBossEvents.UPDATE_NATIONAL_BOSS_FIGHT_POPULATION)}},setNationalBossKillListInfo:function(e){if(e&&!(e.length<=0)){for(var t=this.killerInfos.length=0;t<e.length;t++){var i=e[t],n=new game.NationalBossKillerInfo;n.setData(i),n.index=t,this.killerInfos.push(n)}game.app.show(game.AppConstant.NATIONAL_BOSS_KILL_PANEL)}},setNationalBossNotifyState:function(e,t){var i=this.getBossInfoBySceneId(e);i&&(i.notifyState=t,b8e.evt.dptG(game.NationalBossEvents.NATIONAL_BOSS_RELIVE_TIPS))},enterNationalSceneFinish:function(e,t){game.app.hide(game.AppConstant.DUNGEON_PANEL),this.curNationalBossSceneId=t,game.leaveDungeon.show(0,game.SceneType.NATIONALBOSS),game.transferNotice.isFirstSendTransfer||(game.transferNotice.isFirstSendTransfer=!0,game.TransferNoticeSender.TransferNoticeCDTimeRequest()),this._isTransferGo&&(this._isTransferGo=!1,game.transferNotice.gotoTransferSuccess()),b8e.evt.dptG(game.NationalBossEvents.ENTER_SCENE_FINISH,{cross:e,bossInfo:this.getBossInfoBySceneId(t)})},leaveNationalSceneFinish:function(){this.curNationalBossSceneId=0,b8e.evt.dptG(game.NationalBossEvents.LEAVE_SCENE_FINISH)},setNationalBossAward:function(e,t,i){var n,s=game.mainRole.mainRoleData;n=0==t?s.id==e:s.guildId==t;var a=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_CHUMO_SCORE);this.nationalBossScore+=a,b8e.evt.dptG(game.NationalBossEvents.UPDATE_CHUMO_SCORE),game.app.showAppNoHide(game.AppConstant.NATIONAL_BOSS_RESULT_PANEL,{isKiller:n,userItem:i})},setNationalBossKillInfo:function(e,t,i){var n;(n=0==e?this.nationalBossInfoMap.get(i):this.neutralBossInfoMap.get(i))&&(game.ccfg.NationalBossCfg.getNationalBossById(i)&&(n.time=t,n.isRelive=!1,b8e.evt.dptG(game.NationalBossEvents.KILL_NATIONAL_BOSS,i),this.addReliveBoss(n)))},setOwner:function(e){this.curSceneOwnerId=e.ownerId,this.curSceneOwnerName=e.ownerName,b8e.evt.dptG(game.NationalBossEvents.NATIONAL_BOSS_OWNER_CHANGE)},sendNationalBossInfoRequest:function(e){var t;if(this.reliveBossList.length=0,!(t=e?this.neutralBossInfoMap.values():this.nationalBossInfoMap.values())||t.length<=0)return!1;for(var i=0;i<t.length;i++){var n=t[i];n.isRelive&&this.reliveBossList.push(n.sceneId)}return 0<this.reliveBossList.length&&(game.NationalBossSender.NationalBossInfoRequest(e,this.reliveBossList),!0)},sendEnterNationalBossScene:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.mainRole.mainRoleData.getLv(),n=game.ccfg.NationalBossCfg.getNationalBossById(e);if(i<n.unlockLevel)game.notice.show("等级不足");else if(n.cross&&n.dujieLevel>game.dujie.getSelfDujieLv()){var s=game.ccfg.DujieCfg.getDataByLevel(n.dujieLevel);s&&game.notice.show(79212,[s.name])}else if(game.loneyDungeon.fightCount<=0)game.notice.show("BOSS令牌不足");else{var a=this.getBossInfoBySceneId(e),o=game.SysTime.curTime;a&&a.time>o&&0!=a.time?game.notice.show("BOSS正在复活"):(this._isTransferGo=t,game.NationalBossSender.EnterNationalSceneRequest(e))}},getAllBossInfo:function(){var e=this.getAllNationalBossInfo();return!e||e.length<=0?e=this.getAllNeutralBossInfo():e.concat(this.getAllNeutralBossInfo()),e},changeRelive:function(e,t){game.NationalBossSender.SetNationalBossNotifyStateRequest(e,t)},checkKillInfos:function(e){game.NationalBossSender.NationalBossKillListRequest(e)},onLeaveScene:function(){this.curSceneOwnerId=0,this.curSceneOwnerName="",0!=this.curNationalBossSceneId&&game.NationalBossSender.LeaveNationalSceneRequest(this.curNationalBossSceneId)},callPeople:function(){game.app.show(game.AppConstant.CALL_PANEL)},addReliveBoss:function(e){var t=game.SysTime.curTime;if(!(this.nearRelivetime<e.time&&this.nearRelivetime>=t)){this.nearRelivetime=e.time,this.nearReliveSceneId=e.sceneId;var i=e.time-t+500;this._timer&&(b8e.Timer.remove(this,this.updateReliveTime),this._timer=null),this._timer=b8e.Timer.add(this,this.updateReliveTime,i)}},updateReliveTime:function(){var e=this.getBossInfoBySceneId(this.nearReliveSceneId);if(e){e.isRelive=!0,b8e.evt.dptG(game.NationalBossEvents.NATIONAL_BOSS_RELIVE,{sceneId:this.nearReliveSceneId});var t=game.SysTime.curTime;this.nearReliveSceneId=0,this._timer&&(b8e.Timer.remove(this,this.updateReliveTime),this._timer=null);var i=this.getAllBossInfo();if(i&&!(i.length<=0)){for(var n=0;n<i.length;n++){var s=i[n];s.isRelive||(s.time<=t&&(s.isRelive=!0),(this.nearRelivetime<=t||this.nearRelivetime>s.time)&&(this.nearRelivetime=s.time,this.nearReliveSceneId=s.sceneId))}if(this.nearRelivetime>t&&0!=this.nearReliveSceneId){var a=this.nearRelivetime-game.SysTime.curTime;this._timer&&(b8e.Timer.remove(this,this.updateReliveTime),this._timer=null),this._timer=b8e.Timer.add(this,this.updateReliveTime,a)}}}},formatTime:function(e){return e<0&&(e=0),3600<=(e*=.001)?b8e.TimeUtil.formatNum(e/3600)+":"+b8e.TimeUtil.formatNum(e%3600/60):b8e.TimeUtil.formatNum(e/60)+":"+b8e.TimeUtil.formatNum(e%60)},setNationalBossDailyQuest:function(e){e&&(this.awardScoreList.length=0,this.nationalBossScore=e.score,this.awardScoreList=e.scores)},getCurSelectAwardScore:function(){if(this.isFirst){this.isFirst=!1;for(var e=game.ccfg.NationalAwardCfg.getAwardScoreList(),t=e.length-1;0<=t;t--){var i=e[t];if(this.curSelectAwardScore>=i)return this.curSelectAwardScore=i,this.curSelectAwardScore}return this.curSelectAwardScore=e[0],this.curSelectAwardScore}return this.curSelectAwardScore},setNationalBossAwardId:function(e){if(e){for(var t;t<this.awardScoreList.length;t++){if(this.awardScoreList[t]==e.score)return void b8e.error("这个奖励score已经领取过了，不能再次领取！")}this.awardScoreList.push(e.score),b8e.evt.dptG(game.NationalBossEvents.UPDATE_CHUMO_SCORE)}},setCurSelectAwardScore:function(e){this.curSelectAwardScore=e},sendNationalBossAwardCollect:function(){0!=this.curSelectAwardScore?-1==this.awardScoreList.indexOf(this.curSelectAwardScore)?this.curSelectAwardScore>this.nationalBossScore?game.notice.show("当前积分未达到"):game.NationalBossSender.chuMoAwardCollectRequest(this.curSelectAwardScore):game.notice.show("当前奖励已领取"):game.notice.show("当前没有可领取奖励")},sendChuMoScoreRequest:function(){game.NationalBossSender.chuMoScoreRequest()},gotoKillNationalBoss:function(){game.app.hide(game.AppConstant.ACHIEVEMENT_PANEL),game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.NATIONAL_BOSS)},resetDaily:function(){this.nationalBossScore=0,this.awardScoreList.length=0,this.isGetAllAward=!1},getAllNationalBossInfo:function(){return this.nationalBossInfoMap.values()},getAllNeutralBossInfo:function(){return this.neutralBossInfoMap.values()},getNationalBossKillInfo:function(){return this.killerInfos?this.killerInfos:null},getBossInfoBySceneId:function(e){var t=this.nationalBossInfoMap.get(e);return t||this.neutralBossInfoMap.get(e)},getNationBossIsReliveBySceneId:function(e){var t=this.getBossInfoBySceneId.get(e);return!!t&&t.isRelive},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.NATIONAL_BOSS_ALERT,null,this.NationalBossAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.NEUTRAL_BOSS_ALERT,null,this.NeutralBossAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CHUMO_ALERT,null,this.ChumoAlert,this)},NationalBossAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)){if(game.loneyDungeon.fightCount<=0)return!1;for(var e,t,i=this.nationalBossInfoMap.values(),n=0;n<i.length;n++)if(t=(e=i[n]).time<=game.SysTime.curTime,e.isUnlock&&t&&e.notifyState)return!0}return!1},NeutralBossAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.NEUTRAL_BOSS)){if(game.loneyDungeon.fightCount<=0)return!1;for(var e,t,i=this.neutralBossInfoMap.values(),n=0;n<i.length;n++)if(t=(e=i[n]).time<=game.SysTime.curTime,e.isUnlock&&t&&e.notifyState)return!0}return!1},getNeutralBossServerOpenDay:function(){var e=game.mainRole.mainRoleData.miscData.openServerDay,t=game.ccfg.ClientFunctionOpenCfg.getDataById(game.FunctionType.NEUTRAL_BOSS);return t?t.openServerDay-e:-1},ChumoAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.NATIONAL_BOSS)){var e=game.ccfg.NationalAwardCfg.getAwardScoreList();if(!e||e.length<=0)return!1;if(!this.awardScoreList||this.awardScoreList.length<0)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(-1==this.awardScoreList.indexOf(i)&&i<=this.nationalBossScore)return!0}}return!1},getChumoInfo:function(){var e=this._gameAlertInfo?this._gameAlertInfo:new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoYuanBaoBtn,e.string=game.ccfg.LangCfg.getText(85001),e.isShowTips=!1,e.confirmString=game.ccfg.LangCfg.getText(85002),e.cancelString=game.ccfg.LangCfg.getText(85003);var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ALLCLEAR_CHUMO);if(t){var i=t.split("|"),n=(i[0],0|i[1]);e.oneTimeCount=n;var s=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_CHUMO_SCORE),a=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_CHUMO_SCORE),o=Math.max((s-game.nationalBoss.nationalBossScore)/a,0);return o>>=0,e.allclearCount=o*n,e}b8e.warn("一键除魔参数配置表不对？")},sendBatchChumo:function(e){game.NationalBossSender.batchChumo(e)},updateBatchChumoResult:function(e){this.nationalBossScore=e,game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_CHUMO_SCORE)<=e&&(this.isGetAllAward=!0);for(var t=this.awardScoreList.length,i=0<t?this.awardScoreList[t-1]:0,n=0|game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_CHUMO_SCORE),s=(e-i)/n,a=1;a<=s;a++)this.awardScoreList.push(i+a*n);b8e.evt.dptG(game.NationalBossEvents.UPDATE_CHUMO_SCORE)},crossNationalBossInfoRequest:function(){game.NationalBossSender.CrossNationalBossInfoRequest()}}),game.NationalBossMgr._instance=null,game.NationalBossMgr._singleton=!0,game.NationalBossMgr.inst=function(){return game.NationalBossMgr._instance||(game.NationalBossMgr._singleton=!1,game.NationalBossMgr._instance=new game.NationalBossMgr,game.NationalBossMgr._singleton=!0),game.NationalBossMgr._instance}},{}],550:[function(e,t,i){"use strict";e("./NationalBossMgr")},{"./NationalBossMgr":549}],551:[function(e,t,i){"use strict";e("./cmdlistener/nationalBossCmdIndex_0"),e("./event/nationalBossEventsIndex_0"),e("./sender/nationalBossSenderIndex_0"),e("./manager/nationalBossMgrIndex_0"),e("./panel/nationalBossPanelIndex_0")},{"./cmdlistener/nationalBossCmdIndex_0":546,"./event/nationalBossEventsIndex_0":548,"./manager/nationalBossMgrIndex_0":550,"./panel/nationalBossPanelIndex_0":561,"./sender/nationalBossSenderIndex_0":563}],552:[function(e,t,i){"use strict";game.appModule.CallPanel=game.SkinUIPanel.extends({cd:0,_timer:null,ctor:function(e){this._super(e)},onShow:function(){this.setData(),b8e.evt.onC(this._skin.btn_call,this.onClickBtnCall,this),b8e.evt.addG(this,game.TransferNoticeEvents.SEND_TRANSGER_SUCCSE,this.startCd)},onHide:function(){b8e.evt.offC(this._skin.btn_call,this.onClickBtnCall,this),b8e.evt.rmvG(this,game.TransferNoticeEvents.SEND_TRANSGER_SUCCSE,this.startCd),this._timer&&this._timer.stop()},setData:function(){this._skin.lab_call_title.string=game.ccfg.LangCfg.getText(10201),this._skin.lab_call_desc.string=game.ccfg.LangCfg.getText(10202);var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TRANSFER_USE_TIME),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TRANSFER_SHOT_CD);this._skin.lab_call_cd.string=game.ccfg.LangCfg.getText(10203,[e,t]),this.startCd()},startCd:function(){this.cd=game.transferNotice.callCd;var e=this.cd-game.SysTime.curTime;0<(e=~~(.001*e))&&(this._skin.lab_call.string=e+"s"),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateSureTime,1e3)},onClickBtnCall:function(){var e=game.nationalBoss.curNationalBossSceneId;0<this.cd-game.SysTime.curTime?game.notice.show("发射正在cd中"):0!=e&&e?game.transferNotice.sendTransferNotice(e):game.notice.show("不在全民boss场景中")},updateSureTime:function(){var e=this.cd-game.SysTime.curTime;0<(e=~~(.001*e))?this._skin.lab_call.string=e+"s":(this._skin.lab_call.string="发射",this._timer&&this._timer.stop())}})},{}],553:[function(e,t,i){"use strict";game.appModule.ChumoPanel=game.SkinUIPanel.extends({id:0,_prizeList:null,_prizeInfo:null,_awardScoreList:null,_isGetScoreList:null,_itemList:null,ctor:function(e){this._super(e),this._awardScoreList=[],this._isGetScoreList=[],this._itemList=[]},onShow:function(){this._awardScoreList=game.ccfg.NationalAwardCfg.getAwardScoreList(),this.setData(),b8e.evt.onC(this._skin.get_btn,this.clickGetPrize,this),b8e.evt.onC(this._skin.allclear_btn,this.clickAllClear,this),b8e.evt.onC(this._skin.goto_kill_btn,this.clickGoToKill,this),b8e.evt.onC(this._skin.grid_0,this.clickFirstAward,this),b8e.evt.onC(this._skin.grid_1,this.clickSecondAward,this),b8e.evt.onC(this._skin.grid_2,this.clickThirdAward,this),b8e.evt.onC(this._skin.grid_3,this.clickFourthAward,this),b8e.evt.addG(this,game.NationalBossEvents.UPDATE_CHUMO_SCORE,this.setData)},onHide:function(){b8e.evt.offC(this._skin.get_btn,this.clickGetPrize,this),b8e.evt.offC(this._skin.allclear_btn,this.clickAllClear,this),b8e.evt.offC(this._skin.goto_kill_btn,this.clickGoToKill,this),b8e.evt.offC(this._skin.grid_0,this.clickFirstAward,this),b8e.evt.offC(this._skin.grid_1,this.clickSecondAward,this),b8e.evt.offC(this._skin.grid_2,this.clickThirdAward,this),b8e.evt.offC(this._skin.grid_3,this.clickFourthAward,this),b8e.evt.rmvG(this,game.NationalBossEvents.UPDATE_CHUMO_SCORE,this.setData)},init:function(){this._skin.lab_desc.string=game.ccfg.LangCfg.getText(1033),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prize_node))},setData:function(){var e,t,i,n=game.nationalBoss.nationalBossScore,s=this._awardScoreList.length;if(this._awardScoreList&&0<s)for(this._isGetScoreList=game.nationalBoss.awardScoreList,t=0;t<s;t++)i=(e=this._awardScoreList[t])<=n,this._skin["red_point_"+t].active=i,this._skin["lab_score_"+t].string=e,-1!=this._isGetScoreList.indexOf(e)?(this._skin["grid_is_get_"+t].active=!0,this._skin["grid_award_"+t].active=!1,this._skin["red_point_"+t].active=!1):(this._skin["grid_is_get_"+t].active=!1,this._skin["grid_award_"+t].active=!0);this.setPrizeContent(),this.selectAwardScore(),this.updateActiveAwards()},setPrizeContent:function(){var e=game.nationalBoss.getCurSelectAwardScore(),t=game.ccfg.NationalAwardCfg.getAwardByScore(e);this._prizeInfo.setupById(t),this._prizeList.setData(this._prizeInfo)},clickGoToKill:function(){game.nationalBoss.gotoKillNationalBoss()},clickGetPrize:function(){game.nationalBoss.sendNationalBossAwardCollect()},updateActiveAwards:function(){this._skin.lab_score.string="我的积分:"+game.html.getText(game.html.Q_GREEN,game.nationalBoss.nationalBossScore);var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_CHUMO_SCORE),t=game.nationalBoss.nationalBossScore/e*this._skin.progress_bar_node.width;this._skin.progress_mask.width=t,this._skin.complete_quest.active=!1},clickFirstAward:function(){!this._awardScoreList||this._awardScoreList.length<0||(game.nationalBoss.curSelectAwardScore=this._awardScoreList[0],this.selectAwardScore())},clickSecondAward:function(){!this._awardScoreList||this._awardScoreList.length<1||(game.nationalBoss.curSelectAwardScore=this._awardScoreList[1],this.selectAwardScore())},clickThirdAward:function(){!this._awardScoreList||this._awardScoreList.length<2||(game.nationalBoss.curSelectAwardScore=this._awardScoreList[2],this.selectAwardScore())},clickFourthAward:function(){!this._awardScoreList||this._awardScoreList.length<3||(game.nationalBoss.curSelectAwardScore=this._awardScoreList[3],this.selectAwardScore())},clickAllClear:function(){var e=game.nationalBoss.nationalBossScore;if((0|game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_CHUMO_SCORE))<=e){var t=game.ccfg.LangCfg.getText(85004);game.notice.show(t)}else{var i=game.nationalBoss.getChumoInfo();if(!i)return;game.gameAlert.showAlert(this,this.onClickGameAlert,i)}},onClickGameAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:b8e.log("扫荡"),game.nationalBoss.sendBatchChumo(!0);break;case game.GameAlertBtnType.CANCEL:b8e.log("一次"),game.nationalBoss.sendBatchChumo(!1);break;case game.GameAlertBtnType.CLOSE:}},selectAwardScore:function(){if(this._awardScoreList){var e=game.nationalBoss.curSelectAwardScore,t=this._awardScoreList.indexOf(e);this.updateAwrdGrid(t)}},updateAwrdGrid:function(e){var t=this._awardScoreList[e];if(-1!=e){var i=this._skin["grid_"+e].x;this._skin.grid_select.x=i,this._skin.prize_need_score.string=game.ccfg.LangCfg.getText(1035,[t]),t<=game.nationalBoss.nationalBossScore?(b8e.ShaderUtil.reset(this._skin.get_btn),this._skin.get_btn_red_point.active=!0):(b8e.ShaderUtil.setGray(this._skin.get_btn),this._skin.get_btn_red_point.active=!1),-1!=(e=this._isGetScoreList.indexOf(t))?(this._skin.get_btn.active=!1,this._skin.get_btn_red_point.active=!1,this._skin.is_get.active=!0):(this._skin.get_btn.active=!0,this._skin.is_get.active=!1),this.setPrizeContent()}}})},{}],554:[function(e,t,i){"use strict";game.NationalBossItem=game.SkinUI.extends({_nationalBossInfo:null,_head:null,_prizeList:null,_prizeInfo:null,_isShow:!1,ctor:function(){this._super("nationalBoss/NationalBossItemSkin","NationalBossItemSkin")},getButtonByName:function(e){switch(e){case"fight":return!this._skin||this._skin.btn_challenge}return null},getWidth:function(){return 545},getHeight:function(){return 193},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._head||(this._head=b8e.Sprite.get(),this._head.addToParent(this._skin.img_boss)),this.setData(this._nationalBossInfo),b8e.evt.onC(this._skin.btn_challenge,this.onClickBtnChallenge,this),b8e.evt.onC(this._skin.btn_check_kill_infos,this.onClickBtnCheckKillInfos,this),b8e.evt.onC(this._skin.btn_relive,this.onClickBtnRelive,this),b8e.evt.addG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE_TIPS,this.setReliveTips)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_challenge,this.onClickBtnChallenge,this),b8e.evt.offC(this._skin.btn_check_kill_infos,this.onClickBtnCheckKillInfos,this),b8e.evt.offC(this._skin.btn_relive,this.onClickBtnRelive,this),b8e.evt.rmvG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE_TIPS,this.setReliveTips)},setData:function(e){this._nationalBossInfo=e;var t=game.SysTime.curTime;if(this._nationalBossInfo&&this._skin){var i=game.ccfg.NationalBossCfg.getNationalBossById(e.sceneId);if(i){if(this.setNationalBossPoster(i.head),this.setNationalBossDropItem(i.killPrize),this._skin.img_relive.active=this._nationalBossInfo.notifyState,this._skin.lab_fightPopulation.node.active=!1,this._skin.lab_unlockLevel.node.active=!1,this._skin.lab_unlockDJLevel.node.active=!1,this._skin.btn_check_kill_infos.active=!1,this._skin.btn_relive.active=!0,this._nationalBossInfo.time>t){b8e.ShaderUtil.setGray(this._head),b8e.ShaderUtil.reset(this._skin.node,!0);var n=this._nationalBossInfo.time-game.SysTime.curTime;this._skin.lab_boss_revive_time.string=game.nationalBoss.formatTime(n)+"重生",this._skin.img_kill.active=!0,this._skin.btn_check_kill_infos.active=!0,this._skin.btn_challenge.active=!1,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateReliveTime,500)}else b8e.ShaderUtil.reset(this._head),b8e.ShaderUtil.reset(this._skin.node,!0),this._skin.lab_boss_revive_time.string="",this._skin.img_kill.active=!1,this._skin.btn_challenge.active=!0,this._skin.lab_fightPopulation.node.active=!0,this._skin.lab_fightPopulation.string="争夺:"+e.fightPopulation+"人";if(!this._nationalBossInfo.isUnlock)if(b8e.ShaderUtil.setGray(this._head),b8e.ShaderUtil.setGray(this._skin.node,!0),this._skin.btn_challenge.active=!1,this._skin.lab_unlockLevel.node.active=!0,this._skin.btn_relive.active=!1,1==this._nationalBossInfo.bossType&&0<i.dujieLevel){var s=game.ccfg.DujieCfg.getDataByLevel(i.dujieLevel);s&&(this._skin.lab_unlockLevel.string=s.name+" 开启")}else this._skin.lab_unlockLevel.string=i.unlockLevel+"级开启";this._skin.lab_name.string=i.name}}},updateReliveTime:function(){var e=this._nationalBossInfo.time-game.SysTime.curTime;e<=0?(this.setData(this._nationalBossInfo),this._timer&&this._timer.stop()):this._skin.lab_boss_revive_time.string=game.nationalBoss.formatTime(e)+"重生"},setRelive:function(e){if(e&&e.data){var t=e.data.sceneId;if(t==this._nationalBossInfo.sceneId){var i=game.nationalBoss.getBossInfoBySceneId(t);i&&(this._nationalBossInfo=i,this.setData(this._nationalBossInfo))}}},setNationalBossPoster:function(e){var t=game.ClientCfg.getLoneyDungeonHead(e);this._head.loadTexture(t,null,null,{useManifest:!1}),this._head.setSize(113,105),this._head.setAnchor(0,0)},setNationalBossDropItem:function(e){this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.DUNGEON_SHOW_PRIZE_CONTAINER_ID,this._prizeList.addToParent(this._skin.item_list)),0!=e&&(this._prizeInfo.setupById(e),this._prizeList.setData(this._prizeInfo))},setReliveTips:function(){this._nationalBossInfo=game.nationalBoss.getBossInfoBySceneId(this._nationalBossInfo.sceneId),this._skin.img_relive.active=this._nationalBossInfo.notifyState},onClickBtnChallenge:function(){game.nationalBoss.sendEnterNationalBossScene(this._nationalBossInfo.sceneId)},onClickBtnCheckKillInfos:function(){game.nationalBoss.checkKillInfos(this._nationalBossInfo.sceneId)},onClickBtnRelive:function(){var e=this._skin.img_relive.active;this._skin.img_relive.active=!e,game.nationalBoss.changeRelive(this._nationalBossInfo.sceneId,!e)}})},{}],555:[function(e,t,i){"use strict";game.NationalBossKillItem=game.SkinUI.extends({_killerInfo:null,_bsGrids:null,ctor:function(){this._super("nationalBoss/NationalBossKillItemSkin","NationalBossKillItemSkin")},init:function(){this._bsGrids=[]},getHeight:function(){return 120},getWidth:function(){return 540},onShow:function(){this._killerInfo&&this.setData(this._killerInfo)},onHide:function(){this.clearGrids()},setData:function(e){if(this._killerInfo=e,this._killerInfo&&this._skin){this.clearGrids();var t=b8e.TimeUtil.formatTimestamp(this._killerInfo.time,"h:m:s");this._skin.lab_killTime.string=t,this._skin.lab_name.string=this._killerInfo.name;var i=game.ValueUtil.formatNumber(this._killerInfo.power,1);if(this._skin.lab_combat.string=i,e.bianshens)for(var n,s,a,o=0,r=e.bianshens.length;o<r;o++)(s=e.bianshens[o])&&((a=this._bsGrids[o])||((a=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.TOWER_NOTICE_ID),a.addToParent(this._skin.bianshen_node),a.x=20+o*game.IcoSizeEnum.SIZE_72,a.setScale(game.IconScale.PERCENT_60,game.IconScale.PERCENT_60),this._bsGrids.push(a)),(n=game.ItemInfoUtil.createCommonBSInfo(s)).battle=!1,game.GridUtil.setBianshenGrid(a,n),a.sortLayer())}},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setItemGrid(e,null)}})},{}],556:[function(e,t,i){"use strict";game.appModule.NationalBossKillPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.NationalBossKillItem)),this._list.show(),this.setKillList()},onHide:function(){this._list&&this._list.hide()},setKillList:function(){var e=game.nationalBoss.getNationalBossKillInfo();!e||e.length<=0||this._list.setData(e)}})},{}],557:[function(e,t,i){"use strict";game.NationalBossLeft=game.SkinUI.extends({ownerId:0,ownerName:"",_head:null,ctor:function(){this._super("nationalBoss/NationalBossLeftSkin","NationalBossLeftSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.addToParent(this._skin.img_head)),this.setOwner(),this.onResize(),this._skin.owner_node.active=!1,b8e.evt.onC(this._skin.btn_transfer,this.onClickBtnTransfer,this),b8e.evt.onC(this._skin.btn_attack,this.onClickBtnAttack,this),b8e.evt.addG(this,game.NationalBossEvents.NATIONAL_BOSS_OWNER_CHANGE,this.setOwner)},onHide:function(){this._skin.owner_node.active=!1,this.ownerId=0,this.ownerName="",b8e.evt.offC(this._skin.btn_transfer,this.onClickBtnTransfer,this),b8e.evt.offC(this._skin.btn_attack,this.onClickBtnAttack,this),b8e.evt.rmvG(this,game.NationalBossEvents.NATIONAL_BOSS_OWNER_CHANGE,this.setOwner)},setOwner:function(){this.ownerId=game.nationalBoss.curSceneOwnerId,this.ownerName=game.nationalBoss.curSceneOwnerName;var e=game.sceneRole.getDisplayById(this.ownerId);if(e&&e.data){var t=game.mainRole.mainRoleData;this._skin.lab_name.string=this.ownerName;var i=game.html.Q_RED;e.data.isSelf?i=game.html.Q_GREEN:e.data.guildId==t.guildId&&0!=e.data.guildId&&(i=game.html.Q_GREEN),this._skin.lab_name.node.color=b8e.ColorUtil.toCCColor(i),this._skin.owner_node.active=!0,this._skin.lab_name.string=this.ownerName,""!=e.data.head&&e.data.head?this._head.loadTexture(game.ClientCfg.getHeadUrl(e.data.head),null,null,{useManifest:!1}):this._head.unloadTexture()}},onClickBtnTransfer:function(){0!=game.mainRole.mainRoleData.guildId?game.nationalBoss.callPeople():game.notice.show("玩家没有帮会，不能使用穿云箭！")},onClickBtnAttack:function(){if(0!=this.ownerId){var e=game.sceneRole.getDisplayById(this.ownerId);if(e){var t=game.mainRole.mainRoleData;e.data.isSelf?game.notice.show("不可攻击自己"):e.data.guildId!=t.guildId||0==e.data.guildId?game.ScenePickMgr.inst().pickTarget(e):game.notice.show("不可攻击同帮玩家，归属帮会共享")}}},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=0+e,this.y=280+t)}})},{}],558:[function(e,t,i){"use strict";game.NationalBossPanel=game.SkinUI.extends({_list:null,_showList:null,_showType:0,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._super("nationalBoss/NationalBossSkin","NationalBossSkin"),this._showList=[],this._showType=e},getButtonByName:function(e){switch(e){case"fight":if(this._list){var t,i=this._list.getItemRender(0);if(i)if(t=i.getButtonByName("fight"))return t}return!0}return null},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.NationalBossItem)),this._list.show(),game.loneyDungeon.getLoneyDungeonInfo(),b8e.evt.addG(this,game.NationalBossEvents.UPDATE_NATIONAL_BOSS_FIGHT_POPULATION,this.setNationalBossList),b8e.evt.addG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE,this.setNationalBossList),b8e.evt.addG(this,game.NationalBossEvents.KILL_NATIONAL_BOSS,this.setNationalBossList),b8e.evt.addG(this,game.NationalBossEvents.UPDATE_NATIONAL_BOSS,this.setNationalBossList),1==this._showType&&game.nationalBoss.crossNationalBossInfoRequest(),game.nationalBoss.sendNationalBossInfoRequest(0!=this._showType)||this.setNationalBossList()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.NationalBossEvents.UPDATE_NATIONAL_BOSS_FIGHT_POPULATION,this.setNationalBossList),b8e.evt.rmvG(this,game.NationalBossEvents.NATIONAL_BOSS_RELIVE,this.setNationalBossList),b8e.evt.rmvG(this,game.NationalBossEvents.KILL_NATIONAL_BOSS,this.setNationalBossList),b8e.evt.rmvG(this,game.NationalBossEvents.UPDATE_NATIONAL_BOSS,this.setNationalBossList)},setNationalBossList:function(){(this._showList.length=0)==this._showType?this._showList=game.nationalBoss.getAllNationalBossInfo():1==this._showType&&(this._showList=game.nationalBoss.getAllNeutralBossInfo()),!this._showList||this._showList.length<=0||(0==this._showType?this._showList.sort(this.onNationalBossSortList):this._showList.sort(this.onNeutralBossSortList),this._list.setData(this._showList))},onNationalBossSortList:function(e,t){return 0==e.isUnlock?0==t.isUnlock&&e.unlockLevel<t.unlockLevel?-1:1:0==t.isUnlock?0==e.isUnlock&&t.unlockLevel<e.unlockLevel?1:-1:e.time>game.SysTime.curTime?t.time>game.SysTime.curTime&&e.unlockLevel>t.unlockLevel?-1:1:t.time>game.SysTime.curTime?e.time>game.SysTime.curTime&&t.unlockLevel>e.unlockLevel?1:-1:e.unlockLevel>t.unlockLevel?-1:e.unlockLevel<t.unlockLevel?1:0},onNeutralBossSortList:function(e,t){return 0==e.isUnlock?0==t.isUnlock&&e.unlockDJLevel<t.unlockDJLevel?-1:1:0==t.isUnlock?0==e.isUnlock&&t.unlockDJLevel<e.unlockDJLevel?1:-1:e.time>game.SysTime.curTime?t.time>game.SysTime.curTime&&e.unlockDJLevel>t.unlockDJLevel?-1:1:t.time>game.SysTime.curTime?e.time>game.SysTime.curTime&&t.unlockDJLevel>e.unlockDJLevel?1:-1:e.unlockDJLevel>t.unlockDJLevel?-1:e.unlockDJLevel<t.unlockDJLevel?1:0}})},{}],559:[function(e,t,i){"use strict";game.appModule.NationalBossResultPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_leaveTime:0,ctor:function(e){this._super(e)},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this.showResult(),b8e.evt.onC(this._skin.sure_btn,this.onSureBtnClick,this)},onHide:function(){b8e.evt.offC(this._skin.sure_btn,this.onSureBtnClick,this)},onSureBtnClick:function(){b8e.Timer.remove(this,this.updateSureTime),game.nationalBoss.onLeaveScene(),this.hide()},showResult:function(){this.data&&(this.data.isKiller?(this._skin.lab_killer_info.string="您(或您的帮会)成功击杀了BOSS",this._skin.lab_killer_info.node.color=b8e.ColorUtil.toCCColor(4294950981),this._skin.lab_prize_type.string="击杀奖励"):(this._skin.lab_killer_info.string="未获得BOSS归属",this._skin.lab_killer_info.node.color=b8e.ColorUtil.toCCColor(4285510379),this._skin.lab_prize_type.string="参与奖励"),this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90,game.IconScale.PERCENT_80),this._prizeList.containerId=game.ContainerId.DUNGEON_DROP_PRIZE_LIST_ID,this._prizeList.addToParent(this._skin.list_item.content)),this._prizeInfo.setup(this.data.userItem),this._prizeList.setData(this._prizeInfo),this._leaveTime=10,b8e.Timer.add(this,this.updateSureTime,1e3))},updateSureTime:function(){0<this._leaveTime?(this._leaveTime--,this._skin.lab_sure_btn.string="确定("+this._leaveTime+"s)"):this.onSureBtnClick()}})},{}],560:[function(e,t,i){"use strict";game.NeutralBossAwardPanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,ctor:function(){this._super("nationalBoss/NeutralBossAwardSkin","NeutralBossAwardSkin")},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,5),this._prizeList.containerId=game.ContainerId.WORLD_BOSS_DROP_ID,this._prizeList.addToParent(this._skin.prize_node)},onShow:function(){this.createPrize(),this.updateExp(),this.onResize(),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_EXP_CHANGE,this.updateExp),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize)},onHide:function(){b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_EXP_CHANGE,this.updateExp),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onResize)},createPrize:function(){var e=game.ccfg.NationalBossCfg.getNationalBossById(game.nationalBoss.curNationalBossSceneId);e&&(this._prizeInfo.setupById(e.killPrize),this._prizeList.setData(this._prizeInfo),this.onResize())},updateExp:function(){var e=game.mainRole.mainRoleData,t=e.getExp(),i=e.getLv(),n=game.ccfg.ExpCfg.getExpByLevel(i),s=t/n;this._skin.expProgress.progress=s,this._skin.labExp.string=t+"/"+n},onResize:function(){if(this.setPosition(.5*(b8e.stageWidth-this.width),0),this._prizeList){var e=this._prizeList.realShowCount,t=game.IcoSizeEnum.SIZE_80*e,i=.5*(this.width-t);this._prizeList.setPosition(i,0)}}})},{}],561:[function(e,t,i){"use strict";e("./CallPanel"),e("./NationalBossItem"),e("./NationalBossKillPanel"),e("./NationalBossLeft"),e("./NationalBossPanel"),e("./NationalBossResultPanel"),e("./ChumoPanel"),e("./NeutralBossAwardPanel")},{"./CallPanel":552,"./ChumoPanel":553,"./NationalBossItem":554,"./NationalBossKillPanel":556,"./NationalBossLeft":557,"./NationalBossPanel":558,"./NationalBossResultPanel":559,"./NeutralBossAwardPanel":560}],562:[function(e,t,i){"use strict";var n=game.NationalBossSender=function(){};n.AllNationalBossInfoRequest=function(){var e=game.pbmid.Instance.AllNationalBossInfoRequest;b8e.sendN(e)},n.NationalBossInfoRequest=function(e,t){var i=game.pbmsg.NationalBossInfoRequest;i.cross=e,i.ids=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Instance.NationalBossInfoRequest;b8e.sendN(n)},n.SetNationalBossNotifyStateRequest=function(e,t){var i=game.pbmsg.SetNationalBossNotifyStateRequest;i.id=e,i.state=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Instance.SetNationalBossNotifyStateRequest;b8e.sendN(n)},n.EnterNationalSceneRequest=function(e){var t=game.pbmsg.EnterNationalSceneRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.EnterNationalSceneRequest;b8e.sendN(i)},n.LeaveNationalSceneRequest=function(e){var t=game.pbmsg.LeaveNationalSceneRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.LeaveNationalSceneRequest;b8e.sendN(i)},n.NationalBossKillListRequest=function(e){var t=game.pbmsg.NationalBossKillListRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.NationalBossKillListRequest;b8e.sendN(i)},n.chuMoScoreRequest=function(){var e=game.pbmid.Instance.ChuMoScoreRequest;b8e.sendN(e)},n.chuMoAwardCollectRequest=function(e){var t=game.pbmsg.ChuMoAwardCollectRequest;t.score=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.ChuMoAwardCollectRequest;b8e.sendN(i)},n.batchChumo=function(e){var t=game.pbmsg.ChuMoQuickCompleteRequest;t.completeAll=!!e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.ChuMoQuickCompleteRequest;b8e.sendN(i)},n.CrossNationalBossInfoRequest=function(){var e=game.pbmid.Instance.CrossNationalBossInfoRequest;b8e.sendN(e)}},{}],563:[function(e,t,i){"use strict";e("./NationalBossSender")},{"./NationalBossSender":562}],564:[function(e,t,i){"use strict";game.NickNameCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Nickname.NicknameModuleProto,this.onNicknameModuleProto,this),b8e.addNH(game.pbmid.Nickname.UnlockNicknameResponse,this.onUnlockNicknameResponse,this),b8e.addNH(game.pbmid.Nickname.UpdateNicknameResponse,this.onUpdateNicknameResponse,this),b8e.addNH(game.pbmid.Nickname.AddNicknameNotify,this.onAddNicknameNotify,this),b8e.addNH(game.pbmid.Nickname.RemoveNicknameNotify,this.onRemoveNicknameNotify,this)},onNicknameModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.NicknameModuleProto);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.nickName.setUpNickNameInfo(t)}else b8e.log("")},onUnlockNicknameResponse:function(e){var t=e.readProtobuf(game.pbmsg.UnlockNicknameResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.nickName.onUnlockNickNameResult(t)}else b8e.log("")},onUpdateNicknameResponse:function(e){var t=e.readProtobuf(game.pbmsg.UpdateNicknameResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.nickName.onUpdateNickNameResult(t)}else b8e.log("")},onAddNicknameNotify:function(e){var t=e.readProtobuf(game.pbmsg.AddNicknameNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):t.id&&game.nickName.onAddNicknameNotify(t.id)}else b8e.log("")},onRemoveNicknameNotify:function(e){var t=e.readProtobuf(game.pbmsg.RemoveNicknameNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.nickName.onRemoveNickNameNotify(t.id)}else b8e.log("")}})},{}],565:[function(e,t,i){"use strict";game.NickNameEnum=b8e.Enum({CHUANGDAI:1,XIEXIA:2,JIHUO:3,WEIJIHUO:4})},{}],566:[function(e,t,i){"use strict";game.NickNameEvent=b8e.Enum({UPDATENICKNAMEITEM:b8e.Event.nextCode()})},{}],567:[function(e,t,i){"use strict";game.NickNameMgr=b8e.Object.extends({nicknameInfo:null,choosedId:0,ctor:function(){this._super()},onNicknameModuleRequest:function(){game.NickNameSender.nicknameModuleRequest()},setUpNickNameInfo:function(e){this.nicknameInfo||(this.nicknameInfo=new game.NickNameInfo),this.nicknameInfo.setup(e),this.setChoosedId(this.nicknameInfo.using_id)},chickNickNameById:function(e){return!!this.nicknameInfo&&this.nicknameInfo.chickNickNameById(e)},setChoosedId:function(e){this.choosedId=e},getChoosedId:function(){return this.choosedId},setDefaultChoosedId:function(){if(this.getSelfNickName())this.setChoosedId(this.getSelfNickName());else{var e=game.ccfg.NickNameCfg.getAllData();e&&this.setChoosedId(e[0].id)}},upDateNickNameModule:function(){},getSelfNickName:function(){return this.nicknameInfo?this.nicknameInfo.using_id:null},setSelfNickName:function(e){this.nicknameInfo&&(this.nicknameInfo.using_id=e)},onUnlockNickName:function(e){game.NickNameSender.unlockNicknameRequest(e)},onUnlockNickNameResult:function(e){if(this.nicknameInfo){this.nicknameInfo.addNickName(e.id),b8e.evt.dptG(game.NickNameEvent.UPDATENICKNAMEITEM);var t="您已激活"+game.ccfg.NickNameCfg.getNameById(e.id)+"称号";game.notice.show(t)}},onUpdateNickName:function(e){game.NickNameSender.updateNicknameRequest(e)},onUpdateNickNameResult:function(e){0==e.id&&0!=this.getSelfNickName()&&game.notice.show("卸下成功"),0!=e.id&&this.getSelfNickName()!=e.id&&game.notice.show("穿戴成功"),this.setSelfNickName(e.id),b8e.evt.dptG(game.NickNameEvent.UPDATENICKNAMEITEM)},onAddNicknameNotify:function(e){this.nicknameInfo||(this.nicknameInfo=new game.NickNameInfo),this.nicknameInfo.addNickName(e),0==this.nicknameInfo.using_id&&this.autoUpdateNickName(),b8e.evt.dptG(game.NickNameEvent.UPDATENICKNAMEITEM)},onRemoveNickNameNotify:function(e){this.nicknameInfo&&(this.nicknameInfo.delNickNameById(e),this.getSelfNickName()==e&&this.setSelfNickName(0),b8e.evt.dptG(game.NickNameEvent.UPDATENICKNAMEITEM))},getNickNameStateById:function(e){if(this.nicknameInfo)return this.nicknameInfo.using_id==e?game.NickNameEnum.XIEXIA:this.chickNickNameById(e)?game.NickNameEnum.CHUANGDAI:game.ccfg.NickNameCfg.isGetBySelf(e)?game.NickNameEnum.WEIJIHUO:game.ccfg.NickNameCfg.isNeedItems(e)?this.isHasItemsJiHuo(e)?game.NickNameEnum.JIHUO:game.NickNameEnum.WEIJIHUO:void 0},isHasItemsJiHuo:function(e){var t=game.ccfg.NickNameCfg.getItemsById(e);if(!t)return falsel;for(var i=0;i<t.length;++i){var n=t[i];return game.back.getItemInfoCountById(n.Id)>=n.Num}},autoUpdateNickName:function(){if(this.nicknameInfo)for(var e=this.nicknameInfo.getNickNameList(),t=0;t<e.length;++t)if(!game.ccfg.NickNameCfg.isGetBySelf(0|e[t]))return void this.onUpdateNickName(0|e[t])},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.NICKNAME_ALERT,null,this.nickNameAlert,this)},nickNameAlert:function(){var e=game.ccfg.NickNameCfg.getAllData();if(!e)return!1;for(var t=0;t<e.length;++t)if(this.getNickNameStateById(e[t].id)==game.NickNameEnum.JIHUO)return!0;return!1}}),game.NickNameMgr._instance=null,game.NickNameMgr.inst=function(){return game.NickNameMgr._instance||(game.NickNameMgr._instance=new game.NickNameMgr),game.NickNameMgr._instance}},{}],568:[function(e,t,i){"use strict";e("./cmd/NickNameCmd"),e("./enum/NickNameEnum"),e("./event/NickNameEvent"),e("./manager/NickNameMgr"),e("./panel/nicknamepanelIndex"),e("./sender/NickNameSender")},{"./cmd/NickNameCmd":564,"./enum/NickNameEnum":565,"./event/NickNameEvent":566,"./manager/NickNameMgr":567,"./panel/nicknamepanelIndex":572,"./sender/NickNameSender":573}],569:[function(e,t,i){"use strict";game.NickNameDesc=game.SkinUI.extends({_sceneLayer:null,_anim:null,ctor:function(){this._super("nickname/NickNameDescSkin","NickNameDescSkin")},onShow:function(){this.onUpdata(),b8e.evt.addG(this,game.NickNameEvent.UPDATENICKNAMEITEM,this.onUpdata)},onHide:function(){b8e.evt.rmvG(this,game.NickNameEvent.UPDATENICKNAMEITEM,this.onUpdata)},onUpdata:function(){if(this._skin&&(this.clean(),game.ccfg.NickNameCfg.getAllData())){var e=game.nickName.getChoosedId(),t=game.ccfg.NickNameCfg.getDataById(e),i=t.attrId,n=game.ccfg.SpriteStatCfg.getSpriteStatById(i),s=game.mainRole.mainRoleData.getLv(),a=game.CCommonUtil.getPower(n,s);this._skin.atkLabel.string=a,this._skin.atkNode.active=0<a;for(var o="",r=0;r<3;++r)o=this.getSingleSpriteStatStr(n,r),this._skin["spriteStatLabel_"+r].string=o;game.ccfg.NickNameCfg.isNeedItems(e);this._skin.taskLabel.string="激活条件："+t.desc;var h=game.ccfg.NickNameCfg.getResById(e);this.showModel(h)}},getSpriteStatStr:function(e){var t,i,n="",s="",a="",o=0,r=e.getSpriteStats();if(r&&0<r.length)for(t=0;t<r.length;t++)if(i=r[t]){s=game.ccfg.AttrRulesCfg.getAttrNameByType(i.type),t!=r.length-1&&2==o?(a="\n",o=0):a="         ";var h=i.value;0<h&&o++,n+=s+"   <color = #74E610>+"+h+"</color>"+a}return n},getSingleSpriteStatStr:function(e,t){var i,n="",s=e.getSpriteStats();return!s||t>=s.length||t<0?n:(i=s[t])?n+=game.ccfg.AttrRulesCfg.getAttrNameByType(i.type)+" <color = #74E610>+"+i.value+"</color>":void 0},clean:function(){this._skin.atkLabel.string="",this._skin.spriteStatLabel_2.string="",this._skin.spriteStatLabel_1.string="",this._skin.spriteStatLabel_0.string="",this._skin.taskLabel.string=""},showModel:function(e){var t;this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.nickNameSpNode)),(t=game.ClientCfg.getUIFxs(e))?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.FIRST_RECHARGE_EFFECT_2,1),this._sceneLayer.addChild(this._anim)),this._anim.load(t),this._anim.play()):this._anim&&this._anim.clear()},clearAnimator:function(){this._anim&&this._anim.stop()}})},{}],570:[function(e,t,i){"use strict";game.NickNameItem=game.SkinUI.extends({m_data:null,m_type:0,iscanJiHuo:!1,nicknameicon:null,ctor:function(){this._super("nickname/NickNameItemSkin","NickNameItemSkin")},onShow:function(){this._skin.expireTime.string="",this.m_data?this.setData(this.m_data):b8e.warn("称号数据为空！"),b8e.evt.onC(this._skin.jihuoBnt,this.ontoggleClickBack,this),b8e.evt.onC(this._skin.updateNameBnt,this.ontoggleClickBack,this),b8e.evt.onC(this._skin.chooseBtn,this.onChooseItem,this)},onHide:function(){this.nicknameicon&&this.nicknameicon.unloadTexture(),b8e.evt.offC(this._skin.jihuoBnt,this.ontoggleClickBack,this),b8e.evt.offC(this._skin.updateNameBnt,this.ontoggleClickBack,this),b8e.evt.offC(this._skin.chooseBtn,this.onChooseItem,this)},getHeight:function(){return 118},getWidth:function(){return 540},setData:function(e){if((this.m_data=e)&&this._skin){var t=game.nickName.getNickNameStateById(e.id);if(this.m_type=t,this.setBntByType(t),e.id==game.nickName.getChoosedId()?this._skin.icon_wfg.active=!0:this._skin.icon_wfg.active=!1,e.id==game.nickName.getSelfNickName()?this._skin.chuangtai.active=!0:this._skin.chuangtai.active=!1,this.nicknameicon||(this.nicknameicon=b8e.Sprite.get(),this.nicknameicon.setAnchor(.5,.5),this.nicknameicon.addToParent(this._skin.nicknameicon)),this.nicknameicon.loadTexture(game.ClientCfg.getNickNameIconUrl(e.id),null,null,{useManifest:!1}),game.nickName.chickNickNameById(e.id)&&game.ccfg.NickNameCfg.getIsExpire(e.id)){var i=game.nickName.nicknameInfo.getNickNameById(e.id);if(i){game.SysTime.curTime,i.expire_time;this._skin.expireTime.string=game.ccfg.LangCfg.getText(28e3,[b8e.TimeUtil.formatTimestamp(i.expire_time)])}else this._skin.expireTime.string="",b8e.warn("没有找到ID为"+e.id+"的称号数据！")}else this._skin.expireTime.string=""}},setBntByType:function(e){switch(e){case game.NickNameEnum.XIEXIA:this._skin.weijihuoBg.active=!1,this._skin.btnNameLabel.string="卸下",this._skin.jihuoBnt.active=!1,this._skin.updateNameBnt.active=!0;break;case game.NickNameEnum.CHUANGDAI:this._skin.weijihuoBg.active=!1,this._skin.btnNameLabel.string="穿戴",this._skin.jihuoBnt.active=!1,this._skin.updateNameBnt.active=!0;break;case game.NickNameEnum.WEIJIHUO:this._skin.weijihuoBg.active=!0,this._skin.jihuoBnt.active=!1,this._skin.updateNameBnt.active=!1;break;case game.NickNameEnum.JIHUO:this._skin.weijihuoBg.active=!1,this._skin.jihuoBnt.active=!0,this._skin.updateNameBnt.active=!1}},ontoggleClickBack:function(){switch(this.m_type){case game.NickNameEnum.XIEXIA:game.nickName.onUpdateNickName(0);break;case game.NickNameEnum.CHUANGDAI:game.nickName.onUpdateNickName(this.m_data.id);break;case game.NickNameEnum.JIHUO:game.nickName.onUnlockNickName(this.m_data.id)}this.onChooseItem()},onChooseItem:function(){this.m_data&&this.m_data.id!=game.nickName.choosedId&&(game.nickName.setChoosedId(this.m_data.id),b8e.evt.dptG(game.NickNameEvent.UPDATENICKNAMEITEM))}})},{}],571:[function(e,t,i){"use strict";game.NickNamePanel=game.SkinUI.extends({nicknamedesc:null,list:null,ctor:function(){this._super("nickname/NickNamePanelSkin","NickNamePanelSkin")},onShow:function(){game.nickName.setDefaultChoosedId(),this.nicknamedesc||(this.nicknamedesc=new game.NickNameDesc,this.nicknamedesc.addToParent(this._skin.nickNameDescNode)),this.nicknamedesc.show(),this.list||(this.list=new b8e.List(this._skin.list,game.NickNameItem)),this.list.show(),this.onUpdata(),b8e.evt.addG(this,game.NickNameEvent.UPDATENICKNAMEITEM,this.onUpdata)},onHide:function(){this.list&&(this.list.setData(null),this.hide()),this.nicknamedesc.hide(),b8e.evt.rmvG(this,game.NickNameEvent.UPDATENICKNAMEITEM,this.onUpdata)},onUpdata:function(){var e=game.ccfg.NickNameCfg.getAllData();e&&this.list.setData(e)}})},{}],572:[function(e,t,i){"use strict";e("./NickNameDesc"),e("./NickNameItem"),e("./NickNamePanel")},{"./NickNameDesc":569,"./NickNameItem":570,"./NickNamePanel":571}],573:[function(e,t,i){"use strict";game.NickNameSender={},game.NickNameSender.nicknameModuleRequest=function(){var e=game.pbmid.Nickname.NicknameModuleRequest;b8e.sendN(e)},game.NickNameSender.unlockNicknameRequest=function(e){var t=game.pbmsg.UnlockNicknameRequest;t.id=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Nickname.UnlockNicknameRequest;b8e.sendN(i)},game.NickNameSender.updateNicknameRequest=function(e){var t=game.pbmsg.UpdateNicknameRequest;t.id=0|e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Nickname.UpdateNicknameRequest;b8e.sendN(i)}},{}],574:[function(e,t,i){"use strict";game.appModule.BubbleExpAlert=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.btn_go,this.onTransmists,this)},onHide:function(){b8e.evt.offC(this._skin.btn_go,this.onTransmists,this)},onTransmists:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CHANG_AN_SCENE_ID),t=game.ccfg.SceneCfg.getDataById(e);t&&(game.mainRole.mainRoleData.getLv()>=t.unlocklevel?(game.quest.changeAuto(!1),game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,e),this.hide()):game.notice.show("暂时还去不了这里哟"))}})},{}],575:[function(e,t,i){"use strict";e("./BubbleExpAlert")},{"./BubbleExpAlert":574}],576:[function(e,t,i){"use strict";game.OfflineAwardMgr=b8e.Object.extends({OfflineAward:null,ctor:function(){this._super()},setData:function(e){e&&(this.OfflineAward=e,game.IS_SHIELD_IOS_RECHARGE||game.app.show(game.AppConstant.OFFLINE_AWARD_PANEL))},getData:function(){return this.OfflineAward}}),game.OfflineAwardMgr._instance=null,game.OfflineAwardMgr._singleton=!0,game.OfflineAwardMgr.inst=function(){return null==game.OfflineAwardMgr._instance&&(game.OfflineAwardMgr._singleton=!1,game.OfflineAwardMgr._instance=new game.OfflineAwardMgr,game.OfflineAwardMgr._singleton=!0),game.OfflineAwardMgr._instance}},{}],577:[function(e,t,i){"use strict";e("./OfflineAwardMgr")},{"./OfflineAwardMgr":576}],578:[function(e,t,i){"use strict";e("./manager/managerIndex_19"),e("./panel/panelIndex_29")},{"./manager/managerIndex_19":577,"./panel/panelIndex_29":580}],579:[function(e,t,i){"use strict";game.appModule.OfflineAwardPanel=game.SkinUIPanel.extends({OfflineAward:null,ctor:function(e){this._super(e)},onShow:function(){this.setData(),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.updeteVipInfo),b8e.evt.addG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateCardInfo)},onHide:function(){b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.updeteVipInfo),b8e.evt.rmvG(this,game.PayEvents.UPDATE_PAY_INFO_SUCCESS,this.updateCardInfo)},setData:function(){if(this.OfflineAward=game.offlineAward.getData(),this.OfflineAward){var e=60*game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.OFFLINE_AWARD_MAX_TIME),t=this.formatTime(this.OfflineAward.offlineTime),i=b8e.TimeUtil.formatNum(e/3600)+"小时";this._skin.lab_offline_time.string="离线时间："+t,this._skin.lab_max_offline_time.string="最多累积"+i+"离线收益",this._skin.lab_gold.string=this.OfflineAward.gold,this._skin.lab_exp.string=this.OfflineAward.exp,this.updeteVipInfo(),this.updateCardInfo()}},updeteVipInfo:function(){var e=game.vip.getAddExpRate(),t=game.vip.getAddGoldRate();0<e&&(this._skin.lab_vip_addExp.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)),this._skin.lab_vip_addExp.string="+"+game.vip.getAddExpRate()+"%",0<t&&(this._skin.lab_vip_addGold.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)),this._skin.lab_vip_addGold.string="+"+game.vip.getAddGoldRate()+"%"},updateCardInfo:function(){this._cardsMap=game.pay.getCardsMap();var e,t,i=this._cardsMap.keys(),n=0;if(!i||i.length<=0)return this._skin.lab_card_addExp.string="+0%",void(this._skin.lab_card_addGold.string="+0%");for(var s=0;s<i.length;s++)e=0|i[s],(t=game.pay.getPayInfoIdByType(e))&&(n+=game.ccfg.CardRechargeCfg.getCardRechargeRate(0|t.id));0<n&&(this._skin.lab_card_addExp.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)),this._skin.lab_card_addExp.string="+"+n+"%",0<n&&(this._skin.lab_card_addGold.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)),this._skin.lab_card_addGold.string="+"+n+"%"},formatTime:function(e){e<0&&(e=0),e*=.001;var t=b8e.TimeUtil.formatNum(e/3600);return 0<t?t+"小时"+b8e.TimeUtil.formatNum(e%3600/60)+"分钟"+b8e.TimeUtil.formatNum(e%60)+"秒":b8e.TimeUtil.formatNum(e/60)+"分钟"+b8e.TimeUtil.formatNum(e%60)+"秒"}})},{}],580:[function(e,t,i){"use strict";e("./OfflineAwardPanel")},{"./OfflineAwardPanel":579}],581:[function(e,t,i){"use strict";game.OrnamentCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Ornament.OrnamentModuleResponse,this.onOrnamentModuleResponse,this),b8e.addNH(game.pbmid.Ornament.OrnamentUpgradeResponse,this.onOrnamentUpgradeResponse,this),b8e.addNH(game.pbmid.Ornament.OrnamentEnsoulResponse,this.onOrnamentEnsoulResponse,this),b8e.addNH(game.pbmid.Ornament.OrnamentPutOnResponse,this.onOrnamentPutOnResponse,this),b8e.addNH(game.pbmid.Ornament.OrnamentPutOffResponse,this.onOrnamentPutOffResponse,this)},onOrnamentModuleResponse:function(e){var t=e.readProtobuf(game.pbmsg.OrnamentModuleResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ornament.synOrnamentInfo(t)}},onOrnamentUpgradeResponse:function(e){var t=e.readProtobuf(game.pbmsg.OrnamentUpgradeResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ornament.rpOrnamentUpgrade(t)}},onOrnamentEnsoulResponse:function(e){var t=e.readProtobuf(game.pbmsg.OrnamentEnsoulResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ornament.rpOrnamentEnsoul(t)}},onOrnamentPutOnResponse:function(e){var t=e.readProtobuf(game.pbmsg.OrnamentPutOnResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ornament.rpOrnamentPutOn(t)}},onOrnamentPutOffResponse:function(e){var t=e.readProtobuf(game.pbmsg.OrnamentPutOffResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.ornament.rpOrnamentPutOff(t)}}})},{}],582:[function(e,t,i){"use strict";game.OrnamentEvent=b8e.Enum({ORNAMENT_ITEM_SELECTED:b8e.Event.nextCode(),ACTIVE_SUCCEED:b8e.Event.nextCode(),UPGRADE_SUCCEED:b8e.Event.nextCode(),ENSOUL_SUCCEED:b8e.Event.nextCode(),PUTON_SUCCEED:b8e.Event.nextCode(),PUTOFF_SUCCEED:b8e.Event.nextCode(),REFRESH_ALERT:b8e.Event.nextCode()})},{}],583:[function(e,t,i){"use strict";game.OrnamentMgr=b8e.Object.extends({ctor:function(){if(1==game.OrnamentMgr._singleton)throw new Error("OrnamentMgr 只能通过单例方法获取");this._super(),this.curWear=0,this._isOrnamentInfoInit=!1,this.ornamentInfoMap=b8e.HashMap.get()},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.ORNAMENT)&&this.rqOrnamentInfo()},rqOrnamentInfo:function(){game.OrnamentSender.OrnamentModuleRequest()},synOrnamentInfo:function(e){if(e){if(this.curWear=e.curWear,this.initOrnamentInfos(),e.list)for(var t,i,n=e.list.length,s=0;s<n;s++)t=e.list[s],(i=this.ornamentInfoMap.get(t.itemId))&&i.setup(t);this.showAlert=game.ornament.checkShowAlert(),b8e.evt.dptG(game.OrnamentEvent.REFRESH_ALERT)}},rqOrnamentUpgrade:function(e){game.OrnamentSender.OrnamentUpgradeRequest(e)},rpOrnamentUpgrade:function(e){b8e.Tween.kill(this),b8e.Tween.get(this).wait(200).call(this._rpOrnamentUpgrade,this,[e])},_rpOrnamentUpgrade:function(e){var t=this.getOrnamentInfoById(e.itemId);if(t){var i=0==t.level;t.level=e.level,i?(game.app.show(game.AppConstant.ORNAMENT_UPGRADE_PANEL,t),b8e.evt.dptG(game.OrnamentEvent.ACTIVE_SUCCEED,t)):b8e.evt.dptG(game.OrnamentEvent.UPGRADE_SUCCEED,t),this.showAlert=game.ornament.checkShowAlert(),b8e.evt.dptG(game.OrnamentEvent.REFRESH_ALERT)}},rqOrnamentEnsoul:function(e,t){game.OrnamentSender.OrnamentEnsoulRequest(e,t)},rpOrnamentEnsoul:function(e){b8e.Tween.kill(this),b8e.Tween.get(this).wait(200).call(this._rpOrnamentEnsoul,this,[e])},_rpOrnamentEnsoul:function(e){var t=this.getOrnamentInfoById(e.itemId);t&&(t.ensoul+=e.count,b8e.evt.dptG(game.OrnamentEvent.ENSOUL_SUCCEED,t),this.showAlert=game.ornament.checkShowAlert(),b8e.evt.dptG(game.OrnamentEvent.REFRESH_ALERT))},rqOrnamentPutOn:function(e){game.OrnamentSender.OrnamentPutOnRequest(e)},rpOrnamentPutOn:function(e){var t=this.getOrnamentInfoById(e.id);t&&(this.curWear=e.id,b8e.evt.dptG(game.OrnamentEvent.PUTON_SUCCEED,t))},rqOrnamentPutOff:function(){game.OrnamentSender.OrnamentPutOffRequest()},rpOrnamentPutOff:function(e){this.curWear=0,b8e.evt.dptG(game.OrnamentEvent.PUTOFF_SUCCEED)},initOrnamentInfos:function(){if(!this._isOrnamentInfoInit){var e=game.ccfg.OrnamentCfg.getDatas();if(e){this.ornamentInfoMap.clear();for(var t,i,n=e.length,s=0;s<n;s++)t=e[s],(i=this.ornamentInfoMap.get(t.itemId))||((i=new game.OrnamentInfo).setup(t),i.level=0,i.ensoul=0,this.ornamentInfoMap.set(i.itemId,i));this._isOrnamentInfoInit=!0}}},getOrnamentInfoById:function(e){return this.ornamentInfoMap.get(e)},checkShowAlert:function(){for(var e=this.ornamentInfoMap.values(),t=e.length-1;0<=t;t--){if(this.checkCanActiveOrJinjie(e[t].itemId))return!0;if(this.checkCanEnsoul(e[t].itemId))return!0}return!1},checkCanActiveOrJinjie:function(e){var t=this.getOrnamentInfoById(e);if(!t)return!1;var i=game.ccfg.OrnamentCfg.getMaxLevel(t.itemId);return!(t.level>=i)&&!(0<this.getActiveOrJinjieDiscontentId(t))},getActiveOrJinjieDiscontentId:function(e){var t,i,n=game.ccfg.OrnamentCfg.getCostItemInfo(e.itemId,e.level);if(!n||n.length<0)return 0;for(var s=n.length-1;0<=s;s--)if((t=n[s])&&(!(i=game.back.getItemInfoById(t.Id))||i.num<t.Num))return t.Id;return 0},checkCanEnsoul:function(e){var t=this.getOrnamentInfoById(e);if(!t)return!1;if(t.level<=0)return!1;if(this.getCanEnsoulCount(e)<=0)return!1;e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ORNAMENT_ENSOUL_ITEM);var i=game.back.getItemInfoById(e);return!(!i||i.num<=0)},getCanEnsoulCount:function(e){var t=this.getOrnamentInfoById(e);return t?game.ccfg.OrnamentCfg.getMaxEnSoul(t.itemId,t.level)-t.ensoul:0},calOrnamentAttr:function(t){if(t){var i,e=game.ccfg.OrnamentCfg.getDataByItemIdAndLv(t.itemId,t.level).attr,n=game.ccfg.SpriteStatCfg.getSpriteStatById(e).getSpriteStats();if(0<t.ensoul){var s=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ORNAMENT_ENSOUL_ATTR),a=game.ccfg.SpriteStatCfg.getSpriteStatById(s);if(a)for(var o=0;o<t.ensoul;o++)n=n.concat(a.getSpriteStats())}t.attrMap.clear(),n.forEach(function(e){(i=t.attrMap.get(e.type))?t.attrMap.set(e.type,i+e.value):t.attrMap.set(e.type,e.value)},this)}},getCombat:function(e){var i=0,t=this.getOrnamentInfoById(e);if(t){var n,s=0,a=game.ccfg.LvPowerCoefCfg.getLvCoefByLv(0<t.level?t.level:1),o=0;this.calOrnamentAttr(t),t.attrMap.forEach(function(e,t){if(n=game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(e))switch(o=game.ValueUtil.getDigitsValueByNum(n.coef,4),n.type){case game.AttrPowerCoefType.TYPE_0:s=t*o;break;case game.AttrPowerCoefType.TYPE_1:s=t*o*a}i+=Math.round(s)},this)}return~~i},getAllData:function(){return this.ornamentInfoMap.values()}}),game.OrnamentMgr._instance=null,game.OrnamentMgr._singleton=!0,game.OrnamentMgr.inst=function(){return null==game.OrnamentMgr._instance&&(game.OrnamentMgr._singleton=!1,game.OrnamentMgr._instance=new game.OrnamentMgr,game.OrnamentMgr._singleton=!0),game.OrnamentMgr._instance}},{}],584:[function(e,t,i){"use strict";game.OrnamentItem=game.SkinUI.extends({ctor:function(e){this._super("ornament/OrnamentItemSkin","OrnamentItemSkin"),this._ornamentInfo=e},init:function(){this._iconImg||(this._iconImg=b8e.Sprite.get(),this._iconImg.addToParent(this._skin.img_icon))},onShow:function(){b8e.evt.onC(this._skin.btn_select,this.onSelect,this),b8e.evt.addG(this,game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,this.onSelected),b8e.evt.addG(this,game.OrnamentEvent.ACTIVE_SUCCEED,this.onActiveSucceed),b8e.evt.addG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onActiveSucceed),b8e.evt.addG(this,game.OrnamentEvent.PUTON_SUCCEED,this.setPutOnStatus),b8e.evt.addG(this,game.OrnamentEvent.PUTOFF_SUCCEED,this.setPutOnStatus),this.setData(this._ornamentInfo)},onHide:function(){this.clear(),b8e.evt.offC(this._skin.btn_select,this.onSelect,this),b8e.evt.rmvG(this,game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,this.onSelected),b8e.evt.rmvG(this,game.OrnamentEvent.ACTIVE_SUCCEED,this.onActiveSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onActiveSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.PUTON_SUCCEED,this.setPutOnStatus),b8e.evt.rmvG(this,game.OrnamentEvent.PUTOFF_SUCCEED,this.setPutOnStatus)},clear:function(){this._ornamentInfo=null},onSelect:function(){this._ornamentInfo&&b8e.evt.dptG(game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,this._ornamentInfo)},onSelected:function(e){e.data&&(game.ornament.selectItemId=e.data.itemId,this.setSelect(e.data.itemId))},onActiveSucceed:function(e){if(e.data){var t=e.data.itemId;t&&this._ornamentInfo&&t==this._ornamentInfo.itemId&&this.setData(e.data)}},setSelect:function(e){e&&this._ornamentInfo&&(this._skin.img_select.active=e==this._ornamentInfo.itemId)},setShowAlert:function(){this._ornamentInfo&&(this._skin.img_alert.active=game.ornament.checkCanActiveOrJinjie(this._ornamentInfo.itemId)||game.ornament.checkCanEnsoul(this._ornamentInfo.itemId))},setPutOnStatus:function(){this._skin&&this._ornamentInfo&&(this._skin.img_put_on.active=game.ornament.curWear==this._ornamentInfo.itemId)},setData:function(e){this._ornamentInfo=e,this._skin&&this._ornamentInfo&&(this.setIcon(),this.setName(),this.setShowAlert(),this.setPutOnStatus(),this.setSelect(game.ornament.selectItemId))},setIcon:function(){if(this._iconImg){var e=game.ccfg.OrnamentCfg.getIconRes(this._ornamentInfo.itemId);this._iconImg.loadTexture(game.ClientCfg.getOrnamentUrl(e),null,null,{useManifest:!1}),this._ornamentInfo.level<=0?b8e.ShaderUtil.setGray(this._iconImg):b8e.ShaderUtil.reset(this._iconImg)}},setName:function(){var e=this.getNameColor(game.ccfg.OrnamentCfg.getQuality(this._ornamentInfo.itemId,this._ornamentInfo.level)),t=game.ccfg.OrnamentCfg.getName(this._ornamentInfo.itemId),i=game.html.getText(e,t)+"\n";0<this._ornamentInfo.level?i+=game.html.getText(e,game.ccfg.LangCfg.getText(79303,[this._ornamentInfo.level])):i+=game.html.getText(game.html.Q_RED,game.ccfg.LangCfg.getText(79302)),this._skin.lab_name.string=i},getNameColor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return game.html.getColorByQuality(e)},getHeight:function(){return 180},getWidth:function(){return 110}})},{}],585:[function(e,t,i){"use strict";game.OrnamentJinjieItem=game.SkinUI.extends({ctor:function(e){this._super("ornament/OrnamentJinjieItemSkin","OrnamentJinjieItemSkin")},init:function(){},onShow:function(){this.setData(this._ornamentInfo)},onHide:function(){this._skillIcon&&this._skillIcon.hide()},setData:function(e){(this._ornamentInfo=e)&&this._skin&&(-1==this._ornamentInfo.level?this.setMaxLevel(!0):(this.setMaxLevel(!1),this.setName(),this.createAttr(),this.setSkillIcon()))},setMaxLevel:function(e){this._skin.max_lab_desc.node.active=e,this._skin.lab_name.node.active=!e,this._skin.lab_attr.node.active=!e,this._skillIcon&&(e?this._skillIcon.hide():this._skillIcon.show())},setName:function(){var e=this._ornamentInfo.itemId,t=this._ornamentInfo.level,i=game.ccfg.OrnamentCfg.getDataByItemIdAndLv(e,t);if(i){var n=this.getNameColor(i.quality),s=game.ccfg.OrnamentCfg.getName(this._ornamentInfo.itemId);this._skin.lab_name.string=game.html.getText(n,s)+"\n"+game.html.getText(n,"（"+this._ornamentInfo.level+"阶）")}},getNameColor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return game.html.getColorByQuality(e)},createAttr:function(){if(this._ornamentInfo){game.ornament.calOrnamentAttr(this._ornamentInfo);var i="";this._ornamentInfo.attrMap.forEach(function(e,t){i+=this.getAttrStr(e,t)},this),this._skin.lab_attr.string=i}},getAttrStr:function(e,t){switch(game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(e).type){case game.AttrPowerCoefType.TYPE_1:return game.ccfg.AttrRulesCfg.getAttrNameByType(e)+":  "+(100*t).toFixed(1)+"%<br/>";default:return game.ccfg.AttrRulesCfg.getAttrNameByType(e)+":  "+Math.round(t)+"<br/>"}},setSkillIcon:function(){this._skillIcon||(this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_ORNAMENT_SKILL),this._skillIcon.setAnchor(.5,.5),this._skillIcon.addToParent(this._skin.skill_node)),this._skillIcon.setOrnamentSkillData(this._ornamentInfo,!0,!0,!1),this._skillIcon.show()},getHeight:function(){return 310},getWidth:function(){return 255}})},{}],586:[function(e,t,i){"use strict";game.appModule.OrnamentJinjiePanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},init:function(){this._model||(this._model=b8e.SceneEntity.get(),this._model.setFaceRadian(game.Direction.getRadian(game.Direction.Down)),this._model.addToParent(this._skin.model_node)),this._list||(this._list=new b8e.List(this._skin.list,game.OrnamentJinjieItem))},onShow:function(){this._ornamentInfo=this.data,this._list&&this._list.show(),this.createModel(),this.createAttrPanel(),this.createCost(0),b8e.evt.onC(this._skin.btn_jinjie,this.onClickJinjie,this),b8e.evt.addG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onUpgradeSucceed)},onHide:function(){this._ornamentInfo=null,this._list&&this._list.hide();var e=this._model.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),b8e.evt.offC(this._skin.btn_jinjie,this.onClickJinjie,this),b8e.evt.rmvG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onUpgradeSucceed)},onClickJinjie:function(){if(this._ornamentInfo){var e=game.ccfg.OrnamentCfg.getMaxLevel(this._ornamentInfo.itemId);this._ornamentInfo.level>=e?game.notice.show(79300):game.ornament.rqOrnamentUpgrade(this._ornamentInfo.itemId)}},onUpgradeSucceed:function(e){e.data&&(this._ornamentInfo=e.data,this.createCost(1),this.createAttrPanel(),this.playEffect())},playEffect:function(){var e=game.ClientCfg.getUIFxs("10025");this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._skin.effect_node)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.BIANSHEN_JINJIE_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._anim.load(e),this._anim.addFinishCallback(this.onCompleteOtherEffect,this),this._anim.play(null,0)):this._anim&&this._anim.clear()},onCompleteOtherEffect:function(){this._effect&&this._effect.setVisible(!1)},createCost:function(e){if(this._ornamentInfo){var t=game.ccfg.OrnamentCfg.getDataByItemIdAndLv(this._ornamentInfo.itemId,this._ornamentInfo.level);if(t&&t.cost&&!(t.cost.lenght<=0)){var i=t.cost[0],n=game.ccfg.ItemInfoCfg.getItemInfoById(i.Id);if(n){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(this.COST_CONTAINER_ID),this._itemGrid.addToParent(this._skin.icon_node)),this._itemGrid.fnOnClick(this,this.onClickItemGrid),game.GridUtil.setItemGrid(this._itemGrid,n,!1),this._itemGrid.sortLayer(),this._skin.lab_name.string=n.name;var s=this.getNameColor(t.quality),a=game.html.getText(s,n.name)+"\n",o=game.back.getItemInfoById(i.Id),r=o?o.num:0,h=i.Num;a+=game.html.getText(h<=r?game.html.Q_GREEN:game.html.Q_RED,"（"+r+"/"+h+"）"),this._skin.lab_name.string=a}}}},onClickItemGrid:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},getNameColor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return game.html.getColorByQuality(e)},createModel:function(){if(this._ornamentInfo){var e=game.ccfg.OrnamentCfg.getUIRes(this._ornamentInfo.itemId),t=game.ClientCfg.getUIOrnament(e),i=this._model.getAnimator(game.AnimatorType.BODY,1);if(!i){i=this._model.addAnimator(game.AnimatorType.BODY,1,1);var n=game.ccfg.OrnamentCfg.getJinjieUIScale(this._ornamentInfo.itemId);i.setScale(n,n)}t&&i?(i.load(t),i.play()):i&&i.clear()}},createAttrPanel:function(){if(this._ornamentInfo&&this._list){this._nextLvInfo||(this._nextLvInfo=new game.OrnamentInfo),this._nextLvInfo.setup(this._ornamentInfo);var e=game.ccfg.OrnamentCfg.getMaxLevel(this._ornamentInfo.itemId);this._ornamentInfo.level>=e?this._nextLvInfo.level=-1:this._nextLvInfo.level++;var t=[this._ornamentInfo,this._nextLvInfo];this._list.setData(t)}}})},{}],587:[function(e,t,i){"use strict";game.OrnamentPanel=game.SkinUI.extends({ctor:function(){this._super("ornament/OrnamentSkin","OrnamentSkin"),this._goto=[]},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.OrnamentItem)),this._nameImg||(this._nameImg=b8e.Sprite.get(),this._nameImg.setAnchor(0,1),this._nameImg.addToParent(this._skin.name_node)),this._model||(this._model=b8e.SceneEntity.get(),this._model.addToParent(this._skin.model_node),this._model.setFaceRadian(game.Direction.getRadian(game.Direction.Down)))},onShow:function(){this._list&&this._list.show(),this.createOrnamentList(),b8e.evt.onC(this._skin.btn_active,this.onClickActive,this),b8e.evt.onC(this._skin.btn_jinjie,this.onClickUpgrade,this),b8e.evt.onC(this._skin.btn_soul,this.onClickSoul,this),b8e.evt.onC(this._skin.btn_use,this.onClickUse,this),b8e.evt.onC(this._skin.btn_disuse,this.onClickDisUse,this),b8e.evt.addG(this,game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,this.onSelected),b8e.evt.addG(this,game.OrnamentEvent.ACTIVE_SUCCEED,this.onUpgradeSucceed),b8e.evt.addG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onUpgradeSucceed),b8e.evt.addG(this,game.OrnamentEvent.ENSOUL_SUCCEED,this.onEnSoulSucceed),b8e.evt.addG(this,game.OrnamentEvent.PUTON_SUCCEED,this.onPutOnSucceed),b8e.evt.addG(this,game.OrnamentEvent.PUTOFF_SUCCEED,this.onPutOffSucceed);var e=game.ornament.getAllData();e&&0<e.length&&(game.ornament.selectItemId=e[0].itemId,b8e.evt.dptG(game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,e[0]))},onHide:function(){this._list&&this._list.hide(),b8e.Tween.kill(this);var e=this._model.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),this.clearGoto(),b8e.evt.offC(this._skin.btn_active,this.onClickActive,this),b8e.evt.offC(this._skin.btn_jinjie,this.onClickUpgrade,this),b8e.evt.offC(this._skin.btn_soul,this.onClickSoul,this),b8e.evt.offC(this._skin.btn_use,this.onClickUse,this),b8e.evt.offC(this._skin.btn_disuse,this.onClickDisUse,this),b8e.evt.rmvG(this,game.OrnamentEvent.ORNAMENT_ITEM_SELECTED,this.onSelected),b8e.evt.rmvG(this,game.OrnamentEvent.ACTIVE_SUCCEED,this.onUpgradeSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.UPGRADE_SUCCEED,this.onUpgradeSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.ENSOUL_SUCCEED,this.onEnSoulSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.PUTON_SUCCEED,this.onPutOnSucceed),b8e.evt.rmvG(this,game.OrnamentEvent.PUTOFF_SUCCEED,this.onPutOffSucceed)},onClickUse:function(){game.ornament.rqOrnamentPutOn(this._ornamentInfo.itemId)},onPutOnSucceed:function(){this.setUseStatus()},onClickDisUse:function(){game.ornament.rqOrnamentPutOff()},onPutOffSucceed:function(){this.setUseStatus()},onUpgradeSucceed:function(e){this._ornamentInfo=e.data,this._ornamentInfo&&(this.createOrnamentList(),this.setActiveStatus(),this.createAttr(),this.createCombat(),this.createSkillIcon(),this.createEnsoulCost(),this.setAlertShow())},onEnSoulSucceed:function(e){this._ornamentInfo=e.data,this._ornamentInfo&&(this.createOrnamentList(),this.createEnsoulCost(),this.createAttr(),this.createCombat(),this.setAlertShow())},onClickActive:function(){if(this._ornamentInfo&&!(0<this._ornamentInfo.level))if(game.ornament.checkCanActiveOrJinjie(this._ornamentInfo.itemId))game.ornament.rqOrnamentUpgrade(this._ornamentInfo.itemId);else{var e=game.ornament.getActiveOrJinjieDiscontentId(this._ornamentInfo),t=game.ccfg.ItemInfoCfg.getItemInfoById(e);t?game.notice.show(game.ccfg.LangCfg.getText(79305,[t.name])):b8e.warn("背饰",e,"激活需要的道具没有找到配置数据")}},onClickUpgrade:function(){this._ornamentInfo&&game.app.show(game.AppConstant.ORNAMENT_JINJIE_PANEL,this._ornamentInfo)},onClickSoul:function(){if(this._ornamentInfo){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ORNAMENT_ENSOUL_ITEM),t=game.back.getItemInfoById(e);if(t&&0<t.num)game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:t,containerId:game.ContainerId.ORNAMENT_CONTAINER_ID,ornamentInfo:this._ornamentInfo});else{var i=game.ccfg.ItemInfoCfg.getItemInfoById(e);i?game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:i,containerId:game.ContainerId.ORNAMENT_CONTAINER_ID,ornamentInfo:this._ornamentInfo}):b8e.warn("背饰",e,"没有找到配置数据")}}},setAlertShow:function(){this._ornamentInfo&&(this._skin.active_alert.active=game.ornament.checkCanActiveOrJinjie(this._ornamentInfo.itemId)&&this._ornamentInfo.level<=0,this._skin.jinjie_alert.active=game.ornament.checkCanActiveOrJinjie(this._ornamentInfo.itemId)&&0<=this._ornamentInfo.level,this._skin.ensoul_alert.active=game.ornament.checkCanEnsoul(this._ornamentInfo.itemId))},createOrnamentList:function(){if(this._list){var e=game.ornament.getAllData();this._list.setData(e)}},onSelected:function(e){e.data&&(this._ornamentInfo=e.data,this.setActiveStatus(),this.createModel(),this.createGoto(),this.createAttr(),this.createCombat(),this.createName(),this.createSkillIcon(),this.createEnsoulCost(),this.setUseStatus(),this.setAlertShow())},setActiveStatus:function(){var e=0<this._ornamentInfo.level;this._skin.func_panel.active=e,this._skin.btn_active.active=!e},setUseStatus:function(){var e=game.ornament.curWear==this._ornamentInfo.itemId;this._skin.btn_use.active=!e,this._skin.btn_disuse.active=e},createModel:function(){var e=this._ornamentInfo.itemId,t=game.ccfg.OrnamentCfg.getUIRes(e),i=game.ClientCfg.getUIOrnament(t),n=this._model.getAnimator(game.AnimatorType.BODY,1);if(!n){n=this._model.addAnimator(game.AnimatorType.BODY,1,1);var s=game.ccfg.OrnamentCfg.getMainUIScale(e);n.setScale(s,s)}i&&n?(n.load(i),n.play()):n&&n.clear()},createGoto:function(){this.clearGoto();var e=this._ornamentInfo.itemId,t=game.ccfg.OrnamentCfg.getGoto(e);if(t&&""!=t){var i=t.split(",");if(i&&!(i.length<=0)){this._skin.goto_node.setPosition(294,310);for(var n=0,s=i.length,a=null,o=0;o<s;o++)(a=this._goto[o])||((a=new game.BianshenTrigger).addToParent(this._skin.goto_node),this._goto.push(a)),a.setData(i[o]),a.setPosition(n,0),n+=a.getWidth()+5,a.show();this._skin.goto_node.setPosition(294-n/2+55,310)}}},clearGoto:function(){if(this._goto)for(var e=this._goto.length-1;0<=e;e--)this._goto[e]&&this._goto[e].hide()},createAttr:function(){if(this._ornamentInfo){game.ornament.calOrnamentAttr(this._ornamentInfo);var i=game.ccfg.LangCfg.getText(79304);this._ornamentInfo.attrMap.forEach(function(e,t){game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(e).type!=game.AttrPowerCoefType.TYPE_1&&(i+=game.ccfg.AttrRulesCfg.getAttrNameByType(e)+" +"+Math.round(t)+"<br/>")},this),this._skin.lab_attr.string=i+"</size>"}},createCombat:function(){var e=this._ornamentInfo.itemId;this._skin.lab_combat.string=game.ornament.getCombat(e)},createName:function(){var e=this._ornamentInfo.itemId;if(this._nameImg){var t=game.ccfg.OrnamentCfg.getNameRes(e);this._nameImg.loadTexture(game.ClientCfg.getOrnamentUrl(t),null,null,{useManifest:!1})}},createSkillIcon:function(){this._skillIcon||(this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_ORNAMENT_SKILL),this._skillIcon.setAnchor(.5,.5),this._skillIcon.addToParent(this._skin.skill_node)),this._skillIcon.setOrnamentSkillData(this._ornamentInfo,!0,!1,!1),this._skillIcon.show()},createEnsoulCost:function(){if(this._ornamentInfo){var e=game.ccfg.OrnamentCfg.getMaxEnSoul(this._ornamentInfo.itemId,this._ornamentInfo.level),t=this._ornamentInfo.ensoul;this._skin.lab_cost.string=game.html.getText(game.html.Q_GREEN,t+"/"+e)}}})},{}],588:[function(e,t,i){"use strict";game.appModule.OrnamentUpgradePanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e),this._itemId=0},init:function(){this._model||(this._model=b8e.SceneEntity.get(),this._model.setFaceRadian(game.Direction.getRadian(game.Direction.Down)),this._model.addToParent(this._skin.model_node)),this._nameImg||(this._nameImg=b8e.Sprite.get(),this._nameImg.setAnchor(0,1),this._nameImg.addToParent(this._skin.name_node))},onShow:function(){this._itemId=this.data.itemId,this.createModel(),this.createCombat(),this.createName(),b8e.evt.onC(this._skin.btn_sure,this._onClickSureBtn,this)},onHide:function(){var e=this._model.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),b8e.evt.offC(this._skin.btn_sure,this._onClickSureBtn,this)},createEffect:function(){var e=this._model.getAnimator(game.AnimatorType.ACCESSORY_EFFECT,1);e||(e=this._model.addAnimator(game.AnimatorType.ACCESSORY_EFFECT,1,1)).load(),e.play()},createModel:function(){if(this._itemId&&!(this._itemId<=0)){var e=game.ccfg.OrnamentCfg.getUIRes(this._itemId),t=game.ClientCfg.getUIOrnament(e),i=this._model.getAnimator(game.AnimatorType.BODY,1);i||(i=this._model.addAnimator(game.AnimatorType.BODY,1,1)),t&&i?(i.load(t),i.play()):i&&i.clear()}},createName:function(){if(this._itemId&&!(this._itemId<=0)&&this._nameImg){var e=game.ccfg.OrnamentCfg.getNameRes(this._itemId);this._nameImg.loadTexture(game.ClientCfg.getOrnamentUrl(e),null,null,{useManifest:!1})}},createCombat:function(){!this._itemId||this._itemId<=0||(this._skin.lab_combat.string=game.ornament.getCombat(this._itemId))},_onClickSureBtn:function(){this.hide()}})},{}],589:[function(e,t,i){"use strict";game.OrnamentSender={},game.OrnamentSender.OrnamentModuleRequest=function(){var e=game.pbmid.Ornament.OrnamentModuleRequest;b8e.sendN(e)},game.OrnamentSender.OrnamentUpgradeRequest=function(e){var t=game.pbmsg.OrnamentUpgradeRequest;t.itemId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Ornament.OrnamentUpgradeRequest;b8e.sendN(i)},game.OrnamentSender.OrnamentEnsoulRequest=function(e,t){var i=game.pbmsg.OrnamentEnsoulRequest;i.itemId=e,i.count=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Ornament.OrnamentEnsoulRequest;b8e.sendN(n)},game.OrnamentSender.OrnamentPutOnRequest=function(e){var t=game.pbmsg.OrnamentPutOnRequest;t.itemId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Ornament.OrnamentPutOnRequest;b8e.sendN(i)},game.OrnamentSender.OrnamentPutOffRequest=function(){var e=game.pbmid.Ornament.OrnamentPutOffRequest;b8e.sendN(e)}},{}],590:[function(e,t,i){"use strict";e("./event/OthersRoleEvent"),e("./sender/OthersRoleSender"),e("./cmd/MiscCmd"),e("./manager/OthersRoleMgr"),e("./panel/OthersRolePanelIndex_1")},{"./cmd/MiscCmd":591,"./event/OthersRoleEvent":592,"./manager/OthersRoleMgr":593,"./panel/OthersRolePanelIndex_1":599,"./sender/OthersRoleSender":600}],591:[function(e,t,i){"use strict";game.MiscCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Misc.ViewOtherRoleResponse,this.onViewOtherRoleResponse,this),b8e.addNH(game.pbmid.Misc.MiscDataProto,this.onMiscDataProto,this),b8e.addNH(game.pbmid.Misc.ClientDataProto,this.onClientDataProto,this),b8e.addNH(game.pbmid.Misc.ServerDataResponse,this.onServerDataResponse,this),b8e.addNH(game.pbmid.Misc.MarqueeNotify,this.onMarqueeNotify,this),b8e.addNH(game.pbmid.Misc.BeViewedNotify,this.onBeViewedNotify,this)},onServerDataResponse:function(e){var t=e.readProtobuf(game.pbmsg.ServerDataResponse);if(t&&!(0<t.code)){var i=game.mainRole.mainRoleData;i?(i.miscData.setupServerData(t),b8e.log("初始化serverDataResponse数据成功"),game.IS_SHIELD_IOS_RECHARGE||game.activeBar.initBar()):b8e.log("没有人物数据，无法初始化misc")}},onClientDataProto:function(e){var t=e.readProtobuf(game.pbmsg.ClientDataProto);game.TriggerMgr.inst().setTriggerTimesDatas(t.triggerData),game.setting.setup(t.settingData),game.mainProcess.main.completeHangUpProcess(game.MainProcessTypes.BEAN)},onMiscDataProto:function(e){var t=e.readProtobuf(game.pbmsg.MiscDataProto);if(t)if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{var i=game.mainRole.mainRoleData;i?(i.miscData.setup(t),game.welfare.checkOnlinePrize(!0),game.pay.isShowDiscountDaily(),b8e.log("初始化misc数据成功")):b8e.log("没有人物数据，无法初始化misc")}},onViewOtherRoleResponse:function(e){var t=e.readProtobuf(game.pbmsg.ViewOtherRoleResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.othersRole.setupInfo(t))},onMarqueeNotify:function(e){var t=e.readProtobuf(game.pbmsg.MarqueeNotify);t&&(t.syncChat&&game.chat.addSystemChat(t.content),game.notice.broadcast(t.content,t.sort))},onBeViewedNotify:function(e){var t=e.readProtobuf(game.pbmsg.BeViewedNotify);if(t)if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{var i=game.ccfg.LangCfg.getText(10406,[t.roleName]);game.chat.addSystemChat(i)}}})},{}],592:[function(e,t,i){"use strict";game.OthersRoleEvent=b8e.Enum({INIT_INFO:b8e.Event.nextCode(),BASE_ATTR_UPDATE:b8e.Event.nextCode()})},{}],593:[function(e,t,i){"use strict";game.OthersRoleMgr=b8e.Object.extends({name:"LuowenVirus",_mainRoleEntity:null,_equipSlotMap:null,_equipQualitySuitsMap:null,mainRoleData:null,_showLV:0,_type:game.AccessoryType.None,_canSet:!1,_resPath:null,rebirthLevel:0,ctor:function(){this._super(),this._equipSlotMap=b8e.HashMap.get(),this._equipQualitySuitsMap=b8e.HashMap.get(),this.mainRoleData=game.HeroData.get()},initinfo:function(e){e==game.mainRole.mainRoleData.playerId?b8e.log("错误，你发送了自己的ID"):(game.OthersRoleSender.ViewOthersRole(e),b8e.log(e))},setupInfo:function(e){var t,i=this.mainRoleData;i.setOthersData(e),this.unlockSet(),this.setMainRoleData(i),this.lockSet(),i&&i.equipSlotsMap&&i.equipSlotsMap.forEach(function(e,t){this.setEquipSlotInfo(e,t)},this);var n=game.ccfg.HeroCfg.getResIdById(i.defaultModelId);t=game.ClientCfg.getUiUnits(n),0<e.surfaceId&&(t=game.ccfg.SurfaceCfg.getDataById(e.surfaceId)),this._resPath=t.res,this.rebirthLevel=e.rebirthLevel,this.roleLevel=e.roleLevel,game.app.show(game.AppConstant.OTHERSROLE_PANEL)},getResPath:function(){return this._resPath},getLv:function(){return this.roleLevel},getRebirthLevel:function(){return this.rebirthLevel},setType:function(e){switch(this._type=e,this._type){case game.AccessoryType.Mount:this._showLV=this.mainRoleData._mount_lv;break;case game.AccessoryType.Wing:this._showLV=this.mainRoleData._wing_lv;break;case game.AccessoryType.FaBao:this._showLV=this.mainRoleData._fabao_lv;break;case game.AccessoryType.XianZhen:this._showLV=this.mainRoleData._xianzhen_lv;break;default:b8e.log("已猝！")}},getCfg:function(){switch(this._type){case game.AccessoryType.Mount:return game.ccfg.MountCfg;case game.AccessoryType.Wing:return game.ccfg.WingCfg;case game.AccessoryType.FaBao:return game.ccfg.FaBaoCfg;case game.AccessoryType.XianZhen:return game.ccfg.XianZhenCfg;default:b8e.log("已猝！")}},getDataLvCfg:function(){var e=this.getCfg();return e?e.getDataById(this._showLV):null},getSpellId:function(){var e=this.getCfg();return e?e.getSpellIdByLv(this._showLV):0},getUnLockSpellId:function(){return 0},getSpriteStat:function(){var e=this.getCfg();if(e){var t=e.getDataById(this._showLV);if(t)return game.ccfg.SpriteStatCfg.getSpriteStatById(t.attr)}return null},getStageByLv:function(e){return this.getCfg().getDataById(e).stage},getStarByLv:function(e){if(0==e)return 0;var t=e%10;return 0==t?10:t},setEquipSlotInfo:function(e,t){this._equipSlotMap.set(e,t)},getEquipSlotMap:function(){return this._equipSlotMap},getCurEquipQualitySuits:function(){var e=this.mainRoleData.quality_taoz_id;return game.ccfg.EquipQualitySuitsCfg.getSuitsInfoById(e)},getCurEquipStarSuits:function(){var e=this.mainRoleData.star_taoz_id;return game.ccfg.EquipStarSuitsCfg.getSuitsInfoById(e)},unlockSet:function(){this._canSet=!0},lockSet:function(){this._canSet=!1},setMainRoleData:function(e){if(0==this._canSet)throw new Error("当前模式禁止重设主角数据");this.mainRoleData=e},getMainRoleId:function(){return this.mainRoleData?this.mainRoleData.id:0},getMainRoleData:function(){return this.mainRoleData},setMainRoleEntity:function(e){if(0==this._canSet)throw new Error("当前模式禁止重设主角数据");this._mainRoleEntity=e,b8e.scene.getCamera().setFocusTarget(this._mainRoleEntity)},getMainRoleEntity:function(){return this._mainRoleEntity}}),game.OthersRoleMgr._instance=null,game.OthersRoleMgr.inst=function(){return game.OthersRoleMgr._instance||(game.OthersRoleMgr._instance=new game.OthersRoleMgr),game.OthersRoleMgr._instance}},{}],594:[function(e,t,n){"use strict";game.appModule.OthersAccessoryPanel=game.SkinUIPanel.extends({_model:null,_mgr:null,_showType:0,itemGrid:null,_skillList:null,_nameImg:null,_accessoryModel:null,_stars:null,_accTypeMap:null,_acceAttrTypeMap:null,ctor:function(e){this._super(e),this._skillList=[],this._accTypeMap=b8e.HashMap.get(),this._accTypeMap.set(game.AccessoryType.Mount,"坐  骑"),this._accTypeMap.set(game.AccessoryType.Wing,"翅  膀"),this._accTypeMap.set(game.AccessoryType.FaBao,"法  宝"),this._accTypeMap.set(game.AccessoryType.XianZhen,"仙  阵"),this._acceAttrTypeMap=b8e.HashMap.get(),this._acceAttrTypeMap.set(game.AccessoryType.Mount,"坐骑属性"),this._acceAttrTypeMap.set(game.AccessoryType.Wing,"翅膀属性"),this._acceAttrTypeMap.set(game.AccessoryType.FaBao,"法宝属性"),this._acceAttrTypeMap.set(game.AccessoryType.XianZhen,"仙阵属性")},init:function(){if(this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.modelRoot)),!this._stars){this._stars=[];for(var e=0;e<10;e++){var t=new game.AccessoryStarItem;this._stars.push(t),t.addToParent(this._skin.star)}}},onShow:function(){this.showPanelInit(),this.onUpdateState(),b8e.evt.onC(this._skin.preview,this._onClickpreviewBtn,this),b8e.evt.onC(this._skillItem,this.showSkillPre,this)},onHide:function(){b8e.evt.offC(this._skin.preview,this._onClickpreviewBtn,this),b8e.evt.offC(this._skillItem,this.showSkillPre,this),this._mgr.isAutoSend=!1;var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.clear(),(e=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1))&&e.clear()},showPanelInit:function(){var e,t;switch(this._showType=this.data,this._mgr=game.othersRole,this._showType){case game.AccessoryType.Mount:t=game.Direction.getRadian(game.Direction.DownRight);break;case game.AccessoryType.Wing:case game.AccessoryType.FaBao:case game.AccessoryType.XianZhen:t=game.Direction.getRadian(game.Direction.Down)}e=this._accTypeMap.get(this._showType),this._skin.title.string=e||"",this._accessoryModel.setFaceRadian(t),this._nameImg||(this._nameImg=b8e.Sprite.get(),this._nameImg.setAnchor(.5,.5),this._nameImg.addToParent(this._skin.curLvName)),this._nameImg2||(this._nameImg2=b8e.Sprite.get(),this._nameImg2.setAnchor(.5,.5),this._nameImg2.addToParent(this._skin.curLvName_1)),this._skillItem||(this._skillItem=new game.SkillIcon,this._skillItem.setAnchor(.5,.5),this._skillItem.addToParent(this._skin.skillSlot)),this.onAccessoryChange()},onAccessoryChange:function(){var e=this._mgr.getCfg(),t=this._skin;if(e&&t){var n=this._mgr._showLV,s=e.getDataById(n);if(s){var a;switch(this._showType){case game.AccessoryType.Mount:a=game.ClientCfg.getMount(s.res);break;case game.AccessoryType.Wing:a=game.ClientCfg.getWing(s.res);break;case game.AccessoryType.FaBao:a=game.ClientCfg.getFaBao(s.res);break;case game.AccessoryType.XianZhen:a=game.ClientCfg.getXianZhen(s.res);break;default:b8e.log("出大事儿啦！我左边的程序狗猝死了")}var o=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);if(a?(o||(o=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),o.load(a),o.play(),o.setScale(s.uiScale,s.uiScale)):o&&o.clear(),o=this._accessoryModel.getAnimator(game.AnimatorType.MOUNT_HEAD,1),this._showType==game.AccessoryType.Mount&&s.head?(o||(o=this._accessoryModel.addAnimator(game.AnimatorType.MOUNT_HEAD,1,10)),a=game.ClientCfg.getMount(s.head),o.load(a),o.play(),o.setScale(s.uiScale,s.uiScale)):o&&o.clear(),s.posY?this._accessoryModel.setPosition(0,s.posY):this._accessoryModel.setPosition(0,0),s.name1){var r=game.ClientCfg.getAccessoryUrl(s.name1);this._nameImg.loadTexture(r,null,null,{useManifest:!1})}else this._nameImg.unloadTexture();if(s.name2){var h=game.ClientCfg.getAccessoryUrl(s.name2);this._nameImg2.loadTexture(h,null,null,{useManifest:!1})}else this._nameImg2.unloadTexture();var g=this._mgr.getStarByLv(s.lv);for(i=0;i<10;i++){var l=this._stars[i];l.show(),l.isLight(i<g)}t.fightAmount.string=s.power+"",t.curLvLabel.string=this._mgr.getStageByLv(s.lv),this._showType==game.AccessoryType.XianZhen?(this._skin.otherBg.active=!1,this._skin.xianzhenBg.active=!0,this._skin.silhouette.active=!0):(this._skin.otherBg.active=!0,this._skin.xianzhenBg.active=!1,this._skin.silhouette.active=!1);var c=0;this._showType==game.AccessoryType.FaBao?0<(c=this._mgr.getSpellId())&&(this._skin.skillSlot.active=!0,this._skin.skillTitle.active=!0,this._skillItem.setData(c,!1),this._skillItem.show()):(this._skin.skillSlot.active=!1,this._skin.skillTitle.active=!1)}}},showSkillPre:function(){},_onClickpreviewBtn:function(){var e,t;switch(this._showType){case game.AccessoryType.Mount:e=game.SpriteStatShowType.Mount;break;case game.AccessoryType.Wing:e=game.SpriteStatShowType.Wing;break;case game.AccessoryType.FaBao:e=game.SpriteStatShowType.FaBao;break;case game.AccessoryType.XianZhen:e=game.SpriteStatShowType.XianZhen}0==this._mgr._showLV?(t=game.SpriteStat.get()).initDefault():t=this._mgr.getSpriteStat();game.spriteStat.showSpriteStat(e,this._mgr._showLV,t,null)},onUpdateState:function(){if(this._skin){var e,t=this._acceAttrTypeMap.get(this._showType);this._skin.statetitle.string=t||"",0==this._mgr._showLV?(e=game.SpriteStat.get()).initDefault():e=this._mgr.getSpriteStat(),this._skin.stateRichText_1.string=this.getSpriteStatStr(e,0,4),this._skin.stateRichText_2.string=this.getSpriteStatStr(e,4,7)}},getSpriteStatStr:function(e,t,i){var n,s,a="",o="",r=e.getSpriteStats(),h=t,g=r.length;if(r&&0<g)for(n=h;n<g&&n<i;n++){if(s=r[n])o=n!=g-1?"\n":"",a+=game.ccfg.AttrRulesCfg.getAttrNameByType(s.type)+"   <color = #74E610>+"+s.value+"</color>"+o}return a}})},{}],595:[function(e,t,i){"use strict";game.appModule.OthersEquipSuitsTips=game.SkinUIPanel.extends({_type:0,_isHasEquip:!1,_color:0,ctor:function(e){this._super(e)},onShow:function(){if(null!=this.data)switch(this.clearData(),this._type=this.data,this._type){case game.equip.QUALITY_SUITS:this._skin.lab_title.string="装备品质套装",this.updateEquipSuitsInfo(this._type);break;case game.equip.STAR_SUITS:this._skin.lab_title.string="部位星级套装",this.updateEquipSuitsInfo(this._type)}},onHide:function(){},updateEquipSuitsInfo:function(e){var t,i,n,s;switch(e){case game.equip.QUALITY_SUITS:t=(n=game.othersRole.getCurEquipQualitySuits()).level,i=n.quality,s=t+"级"+game.html.getQNameByQuality(i)+"套装",this.onUpdateCurEquipSuitsInfo(n,!0,s);break;case game.equip.STAR_SUITS:s=(t=(n=game.othersRole.getCurEquipStarSuits()).level)+"级"+(i=n.star)+"星套装",this.onUpdateCurEquipSuitsInfo(n,!0,s)}},onUpdateCurEquipSuitsInfo:function(e,t,i){if(e){var n=e.suitsSpriteStat;if(n){var s,a=this.getSpriteStatStr(n);t?(s="当前激活："+i,a=game.html.getText(game.html.Q_YELLOW,a)):(s=game.html.getText(game.html.GRAY,"未激活："+i),a=game.html.getText(game.html.GRAY,a)),this._skin.lab_title1.string=s,this._skin.lab_curState.string=a}}},getSpriteStatStr:function(e){if(!e)return"";var t=e.getSpriteStats();if(!t||t.length<=0)return"";for(var i="",n="",s=0,a=0;a<t.length;a++){var o=t[a];if(o){var r=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type);n=a!=t.length-1?"\n":"";var h=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(o.type);if(h)switch(h.format){case game.AttrRulesFormat.FORMAT_1:s=o.value;break;case game.AttrRulesFormat.FORMAT_2:s=game.ValueUtil.getDigitsValueByNum(o.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:s=game.ValueUtil.getDigitsValueByNum(o.value/100,2)}i+=r+" +"+s+n}}return i},layoutTips:function(e,t,i,n){this.resetPosition()},clearData:function(){this._skin.lab_curState.string=""}})},{}],596:[function(e,t,i){"use strict";game.OthersRoleAttibuteItem=game.SkinUI.extends({_isNeedTitle:!1,_isRate:!1,_isOpen:!1,_type:-1,_leftAttrName:0,_leftAttrValue:0,_rightAttrName:0,_rightAttrValue:0,ctor:function(e,t,i,n,s,a,o,r){this._super("othersrole/OthersAccessorySkin","OthersAccessorySkin"),this._isNeedTitle=e,this._isRate=t,this._isOpen=i,this._type=n,this._leftAttrName=s,this._leftAttrValue=a,this._rightAttrName=o,this._rightAttrValue=r},onShow:function(){this.setData(this._isNeedTitle,this._isRate,this._isOpen,this._type,this._leftAttrName,this._leftAttrValue,this._rightAttrName,this._rightAttrValue)},onHide:function(){},setData:function(e,t,i,n,s,a,o,r){switch(this._skin.lab_open.node.active=!i,n){case 0:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="基础属性";break;case 1:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="高级属性";break;case 2:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="超级属性";break;default:this._skin.titleNode.active=!1,i?t?(this._skin.lab_baseNode.active=!0,this._skin.lab_node.active=!1,this._skin.lab_baseAttrName.string=s,this._skin.lab_baseAttrValue.string=a,this._skin.lab_baseAttrValueRate.string=o+r):(this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!0,this._skin.lab_leftAttrName.string=s,this._skin.lab_leftAttrValue.string=a,this._skin.lab_rightAttrName.string=o,this._skin.lab_rightAttrValue.string=r):(this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1)}}})},{}],597:[function(e,t,i){"use strict";game.appModule.OthersRoleAttibutePanel=game.SkinUIPanel.extends({_baseSpriteArr:null,_highSpriteArr:null,_superSpriteArr:null,_itemVec:null,ctor:function(e){this._super(e),this._baseSpriteArr=[],this._highSpriteArr=[],this._superSpriteArr=[],this._itemVec=[]},onShow:function(){this.updateAttr()},onHide:function(){this.clearData()},updateAttr:function(){var e=game.othersRole.mainRoleData;if(e){var t=e.baseSpriteStat;if(t){var i=t.getSpriteStats();if(i&&!(i.length<=0)){this._baseSpriteArr.length=0,this._highSpriteArr.length=0;for(var n=this._superSpriteArr.length=0;n<i.length;n++){var s=i[n];if(s){var a=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(s.type);if(a)switch(a.attrType){case game.AttrRulesType.AttrRulesType_1:this._baseSpriteArr.push(s);break;case game.AttrRulesType.AttrRulesType_2:this._highSpriteArr.push(s);break;case game.AttrRulesType.AttrRulesType_3:this._superSpriteArr.push(s)}}}var o;this._baseSpriteArr&&0<this._baseSpriteArr.length&&((o=new game.RoleAttributeItem(!0,!1,!0,0)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._baseSpriteArr.sort(this.onSortAttr),this.updateBaseSpriteSatat(this._baseSpriteArr)),this._highSpriteArr&&0<this._highSpriteArr.length&&((o=new game.RoleAttributeItem(!0,!1,!0,1)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._highSpriteArr.sort(this.onSortAttr),this.updateHighSpriteSatat(this._highSpriteArr)),this._superSpriteArr&&0<this._superSpriteArr.length?((o=new game.RoleAttributeItem(!0,!1,!0,2)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._superSpriteArr.sort(this.onSortAttr),this.updateSuperSpriteSatat(this._superSpriteArr)):((o=new game.RoleAttributeItem(!0,!1,!0,2)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this.updateSuperSpriteSatat(null))}}}},updateBaseSpriteSatat:function(e){for(var t,i,n="",s="",a=0,o="",r=0,h=0;h<e.length;h++){var g=e[h];if(g){n=game.ccfg.AttrRulesCfg.getAttrNameByType(g.type);var l=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(g.type);if(l)switch(l.format){case game.AttrRulesFormat.FORMAT_1:t=g.value;break;case game.AttrRulesFormat.FORMAT_2:t=game.ValueUtil.getDigitsValueByNum(g.value/100,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:t=game.ValueUtil.getDigitsValueByNum(g.value/100,2)}h%2!=0?(o=n,r=t,(i=new game.RoleAttributeItem(!1,!1,!0,-1,s,a,o,r)).setAnchor(.5,.5),i.setSize(470,40),i.addToParent(this._skin.list.content),i.show(),this._itemVec.push(i)):(s=n,a=t)}}},updateHighSpriteSatat:function(e){for(var t,i="",n="",s=0,a="",o=0,r=0;r<e.length;r++){var h=e[r];if(h){i=game.ccfg.AttrRulesCfg.getAttrNameByType(h.type);var g=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(h.type);if(g)switch(g.format){case game.AttrRulesFormat.FORMAT_1:t=h.value;break;case game.AttrRulesFormat.FORMAT_2:t=game.ValueUtil.getDigitsValueByNum(h.value/100,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:t=game.ValueUtil.getDigitsValueByNum(h.value/100,2)}if(r%2!=0){a=i,o=t;var l=new game.RoleAttributeItem(!1,!1,!0,-1,n,s,a,o);l.setAnchor(.5,.5),l.setSize(470,40),l.addToParent(this._skin.list.content),l.show(),this._itemVec.push(l)}else n=i,s=t}}},updateSuperSpriteSatat:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=new game.RoleAttributeItem(!0,!1,!1,-1);e.setAnchor(.5,.5),e.setSize(470,40),e.addToParent(this._skin.list.content),e.show(),this._itemVec.push(e)},onSortAttr:function(e,t){var i=game.ccfg.AttrRulesCfg.getAttrSortByType(e.type),n=game.ccfg.AttrRulesCfg.getAttrSortByType(t.type);return n<i?1:i<n?-1:0},clearData:function(){if(this._itemVec&&0<this._itemVec.length)for(var e=0;e<this._itemVec.length;e++){this._itemVec[e].hide()}this._itemVec.length=0,this._skin.list.content.removeAllChildren()}})},{}],598:[function(e,t,i){"use strict";game.appModule.OthersRolePanel=game.SkinUIPanel.extends({_equipItemArr:null,_accessoryModel:null,_starBarArr:null,_dujieIcon:null,ctor:function(e){this._super(e),this._equipItemArr=[],this._starBarArr=[]},onShow:function(){this.registerOrUnregisterEvent(!0);game.othersRole.mainRoleData;this.showModel(game.othersRole.getResPath()),this.updateWingAvatar(),this.updateRoleEquipInfo(),this.setupShowPanel(),this.updateEquipStarInfo()},init:function(){this._accessoryModel||(this._accessoryModel=b8e.SceneEntity.get(),this._accessoryModel.addToParent(this._skin.characterModelRoot))},onHide:function(){this.registerOrUnregisterEvent(!1),this.clearEquipItem();var e=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);e&&e.stop();var t=this._accessoryModel.getAnimator(game.AnimatorType.WING,1);t&&t.stop()},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.wingBtn.node,this.onClickWingBtn,this),b8e.evt.onC(this._skin.mountBtn.node,this.onClickMountBtn,this),b8e.evt.onC(this._skin.talismanBtn.node,this.onClicktalismanBtnBtn,this),b8e.evt.onC(this._skin.xianzhenBtn.node,this.onClickXianZhenBtn,this),b8e.evt.onC(this._skin.qualityBtn,this.onOpenEquipQualitySuitsTips,this),b8e.evt.onC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.onC(this._skin.previewBtn,this.onOpenRoleAttributePanel,this)):(b8e.evt.offC(this._skin.wingBtn.node,this.onClickWingBtn,this),b8e.evt.offC(this._skin.mountBtn.node,this.onClickMountBtn,this),b8e.evt.offC(this._skin.talismanBtn.node,this.onClicktalismanBtnBtn,this),b8e.evt.offC(this._skin.xianzhenBtn.node,this.onClickXianZhenBtn,this),b8e.evt.offC(this._skin.qualityBtn,this.onOpenEquipQualitySuitsTips,this),b8e.evt.offC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.offC(this._skin.previewBtn,this.onOpenRoleAttributePanel,this))},setupShowPanel:function(){var e=game.othersRole.mainRoleData;0<e.quality_taoz_id?b8e.ShaderUtil.reset(this._skin.qualityBtn):b8e.ShaderUtil.setGray(this._skin.qualityBtn),0<e.star_taoz_id?b8e.ShaderUtil.reset(this._skin.starRanktn):b8e.ShaderUtil.setGray(this._skin.starRanktn),0<e._wing_lv?b8e.ShaderUtil.reset(this._skin.wingBtn):b8e.ShaderUtil.setGray(this._skin.wingBtn),0<e._mount_lv?b8e.ShaderUtil.reset(this._skin.mountBtn):b8e.ShaderUtil.setGray(this._skin.mountBtn),0<e._fabao_lv?b8e.ShaderUtil.reset(this._skin.talismanBtn):b8e.ShaderUtil.setGray(this._skin.talismanBtn),0<e._xianzhen_lv?b8e.ShaderUtil.reset(this._skin.xianzhenBtn):b8e.ShaderUtil.setGray(this._skin.xianzhenBtn);var t;t=e.getZhanLi(),this._skin.lab_power.string=t,this._dujieIcon||(this._dujieIcon=b8e.Sprite.get(),this._dujieIcon.addToParent(this._skin.dujieNode));var i=game.ccfg.DujieCfg.getDataByLevel(e.dujie);i&&i.IvIcon?this._dujieIcon.loadTexture(game.ClientCfg.getDujieLvIconUrl(i.IvIcon),null,null,{useManifest:!1}):this._dujieIcon.unloadTexture(),this._skin.title.string=e.name;var n=game.othersRole.getRebirthLevel(),s=game.othersRole.getLv();this._skin.level_lab.string=0<n?"等级:"+n+"转"+s+"级":"等级:"+s+"级";var a=e.guildName;this._skin.guildName.string=a?"帮会:"+a:"帮会:  无"},showModel:function(e){var t=game.ClientCfg.getAvatarAnim(game.RoleType.UIRole,e),i=this._accessoryModel.getAnimator(game.AnimatorType.BODY,1);t?(i||(i=this._accessoryModel.addAnimator(game.AnimatorType.BODY,1,-10)),i.load(t),i.play()):i&&i.clear()},updateRoleEquipInfo:function(){var e=this._equipItemArr.length,t=game.othersRole.getEquipSlotMap();if(t){var i=t.values();if(!i||i.length<=0)return;for(var n=0;n<i.length;n++){var s=i[n];if(s){var a,o=this._skin["equipGrids_"+n];n<e?a=this._equipItemArr[n]:(a=game.GridUtil.creatItemGrid(this,o,game.IcoSizeEnum.SIZE_90,game.ContainerId.ROLE_EQUIP_CONTAINER_ID,this.onClick),this._equipItemArr.push(a)),game.GridUtil.setEquipSlotGrid(a,s,!0,!1,!1,s.slotStar),0<s.slotStar&&a.setStarBarPos(0,-15),a.setEqEnchantIcon(s.isenchant),a.sortLayer()}}}},updateEquipStarInfo:function(){var e=0,t=game.othersRole.getCurEquipStarSuits();t&&(e=t.star),0<e&&e<6?(this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!0,this._skin.yueliang.active=!1,this._skin.taiyang.active=!1,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!0):6<=e&&e<11?(this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!1,this._skin.yueliang.active=!0,this._skin.taiyang.active=!1,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!0):11<=e&&e<16?(this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!1,this._skin.yueliang.active=!1,this._skin.taiyang.active=!0,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!0):16<=e&&e<21?(this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!1,this._skin.yueliang.active=!1,this._skin.taiyang.active=!1,this._skin.huangguan.active=!0,this._skin.labStar.node.active=!0):(this._skin.xingxingGray.active=!0,this._skin.xingxing.active=!1,this._skin.yueliang.active=!1,this._skin.taiyang.active=!1,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!1),this._skin.labStar.string=e},onClick:function(e){e&&e.faceInfo&&(e.faceInfo.equip?game.app.show(game.AppConstant.OTHERSROLE_EQUIP_TIPS,e.faceInfo):game.notice.show("当前没有装备"))},updateWingAvatar:function(){var e,t,i,n=!1;(i=game.othersRole.mainRoleData._wing_lv)&&(t=game.ccfg.WingCfg.getDataById(i))&&(n=!0);var s=this._accessoryModel.getAnimator(game.AnimatorType.WING,1);n&&(e=game.ClientCfg.getWing(t.res))?(s||(s=this._accessoryModel.addAnimator(game.AnimatorType.WING,1,-11)),s.load(e),s.play(),s.setScale(1.7,1.7),s.setPosition(0,-70)):s&&s.clear()},clearEquipItem:function(){for(var e=0;e<this._equipItemArr.length;e++){var t=this._equipItemArr[e];t&&game.GridUtil.setEquipSlotGrid(t,null)}},onClickMountBtn:function(){0<game.othersRole.mainRoleData._mount_lv?(game.othersRole.setType(game.AccessoryType.Mount),game.app.show(game.AppConstant.OTHERS_ACCESSORY_PANEL,game.AccessoryType.Mount)):game.notice.show("此玩家没有坐骑")},onClickWingBtn:function(){0<game.othersRole.mainRoleData._wing_lv?(game.othersRole.setType(game.AccessoryType.Wing),game.app.show(game.AppConstant.OTHERS_ACCESSORY_PANEL,game.AccessoryType.Wing)):game.notice.show("此玩家没有翅膀")},onClickXianZhenBtn:function(){0<game.othersRole.mainRoleData._xianzhen_lv?(game.othersRole.setType(game.AccessoryType.XianZhen),game.app.show(game.AppConstant.OTHERS_ACCESSORY_PANEL,game.AccessoryType.XianZhen)):game.notice.show("此玩家没有仙阵")},onClicktalismanBtnBtn:function(){0<game.othersRole.mainRoleData._fabao_lv?(game.othersRole.setType(game.AccessoryType.FaBao),game.app.show(game.AppConstant.OTHERS_ACCESSORY_PANEL,game.AccessoryType.FaBao)):game.notice.show("此玩家没有法宝")},onOpenEquipQualitySuitsTips:function(){0<game.othersRole.mainRoleData.quality_taoz_id?game.app.show(game.AppConstant.OTHEREQUIP_SUITS_TIPS,game.equip.QUALITY_SUITS):game.notice.show("此玩家没有品质套装")},onOpenEquipStarSuitsTips:function(){0<game.othersRole.mainRoleData.star_taoz_id?game.app.show(game.AppConstant.OTHEREQUIP_SUITS_TIPS,game.equip.STAR_SUITS):game.notice.show("此玩家没有星级套装")},onOpenRoleAttributePanel:function(){game.othersRole.mainRoleData;game.app.show(game.AppConstant.OTHERSROLE_ATTIBUTE_PANEL)}})},{}],599:[function(e,t,i){"use strict";e("./OthersAccessoryPanel"),e("./OthersEquipSuitsTips"),e("./OthersRoleAttibuteItem"),e("./OthersRoleAttibutePanel"),e("./OthersRolePanel")},{"./OthersAccessoryPanel":594,"./OthersEquipSuitsTips":595,"./OthersRoleAttibuteItem":596,"./OthersRoleAttibutePanel":597,"./OthersRolePanel":598}],600:[function(e,t,i){"use strict";game.OthersRoleSender={},game.OthersRoleSender.ViewOthersRole=function(e){var t=game.pbmsg.ViewOtherRoleRequest;t.roleId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Misc.ViewOtherRoleRequest;b8e.sendN(i)}},{}],601:[function(e,t,i){"use strict";game.PayCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Recharge.RechargeModuleProto,this.onRechargeModuleProto,this),b8e.addNH(game.pbmid.Recharge.RechargeAmountNotify,this.onRechargeAmountNotify,this),b8e.addNH(game.pbmid.Recharge.RechargeSuccessNotify,this.onRechargeSuccessNotify,this),b8e.addNH(game.pbmid.Recharge.CardAwardResponse,this.onCardAwardResponse,this),b8e.addNH(game.pbmid.Recharge.AccumulateRechargeAwardResponse,this.onAccumulateRechargeAwardResponse,this),b8e.addNH(game.pbmid.Recharge.RechargeRebateAwardResponse,this.onRechargeRebateAwardResponse,this),b8e.addNH(game.pbmid.Recharge.FundBuyResponse,this.onFundBuyResponse,this),b8e.addNH(game.pbmid.Recharge.FundCollectResponse,this.onFundCollectResponse,this),b8e.addNH(game.pbmid.Recharge.CollectSalePrizeResponse,this.onCollectSalePrizeResponse,this),b8e.addNH(game.pbmid.Recharge.DailyDiscountItemNotify,this.onDailyDiscountItemNotify,this)},onRechargeModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.RechargeModuleProto);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synPayModuleInfo(t)},onRechargeAmountNotify:function(e){var t=e.readProtobuf(game.pbmsg.RechargeAmountNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synRechargeAmountNotify(t.rechargeDiamond)},onRechargeSuccessNotify:function(e){var t=e.readProtobuf(game.pbmsg.RechargeSuccessNotify);0<t.code?game.pay.showRechargeTips(!1):(game.pay.showRechargeTips(!0),game.pay.synRechargeSuccessNotify(t.id,t.orderId))},onCardAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.CardAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synCardAwardResponse(t.cardType)},onAccumulateRechargeAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.AccumulateRechargeAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synAccumulateRechargeAwardResponse(t.id)},onRechargeRebateAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.RechargeRebateAwardResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synRechargeRebateAwardResponse(t.id)},onFundBuyResponse:function(e){var t=e.readProtobuf(game.pbmsg.FundBuyResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.fund.synFundBuyResponse()},onFundCollectResponse:function(e){var t=e.readProtobuf(game.pbmsg.FundCollectResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.fund.synFundCollectResponse(t.level)},onCollectSalePrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.CollectSalePrizeResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synSalePrize()},onDailyDiscountItemNotify:function(e){var t=e.readProtobuf(game.pbmsg.DailyDiscountItemNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.pay.synDailyDiscount(t.id)}})},{}],602:[function(e,t,i){"use strict";e("./PayCmd")},{"./PayCmd":601}],603:[function(e,t,i){"use strict";game.RechargeType=b8e.Enum({NORMAL_RECHARGE:0,CARD_RECHARGE:1,SALE_RECHARGE:2,DISCOUNT_RECHARGE:3,FIRST_RECHARGE:100,VIP_SHOW:200})},{}],604:[function(e,t,i){"use strict";game.PayEvents=b8e.Enum({UPDATE_PAY_INFO_SUCCESS:b8e.Event.nextCode(),RECHARGE_SUCCESS:b8e.Event.nextCode(),GET_FIRST_RECHARGE_AWARD_SUCCESS:b8e.Event.nextCode(),COLLECT_AWARD_SUCCESS:b8e.Event.nextCode(),COLLECT_CARD_AWARD_SUCCESS:b8e.Event.nextCode(),COLLECT_SALE_DAILY_SUCCESS:b8e.Event.nextCode(),UPDATE_DISCOUNT_BTN:b8e.Event.nextCode(),PAY_EVENT_XIAN_LAI_UPDATE_COIN_REMAIN:b8e.Event.nextCode()})},{}],605:[function(e,t,i){"use strict";e("./PayEvents")},{"./PayEvents":604}],606:[function(e,t,i){"use strict";game.PayMgr=b8e.Object.extends({name:"PayMgr",isRechargePanel:!1,_rechargeMap:null,_cardsMap:null,endTime:-1,payInfo:null,conditionsMap:null,canReceiveAccumulateArr:null,canReceiveRebateArr:null,pfType:1,firstClickArr:null,isGetSeverData:!1,isShowDiscount:!1,_prizeArr:null,ctor:function(){if(1==game.PayMgr._singleton)throw new Error("PayMgr 只能通过单例方法获取");this._super(),this.conditionsMap=b8e.HashMap.get(),this.payInfo=new game.PayInfo,this.canReceiveAccumulateArr=[],this.canReceiveRebateArr=[],this.firstClickArr=[],this._prizeArr=[]},diamondRechargeTips:function(){game.gameAlert.showVipAlert(!0,101)},synPayModuleInfo:function(e){e&&(b8e.isWeChatGame?this.pfType=2:game.LoginConfig.openApplePay||"72usa6_recharge_client"==game.VERSION_NAME?this.pfType=2:this.pfType=1,game.fund.synFundInfo(e.fundCollectStates),game.fund.isBuyFund=e.buyFundState,game.vip.synVipInfo(e.vipLv,e.vipExp),game.vip.collectedVipPrize=e.collectedVipPrize,this.payInfo.setup(e),this.isGetSeverData=!0,game.app.isShow(game.AppConstant.FIRST_RECHARGE_PANEL)&&e.collectedFirstRecharge&&game.app.hide(game.AppConstant.FIRST_RECHARGE_PANEL),b8e.evt.dptG(game.PayEvents.UPDATE_PAY_INFO_SUCCESS))},synRechargeAmountNotify:function(e){this.payInfo.rechargeDiamond+=e},rechargeResetDaily:function(){this.payInfo.buyDiscountDaily=!1,this.payInfo.collectedSalePrizeDaily=!1,this.payInfo.buySaleRecords&&(this.payInfo.buySaleRecords.length=0);var e=this.payInfo.getCardsMap();if(e&&0<e.count())for(var t,i,n,s,a=e.keys(),o=0;o<a.length;o++)t=a[o],(i=this.payInfo.getCardsInfoByCardType(t)).cardType=t,n=game.SysTime.curTime-i.expireTime,0!=i.expireTime?0<=n||Math.abs(n)<1e3?this.payInfo.delCardsInfoByCardType(t):(s=b8e.TimeUtil.DAY_MICRO_SECONDS,i.expireTime=i.expireTime-s,i.collectedPrizeDaily=!1,this.payInfo.setCardsMap(i)):(i.collectedPrizeDaily=!1,this.payInfo.setCardsMap(i));this.payInfo.rechargeDiamondDaily=0,this.payInfo.collectedAccumulatePrizes.length=0;var r=game.ccfg.AccumulateRechargeCfg.getDatasCount();this.payInfo.accumulatePrizeGroup==r?this.payInfo.accumulatePrizeGroup=1:this.payInfo.accumulatePrizeGroup+=1;var h=this.getConditionsInfo(game.ActivityConditionType.FESTIVAL_RECHARGE);h&&(h.value=0,this.setConditionsMap(h));var g=game.ccfg.RechargeRebateCfg.getRebateArrByGroup(this.payInfo.rebatePrizeGroup),l=game.ccfg.RechargeRebateCfg.getDatasCount();if(g){var c=this.payInfo.collectedRebatePrizes.length==g.length;this.payInfo.rechargeDays>=g.length&&this.payInfo.rebatePrizeGroup!=l&&c?(this.payInfo.rebatePrizeGroup+=1,this.payInfo.collectedRebatePrizes.length=0,this.payInfo.rechargeDays=0):this.payInfo.rechargeDays>=g.length&&this.payInfo.rebatePrizeGroup==l&&c&&(this.payInfo.rebatePrizeGroup=1,this.payInfo.collectedRebatePrizes.length=0,this.payInfo.rechargeDays=0)}this.isShowDiscountDaily()},synRechargeSuccessNotify:function(e,t){var i=game.ccfg.RechargeCfg.getRecharge(e),n=i.money,s=0,a=game.ccfg.RechargeCfg.getRechargeTypeById(e);if(a==game.RechargeType.NORMAL_RECHARGE){this.payInfo.collectedFirstRecharge||(this.payInfo.collectedFirstRecharge=!0,b8e.evt.dptG(game.PayEvents.GET_FIRST_RECHARGE_AWARD_SUCCESS)),0<i.addAccuDiamond&&0==this.payInfo.rechargeDiamondDaily&&(this.payInfo.rechargeDays+=1);var o,r,h=game.ccfg.NormalRechargeCfg.getRecharge(e);this.payInfo._rechargeMap.get(e)?((r=this.payInfo._rechargeMap.get(e)).id=e,r.count=r.count+1,o=h.extraDiamond):((r=new game.RechargeDatasInfo).id=e,r.count=1,o=h.firstExtraDiamond),this.payInfo.setRechargeMap(r),s=i.addAccuDiamond+o}else if(a==game.RechargeType.CARD_RECHARGE){var g=game.ccfg.CardRechargeCfg.getCardRecharge(e),l=game.SysTime.curTime,c=b8e.TimeUtil.DAY_MICRO_SECONDS,u=new game.CardRechargeInfo;u.id=e,u.expireTime=l+g.validDays*c,u.collectedPrizeDaily=!1,u.cardType=game.ccfg.CardRechargeCfg.getCardTypeById(e),this.payInfo.setCardsMap(u),s=g.diamond}else if(a==game.RechargeType.SALE_RECHARGE){var m=game.ccfg.SaleDailyCfg.getDataByKey(e);m&&this.payInfo.addIdToSaleRecords(m.saleType)}else a==game.RechargeType.DISCOUNT_RECHARGE&&(this.payInfo.buyDiscountDaily=!0,this.isShowDiscountDaily(),0<i.addAccuDiamond&&0==this.payInfo.rechargeDiamondDaily&&(this.payInfo.rechargeDays+=1));0<i.addAccuDiamond&&(this.payInfo.rechargeDiamond+=i.addAccuDiamond,this.payInfo.rechargeDiamondDaily+=i.addAccuDiamond,this.synRechargeActive(i,game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE,game.ActivityConditionType.TARGET_RECHARGE),this.synRechargeActive(i,game.ActiveSubType.ST_FESTIVAL_RECHARGE,game.ActivityConditionType.FESTIVAL_RECHARGE),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_LOW_COST,game.ActivityConditionType.LOW_COST_RECHARGE),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_RECHARGE,game.ActivityConditionType.ZHUANPAN_RECHARGE),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_EASTEREGG,game.ActivityConditionType.ZHUANPAN_EASTEREGG),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_DIAMOND,game.ActivityConditionType.ZHUANPAN_DIAMOND),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST,game.ActivityConditionType.MIDDLE_COST_RECHARGE),this.synRechargeActive(i,game.ActiveSubType.ST_ZHUANPAN_UP_COST,game.ActivityConditionType.UP_COST_RECHARGE)),0<i.addVipExp&&(game.vip._vipExp+=i.addVipExp,game.vip._vipLv=this.getRechargedVipLv()),this.onReqActivityCondition(),game.back.updateAmountInfo(s),game.mainRole.mainRoleData.setVipLv(this.getRechargedVipLv()),game.vip.setMinShowLv(),b8e.evt.dptG(game.VipEvents.UPDATA_VIP_INFO),b8e.evt.dptG(game.PayEvents.RECHARGE_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),0==game.app.isShow(game.AppConstant.WELFARE_PANEL)&&(game.welfare.selectSubType=game.welfare.isHideVipRoullete()?game.WelfareType.COVER_PANEL:game.WelfareType.VIP_ROULETTE),game.AnalyticsSDK.onFinishRecharge(t,n,s,e)},onReqActivityCondition:function(){var e;game.active.hasActiveSubType(game.ActiveSubType.SINGLE_RECHARGE)&&(e=game.active.subTypeToCondition(game.ActiveSubType.SINGLE_RECHARGE),game.ActiveSender.getActiveCostMap(e)),game.active.hasActiveSubType(game.ActiveSubType.ST_SINGLE_RECHARGE_2)&&(e=game.active.subTypeToCondition(game.ActiveSubType.ST_SINGLE_RECHARGE_2),game.ActiveSender.getActiveCostMap(e)),game.active.hasActiveSubType(game.ActiveSubType.ST_SINGLE_RECHARGE_3)&&(e=game.active.subTypeToCondition(game.ActiveSubType.ST_SINGLE_RECHARGE_3),game.ActiveSender.getActiveCostMap(e)),game.active.hasActiveSubType(game.ActiveSubType.ST_NEW_RECHARGE)&&(e=game.active.subTypeToCondition(game.ActiveSubType.ST_NEW_RECHARGE),game.ActiveSender.getActiveCostMap(e)),game.active.hasActiveSubType(game.ActiveSubType.ST_MYSTERY)&&(e=game.active.subTypeToCondition(game.ActiveSubType.ST_MYSTERY),game.ActiveSender.getActiveCostMap(e)),game.active.hasActiveSubType(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_1)&&(game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_RECHARGE_1),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_1),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_1)),game.active.hasActiveSubType(game.ActiveSubType.ST_TIME_LIMIT_RECHARGE_2)&&(game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_RECHARGE_2),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_RECHARGE_2),game.ActiveSender.getActiveCostMap(game.ActivityConditionType.TIME_LIMIT_ACCUMULATE_DAYS_2))},synRechargeConditions:function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.ActiveConditionsInfo;n.type=i.type,n.value=i.value,n.expireTime=i.expireTime,this.setConditionsMap(n)}}},setConditionsMap:function(e){this.conditionsMap.set(e.type,e)},getConditionsInfo:function(e){var t;(t=this.conditionsMap.get(e))||((t=new game.ActiveConditionsInfo).type=e,t.value=0,t.expireTime=0,this.conditionsMap.set(t.type,t));return t},synRechargeActive:function(e,t,i){var n=game.active.getSubTypeInfo(t);if(n){var s=this.getConditionsInfo(i);if(s&&s.expireTime==n.endTime)i==game.ActivityConditionType.TARGET_RECHARGE||i==game.ActivityConditionType.FESTIVAL_RECHARGE?s.value+=e.addAccuDiamond:s.value+=e.money,this.setConditionsMap(s);else{var a=new game.ActiveConditionsInfo;(a.type=i)==game.ActivityConditionType.TARGET_RECHARGE||i==game.ActivityConditionType.FESTIVAL_RECHARGE?a.value=e.addAccuDiamond:a.value=e.money,a.expireTime=n.endTime,this.setConditionsMap(a)}}},festivalResetDaily:function(){if(game.active.hasActive(game.ActiveType.FESTIVAL)){var e,t=game.active.getSubTypeInfo(game.ActiveSubType.FESTIVAL_LOGIN);if(t)if(e=this.getConditionsInfo(game.ActivityConditionType.FESTIVAL_LOGIN))e.expireTime==t.endTime?e.value++:(e.value=1,e.expireTime=t.endTime),this.setConditionsMap(e);else(e=new game.ActiveConditionsInfo).type=game.ActivityConditionType.FESTIVAL_LOGIN,e.value=1,e.expireTime=t.endTime,this.setConditionsMap(e)}},isFirstRecharge:function(e){return this.payInfo.isFirstRecharge(e)},isCollected:function(e,t){if(!(e&&0<e.length))return!1;for(var i=0;i<e.length;i++){if(t==e[i])return!0;if(i==e.length-1)return!1}},getIsShowEffect:function(e){if(-1!=this.firstClickArr.indexOf(e))return!1;switch(e){case game.RechargeType.CARD_RECHARGE:var t=this.getCardRechargeInfoArr(),i=this.getCardsMap();if(t&&0<t.length)for(var n=0;n<t.length;n++){var s=t[n].itemId;if(!i.get(s))return!0}return!1}return!0},getRechargedVipLv:function(){var e,t=game.ccfg.VipCfg.getMaxVipLv(),i=game.vip._vipExp;if(game.ccfg.VipCfg.getMaxVipExp()<=i)return t;e=game.vip._vipLv+1;for(var n=0;n<t;n++){if(!(game.ccfg.VipCfg.getVipExpByLv(e)<=i))return e-1;e++}},getRemainDays:function(e){return(e-game.SysTime.curTime)/b8e.TimeUtil.DAY_MICRO_SECONDS>>0},getCardsMap:function(){return this.payInfo.getCardsMap()},getCardsInfo:function(e){return this.payInfo.getCardsMap().get(e)},getIsCollectedFirstRecharge:function(){return this.payInfo.collectedFirstRecharge},synCardAwardResponse:function(e){var t=this.payInfo.getCardsInfoByCardType(e);t.collectedPrizeDaily=!0,this.payInfo.setCardsMap(t),b8e.evt.dptG(game.PayEvents.COLLECT_CARD_AWARD_SUCCESS)},getPayInfoIdByType:function(e){return this.payInfo?this.payInfo.getCardsInfoByCardType(e):null},synAccumulateRechargeAwardResponse:function(e){this.payInfo.addIdToAccumulatePrizes(e),b8e.evt.dptG(game.PayEvents.COLLECT_AWARD_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},synRechargeRebateAwardResponse:function(e){this.payInfo.addIdToRebatePrizes(e),b8e.evt.dptG(game.PayEvents.COLLECT_AWARD_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},showRechargeTips:function(e){var t=new game.GameAlertInfo;t.alertType=game.GameAlertType.OneBtn,t.string=1==e?"恭喜您，充值成功":"充值失败，请稍候再试！",t.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,t)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:case game.GameAlertBtnType.CLOSE:}},showPayPanel:function(){game.shield.isShieldRecharge()||(this.getIsCollectedFirstRecharge()?game.TriggerMgr&&(this.isRechargePanel=!0,game.TriggerMgr.inst().customTriggerById(3119)):game.app.show(game.AppConstant.FIRST_RECHARGE_PANEL))},synSalePrize:function(){this.payInfo.collectedSalePrizeDaily=!0,b8e.evt.dptG(game.PayEvents.COLLECT_SALE_DAILY_SUCCESS)},synDailyDiscount:function(e){this.payInfo.discountId=e},resetActiveRebate:function(){var e=this.getConditionsInfo(game.ActivityConditionType.TARGET_RECHARGE);e&&(e.value=0,this.setConditionsMap(e))},isShowDiscountDaily:function(){var e=game.mainRole.mainRoleData.miscData;if(0==this._prizeArr.length){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.DISCOUNT_DAILY_ID);this._prizeArr=t.split("|")}this.isShowDiscount=!(e.loginDay>this._prizeArr.length||this.payInfo.buyDiscountDaily),b8e.evt.dptG(game.PayEvents.UPDATE_DISCOUNT_BTN)},getDiscountId:function(){return this.payInfo.discountId},getDiscountBanner:function(){var e=game.ccfg.DiscountDailyCfg.getDataById(this.payInfo.discountId);return e?e.adRes:null},getDiscountDailyItemId:function(){var e=game.ccfg.DiscountDailyCfg.getDataById(this.payInfo.discountId);return e?e.itemId:0},getDiscountDailyDropId:function(){var e=game.ccfg.DiscountDailyCfg.getDataById(this.payInfo.discountId);return e?e.dropId:0},getDiscountDailyRealCost:function(){var e=game.ccfg.DiscountDailyCfg.getDataById(this.payInfo.discountId);return e?e.realCost:1},getDiscountDailyShowCost:function(){var e=game.ccfg.DiscountDailyCfg.getDataById(this.payInfo.discountId);return e?e.showCost:1},getIsBuyDiscountDaily:function(){return this.payInfo.buyDiscountDaily},getIsCollectedSalePrizeDaily:function(){return this.payInfo.collectedSalePrizeDaily},getSalePrizeArr:function(){return game.ccfg.SaleDailyCfg.getSalePrizeArr()},getSaleRecords:function(){return this.payInfo.buySaleRecords},getRechargeDiamond:function(){return this.payInfo.rechargeDiamond},getDailyRechargeDiamond:function(){return this.payInfo.rechargeDiamondDaily},getCollectedAccumulateArr:function(){return this.payInfo.collectedAccumulatePrizes},getRechargeRebateDays:function(){return this.payInfo.rechargeDays},getCollectedRebateArr:function(){return this.payInfo.collectedRebatePrizes},getArrByRechargeType:function(e){return game.ccfg.RechargeCfg.getRechargeInfoArrByType(e)},getRechargeInfoArr:function(){return game.ccfg.NormalRechargeCfg.getNormalRechargeInfoArr()},getCardRechargeInfoArr:function(){return game.ccfg.CardRechargeCfg.getCardRechargeArr()},getRebateArr:function(){return game.ccfg.RechargeRebateCfg.getRebateArrByGroup(this.payInfo.rebatePrizeGroup)},getAccumulateRechargeArr:function(){return game.ccfg.AccumulateRechargeCfg.getAccumulateArrByGroup(this.payInfo.accumulatePrizeGroup)},getFirstRechargeMaxMoney:function(){var e=game.ccfg.NormalRechargeCfg.getFirstRechargeArr();return e&&0<e.length?(e.sort(this.onSortByMoney),e[e.length-1].money):0},getFailueBannerPath:function(){if(this.getIsCollectedFirstRecharge()){var e=this.getSaleRecords();if(e&&0<e.length){var t=game.ccfg.SaleDailyCfg.getSalePrizeArr();if(t&&0<t.length)if(e.length>=t.length)return this.getIsBuyDiscountDaily()?game.strengthen.getBannerPathById(game.FailueBannerId.MYSTERY_SHOP):game.strengthen.getBannerPathById(game.FailueBannerId.DISCOUNT_DAILY)}return game.strengthen.getBannerPathById(game.FailueBannerId.SALE_DISCOUNT)}return game.strengthen.getBannerPathById(game.FailueBannerId.FIRST_RECHARGE)},goFailueTrigger:function(){if(this.getIsCollectedFirstRecharge()){var e=this.getSaleRecords();if(e&&0<e.length){var t=game.ccfg.SaleDailyCfg.getSalePrizeArr();if(t&&0<t.length)if(e.length>=t.length)return this.getIsBuyDiscountDaily()?void this.failueTrigger(game.FailueBannerId.MYSTERY_SHOP):void this.failueTrigger(game.FailueBannerId.DISCOUNT_DAILY)}this.failueTrigger(game.FailueBannerId.SALE_DISCOUNT)}else game.app.show(game.AppConstant.FIRST_RECHARGE_PANEL)},failueTrigger:function(e){var t=game.ccfg.FailueBannerCfg.getDataById(e);if(t){var i=t.triggerId;game.TriggerMgr.inst().customTriggerById(i)}},onSortByMoney:function(e,t){return e.money>t.money?1:e.money<t.money?-1:0},cardRechargeAlert:function(){var e=this.getCardRechargeInfoArr();if(e)for(var t,i,n=e.length,s=0;s<n;s++)if(i=e[s],(t=this.getCardsInfo(i.cardType))&&0==t.collectedPrizeDaily)return!0;return!1},getAlertByCardType:function(e){var t=this.getCardsInfo(e);return!(!t||0!=t.collectedPrizeDaily)},getCanAccumulateArr:function(){var e=game.ccfg.AccumulateRechargeCfg.getDataByKey(this.payInfo.accumulatePrizeGroup),t=this.getDailyRechargeDiamond();if(e&&0<e.length)for(var i=this.canReceiveAccumulateArr.length=0;i<e.length;i++){var n=e[i];t>n.accumulateValue&&this.canReceiveAccumulateArr.push(n)}return this.canReceiveAccumulateArr},getCanRebateArr:function(){var e=game.ccfg.RechargeRebateCfg.getDataByKey(this.payInfo.rebatePrizeGroup),t=this.getRechargeRebateDays();if(e&&0<e.length)for(var i=this.canReceiveRebateArr.length=0;i<e.length;i++){var n=e[i];t>=n.rechargeDays&&this.canReceiveRebateArr.push(n)}return this.canReceiveRebateArr},isAlertAccumulateRecharge:function(){var e=this.getCanAccumulateArr(),t=this.payInfo.collectedAccumulatePrizes;return!!(e&&0<e.length&&e.length>t.length)},isAlertRebateRecharge:function(){var e=this.getCanRebateArr(),t=this.payInfo.collectedRebatePrizes;return!!(e&&0<e.length&&e.length>t.length)},isAlertRechargeActive:function(){var e=this.isAlertRebateRecharge(),t=game.active.getTargetIsAlert(game.ActiveSubType.ST_RECHARGE_ACTIVEREBATE),i=game.active.getTargetIsAlert(game.ActiveSubType.ST_FESTIVAL_RECHARGE);return!!(e||t||i)},setRebateDaysState:function(e){var t=this.getRechargeRebateDays();if(e.rechargeDays<=t){var i=this.getCollectedRebateArr(),n=this.isCollected(i,e.id);e.state=n?1:0}else e.state=2},getRestivalState:function(e){var t=game.active.activeIsGetAllPrize(e),i=game.active.targetIsComplete(e);return t?1:i?0:2},setFundState:function(e){var t=game.mainRole.mainRoleData.getLv();if(game.fund.isBuyFund&&t>=e.level){var i=this.getIsDisplay(e.level);e.state=i?0:1}else e.state=2},getIsDisplay:function(e){var t=game.fund.collectStatesArr;if(t&&0<t.length)for(var i=t.length,n=0;n<i;n++){if(e==t[n])return!1}return!0}}),game.PayMgr._instance=null,game.PayMgr._singleton=!0,game.PayMgr.inst=function(){return game.PayMgr._instance||(game.PayMgr._singleton=!1,game.PayMgr._instance=new game.PayMgr,game.PayMgr._singleton=!0),game.PayMgr._instance}},{}],607:[function(e,t,i){"use strict";e("./PayMgr")},{"./PayMgr":606}],608:[function(e,t,i){"use strict";game.PayItem=game.SkinUI.extends({_payInfo:null,_iconSprite:null,_gameAlertInfo:null,ctor:function(){this._super("pay/PayItemSkin","PayItemSkin")},getHeight:function(){return 140},getWidth:function(){return 250},onShow:function(){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon)),this.setData(this._payInfo),b8e.evt.onC(this._skin.node_click,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClickItem,this)},setData:function(e){if(this._payInfo=e,this._skin&&this._payInfo){if(this._iconSprite.loadTexture(game.ClientCfg.getImgUrl(this._payInfo.iconName),null,null,{useManifest:!1}),game.IS_HUO_SHU){var t=game.HuoShuSDK.getAppId();("2038"==t||"2066"==t)&&game.LoginConfig.isExchangeType?this._skin.lab_pay.string=this._payInfo.money*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name:this._skin.lab_pay.string=this._payInfo.money+"元"}else this._skin.lab_pay.string=this._payInfo.money+"元";this._skin.lab_reward.string=this._payInfo.diamond,game.pay.isFirstRecharge(this._payInfo.itemId)?(this._skin.node_tag.active=!0,this._skin.lab_desc.string="赠送"+this._payInfo.firstExtraDiamond+"元宝",this._skin.lab_only.string="(限购一次)"):(this._skin.node_tag.active=!1,0<this._payInfo.extraDiamond?this._skin.lab_desc.string="赠送"+this._payInfo.extraDiamond+"元宝":this._skin.lab_desc.string="",this._skin.lab_only.string="")}},onClickItem:function(){if(game.pay.isGetSeverData){var e={itemId:this._payInfo.itemId};if(game.IS_HUO_SHU){var t=game.HuoShuSDK.getAppId();if(("2038"==t||"2066"==t)&&game.LoginConfig.isExchangeType){var i=game.html.getText(game.html.REWARD_COLOR,this._payInfo.money*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name),n=game.html.getText(game.html.REWARD_COLOR,this._payInfo.money*game.LoginConfig.exchange_num+"元宝"),s="";s=game.pay.isFirstRecharge(this._payInfo.itemId)?game.html.getText(game.html.REWARD_COLOR,"赠送"+this._payInfo.firstExtraDiamond+"元宝"):0<this._payInfo.extraDiamond?game.html.getText(game.html.REWARD_COLOR,"赠送"+this._payInfo.extraDiamond+"元宝"):"",this._gameAlertInfo||(this._gameAlertInfo=new game.GameAlertInfo),this._gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this._gameAlertInfo.string=game.ccfg.LangCfg.getText("您是否花费$兑换$？<br/>"+s,[i,n]),this._gameAlertInfo.isShowTips=!1,this._gameAlertInfo.obj={params:e},game.gameAlert.showAlert(this,this.onClickPay,this._gameAlertInfo)}else game.sdk.pay(e)}else game.sdk.pay(e)}else game.notice.show("数据发生错误，请重新登陆！")},onClickPay:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.sdk.pay(e.obj.params);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}}})},{}],609:[function(e,t,i){"use strict";game.appModule.PayPanel=game.SkinUIPanel.extends({_itemInfo:null,_rechargeType:!0,_vipLv:0,_vipExp:0,_index:-1,_page:1,_minPage:1,_maxPage:-1,_collectedVipPrize:-1,_prizeList:null,_curVIPSprite:null,_nextVIPSprite:null,_bannerSprite:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.PayItem,2),this._curVIPSprite=b8e.Sprite.get(),this._curVIPSprite.addToParent(this._skin.img_nowVip),this._nextVIPSprite=b8e.Sprite.get(),this._nextVIPSprite.addToParent(this._skin.img_nextVip),this._bannerSprite=b8e.Sprite.get(),this._bannerSprite.addToParent(this._skin.img_vipBanner)},onShow:function(){if(game.pay.isRechargePanel&&!game.pay.getIsCollectedFirstRecharge())return this.hide(),void game.app.show(game.AppConstant.FIRST_RECHARGE_PANEL);this.updateCoinRemain(),this._skin.list.node.active=!1,this._skin.node_vip.active=!1,this.updatePanelInfo(),b8e.evt.onC(this._skin.btn_vip,this.onClickVipBtn,this),b8e.evt.onC(this._skin.btn_left,this.onClickLeftBtn,this),b8e.evt.onC(this._skin.btn_right,this.onClickRightBtn,this),b8e.evt.onC(this._skin.btn_receive,this.onClickReceiveBtn,this),b8e.evt.addG(this,game.VipEvents.RES_VIP_PRIZE_SUCCESS,this.updatePanelInfo),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanelInfo),b8e.evt.addG(this,game.PayEvents.PAY_EVENT_XIAN_LAI_UPDATE_COIN_REMAIN,this.updateCoinRemain),this._list.show()},onHide:function(){game.vip.panelShowVipLv=0,this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_vip,this.onClickVipBtn,this),b8e.evt.offC(this._skin.btn_left,this.onClickLeftBtn,this),b8e.evt.offC(this._skin.btn_right,this.onClickRightBtn,this),b8e.evt.offC(this._skin.btn_receive,this.onClickReceiveBtn,this),b8e.evt.rmvG(this,game.VipEvents.RES_VIP_PRIZE_SUCCESS,this.updatePanelInfo),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanelInfo),b8e.evt.rmvG(this,game.PayEvents.PAY_EVENT_XIAN_LAI_UPDATE_COIN_REMAIN,this.updateCoinRemain)},updateCoinRemain:function(){if(game.IS_HUO_SHU){var e=game.HuoShuSDK.getAppId();if("2038"==e||"2066"==e){this._skin.xlNode.active=!0;var t="",i=game.LoginConfig.coinRemain;1e8<=i?(i=i/1e8-.005,t=game.ValueUtil.getDigitsValueByNum(i,2)+"亿"):1e4<=i?(i=i/1e4-.005,t=game.ValueUtil.getDigitsValueByNum(i,2)+"万"):t=i+"",b8e.log("闲徕updateCoinRemain（充值）：_coinRemainNum："+i+"_coinRemainString："+t),b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e3).call(this.delayShow,this,[t])}else this._skin.xlNode.active=!1}else this._skin.xlNode.active=!1},delayShow:function(e){this._skin.lab_num.string=e},onClickVipBtn:function(){game.pay.getIsCollectedFirstRecharge()?(game.pay.isRechargePanel=!game.pay.isRechargePanel,this.updatePanelInfo()):(this.hide(),game.app.show(game.AppConstant.FIRST_RECHARGE_PANEL))},onClickLeftBtn:function(){this._page-=1,this.updateVipPanel()},onClickRightBtn:function(){this._page+=1,this.updateVipPanel()},onClickReceiveBtn:function(){game.VipSender.reqVipPrize(this._page)},updatePanelInfo:function(){this._vipLv=game.vip.getVipLv(),this._vipExp=game.vip.getVipExp(),this._collectedVipPrize<0&&(this._collectedVipPrize=game.vip.getCollectedVipPrize()),this._maxPage=game.ccfg.VipCfg.getMaxVipLv(),0==game.vip.panelShowVipLv&&game.vip.setOpenPanelVipLv(),this._page=game.vip.panelShowVipLv,game.pay.isRechargePanel?this.updateRechargePanel():this.updateVipPanel(),this.updateUpPanel()},updateUpPanel:function(){var e="",t="",i=0,n=this._skin.progressBar.width;if(game.vip.isMaxVip()){var s=game.ccfg.VipCfg.getMaxVipLv(),a=game.vip.getInfoByVipLv(s);a&&(this._skin.node_disappear.active=!1,this._skin.node_middle.x=250,this._skin.btn_vip.x=320,this._curVIPSprite.loadTexture(game.ClientCfg.getImgUrl(a.iconName),null,null,{useManifest:!1}),t=this._vipExp+"/"+a.needVipExp,i=this._vipExp/a.needVipExp,e="已达最大VIP等级")}else{var o=game.vip.getInfoByVipLv(this._vipLv);if(!o)return;var r=game.vip.getNextVipInfo();if(!r)return;this._curVIPSprite.loadTexture(game.ClientCfg.getImgUrl(o.iconName),null,null,{useManifest:!1}),this._nextVIPSprite.loadTexture(game.ClientCfg.getImgUrl(r.iconName),null,null,{useManifest:!1}),t=this._vipExp+"/"+r.needVipExp,e="再充值"+game.html.getText(game.html.Q_GREEN,r.needVipExp-this._vipExp)+"元宝成为VIP"+game.html.getText(game.html.Q_GREEN,this._vipLv+1),i=this._vipExp/r.needVipExp}this._skin.progress.string=t,this._skin.lab_paySum.string=e,1<=i&&(i=1),this._skin.bar.width=parseInt(n*i)},updateRechargePanel:function(){this._skin.list.node.active=!0,this._skin.node_vip.active=!1,this._skin.title.string="充值",this._skin.lab_btn.string="VIP特权";var e=game.pay.getRechargeInfoArr();e&&0<e.length&&e.sort(this.onSortByOrder),this._list.setData(e)},updateVipPanel:function(){game.vip.getNextVipInfo();var e=game.ccfg.VipCfg.getMaxVipLv();if(0<this._page){this._page>=e+1&&(this._page=e);var t=game.vip.getInfoByVipLv(this._page),i=game.ccfg.LangCfg.getText(10100+this._page);i||(i=""),this._skin.lab_privilege.string=i,this._bannerSprite.loadTexture(game.ClientCfg.getImgUrl(t.banner,!0),null,null,{useManifest:!1}),this._skin.list.node.active=!1,this._skin.node_vip.active=!0,this._skin.title.string="VIP",this._skin.lab_btn.string="立刻充值",this._skin.lab_vip.string="VIP"+this._page+"特权";var n=game.ccfg.VipCfg.getVipExpByLv(this._page);this._skin.lab_desc.string="充值"+n+"元宝成为VIP"+this._page;var s=game.vip.getVipPrizeInfo(this._page);this._prizeList||(this._prizeList=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80)),this._prizeList.addToParent(this._skin.list_goods.content),this._prizeList.setData(s),this.updataReceiveBtn(),this.updataTurnPageBtn(),this.updataBtnRedpoint()}},updateVipPrivilege:function(e){this._skin.lab_privilege.string=game.ccfg.LangCfg.getText(10101)},updataTurnPageBtn:function(){this._skin.btn_left.active=!0,this._skin.btn_right.active=!0,this._page<=this._minPage?this._skin.btn_left.active=!1:this._page>=this._maxPage&&(this._skin.btn_right.active=!1)},updataBtnRedpoint:function(){var e=this._page-1,t=this._page+1;if(this._page>this._minPage&&e<=this._vipLv&&0!=this._vipLv){var i=game.vip.isGetVipPrize(e);this._skin.left_redpoint.active=!i}else this._skin.left_redpoint.active=!1;if(this._page<this._maxPage&&t<=this._vipLv&&0!=this._vipLv){i=game.vip.isGetVipPrize(t);this._skin.right_redpoint.active=!i}else this._skin.right_redpoint.active=!1},updataReceiveBtn:function(){var e=this._page-1;(this._collectedVipPrize=game.vip.getCollectedVipPrize(),e<this._vipLv&&0!=this._vipLv)?(this._skin.btn_receive.active=!0,0!=(this._collectedVipPrize&1<<this._page-1)?(this._skin.lab_receive.string="已领取",b8e.ShaderUtil.setGray(this._skin.btn_receive)):(this._skin.lab_receive.string="领取奖励",b8e.ShaderUtil.reset(this._skin.btn_receive))):this._skin.btn_receive.active=!1},onSortByOrder:function(e,t){return e.showOrder>t.showOrder?1:e.showOrder<t.showOrder?-1:0},setTab:function(e){return!!this._skin&&("0"==e?(game.pay.isRechargePanel=!1,this.updatePanelInfo(),this._skin.btn_vip):"1"!=e||(game.pay.isRechargePanel=!0,this.updatePanelInfo(),this._skin.btn_vip))}})},{}],610:[function(e,t,i){"use strict";e("./PayPanel"),e("./PayItem")},{"./PayItem":608,"./PayPanel":609}],611:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_86"),e("./manager/managerIndex_86"),e("./panel/panelIndex_86"),e("./sender/senderIndex_86")},{"./cmdlistener/cmdlistenerIndex_86":602,"./manager/managerIndex_86":607,"./panel/panelIndex_86":610,"./sender/senderIndex_86":613}],612:[function(e,t,i){"use strict";var n=game.PaySender=function(){};n.reqRechargeInfo=function(){var e=game.pbmid.Recharge.RechargeModuleRequest;b8e.sendN(e)},n.reqRecharge=function(e,t){var i=game.pbmsg.RechargeRequest;i.type=e,i.id=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Recharge.RechargeRequest;b8e.sendN(n)},n.reqCardAward=function(e){var t=game.pbmsg.CardAwardRequest;t.cardType=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Recharge.CardAwardRequest;b8e.sendN(i)},n.reqAccumulateRechargeAward=function(e){var t=game.pbmsg.AccumulateRechargeAwardRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Recharge.AccumulateRechargeAwardRequest;b8e.sendN(i)},n.reqRechargeRebateAward=function(e){var t=game.pbmsg.RechargeRebateAwardRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Recharge.RechargeRebateAwardRequest;b8e.sendN(i)},n.reqBuyFund=function(){var e=game.pbmid.Recharge.FundBuyRequest;b8e.sendN(e)},n.reqCollectFund=function(e){var t=game.pbmsg.FundCollectRequest;t.level=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Recharge.FundCollectRequest;b8e.sendN(i)},n.reqCollectSalePrize=function(){var e=game.pbmid.Recharge.CollectSalePrizeRequest;b8e.sendN(e)}},{}],613:[function(e,t,i){"use strict";e("./PaySender")},{"./PaySender":612}],614:[function(e,t,i){"use strict";game.PkModeCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Scene.SwitchPkModeResponse,this.onSwitchPkModeResponse,this),b8e.addNH(game.pbmid.Scene.PkModeNotify,this.onPkModeNotify,this)},onSwitchPkModeResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.SwitchPkModeResponse),n=i.code,s=i.mode;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{game.pkMode.onSwitchPkModeFinish(s);var a=b8e.scene.getDisplayByType(game.RoleType.Hero);if(!a||a.length<=0)return;for(var o=0;o<a.length;o++){var r=a[o];r&&r.updateHpBar()}}},onPkModeNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.PkModeNotify);i&&game.pkMode.receivePkModeNotify(i)}})},{}],615:[function(e,t,i){"use strict";e("./PkModeCmd")},{"./PkModeCmd":614}],616:[function(e,t,i){"use strict";game.PkModeEvents=b8e.Enum({SWITCH_PK_MODE_COMPLETED:b8e.Event.nextCode(),SET_PK_MODE:b8e.Event.nextCode()})},{}],617:[function(e,t,i){"use strict";e("./PkModeEvents")},{"./PkModeEvents":616}],618:[function(e,t,i){"use strict";game.PkModeMgr=b8e.Object.extends({name:"PkModeMgr",_pkModeInfo:null,lastPkMode:null,ctor:function(){if(1==game.PkModeMgr._singleton)throw new Error("PkModeMgr 只能通过单例方法获取");this._super()},onSwitchPkModeFinish:function(e){var t=game.mainRole.mainRoleData;t.setPkMode(e);var i=game.SceneMgr.inst().getSceneConfig();i&&i.isField&&t.pkMode!=game.PkModeType.PEACE&&game.TrusteeshipMgr.inst().stop(),b8e.evt.dptG(game.PkModeEvents.SWITCH_PK_MODE_COMPLETED)},receivePkModeNotify:function(e){if(e){var t=e.currentMode;this._pkModeInfo||(this._pkModeInfo=new game.PkModeInfo),this._pkModeInfo.setup(e);var i=game.mainRole.mainRoleData;i.setPkMode(t);var n=game.SceneMgr.inst().getSceneConfig();n&&n.isField&&i.pkMode!=game.PkModeType.PEACE&&(this.lastPkMode=i.pkMode,1==this.pkModeInfo.getAvailableModesByMode(game.PkModeType.PEACE)&&game.PkSender.swichPkModeRequest(game.PkModeType.PEACE)),b8e.evt.dptG(game.PkModeEvents.SET_PK_MODE)}},pkModeInfo:{set:function(e){this._pkModeInfo=e},get:function(){return this._pkModeInfo}}}),game.PkModeMgr._instance=null,game.PkModeMgr._singleton=!0,game.PkModeMgr.inst=function(){return game.PkModeMgr._instance||(game.PkModeMgr._singleton=!1,game.PkModeMgr._instance=new game.PkModeMgr,game.PkModeMgr._singleton=!0),game.PkModeMgr._instance}},{}],619:[function(e,t,i){"use strict";e("./PkModeMgr")},{"./PkModeMgr":618}],620:[function(e,t,i){"use strict";game.PkModePanel=game.SkinUI.extends({_questInfo:null,_isShowMode:!1,ctor:function(){this._super("mainui/PkModeSkin","PkModeSkin"),game.CommandMgr.inst().registerSkinUI("PK_MODE",this)},getButtonByName:function(e){switch(e){case"pkMode":return!this._skin||this._skin.pkResultMode.node}return null},onShow:function(){this.onResize(),this.showPkResultMode(),b8e.evt.onC(this._skin.pkResultMode,this.showPkModePanel,this),b8e.evt.onC(this._skin.pkModePeaceBtn.node,this.onPkModePeaceClick,this),b8e.evt.onC(this._skin.pkModeAllBtn.node,this.onPkModeAllClick,this),b8e.evt.onC(this._skin.pkModeGuildBtn.node,this.onPkModeGuildClick,this),b8e.evt.addG(this,game.PkModeEvents.SET_PK_MODE,this.showPkResultMode),b8e.evt.addG(this,game.PkModeEvents.SWITCH_PK_MODE_COMPLETED,this.showPkResultMode)},onHide:function(){b8e.evt.offC(this._skin.pkResultMode,this.showPkModePanel,this),b8e.evt.offC(this._skin.pkModePeaceBtn.node,this.onPkModePeaceClick,this),b8e.evt.offC(this._skin.pkModeAllBtn.node,this.onPkModeAllClick,this),b8e.evt.offC(this._skin.pkModeGuildBtn.node,this.onPkModeGuildClick,this),b8e.evt.rmvG(this,game.PkModeEvents.SET_PK_MODE,this.showPkResultMode),b8e.evt.rmvG(this,game.PkModeEvents.SWITCH_PK_MODE_COMPLETED,this.showPkResultMode)},showPkModePanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.PK_MODE)&&(0==this._isShowMode?(this._isShowMode=!0,this._skin.pkModePeaceBtn.node.active=!0,this._skin.pkModeAllBtn.node.active=!0,this._skin.pkModeGuildBtn.node.active=!0,this.setAvailableModes()):(this._isShowMode=!1,this._skin.pkModePeaceBtn.node.active=!1,this._skin.pkModeAllBtn.node.active=!1,this._skin.pkModeGuildBtn.node.active=!1))},setAvailableModes:function(){null!=game.pkMode.pkModeInfo&&(0==game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.PEACE)?b8e.ShaderUtil.setGray(this._skin.pkModePeaceBtn):b8e.ShaderUtil.reset(this._skin.pkModePeaceBtn),0==game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.ALL)?b8e.ShaderUtil.setGray(this._skin.pkModeAllBtn):b8e.ShaderUtil.reset(this._skin.pkModeAllBtn),0==game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.GUILD)?b8e.ShaderUtil.setGray(this._skin.pkModeGuildBtn):0<game.mainRole.mainRoleData.guildId?b8e.ShaderUtil.reset(this._skin.pkModeGuildBtn):b8e.ShaderUtil.setGray(this._skin.pkModeGuildBtn))},onPkModePeaceClick:function(){(this._isShowMode=!0,game.mainRole.mainRoleData.pkMode==game.PkModeType.PEACE)?game.notice.show("当前已是和平模式"):game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.PEACE)?game.PkSender.swichPkModeRequest(game.PkModeType.PEACE):game.notice.show("该场景不能切换和平模式");this.showPkModePanel()},onPkModeAllClick:function(){(this._isShowMode=!0,game.mainRole.mainRoleData.pkMode==game.PkModeType.ALL)?game.notice.show("当前已是pk模式"):game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.ALL)?game.PkSender.swichPkModeRequest(game.PkModeType.ALL):game.notice.show("该场景不能切换pk模式");this.showPkModePanel()},onPkModeGuildClick:function(){this._isShowMode=!0;var e=game.mainRole.mainRoleData;if(e.pkMode==game.PkModeType.GUILD)game.notice.show("当前已是帮会模式");else if(game.pkMode.pkModeInfo.getAvailableModesByMode(game.PkModeType.GUILD))game.PkSender.swichPkModeRequest(game.PkModeType.GUILD);else{var t=game.SceneMgr.inst().getSceneConfig();if(t)if(-1!=t.availablePkModes.indexOf(game.PkModeType.GUILD)&&0==e.guildId)return game.notice.show("玩家没有加入帮派"),void this.showPkModePanel();game.notice.show("该场景不能切换帮会模式")}this.showPkModePanel()},showPkResultMode:function(){var e=game.mainRole.mainRoleData.getPkMode();this.loadResultRes(e)},loadResultRes:function(e){var t;switch(e){case game.PkModeType.PEACE:t="icon_zds_hp";break;case game.PkModeType.ALL:t="icon_zds_PK";break;case game.PkModeType.GUILD:t="icon_zds_bh"}game.ClientCfg.PKMODE_ALAST_URL,game.resController.setImgSpriteFrame(this._skin.pkResultMode,game.ClientCfg.PKMODE_ALAST_URL,t)},resReady:function(e){this._skin.pkResultMode.node.getComponent(cc.Sprite).spriteFrame=e},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._skin&&(this.x=b8e.stageWidth-this.width+e,this.y=210+t)}})},{}],621:[function(e,t,i){"use strict";e("./PkModePanel")},{"./PkModePanel":620}],622:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_3"),e("./event/eventIndex_5"),e("./manager/managerIndex_8"),e("./panel/panelIndex_14"),e("./sender/senderIndex_4")},{"./cmdlistener/cmdlistenerIndex_3":615,"./event/eventIndex_5":617,"./manager/managerIndex_8":619,"./panel/panelIndex_14":621,"./sender/senderIndex_4":624}],623:[function(e,t,i){"use strict";(game.PkSender=function(){}).swichPkModeRequest=function(e){var t=game.pbmsg.SwitchPkModeRequest;t.mode=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.SwitchPkModeRequest;b8e.sendN(i)}},{}],624:[function(e,t,i){"use strict";e("./PkSender")},{"./PkSender":623}],625:[function(e,t,i){"use strict";game.appModule.EquipBaseTips=game.SkinUIPanel.extends({_equipInfo:null,itemGrid:null,ctor:function(e){this._super(e)},onShow:function(){this._equipInfo=this.data,this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.img_icon),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.TIPS_CONTAINER_ID),this.itemGrid.addToParent(this._skin.img_icon)),this.updateInfo()},onHide:function(){this._skin.lab_itemName.string="",this._skin.lab_itemType.string="",this._skin.lab_desc.string="",this._skin.lab_lv.string="",this._skin.lab_fight.string="",game.GridUtil.setItemGrid(this.itemGrid,null)},updateInfo:function(){if(this._equipInfo){this._skin.lab_itemName.string=game.ccfg.ItemInfoCfg.getQualityNameById(this._equipInfo.id),this._skin.lab_itemType.string=game.ccfg.EquipTypeCfg.getEquipTypeNameByType(this._equipInfo.type);var e="";e=game.mainRole.mainRoleData.getLv()>=this._equipInfo.level?game.html.getText(game.html.Q_GREEN,"装备等级："+this._equipInfo.level):game.html.getText(game.html.Q_RED,"装备等级："+this._equipInfo.level),this._skin.lab_lv.string=e,this._skin.lab_fight.string=this._equipInfo.power,game.GridUtil.setItemGrid(this.itemGrid,this._equipInfo),this.itemGrid.sortLayer(),this.onUpdateEquipAttr()}},onUpdateEquipAttr:function(){var e=this.getEquipSpriteStatStr(this._equipInfo.baseSpriteStat,!1);this._equipInfo.isHighEquip&&this._equipInfo.highSpriteStat&&(e+=game.ccfg.LangCfg.getText(15049),e+=this.getEquipSpriteStatStr(this._equipInfo.highSpriteStat,!0,!0)),this._equipInfo.appendSpriteStat&&0<this._equipInfo.appendSpriteStatLine&&(e+="\n<color=#e7d7a7>附加属性</color>\n",e+=this.getEquipSpriteStatStr(this._equipInfo.appendSpriteStat,!0)),this._skin.lab_desc.string="<color=#e7d7a7>装备属性</color>\n"+e;var t=this._skin.lab_desc.node.height+10;this._skin.bg_2.height=t,this._skin.top_node.y=this._skin.bg_2.y+this._skin.bg_2.height+20,this.height=this._skin.bg.node.height=this._skin.top_node.y+this._skin.top_node.height+20,this.resetPosition()},getEquipSpriteStatStr:function(e,t){var i,n,s=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a="",o="",r="",h=e.getSpriteStats();if(h&&0<h.length)for(i=0;i<h.length;i++)if(n=h[i]){o=game.ccfg.AttrRulesCfg.getAttrNameByType(n.type),r=i!=h.length-1?"\n":"";var g=n.value;switch(game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(n.type).format){case game.AttrRulesFormat.FORMAT_1:g=n.value;break;case game.AttrRulesFormat.FORMAT_2:g=game.ValueUtil.getDigitsValueByNum(100*n.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:g=game.ValueUtil.getDigitsValueByNum(100*n.value,2)}if(s){a+=game.html.getText(game.html.Q_RED,"    "+o+" "+g);continue}t?(o=game.ccfg.AttrRulesCfg.getAttrNameByType(n.type),a+="    "+(o=game.ccfg.EquipRefineColorCfg.getColorStr(this._equipInfo.level,n.type,n.value,o+" "+n.value))+r):a+="    "+o+" "+n.value+r}return a}})},{}],626:[function(e,t,i){"use strict";game.PrizeList=b8e.BaseDisplay.extends({_itemList:null,_data:null,_wCount:0,_itemWidth:0,_itemHeight:0,_scale:1,_maxShow:0,containerId:0,realShowCount:0,ctor:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];this._wCount=e,this._itemWidth=t,this._itemHeight=i,this._scale=n,this._maxShow=s,this._isCenter=a,this._itemList=[],this._gridVec=[],this.containerId=game.ContainerId.PRIZE_LIST_ID,this._super()},setpPrameter:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];this._wCount=e,this._itemWidth=t,this._itemHeight=i,this._scale=n,this._maxShow=s,this._isCenter=a},setData:function(e){if(this._data=e,this.clearItemList(),this._data){this.realShowCount=0;var t,i,n=this._data.getPrizeList(),s=this._data.getPercent(),a=0;t=this._maxShow<=0?n.length:n.length>this._maxShow?this._maxShow:n.length;for(var o=this._itemList.length,r=0;r<t;r++){var h=n[r];if(h&&!((a=h.num*s>>0)<=0)){var g;switch(h.type){case game.PrizeItemType.TYPE_ITEM:g=game.ccfg.ItemInfoCfg.getItemInfoById(h.itemId,!0);break;case game.PrizeItemType.TYPE_SILVER:g=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.SILVER,!0);break;case game.PrizeItemType.TYPE_YUAN_BAO:g=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.YUAN_BAO,!0);break;case game.PrizeItemType.TYPE_POPULARITY:g=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.POPULARITY,!0);break;case game.PrizeItemType.CONTRIBUTION:g=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.CONTRIBUTION,!0);break;case game.PrizeItemType.BIAN_SHEN_CARD:(g=game.ccfg.BianshenCfg.getBianshenCfgById(h.itemId)).type=game.GoodsType.BIAN_SHEN_CARD;break;case game.PrizeItemType.RUNE:(g=game.ccfg.RuneCfg.getRuneDataById(h.itemId)).baseType=game.GoodsType.RUNE;break;default:b8e.warn("PrizeList PrizeItem type warn：type:"+h.type+"--- id:"+h.itemId);continue}if(g){var l;g.num=a,r<o?i=this._itemList[r]:(i=new game.ItemGrid,this._itemList.push(i),this.addChild(i)),i.gridInfo=new game.GridInfo(this.containerId),i.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(i,g),this.setPrizeListItemName(i,g,this.containerId),l=this._isCenter?this.realShowCount%this._wCount*this._itemWidth+.5*this._itemWidth-t*this._itemWidth*.5:this.realShowCount%this._wCount*this._itemWidth+.5*this._itemWidth;var c=Math.floor(this.realShowCount/this._wCount)*this._itemHeight*-1-.5*this._itemHeight;i.setPosition(l,c),i.setNum(a),i.setScale(this._scale,this._scale),i.sortLayer(),this.realShowCount++}}}var u=this._wCount*this._itemWidth,m=Math.ceil(this.realShowCount/this._wCount)*this._itemHeight;this.setSize(u,m)}},setPrizeListItemName:function(e,t,i){switch(i){case game.ContainerId.PRIZE_LIST_ID:case game.ContainerId.WORLD_BOSS_DROP_ID:case game.ContainerId.SURA_PRIZRITEN_SHOWICON:e.setName("");break;case game.ContainerId.SURA_PRIZE_ITEM_SHOWNAME:case game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID:case game.ContainerId.ESCORT_PRIZE_CONTAINER_ID:e.setName(t.name,game.html.getColorByQuality(t.quality),null,null,null,null,null,0);break;case game.ContainerId.DUNGEON_SHOW_PRIZE_CONTAINER_ID:case game.ContainerId.DUNGEON_DROP_PRIZE_LIST_ID:case game.ContainerId.DAILY_REBATE_CONTAINER_ID:case game.ContainerId.VIP_REBATE_CONTAINER_ID:t.isEquip?e.setName("Lv."+t.level,game.html.getColorByQuality(t.quality),null,null,null,null,null,0):e.setName(t.name,game.html.getColorByQuality(t.quality),null,null,null,null,null,0);break;default:e.setName("")}},clearItemList:function(){for(var e=0;e<this._itemList.length;e++){var t=this._itemList[e];game.GridUtil.setItemGrid(t,null)}},onClick:function(e){e&&e.faceInfo&&e.gridInfo&&e.gridInfo.containerId!=game.ContainerId.TIPS_CONTAINER_ID&&e.gridInfo.containerId!=game.ContainerId.DUNGEON_DROP_PRIZE_LIST_ID&&(e.faceInfo instanceof game.ItemInfo?e.faceInfo.isEquip?game.app.show(game.AppConstant.EQUIP_BASE_TIPS,e.faceInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId}):e.faceInfo instanceof game.BianshenInfo?game.bianshen.showBianshenDetail(e.faceInfo):e.faceInfo.baseType==game.GoodsType.RUNE&&game.app.show(game.AppConstant.RUNE_TIPS_PANEL,{runeInfo:e.faceInfo,containerId:e.gridInfo.containerId}))}})},{}],627:[function(e,t,i){"use strict";e("./EquipBaseTips"),e("./PrizeList")},{"./EquipBaseTips":625,"./PrizeList":626}],628:[function(e,t,i){"use strict";e("./panel/panelIndex_15")},{"./panel/panelIndex_15":627}],629:[function(e,t,i){"use strict";game.RankCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Rank.RankResponse,this.onRankResponse,this)},onRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.RankResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rank.synRankInfo(t)}})},{}],630:[function(e,t,i){"use strict";e("./RankCmd")},{"./RankCmd":629}],631:[function(e,t,i){"use strict";game.RankType=b8e.Enum({RANK_LEVEL:0,RANK_ARENA:1,RANK_POWER:2,RANK_STAR:3,RANK_MOUNT:4,RANK_WING:5,RANK_FABAO:6,RANK_REPUTATION:7,RANK_AMULET:8,RANK_DUNGEON:9,RANK_TOWER:10,RANK_XIANZHEN:11,HIGH_EQUIP:12})},{}],632:[function(e,t,i){"use strict";e("./RankType")},{"./RankType":631}],633:[function(e,t,i){"use strict";game.RankEvents=b8e.Enum({UPDATE_RANK_INFO:b8e.Event.nextCode(),GET_RANK_INFO_CALLBACK:b8e.Event.nextCode(),RANK_BTN_CHANGE:b8e.Event.nextCode()})},{}],634:[function(e,t,i){"use strict";e("./RankEvents")},{"./RankEvents":633}],635:[function(e,t,i){"use strict";game.RankMgr=b8e.Object.extends({name:"RankMgr",selfRankInfo:null,_rankMap:null,_selfRankMap:null,selectSubType:0,ctor:function(){if(1==game.RankMgr._singleton)throw new Error("RankMgr 只能通过单例方法获取");this._rankMap=b8e.HashMap.get(),this._selfRankMap=b8e.HashMap.get()},synRankInfo:function(e){if(e){var t=e.type,i=e.userRank,n=e.list;this.selfRankInfo=null==i?null:this.createOneRankInfo(t,i),this._selfRankMap.set(t,this.selfRankInfo),this.saveRankInfo(t,n)}},saveRankInfo:function(e,t){if(!t||t.length<=0)return this._rankMap.set(e,null),void b8e.evt.dptG(game.RankEvents.UPDATE_RANK_INFO);for(var i=[],n=i.length=0;n<t.length;n++){var s=t[n];s&&i.push(this.createOneRankInfo(e,s))}i&&0<i.length&&i.sort(this.onSortByRank),this._rankMap.set(e,i),b8e.evt.dptG(game.RankEvents.UPDATE_RANK_INFO)},onSortByRank:function(e,t){return e.rank>t.rank?1:e.rank<t.rank?-1:0},createOneRankInfo:function(e,t){var i=new game.RankInfo;return i.type=e,i.roleid=t.roleid,i.name=t.name,i.rank=t.rank,i.score=t.score,i.level=t.level,i.power=t.power,i.time=t.time,i.vip=t.vip,i.vipLevel=t.vipLevel,t.rebirthLevel&&(i.rebirthLevel=t.rebirthLevel),1==i.rank&&i.setInfo(t.info),i},getFirstRankInfo:function(e){var t=this._rankMap.get(e);if(!t||t.length<=0)return null;for(var i=0;i<t.length;i++){var n=t[i];if(n&&1==n.rank)return n}return null},reqRanInfoByType:function(e){game.RankSender.reqRankInfo(e)},selectType:function(e){this.selectSubType!=e&&(this.selectSubType=e,b8e.evt.dptG(game.RankEvents.RANK_BTN_CHANGE))},getSelfRanInfoByType:function(e){return this._selfRankMap.get(e)},getRankBtns:function(){return game.ccfg.RankBarCfg.getDatas()},getRankListByType:function(e){var t=this._rankMap.get(e);return!t||t.length<=0?[]:t.concat()},isSelfRankFirst:function(e){var t=this._rankMap.get(e);if(!t||t.length<=0)return!1;var i=game.mainRole.mainRoleData,n=this.getFirstRankInfo(e);return!(!n||n.roleid!=i.playerId)},showRankMenu:function(e,t){if(e){var i=game.mainRole.mainRoleData;if(e.roleid!=i.playerId)if(String(e.roleid).length<12)game.notice.show(82e3);else{i=game.mainRole.mainRoleData;if(e.roleid!=i.playerId&&e){var n=new game.MenuData;n.roleId=e.roleid,n.roleName=e.name,game.relation.isFriend(n.roleId)?game.menu.show(this,t,game.MenuList.COMMON_FRIEND_MASTER_MENU,n):game.menu.show(this,t,game.MenuList.COMMON_NORMAL_MASTER_MENU,n)}}}},getArenaRank:function(){game.rank.reqRanInfoByType(game.RankType.RANK_ARENA)}}),game.RankMgr._instance=null,game.RankMgr._singleton=!0,game.RankMgr.inst=function(){return game.RankMgr._instance||(game.RankMgr._singleton=!1,game.RankMgr._instance=new game.RankMgr,game.RankMgr._singleton=!0),game.RankMgr._instance}},{}],636:[function(e,t,i){"use strict";e("./RankMgr")},{"./RankMgr":635}],637:[function(e,t,i){"use strict";game.RankBtn=game.SkinUI.extends({_data:null,_normal:null,_select:null,ctor:function(){this._super("rank/RankBtnSkin","RankBtnSkin")},init:function(){this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle),this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle),this._selectName=b8e.Sprite.get(),this._selectName.addToParent(this._skin.selectName),this._normalName=b8e.Sprite.get(),this._normalName.addToParent(this._skin.normalTitle)},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},onTouchThis:function(){game.rank.selectType(this._data.type),this._data.type==game.RankType.RANK_FENGSHEN?game.rank.reqRanInfoByType(game.RankType.RANK_POWER):game.rank.reqRanInfoByType(this._data.type)},setData:function(e){if(this._data=e,this._skin){this._skin.normalTitle.active=!1,this._skin.selectTitle.active=!1,this._skin.normalName.active=!1,this._skin.selectName.active=!1;var t=game.rank.selectSubType;this._data.type==t?(this._skin.selectTitle.active=!0,this._skin.selectName.active=!0,this._select.loadTexture(game.ClientCfg.getImgUrl(e.selectBg,!1),null,null,{useManifest:!1}),e.selectName&&this._selectName.loadTexture(game.ClientCfg.getImgUrl(e.selectName,!1),null,null,{useManifest:!1})):(this._skin.normalTitle.active=!0,this._skin.normalName.active=!0,this._normal.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!1),null,null,{useManifest:!1}),e.btnName&&this._normalName.loadTexture(game.ClientCfg.getImgUrl(e.btnName,!1),null,null,{useManifest:!1}))}},getHeight:function(){return 95},getWidth:function(){return 85}})},{}],638:[function(e,t,i){"use strict";game.RankItem=game.SkinUI.extends({_rankInfo:null,_iconSprite:null,_stageIconSprite:null,_starIconSprite:null,_vipSprite:null,_vipNumSprite:null,_rebirthIconSprite:null,_levelIconSprite:null,_stageIconPos:null,_starIconPos:null,_labNumberPos1:null,_labNumberPos2:null,ctor:function(e){this._super("rank/RankItemSkin","RankItemSkin"),this._rankInfo=e},init:function(){this._stageIconPos=this._skin.img_stage.getPosition(),this._starIconPos=this._skin.img_star.getPosition(),this._labNumberPos1=this._skin.lab_number1.node.getPosition(),this._labNumberPos2=this._skin.lab_number2.node.getPosition()},getHeight:function(){return 54},getWidth:function(){return 520},onShow:function(){this.setData(this._rankInfo),b8e.evt.onC(this._skin.lab_name.node,this.onShowMenu,this)},onHide:function(){this._iconSprite&&this._iconSprite.unloadTexture(),this._stageIconSprite&&this._stageIconSprite.unloadTexture(),this._starIconSprite&&this._starIconSprite.unloadTexture(),this._rebirthIconSprite&&this._rebirthIconSprite.unloadTexture(),this._levelIconSprite&&this._levelIconSprite.unloadTexture(),b8e.evt.offC(this._skin.lab_name.node,this.onShowMenu,this)},onShowMenu:function(e){game.rank.showRankMenu(this._rankInfo,e)},initImg:function(){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon)),this._stageIconSprite||(this._stageIconSprite=b8e.Sprite.get(),this._stageIconSprite.addToParent(this._skin.img_stage)),this._starIconSprite||(this._starIconSprite=b8e.Sprite.get(),this._starIconSprite.addToParent(this._skin.img_star)),this._rebirthIconSprite||(this._rebirthIconSprite=b8e.Sprite.get(),this._rebirthIconSprite.addToParent(this._skin.img_rebirth)),this._levelIconSprite||(this._levelIconSprite=b8e.Sprite.get(),this._levelIconSprite.addToParent(this._skin.img_level)),this._skin.lab_number1.node.x=this._labNumberPos1.x,this._skin.lab_number2.node.x=this._labNumberPos2.x,this._skin.img_stage.x=this._stageIconPos.x,this._skin.img_star.x=this._starIconPos.x},setData:function(e){if(this._rankInfo=e,this._skin&&(this._skin.img_two.active=!1,this._skin.img_three.active=!1,this._skin.img_four.active=!1,this._skin.img_rebirth.active=!1,this._skin.lab_rank.string="",this._skin.lab_rebirth.string="",e)){switch(this.initImg(),this._vipSprite&&this._vipSprite.unloadTexture(),this._vipNumSprite&&this._vipNumSprite.unloadTexture(),this._rebirthIconSprite&&this._rebirthIconSprite.unloadTexture(),this._levelIconSprite&&this._levelIconSprite.unloadTexture(),0<e.vip&&(this._vipSprite||(this._vipSprite=b8e.Sprite.get(),this._vipSprite.addToParent(this._skin.img_vip)),this._vipSprite.loadTexture(game.ClientCfg.getImgUrl("vip/lv/vip"),null,null,{useManifest:!1}),0<e.vipLevel&&(this._vipNumSprite||(this._vipNumSprite=b8e.Sprite.get(),this._vipNumSprite.addToParent(this._skin.img_vipNum)),this._vipNumSprite.loadTexture(game.ClientCfg.getImgUrl("vip/lv/"+e.vipLevel),null,null,{useManifest:!1}))),e.rank){case 2:this._skin.img_two.active=!0;break;case 3:this._skin.img_three.active=!0;break;default:this._skin.img_four.active=!0,this._skin.lab_rank.string=e.rank}var t,i,n,s,a,o;switch(this._skin.lab_name.string=e.name,e.type){case game.RankType.RANK_MOUNT:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount);break;case game.RankType.RANK_WING:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);break;case game.RankType.RANK_FABAO:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao);break;case game.RankType.RANK_XIANZHEN:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.XianZhen)}if(this._skin.img_rebirth.active=!1,this._skin.img_level.active=!1,this._skin.lab_rebirth.string="",this._skin.lab_level.string="",this._skin.lab_number1.string="",this._skin.lab_number2.string="",t)i=t.getStageByLv(e.score),n=t.getStarByLv(e.score),this._skin.lab_number1.string=i,this._skin.lab_number2.string=n,this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/stage"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/star"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(this._skin.img_stage.active=!1,this._skin.img_star.active=!1,e.type==game.RankType.RANK_ARENA)this._skin.lab_number1.string=e.power;else if(e.type==game.RankType.RANK_LEVEL&&0<e.rebirthLevel)this._skin.lab_number1.string="",this._skin.lab_rebirth.string=e.rebirthLevel,this._skin.lab_level.string=e.score,this._skin.img_rebirth.active=!0,this._skin.img_level.active=!0,s=game.ClientCfg.getImgUrl("rank/rebirth"),this._rebirthIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/level"),this._levelIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(e.type==game.RankType.RANK_DUNGEON)a=game.loneyDungeon.getGroupById(e.score),o=game.loneyDungeon.getGroupLevelById(e.score),this._skin.lab_number1.string=a,this._skin.lab_number2.string=o,this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/group"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/groupLevel"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(e.type==game.RankType.RANK_TOWER){var r=e.score;this._skin.lab_number1.string=""+game.tower.calHeaven(r),this._skin.lab_number2.string=""+game.tower.calFloor(r),this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/heaven"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/floor"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1}),this._skin.lab_number2.node.x=this._labNumberPos2.x+10,this._skin.img_stage.x=this._stageIconPos.x-2,this._skin.lab_number1.node.x=this._skin.img_stage.x-this._skin.lab_number1.node.width+8,this._skin.img_star.x=this._starIconPos.x+6}else this._skin.lab_number1.string=e.score;if(e.type!=game.RankType.RANK_AMULET)this._skin.lab_amulet.string="",this._skin.img_icon.active=!0,s=game.ClientCfg.getImgUrl("rank/"+e.type),this._iconSprite.loadTexture(s,null,null,{useManifest:!1});else{this._skin.img_stage.active=!1,this._skin.img_star.active=!1,this._skin.img_rebirth.active=!1,this._skin.img_level.active=!1,this._skin.img_icon.active=!1,this._skin.lab_number1.string="",this._skin.lab_number2.string="";var h=game.amulet.getStageByLv(e.score)+"阶"+game.amulet.getStarByLv(e.score)+"星",g=game.ccfg.AmuletCfg.getAmuletNameByLevel(e.score);this._skin.lab_amulet.string=g+"  "+[game.html.getText(game.html.Q_GREEN,h)]}}}})},{}],639:[function(e,t,i){"use strict";game.appModule.RankPanel=game.SkinUIPanel.extends({_roleModel:null,_roleWing:null,_iconSprite:null,_stageIconSprite:null,_starIconSprite:null,_rebirthIconSprite:null,_levelIconSprite:null,_list:null,_btnList:null,_time:-1,_rankType:0,_fontsArr:null,_stageIconPos:null,_starIconPos:null,_labNumberPos1:null,_labNumberPos2:null,ctor:function(e){this._super(e),this._fontsArr=["等级","战力","战力","星级","坐骑","翅膀","法宝","声望","护符","封神","精英"]},onShow:function(){this._list.show(),this._btnList&&this._btnList.show(),this.data?(game.rank.reqRanInfoByType(this.data),game.rank.selectType(this.data)):game.rank.reqRanInfoByType(game.RankType.RANK_LEVEL),this.onUpdateRankInfo(),b8e.evt.onC(this._skin.lab_name.node,this.onShowMenu,this),b8e.evt.onC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.onC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.onUpdateRankInfo)},onHide:function(){this._list&&this._list.hide(),this._btnList&&this._btnList.hide(),game.rank.selectType(game.RankType.RANK_LEVEL),b8e.evt.offC(this._skin.lab_name.node,this.onShowMenu,this),b8e.evt.offC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.offC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.onUpdateRankInfo)},init:function(){this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon),this._stageIconSprite=b8e.Sprite.get(),this._stageIconSprite.addToParent(this._skin.img_stage),this._starIconSprite=b8e.Sprite.get(),this._starIconSprite.addToParent(this._skin.img_star),this._rebirthIconSprite=b8e.Sprite.get(),this._rebirthIconSprite.addToParent(this._skin.img_rebirth),this._levelIconSprite=b8e.Sprite.get(),this._levelIconSprite.addToParent(this._skin.img_level),this._list=new b8e.List(this._skin.list_rank,game.RankItem);var e=game.rank.getRankBtns();e&&(this._btnList=new b8e.List(this._skin.btn_list,game.RankBtn,e.length)),this._stageIconPos=this._skin.img_stage.getPosition(),this._starIconPos=this._skin.img_star.getPosition(),this._labNumberPos1=this._skin.lab_number1.node.getPosition(),this._labNumberPos2=this._skin.lab_number2.node.getPosition()},onUpdateRankInfo:function(){this.clearData();var e=game.rank.getRankBtns();e&&0<e.length&&e.sort(this.onSortBtn),this._btnList&&this._btnList.setData(e);var t=game.rank.selectSubType;this.updateFirstRankInfo(t);var i=game.rank.getRankListByType(t);i&&0<i.length&&i.splice(0,1),this._list.setData(i,!0);var n,s,a=game.rank.getSelfRanInfoByType(t);a&&0!=a.rank?this._skin.lab_myRanking.string=a.rank:this._skin.lab_myRanking.string="未上榜";var o=game.mainRole.mainRoleData;switch(t){case game.RankType.RANK_LEVEL:s=game.rebirth.getSelfRebirthAndLv();break;case game.RankType.RANK_ARENA:case game.RankType.RANK_POWER:s=o.getZhanLi();break;case game.RankType.RANK_STAR:s=game.equip.getTotalStar();break;case game.RankType.RANK_MOUNT:s=game.MountMgr().accessoryData.lv,n=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount);break;case game.RankType.RANK_WING:s=game.WingMgr().accessoryData.lv,n=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);break;case game.RankType.RANK_FABAO:s=game.FaBaoMgr().accessoryData.lv,n=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao);break;case game.RankType.RANK_XIANZHEN:s=game.XianZhenMgr().accessoryData.lv,n=game.AccessoryMgr.getMgrByType(game.AccessoryType.XianZhen);break;case game.RankType.RANK_REPUTATION:s=game.back.getAmountValue(game.AmountType.POPULARITY);break;case game.RankType.RANK_AMULET:s=game.amulet.getAmuletLevel();break;case game.RankType.RANK_DUNGEON:var r=game.loneyDungeon.getFinishDungeonId();s=game.loneyDungeon.getDungeonRank(r);break;case game.RankType.RANK_TOWER:if(0<game.tower.getInsId()){var h=game.tower.getInsId();s=game.tower.convertPassString(h)}else s="未闯关"}if(n)if(a){var g=n.getLvString(a.score);this._skin.lab_powerNum.string=g}else this._skin.lab_powerNum.string="";else this._skin.lab_powerNum.string=s;var l=game.ccfg.RankBarCfg.getShortNameByType(t);""!=l&&(this._skin.lab_powerFont.string=l)},updateFirstRankInfo:function(){var e=game.rank.selectSubType,t=game.rank.getFirstRankInfo(e);if(this._skin.img_one.active=!!t,this._skin.img_icon.active=!!t,this._vipSprite&&this._vipSprite.unloadTexture(),this._vipNumSprite&&this._vipNumSprite.unloadTexture(),this._rebirthIconSprite&&this._rebirthIconSprite.unloadTexture(),this._levelIconSprite&&this._levelIconSprite.unloadTexture(),this._skin.lab_amulet.string="",this._skin.img_icon.active=!1,t)if(this.setStageAndStar(t),this._skin.lab_name.string=t.name,e==game.RankType.RANK_ARENA?t.info?(this.showModel(t.info.protoId,t.info.surface),this.showWing(t.info.wing)):this.showModel(1001):(this.showModel(t.info.protoId,t.info.surface),this.showWing(t.info.wing)),0<t.vip&&(this._vipSprite||(this._vipSprite=b8e.Sprite.get(),this._vipSprite.addToParent(this._skin.img_vip)),this._vipSprite.loadTexture(game.ClientCfg.getImgUrl("vip/lv/vip"),null,null,{useManifest:!1}),0<t.vipLevel&&(this._vipNumSprite||(this._vipNumSprite=b8e.Sprite.get(),this._vipNumSprite.addToParent(this._skin.img_vipNum)),this._vipNumSprite.loadTexture(game.ClientCfg.getImgUrl("vip/lv/"+t.vipLevel),null,null,{useManifest:!1}))),t.type!=game.RankType.RANK_AMULET){this._skin.img_icon.active=!0;var i=game.ClientCfg.getImgUrl("rank/"+t.type);this._iconSprite.loadTexture(i,null,null,{useManifest:!1})}else{this._skin.img_stage.active=!1,this._skin.img_star.active=!1,this._skin.img_rebirth.active=!1,this._skin.img_level.active=!1,this._skin.img_icon.active=!1,this._skin.lab_number1.string="",this._skin.lab_number2.string="";var n=game.amulet.getStageByLv(t.score)+"阶"+game.amulet.getStarByLv(t.score)+"星",s=game.ccfg.AmuletCfg.getAmuletNameByLevel(t.score);this._skin.lab_amulet.string=s+"  "+[game.html.getText(game.html.Q_GREEN,n)]}else this._skin.lab_name.string=""},setStageAndStar:function(e){var t,i,n,s,a,o;switch(e.type){case game.RankType.RANK_MOUNT:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount);break;case game.RankType.RANK_WING:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);break;case game.RankType.RANK_FABAO:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao);break;case game.RankType.RANK_XIANZHEN:t=game.AccessoryMgr.getMgrByType(game.AccessoryType.XianZhen)}if(this._skin.img_rebirth.active=!1,this._skin.img_level.active=!1,this._skin.lab_rebirth.string="",this._skin.lab_level.string="",this._skin.img_stage.x=this._stageIconPos.x,this._skin.img_star.x=this._starIconPos.x,this._skin.lab_number1.node.x=this._labNumberPos1.x,this._skin.lab_number2.node.x=this._labNumberPos2.x,t)i=t.getStageByLv(e.score),n=t.getStarByLv(e.score),this._skin.lab_number1.string=i,this._skin.lab_number2.string=n,this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/stage"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/star"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(this._skin.img_stage.active=!1,this._skin.img_star.active=!1,e.type==game.RankType.RANK_ARENA)this._skin.lab_number1.string=e.power;else if(e.type==game.RankType.RANK_LEVEL&&0<e.rebirthLevel)this._skin.lab_rebirth.string=e.rebirthLevel,this._skin.lab_level.string=e.score,this._skin.img_rebirth.active=!0,this._skin.img_level.active=!0,s=game.ClientCfg.getImgUrl("rank/rebirth"),this._rebirthIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/level"),this._levelIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(e.type==game.RankType.RANK_DUNGEON)a=game.loneyDungeon.getGroupById(e.score),o=game.loneyDungeon.getGroupLevelById(e.score),this._skin.lab_number1.string=a,this._skin.lab_number2.string=o,this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/group"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/groupLevel"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1});else if(e.type==game.RankType.RANK_TOWER){var r=e.score;this._skin.lab_number1.string=""+game.tower.calHeaven(r),this._skin.lab_number2.string=""+game.tower.calFloor(r),this._skin.img_stage.active=!0,this._skin.img_star.active=!0,s=game.ClientCfg.getImgUrl("rank/heaven"),this._stageIconSprite.loadTexture(s,null,null,{useManifest:!1}),s=game.ClientCfg.getImgUrl("rank/floor"),this._starIconSprite.loadTexture(s,null,null,{useManifest:!1}),this._skin.lab_number2.node.x=this._labNumberPos2.x+10,this._skin.img_stage.x=this._stageIconPos.x-2,this._skin.lab_number1.node.x=this._skin.img_stage.x-this._skin.lab_number1.node.width+8,this._skin.img_star.x=this._starIconPos.x+6}else this._skin.lab_number1.string=e.score,this._skin.lab_number2.string="",this._skin.lab_rebirth.string="",this._skin.lab_level.string=""},showModel:function(e,t){var i,n;if(this._roleModel||(this._roleModel=b8e.SceneEntity.get(),this._roleModel.addToParent(this._skin.node_model)),0<t){var s=game.ccfg.SurfaceCfg.getDataById(t);s?(i=s.res,n=game.ClientCfg.getAvatarAnim(game.RoleType.UIRole,i)):(i=game.ccfg.HeroCfg.getResIdById(e),n=game.ClientCfg.getUiUnits(i))}else i=game.ccfg.HeroCfg.getResIdById(e),n=game.ClientCfg.getUiUnits(i);var a=this._roleModel.getAnimator(game.AnimatorType.BODY,1);n?(a||(a=this._roleModel.addAnimator(game.AnimatorType.BODY,1,-10)),a.load(n),a.play(),a.setScale(.85,.85)):a&&a.clear()},showWing:function(e){var t;this._roleWing||(this._roleWing=b8e.SceneEntity.get(),this._roleWing.addToParent(this._skin.node_wing));var i,n,s=!1;if((n=e)&&(i=game.ccfg.WingCfg.getDataById(n))&&(s=!0),s){t=game.ClientCfg.getWing(i.res);var a=this._roleWing.getAnimator(game.AnimatorType.WING,1);t?(a||(a=this._roleWing.addAnimator(game.AnimatorType.WING,1,-11)),a.load(t),a.play(),a.setScale(1.5,1.5)):a&&a.clear()}},onSortBtn:function(e,t){return e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0},onShowMenu:function(e){var t=game.rank.getFirstRankInfo(game.rank.selectSubType);t&&game.rank.showRankMenu(t,e)},clickLeftBtn:function(){this._btnList&&this._btnList.scrollLeft()},clickRightBtn:function(){this._btnList&&this._btnList.scrollRight()},clearData:function(){if(this._roleModel){var e=this._roleModel.getAnimator(game.AnimatorType.BODY,1);e&&e.clear()}if(this._roleWing){var t=this._roleWing.getAnimator(game.AnimatorType.WING,1);t&&t.clear()}this._skin.img_one.active=!1,this._skin.img_icon.active=!1,this._skin.lab_name.string="",this._skin.lab_number1.string="",this._skin.lab_number2.string="",this._skin.lab_rebirth.string="",this._skin.lab_level.string="",this._iconSprite&&this._iconSprite.unloadTexture(),this._stageIconSprite&&this._stageIconSprite.unloadTexture(),this._starIconSprite&&this._starIconSprite.unloadTexture()}})},{}],640:[function(e,t,i){"use strict";e("./RankPanel"),e("./RankItem")},{"./RankItem":638,"./RankPanel":639}],641:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_82"),e("./manager/managerIndex_82"),e("./panel/panelIndex_82"),e("./sender/senderIndex_82"),e("./enum/rankEnumIndex_0")},{"./cmdlistener/cmdlistenerIndex_82":630,"./enum/rankEnumIndex_0":632,"./manager/managerIndex_82":636,"./panel/panelIndex_82":640,"./sender/senderIndex_82":643}],642:[function(e,t,i){"use strict";(game.RankSender=function(){}).reqRankInfo=function(e){var t=game.pbmsg.RankRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Rank.RankRequest;b8e.sendN(i)}},{}],643:[function(e,t,i){"use strict";e("./RankSender")},{"./RankSender":642}],644:[function(e,t,i){"use strict";game.RebirthCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Rebirth.QryRebirthModuleResponse,this.onQryRebirthModuleResponse,this),b8e.addNH(game.pbmid.Rebirth.UpgradeRebirthResponse,this.onUpgradeRebirthResponse,this),b8e.addNH(game.pbmid.Rebirth.ExpConvertResponse,this.onExpConvertResponse,this),b8e.addNH(game.pbmid.Rebirth.ItemConvertResponse,this.onItemConvertResponse,this)},onQryRebirthModuleResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryRebirthModuleResponse);t&&game.rebirth.init(t)},onUpgradeRebirthResponse:function(e){var t=e.readProtobuf(game.pbmsg.UpgradeRebirthResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rebirth.upgradeRebirthSuccess(t))},onExpConvertResponse:function(e){var t=e.readProtobuf(game.pbmsg.ExpConvertResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rebirth.expConvertSuccess(t))},onItemConvertResponse:function(e){var t=e.readProtobuf(game.pbmsg.ItemConvertResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rebirth.itemConvertSuccess(t))},onQryConvertCountRequest:function(e){e.readProtobuf(game.pbmsg.QryConvertCountRequest)}})},{}],645:[function(e,t,i){"use strict";game.RebirthEvent=b8e.Enum({INIT_DATA:b8e.Event.nextCode(),UPGRAD_LEVEL_SUCCESS:b8e.Event.nextCode(),CONVERT_SUCCESS:b8e.Event.nextCode()})},{}],646:[function(e,t,i){"use strict";game.RebirthMgr=b8e.Object.extends({rebirthLevel:0,cultivation:0,expCount:0,itemCount:0,rebirthItemId:0,isInit:!1,ctor:function(){if(1==game.RebirthMgr._singleton)throw new Error("RebirthMgr 只能通过单例方法获取")},resetDaily:function(){this.expCount=0,this.itemCount=0,b8e.evt.dptG(game.RebirthEvent.INIT_DATA)},init:function(e){this.rebirthLevel=e.rebirthLevel,this.cultivation=e.cultivation,this.expCount=e.expCount,this.itemCount=e.itemCount,this.isInit=!0,this.rebirthItemId=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.REBIRTH_ITEM_ID),game.TriggerMgr.inst().setRebirthData(),b8e.evt.dptG(game.RebirthEvent.INIT_DATA)},getCurCfg:function(){return game.ccfg.RebirthCfg.getDataById(this.rebirthLevel)},getNextCfg:function(){return game.ccfg.RebirthCfg.getDataById(this.rebirthLevel+1)},getRebirthData:function(){0==this.isInit?game.RebirthSender.initModule():b8e.evt.dptG(game.RebirthEvent.INIT_DATA)},upgradeRebirth:function(){var e=this.getCurCfg();this.cultivation<e.cultivation?game.notice.show("修为不足无法转生"):game.RebirthSender.upgradeRebirth()},upgradeRebirthSuccess:function(e){!e||0<e.code||(this.rebirthLevel=e.rebirthLevel,this.cultivation=e.cultivation,game.notice.show("转生成功,获得大量属性提升"),b8e.evt.dptG(game.RebirthEvent.UPGRAD_LEVEL_SUCCESS),game.sdk.levelUpLog())},expConvert:function(){var e=this.getCurCfg();if(e.expConvertCount<=this.expConvertCount)game.notice.show("兑换次数已经到达上限");else{var t=game.mainRole.mainRoleData.getLv();if(e.lowerLimitLevel>=t)game.notice.show("等级不足兑换");else{var i=new game.GameAlertInfo;i.alertType=game.GameAlertType.TwoBtn,i.string="兑换修为将使等级<color=#dd3333>降低1级</c>\n是否兑换",i.isShowTips=!0,game.gameAlert.showAlert(this,this.onExpConvertBtn,i)}}},onExpConvertBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.RebirthSender.expConvert();break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},expConvertSuccess:function(e){this.expCount++;var t=e.cultivation-this.cultivation;this.cultivation=e.cultivation,game.notice.show(100011,[t]),b8e.evt.dptG(game.RebirthEvent.CONVERT_SUCCESS)},itemConvert:function(){if(game.vip.getRebirthItemUseCount()<=this.itemCount)game.gameAlert.showVipAlert(!1,100);else{var e=new game.UpgradeInfo;e.addCostItem(this.rebirthItemId,1),game.upgrade.costCheck(this,e,this.checkItemConvertComplete,!1,!0)}},checkItemConvertComplete:function(e){e&&game.RebirthSender.itemConvert()},itemConvertSuccess:function(e){this.itemCount++;var t=e.cultivation-this.cultivation;this.cultivation=e.cultivation,game.notice.show(100011,[t]),b8e.evt.dptG(game.RebirthEvent.CONVERT_SUCCESS)},getSelfRebirthAndLv:function(){var e=game.mainRole.mainRoleData.getLv();return this.getRebirthAndLv(this.rebirthLevel,e)},getRebirthAndLv:function(e,t){var i="";return 0<e&&(i+=e+"转"),i+=t+"级"},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.REBIRTH_ALERT,game.SpotAlertChildrens.REBIRTH_ALERT_CHILDRENDS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.REBIRTH_EXP_BUY_ALERT,null,this.rebirthExpBuyAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.REBIRTH_ITEM_BUY_ALERT,null,this.rebirthItemBuyAlert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.REBIRTH_UPGRADE_ALERT,null,this.rebirthUpgradeAlert,this)},rebirthItemBuyAlert:function(){return!!game.funcOpen.checkOpen(game.FunctionType.REBIRTH)&&(!(game.vip.getRebirthItemUseCount()<=this.itemCount)&&!(game.back.getItemInfoCountById(this.rebirthItemId)<=0))},rebirthExpBuyAlert:function(){if(!game.funcOpen.checkOpen(game.FunctionType.REBIRTH))return!1;var e=this.getCurCfg();if(e.expConvertCount<=this.expCount)return!1;var t=game.mainRole.mainRoleData.getLv();return!(e.lowerLimitLevel>=t)},rebirthUpgradeAlert:function(){if(!game.funcOpen.checkOpen(game.FunctionType.REBIRTH))return!1;var e=this.getNextCfg();return!!e&&!(this.cultivation<e.cultivation)},isRebirthExp:function(){if(!game.funcOpen.checkOpen(game.FunctionType.REBIRTH))return!1;var e=this.getCurCfg();if(!e)return!1;var t=game.mainRole.mainRoleData.getExp(),i=game.ccfg.ExpCfg.getExpByLevel(e.upLimitLevel),n=game.mainRole.mainRoleData.getLv();return!(e.upLimitLevel>=n&&i-1<=t)},addCultivationByOtherWay:function(e){this.cultivation+=e,game.notice.show(100011,[e]),b8e.evt.dptG(game.RebirthEvent.CONVERT_SUCCESS)}}),game.RebirthMgr._instance=null,game.RebirthMgr._singleton=!0,game.RebirthMgr.inst=function(){return null==game.RebirthMgr._instance&&(game.RebirthMgr._singleton=!1,game.RebirthMgr._instance=new game.RebirthMgr,game.RebirthMgr._singleton=!0),game.RebirthMgr._instance}},{}],647:[function(e,t,i){"use strict";game.appModule.RebirthBuyPanel=game.SkinUIPanel.extends({expIcon:null,itemIcon:null,onShow:function(){this.initPanel(),b8e.evt.addG(this,game.RebirthEvent.CONVERT_SUCCESS,this.onSetData),b8e.evt.onC(this._skin.expChange,this.onExpChange,this),b8e.evt.onC(this._skin.itemChange,this.onItemChange,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo),b8e.evt.addG(this,game.BackEvt.BACK_REMOVE_ITEMINFO,this.updateInfo),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onSetData),this.onSetData(),this.onSpotAlertChange()},onHide:function(){b8e.evt.rmvG(this,game.RebirthEvent.CONVERT_SUCCESS,this.onSetData),b8e.evt.offC(this._skin.expChange,this.onExpChange,this),b8e.evt.offC(this._skin.itemChange,this.onItemChange,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateInfo),b8e.evt.rmvG(this,game.BackEvt.BACK_REMOVE_ITEMINFO,this.updateInfo),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onSetData)},onSpotAlertChange:function(){this._skin.expAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_EXP_BUY_ALERT),this._skin.itemAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_ITEM_BUY_ALERT)},updateInfo:function(){this.onSpotAlertChange(),this.onSetData()},initPanel:function(){var e;this.expIcon||(this.expIcon=game.GridUtil.creatItemGrid(this,this._skin.expIcon),this.expIcon.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this.expIcon.fnOnClick(this,this.onClick),(e=game.ccfg.ItemInfoCfg.getItemInfoById(game.AmountItemId.EXP))&&(game.GridUtil.setItemGrid(this.expIcon,e),this.expIcon.setNum(1),this.expIcon.sortLayer()));this.itemIcon||(this.itemIcon=game.GridUtil.creatItemGrid(this,this._skin.itemIcon),this.itemIcon.gridInfo=new game.GridInfo(game.ContainerId.COST_CONTAINER_ID),this.itemIcon.fnOnClick(this,this.onClick),(e=game.ccfg.ItemInfoCfg.getItemInfoById(game.rebirth.rebirthItemId))&&(game.GridUtil.setItemGrid(this.itemIcon,e),this.itemIcon.setNum(1),this.itemIcon.sortLayer()))},onClick:function(e){e&&e.faceInfo&&""!=e.faceInfo.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:e.faceInfo,num:e.faceInfo.num})},onSetData:function(){var e=game.rebirth.getCurCfg(),t=game.mainRole.mainRoleData.getLv();e.lowerLimitLevel>=t?(this._skin.expDes.string="等级大于"+e.lowerLimitLevel+"级可兑换",this._skin.expCost.string=""):(this._skin.expDes.string="",this._skin.expCost.string="等级兑换:降低"+e.levelReduce+"级");var i,n=e.expConvertCount-game.rebirth.expCount;0<n?i=game.html.Q_GREEN:(i=game.html.Q_RED,n=0),this._skin.expCount.string="今日还可兑换"+game.html.getText(i,n)+"次";var s=game.ccfg.ExpCfg.getCfgByLevel(t);s?this._skin.expAdd.string="增加"+game.html.getText(game.html.Q_GREEN,s.expConvertValue)+"修为":(this._skin.expAdd.string="",b8e.warn("等级兑换经验未找到"));var a=game.rebirth.rebirthItemId,o=game.ccfg.ItemInfoCfg.getItemInfoById(a);if(o){var r=game.back.getItemInfoCountById(a);if(0<r)this._skin.itemName.string=o.name+game.html.getText(game.html.Q_GREEN,"(拥有"+r+"颗)"),this._skin.itemBuy.active=!1,this._skin.itemChangeLbl.string="使  用";else{this._skin.itemName.string=o.name,this._skin.itemBuy.active=!0;var h=game.ccfg.ShopCfg.getCfgByGoodsId(a);if(h){var g=h.items?h.items[0]:null;g?this._skin.itemCost.string=g.Num+"":b8e.warn("转生丹没有配置购买消耗")}this._skin.itemChangeLbl.string="购买并使用"}}var l=game.vip.getRebirthItemUseCount()-game.rebirth.itemCount;0<l?i=game.html.Q_GREEN:(i=game.html.Q_RED,l=0),this._skin.itemCount.string="今日还可使用"+game.html.getText(i,l)+"次",this._skin.itemAdd.string="增加"+game.html.getText(game.html.Q_GREEN,e.itemConvertValue)+"修为"},onExpChange:function(){game.rebirth.expConvert()},onItemChange:function(){game.rebirth.itemConvert()}})},{}],648:[function(e,t,i){"use strict";game.appModule.RebirthPanel=game.SkinUIPanel.extends({nowStats:null,nextStats:null,upgradeAlert:null,convertAlert:null,upgradeEffect:null,upgradeTextEffect:null,onShow:function(){this.initPanel(),b8e.evt.addG(this,game.RebirthEvent.INIT_DATA,this.onInitData),b8e.evt.addG(this,game.RebirthEvent.CONVERT_SUCCESS,this.onInitData),b8e.evt.addG(this,game.RebirthEvent.UPGRAD_LEVEL_SUCCESS,this.upgradeSuccess),b8e.evt.onC(this._skin.upgrade,this.onUpgrade,this),b8e.evt.onC(this._skin.getCultivation,this.onGetCultivation,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),game.rebirth.getRebirthData()},onHide:function(){b8e.evt.offC(this._skin.upgrade,this.onUpgrade,this),b8e.evt.offC(this._skin.getCultivation,this.onGetCultivation,this),b8e.evt.rmvG(this,game.RebirthEvent.INIT_DATA,this.onInitData),b8e.evt.rmvG(this,game.RebirthEvent.CONVERT_SUCCESS,this.onInitData),b8e.evt.rmvG(this,game.RebirthEvent.UPGRAD_LEVEL_SUCCESS,this.upgradeSuccess),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.autoCLearUpgradeEffect()},_isPlayConvertEffect:!1,_isPlayUpgradeEffect:!1,onSpotAlertChange:function(){if(game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_EXP_BUY_ALERT)||game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_ITEM_BUY_ALERT)){if(0==this._isPlayConvertEffect){var e=game.ClientCfg.getUIFxs(10056);this.convertAlert.load(e),this.convertAlert.play(),this._isPlayConvertEffect=!0}}else this._isPlayConvertEffect=!1,this.convertAlert.clear();if(game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_UPGRADE_ALERT)){if(this._isPlayUpgradeEffect){this._isPlayUpgradeEffect=!0;e=game.ClientCfg.getUIFxs(10019);this.upgradeAlert.load(e),this.upgradeAlert.play()}}else this._isPlayUpgradeEffect=!1,this.upgradeAlert.clear()},onUpgrade:function(){game.rebirth.upgradeRebirth()},onGetCultivation:function(){game.app.show(game.AppConstant.REBIRTH_BUY_PANEL)},initPanel:function(){var e;if(!this.nowStats){this.nowStats=[];for(var t=0;t<5;t++)(e=this.getLabText()).node.setPosition(0,-30*t),e.node.color=b8e.ColorUtil.toCCColor(game.html.Q_WHITE),this._skin.nowStat.addChild(e.node),this.nowStats.push(e)}if(!this.nextStats)for(this.nextStats=[],t=0;t<5;t++)(e=this.getLabText()).node.setPosition(0,-30*t),e.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN),this._skin.nextStat.addChild(e.node),this.nextStats.push(e);this.upgradeAlert||(this.upgradeAlert=b8e.Animator.get(game.AnimatorType.REBIRTH_UPGRADE_EFFECT,1),this.upgradeAlert.addToParent(this._skin.upgrade),this.upgradeAlert.setAnchor(.5,.5)),this.convertAlert||(this.convertAlert=b8e.Animator.get(game.AnimatorType.REBIRTH_CONVERT_EFFECT,1),this.convertAlert.addToParent(this._skin.getCultivation),this.convertAlert.setAnchor(.5,.5)),this.upgradeEffect||(this.upgradeEffect=b8e.Animator.get(game.AnimatorType.REBIRTH_UPGRADE_SUCCESS_EFFECT,1),this.upgradeEffect.addToParent(this._skin.upgradeEffect),this.upgradeEffect.setAnchor(.5,.5),this.upgradeEffect.setBlendMode(b8e.BlendMode.ADD)),this.upgradeTextEffect||(this.upgradeTextEffect=b8e.Animator.get(game.AnimatorType.REBIRTH_UPGRADE_SUCCESS_EFFECT,2),this.upgradeTextEffect.addToParent(this._skin.upgradeEffect),this.upgradeTextEffect.setAnchor(.5,.5))},upgradeSuccess:function(){var e=game.ClientCfg.getUIFxs(10057);this.upgradeEffect.load(e),this.upgradeEffect.play(0),e=game.ClientCfg.getUIFxs(11057),this.upgradeTextEffect.load(e),this.upgradeTextEffect.play(0),b8e.Tween.kill(this.upgradeEffect),b8e.Tween.get(this.upgradeEffect).wait(900).call(this.autoCLearUpgradeEffect,this),this.onInitData()},autoCLearUpgradeEffect:function(){this.upgradeEffect&&(this.upgradeEffect.clear(),this.upgradeTextEffect.clear(),b8e.Tween.kill(this.upgradeEffect))},onInitData:function(){var e,t=game.rebirth.getCurCfg(),i=game.rebirth.getNextCfg();this._skin.curLv.string="当前转生等级:"+t.level,this._skin.prower.string=t.power,this._skin.nowMaxLv.string=t.upLimitLevel;for(var n=game.ccfg.SpriteStatCfg.getSpriteStatById(t.attr).getSpriteStats(),s=0;s<5;s++)e=n[s],this.nowStats[s].string=e?game.ccfg.AttrRulesCfg.getAttrNameByType(e.type)+" +"+e.value:"";if(this._skin.have.string=game.rebirth.cultivation+"",i){this._skin.cost.string=i.cultivation+"",this._skin.maxLabel.active=!1,this._skin.upgradeNode.active=!0,this._skin.nowStatNode.x=160,this._skin.nextMaxLv.string=i.upLimitLevel;for(n=game.ccfg.SpriteStatCfg.getSpriteStatById(i.attr).getSpriteStats(),s=0;s<5;s++)e=n[s],this.nextStats[s].string=e?game.ccfg.AttrRulesCfg.getAttrNameByType(e.type)+" +"+e.value:""}else this._skin.upgradeNode.active=!1,this._skin.nowStatNode.x=300,this._skin.maxLabel.active=!0,this._skin.cost.string="0"},getLabText:function(){var e=b8e.BaseDisplay.get().getNode().addComponent(cc.Label);return e.overflow=b8e.OverflowType.NONE,e.horizontalAlign=b8e.HorizontalAlign.LEFT,e.verticalAlign=b8e.VerticalAlign.TOP,e.fontSize=18,e.node.width=100,e.node.height=20,e.node.setAnchorPoint(0,.5),e}})},{}],649:[function(e,t,i){"use strict";e("./cmd/RebirthCmd"),e("./event/RebirthEvent"),e("./mgr/RebirthMgr"),e("./panel/RebirthPanel"),e("./panel/RebirthBuyPanel"),e("./sender/RebirthSender")},{"./cmd/RebirthCmd":644,"./event/RebirthEvent":645,"./mgr/RebirthMgr":646,"./panel/RebirthBuyPanel":647,"./panel/RebirthPanel":648,"./sender/RebirthSender":650}],650:[function(e,t,i){"use strict";game.RebirthSender={},game.RebirthSender.initModule=function(){var e=game.pbmid.Rebirth.QryRebirthModuleRequest;b8e.sendN(e)},game.RebirthSender.expConvert=function(){var e=game.pbmid.Rebirth.ExpConvertRequest;b8e.sendN(e)},game.RebirthSender.itemConvert=function(){var e=game.pbmid.Rebirth.ItemConvertRequest;b8e.sendN(e)},game.RebirthSender.upgradeRebirth=function(){var e=game.pbmid.Rebirth.UpgradeRebirthRequest;b8e.sendN(e)}},{}],651:[function(e,t,i){"use strict";game.DiscountDailyPanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_timer:null,discount:null,ctor:function(){this._super("rechargeActive/DiscountDailySkin","DiscountDailySkin")},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize),this.updateBanner()},onShow:function(){this.updatePanel(),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,1e3),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.PayEvents.UPDATE_DISCOUNT_BTN,this.updateBanner)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.PayEvents.UPDATE_DISCOUNT_BTN,this.updateBanner),this._timer&&this._timer.stop()},updateBanner:function(){var e=game.pay.getDiscountBanner();e&&(this.discount||(this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.login)),this.discount.unloadTexture(),this.discount.loadTexture(game.ClientCfg.getImgUrl(e,!0),null,null,{useManifest:!1}))},updatePanel:function(){var e=game.pay.getDiscountDailyDropId(),t=game.pay.getDiscountDailyRealCost(),i=game.pay.getDiscountDailyShowCost();if(this._prizeInfo.setupById(e),this._prizeList.setData(this._prizeInfo),game.IS_HUO_SHU){var n=game.HuoShuSDK.getAppId();("2038"==n||"2066"==n)&&game.LoginConfig.isExchangeType?(this._skin.lab_buy.string=t*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name+"购买",this._skin.lab_showCost.string="原价："+i*game.LoginConfig.exchange_num+game.LoginConfig.exchange_name):(this._skin.lab_buy.string=t+"元购买",this._skin.lab_showCost.string="原价："+i+"元")}else this._skin.lab_buy.string=t+"元购买",this._skin.lab_showCost.string="原价："+i+"元";var s=i/t*100>>0;this._skin.lab_desc.string=s+"%";var a=game.pay.getIsBuyDiscountDaily();this._skin.btn_buy.active=!a},onClickBuyBtn:function(){if(game.pay.isGetSeverData){var e=game.pay.getDiscountDailyItemId();if(0<e){var t={itemId:e};game.sdk.pay(t)}}else game.notice.show("数据发生错误，请重新登陆！")},updateTime:function(){var e=game.SysTime.curTime,t=b8e.TimeUtil.getNextDateTime(e,1),i=b8e.TimeUtil.formatTime(t-e);this._skin.lab_time.string=i}})},{}],652:[function(e,t,i){"use strict";game.SaleDailyItem=game.SkinUI.extends({_data:null,_prizeInfo:null,_prizeList:null,ctor:function(e){this._super("rechargeActive/SaleDailyItemSkin","SaleDailyItemSkin"),this._prizeInfo=new game.PrizeInfo,this._data=e},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.btn_buy,this.onClickBuyBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuyBtn,this)},init:function(){this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize)},setData:function(e){(this._data=e,this._skin&&this._data)&&(-1<game.pay.getSaleRecords().indexOf(e.saleType)?this._skin.btn_buy.active=!1:this._skin.btn_buy.active=!0,this._skin.lab_price.string=e.name,this._skin.lab_desc.string=e.desc,this._skin.lab_buy.string=e.saleType+"元购买",this._prizeInfo.setupById(e.dropId),this._prizeList.setData(this._prizeInfo))},onClickBuyBtn:function(){if(game.pay.isGetSeverData){var e={itemId:this._data.itemId};game.sdk.pay(e)}else game.notice.show("数据发生错误，请重新登陆！")},getWidth:function(){return 545},getHeight:function(){return 140}})},{}],653:[function(e,t,i){"use strict";game.SaleDailyPanel=game.SkinUI.extends({_list:null,discount:null,ctor:function(){this._super("rechargeActive/SaleDailySkin","SaleDailySkin")},onShow:function(){this._list.show(),this.updatePanel(),b8e.evt.onC(this._skin.btn_close,this.onClickBox,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.updatePanel)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_close,this.onClickBox,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.PayEvents.COLLECT_SALE_DAILY_SUCCESS,this.updatePanel)},init:function(){this._list=new b8e.List(this._skin.list,game.SaleDailyItem),this._sceneLayerBtn=b8e.BaseDisplay.get(),this._sceneLayerBtn.addToParent(this._skin.btn_close),this._btnAnim=b8e.Animator.get(game.AnimatorType.SALE_DAILY_EFFECT,1),this._sceneLayerBtn.addChild(this._btnAnim),this.discount=b8e.Sprite.get(),this.discount.addToParent(this._skin.discount)},updatePanel:function(){var e=game.pay.getIsCollectedSalePrizeDaily();e?this.clearAnimator():this.showBtnModel(),this._skin.lab_box.string=e?"已领取":"今日福利";var t=game.pay.getSalePrizeArr();this._list.setData(t);var i=game.active.selectSubType,n=game.ccfg.ClientActiveCfg.getDataById(i);n&&""==n.discount||(this.discount.setVisible(!0),this.discount.loadTexture(game.ClientCfg.getImgUrl(n.discount,!0),null,null,{useManifest:!1}))},onClickBox:function(){game.pay.getIsCollectedSalePrizeDaily()||game.PaySender.reqCollectSalePrize()},showBtnModel:function(){var e=game.ClientCfg.getUIFxs("10072");e?(this._btnAnim.load(e),this._btnAnim.play()):this._btnAnim&&this._btnAnim.clear()},clearAnimator:function(){this._btnAnim&&this._btnAnim.clear()}})},{}],654:[function(e,t,i){"use strict";game.TimeLimitRechargePanel=game.SkinUI.extends({ctor:function(){this._super("rechargeActive/TimeLimitRechargeSkin","TimeLimitRechargeSkin")},init:function(){},onShow:function(){},onHide:function(){}})},{}],655:[function(e,t,i){"use strict";game.ReconnectLoading=b8e.PrefabDisplay.extends({_bgGraph:null,_isShowing:!1,_loadComplete:!1,ctor:function(){this._super(),this._bgGraph=b8e.Graphics.get(),this._bgGraph.setAnchor(.5,.5),this.addChild(this._bgGraph)},show:function(){this.parent||(0==this._loadComplete?this.loadPrefab("app/prefabs/app_module_skin/reconnect/ReconnectSkin","ReconnectSkin",this.onLoaded,this):this.onLoaded(),b8e.layer.getTopLayer().addChild(this),this.setLocalZOrder(999999999),this.onResize(),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.onC(this._bgGraph,this.onClick,this))},onLoaded:function(){this._loadComplete||(this._loadComplete=!0),this.onResize()},hide:function(){this.onHide()},onHide:function(){this.parent&&(this.removeFromParent(),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onResize),b8e.evt.offC(this._bgGraph,this.onClick,this))},onClick:function(){},setSize:function(e,t){this._super(e,t),this.onResize()},onResize:function(){this._bgGraph.clear(),this._bgGraph.fillColor(1711276032),this._bgGraph.fillRect(0,0,b8e.stageWidth,b8e.stageHeight),this._bgGraph.setSize(b8e.stageWidth,b8e.stageHeight),this.setPosition(.5*b8e.stageWidth,.5*b8e.stageHeight)},setTipText:function(e){this.callProp("setText",e)},setErrorText:function(e){this.callProp("setText",e),this.callProp("setTextColor",4294901760)},setProgress:function(e){this.callProp("setProgress",e)}}),game.ReconnectLoading._instance=null,game.ReconnectLoading._singleton=!0,game.ReconnectLoading.inst=function(){return null==game.ReconnectLoading._instance&&(game.ReconnectLoading._singleton=!1,game.ReconnectLoading._instance=new game.ReconnectLoading,game.ReconnectLoading._singleton=!0),game.ReconnectLoading._instance}},{}],656:[function(e,t,i){"use strict";game.RedPacketCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Welfare.HongbaoNotify,this.onHongbaoNotify,this),b8e.addNH(game.pbmid.Welfare.CollectHongbaoResponse,this.onCollectHongbaoResponse,this)},onHongbaoNotify:function(e){var t=e.readProtobuf(game.pbmsg.HongbaoNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.redPacket.synHongbaoNotify(t)},onCollectHongbaoResponse:function(e){var t=e.readProtobuf(game.pbmsg.CollectHongbaoResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),game.redPacket.delRedPacket(t.id)):game.redPacket.collectHongbao(t)}})},{}],657:[function(e,t,i){"use strict";game.RedPacketEvents=b8e.Enum({RED_PACKET_UPDATE:b8e.Event.nextCode(),DEL_RED_PACKET_SUCCESS:b8e.Event.nextCode()})},{}],658:[function(e,t,i){"use strict";game.RedPacketMgr=b8e.Object.extends({redPacketNum:0,_timer:null,ctor:function(){this._super(),this.redPacketMap=b8e.HashMap.get()},synHongbaoNotify:function(e){var t=new game.RedPacketInfo;t.setup(e),this.redPacketMap.set(t.id,t),this.redPacketNum=this.redPacketMap.count(),b8e.evt.dptG(game.RedPacketEvents.RED_PACKET_UPDATE),this._timer||(this._timer=b8e.Timer.add(this,this.checkRedPacketExpire,1e3))},collectHongbao:function(e){this.items=e.items,game.app.show(game.AppConstant.RED_PACKET_DETAIL_PANEL),this.delRedPacket(e.id)},checkRedPacketExpire:function(){var e,t,i=this.getRedPacketArr();if(i&&0<i.length)for(var n=0;n<i.length;n++)e=i[n],t=game.SysTime.curTime,e.expireTime-t<=0&&this.delRedPacket(e.id);else this._timer&&(b8e.Timer.remove(this,this.checkRedPacketExpire),this._timer=null)},delRedPacket:function(e){this.redPacketMap.get(e)&&this.redPacketMap.del(e),this.redPacketNum=this.redPacketMap.count(),b8e.evt.dptG(game.RedPacketEvents.DEL_RED_PACKET_SUCCESS)},getRedPacketArr:function(){return this.redPacketMap.values()},getRedPacketById:function(e){return this.redPacketMap.get(e)}}),game.RedPacketMgr._instance=null,game.RedPacketMgr.inst=function(){return game.RedPacketMgr._instance||(game.RedPacketMgr._instance=new game.RedPacketMgr),game.RedPacketMgr._instance}},{}],659:[function(e,t,i){"use strict";game.appModule.RedPacketDetailPanel=game.SkinUIPanel.extends({_bgSprite:null,_prizeInfo:null,_prizeList:null,ctor:function(e){this._super(e)},init:function(){this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_packet)},onShow:function(){this.updatePrize(),b8e.evt.onC(this,this.onClickYes,this),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("redPacket/bg_redPacket"),null,null,{useManifest:!1})},onHide:function(){b8e.evt.offC(this,this.onClickYes,this),this._bgSprite.unloadTexture(),this._prizeList&&this._prizeList.removeFromParent()},updatePrize:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80);var e=game.redPacket.items,t=e.list;t&&0<t.length?this._prizeInfo.setupItemList(t):e.amount&&this._prizeInfo.setupAmount(e.amount),this._prizeList.addToParent(this._skin.prize),this._prizeList.setData(this._prizeInfo)},onClickYes:function(){this.hide()}})},{}],660:[function(e,t,i){"use strict";game.RedPacketItem=game.SkinUI.extends({_redPacketInfo:null,ctor:function(e){this._super("redPacket/RedPacketItemSkin","RedPacketItemSkin"),this._redPacketInfo=e},onShow:function(){this.setData(this._redPacketInfo),b8e.evt.onC(this,this.onClickBtn,this)},onHide:function(){b8e.evt.offC(this,this.onClickBtn,this)},setData:function(e){if(this._redPacketInfo=e,this._skin&&this._redPacketInfo){var t=game.SysTime.curTime;this._skin.lab_desc.string=e.content,this._skin.lab_time.string=parseInt((e.expireTime-t)/1e3)+"秒后消失"}},onClickBtn:function(){game.RedPacketSender.reqCollectHongbao(this._redPacketInfo.id)},getHeight:function(){return 110},getWidth:function(){return 520}})},{}],661:[function(e,t,i){"use strict";game.appModule.RedPacketPanel=game.SkinUIPanel.extends({_list:null,_timer:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.RedPacketItem)},onShow:function(){this._list.show(),this.updatePanel(),this._timer||(this._timer=b8e.Timer.add(this,this.updatePanel,1e3)),this._timer.reset(),this._timer.start(),b8e.evt.addG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.updatePanel)},onHide:function(){b8e.evt.rmvG(this,game.RedPacketEvents.DEL_RED_PACKET_SUCCESS,this.updatePanel),this._list&&this._list.hide(),this._timer&&this._timer.stop()},updatePanel:function(){var e=game.redPacket.getRedPacketArr();e.length<=0?this.hide():this._list.setData(e)}})},{}],662:[function(e,t,i){"use strict";e("./cmd/RedPacketCmd"),e("./event/RedPacketEvents"),e("./manager/RedPacketMgr"),e("./sender/RedPacketSender"),e("./panel/RedPacketDetailPanel"),e("./panel/RedPacketItem"),e("./panel/RedPacketPanel")},{"./cmd/RedPacketCmd":656,"./event/RedPacketEvents":657,"./manager/RedPacketMgr":658,"./panel/RedPacketDetailPanel":659,"./panel/RedPacketItem":660,"./panel/RedPacketPanel":661,"./sender/RedPacketSender":663}],663:[function(e,t,i){"use strict";(game.RedPacketSender=function(){}).reqCollectHongbao=function(e){var t=game.pbmsg.CollectHongbaoRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Welfare.CollectHongbaoRequest;b8e.sendN(i)}},{}],664:[function(e,t,i){"use strict";game.RelationCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Relation.RelationDataResponse,this.onRelationDataResponse,this),b8e.addNH(game.pbmid.Relation.AddRelationResponse,this.onAddRelationResponse,this),b8e.addNH(game.pbmid.Relation.RemoveRelationResponse,this.onRemoveRelationResponse,this),b8e.addNH(game.pbmid.Relation.SearchRoleIdByNameResponse,this.onSearchRoleIdByNameResponse,this),b8e.addNH(game.pbmid.Relation.CommendFriendResponse,this.onCommendFriendResponse,this)},onSearchRoleIdByNameResponse:function(e){var t=e.readProtobuf(game.pbmsg.SearchRoleIdByNameResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(b8e.log("找到玩家了"),game.relation.selectFriend(t)))},onRemoveRelationResponse:function(e){var t=e.readProtobuf(game.pbmsg.RemoveRelationResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.relation.removeRelation(t))},onAddRelationResponse:function(e){var t=e.readProtobuf(game.pbmsg.AddRelationResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.relation.addRelation(t))},onRelationDataResponse:function(e){var t=e.readProtobuf(game.pbmsg.RelationDataResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.relation.setupInfo(t))},onCommendFriendResponse:function(e){var t=e.readProtobuf(game.pbmsg.CommendFriendResponse);t&&(t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.relation.setCommendFriendList(t.roleDatas))}})},{}],665:[function(e,t,i){"use strict";game.RelationEvent=b8e.Enum({INIT_RELATION_TYPE:b8e.Event.nextCode(),CHANGE_RELATION_TYPE:b8e.Event.nextCode(),CHATS_CHANGE:b8e.Event.nextCode(),CHAT_TARGET_CHANGE:b8e.Event.nextCode(),COMMENDFRIEND:b8e.Event.nextCode()})},{}],666:[function(e,t,i){"use strict";game.RelationChatMgr=b8e.Object.extends({_chats:null,_isInit:!1,chatTarget:null,chatTargetName:null,chatTargetHead:0,chatTargetContent:null,chatLock:!1,vipCustomerId:1e4,vipCustomerName:"浪里小白龙",vipCustomerChat:null,ctor:function(){this._super(),this._chats=b8e.HashMap.get()},initData:function(){0==this._isInit?game.RelationSender.initRleationChat():b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE)},setupData:function(e){if(e){for(var t=e.privateDatas,i=0;i<t.length;i++){var n=t[i],s=new game.RelationChatInfo;s.setup(n),s.roleId!=this.vipCustomerId?this._chats.set(s.roleId,s):this.vipCustomerChat=s}this._isInit=!0,b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE)}},removeChat:function(e){this._chats.del(e),b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE)},addChat:function(e){var t;e&&((t=e.roleId==this.vipCustomerId?this.vipCustomerChat:this._chats.get(e.roleId))||((t=new game.RelationChatInfo).roleId=e.roleId,t.roleName=e.roleName,t.head=e.head,e.roleId==this.vipCustomerId?this.vipCustomerChat=t:this._chats.set(e.roleId,t)),t.lastMsgTime=game.SysTime.curTime,this.chatTarget!=t.roleId&&t.roleId!=this.vipCustomerId&&t.offlineMsgCount++,t.addChat(e),b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE),b8e.evt.dptG(game.RelationEvent.CHAT_TARGET_CHANGE))},getChats:function(){var e=this._chats.values();return e.sort(this._sortChats),e},_sortChats:function(e,t){return e.lastMsgTime-t.lastMsgTime},setChatTarget:function(e,t,i){if(this.chatTarget=e,this.chatTargetName=t,this.chatTargetHead=i,e){e==this.vipCustomerId?game.app.show(game.AppConstant.VIP_CUSTOMER_CHAT_PANEL):game.app.show(game.AppConstant.TALK_PANEL);var n=this._chats.get(this.chatTarget);n&&(n.offlineMsgCount=0,b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE))}},setVipCustomerChat:function(){this.setChatTarget(this.vipCustomerId,this.vipCustomerName,"1002")},sendSuccess:function(){var e;this.chatLock=!1,(e=this.chatTarget==this.vipCustomerId?this.vipCustomerChat:this._chats.get(this.chatTarget))||((e=new game.RelationChatInfo).roleId=this.chatTarget,e.roleName=this.chatTargetName,e.head=this.chatTargetHead?this.chatTargetHead:"1001",this.chatTarget==this.vipCustomerId?this.vipCustomerChat=e:this._chats.set(this.chatTarget,e));var t=game.mainRole.mainRoleData,i=new game.ChatItemInfo;i.type=game.ChatType.CHAT_PRIVATE,i.content=b8e.SensitiveWords.filter(this.chatTargetContent,"*"),i.roleId=t.playerId,i.roleName=t.name,i.head=t.head,e.pushChat(i),e.lastMsgTime=game.SysTime.curTime,b8e.evt.dptG(game.ChatEvent.CHAT_SEND_SUCCESS),b8e.evt.dptG(game.RelationEvent.CHAT_TARGET_CHANGE),b8e.evt.dptG(game.RelationEvent.CHATS_CHANGE)},autoSendChat:function(e,t,i,n){this.chatTarget=e,this.chatTargetName=t,this.chatTargetHead=i,e&&n&&this.sendChat(n,!0)},sendChat:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e&&0!=e.length&&1!=this.chatLock&&(this.chatLock=!0,b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this.autoUnlockChat),this.chatTargetContent=e,game.ChatSender.sendChat(game.ChatType.CHAT_PRIVATE,e,this.chatTarget,t))},autoUnlockChat:function(){this.chatLock=!1},getChatTarget:function(){return this.chatTarget==this.vipCustomerId?this.vipCustomerChat:this._chats.get(this.chatTarget)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.RELATION_CHAT_ALERT,null,this.chatAlert,this)},chatAlert:function(){if(0==this._chats.count)return!1;for(var e=this._chats.values(),t=0;t<e.length;t++)if(0<e[t].offlineMsgCount)return!0;return!1}}),game.RelationChatMgr._instance=null,game.RelationChatMgr.inst=function(){return game.RelationChatMgr._instance||(game.RelationChatMgr._instance=new game.RelationChatMgr),game.RelationChatMgr._instance}},{}],667:[function(e,t,i){"use strict";game.RelationMgr=b8e.Object.extends({space:35e3,friend:null,black:null,curType:0,friendSendChat:null,commendFriendList:null,descId:0,recMembers:null,ctor:function(){this._super(),this.friend=new game.RelationInfo,this.black=new game.RelationInfo,this.recMembers=[]},initInfo:function(e){this.curType=e;var t=this.getRelationInfo(e);!t||t.nextRequestTime<game.SysTime.curTime?game.RelationSender.init(e):b8e.evt.dptG(game.RelationEvent.INIT_RELATION_TYPE)},initFriendInfo:function(){this.initInfo(game.RelationType.Friend)},initBlackInfo:function(){this.initInfo(game.RelationType.Black)},setupInfo:function(e){if(e){var t=this.getRelationInfo(e.type);if(t){if(!this.friendSendChat){var i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.ADD_FRIEND_RANDOM_CHAT);this.friendSendChat=i?i.split("|"):[]}t.setup(e),t.nextRequestTime=game.SysTime.curTime+this.space,b8e.evt.dptG(game.RelationEvent.INIT_RELATION_TYPE)}}},addFriend:function(e){this.friend.getInfo(e)||game.mainRole.mainRoleId!=e&&game.RelationSender.addInfo(game.RelationType.Friend,e)},removeFriend:function(e){this.friend.getInfo(e)&&(game.mainRole.mainRoleId!=e&&game.RelationSender.removeInfo(game.RelationType.Friend,e))},isFriend:function(e){return this.friend.getInfo(e)},addBlack:function(e){this.black.getInfo(e)||game.mainRole.mainRoleId!=e&&game.RelationSender.addInfo(game.RelationType.Black,e)},removeBlack:function(e){this.black.getInfo(e)&&(game.mainRole.mainRoleId!=e&&game.RelationSender.removeInfo(game.RelationType.Black,e))},isBlack:function(e){return this.black.getInfo(e)},addRelation:function(e){if(e){var t=this.getRelationInfo(e.type);if(t){switch(e.type){case game.RelationType.Black:game.notice.show("加入黑名单成功");break;case game.RelationType.Friend:if(e.roleData&&e.roleData.roleId&&this.friendSendChat&&0<this.friendSendChat.length){var i=Math.random()*this.friendSendChat.length;i>>=0;var n=this.friendSendChat[i];game.relationChat.autoSendChat(e.roleData.roleId,e.roleData.roleName,e.roleData.head,n)}game.notice.show("添加好友成功")}t.addInfo(e),b8e.evt.dptG(game.RelationEvent.CHANGE_RELATION_TYPE)}}},removeRelation:function(e){if(e){var t=this.getRelationInfo(e.type);if(t){switch(e.type){case game.RelationType.Black:game.notice.show("移除黑名单成功");break;case game.RelationType.Friend:game.notice.show("移除好友成功")}t.removeInfo(e),b8e.evt.dptG(game.RelationEvent.CHANGE_RELATION_TYPE)}}},getRelationInfo:function(e){switch(e){case game.RelationType.Friend:return this.friend;case game.RelationType.Black:return this.black}return null},selectFriend:function(e){e&&(game.app.hide(game.AppConstant.ADD_FRIEND_PANEL),this.addFriend(e.roleId))},setCommendFriendList:function(e){if(e){this.commendFriendList||(this.commendFriendList=[]),this.commendFriendList.length=0;for(var t,i=e.length,n=0;n<i;++n)(t=new game.RelationRoleData).setup(e[n]),this.commendFriendList.push(t);b8e.evt.dptG(game.RelationEvent.COMMENDFRIEND)}},getCommendFriendList:function(){return this.commendFriendList?this.commendFriendList:null},addAllFriendByOneKey:function(){if(this.commendFriendList&&0!=this.commendFriendList.length)for(var e,t=this.commendFriendList.length,i=0;i<t;++i)e=this.commendFriendList[i],this.isFriend(e.roleId)||game.RelationSender.selectFriend(e.roleName)},showFriendsRecommend:function(e,t){if(this.descId=e,t&&0!=t.length){for(var i=this.recMembers.length=0;i<t.length;++i)this.recMembers.push(t[i]);game.app.show(game.AppConstant.TEAM_FRIEND_PANEL)}}}),game.RelationMgr._instance=null,game.RelationMgr.inst=function(){return game.RelationMgr._instance||(game.RelationMgr._instance=new game.RelationMgr),game.RelationMgr._instance}},{}],668:[function(e,t,i){"use strict";game.AddFriendItem=game.SkinUI.extends({_data:null,_head:null,ctor:function(){this._super("relation/AddFriendItemSkin","AddFriendItemSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.setAnchor(.5,.5),this._head.addToParent(this._skin.head)),b8e.evt.onC(this._head,this.clickHead,this),b8e.evt.onC(this._skin.addBtn,this.onAddBtnClick,this),b8e.evt.addG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.updataRelation),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._head,this.clickHead,this),b8e.evt.offC(this._skin.addBtn,this.onAddBtnClick,this),b8e.evt.rmvG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.updataRelation)},setData:function(e){if(this._data=e,this._skin&&e){this._skin.roleName.string=e.roleName,this._skin.lvlab.string=game.rebirth.getRebirthAndLv(e.rebirthLevel,e.lv),this._skin.atklab.string=e.fightAmount;var t=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=t&&t?this._head.loadTexture(game.ClientCfg.getHeadUrl(t),null,null,{useManifest:!1}):this._head.unloadTexture(),this._skin.addBtn.active=!game.relation.isFriend(e.roleId),this._skin.unAddBtn.active=game.relation.isFriend(e.roleId)}},updataRelation:function(){this._data&&(this._skin.addBtn.active=!game.relation.isFriend(this._data.roleId),this._skin.unAddBtn.active=game.relation.isFriend(this._data.roleId))},getHeight:function(){return 86},getWidth:function(){return 540},clickHead:function(e){b8e.log("提示一下点击头像了")},onAddBtnClick:function(){this._data&&game.RelationSender.selectFriend(this._data.roleName)},clickDel:function(e){this._data&&game.relation.removeBlack(this._data.roleId)}})},{}],669:[function(e,t,i){"use strict";game.appModule.AddFriendPanel=game.SkinUIPanel.extends({list:null,nodeHight:90,defaultHight:234,defaultX:0,onShow:function(){this.list||(this.list=new b8e.List(this._skin.list,game.AddFriendItem)),b8e.evt.addG(this,game.RelationEvent.COMMENDFRIEND,this.upDataCommendFriendList),b8e.evt.onC(this._skin.send,this.clickAddFriend,this),b8e.evt.onC(this._skin.addAllBtn,this.clickAddAllFriend,this),this._skin.nameBox.string="",game.RelationSender.CommendFriendRq()},onHide:function(){b8e.evt.offC(this._skin.send,this.clickAddFriend,this),b8e.evt.rmvG(this,game.RelationEvent.COMMENDFRIEND,this.upDataCommendFriendList),b8e.evt.offC(this._skin.addAllBtn,this.clickAddAllFriend,this),this.list&&(this.list.setData(null),this.list.hide())},clickAddFriend:function(){var e=this._skin.nameBox.string;""!=e&&e&&game.RelationSender.selectFriend(e)},clickAddAllFriend:function(){game.relation.addAllFriendByOneKey()},upDataCommendFriendList:function(){var e=game.relation.getCommendFriendList();e&&0<e.length&&(this.list.setData(e),this.list.show()),this.upDataSize()},upDataSize:function(){if(this._skin){var e=0,t=game.relation.getCommendFriendList();t&&0<t.length&&(e=t.length),this._skin.commendFriendTips.active=0<e,this._skin.addAllBtn.active=0<e,this._skin.bg.node.height=this.defaultHight+e*this.nodeHight,this.height=this.defaultHight+e*this.nodeHight,this._skin.addFriendNode.y=this.defaultX+e*this.nodeHight,this.resetPosition()}}})},{}],670:[function(e,t,i){"use strict";game.BlackItem=game.SkinUI.extends({_data:null,_head:null,ctor:function(){this._super("relation/BlackItemSkin","BlackItemSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.head)),b8e.evt.onC(this._head,this.clickHead,this),b8e.evt.onC(this._skin.del,this.clickDel,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._head,this.clickHead,this),b8e.evt.offC(this._skin.del,this.clickDel,this)},setData:function(e){if(this._data=e,this._skin&&e){this._skin.roleName.string=e.roleName,this._skin.lv.string=game.rebirth.getRebirthAndLv(e.rebirthLevel,e.lv);var t=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=t&&t?this._head.loadTexture(game.ClientCfg.getHeadUrl(t),null,null,{useManifest:!1}):this._head.unloadTexture()}},getHeight:function(){return 86},getWidth:function(){return 540},clickHead:function(e){b8e.log("提示一下点击头像了")},clickDel:function(e){this._data&&game.relation.removeBlack(this._data.roleId)}})},{}],671:[function(e,t,i){"use strict";game.BlackPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("relation/BlackSkin","BlackPanelSkin")},onShow:function(){this.initPanel(),b8e.evt.addG(this,game.RelationEvent.INIT_RELATION_TYPE,this.onInitInfo),b8e.evt.addG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.onInitInfo),game.relation.initInfo(game.RelationType.Black),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.RelationEvent.INIT_RELATION_TYPE,this.onUpdateMailInfo),b8e.evt.rmvG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.onInitInfo)},onAddFriend:function(){b8e.log("点击了添加好友")},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.BlackItem))},onInitInfo:function(){var e=game.relation.black.getDatas(),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_RELATION_NUM);this._skin.blackNum.string="屏蔽数量："+e.length+"/"+t,0==e.length?this._skin.dontHaveTips.active=!0:this._skin.dontHaveTips.active=!1,this._list.setData(e)}})},{}],672:[function(e,t,i){"use strict";game.FriendItem=game.SkinUI.extends({_data:null,_head:null,ctor:function(){this._super("relation/FriendItemSkin","FriendItemSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.head)),b8e.evt.onC(this._head,this.clickHead,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._head,this.clickHead,this)},setData:function(e){if(this._data=e,this._skin&&e){this._skin.roleName.string=e.roleName,this._skin.lv.string=game.rebirth.getRebirthAndLv(e.rebirthLevel,e.lv);var t,i=game.SysTime.curTime-e.lastLogoutTime;1==e.isOnline?(t=b8e.ColorUtil.toCCColor(4285851152),this._skin.isOnline.node.color=t,this._skin.isOnline.string="在线"):(t=b8e.ColorUtil.toCCColor(4293387742),this._skin.isOnline.node.color=t,this._skin.isOnline.string=b8e.TimeUtil.getLogoutTime(i)),this._skin.fightAmount.string=e.fightAmount+"";var n=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=n&&n?this._head.loadTexture(game.ClientCfg.getHeadUrl(n),null,null,{useManifest:!1}):this._head.unloadTexture()}},getHeight:function(){return 86},getWidth:function(){return 540},clickHead:function(e){var t=new game.MenuData;t.roleId=this._data.roleId,t.roleName=this._data.roleName,t.head=this._data.head,game.menu.show(this,e,game.MenuList.FRIEND_MENU,t)}})},{}],673:[function(e,t,i){"use strict";game.FriendPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("relation/FriendSkin","FriendPanelSkin")},onShow:function(){this.initPanel(),b8e.evt.addG(this,game.RelationEvent.INIT_RELATION_TYPE,this.onInitInfo),b8e.evt.addG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.onInitInfo),b8e.evt.onC(this._skin.addFriend,this.onAddFriend,this),game.relation.initInfo(game.RelationType.Friend),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.RelationEvent.INIT_RELATION_TYPE,this.onUpdateMailInfo),b8e.evt.rmvG(this,game.RelationEvent.CHANGE_RELATION_TYPE,this.onInitInfo),b8e.evt.offC(this._skin.addFriend,this.onAddFriend,this)},onAddFriend:function(){game.app.show(game.AppConstant.ADD_FRIEND_PANEL)},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.FriendItem))},onInitInfo:function(){var e=game.relation.friend.getDatas(),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_RELATION_NUM);this._skin.friendNum.string="好友数量："+e.length+"/"+t,0==e.length?this._skin.dontHaveTips.active=!0:this._skin.dontHaveTips.active=!1,this._list.setData(e)}})},{}],674:[function(e,t,i){"use strict";game.RelationChatLogItem=game.SkinUI.extends({_data:null,_head:null,MAX_COUNT:10,ctor:function(){this._super("relation/RelationChatLogSkin","RelationChatItemSkin")},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68),this._head.addToParent(this._skin.head)),b8e.evt.onC(this._skin.touch,this.touchThis,this),b8e.evt.onC(this._skin.del,this.clickDel,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.touchThis,this),b8e.evt.offC(this._skin.del,this.clickDel,this)},touchThis:function(){this._data&&game.relationChat.setChatTarget(this._data.roleId,this._data.roleName,this._data.head)},setData:function(e){if(this._data=e,this._skin&&e){this._skin.roleName.string=e.roleName,0<e.offlineMsgCount?(this._skin.countNode.active=!0,this._skin.count.string=e.offlineMsgCount+""):this._skin.countNode.active=!1;var t=e.getLastContent();t.length>this.MAX_COUNT&&(t=t.slice(0,this.MAX_COUNT)+"..."),this._skin.content.string=t;var i=game.SysTime.curTime-e.lastMsgTime;this._skin.time.string=b8e.TimeUtil.getLogoutTime(i);var n=game.ccfg.HeadCfg.getsmallIcon(e.head);""!=n&&n?this._head.loadTexture(game.ClientCfg.getHeadUrl(n),null,null,{useManifest:!1}):this._head.unloadTexture()}},getHeight:function(){return 86},getWidth:function(){return 540},clickHead:function(e){b8e.log("提示一下点击头像了")},clickDel:function(){this._data&&game.RelationSender.removeRelationChat(this._data.roleId)}})},{}],675:[function(e,t,i){"use strict";game.RelationChatLogPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("relation/RelationChatSkin","RelationChatSkin")},onShow:function(){this.initPanel(),this._list.show(),b8e.evt.addG(this,game.RelationEvent.CHATS_CHANGE,this.onInfoChange),game.relationChat.initData()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.RelationEvent.CHATS_CHANGE,this.onInfoChange)},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.scrollview,game.RelationChatLogItem))},onInfoChange:function(){var e=game.relationChat.getChats();e&&0<e.length&&e.sort(this.onSort),this._list.setData(e),e&&0!=e.length?this._skin.lab_tip.node.active=!1:this._skin.lab_tip.node.active=!0},onSort:function(e,t){return t.lastMsgTime-e.lastMsgTime}})},{}],676:[function(e,t,i){"use strict";game.appModule.RelationPanel=game.SkinUIPanel.extends({mailPanel:null,friendPanel:null,blackPanel:null,chatPanel:null,_index:-1,_curPanel:null,ctor:function(e){this._super(e)},setTab:function(e){if(this._skin)switch(e){case 0:return this.onClickConversation(),this._skin.conversationBtn;case 1:return this.onClickFriend(),this._skin.friendBtn;case 2:return this.onClickMail(),this._skin.mailBtn;case 3:return this.onClickBlack(),this._skin.blackBtn}return!1},onShow:function(){b8e.evt.onC(this._skin.conversationBtn,this.onClickConversation,this),b8e.evt.onC(this._skin.friendBtn,this.onClickFriend,this),b8e.evt.onC(this._skin.mailBtn,this.onClickMail,this),b8e.evt.onC(this._skin.blackBtn,this.onClickBlack,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange(),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE),this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this._skin.buttonToggle[this._index].check(),this.onSelectPanelByIndex(this._index)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.conversationBtn,this.onClickConversation,this),b8e.evt.offC(this._skin.friendBtn,this.onClickFriend,this),b8e.evt.offC(this._skin.mailBtn,this.onClickMail,this),b8e.evt.offC(this._skin.blackBtn,this.onClickBlack,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onSpotAlertChange:function(){this._skin.chatAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.RELATION_CHAT_ALERT),this._skin.emailAlert.active=game.mail.mailAlert()},onClickMail:function(){2!=this._index&&this.onSelectPanelByIndex(2)},onClickConversation:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickFriend:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onClickBlack:function(){3!=this._index&&this.onSelectPanelByIndex(3)},onSelectPanelByIndex:function(e){switch(this._index=e,this._curPanel&&this._curPanel.hide(),e){case 0:this.chatPanel||(this.chatPanel=new game.RelationChatLogPanel,this.chatPanel.addToParent(this._skin.conversationNode)),this.chatPanel.show(),this._curPanel=this.chatPanel;break;case 1:this.friendPanel||(this.friendPanel=new game.FriendPanel,this.friendPanel.addToParent(this._skin.friendNode)),this.friendPanel.show(),this._curPanel=this.friendPanel;break;case 2:this.mailPanel||(this.mailPanel=new game.MailPanel,this.mailPanel.addToParent(this._skin.mailNode)),this.mailPanel.show(),this._curPanel=this.mailPanel;break;case 3:this.blackPanel||(this.blackPanel=new game.BlackPanel,this.blackPanel.addToParent(this._skin.blackNode)),this.blackPanel.show(),this._curPanel=this.blackPanel}}})},{}],677:[function(e,t,i){"use strict";game.TalkItem=game.SkinUI.extends({_data:null,_head:null,ctor:function(){this._super("relation/TalkItemSkin","TalkItemSkin")},getHeight:function(){return 86},getWidth:function(){return 540},onShow:function(){this._head||(this._head=b8e.Sprite.get(),this._head.setSize(68,68)),this.setData(this._data),b8e.evt.onC(this._head,this.clickHead,this)},onHide:function(){b8e.evt.offC(this._head,this.clickHead,this)},clickHead:function(e){var t=game.mainRole.mainRoleData;if(this._data&&t.playerId!=this._data.roleId&&this._data.roleId!=game.RelationChatMgr.inst().vipCustomerId){var i=new game.MenuData;i.roleId=this._data.roleId,i.roleName=this._data.roleName,i.head=this._data.head,game.relation.isFriend(this._data.roleId)?game.menu.show(this,e,game.MenuList.TALK_FRIEND_MENU,i):game.menu.show(this,e,game.MenuList.TALK_NORMAL_MENU,i)}},setData:function(e){var t;(this._data=e,this._skin&&e)&&(this._skin.selfNode.active=!1,this._skin.otherNode.active=!1,this._head.removeFromParent(),game.mainRole.mainRoleData.playerId==e.roleId?(this._head.addToParent(this._skin.selfHead),this._skin.selfContent.string=e.content,this._skin.selfNode.active=!0):(this._head.addToParent(this._skin.otherHead),this._skin.otherContent.string=e.content,this._skin.otherNode.active=!0),""!=(t=this._data.roleId==game.RelationChatMgr.inst().vipCustomerId?game.ccfg.HeadCfg.getsmallIcon("1002"):game.ccfg.HeadCfg.getsmallIcon(e.head))&&t?this._head.loadTexture(game.ClientCfg.getHeadUrl(t),null,null,{useManifest:!1}):this._head.unloadTexture())}})},{}],678:[function(e,t,i){"use strict";game.appModule.TalkPanel=game.SkinUIPanel.extends({_list:null,onShow:function(){this.initPanel(),this.onChatSendSuccess(),b8e.evt.addG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.addG(this,game.RelationEvent.CHAT_TARGET_CHANGE,this.onChatChange),b8e.evt.onC(this._skin.send,this.sendMsg,this),this.onChatChange(),this._list.show(!1,!1)},onHide:function(){this._list&&this._list.hide(!1),b8e.evt.rmvG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.rmvG(this,game.RelationEvent.CHAT_TARGET_CHANGE,this.onChatChange),b8e.evt.offC(this._skin.send,this.sendMsg,this),b8e.Tween.kill(this),game.relationChat.setChatTarget(0)},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.scrollView,game.TalkItem))},onChatChange:function(){var e=game.relationChat.getChatTarget();e?(this._list.setData(e.chats),e.chats&&0!=e.chats.length?this._skin.lab_tip.node.active=!1:this._skin.lab_tip.node.active=!0,this._skin.title.string=e.roleName,7<e.chats.length&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this.onScrollToBottom))):(this._skin.lab_tip.node.active=!0,this._list.setData([]),this._skin.title.string=game.relationChat.chatTargetName)},onScrollToBottom:function(){this._skin.scrollView.scrollToBottom(0),this._list._onScrolling()},sendMsg:function(){game.relationChat.sendChat(this._skin.content.string)},onChatSendSuccess:function(){this._skin&&(this._skin.content.string="")}})},{}],679:[function(e,t,i){"use strict";e("./cmd/RelationCmd"),e("./event/RelationEvent"),e("./manager/RelationMgr"),e("./manager/RelationChatMgr"),e("./panel/BlackPanel"),e("./panel/FriendPanel"),e("./panel/RelationPanel"),e("./panel/FriendItem"),e("./panel/AddFriendPanel"),e("./panel/BlackItem"),e("./panel/RelationChatLogItem"),e("./panel/RelationChatLogPanel"),e("./panel/TalkItem"),e("./panel/TalkPanel"),e("./sender/RelationSender")},{"./cmd/RelationCmd":664,"./event/RelationEvent":665,"./manager/RelationChatMgr":666,"./manager/RelationMgr":667,"./panel/AddFriendPanel":669,"./panel/BlackItem":670,"./panel/BlackPanel":671,"./panel/FriendItem":672,"./panel/FriendPanel":673,"./panel/RelationChatLogItem":674,"./panel/RelationChatLogPanel":675,"./panel/RelationPanel":676,"./panel/TalkItem":677,"./panel/TalkPanel":678,"./sender/RelationSender":680}],680:[function(e,t,i){"use strict";game.RelationSender={},game.RelationSender.init=function(e){var t=game.pbmsg.RelationDataRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Relation.RelationDataRequest;b8e.sendN(i),engine.Logger.log("请求关系数据类型",e)},game.RelationSender.addInfo=function(e,t){var i=game.pbmsg.AddRelationRequest;i.type=e,i.roleId=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Relation.AddRelationRequest;b8e.sendN(n)},game.RelationSender.removeInfo=function(e,t){var i=game.pbmsg.RemoveRelationRequest;i.type=e,i.roleId=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Relation.RemoveRelationRequest;b8e.sendN(n)},game.RelationSender.initRleationChat=function(){var e=game.pbmid.Chat.PrivateChatHistoryRequest;b8e.sendN(e)},game.RelationSender.removeRelationChat=function(e){var t=game.pbmsg.RemovePrivateChatRequest;t.roleId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Chat.RemovePrivateChatRequest;b8e.sendN(i)},game.RelationSender.selectFriend=function(e){var t=game.pbmsg.SearchRoleIdByNameRequest;t.roleName=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Relation.SearchRoleIdByNameRequest;b8e.sendN(i)},game.RelationSender.CommendFriendRq=function(){var e=game.pbmid.Relation.CommendFriendRequest;b8e.sendN(e)}},{}],681:[function(e,t,i){"use strict";game.ReliveCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Scene.DefeatNotify,this.onDefeatNotify,this),b8e.addNH(game.pbmid.Scene.ReliveResponse,this.onReliveResponse,this),b8e.addNH(game.pbmid.Scene.ReliveNotify,this.onReliveNotify,this)},onReliveNotify:function(e){var t=e.readProtobuf(game.pbmsg.ReliveNotify);t&&game.ReliveMgr.inst().playerRelive(t)},onDefeatNotify:function(e){var t=e.readProtobuf(game.pbmsg.DefeatNotify);t&&game.ReliveMgr.inst().playerDie(t)},onReliveResponse:function(e){var t=e.readProtobuf(game.pbmsg.ReliveResponse);t&&game.ReliveMgr.inst().reliveResponse(t)}})},{}],682:[function(e,t,i){"use strict";e("./ReliveCmd")},{"./ReliveCmd":681}],683:[function(e,t,i){"use strict";game.ReliveMgr=b8e.Object.extends({reliveInfo:null,costReliveCount:0,_timer:null,getReliveViewType:function(){return this.reliveInfo&&this.reliveInfo.getReliveViewType(),game.ReliveViewType.ReliveType_Fail},getReliveCost:function(){return this.reliveInfo&&this.reliveInfo.cost,0},setup:function(e){},playerDie:function(e){if(this.reliveInfo||(this.reliveInfo=new game.ReliveInfo),this.reliveInfo.setup(e),this.reliveInfo.getReliveViewType()!=game.ReliveViewType.ReliveType_Fail){var t=this.reliveInfo.autoReliveTime-game.SysTime.curTime;this._timer||(this._timer=b8e.Timer.add(this,this.freeRelive,t,1)),this._timer.reset(),this._timer.start(),game.app.showAppNoHide(game.AppConstant.RELIVE_PANEL),e.killer||b8e.warn("玩家挂了，接收服务器发过来的数据，data.killer为null"),e.killer&&e.killer.type==game.RoleType.Hero&&this.addPlayerDieChat(e.killer.name)}},addPlayerDieChat:function(e){if(e){var t=game.ccfg.LangCfg.getText(10401,[e]);game.chat.addSystemChat(t)}},playerRelive:function(e){if(e){var t=game.sceneRole.getDisplayById(e.id);if(t){t.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),t.data&&1==t.data.isSelf&&t.showBar(),t.data&&t.data.type==game.RoleType.Hero&&t.showBar();var i=t.getAnimator(game.AnimatorType.RELIVE_EFFECT,1);i||(i=t.addAnimator(game.AnimatorType.RELIVE_EFFECT,1,100));var n=game.ClientCfg.getSceneFx("relive");i.load(n),i.play(),i.autoRelease()}}},reliveResponse:function(e){e&&0==e.code?(b8e.log("自己复活了，我要关面板了"),game.app.hide(game.AppConstant.RELIVE_PANEL),this._timer&&this._timer.stop()):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(e.code))},freeRelive:function(){game.SysTime.curTime<this.reliveInfo.waitTime||(this._timer&&this._timer.stop(),game.ReliveSender.inst().relive(!0),game.quest.changeAuto(!1))},costRelive:function(){var e=game.back.getAmountValue(game.AmountType.YUAN_BAO);this.reliveInfo.cost>e?game.gameAlert.showVipAlert(!0,101):game.ReliveSender.inst().relive(!1)}}),game.ReliveMgr._instance=null,game.ReliveMgr.inst=function(){return null==game.ReliveMgr._instance&&(game.ReliveMgr._instance=new game.ReliveMgr),game.ReliveMgr._instance}},{}],684:[function(e,t,i){"use strict";e("./ReliveMgr")},{"./ReliveMgr":683}],685:[function(e,t,i){"use strict";game.appModule.RelivePanel=game.SkinUIPanel.extends({_skin:null,_autoReliveTime:0,_timer:null,ctor:function(e){this._super(e),this._skin=this._skin},onShow:function(){var e=game.ReliveMgr.inst().getReliveViewType();this.showReliveView(e),this.registerOrUnregisterEvent(!0)},onHide:function(){this._skin.lab_no_btn_relive_time.string="",this._skin.lab_no_btn_reset_relive.active=!1,this.registerOrUnregisterEvent(!1),this._timer&&this._timer.stop()},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.relivePointBtn,this.onClickSafeReliveBtn,this),b8e.evt.onC(this._skin.originReliveBtn,this.onClickOriginReliveBtn,this),b8e.evt.onC(this._skin.powerBtn,this.onClickStrengthenBtn,this),b8e.evt.onC(this._skin.lab_no_btn_reset_relive,this.onFreeRelive,this)):(b8e.evt.offC(this._skin.relivePointBtn,this.onClickSafeReliveBtn,this),b8e.evt.offC(this._skin.originReliveBtn,this.onClickOriginReliveBtn,this),b8e.evt.offC(this._skin.powerBtn,this.onClickStrengthenBtn,this),b8e.evt.offC(this._skin.lab_no_btn_reset_relive,this.onFreeRelive,this))},showReliveView:function(e){switch(this._skin.lab_no_btn_reset_relive.active=!1,e){case game.ReliveViewType.ReliveType_1:this._skin.safe_relive.active=!0,this._skin.origin_relive.active=!0,this._skin.safe_relive.x=this._skin.width/4,this._skin.origin_relive.x=this._skin.width/2+this._skin.width/4;break;case game.ReliveViewType.ReliveType_2:this._skin.safe_relive.active=!0,this._skin.origin_relive.active=!1,this._skin.safe_relive.x=this._skin.width/2;break;case game.ReliveViewType.ReliveType_3:this._skin.safe_relive.active=!0,this._skin.origin_relive.active=!1,this._skin.origin_relive.x=this._skin.width/2}this._skin.lab_no_btn_relive.node.active=!1,this._skin.relivePointBtn.active=!0,this._skin.lab_safe_relive_time.node.active=!0;var t=game.SceneMgr.inst().getSceneConfig();t&&t.isHideFreeRelive&&(this._skin.relivePointBtn.active=!1,this._skin.lab_safe_relive_time.node.active=!1,this._skin.lab_no_btn_relive.node.active=!0,this._skin.lab_no_btn_relive.string="          秒后\n在本场景复活",t.isRandomRelive&&(this._skin.lab_no_btn_relive.string="          秒后\n在随机位置复活")),t.type==game.SceneType.TEAM_BOSS&&(this._skin.relivePointBtn.active=!1,this._skin.lab_safe_relive_time.node.active=!1,this._skin.lab_no_btn_relive.node.active=!0,this._skin.lab_no_btn_relive.string="          秒后\n在安全点复活"),this.setReliveView()},setReliveView:function(){var e=game.ReliveMgr.inst().reliveInfo;this._skin.img_origin_relive_cost_count.string=e.cost+"",this._skin.lab_killer_name.string=e.killer?e.killer.name:"???",0!=e.autoReliveTime&&(this._autoReliveTime=e.autoReliveTime,this.getFreeReliveTime())},onClickStrengthenBtn:function(){game.app.show(game.AppConstant.STRENGTHEN_PANEL)},onClickSafeReliveBtn:function(){var e=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer),t=game.SceneMgr.inst().getSceneConfig();t&&t.type==game.SceneType.TIANGONG?e&&e.isOpen&&game.notice.show("天宫争霸活动期间不能原地复活"):t&&t.type!=game.SceneType.TEAM_BOSS&&game.ReliveMgr.inst().freeRelive()},onClickOriginReliveBtn:function(){var e=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer),t=game.SceneMgr.inst().getSceneConfig();t&&t.type==game.SceneType.TIANGONG?e&&e.isOpen&&(game.tianGong.isCrossServer?game.ReliveMgr.inst().costRelive():game.notice.show("天宫争霸活动期间不能原地复活")):game.ReliveMgr.inst().costRelive()},getFreeReliveTime:function(){this._skin.lab_safe_relive_time.string="",this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.setFreeReliveTime,500)},setFreeReliveTime:function(){var e=this._autoReliveTime-game.SysTime.curTime;if(e<0)return this._timer&&this._timer.stop(),void b8e.Tween.get(this).wait(1500).call(this.delayVisible,this);var t=String(~~(e/1e3));this._skin.lab_safe_relive_time.string=t,this._skin.lab_no_btn_relive_time.string=t},delayVisible:function(){b8e.Tween.kill(this),this._skin.lab_no_btn_reset_relive.active=!0},onFreeRelive:function(){game.ReliveSender.inst().relive(!0),game.quest.changeAuto(!1)}})},{}],686:[function(e,t,i){"use strict";e("./RelivePanel")},{"./RelivePanel":685}],687:[function(e,t,i){"use strict";e("./cmd/cmdIndex_1"),e("./manager/managerIndex_9"),e("./panel/panelIndex_16"),e("./sender/senderIndex_5")},{"./cmd/cmdIndex_1":682,"./manager/managerIndex_9":684,"./panel/panelIndex_16":686,"./sender/senderIndex_5":689}],688:[function(e,t,i){"use strict";game.ReliveSender=game.BaseSender.extends({relive:function(e){var t=game.pbmsg.ReliveRequest;t.safe=e,this.bytes.writeProtobuf(t);var i=game.pbmid.Scene.ReliveRequest;this.send(i)}}),game.ReliveSender._instance=null,game.ReliveSender.inst=function(){return game.ReliveSender._instance||(game.ReliveSender._instance=new game.ReliveSender),game.ReliveSender._instance}},{}],689:[function(e,t,i){"use strict";e("./ReliveSender")},{"./ReliveSender":688}],690:[function(e,t,i){"use strict";game.ResetDailyCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Login.DailyResetNotify,this.onDailyResetNotify,this),b8e.addNH(game.pbmid.Login.WeeklyResetNotify,this.onWeekResetNotify,this)},onWeekResetNotify:function(e){game.welfare.weekSignReset()},onDailyResetNotify:function(e){game.ResetDailyMgr.resetDaily()}})},{}],691:[function(e,t,i){"use strict";game.ResetDailyMgr={},game.ResetDailyMgr.resetDaily=function(){game.mainRole.mainRoleData.miscData.loginDay++,game.chat.resetDaily(),game.pay.rechargeResetDaily(),game.welfare.welfareResetDaily(),game.ShareMgr.inst().resetDaily(),game.beauty.resetDaily(),game.worldBoss.resetDaily(),game.IS_SHIELD_IOS_RECHARGE||game.activeBar.initBar(!0),game.cornucopia.resetDaily(),game.pay.festivalResetDaily(),game.shop.mysteryResetDaily(),game.nationalBoss.resetDaily(),game.zhanyao.resetDaily(),game.rebirth.resetDaily(),game.guild.resetDaily(),game.roulette.resetDaily(),game.guild.init(),game.tianGong.isResetDaily=!0,game.tianGong.firstEnterScene(),game.team.resetData(),game.shop.refreshCount=0,game.welfare.weekSignResetDaily(),game.RetrieveMgr.inst().resetDaily(),game.shop.goodsResetDaily()}},{}],692:[function(e,t,i){"use strict";e("./ResetDailyCmd"),e("./ResetDailyMgr")},{"./ResetDailyCmd":690,"./ResetDailyMgr":691}],693:[function(e,t,i){"use strict";game.RevolvingLanternEvents=b8e.Enum({HAS_NEW_SYSTEM_NOTICE:b8e.Event.nextCode()})},{}],694:[function(e,t,i){"use strict";cc.Class({extends:cc.Component,properties:{},onLoad:function(){}})},{}],695:[function(e,t,i){"use strict";game.RevolvingLanternPanel=game.SkinUI.extends({arr:null,ctor:function(){this._super("revolvingLantern/RevolvingLanternSkin","RevolvingLanternSkin"),this.arr=[]},onShow:function(){this.refreshLayout()},onHide:function(){},setData:function(e){},finish:function(){this.visible=!1},refreshLayout:function(){this._skin.node.x=91,this._skin.node.y=b8e.stageHeight-263}})},{}],696:[function(e,t,i){arguments[4][694][0].apply(i,arguments)},{dup:694}],697:[function(e,t,i){"use strict";e("./panel/panelIndex_30"),e("./event/eventIndex_13")},{"./event/eventIndex_13":694,"./panel/panelIndex_30":696}],698:[function(e,t,i){"use strict";game.RoleLoginCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Login.FangChenMiNotify,this.onFangChenMiNotify,this),b8e.addNH(game.pbmid.Login.OfflineAwardNotify,this.onOfflineAwardNotify,this),b8e.addNH(game.pbmid.Login.QryServerTimeResponse,this.onQryServerTimeResponse,this),b8e.addNH(game.pbmid.Login.RoleAttrUpdateNotify,this.onRoleAttrUpdateNotify,this),b8e.addNH(game.pbmid.Login.RenameResponse,this.onRenameRp,this)},onRoleAttrUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.RoleAttrUpdateNotify);if(t){var i,n,s=game.mainRole.mainRoleData;i=s.getZhanLi();for(var a=0;a<t.stat.stats.length;a++){var o=t.stat.stats[a];if(!(o.value<=0)){var r=s.baseSpriteStat.getStatValue(o.type),h=o.value-r;h<=0||game.bounceCharacters.showAttrBounceCharacters(h,o.type+2)}}s.baseSpriteStat.setup(t.stat),n=s.getZhanLi(),b8e.evt.dptG(game.AttributesEvents.BASE_ATTR_UPDATE),i<n&&(game.ActiveMgr.inst().getSubTypeInfo(game.ActiveSubType.ST_TARGET_FIGHGT_AMOUNT)&&b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),game.FightAmountSprite.inst().play(i,n)),game.sdk.updateFightScoreLog()}},onQryServerTimeResponse:function(e,t){var i=e.readProtobuf(game.pbmsg.QryServerTimeResponse);i&&(b8e.startup.setServerTime(i.ts,t),b8e.evt.dptG(game.SceneEvent.PING_CHANGE))},onFangChenMiNotify:function(e){var t=e.readProtobuf(game.pbmsg.FangChenMiNotify);if(t){var i="fangChenMiLv_"+t.fangChenMiType,n=game.ccfg.GlobalCfg.getValue(i);game.chat.addSystemChat(n)}},onOfflineAwardNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.OfflineAwardNotify);i&&game.offlineAward.setData(i)},onRenameRp:function(e){var t=e.readProtobuf(game.pbmsg.RenameResponse);if(t){var i=t.code;if(0<i)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i));else{var n=game.mainRole.mainRoleData;""!=game.setting.nameStr&&(n.name=game.setting.nameStr,game.setting.nameStr="",game.notice.show(31004),b8e.evt.dptG(game.ClientSettingEvt.CHANGE_NAME_SUCCESS))}}}})},{}],699:[function(e,t,i){"use strict";e("./cmdlistener/RoleLoginCmd")},{"./cmdlistener/RoleLoginCmd":698}],700:[function(e,t,i){"use strict";game.RoleAttributeItem=game.SkinUI.extends({_isNeedTitle:!1,_isRate:!1,_isOpen:!1,_type:-1,_leftAttrName:0,_leftAttrValue:0,_rightAttrName:0,_rightAttrValue:0,ctor:function(e,t,i,n,s,a,o,r){this._super("role/RoleAttributeItemSkin","RoleAttributeItemSkin"),this._isNeedTitle=e,this._isRate=t,this._isOpen=i,this._type=n,this._leftAttrName=s,this._leftAttrValue=a,this._rightAttrName=o,this._rightAttrValue=r},onShow:function(){this.setData(this._isNeedTitle,this._isRate,this._isOpen,this._type,this._leftAttrName,this._leftAttrValue,this._rightAttrName,this._rightAttrValue)},onHide:function(){},setData:function(e,t,i,n,s,a,o,r){switch(this._skin.lab_open.node.active=!i,n){case 0:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="基础属性";break;case 1:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="高级属性";break;case 2:this._skin.titleNode.active=!0,this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1,this._skin.lab_title.string="超级属性";break;default:this._skin.titleNode.active=!1,i?t?(this._skin.lab_baseNode.active=!0,this._skin.lab_node.active=!1,this._skin.lab_baseAttrName.string=s,this._skin.lab_baseAttrValue.string=a,this._skin.lab_baseAttrValueRate.string=o+r):(this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!0,this._skin.lab_leftAttrName.string=s,this._skin.lab_leftAttrValue.string=a,this._skin.lab_rightAttrName.string=o,this._skin.lab_rightAttrValue.string=r):(this._skin.lab_baseNode.active=!1,this._skin.lab_node.active=!1)}}})},{}],701:[function(e,t,i){"use strict";game.appModule.RoleAttributePanel=game.SkinUIPanel.extends({_baseSpriteArr:null,_highSpriteArr:null,_superSpriteArr:null,_itemVec:null,ctor:function(e){this._super(e),this._baseSpriteArr=[],this._highSpriteArr=[],this._superSpriteArr=[],this._itemVec=[]},onShow:function(){this.updateAttr(),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAttr)},onHide:function(){this.clearData(),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateAttr)},updateAttr:function(){this.clearData();var e=game.mainRole.mainRoleData;if(e){var t=e.baseSpriteStat;if(t){var i=t.getSpriteStats();if(i&&!(i.length<=0)){this._baseSpriteArr.length=0,this._highSpriteArr.length=0;for(var n=this._superSpriteArr.length=0;n<i.length;n++){var s=i[n];if(s){var a=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(s.type);if(a)switch(a.attrType){case game.AttrRulesType.AttrRulesType_1:this._baseSpriteArr.push(s);break;case game.AttrRulesType.AttrRulesType_2:this._highSpriteArr.push(s);break;case game.AttrRulesType.AttrRulesType_3:this._superSpriteArr.push(s)}}}var o;this._baseSpriteArr&&0<this._baseSpriteArr.length&&((o=new game.RoleAttributeItem(!0,!1,!0,0)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._baseSpriteArr.sort(this.onSortAttr),this.updateBaseSpriteSatat(this._baseSpriteArr)),this._highSpriteArr&&0<this._highSpriteArr.length&&((o=new game.RoleAttributeItem(!0,!1,!0,1)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._highSpriteArr.sort(this.onSortAttr),this.updateHighSpriteSatat(this._highSpriteArr)),this._superSpriteArr&&0<this._superSpriteArr.length?((o=new game.RoleAttributeItem(!0,!1,!0,2)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this._superSpriteArr.sort(this.onSortAttr),this.updateSuperSpriteSatat(this._superSpriteArr)):((o=new game.RoleAttributeItem(!0,!1,!0,2)).setAnchor(.5,.5),o.setSize(470,40),o.addToParent(this._skin.list.content),o.show(),this._itemVec.push(o),this.updateSuperSpriteSatat(null))}}}},updateBaseSpriteSatat:function(e){for(var t,i,n="",s="",a=0,o="",r=0,h=0;h<e.length;h++){var g=e[h];if(g){n=game.ccfg.AttrRulesCfg.getAttrNameByType(g.type);var l=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(g.type);if(l)switch(l.format){case game.AttrRulesFormat.FORMAT_1:t=g.value;break;case game.AttrRulesFormat.FORMAT_2:t=game.ValueUtil.getDigitsValueByNum(g.value/100,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:t=game.ValueUtil.getDigitsValueByNum(g.value/100,2)}g.type,h%2!=0?(o=n,r=t,(i=new game.RoleAttributeItem(!1,!1,!0,-1,s,a,o,r)).setAnchor(.5,.5),i.setSize(470,40),i.addToParent(this._skin.list.content),i.show(),this._itemVec.push(i)):(s=n,a=t)}}},updateHighSpriteSatat:function(e){for(var t,i="",n="",s=0,a="",o=0,r=0;r<e.length;r++){var h=e[r];if(h){i=game.ccfg.AttrRulesCfg.getAttrNameByType(h.type);var g=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(h.type);if(g)switch(g.format){case game.AttrRulesFormat.FORMAT_1:t=h.value;break;case game.AttrRulesFormat.FORMAT_2:t=game.ValueUtil.getDigitsValueByNum(h.value/100,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:t=game.ValueUtil.getDigitsValueByNum(h.value/100,2)}if(r%2!=0){a=i,o=t;var l=new game.RoleAttributeItem(!1,!1,!0,-1,n,s,a,o);l.setAnchor(.5,.5),l.setSize(470,40),l.addToParent(this._skin.list.content),l.show(),this._itemVec.push(l)}else n=i,s=t}}},updateSuperSpriteSatat:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];var e=new game.RoleAttributeItem(!0,!1,!1,-1);e.setAnchor(.5,.5),e.setSize(470,40),e.addToParent(this._skin.list.content),e.show(),this._itemVec.push(e)},onSortAttr:function(e,t){var i=game.ccfg.AttrRulesCfg.getAttrSortByType(e.type),n=game.ccfg.AttrRulesCfg.getAttrSortByType(t.type);return n<i?1:i<n?-1:0},clearData:function(){if(this._itemVec&&0<this._itemVec.length)for(var e=0;e<this._itemVec.length;e++){this._itemVec[e].hide()}this._itemVec.length=0,this._skin.list.content.removeAllChildren()}})},{}],702:[function(e,t,i){"use strict";game.appModule.RolePanel=game.SkinUIPanel.extends({_equipItemArr:null,_role:null,_roleData:null,_starBarArr:null,ctor:function(e){this._super(e),this._equipItemArr=[],this._starBarArr=[]},getButtonByName:function(e){switch(e){case"surface":return!0;case"xiandan":return!this._skin||this._skin.xiandanBtn;case"mount":return!this._skin||this._skin.mountBtn;case"realm":return!this._skin||this._skin.realmBtn;case"beauty":return!this._skin||this._skin.beautyBtn;case"reincarnation":return!this._skin||this._skin.rebirthBtn;case"talisman":return!this._skin||this._skin.talismanBtn;case"wing":return!this._skin||this._skin.wingBtn;case"amulet":return!this._skin||this._skin.amuletBtn;case"equip0":return this._equipItemArr[0];case"equip1":return this._equipItemArr[1];case"equip2":return this._equipItemArr[2];case"equip3":return this._equipItemArr[3];case"equip4":return this._equipItemArr[4];case"equip5":return this._equipItemArr[5];case"equip6":return this._equipItemArr[6];case"equip7":return this._equipItemArr[7];case"back":return this._skin.closeBtnReturn;case"highequipBtn":return this._skin.highequipBtn;case"xianzhenBtn":return this._skin.xianzhenBtn}return null},onShow:function(){this._skin.surface.node.active=!game.IS_SHIELD_IOS_RECHARGE,this.registerOrUnregisterEvent(!0),this.updateRoleEquipInfo(),this.showModel(),this.updateFightAmount(),this.onSpotAlertChange(),this.updateEquipStarInfo(),this.onHighEquipAlert(),game.ornament.showAlert=game.ornament.checkShowAlert(),this.onOrnamentRefreshAlert(),b8e.evt.addG(this,game.EquipEvt.PUT_ON_EQUIP,this.onPutOnEquip),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onHide:function(){this.clearEquipItem(),this.registerOrUnregisterEvent(!1);var e=this._role.getAnimator(game.AnimatorType.BODY,1);e&&e.stop();var t=this._role.getAnimator(game.AnimatorType.WING,1);t&&t.stop(),b8e.evt.rmvG(this,game.EquipEvt.PUT_ON_EQUIP,this.onPutOnEquip),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},init:function(){this._role||(this._role=b8e.SceneEntity.get(),this._role.addToParent(this._skin.characterModelRoot)),this._roleData||(this._roleData=game.HeroData.get(),this._roleData.type=game.RoleType.UIRole)},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.surface.node,this.onOpenSurfacePanel,this),b8e.evt.onC(this._skin.xiandanBtn.node,this.onOpenXiandanPanel,this),b8e.evt.onC(this._skin.mountBtn.node,this.onClickMountBtn,this),b8e.evt.onC(this._skin.realmBtn.node,this.onOpenDujiePanel,this),b8e.evt.onC(this._skin.beautyBtn.node,this.onOpenBeautyPanel,this),b8e.evt.onC(this._skin.talismanBtn.node,this.onClicktalismanBtnBtn,this),b8e.evt.onC(this._skin.wingBtn.node,this.onClickWingBtn,this),b8e.evt.onC(this._skin.amuletBtn.node,this.onClickAmuletBtn,this),b8e.evt.onC(this._skin.qualityBtn,this.onOpenEquipQualitySuitsTips,this),b8e.evt.onC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.onC(this._skin.previewBtn,this.onOpenRoleAttributePanel,this),b8e.evt.onC(this._skin.rebirthBtn.node,this.onClickRebirthBtn,this),b8e.evt.onC(this._skin.highequipBtn,this.onOpenHighEquipPanel,this),b8e.evt.onC(this._skin.xianzhenBtn.node,this.onClickXianZhenBtn,this),b8e.evt.addG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_APPEARANCE_UPDATE,this.showModel),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.EquipEvt.HIGHEQUIP_SPORTALERT,this.onHighEquipAlert),b8e.evt.addG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert)):(b8e.evt.offC(this._skin.surface.node,this.onOpenSurfacePanel,this),b8e.evt.offC(this._skin.xiandanBtn.node,this.onOpenXiandanPanel,this),b8e.evt.offC(this._skin.mountBtn.node,this.onClickMountBtn,this),b8e.evt.offC(this._skin.realmBtn.node,this.onOpenDujiePanel,this),b8e.evt.offC(this._skin.beautyBtn.node,this.onOpenBeautyPanel,this),b8e.evt.offC(this._skin.talismanBtn.node,this.onClicktalismanBtnBtn,this),b8e.evt.offC(this._skin.wingBtn.node,this.onClickWingBtn,this),b8e.evt.offC(this._skin.amuletBtn.node,this.onClickAmuletBtn,this),b8e.evt.offC(this._skin.qualityBtn,this.onOpenEquipQualitySuitsTips,this),b8e.evt.offC(this._skin.starNode,this.onOpenEquipStarSuitsTips,this),b8e.evt.offC(this._skin.previewBtn,this.onOpenRoleAttributePanel,this),b8e.evt.offC(this._skin.rebirthBtn.node,this.onClickRebirthBtn,this),b8e.evt.offC(this._skin.highequipBtn,this.onOpenHighEquipPanel,this),b8e.evt.offC(this._skin.xianzhenBtn.node,this.onClickXianZhenBtn,this),b8e.evt.rmvG(this,game.AttributesEvents.BASE_ATTR_UPDATE,this.updateFightAmount),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_APPEARANCE_UPDATE,this.showModel),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.EquipEvt.HIGHEQUIP_SPORTALERT,this.onHighEquipAlert),b8e.evt.rmvG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert))},onSpotAlertChange:function(){this._skin.surfaceAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.SURFACE_ALERT)||game.ornament.checkShowAlert(),this._skin.xiandanAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.XIANDAN_ALERT),this._skin.mountAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.MOUNT_ALERT)||game.mountequip.isShowMountEquipAlert,this._skin.beautyAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.BEAUTY_ALERT),this._skin.fabaoAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.FABAO_ALERT),this._skin.xianzhenAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.XIANZHEN_ALERT),this._skin.wingAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.WING_ALERT),this._skin.rebirthAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.REBIRTH_ALERT),this._skin.amuletAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.AMULET_ALERT),this._skin.equipAlert_0.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_0),this._skin.equipAlert_1.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_1),this._skin.equipAlert_2.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_2),this._skin.equipAlert_3.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_3),this._skin.equipAlert_4.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_4),this._skin.equipAlert_5.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_5),this._skin.equipAlert_6.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_6),this._skin.equipAlert_7.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROLE_EQUIP_ALERT_7)},onOrnamentRefreshAlert:function(){this._skin.surfaceAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.SURFACE_ALERT)||game.ornament.showAlert},onHighEquipAlert:function(){this._skin.highequipAlert.active=game.equip.isHighEquipSpotAlert()},showModel:function(){var e=game.mainRole.mainRoleData;this._roleData.defaultModelId=e.defaultModelId,this._roleData.avatarInfo.bodyResId=e.defaultModelId,this._roleData.avatarInfo.bodyRes=e.avatarInfo.bodyRes,this._roleData.avatarInfo.surfaceBodyRes=e.avatarInfo.surfaceBodyRes,this._roleData.avatarInfo.wingResId=e.avatarInfo.wingResId,this._role.data=this._roleData,game.AvatarUtil.updateBodyAvatar(this._role),game.AvatarUtil.updateWingAvatar(this._role)},updateRoleEquipInfo:function(){var e=this._equipItemArr.length,t=game.equip.getEquipSlotMap();if(t){var i,n,s,a=t.values();if(!a||a.length<=0)return;for(var o=0;o<a.length;o++)(i=a[o])&&(s=this._skin["equipGrids_"+o],o<e?n=this._equipItemArr[o]:(n=game.GridUtil.creatItemGrid(this,s,game.IcoSizeEnum.SIZE_90,game.ContainerId.ROLE_EQUIP_CONTAINER_ID,this.onClick),this._equipItemArr.push(n)),game.GridUtil.setEquipSlotGrid(n,i,!0,!1,!1,i.slotStar),0<i.slotStar&&n.setStarBarPos(0,-15),n.setEqEnchantIcon(i.isenchant),n.sortLayer())}},onClick:function(e){e&&e.faceInfo&&(e.faceInfo.equip?game.app.show(game.AppConstant.ROLE_EQUIP_TIPS,e.faceInfo):game.app.show(game.AppConstant.EQUIP_SELECT_PANEL,e.faceInfo.slotType))},onPutOnEquip:function(e){if(e&&e.data){var t=e.data.equipSlotInfo;if(t){for(var i,n=this._equipItemArr.length,s=0;s<n;s++)(i=this._equipItemArr[s]).faceInfo&&i.faceInfo.slotType==t.slotType&&(game.GridUtil.setEquipSlotGrid(i,t,!0,!1,!1,t.slotStar),i.setEqEnchantIcon(t.isenchant),i.sortLayer());this.updateEquipStarInfo()}}},clearEquipItem:function(){if(this._equipItemArr&&0<this._equipItemArr.length)for(var e,t=this._equipItemArr.length,i=0;i<t;i++)(e=this._equipItemArr[i])&&game.GridUtil.setEquipSlotGrid(e,null)},updateFightAmount:function(){var e=game.mainRole.mainRoleData.getZhanLi();e&&(this._skin.lab_power.string=e)},updateEquipStarInfo:function(){var e=game.equip.getEquipStarSuits();this._skin.xingxingGray.active=!1,this._skin.xingxing.active=!1,this._skin.yueliang.active=!1,this._skin.taiyang.active=!1,this._skin.huangguan.active=!1,this._skin.labStar.node.active=!1;var t=game.ccfg.StarCfg.getStarInfo(e,game.StarType.EQUIP_UP_STAR);if(!t)return this._skin.xingxingGray.active=!0,void(this._skin.labStar.string=e);switch(t.iconType){case game.StarIconType.XINGXING:this._skin.xingxing.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.YUELIANG:this._skin.yueliang.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.TAIYANG:this._skin.taiyang.active=!0,this._skin.labStar.node.active=!0;break;case game.StarIconType.HUANGGUANG:this._skin.huangguan.active=!0,this._skin.labStar.node.active=!0;break;default:this._skin.xingxingGray.active=!0}this._skin.labStar.string=e},onClickRebirthBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.REBIRTH)&&game.app.show(game.AppConstant.REBIRTH_PANEL)},onClickAchievementBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.CHENG_JIU)},onClickWingBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.WING)&&game.AccessoryMgr.showPanel(game.AccessoryType.Wing)},onClickXianZhenBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.XIANZHEN)&&game.AccessoryMgr.showPanel(game.AccessoryType.XianZhen)},onClickMountBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.MOUNT)&&game.AccessoryMgr.showPanel(game.AccessoryType.Mount)},onClicktalismanBtnBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.FA_BAO)&&game.AccessoryMgr.showPanel(game.AccessoryType.FaBao)},onClickSoulBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.YUAN_SHEN)},onOpenEquipQualitySuitsTips:function(){game.app.show(game.AppConstant.EQUIP_SUITS_TIPS,game.equip.QUALITY_SUITS)},onOpenEquipStarSuitsTips:function(){game.app.show(game.AppConstant.EQUIP_SUITS_TIPS,game.equip.STAR_SUITS)},onOpenRoleAttributePanel:function(){game.app.show(game.AppConstant.ROLE_ATTRIBUTE_PANEL)},onOpenBeautyPanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.BEAUTY)&&game.app.show(game.AppConstant.BEAUTY_PANEL)},onOpenDujiePanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.JING_JIE)&&game.app.show(game.AppConstant.DUJIE_PANEL)},onClickAmuletBtn:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.AMULET)&&game.app.show(game.AppConstant.AMULET_PANEL)},onOpenSurfacePanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.SURFACE)&&game.app.show(game.AppConstant.SURFACE_PANEL)},onOpenXiandanPanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.XIAN_DAN)&&game.app.show(game.AppConstant.XIANDAN_PANEL)},onOpenHighEquipPanel:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.HIGHEQUIP)&&game.app.show(game.AppConstant.HIGHEQUIP_PANEL)}})},{}],703:[function(e,t,i){"use strict";e("./RolePanel"),e("./RoleAttributeItem"),e("./RoleAttributePanel")},{"./RoleAttributeItem":700,"./RoleAttributePanel":701,"./RolePanel":702}],704:[function(e,t,i){"use strict";e("./panel/panelIndex_17")},{"./panel/panelIndex_17":703}],705:[function(e,t,i){"use strict";game.RouletteEvents=b8e.Enum({ZHUANPAN_SUCCESS:b8e.Event.nextCode(),DUOBAO_SUCCESS:b8e.Event.nextCode(),RESET_ROULETTE:b8e.Event.nextCode(),COLLECT_COUNT_AWARD_SUCCESS:b8e.Event.nextCode(),GET_BAOZHU_AWARD_SUCCESS:b8e.Event.nextCode()})},{}],706:[function(e,t,i){"use strict";game.RouletteMgr=b8e.Object.extends({idList:null,zpStopIndex:0,dbStopIndex:0,isZhuanPan:!1,dropId:0,baozhuItemInfo:null,isShowEffect:!1,isActiveSever:!1,awards:null,duoBaoAwards:null,positionArr:null,boxIndexArr:null,curArr:null,zhuanPanMap:null,duoBaoMap:null,positionsMap:null,raffleCount:0,costItemId:0,upCostMax:0,ctor:function(){this._super(),this.awards=[],this.duoBaoAwards=[],this.positionArr=[],this.boxIndexArr=[1,2,3],this.curArr=[],this.zhuanPanMap=b8e.HashMap.get(),this.duoBaoMap=b8e.HashMap.get(),this.recordMap=b8e.HashMap.get(),this.positionsMap=b8e.HashMap.get()},synRoulette:function(e,t){var i,n,s,a,o;if(e&&0<e.length)for(i=0;i<e.length;i++)n=e[i],(s=new game.ZhuanPanInfo).setup(n),s.positions&&0<s.positions.length&&this.positionsMap.set(s.activitySubType,s.positions),this.zhuanPanMap.set(s.activitySubType,s);if(t&&0<t.length)for(i=0;i<t.length;i++)a=t[i],(o=new game.DuoBaoInfo).setup(a),this.duoBaoMap.set(o.activitySubType,o);this.upCostMax=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.UP_COST_MAX_COUNT)},synZhuanPan:function(e,t,i){if(t){this.awards=t,this.isZhuanPan=!0,e==game.ActiveSubType.ST_ZHUANPAN_BAOZHU&&(this.isShowEffect=!0);var n=this.getZhuanPanInfoByType(e);n&&(this.costItemId=game.ccfg.ZhuanPanCostCfg.getCostItemId(e,game.ZhuanPanCostType.AWARD_COST),this.costItemId?n.zhuanPanCount+=t.length-1:n.zhuanPanCount+=t.length,n.dailyFreeUsed||2!=t.length||(n.dailyFreeUsed=!0)),this.zpStopIndex=this.getStopIndexById(t[0],!0),e==game.ActiveSubType.ST_ZHUANPAN_UP_COST&&(n.zhuanPanCount%this.upCostMax==0?this.positionsMap.get(e)?this.positionsMap.get(e).length=0:(this.positionArr.length=0,this.positionsMap.set(e,this.positionArr)):this.positionsMap.get(e)?this.positionsMap.get(e).push(i):(this.positionArr.length=0,this.positionArr.push(i),this.positionsMap.set(e,this.positionArr))),b8e.evt.dptG(game.RouletteEvents.ZHUANPAN_SUCCESS)}else game.notice.show("转盘系统暂时繁忙,请稍候再试")},synDuoBao:function(e,t,i){var n=this.getDuoBaoListByType(e);if(this.duoBaoId=t,this.duoBaoAwards=i,-1!=n.indexOf(t))for(var s=0;s<n.length;s++)if(t==n[s]){n.splice(s,1);break}this.isZhuanPan=!1,this.dbStopIndex=this.getStopIndexById(t,!1),b8e.evt.dptG(game.RouletteEvents.DUOBAO_SUCCESS)},synZhuanPanCountAward:function(e,t){var i=this.getZhuanPanInfoByType(e);i&&-1==i.awardRecord.indexOf(t)&&i.awardRecord.push(t),b8e.evt.dptG(game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS)},synZhuanPanRecord:function(e,t){var i=new game.BaozhuItemInfo;i.setup(t),this.recordMap.set(e,i),b8e.evt.dptG(game.RouletteEvents.GET_BAOZHU_AWARD_SUCCESS)},resetDaily:function(){if(this.zhuanPanMap&&0<this.zhuanPanMap.count())for(var e,t=this.zhuanPanMap.values(),i=0;i<t.length;i++)(e=t[i]).activitySubType==game.ActiveSubType.ST_ZHUANPAN_FOREVER&&(e.zhuanPanCount=0,e.awardRecord.length=0),e.dailyFreeUsed=!1;b8e.evt.dptG(game.RouletteEvents.RESET_ROULETTE)},isRunEffect:function(){return!game.app.isShow(game.AppConstant.ROULETTE_SMALL_TIPS_PANEL)&&!game.app.isShow(game.AppConstant.ROULETTE_TIPS_PANEL)},clickBuyOnce:function(e){if(this.getFreeUsedByType(e)){var t=game.back.getAmountInfo(),i=0;t&&(i=t.getValue(game.AmountType.YUAN_BAO));var n=game.ccfg.ZhuanPanCostCfg.getCostNum(e,game.ZhuanPanCostType.ONCE_COST);this.costItemId=game.ccfg.ZhuanPanCostCfg.getCostItemId(e,game.ZhuanPanCostType.ONCE_COST),this.costItemId==game.AmountItemId.YUAN_BAO?n<=i?this.onReqZhuanPan(1,e):game.gameAlert.showVipAlert(!0,101):this.onReqZhuanPan(1,e)}else this.onReqZhuanPan(1,e)},clickBuyZehnmal:function(e){if(e==game.ActiveSubType.ST_ZHUANPAN_UP_COST){var t=this.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_UP_COST);return this.raffleCount=10,void game.ActiveSender.reqZhuanPan(this.upCostMax-t%this.upCostMax,game.ActiveSubType.ST_ZHUANPAN_UP_COST)}var i=game.back.getAmountInfo(),n=0;i&&(n=i.getValue(game.AmountType.YUAN_BAO));var s=game.ccfg.ZhuanPanCostCfg.getCostNum(e,game.ZhuanPanCostType.MULTIPLE_COST);this.costItemId=game.ccfg.ZhuanPanCostCfg.getCostItemId(e,game.ZhuanPanCostType.MULTIPLE_COST),this.costItemId==game.AmountItemId.YUAN_BAO?s<=n?this.onReqZhuanPan(10,e):game.gameAlert.showVipAlert(!0,101):this.onReqZhuanPan(10,e)},upCostAgain:function(){if(1<this.raffleCount)this.onReqZhuanPan(this.upCostMax,game.ActiveSubType.ST_ZHUANPAN_UP_COST);else if(0==this.positionArr.length)this.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_UP_COST,1);else for(var e=this.boxIndexArr.length,t=0;t<e;t++)if(-1==this.positionArr.indexOf(this.boxIndexArr[t]))return void this.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_UP_COST,this.boxIndexArr[t])},getZhuanPanInfoByType:function(e){if(this.zhuanPanMap&&0<this.zhuanPanMap.count()){var t=this.zhuanPanMap.get(e);if(t)return t}return null},getZhuanPanCountByType:function(e){if(this.zhuanPanMap&&0<this.zhuanPanMap.count()){var t=this.zhuanPanMap.get(e);if(t)return t.zhuanPanCount}return 0},getFreeUsedByType:function(e){if(this.zhuanPanMap&&0<this.zhuanPanMap.count()){var t=this.zhuanPanMap.get(e);if(t)return t.dailyFreeUsed}return!1},getDuoBaoListByType:function(e){if(this.duoBaoMap&&0<this.duoBaoMap.count()){var t=this.duoBaoMap.get(e);if(t)return t.duoBaoList}return null},getBaozhuItemInfoByType:function(e){return this.recordMap&&0<this.recordMap.count()?this.recordMap.get(e):null},getStopIndexById:function(e,t){if(e)for(var i,n=t?this.getZhuanPanArr():this.getDuoBaoArr(),s=0;s<n.length;s++)if(i=n[s],t){if(e.itemId==i.itemId)return s}else if(e==i.id)return s;return 1},getPositions:function(e){return this.positionsMap.get(e)},getZhuanPanArr:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=game.ccfg.ZhuanPanCfg.getArrByActiveType(game.active.selectSubType),i=0,n=game.active.getSubTypeInfo(game.active.selectSubType);if(n){var s=n.activeIds;s&&0<s.length&&(i=s[0])}var a=0,o=game.ccfg.ActivityCfg.getDataById(i);if(o&&(a=o.repository),t&&0<t.length){var r;this.curArr.length=0;for(var h=t.length,g=0;g<h;g++)(r=t[g]).repository==a&&(e?r.precious&&this.curArr.push(r):this.curArr.push(r));return this.curArr}return null},getDuoBaoArr:function(){var e=game.ccfg.DuoBaoCfg.getDatas();return e&&0<e.length?e:null},getRouletteBox:function(e){return game.ccfg.CountAwardCfg.getCountAwardListByType(e)},getItemInfoById:function(e,t){var i=(t?game.ccfg.ZhuanPanCfg:game.ccfg.DuoBaoCfg).getDataById(e);return i?game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0):(b8e.log("转盘或者夺宝表配错啦"),null)},getItemInfo:function(e){var t;return e?(game.back.isBianshenCard(e.itemId)?((t=game.ccfg.BianshenCfg.getBianshenCfgById(e.itemId)).type=game.GoodsType.BIAN_SHEN_CARD,t.desc=""):t=game.ccfg.ItemInfoCfg.getItemInfoById(e.itemId,!0),t):(b8e.log("转盘或者夺宝表配错啦"),null)},getPrizeNumById:function(e,t){var i=(t?game.ccfg.ZhuanPanCfg:game.ccfg.DuoBaoCfg).getDataById(e);return i?i.itemNum:(b8e.log("转盘或者夺宝表配错啦"),1)},getStr:function(e){var t="",i=0;switch(game.active.selectSubType){case game.ActiveSubType.ST_ZHUANPAN_NORMAL:case game.ActiveSubType.ST_ZHUANPAN_FESTIVAL:case game.ActiveSubType.ST_ZHUANPAN_RECHARGE:i=e?13015:13014;break;case game.ActiveSubType.ST_ZHUANPAN_COMBINE:i=e?13017:13016;break;case game.ActiveSubType.ST_ZHUANPAN_FOREVER:i=e?13019:13018;break;case game.ActiveSubType.ST_ZHUANPAN_LOW_COST:i=e?13041:13040;break;case game.ActiveSubType.ST_ZHUANPAN_VIP:i=e?13062:13061;break;case game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST:i=e?13064:13063;break;case game.ActiveSubType.ST_ZHUANPAN_UP_COST:case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:i=e?55007:55008;break;case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG:case game.ActiveSubType.ST_ZHUANPAN_EASTEREGG_GOLD:case game.ActiveSubType.ST_ZHUANPAN_DIAMOND:case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:return t;default:i=e?13013:13012}return i&&(t=game.ccfg.LangCfg.getText(i)),t},getAwards:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?this.awards:this.duoBaoAwards;if(t&&0<t.length){for(var i,n,s=[],a=e?t.length:2,o=0;o<a;o++)(n=t[o])&&(i=this.getItemInfo(n))&&(i.num=n.itemNum,s.push(i));return s}return[]},getRaffleCost:function(e){var t=game.ccfg.ZhuanPanCostCfg.getDataByKey(e);return t&&t.money?t.money:0},getLowCostAlert:function(e,t){var i=0,n=this.getRaffleCost(e),s=game.pay.getConditionsInfo(t);game.active.getActiveConditionValue(e,t);if(0<n&&(s&&(i=s.value),0<i/n-this.getZhuanPanCountByType(e)>>0))return!0;return!1},getGoldedPigAlert:function(){var e=game.PayMgr.inst().getConditionsInfo(game.ActivityConditionType.MIDDLE_COST_RECHARGE);if(!e)return!1;var t=game.RouletteMgr.inst().getZhuanPanInfoByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);if(!t||!t.awardRecord)return!1;var i,n=game.ccfg.CountAwardCfg.getCountAwardListByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST),s=n.length;s=3<s?s=3:s;for(var a=0;a<s;a++)if((i=n[a])&&-1==t.awardRecord.indexOf(i.count)&&t.zhuanPanCount>=i.count)return!0;i=game.ccfg.ZhuanPanCostCfg.getCostByType(game.ActiveSubType.ST_ZHUANPAN_MIDDLE_COST);var o=e.value/i.money>>0;return 0<(o-=t.zhuanPanCount)},onReqZhuanPan:function(e,t,i){this.raffleCount=e,game.ActiveSender.reqZhuanPan(e,t,i)},zhuanPanCallBack:function(){2<this.raffleCount&&game.active.selectSubType!=game.ActiveSubType.ST_ZHUANPAN_UP_COST?game.app.show(game.AppConstant.ROULETTE_TIPS_PANEL):game.app.show(game.AppConstant.ROULETTE_SMALL_TIPS_PANEL)}}),game.RouletteMgr._instance=null,game.RouletteMgr.inst=function(){return game.RouletteMgr._instance||(game.RouletteMgr._instance=new game.RouletteMgr),game.RouletteMgr._instance}},{}],707:[function(e,t,i){"use strict";game.appModule.BaozhuDescPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},init:function(){},onShow:function(){var e=13030,t=13101;if(game.active.actvieDescType==game.active.ACTIVE_DESC)switch(game.active.selectSubType){case game.ActiveSubType.ST_ZHUANPAN_NORMAL:e=13020,t=13080;break;case game.ActiveSubType.ST_ZHUANPAN_COMBINE:e=13021,t=13081;break;case game.ActiveSubType.ST_ZHUANPAN_FOREVER:e=13022,t=13082;break;case game.ActiveSubType.ST_ZHUANPAN_FESTIVAL:e=13023,t=13083;break;case game.ActiveSubType.ST_ZHUANPAN_BAOZHU:e=13011,t=13091;break;case game.ActiveSubType.ST_ZHUANPAN_RECHARGE:case game.ActiveSubType.ST_ZHUANPAN_DIAMOND:e=13024,t=13084;break;case game.ActiveSubType.ST_ZHUANPAN_VIP:e=13025,t=13085;break;case game.ActiveSubType.ST_ZHUANPAN_UP_COST:e=13026,t=13086;break;case game.ActiveSubType.ST_COST_RANK_CROSS_ZHUANPAN:case game.ActiveSubType.ST_COST_RANK_CROSS_STAR:case game.ActiveSubType.ST_COST_RANK_CROSS_FABAO:case game.ActiveSubType.ST_COST_RANK_CROSS_REPUTATION:case game.ActiveSubType.ST_COST_RANK_CROSS_MOUNT:case game.ActiveSubType.ST_COST_RANK_CROSS_WING:case game.ActiveSubType.ST_COST_RANK_CROSS_BIANSHEN:case game.ActiveSubType.ST_COST_RANK_CROSS_XIANZHEN:e=game.active.getCrossServerStr(),t=71009;break;case game.ActiveSubType.ST_CROSS_REBATE_PURCHASE:case game.ActiveSubType.ST_COST_RANK_CROSS_PURCHASE:e=game.active.getCrossPurchaseServerStr(),t=71008;break;case game.ActiveSubType.ST_ZHUANPAN_BIANSHEN:e=74501,t=74500;break;case game.ActiveSubType.ST_FRAGMENT_CONVERT:e=81016,t=81015;break;case game.ActiveSubType.ST_COLLECT_EXCHANGE_2:case game.ActiveSubType.ST_COLLECT_EXCHANGE_3:e=game.active.getWorldCupServerStr(),t=71008}this._skin.title.string=game.ccfg.LangCfg.getText(t),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(e)},onHide:function(){}})},{}],708:[function(e,t,i){"use strict";game.BaozhuItem=game.SkinUI.extends({m_data:null,ctor:function(){this._super("roulette/BaozhuItemSkin","BaozhuItemSkin")},getHeight:function(){return 26},getWidth:function(){return 410},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){if(this.m_data=e,this._skin&&e&&e.id){var t=game.roulette.getItemInfoById(e.id,!0);if(t&&""!=t.name){var i,n=game.roulette.getPrizeNumById(e.id,!0);i=n&&1<n?game.ccfg.LangCfg.getText(13010,[e.name,game.html.getText(game.ccfg.ItemInfoCfg.getQualityColorById(t.id),t.name+"*"+n)]):game.ccfg.LangCfg.getText(13010,[e.name,game.html.getText(game.ccfg.ItemInfoCfg.getQualityColorById(t.id),t.name)]),this._skin.recordlab.string=i}}}})},{}],709:[function(e,t,i){"use strict";game.BaozhuPanel=game.SkinUI.extends({_timer:null,rewardBoxes:null,_dataList:null,_dataPool:null,_itemList:null,_itemPool:null,firstPoY:0,lastPosY:0,itemHeight:26,maxShowNum:5,_bgSprite:null,_bgNsSprite:null,_nianshouSprite:null,_modalDisplay:null,_oldy:-1,isEnd:!0,effectIsEnd:!0,_lightShaderCd:0,ctor:function(){this._super("roulette/BaozhuSkin","BaozhuSkin")},init:function(){this._itemList=[],this._itemPool=[],this._dataList=[],this._dataPool=[],this.rewardBoxes=[],this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgBaozhu",!0),null,null,{useManifest:!1}),this._bgNsSprite=b8e.Sprite.get(),this._bgNsSprite.addToParent(this._skin.img_nianshou),this._bgNsSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgBaozhu2",!1),null,null,{useManifest:!1}),this._onceCostSprite||(this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.icon_item1),this._onceCostSprite.setSize(30,30)),this._tenCostSprite||(this._tenCostSprite=b8e.Sprite.get(),this._tenCostSprite.addToParent(this._skin.icon_item10),this._tenCostSprite.setSize(30,30)),this.createGrids(),this.creatBoxes(),this._modalDisplay||(this._modalDisplay=b8e.BaseDisplay.get(),this._modalDisplay.addToParent(this._skin.effect))},onShow:function(){game.ActiveSender.reqZhuanPanRecord(game.ActiveSubType.ST_ZHUANPAN_BAOZHU),this._skin.img_one.opacity=0,this._skin.img_ten.opacity=0,-1==this._oldy&&(this._oldy=this._skin.img_one.y),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenhao,this),b8e.evt.addG(this,game.RouletteEvents.GET_BAOZHU_AWARD_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updateProgress),b8e.evt.addG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes)},onHide:function(){this.clearAnim(),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenhao,this),b8e.evt.rmvG(this,game.RouletteEvents.GET_BAOZHU_AWARD_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updateProgress),b8e.evt.rmvG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes)},updatePanel:function(){this.updateProgress();var e=game.roulette.getBaozhuItemInfoByType(game.ActiveSubType.ST_ZHUANPAN_BAOZHU);if(e){var t=e.records;if(t||!(t.length<=0)){var i;this.reset();for(var n=0;n<t.length;++n)n<this.maxShowNum?((i=this.getItem()).setData(t[n]),this.addRecordItemNode(i),i.addToParent(this._skin.recordNode),i.show(),this._itemList.push(i),this._dataList.push(t[n])):this._dataPool.push(t[n]);this.critAnimation()}}},addRecordItemNode:function(e){e&&(this.lastPosY-=e.height,e.y=this.lastPosY)},critAnimation:function(){this._skin.recordNode.y!=this.firstPoY&&this.changeItemPosition(),b8e.Tween.kill(this._skin.recordNode);var e=this._skin.recordNode.y;b8e.Tween.get(this._skin.recordNode).to({y:e+this.itemHeight},2e3).call(this.critAnimation,this)},changeItemPosition:function(){if(0<this._itemList.length){var e=this._itemList.shift(),t=this._dataList.shift();this._dataPool.push(t);var i=this._dataPool.shift();e.setData(i),this._dataList.push(i),this.addRecordItemNode(e),this._itemList.push(e)}},getItem:function(){return 0<this._itemPool.length?this._itemPool.shift():new game.BaozhuItem},clearItem:function(){for(;0<this._itemList.length;){var e=this._itemList.shift();e.hide(),this._itemPool.push(e)}this._itemList.length=0},reset:function(){this.lastPosY=0,this.clearItem(),b8e.Tween.kill(this._skin.recordNode),this._skin.recordNode.y=this.firstPoY,this._dataList&&(this._dataList.length=0),this._dataPool&&(this._dataPool.length=0)},updatePrice:function(){if(game.roulette.getFreeUsedByType(game.ActiveSubType.ST_ZHUANPAN_BAOZHU)){this._skin.lab_free.string="",this._skin.node_priceOne.active=!0;var e=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_BAOZHU,game.ZhuanPanCostType.ONCE_COST);if(this._skin.lab_onePrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_BAOZHU,game.ZhuanPanCostType.ONCE_COST),e==game.AmountItemId.SILVER)this._skin.node_yinbi.active=!0,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!1;else if(e==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!0,this._skin.icon_item1.active=!1;else{this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!0;var t=game.ccfg.ItemInfoCfg.getIconNameById(e);if(t){var i=game.ClientCfg.getImgUrl(t);this._onceCostSprite.loadTexture(i,null,null,{useManifest:!1})}}}else this._skin.lab_free.string="免费",this._skin.node_priceOne.active=!1;var n=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_BAOZHU,game.ZhuanPanCostType.MULTIPLE_COST);if(this._skin.lab_tenPrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_BAOZHU,game.ZhuanPanCostType.MULTIPLE_COST),n==game.AmountItemId.SILVER)this._skin.node_yinbi10.active=!0,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!1;else if(n==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!0,this._skin.icon_item10.active=!1;else{this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!0;var s=game.ccfg.ItemInfoCfg.getIconNameById(n);if(s){i=game.ClientCfg.getImgUrl(s);this._tenCostSprite.loadTexture(i,null,null,{useManifest:!1})}}},updateProgress:function(){var e=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.ActiveSubType.ST_ZHUANPAN_BAOZHU),t=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_BAOZHU);0<e&&(this._skin.progress_bar_node.width=this._skin.progress_mask.width*t/e),this._skin.lab_buyCount.string=t+"万",this.updatePrice(),this.updateBoxes(),this.effectIsEnd&&game.roulette.isShowEffect&&(this.showEffect(),this.riseAnim(),this.addLightShader())},creatBoxes:function(){var e,t,i=game.roulette.getRouletteBox(game.ActiveSubType.ST_ZHUANPAN_BAOZHU);if(i&&0<i.length)for(var n=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.ActiveSubType.ST_ZHUANPAN_BAOZHU),s=0;s<i.length;s++)(t=i[s])&&((e=new game.RouletteBox).addToParent(this._skin.box),0<n&&e.setPosition(t.count/parseInt(n)*this._skin.progress_mask.width,0),e.setData(t),e.setVisible(!0),e.show(),this.rewardBoxes.push(e))},updateBoxes:function(){var e,t=game.roulette.getRouletteBox(game.ActiveSubType.ST_ZHUANPAN_BAOZHU);if(this.rewardBoxes&&0<this.rewardBoxes.length)for(var i=0;i<this.rewardBoxes.length;i++)e=t[i],this.rewardBoxes[i].setData(e)},createGrids:function(){var e,t,i,n,s,a,o=[],r=game.roulette.getZhuanPanArr(!0);if(r&&0<r.length)for(var h=r.length,g=0;g<h;g++)(i=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.BAO_ZHU_CONTAINER_ID),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),a=r[g],(s=game.ccfg.ItemInfoCfg.getItemInfoById(a.itemId,!0))&&(s.num=a.itemNum,game.GridUtil.setItemGrid(i,s),i.fnOnClick(this,this.onClick),i.setNum(a.itemNum),n=.5*g,n>>=0,e=200*Math.pow(-1,g),t=-130*n,i.setPosition(e,t),i.sortLayer(),o.push(i))},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},onClickBuyOnce:function(){this.isEnd&&game.roulette.clickBuyOnce(game.ActiveSubType.ST_ZHUANPAN_BAOZHU)},onClickBuyZehnmal:function(){this.isEnd&&game.roulette.clickBuyZehnmal(game.ActiveSubType.ST_ZHUANPAN_BAOZHU)},onClickWenhao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},showEffect:function(){var e;(e=game.ClientCfg.getUIFxs("10081"))?(this.effectIsEnd=!1,this._anim=b8e.Animator.get(game.AnimatorType.BAOZHU_EFFECT,1),this._modalDisplay.addChild(this._anim),this._anim.load(e),this._anim.play(null,0),this._anim.addFinishCallback(this.onCompleteEffect,this),game.roulette.isShowEffect=!1):this._anim&&this._anim.clear()},onCompleteEffect:function(){this._anim&&this._anim.setVisible(!1),this.effectIsEnd=!0},riseAnim:function(){var e=10==game.roulette.raffleCount?this._skin.img_ten:this._skin.img_one;if(this.isEnd){if(e){this.isEnd=!1,e.opacity=255,b8e.Tween.kill(e);var t=e.y;b8e.Tween.get(e).to({y:t+60,opacity:0},1e3).wait(500).call(this.restoreAnim,this,[e])}}else this.restoreAnim(e),this.riseAnim()},restoreAnim:function(e){this.isEnd||(b8e.Tween.kill(e),e.opacity=0,e.y=this._oldy,game.roulette.zhuanPanCallBack(),this.isEnd=!0)},addLightShader:function(){if(this._skin&&this._bgNsSprite){var e=game.SysTime.curTime;if(!(this._lightShaderCd>e)){this._lightShaderCd=e+500,b8e.Tween.kill(this);var t=this._bgNsSprite.getShader();t.getColorTransfrom().clear(),t.update(),t.getColorTransfrom().setData([8,8,8,1,0,0,0,0]),t.update(),b8e.Tween.get(this).wait(100).call(this.removeLightShader,this)}}},removeLightShader:function(){if(this._skin&&this._bgNsSprite){var e=this._bgNsSprite.getShader();e.getColorTransfrom().clear(),e.update()}},clearAnim:function(){b8e.Tween.kill(this),this.removeLightShader(),this._lightShaderCd=0;var e=10==game.roulette.raffleCount?this._skin.img_ten:this._skin.img_one;this.restoreAnim(e),this.onCompleteEffect()}})},{}],710:[function(e,t,i){"use strict";game.LowCostPanel=game.SkinUI.extends({_gridPosArr:null,_endTimer:null,ctor:function(){this._super("roulette/LowCostSkin","LowCostSkin"),this._gridPosArr=[[0,90],[-160,70],[160,70],[-60,-20],[60,-20]]},init:function(){this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgLowCost",!0),null,null,{useManifest:!1}),this.createGrids();var e=game.ccfg.LangCfg.getText(13042);this._skin.lab_desc.string=e,e=game.ccfg.LangCfg.getText(13043),this._skin.lab_desc1.string=e},onShow:function(){this.updateProgress(),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.onC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress)},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.offC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress)},updateProgress:function(){var e=0,t=0,i=game.roulette.getRaffleCost(game.ActiveSubType.ST_ZHUANPAN_LOW_COST),n=game.pay.getConditionsInfo(game.ActivityConditionType.LOW_COST_RECHARGE),s=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_LOW_COST);if(0<i){n&&(e=(t=n.value)%i),this._skin.progress_bar_node.width=this._skin.progress_mask.width*e/i,this._skin.lab_progress.string=e+"/"+i;var a=i-e;this._skin.lab_pay.string="再充值"+game.html.getText(game.html.Q_GREEN,a+"元")+"可获得1次抽奖机会";var o=t/i-s>>0;this._skin.lab_remainCount.string="剩余次数："+o+"次"}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},createGrids:function(){var e,t,i,n,s,a=game.roulette.getZhuanPanArr();if(a&&0<a.length)for(var o=0;o<5;o++)(e=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.LOW_COST_CONTAINER_ID),e.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),i=a[o],(t=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0))&&(t.num=i.itemNum,game.GridUtil.setItemGrid(e,t),e.fnOnClick(this,this.onClick),e.setNum(i.itemNum),n=this._gridPosArr[o][0],s=this._gridPosArr[o][1],e.setPosition(n,s),e.sortLayer())},zhuanPanCallBack:function(){this.updateProgress(),game.roulette.zhuanPanCallBack()},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickRecharge:function(){game.pay.showPayPanel()},onClickBuyOnce:function(){game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_LOW_COST)},onClickBuyZehnmal:function(){game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_LOW_COST)}})},{}],711:[function(e,t,i){"use strict";game.RouletteBox=game.SkinUI.extends({_data:null,_normal:null,_select:null,ctor:function(){this._super("roulette/RouletteBoxSkin","RouletteBoxSkin")},init:function(){this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle),this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle)},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},onTouchThis:function(){var e=game.roulette.getZhuanPanInfoByType(game.active.selectSubType);e&&e.awardRecord&&(game.roulette.getZhuanPanCountByType(game.active.selectSubType)>=this._data.count&&-1==e.awardRecord.indexOf(this._data.count)?game.ActiveSender.collectZhuanPanCountAward(this._data.count,game.active.selectSubType):this._data.dropId&&(game.roulette.dropId=this._data.dropId,game.app.show(game.AppConstant.AWARD_TIPS_PANEL,game.roulette.dropId)))},setData:function(e){if(this._data=e,this._skin){this._skin.alert.active=!1,this._skin.normalTitle.active=!1,this._skin.selectTitle.active=!1,this._data.count&&(game.active.selectSubType!=game.ActiveSubType.ST_ZHUANPAN_BAOZHU?this._skin.lab_count.string=this._data.count+"次":this._skin.lab_count.string=this._data.count+"万");var t=game.roulette.getZhuanPanInfoByType(game.active.selectSubType);if(t&&t.awardRecord)if(-1!=t.awardRecord.indexOf(this._data.count))this._skin.selectTitle.active=!0,this._select.loadTexture(game.ClientCfg.getImgUrl(e.receivedBg,!1),null,null,{useManifest:!1});else{var i=game.roulette.getZhuanPanCountByType(game.active.selectSubType);this._data.count<=i?this._skin.alert.active=!0:this._skin.alert.active=!1,this._skin.normalTitle.active=!0,this._normal.loadTexture(game.ClientCfg.getImgUrl(e.normalBg,!1),null,null,{useManifest:!1})}}},getHeight:function(){return 95},getWidth:function(){return 85}})},{}],712:[function(e,t,i){"use strict";game.RouletteDbPanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_endTimer:null,_marqueeController:null,posArrayX:null,posArrayY:null,gridArr:null,cicleRadius:210,isEnd:!0,_discount:null,ctor:function(){this._super("roulette/RouletteDbSkin","RouletteDbSkin")},init:function(){this.gridArr=[],this.posArrayX=[],this.posArrayY=[],this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgRoulette",!0),null,null,{useManifest:!1}),this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount);var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_DUOBAO_NORMAL);e&&""!=e.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!1),null,null,{useManifest:!1}),this.createGrids();var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.DUOBAO_PRIZE);if(t){var i=t.split("|");this._skin.lab_desc.string=game.ccfg.LangCfg.getText(10502,[game.ccfg.ItemInfoCfg.getNameById(i[0])])}this._anim=b8e.Animator.get(game.AnimatorType.ROULETTE_EFFECT,1),this._anim.addToParent(this._skin.effect),this._anim.setBlendMode(b8e.BlendMode.ADD)},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),this.updatePanel(),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.addG(this,game.RouletteEvents.DUOBAO_SUCCESS,this.duobaoCallBack)},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.rmvG(this,game.RouletteEvents.DUOBAO_SUCCESS,this.duobaoCallBack),this.isEnd||(this.setGridLabel(),game.app.show(game.AppConstant.ROULETTE_SMALL_TIPS_PANEL),this.isEnd=!0)},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},duobaoCallBack:function(){game.roulette.isRunEffect()&&this.startMarquee()},updatePanel:function(){var e=game.roulette.getDuoBaoListByType(game.ActiveSubType.ST_DUOBAO_NORMAL);if(e){var t=game.ccfg.CostCfg.getMaxBuyCountById(game.SystemId.DUOBAO_COUNT),i=game.ccfg.CostCfg.getNextCost(game.SystemId.DUOBAO_COUNT,t-e.length);this._skin.lab_onePrice.string=i;var n,s,a=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.DUOBAO_COUNT,t-e.length);a&&(a.upgradeInfo.amountInfo.hasSomeType(game.AmountType.YUAN_BAO)?(this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!0):(this._skin.node_yinbi.active=!0,this._skin.node_yuanbao.active=!1));for(var o=0;o<e.length;o++)s=e[o],n=game.roulette.getStopIndexById(s,!1),this.gridArr[n]&&this.gridArr[n].setName("",game.html.Q_GREEN,null,200,30,24)}},createGrids:function(){var e,t,i,n,s,a=game.roulette.getDuoBaoArr();if(a&&0<a.length){for(var o=a.length,r=0;r<o;r++)(i=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_DB_CONTAINER_ID),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),s=a[r],(n=game.ccfg.ItemInfoCfg.getItemInfoById(s.itemId,!0))&&(n.num=s.itemNum,game.GridUtil.setItemGrid(i,n),i.setNum(s.itemNum),i.fnOnClick(this,this.onClick),i.setName("已获得",game.html.Q_GREEN,null,200,30,24),e=Math.sin(360/o*r*Math.PI/180)*this.cicleRadius,t=Math.cos(360/o*r*Math.PI/180)*this.cicleRadius,this.posArrayX.push(e),this.posArrayY.push(t),i.setPosition(e,t),i.sortLayer(),this.gridArr.push(i));this._marqueeController=new game.Roulette(this,[[5,1]],this.posArrayX,this.posArrayY,this.runingFun,this.runCompleteFun)}},runingFun:function(e){this._skin.effect.x=this._skin.item.x+this.posArrayX[e],this._skin.effect.y=this._skin.item.y+this.posArrayY[e]},runCompleteFun:function(){this.isEnd||(this._anim&&this._anim.setVisible(!1),this.setGridLabel(),game.app.show(game.AppConstant.ROULETTE_SMALL_TIPS_PANEL),this.isEnd=!0,this._marqueeController.stop())},startMarquee:function(){this.isEnd=!1,this.showEffect();var e=game.roulette.dbStopIndex,t=game.roulette.getDuoBaoArr();t&&0<t.length&&(0==e&&(e=t.length),this._marqueeController.run(this._skin.effect,e))},setGridLabel:function(){var e=game.roulette.getStopIndexById(game.roulette.duoBaoId,!1);this.gridArr[e]&&this.gridArr[e].setName("已获得",game.html.Q_GREEN,null,200,30,24),this._anim&&this._anim.setVisible(!1)},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickBuyOnce:function(){if(this.isEnd){var e=game.roulette.getDuoBaoListByType(game.ActiveSubType.ST_DUOBAO_NORMAL);if(e&&0<e.length){var t=game.back.getAmountInfo();if(t){t.getValue(game.AmountType.SILVER);var i=t.getValue(game.AmountType.YUAN_BAO)}var n=game.ccfg.CostCfg.getMaxBuyCountById(game.SystemId.DUOBAO_COUNT),s=game.ccfg.CostCfg.getNextCost(game.SystemId.DUOBAO_COUNT,n-e.length),a=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.DUOBAO_COUNT,n-e.length);a&&(a.upgradeInfo.amountInfo.hasSomeType(game.AmountType.YUAN_BAO)?s<=i?game.ActiveSender.reqDuoBao(game.ActiveSubType.ST_DUOBAO_NORMAL):game.gameAlert.showVipAlert(!0,101):game.ActiveSender.reqDuoBao(game.ActiveSubType.ST_DUOBAO_NORMAL))}else game.notice.show("夺宝次数已用完")}},showEffect:function(){this._anim&&this._anim.setVisible(!0);var e=game.ClientCfg.getUIFxs("10073");e?(this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}})},{}],713:[function(e,t,i){"use strict";game.RouletteGrid=game.SkinUI.extends({_itemInfo:null,_itemGrid:null,ctor:function(){this._super()},setData:function(e){if(this._itemInfo=e,this._itemInfo){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID)),this.addChild(this._itemGrid),game.GridUtil.setItemGrid(this._itemGrid,e);var t=e.num;this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.setName(e.name,game.html.getColorByQuality(e.quality),null,200,30,20),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.setNum(t),this._itemGrid.sortLayer()}else this._itemGrid&&game.GridUtil.setItemGrid(this._itemGrid,null)},getHeight:function(){return 90},getWidth:function(){return 90},onClick:function(e){e&&e.faceInfo&&(game.back.isBianshenCard(e.faceInfo.id)?game.bianshen.showBianshenDetail(e.faceInfo):e.faceInfo.isEquip?game.app.show(game.AppConstant.EQUIP_BASE_TIPS,e.faceInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId}))}})},{}],714:[function(e,t,i){"use strict";game.RoulettePanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_timer:null,_marqueeController:null,posArrayX:null,posArrayY:null,isEnd:!0,rewardBoxes:null,_endTimer:null,_discount:null,_bgSprite:null,_onceCostSprite:null,_tenCostSprite:null,ctor:function(){this._super("roulette/RouletteSkin","RouletteSkin")},init:function(){this.posArrayX=[],this.posArrayY=[],this.rewardBoxes=[],this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgRoulette",!0),null,null,{useManifest:!1}),this.createGrids(),this.creatBoxes(),this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount);var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_ZHUANPAN_NORMAL);e&&""!=e.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1}),this._onceCostSprite||(this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.icon_item1),this._onceCostSprite.setSize(30,30)),this._tenCostSprite||(this._tenCostSprite=b8e.Sprite.get(),this._tenCostSprite.addToParent(this._skin.icon_item10),this._tenCostSprite.setSize(30,30)),this._skin.lab_desc.string="",this._anim=b8e.Animator.get(game.AnimatorType.ROULETTE_EFFECT,1),this._anim.addToParent(this._skin.effect),this._anim.setBlendMode(b8e.BlendMode.ADD)},onShow:function(){this.updatePanel(),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanoPanCallBack),b8e.evt.addG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes)},onHide:function(){this._timer&&this._timer.stop(),this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanoPanCallBack),b8e.evt.rmvG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes),game.active.selectSubType!=game.ActiveSubType.ST_ZHUANPAN_NORMAL&&this.runCompleteFun()},zhuanoPanCallBack:function(){this.updatePanel(),game.roulette.isRunEffect()&&this.startMarquee()},updatePanel:function(){this.updatePrice(),this.updateProgress(),this.updateBoxes()},updateTime:function(){var e=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime)-game.SysTime.curTime;this._skin.lab_freeTime.string=0<e?b8e.TimeUtil.formatTime(e)+"后免费":""},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},updateProgress:function(){var e=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.active.selectSubType),t=game.roulette.getZhuanPanCountByType(game.active.selectSubType);0<e&&(this._skin.progress_bar_node.width=this._skin.progress_mask.width*t/e),this._skin.lab_buyCount.string=t+"次"},updatePrice:function(){var e=game.ccfg.ZhuanPanCostCfg.getRaffleCountByType(game.active.selectSubType),t=game.roulette.getZhuanPanCountByType(game.active.selectSubType);if(0<e&&(this._skin.lab_remainTimes.string="剩余购买次数:"+(e-t)+"次"),game.roulette.getFreeUsedByType(game.active.selectSubType)){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3)),this._timer.start(),this._skin.lab_free.string="",this._skin.node_priceOne.active=!0;var i=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.active.selectSubType,game.ZhuanPanCostType.ONCE_COST);if(this._skin.lab_onePrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.ONCE_COST),i==game.AmountItemId.SILVER)this._skin.node_yinbi.active=!0,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!1;else if(i==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!0,this._skin.icon_item1.active=!1;else{this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!0;var n=game.ccfg.ItemInfoCfg.getIconNameById(i);if(n){var s=game.ClientCfg.getImgUrl(n);this._onceCostSprite.loadTexture(s,null,null,{useManifest:!1})}}}else this._timer&&this._timer.stop(),this._skin.lab_freeTime.string="",this._skin.lab_free.string="免费",this._skin.node_priceOne.active=!1;var a=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.active.selectSubType,game.ZhuanPanCostType.MULTIPLE_COST);if(this._skin.lab_tenPrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.MULTIPLE_COST),a==game.AmountItemId.SILVER)this._skin.node_yinbi10.active=!0,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!1;else if(a==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!0,this._skin.icon_item10.active=!1;else{this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!0;var o=game.ccfg.ItemInfoCfg.getIconNameById(a);if(o){s=game.ClientCfg.getImgUrl(o);this._tenCostSprite.loadTexture(s,null,null,{useManifest:!1})}}},creatBoxes:function(){var e,t,i=game.roulette.getRouletteBox(game.active.selectSubType);if(i&&0<i.length)for(var n=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.active.selectSubType),s=0;s<i.length;s++)(t=i[s])&&((e=new game.RouletteBox).addToParent(this._skin.box),0<n&&e.setPosition(t.count/parseInt(n)*this._skin.progress_mask.width,0),e.setData(t),e.setVisible(!0),e.show(),this.rewardBoxes.push(e))},updateBoxes:function(){var e,t=game.roulette.getRouletteBox(game.active.selectSubType);if(this.rewardBoxes&&0<this.rewardBoxes.length)for(var i=0;i<this.rewardBoxes.length;i++)e=t[i],this.rewardBoxes[i].setData(e)},createGrids:function(){var e,t,i,n,s,a=[],o=game.roulette.getZhuanPanArr();if(o&&0<o.length){for(var r=o.length,h=0;h<r;h++)(i=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),s=o[h],(n=game.ccfg.ItemInfoCfg.getItemInfoById(s.itemId,!0))&&(n.num=s.itemNum,game.GridUtil.setItemGrid(i,n),i.fnOnClick(this,this.onClick),i.setNum(s.itemNum),e=198*Math.sin((360/r*h+180/r)*Math.PI/180),t=198*Math.cos((360/r*h+180/r)*Math.PI/180),this.posArrayX.push(e),this.posArrayY.push(t),i.setPosition(e,t),i.sortLayer(),a.push(i));this._marqueeController=new game.Roulette(this,[[5,1]],this.posArrayX,this.posArrayY,this.runingFun,this.runCompleteFun)}},runingFun:function(e){var t=game.roulette.getZhuanPanArr();t&&t.length&&(e==t.length&&(e=0),this._skin.effect.x=this._skin.item.x+this.posArrayX[e],this._skin.effect.y=this._skin.item.y+this.posArrayY[e])},runCompleteFun:function(){this.isEnd||(this._anim&&this._anim.setVisible(!1),game.roulette.zhuanPanCallBack(),this.isEnd=!0,this._marqueeController.stop())},startMarquee:function(){this.isEnd=!1,this.showEffect();var e=game.roulette.zpStopIndex,t=game.roulette.getZhuanPanArr();t&&0<t.length&&(0==e&&(e=t.length),this._marqueeController.run(this._skin.effect,e))},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickBuyOnce:function(){this.isEnd&&game.roulette.clickBuyOnce(game.active.selectSubType)},onClickBuyZehnmal:function(){this.isEnd&&game.roulette.clickBuyZehnmal(game.active.selectSubType)},showEffect:function(){this._anim&&this._anim.setVisible(!0);var e=game.ClientCfg.getUIFxs("10073");e?(this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}})},{}],715:[function(e,t,i){"use strict";game.RouletteRechargePanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_marqueeController:null,posArrayX:null,posArrayY:null,isEnd:!0,rewardBoxes:null,_endTimer:null,_discount:null,ctor:function(){this._super("roulette/RouletteRechargeSkin","RouletteRechargeSkin")},init:function(){this.posArrayX=[],this.posArrayY=[],this.rewardBoxes=[],this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgRoulette",!0),null,null,{useManifest:!1}),this.createGrids(),this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount);var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_ZHUANPAN_NORMAL);e&&""!=e.discount&&this._discount.loadTexture(game.ClientCfg.getImgUrl(e.discount,!0),null,null,{useManifest:!1}),this._anim=b8e.Animator.get(game.AnimatorType.ROULETTE_EFFECT,1),this._anim.addToParent(this._skin.effect),this._anim.setBlendMode(b8e.BlendMode.ADD)},onShow:function(){this.updateProgress(),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),game.roulette.isActiveSever&&(this._skin.node_blackBg.height=760),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.onC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanoPanCallBack),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress)},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.offC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanoPanCallBack),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress),game.active.selectSubType!=game.ActiveSubType.ST_ZHUANPAN_RECHARGE&&this.runCompleteFun()},zhuanoPanCallBack:function(){this.updateProgress(),game.roulette.isRunEffect()&&this.startMarquee()},updateProgress:function(){var e=0,t=0,i=game.roulette.getRaffleCost(game.ActiveSubType.ST_ZHUANPAN_RECHARGE),n=game.pay.getConditionsInfo(game.ActivityConditionType.ZHUANPAN_RECHARGE),s=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_RECHARGE);if(0<i){n&&(e=(t=n.value)%i),this._skin.progress_bar_node.width=this._skin.progress_mask.width*e/i,this._skin.lab_progress.string=e+"/"+i;var a=i-e;this._skin.lab_pay.string="再充值"+game.html.getText(game.html.Q_GREEN,a+"元")+"可获得1次抽奖机会";var o=t/i-s>>0;this._skin.lab_remainCount.string="剩余次数："+o+"次"}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.lab_endTimer.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.lab_endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.lab_endTimer.string="已结束"},createGrids:function(){var e,t,i,n,s,a=[],o=game.roulette.getZhuanPanArr();if(o&&0<o.length){for(var r=o.length,h=0;h<r;h++)(i=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),s=o[h],(n=game.ccfg.ItemInfoCfg.getItemInfoById(s.itemId,!0))&&(n.num=s.itemNum,game.GridUtil.setItemGrid(i,n),i.fnOnClick(this,this.onClick),i.setNum(s.itemNum),e=198*Math.sin((360/r*h+180/r)*Math.PI/180),t=198*Math.cos((360/r*h+180/r)*Math.PI/180),this.posArrayX.push(e),this.posArrayY.push(t),i.setPosition(e,t),i.sortLayer(),a.push(i));this._marqueeController=new game.Roulette(this,[[5,1]],this.posArrayX,this.posArrayY,this.runingFun,this.runCompleteFun)}},runingFun:function(e){var t=game.roulette.getZhuanPanArr();t&&t.length&&(e==t.length&&(e=0),this._skin.effect.x=this._skin.item.x+this.posArrayX[e],this._skin.effect.y=this._skin.item.y+this.posArrayY[e])},runCompleteFun:function(){this.isEnd||(this._anim&&this._anim.setVisible(!1),game.roulette.zhuanPanCallBack(),this.isEnd=!0,this._marqueeController&&this._marqueeController.stop())},startMarquee:function(){this.isEnd=!1,this.showEffect();var e=game.roulette.zpStopIndex,t=game.roulette.getZhuanPanArr();t&&0<t.length&&(0==e&&(e=t.length),this._marqueeController.run(this._skin.effect,e))},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickRecharge:function(){game.pay.showPayPanel()},onClickBuyOnce:function(){this.isEnd&&game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_RECHARGE)},onClickBuyZehnmal:function(){this.isEnd&&game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_RECHARGE)},showEffect:function(){this._anim&&this._anim.setVisible(!0);var e=game.ClientCfg.getUIFxs("10073");e?(this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}})},{}],716:[function(e,t,i){"use strict";game.appModule.RouletteSmallTipsPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_timer:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.RouletteGrid,3)},onShow:function(){this.updatePanel(),b8e.evt.onC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.onC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updatePanel)},onHide:function(){b8e.evt.offC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.offC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updatePanel)},updatePanel:function(){var e=1<game.roulette.raffleCount,t=game.roulette.getAwards(e,game.roulette.isZhuanPan);t&&2<t.length?this._skin.list.node.x=225:t&&2==t.length?this._skin.list.node.x=270:this._skin.list.node.x=320,this._list.show(),this._list.setData(t);var i=game.roulette.getStr(e);this._skin.lab_desc.string=i,i=game.active.selectSubType==game.ActiveSubType.ST_ZHUANPAN_UP_COST&&e?game.ccfg.LangCfg.getText(55006,[game.roulette.upCostMax]):game.ccfg.LangCfg.getText(56001,[game.roulette.upCostMax]),this._skin.lab_again.string=i},onClick:function(e){e&&e.faceInfo&&(e.faceInfo.isEquip?game.app.show(game.AppConstant.EQUIP_BASE_TIPS,e.faceInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId}))},onClickYes:function(){this.hide()},onClickAgain:function(){game.active.selectSubType==game.ActiveSubType.ST_ZHUANPAN_UP_COST?game.roulette.upCostAgain():game.roulette.clickBuyOnce(game.active.selectSubType)}})},{}],717:[function(e,t,i){"use strict";game.appModule.RouletteTipsPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_timer:null,_list:null,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.RouletteGrid,4)},onShow:function(){this.updatePanel(),b8e.evt.onC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.onC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updatePanel)},onHide:function(){this._list.setData(null),b8e.evt.offC(this._skin.btn_yes,this.onClickYes,this),b8e.evt.offC(this._skin.btn_again,this.onClickAgain,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.updatePanel)},updatePanel:function(){var e=game.roulette.getAwards(!0,game.roulette.isZhuanPan);this._list.show(),this._list.setData(e);var t=game.roulette.getStr(!0);this._skin.lab_desc.string=t},onClickYes:function(){this.hide()},onClickAgain:function(){game.roulette.clickBuyZehnmal(game.active.selectSubType)}})},{}],718:[function(e,t,i){"use strict";game.UpCostBox=game.SkinUI.extends({_data:null,_closeBg:null,_openBg:null,ctor:function(){this._super("roulette/UpCostBoxSkin","UpCostBoxSkin")},init:function(){this._closeBg=b8e.Sprite.get(),this._closeBg.addToParent(this._skin.closeBg),this._openBg=b8e.Sprite.get(),this._openBg.addToParent(this._skin.openBg),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(55005)},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},onTouchThis:function(){var e=game.roulette.getPositions(game.active.selectSubType);e&&-1!=e.indexOf(this._data)||game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_UP_COST,this._data)},setData:function(e){if(this._data=e,this._skin){this._skin.closeBg.active=!1,this._skin.openBg.active=!1;var t=game.roulette.getPositions(game.active.selectSubType);t&&-1!=t.indexOf(this._data)?(this._skin.openBg.active=!0,this._skin.notice.active=!1,this._openBg.loadTexture(game.ClientCfg.getImgUrl("roulette/upCost/open"),null,null,{useManifest:!1})):(this._skin.closeBg.active=!0,this._skin.notice.active=!0,this._closeBg.loadTexture(game.ClientCfg.getImgUrl("roulette/upCost/close"),null,null,{useManifest:!1}))}},getHeight:function(){return 189},getWidth:function(){return 160}})},{}],719:[function(e,t,i){"use strict";game.UpCostPanel=game.SkinUI.extends({_bgSprite:null,_showArr:null,_list:null,_grid:null,_endTimer:null,ctor:function(){this._super("roulette/UpCostSkin","UpCostSkin"),this._showArr=[]},init:function(){this._list=new b8e.List(this._skin.list,game.UpCostBox,game.roulette.upCostMax);var e=game.roulette.getZhuanPanArr();this.setShowArr(e),game.CCommonUtil.createRectGrids(this._showArr,this,this._skin.item,this.onClick,6,3,90,90),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("roulette/upCost/bg"),null,null,{useManifest:!1}),this._skin.lab_must.string=game.ccfg.LangCfg.getText(55001,[game.ccfg.ZhuanPanCostCfg.getPreciousInterval(game.ActiveSubType.ST_ZHUANPAN_UP_COST)])},onShow:function(){this._list.show(),this.updatePanel(),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.onC(this._skin.btn_raffle,this.onClickRaffle,this),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress)},onHide:function(){this._list&&this._list.hide(),this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.btn_recharge,this.onClickRecharge,this),b8e.evt.offC(this._skin.btn_raffle,this.onClickRaffle,this),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateProgress)},updatePanel:function(){this._list.setData(game.roulette.boxIndexArr),this.updateProgress()},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},updateProgress:function(){var e=0,t=0,i=game.roulette.getRaffleCost(game.ActiveSubType.ST_ZHUANPAN_UP_COST),n=game.pay.getConditionsInfo(game.ActivityConditionType.UP_COST_RECHARGE),s=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_UP_COST);if(0<i){n&&(e=(t=n.value)%i),this._skin.progress_bar_node.width=this._skin.progress_mask.width*e/i,this._skin.lab_progress.string=e+"/"+i;var a=i-e;this._skin.lab_pay.string=game.ccfg.LangCfg.getText(55002,[a]);var o=t/i-s>>0;o=0<o?o:0,this._skin.lab_remainCount.string=game.ccfg.LangCfg.getText(55003,[o])}this._skin.lab_count.string=game.ccfg.LangCfg.getText(55004,[game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_UP_COST)])},zhuanPanCallBack:function(){this.updateProgress(),game.roulette.zhuanPanCallBack()},setShowArr:function(e){e&&0<e.length&&(this.setGreatPrize(e[0]),e.splice(0,1),this._showArr=e)},setGreatPrize:function(e){this._grid=game.GridUtil.creatItemGrid(this,this._skin.greatPrize,null,game.ContainerId.LOW_COST_CONTAINER_ID),this._grid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80);var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.itemId,!0);t&&(t.num=e.itemNum,game.GridUtil.setItemGrid(this._grid,t),this._grid.fnOnClick(this,this.onClick),this._grid.setNum(e.itemNum),this._grid.sortLayer())},onClickRecharge:function(){game.pay.showPayPanel()},onClickRaffle:function(){game.roulette.clickBuyZehnmal(game.ActiveSubType.ST_ZHUANPAN_UP_COST)},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)}})},{}],720:[function(e,t,i){"use strict";game.ZhuanPanBianshen=game.SkinUI.extends({_bianshenInfo:null,_anim:null,_rewardBoxes:null,_bg:null,_endTimer:null,ctor:function(){this._super("roulette/ZhuanPanBianshenSkin","ZhuanPanBianshenSkin"),this._rewardBoxes=[],this._bianshenArr=[],this._bsGrids=[]},init:function(){if(!this._bg){this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.node_bg);var e=game.ClientCfg.getImgUrl("bianshen/bianshenDetalilsBg",!0);this._bg.loadTexture(e,null,null,{useManifest:!1}),this._bg.setSize(550,410),this._bg.setAnchor(.5,.5)}this.creatBoxes()},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),this._bianshenArr=game.roulette.getZhuanPanArr(!0),this._bianshenArr&&0<this._bianshenArr.length&&(this._bianshenInfo=game.ccfg.BianshenCfg.getBianshenCfgById(this._bianshenArr[0].itemId)),this.setBSGridInfo(),this.setBianshenData(),this.updatePrice(),this.updateBoxes(),b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.onceBtn,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.tenBtn,this.onClickBuyZehnmal,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},onHide:function(){this._endTimer&&this._endTimer.stop(),this._anim&&this._anim.clear(),this.clearData(),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.onceBtn,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.tenBtn,this.onClickBuyZehnmal,this),b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},updatePrice:function(){game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.active.selectSubType);var e=game.roulette.getZhuanPanCountByType(game.active.selectSubType);this._skin.mineTimes.string="我的抽奖次数:"+e+"次";var t=this.getRouletteBox(game.active.selectSubType);if(t&&0<t.length){for(var i,n=t.length,s=0,a=n-1;0<=a;a--){if((i=t[a])&&e>=i.count){i.count,s=a;break}i.count,a}var o=this._skin.progress_mask.width/(n-1);this._skin.progress_bar_node.width=s*o+0}this._skin.oneNum.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.ONCE_COST),this._skin.tenNum.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.MULTIPLE_COST)},clearData:function(){this._starBar&&this._starBar.clearData()},creatBoxes:function(){var e=this.getRouletteBox(game.active.selectSubType);if(e&&!(e.length<=0))for(var t,i,n=e.length,s=this._skin.progress_mask.width/(n-1),a=0;a<n;a++)(i=e[a])&&((t=new game.RouletteBox).addToParent(this._skin.box),t.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),t.setPosition(s*a,0),t.setData(i),t.setVisible(!0),t.show(),this._rewardBoxes.push(t))},updateBoxes:function(){var e=this.getRouletteBox(game.active.selectSubType);if(e&&!(e.length<=0)&&this._rewardBoxes&&0<this._rewardBoxes.length)for(var t,i=0;i<this._rewardBoxes.length;i++)(t=e[i])&&this._rewardBoxes[i]&&this._rewardBoxes[i].setData(t)},getRouletteBox:function(){var e=game.ccfg.CountAwardCfg.getCountAwardListByType(game.active.selectSubType);if(!e||e.length<=0)return null;var t=0,i=game.active.getSubTypeInfo(game.active.selectSubType);if(i){var n=i.activeIds;n&&0<n.length&&(t=n[0])}var s=0,a=game.ccfg.ActivityCfg.getDataById(t);a&&(s=a.repository);for(var o,r=e.length,h=[],g=0;g<r;g++)(o=e[g])&&o.repository==s&&h.push(o);return h},setBSGridInfo:function(){if(this._bianshenArr&&!(this._bianshenArr.length<=1)){for(var e,t,i,n=this._bsGrids.length,s=this._bianshenArr.length,a=0;a<s&&!(4<a);a++)(e=this._bianshenArr[a])&&(a<n?t=this._bsGrids[a]:(t=game.GridUtil.creatItemGrid(this,this._skin.grids_node,null,game.ContainerId.ROULETTE_CONTAINER_ID,this.onClick),this._bsGrids.push(t)),i=game.ccfg.BianshenCfg.getBianshenCfgById(e.itemId),game.GridUtil.setItemGrid(t,i),t.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),t.setPosition(game.IcoSizeEnum.SIZE_72*a+(game.IcoSizeEnum.SIZE_72>>1)+10*a,0),t.sortLayer());this.onSortLayer()}},onClick:function(e){e&&e.faceInfo&&e.gridInfo&&game.bianshen.showBianshenDetail(e.faceInfo)},onSortLayer:function(){if(this._bsGrids&&!(this._bsGrids.length<=0)){for(var e,t=0,i=0;i<this._bsGrids.length;i++)(e=this._bsGrids[i])&&e.getVisible()&&(t+=game.IcoSizeEnum.SIZE_72+10*i);this._skin.grids_node.x=(556-t>>1)+(game.IcoSizeEnum.SIZE_72>>1)+10}},setBianshenData:function(){if(this._bianshenInfo){this.showModel(),this.setWuxing(this._bianshenInfo.wuxing),this.setSkillInfo(),this.setAttr();var e=game.bianshen.getBianshenCombatByIdx(this._bianshenInfo,this._bianshenInfo.jie);this._skin.lab_combat.string=e,this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.addToParent(this._skin.star_node)),this._starBar.setStarGradeData(this._bianshenInfo.star,this._bianshenInfo.jie,game.StarType.BIANSHEN_DETAILS_STAR),this._starBar.x=~~(this._skin.star_node.width-this._starBar.starWidth)/2,this._starBar.y=0,this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._bianshenInfo.quality),this._bianshenInfo.name)}},showModel:function(){var e=game.ccfg.BianshenCfg.getUiPosterById(this._bianshenInfo.id),t=game.ClientCfg.getUiUnits(e);t?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.BODY,1,-10),this._anim.addToParent(this._skin.model_node)),this._anim.load(t),this._anim.play()):anim&&anim.clear()},setWuxing:function(e){var t="icon_wx_jin";switch(e){case game.BianshenWuxingType.JIN:t="icon_wx_jin","icon_wx_mu";break;case game.BianshenWuxingType.MU:t="icon_wx_mu","icon_wx_tu";break;case game.BianshenWuxingType.SHUI:t="icon_wx_shui","icon_wx_huo";break;case game.BianshenWuxingType.TU:t="icon_wx_tu","icon_wx_shui";break;case game.BianshenWuxingType.HUO:t="icon_wx_huo","icon_wx_jin"}game.resController.setImgSpriteFrame(this._skin.img_wuxing,game.ClientCfg.Bianshen_ALAST_URL,t)},setAttr:function(){var e=game.ccfg.BianshenUpgradeLvCfg.getMaxLv();!(this._bianshenInfo.level<e)&&(this._skin.btn_upgrade.active=!1);var t=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(this._bianshenInfo.level);this._skin.leveLab.string=game.ccfg.LangCfg.getText(10503,[this._bianshenInfo.level]);var i=game.ccfg.BianshenCfg.getAttrById(this._bianshenInfo.id),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i),s=t.attrCoef;s*=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(this._bianshenInfo.jie);for(var a,o="",r=n.getSpriteStats(),h=0;h<r.length;h++)(a=r[h])&&(o=o+game.ccfg.AttrRulesCfg.getAttrNameByType(a.type)+" "+Math.round(a.value*s)+"<br/>");var g=game.ccfg.BianshenCfg.getDataById(this._bianshenInfo.id);g&&(o+=game.ccfg.LangCfg.getText(79251)+" "+g.speed),this._skin.attrRichText.string=o},setSkillInfo:function(){this.setSkill(1),this.setPublicSkill(0)},setSkill:function(e){if(this._bianshenInfo){var t=game.ccfg.HeroCfg.getSpellListById(this._bianshenInfo.id);if(t&&t[e]){var i=game.ccfg.SpellCfg.getSpellById(t[e]);i&&(this.skillIcon||(this.skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_A),this.skillIcon.addToParent(this._skin.icon_skill),this.skillIcon.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this.skillIcon.setPosition(0,-88*(e-1)),this.skillIcon.setData(i.id,!1),this.skillIcon.show()))}else b8e.log("spellList为null或spellList.length<2,变身配置id:"+this._bianshenInfo.id)}},setPublicSkill:function(e){if(this._bianshenInfo){var t=game.ccfg.HeroCfg.getPublicSpellList(this._bianshenInfo.id);if(t&&t[e]){var i=game.ccfg.SpellCfg.getSpellById(t[e]);i&&(this.publicSkillIcon||(this.publicSkillIcon=new game.SkillIcon(game.SkillIconType.TYPE_A),this.publicSkillIcon.addToParent(this._skin.icon_skill),this.publicSkillIcon.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this.publicSkillIcon.setPosition(0,-88*(e+1)),this.publicSkillIcon.setData(i.id,!1),this.publicSkillIcon.show()))}else b8e.log("PublicSpellList为null或PublicSpellList.length<1,变身配置id:"+this._bianshenInfo.id)}},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClickBuyOnce:function(){game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)<game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.ONCE_COST)?game.gameAlert.showVipAlert(!0,101):game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_BIANSHEN)},onClickBuyZehnmal:function(){game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)<game.ccfg.ZhuanPanCostCfg.getCostNum(game.active.selectSubType,game.ZhuanPanCostType.MULTIPLE_COST)?game.gameAlert.showVipAlert(!0,101):game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_BIANSHEN)},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.endTimer.string="剩余时间："+b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.endTimer.string="已结束"},zhuanPanCallBack:function(){game.roulette.zhuanPanCallBack()}})},{}],721:[function(e,t,i){"use strict";game.ZhuanPanGoldPage=game.SkinUI.extends({activebg:null,activeTitleBg:null,remainCount:0,isEnd:!0,posArrayX:null,posArrayY:null,nextPositionArr:null,ctor:function(){this._super("roulette/ZhuanPanGoldSkin","ZhuanPanGoldSkin")},init:function(){this.posArrayX=[],this.posArrayY=[],this.nextPositionArr=[[100,0],[0,-90],[-100,0],[0,90]],this.activebg=b8e.Sprite.get(),this.activebg.setAnchor(.5,.5),this.activebg.addToParent(this._skin.nodeBg),this.activebg.loadTexture("images/image/active/discount/zhuanpanGoldBg.jpg",null,null,{useManifest:!1}),this.activeTitleBg=b8e.Sprite.get(),this.activeTitleBg.setAnchor(.5,.5),this.activeTitleBg.addToParent(this._skin.titlenode),this.activeTitleBg.loadTexture("images/image/active/discount/zhuanpanGold_title.jpg",null,null,{useManifest:!1}),this.showBestPrize(),this.createGrids();var e=game.ccfg.ClientActiveCfg.getDataById(game.ActiveSubType.ST_ZHUANPAN_DIAMOND);e&&(this._skin.activeconet.string=e.des),this._anim=b8e.Animator.get(game.AnimatorType.ROULETTE_EFFECT,1),this._anim.addToParent(this._skin.effect),this._anim.setBlendMode(b8e.BlendMode.ADD)},onShow:function(){this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),b8e.evt.onC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.onC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.onC(this._skin.gotoPayBtn,this.onGotoPay,this),b8e.evt.onC(this._skin.helpBtn,this.onClickWenHao,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),this.updatePanel()},onHide:function(){this._endTimer&&this._endTimer.stop(),b8e.evt.offC(this._skin.getOnePrizeBtn,this.onClickOneEgg,this),b8e.evt.offC(this._skin.getTenPrizeBtn,this.onClickTenEgg,this),b8e.evt.offC(this._skin.gotoPayBtn,this.onGotoPay,this),b8e.evt.offC(this._skin.helpBtn,this.onClickWenHao,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),game.active.selectSubType!=game.ActiveSubType.ST_ZHUANPAN_DIAMOND&&this.runCompleteFun()},updatePanel:function(){if(this._skin){var e=0,t=0,i=game.roulette.getRaffleCost(game.ActiveSubType.ST_ZHUANPAN_DIAMOND),n=game.pay.getConditionsInfo(game.ActivityConditionType.ZHUANPAN_DIAMOND),s=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_DIAMOND);if(0<i){n&&(e=(t=n.value)%i),this._skin.progress.width=350*e/i,this._skin.progressLab.string=e+"/"+i;var a=i-e;this._skin.targetTips.string="再充值"+game.html.getText(game.html.Q_GREEN,a+"元")+"可获得1次抽奖机会";var o,r=t/i-s>>0;o=0<r?"剩余次数："+game.html.getText(game.html.Q_GREEN,r)+"次":"剩余次数："+game.html.getText(game.html.Q_RED,r)+"次",this._skin.timestips.string=o,this.remainCount=r}}},updateEndTime:function(){var e=game.active.selectSubType,t=game.active.getSubTypeInfo(e);if(t){var i=t.endTime-game.SysTime.curTime;0<i?this._skin.time.string=b8e.TimeUtil.formatTime(i):(this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束")}else this._endTimer&&this._endTimer.stop(),this._skin.time.string="已结束"},showBestPrize:function(){var e=game.roulette.getZhuanPanArr(!0),t=e.length;if(e&&0<t){var i=e[0],n=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0);if(n){var s=game.GridUtil.creatItemGrid(this,this._skin.bestItem);s.gridInfo=new game.GridInfo(game.ContainerId.LOW_COST_CONTAINER_ID),s.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),n.num=i.itemNum,game.GridUtil.setItemGrid(s,n),s.fnOnClick(this,this.onClick),s.setNum(i.itemNum),s.setPosition(0,0),s.sortLayer()}}},createGrids:function(){var e,t,i,n,s=0,a=0,o=game.roulette.getZhuanPanArr(),r=o.length;if(o&&0<r){for(var h=0;h<r;h++)i=o[h],(t=game.ccfg.ItemInfoCfg.getItemInfoById(i.itemId,!0))&&((e=game.GridUtil.creatItemGrid(this,this._skin.prizeNode)).gridInfo=new game.GridInfo(game.ContainerId.LOW_COST_CONTAINER_ID),e.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),t.num=i.itemNum,game.GridUtil.setItemGrid(e,t),e.fnOnClick(this,this.onClick),e.setNum(i.itemNum),s+=(n=h<5?this.nextPositionArr[0]:h<8?this.nextPositionArr[1]:h<12?this.nextPositionArr[2]:this.nextPositionArr[3])[0],a+=n[1],e.setPosition(s,a),this.posArrayX.push(s),this.posArrayY.push(a),e.sortLayer());this._marqueeController=new game.Roulette(this,[[5,1]],this.posArrayX,this.posArrayY,this.runingFun,this.runCompleteFun)}},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickOneEgg:function(){this.isEnd&&(this.remainCount<=0?game.notice.show("次数不足"):game.roulette.onReqZhuanPan(1,game.ActiveSubType.ST_ZHUANPAN_DIAMOND))},onClickTenEgg:function(){this.isEnd&&(this.remainCount<10?game.notice.show("次数不足"):game.roulette.onReqZhuanPan(10,game.ActiveSubType.ST_ZHUANPAN_DIAMOND))},onGotoPay:function(){game.pay.showPayPanel()},zhuanPanCallBack:function(){this.updatePanel(),game.roulette.isRunEffect()&&this.startMarquee()},startMarquee:function(){this.isEnd=!1,this.showEffect();var e=game.roulette.zpStopIndex,t=game.roulette.getZhuanPanArr();t&&0<t.length&&(0==e&&(e=t.length),this._marqueeController.run(this._skin.effect,e))},runingFun:function(e){var t=game.roulette.getZhuanPanArr();t&&t.length&&(e==t.length&&(e=0),this._skin.effect.x=this._skin.prizeNode.x+this.posArrayX[e],this._skin.effect.y=this._skin.prizeNode.y+this.posArrayY[e])},runCompleteFun:function(){this.isEnd||(this._anim&&this._anim.setVisible(!1),game.roulette.zhuanPanCallBack(),this.isEnd=!0,this._marqueeController.stop())},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},showEffect:function(){this._anim&&this._anim.setVisible(!0);var e=game.ClientCfg.getUIFxs("10073");e?(this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}})},{}],722:[function(e,t,i){"use strict";e("./event/RouletteEvents"),e("./manager/RouletteMgr"),e("./panel/RouletteDbPanel"),e("./panel/RouletteGrid"),e("./panel/RoulettePanel"),e("./panel/RouletteTipsPanel")},{"./event/RouletteEvents":705,"./manager/RouletteMgr":706,"./panel/RouletteDbPanel":712,"./panel/RouletteGrid":713,"./panel/RoulettePanel":714,"./panel/RouletteTipsPanel":717}],723:[function(e,t,i){"use strict";game.RuneCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Char.RuneBagResponse,this.onRuneBagResponse,this),b8e.addNH(game.pbmid.Char.WearRuneResponse,this.onWearRuneResponse,this),b8e.addNH(game.pbmid.Char.UpgradeRuneResponse,this.onUpgradeRuneResponse,this),b8e.addNH(game.pbmid.Char.UnfixRuneResponse,this.onUnfixRuneResponse,this),b8e.addNH(game.pbmid.Char.ResolveRuneResponse,this.onResolveRuneResponse,this),b8e.addNH(game.pbmid.Char.ConvertRuneResponse,this.onConvertRuneResponse,this),b8e.addNH(game.pbmid.Char.NewRuneNotify,this.onNewRuneNotify,this)},onRuneBagResponse:function(e){var t=e.readProtobuf(game.pbmsg.RuneBagResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.synRuneItemInfo(t.list))},onWearRuneResponse:function(e){var t=e.readProtobuf(game.pbmsg.WearRuneResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.wearRunes(t.runeInfos))},onUnfixRuneResponse:function(e){var t=e.readProtobuf(game.pbmsg.UnfixRuneResponse);if(t)if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{if(!t.runeInfos||!t.runeInfos.length)return;for(var i=0,n=t.runeInfos.length;i<n;i++)game.rune.unfixRune(t.runeInfos[i])}},onUpgradeRuneResponse:function(e){var t=e.readProtobuf(game.pbmsg.UpgradeRuneResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.upgradeRune(t.rune))},onResolveRuneResponse:function(e){var t=e.readProtobuf(game.pbmsg.ResolveRuneResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.resolveRune(t.idx))},onConvertRuneResponse:function(e){var t=e.readProtobuf(game.pbmsg.ConvertRuneResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.convertRune(t.id))},onNewRuneNotify:function(e){var t=e.readProtobuf(game.pbmsg.NewRuneNotify);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.rune.getNewRune(t.list))}})},{}],724:[function(e,t,i){"use strict";game.RuneEvents=b8e.Enum({RUNE_UPDATE:b8e.Event.nextCode(),RUNE_BATE_SELECT_COMPLETE:b8e.Event.nextCode(),RUNE_SELECT_COMPLETE:b8e.Event.nextCode(),RUNE_CONVERT_COMPLETE:b8e.Event.nextCode(),RUNE_ATTR_CHANGE:b8e.Event.nextCode(),RUNE_UNFIX_SUCCESS:b8e.Event.nextCode()})},{}],725:[function(e,t,i){"use strict";game.RuneMgr=b8e.Object.extends({name:"RuneMgr",_runeMap:null,_selectRuneMap:null,_soltRuneMap:null,_resolveBackList:null,_limitArr:null,slotIndex:1,_upgradeInfo:null,nowRuneInfo:null,_powerMap:null,runeSuitAttMap:null,isTowerChange:!1,_remainArr:null,isIntensifying:null,gameAlertInfo:null,_runeTypeMap:null,maxRuneSlotIndex:0,isCanWearRune:!1,isCanUpgrade:!1,_runeTypeArr:null,tempArr:null,isQuickMount:!1,_lastQuickMoutTimeStamp:0,selectRuneSuit:1,canWearRuneSuitFlagArr:null,_runeSuitMap:null,SUIT_ONE:1,SUIT_TWO:2,SUIT_THREE:3,ctor:function(){if(1==game.RuneMgr._singleton)throw new Error("RuneMgr 只能通过单例方法获取");this._super(),this._runeMap=b8e.HashMap.get(),this._selectRuneMap=b8e.HashMap.get(),this._soltRuneMap=b8e.HashMap.get(),this._powerMap=b8e.HashMap.get(),this.runeSuitAttMap=b8e.HashMap.get(),this._runeTypeMap=b8e.HashMap.get(),this._resolveBackList=[],this._limitArr=[],this._remainArr=[],this._runeTypeArr=[],this.canWearRuneSuitFlagArr=[],this._runeSuitMap=b8e.HashMap.get();for(var e=this.SUIT_ONE;e<=this.SUIT_THREE;e++){var t=b8e.HashMap.get();this._runeSuitMap.set(e,t),this.canWearRuneSuitFlagArr.push(!1)}this.init()},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onLevelUp)},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.RUNE)&&(this.isRequest=!0,game.RuneSender.runeBagRequest())},isShowRedPoint:function(){return this.isCanWearRune||this.isCanUpgrade},onLevelUp:function(){game.funcOpen.checkOpen(game.FunctionType.RUNE)&&(this.isRequest||(this.isRequest=!0,game.RuneSender.runeBagRequest()),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onLevelUp))},onMainQuestComplete:function(){game.funcOpen.checkOpen(game.FunctionType.RUNE)&&(this.isRequest||(this.isRequest=!0,game.RuneSender.runeBagRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete))},onMainQuest:function(){game.funcOpen.checkOpen(game.FunctionType.RUNE)&&(this.isRequest||(this.isRequest=!0,game.RuneSender.runeBagRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest))},synRuneItemInfo:function(e){this._runeMap.clear();if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.RuneInfo;n.setup(i),this._runeMap.set(n.idx,n);var s=this._runeSuitMap.get(n.runeSuitId);s&&s.set(n.idx,n)}}b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE)},sendUnfixRune:function(e){var t=[];t.push(e),game.RuneSender.unfixRuneRequest(t)},sendWearRune:function(e,t,i){var n=this._runeMap.get(e);if(n){if((r=this.getRuneSuitRuneArr(t))&&0<r.length)for(var s=0,a=r.length;s<a;s++){var o=this._runeMap.get(r[s].idx);if(o&&o.type==n.type)return void game.notice.show(29015)}var r=[],h=b8e.ProtobufUtil.createMessage(game.pbmsg.Rune);h.idx=e,h.slotIndex=t,h.targetSlot=i,r.push(h),game.RuneSender.wearRuneRequest(r)}else b8e.log("sendWearRune,runeInfo为null")},sendUpgradeRune:function(e){this._runeMap.get(e)?game.RuneSender.upgradeRuneRequest(e):b8e.log("sendUpgradeRune,runeInfo为null")},sendResolveRune:function(){var e=this._selectRuneMap.keys();!e||e.length<=0?game.notice.show(29014):this.secondCheck(e)},secondCheck:function(e){for(var t,i=!1,n=[],s=0,a=e.length;s<a;s++){var o=e[s];(t=this._runeMap.get(o))&&(n.push(parseInt(o)),t.quality>=game.Quality.Q_PURPLE&&(i=!0))}i?(this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo),this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string=game.ccfg.LangCfg.getText(29024),this.gameAlertInfo.obj={idxArr:n},this.gameAlertInfo.isShowTips=!0,game.gameAlert.showAlert(this,this.onClickGameAlert,this.gameAlertInfo)):game.RuneSender.resolveRuneRequest(n)},onClickGameAlert:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.RuneSender.resolveRuneRequest(e.obj.idxArr);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},sendConvertRune:function(e){var t=game.ccfg.RuneCfg.getRuneDataById(e);t&&(this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),game.tower.getInsId()<t.layer?game.notice.show(29022):(this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(t.convertCost),game.upgrade.costCheck(this,this._upgradeInfo,null,!0)&&game.RuneSender.convertRuneRequest(e)))},changeRune:function(e,t){if(game.rune.nowRuneInfo){var i=this._runeMap.get(e);this.delRuneSuitRune(i),this.sendWearRune(t,game.rune.selectRuneSuit,this.slotIndex)}},wearRunes:function(e){if(!e||!e.length||e.length<=0)this.tempArr&&(this.tempArr.length=0);else{if(this.isQuickMount){for(var t=0,i=this.tempArr.length;t<i;t++){if(this.tempArr[t]){var n=this.tempArr[t].idx,s=this._runeMap.get(n);s&&this.delRuneSuitRune(s)}}this.updateRuneAtt(game.rune.selectRuneSuit),this.tempArr.length=0,this.isQuickMount=!1}for(t=0,i=e.length;t<i;t++)game.rune.wearRune(e[t]);this.setIsCanWearRune(),this.setRuneAllPower(),this.updateRuneAtt(game.rune.selectRuneSuit),b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE)}},wearRune:function(e){if(e){var t=this._runeMap.get(e.idx);if(t.runeSuitId!==this.selectRuneSuit&&0<t.targetSlot){var i=t.runeSuitId;this.delRuneSuitRune(t),this.updateRuneAtt(i)}t.setup(e),this._runeMap.set(t.idx,t),this.setRuneSuit(t),game.app.isShow(game.AppConstant.RUNE_SELECT_PANEL)&&game.app.hide(game.AppConstant.RUNE_SELECT_PANEL),game.app.isShow(game.AppConstant.RUNE_TIPS_PANEL)&&game.app.hide(game.AppConstant.RUNE_TIPS_PANEL)}},delRuneSuitRune:function(e){var t=this._runeSuitMap.get(e.runeSuitId);t?(e.runeSuitId=0,e.targetSlot=0,t.del(e.idx)):b8e.error("wearRune 符文套不存在")},setRuneSuit:function(e){var t=this._runeSuitMap.get(e.runeSuitId);t&&t.set(e.idx,e)},getRuneSuitRuneArr:function(e){var t=this._runeSuitMap.get(e);if(t)return t.values();b8e.error("wearRune 符文套不存在")},unfixRune:function(e){if(e){var t=this._runeMap.get(e.idx);if(t){var i=t.runeSuitId;this.slotIndex=t.targetSlot,this.delRuneSuitRune(t),t.setup(e),this._runeMap.set(t.idx,t),this.updateRuneAtt(i),this.setRuneAllPower(),this.setIsCanWearRune(),b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE),b8e.evt.dptG(game.RuneEvents.RUNE_UNFIX_SUCCESS)}}},upgradeRune:function(e){if(e){this.isIntensifying=!0;var t=this._runeMap.get(e.idx),i=t.runeSuitId;t.setup(e),this._runeMap.set(t.idx,t),this.setRuneSuit(t),this.nowRuneInfo=t,game.notice.show(29011),this.setIsCanWearRune(),this.updateRuneAtt(i),this.setRuneAllPower(),b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE)}},resolveRune:function(e){if(!e||e.length<0)b8e.log("resolveRune的参数，itemIdx为null或者itemIdx.length<0");else{for(var t=0;t<e.length;t++){var i=e[t];if(!i)return;this._runeMap.get(i)&&this._runeMap.del(i)}this._selectRuneMap.clear(),game.notice.show(29010),this.setIsCanWearRune(),b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE)}},convertRune:function(e){this.setIsCanWearRune(),b8e.evt.dptG(game.RuneEvents.RUNE_CONVERT_COMPLETE)},setRuneTypeMap:function(e,t){this._runeTypeMap.set(e,t)},getRuneTypeArr:function(e){return this._runeTypeMap.get(e)},getNewRune:function(e){if(e&&!(e.length<0)){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.RuneInfo;n.setup(i),this._runeMap.set(n.idx,n),game.notice.show(1000001,[game.html.getText(game.html.getColorByQuality(n.quality),n.name)])}}this.setIsCanWearRune(),b8e.evt.dptG(game.RuneEvents.RUNE_UPDATE)}},resolveBatchSelect:function(i,e){var n=!1;if(e){if(this._runeMap.forEach(function(e,t){t&&(0<t.runeSuitId||0<t.targetSlot||1<t.level||t.quality==i&&(n=!0,this._selectRuneMap.set(t.idx,t)))},this),!n)switch(i){case game.Quality.Q_GREEN:game.notice.show(29006);break;case game.Quality.Q_BLUE:game.notice.show(29007);break;case game.Quality.Q_PURPLE:game.notice.show(29008);break;case game.Quality.Q_YELLOW:game.notice.show(29009)}}else this._selectRuneMap.forEach(function(e,t){t&&t.quality==i&&this._selectRuneMap.del(t.idx)},this);b8e.evt.dptG(game.RuneEvents.RUNE_BATE_SELECT_COMPLETE)},resolveSelect:function(e){var t=this._selectRuneMap.get(e);t?this._selectRuneMap.del(e):(t=this._runeMap.get(e))&&this._selectRuneMap.set(e,t),b8e.evt.dptG(game.RuneEvents.RUNE_SELECT_COMPLETE)},clearResolveSelect:function(){this._selectRuneMap.clear()},canIntensify:function(e){var t,i=game.ccfg.RuneCfg.getRuneDataBIL(e.group,e.level+1);if(!i)return!1;var n=game.ccfg.RuneCfg.getUpgradeInfoByType(i.id,!0);t=1==e.level?game.ccfg.RuneCfg.getUpgradeInfoByType(i.id,!1):game.ccfg.RuneCfg.getUpgradeInfoByType(e.id,!1);var s=game.rune.getRuneEssence(t);return n<=s&&0!=s},showRuneTips:function(e,t){game.app.show(game.AppConstant.RUNE_TIPS_PANEL,{containerId:t,runeInfo:e})},showIntensifyPanel:function(e){this.nowRuneInfo=e,game.app.show(game.AppConstant.RUNE_INTENSITY_PANEL)},showSelectPanel:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.nowRuneInfo=e,game.app.show(game.AppConstant.RUNE_SELECT_PANEL)},isOpenSlotBySlot:function(e){var t=game.tower.getInsId();return this.getLimitBySlotId(e)<=t},changeSlots:function(){this.isTowerChange=!0},getUnsetRune:function(){var e;this._remainArr.length=0;for(var t=game.rune.getBackRune(),i=0;i<t.length;i++)0===(e=t[i]).runeSuitId&&0===e.targetSlot&&this._remainArr.push(e);return this._remainArr},setRuneAtt:function(e){this.getRuneAttMap(e)||this.updateRuneAtt(e)},updateRuneAtt:function(e){if(0!=e){var t,i,n,s,a,o=this.getRuneAttMap(e);o||(o=b8e.HashMap.get()),o.clear();var r=this.getRuneSuitRuneArr(e);if(r||0!=r.length){for(var h=0,g=r.length;h<g;h++){var l=r[h];if(i=game.ccfg.RuneCfg.getRuneAttrById(l.id),(s=game.ccfg.SpriteStatCfg.getSpriteStatById(i))&&(a=s.getSpriteStats())&&!(a.length<=0))for(var c=0;c<a.length;c++)(n=a[c])&&((t=o.get(n.type))?t.value+=n.value:o.set(n.type,n))}this.runeSuitAttMap.set(e,o),b8e.evt.dptG(game.RuneEvents.RUNE_ATTR_CHANGE)}}},getRuneAttMap:function(e){return this.runeSuitAttMap.get(e)},getRuneAllPower:function(){return this._powerMap.get(game.rune.selectRuneSuit)||this.setRuneAllPower(),this._powerMap.get(game.rune.selectRuneSuit)},setRuneAllPower:function(){for(var e,t=0,i=this.getRuneSuitRuneArr(this.selectRuneSuit),n=0;n<i.length;n++)e=i[n],t+=this.getRunePower(e.id);this._powerMap.set(this.selectRuneSuit,t)},getAttrStrById:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.ccfg.RuneCfg.getRuneAttrById(e),n=game.ccfg.SpriteStatCfg.getSpriteStatById(i);return this.getSpriteStatAttrStr(n,!0,t)},getRunePower:function(e){var t,i=game.mainRole.mainRoleData.getLv(),n=game.ccfg.RuneCfg.getRuneAttrById(e),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n);return s&&(t=game.CCommonUtil.getPower(s,i)),t},getSpriteStatAttrStr:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n="",s="",a="";if(e){var o=e.getSpriteStats();if(o&&0<o.length)for(var r=0;r<o.length;r++){var h=o[r];if(h){var g=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(h.type),l=h.value;if(g)switch(g.format){case game.AttrRulesFormat.FORMAT_1:l=h.value;break;case game.AttrRulesFormat.FORMAT_2:l=game.ValueUtil.getDigitsValueByNum(100*h.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:l=game.ValueUtil.getDigitsValueByNum(100*h.value,2)}s=game.ccfg.AttrRulesCfg.getAttrNameByType(h.type),r!=o.length-1&&(a="\n"),n=t?s+game.html.getText(game.html.Q_GREEN," +"+l)+a:game.html.getText(game.html.Q_GREEN," +"+l)+a,i&&(n="     "+n)}}}return n},setRuneInfoBySlot:function(e){if(e&&0<e.length){var t;this._soltRuneMap.clear();for(var i=0;i<e.length;i++)t=this.getRuneInfoById(e[i]),this._soltRuneMap.set(t.targetSlot,t)}},setRuneSuitInfo:function(e){var t=this._runeSuitMap.get(e);if(t){var i=this;t.forEach(function(e,t){i._soltRuneMap.set(t.targetSlot,t)},this)}else b8e.error("wearRune 符文套不存在")},getRuneInfoBySlot:function(e){return this._soltRuneMap.get(e)},getLimitBySlotId:function(e){if(this._limitArr&&0==this._limitArr.length){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.RUNE_SLOT_LIMIT);this._limitArr=t.split("|")}return 0|+this._limitArr[e-1]},getRuneEssence:function(e){return game.back.getItemInfoCountById(e)},getRuneInfoById:function(e){var t=this._runeMap.get(e);return t||null},getIsSelectByIdx:function(e){return!!this._selectRuneMap.get(e)},getResolveBackList:function(){return this._resolveBackList.length=0,this._runeMap.forEach(function(e,t){t&&(0<t.runeSuitId||0<t.targetSlot||this._resolveBackList.push(t))},this),this._resolveBackList},getSelectRune:function(){return this._selectRuneMap.keys()},getBackRune:function(){return this._runeMap.values()},setIsCanWearRune:function(){this.isCanWearRune=!1,this.isCanUpgrade=!1,this.isCanWearRune=this.hasSuitCanWearRune(),b8e.evt.dptG(game.BianshenEvent.UPDATE_BACK),b8e.evt.dptG(game.BianshenEvent.SPOT_ALERT_STATE_CHANGE)},hasSuitCanWearRune:function(){var n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],s=!1,a=this,o=this.getUnsetRune();return o.sort(this.sortByQualityThenLV),this._runeSuitMap.forEach(function(e,t){var i=a.getRuneAlertById(0|e,o,n);s=!!i||s},this),s},setUnLockRuneSlot:function(){var e=game.tower.getInsId();if(this._limitArr&&0==this._limitArr.length){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.RUNE_SLOT_LIMIT);this._limitArr=t.split("|")}for(var i=this._limitArr.length,n=0;n<i;n++)e>=(0|this._limitArr[n])&&(this.maxRuneSlotIndex=n+1)},getRuneUpgradeAlertById:function(e){var t=this.getRuneSuitRuneArr(e);if(!t)return!1;for(var i=null,n=t.length,s=0;s<n;s++)if((i=t[s])&&this.canIntensify(i))return!0;return!1},getRuneAlertById:function(e,t){!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.canWearRuneSuitFlagArr[e-1]=!1,this._runeTypeArr.length=0;var i,n,s=b8e.HashMap.get(),a=!1,o=this.getRuneSuitRuneArr(e),r=null;for(n=o.length,i=0;i<n;i++)(r=o[i])&&(this.canIntensify(r)&&!this.isCanUpgrade&&(this.isCanUpgrade=!0),s.set(r.type,r.idx),this._runeTypeArr.push(r.type));if(t||(t=this.getUnsetRune())&&0<t.length&&t.sort(this.sortByQualityThenLV),t&&0<t.length){var h=b8e.HashMap.get(),g=t.length,l=0;for(i=0;i<g;i++){r=t[i];if(!h.get(r.type)&&(h.set(r.type,r),l++,s.has(r.type)&&!a)){var c=s.get(r.type),u=this._runeMap.get(c);if(!u)continue;if(u.quality<r.quality){a=!0,this.canWearRuneSuitFlagArr[e-1]=!0;break}if(u.quality===r.quality&&u.level<r.level){a=!0,this.canWearRuneSuitFlagArr[e-1]=!0;break}}if(l>=game.RuneGroupType.WUXING_DMG_REDUCTION)break}if(h.release(),s.release(),a)return!0;if(this.maxRuneSlotIndex>n&&n<l)return a=!0,this.canWearRuneSuitFlagArr[e-1]=!0}return!1},quickMountRune:function(e){var t=game.SysTime.curTime;if(t-this._lastQuickMoutTimeStamp<1e3)game.notice.show(game.ClientCfg.opt_too_quick);else{this._lastQuickMoutTimeStamp=t;var i=game.rune.getUnsetRune();if(i){var n=0,s=b8e.HashMap.get(),a=this.getRuneSuitRuneArr(e);this.tempArr?this.tempArr.length=0:this.tempArr=[];for(var o=0,r=a.length;o<r;o++){var h=a[o].idx;(c=this._runeMap.get(h))&&(i.push(c),s.set(c.type,c.type),this.tempArr.indexOf(c)<0&&this.tempArr.push(c))}i.sort(this.sortByQualityThenLV);var g=b8e.HashMap.get(),l=[];for(o=0,r=i.length;o<r;o++){var c=i[o];if(g.get(c.type)||(g.set(c.type,c),n++,l.push(c)),n>=game.RuneGroupType.WUXING_DMG_REDUCTION)break}for(var u=[],m=[],_=[],d=(r=l.length<7?l.length:7,r=Math.min(this.maxRuneSlotIndex,r),o=0,l.length);o<d;o++){c=l[o];s.has(c.type)?u.push(c):m.push(c)}g.release(),s.release();var f=u.length,p=0,S=0,T=[];for(o=0;o<r;o++){c=null;o<f?(c=u[p],p++):(c=m[S],S++),c&&T.push(c)}if(T&&0<T.length){T.sort(this.sortByQualityThenLV);for(o=0,d=T.length;o<d;o++)if(T[o]){var I=T[o].idx,v=b8e.ProtobufUtil.createMessage(game.pbmsg.Rune);v.idx=I,v.slotIndex=this.selectRuneSuit,v.targetSlot=o+1,_.push(v)}}var A=_.length,C=!0;if(A===a.length)for(o=0,r=A;o<r;o++){var E=T[o];if(-1===a.indexOf(E)){C=!1;break}}else C=!1;C?game.notice.show(game.ClientCfg.rune_was_best):(this.isQuickMount=!0,!_||_.length<=0?game.notice.show(game.ClientCfg.rune_has_no_rune_wear):game.RuneSender.wearRuneRequest(_))}}},sortByQualityThenLV:function(e,t){return e.quality<t.quality?1:e.quality>t.quality?-1:e.level>t.level?-1:e.level<t.level?1:e.idx<t.idx?-1:e.idx>t.idx?1:0},quickUnmountRune:function(e){var t=this.getRuneSuitRuneArr(e),i=[];if(t&&0<t.length){for(var n=0,s=t.length;n<s;n++){var a=t[n].idx;i.push(a)}game.RuneSender.unfixRuneRequest(i)}}}),game.RuneMgr._instance=null,game.RuneMgr.inst=function(){return game.RuneMgr._instance||(game.RuneMgr._instance=new game.RuneMgr),game.RuneMgr._instance}},{}],726:[function(e,t,i){"use strict";game.RuneArchiveItem=game.SkinUI.extends({_runeInfo:null,_itemGrid:null,_runeCfg:null,ctor:function(){this._super("rune/RuneArchiveItemSkin","RuneArchiveItemSkin")},onShow:function(){this.setData(this._runeCfg)},onHide:function(){},getWidth:function(){return 135},getHeight:function(){return 175},setData:function(e){(this._runeCfg=e,this._runeCfg)&&(this._skin&&(this._runeInfo||(this._runeInfo=new game.RuneInfo),this._runeInfo.setupByCfg(this._runeCfg),this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.CSARENA_DECOMPOSE_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.addToParent(this._skin.icon)),game.GridUtil.setRuneGrid(this._itemGrid,this._runeInfo,!1,!1,!1,!1),this._itemGrid.sortLayer(),this._skin.lab_name.string=game.html.getText(game.html.getColorByQuality(this._runeInfo.quality),this._runeInfo.name),game.tower.getInsId()>=this._runeInfo.layer?this._skin.lab_unlock.node.active=!1:(this._skin.lab_unlock.node.active=!0,this._skin.lab_unlock.string=game.ccfg.LangCfg.getText(29023,[Math.ceil(this._runeInfo.layer/6)]))))},onClick:function(e){e&&e.faceInfo&&game.rune.showRuneTips(e.faceInfo,game.ContainerId.CSARENA_ILLUSTRATION_CONTAINER_ID)},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],727:[function(e,t,i){"use strict";game.RuneArchivePanel=game.SkinUI.extends({_runeLayerList:null,ctor:function(){this._super("rune/RuneArchiveSkin","RuneArchiveSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.RuneArchiveItem,4)},sort:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},onShow:function(){this._list.show(),this.updateList()},updateList:function(){this._runeLayerList=game.ccfg.RuneCfg.getLayerMap(),this._runeLayerList&&0<this._runeLayerList.length&&this._runeLayerList.sort(this.sort),this._list.setData(this._runeLayerList)},onHide:function(){this._list&&this._list.hide()},onClick:function(e){game.rune.showRuneTips(e.faceInfo,game.ContainerId.CSARENA_ILLUSTRATION_CONTAINER_ID)}})},{}],728:[function(e,t,i){"use strict";game.RuneBagPanel=game.SkinUI.extends({_runeList:null,back_count:0,ctor:function(){this._super("rune/RuneBagSkin","RuneBagSkin")},init:function(){this._runeList=[],this._list=new b8e.List(this._skin.list,game.RunePackGrid,5)},onShow:function(){this._list.show(),this.updateBack(),b8e.evt.onC(this._skin.node_archive,this.clickAchive,this),b8e.evt.onC(this._skin.btn_decompose,this.clickDecompose,this),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.updateBack)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.node_archive,this.clickAchive,this),b8e.evt.offC(this._skin.btn_decompose,this.clickDecompose,this),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.updateBack)},updateBack:function(){this._runeList=game.rune.getBackRune(),this._skin.lab_tip.node.active=!0,this._runeList&&0<this._runeList.length&&(this._skin.lab_tip.node.active=!1),this._runeList.sort(this.sort),this._list.setData(this._runeList,!0),this.back_count=this._runeList?this._runeList.length:0,this._skin.back_count.string=this.back_count+"/"+game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.MAX_RUNE_BACK_COUNT)},sort:function(e,t){return 0<e.runeSuitId&&0===t.runeSuitId?-1:0===e.runeSuitId&&0<t.runeSuitId?1:e.quality>t.quality?-1:e.quality<t.quality?1:e.level>t.level?-1:e.level<t.level?1:e.id>t.id?-1:e.id<t.id?1:0},clickAchive:function(){game.app.show(game.AppConstant.RUNE_SHOW_PANEL)},clickDecompose:function(){game.app.show(game.AppConstant.RUNE_DECOMPOSE_PANEL)}})},{}],729:[function(e,t,i){"use strict";game.RuneConvertItem=game.SkinUI.extends({_runeInfo:null,_itemGrid:null,_sprite:null,_cfg:null,_upgradeInfo:null,ctor:function(){this._super("rune/RuneConvertItemSkin","RuneConvertItemSkin")},getWidth:function(){return 180},getHeight:function(){return 275},init:function(){this._sprite=b8e.Sprite.get(),this._sprite.addToParent(this._skin.icon),this._sprite.setScale(.4,.4)},onShow:function(){this.setData(this.data),b8e.evt.onC(this._skin.btn_convert,this.clickConvert,this)},onHide:function(){b8e.evt.offC(this._skin.btn_convert,this.clickConvert,this),this._sprite.unloadTexture()},setData:function(e){e&&(this.data=e,this._skin&&(this._runeInfo||(this._runeInfo=new game.RuneInfo),this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.addToParent(this._skin.runeIcon)),this._cfg=game.ccfg.RuneCfg.getRuneDataById(this.data),this._cfg&&(this._runeInfo.setupByCfg(this._cfg),game.GridUtil.setRuneGrid(this._itemGrid,this._runeInfo,!1,!0),this._itemGrid.sortLayer(),game.tower.getInsId()>=this._runeInfo.layer?(this._skin.btn_convert.active=!0,this._skin.lab_layer.node.active=!1):(this._skin.btn_convert.active=!1,this._skin.lab_layer.node.active=!0,this._skin.lab_layer.string=game.ccfg.LangCfg.getText(29005,[Math.ceil(this._runeInfo.layer/6)])),this.updateConvertCost())))},updateConvertCost:function(){if(this._cfg&&this._cfg.convertCost&&!(this._cfg.convertCost.length<0)){var e=game.ccfg.ItemInfoCfg.getItemInfoById(this._cfg.convertCost[0].Id);if(e){var t=e.iconName;this._sprite.loadTexture(game.ClientCfg.getImgUrl(t,!1),null,null,{useManifest:!1}),this._skin.lab_cost.string=this._cfg.convertCost[0].Num+"",this._upgradeInfo||(this._upgradeInfo=new game.UpgradeInfo),this._upgradeInfo.clear(),this._upgradeInfo.setUpgradeInfo(this._cfg.convertCost);var i=!1;switch(e.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.CONTRIBUTION:case game.AmountType.HONOUR:i=game.upgrade.costCheckMoney(e.type,this._cfg.convertCost[0].Num);break;default:i=game.upgrade.isHasEnoughItem(this._upgradeInfo)}i?b8e.ShaderUtil.reset(this._skin.btn_convert):b8e.ShaderUtil.setGray(this._skin.btn_convert)}}},clickConvert:function(){this._cfg&&game.rune.sendConvertRune(this._cfg.id)},onClick:function(e){game.rune.showRuneTips(e.faceInfo,game.ContainerId.RUNE_CONVERTITEM_CONTAINER_ID)}})},{}],730:[function(e,t,i){"use strict";game.RuneConvertPanel=game.SkinUI.extends({_convertList:null,_sprite:null,_costConvertId:null,_str:null,_num:0,ctor:function(){this._super("rune/RuneConvertSkin","RuneConvertSkin"),this._convertList=[]},init:function(){this._list=new b8e.List(this._skin.list,game.RuneConvertItem,3),this._sprite=b8e.Sprite.get(),this._sprite.addToParent(this._skin.icon),this._sprite.setScale(.4,.4)},onShow:function(){this._list.show(),this.updataList(),this.updateCostConvert(),b8e.evt.onC(this._skin.lab_get.node,this.clickGetAway,this),b8e.evt.addG(this,game.RuneEvents.RUNE_CONVERT_COMPLETE,this.updataAll),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostConvert)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.lab_get.node,this.clickGetAway,this),b8e.evt.rmvG(this,game.RuneEvents.RUNE_CONVERT_COMPLETE,this.updataAll),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCostConvert)},updataAll:function(){this.updataList(),this.updateCostConvert()},updataList:function(){this._convertList=game.ccfg.RuneCfg.getConvertList(),this._list.setData(this._convertList)},updateCostConvert:function(){this._costConvertId=game.ccfg.RuneCfg.getCostConvertItemId();var e=game.ccfg.ItemInfoCfg.getItemInfoById(this._costConvertId);if(e){var t=e.iconName;this._sprite.loadTexture(game.ClientCfg.getImgUrl(t,!1),null,null,{useManifest:!1})}var i=game.back.getAmountInfo();switch(this._skin.lab_name.string=e.name,e.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.CONTRIBUTION:case game.AmountType.HONOUR:var n=i.getValue(e.type);this._num=n,this._str=game.ValueUtil.formatNumber(n,0,!1,!1,!1,!1);break;default:this._str=game.back.getItemInfoCountById(this._costConvertId),this._num=this._str}this._skin.lab_have.string=this._str+""},clickGetAway:function(){game.upgrade.isOpenGoToPanel(this._costConvertId,this._num)}})},{}],731:[function(e,t,i){"use strict";game.RuneDecomposeGrid=b8e.BaseDisplay.extends({_runeInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getWidth:function(){return 105},getHeight:function(){return 130},setData:function(e){if(this._runeInfo=e,this._runeInfo){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.CSARENA_DECOMPOSE_CONTAINER_ID),this.addChild(this._itemGrid)),this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setRuneGrid(this._itemGrid,this._runeInfo,!1);var t=game.rune.getIsSelectByIdx(this._runeInfo.idx);this._itemGrid.setImgSelect(t),this._itemGrid.sortLayer()}},onClick:function(e){if(e&&e.faceInfo){game.rune.resolveSelect(e.faceInfo.idx);var t=game.rune.getIsSelectByIdx(e.faceInfo.idx);e.setImgSelect(t)}},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],732:[function(e,t,i){"use strict";game.appModule.RuneDecomposePanel=game.SkinUIPanel.extends({_runeList:null,_selectIdList:null,_resolveIdList:null,_sprite1:null,_sprite2:null,_locked:!1,_greenSelect:!1,_blueSelect:!1,_purpleSelect:!1,_yellowSelect:!1,ctor:function(e){this._super(e),this._runeList=[],this._selectIdList=[],this._resolveIdList=[]},init:function(){this._list=new b8e.List(this._skin.list,game.RuneDecomposeGrid,5),this._sprite1=b8e.Sprite.get(),this._sprite1.addToParent(this._skin.icon1),this._sprite1.setScale(.4,.4),this._sprite2=b8e.Sprite.get(),this._sprite2.addToParent(this._skin.icon2),this._sprite2.setScale(.4,.4)},onShow:function(){var e;(this._list.show(),this._resolveIdList=game.ccfg.RuneCfg.getResolveIdList(),this._resolveIdList&&0<this._resolveIdList.length)?(this._resolveIdList[0]&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(this._resolveIdList[0]))&&this._sprite1.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._resolveIdList[1]&&(e=game.ccfg.ItemInfoCfg.getItemInfoById(this._resolveIdList[1]))&&this._sprite2.loadTexture(game.ClientCfg.getImgUrl(e.iconName,!1),null,null,{useManifest:!1}),this._skin.lab_num1.node.active=!!this._resolveIdList[0],this._skin.lab_num2.node.active=!!this._resolveIdList[1]):(this._skin.lab_num1.node.active=!1,this._skin.lab_num1.node.active=!1);game.rune.clearResolveSelect(),this.resetSelectBtn(),this.updateRuneList(),this.updateGet(),this._locked=!1,b8e.evt.onC(this._skin.button[0],this.onClickGreenBtn,this),b8e.evt.onC(this._skin.button[1],this.onClickBlueBtn,this),b8e.evt.onC(this._skin.button[2],this.onClickPurpleBtn,this),b8e.evt.onC(this._skin.button[3],this.onClickYellowBtn,this),b8e.evt.onC(this._skin.btn_decompose,this.onClickDecompose,this),b8e.evt.addG(this,game.RuneEvents.RUNE_BATE_SELECT_COMPLETE,this.updataAll),b8e.evt.addG(this,game.RuneEvents.RUNE_SELECT_COMPLETE,this.updateGet),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.updataAll)},onHide:function(){this._list&&this._list.hide(),game.rune.clearResolveSelect(),this.resetSelectBtn(),this._locked=!1,b8e.evt.offC(this._skin.button[0],this.onClickGreenBtn,this),b8e.evt.offC(this._skin.button[1],this.onClickBlueBtn,this),b8e.evt.offC(this._skin.button[2],this.onClickPurpleBtn,this),b8e.evt.offC(this._skin.button[3],this.onClickYellowBtn,this),b8e.evt.offC(this._skin.btn_decompose,this.onClickDecompose,this),b8e.evt.rmvG(this,game.RuneEvents.RUNE_BATE_SELECT_COMPLETE,this.updataAll),b8e.evt.rmvG(this,game.RuneEvents.RUNE_SELECT_COMPLETE,this.updateGet),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.updataAll)},updataAll:function(){this.updateRuneList(),this.updateGet()},updateRuneList:function(){this._runeList=game.rune.getResolveBackList(),this._runeList.sort(this.sort),this._list.setData(this._runeList)},sort:function(e,t){return e.quality>t.quality?-1:e.quality<t.quality?1:e.level>t.level?-1:e.level<t.level?1:e.id<t.id?-1:e.id>t.id?1:0},updateGet:function(){this._selectIdList=game.rune.getSelectRune();var e,t=0,i=0;if(this._selectIdList&&0<this._selectIdList.length)for(var n=0;n<this._selectIdList.length;n++){var s=game.rune.getRuneInfoById(this._selectIdList[n]);if(s){if(!(e=game.ccfg.RuneCfg.getRuneResolveById(s.id))||e.length<=0)return;e[0]&&(t+=e[0].Num),e[1]&&(i+=e[1].Num)}}this._skin.lab_num1.string=t+"",this._skin.lab_num2.string=i+""},onClickGreenBtn:function(){this._locked?this._skin.buttonSelect[0].active=this._greenSelect:(this._greenSelect=!this._greenSelect,this.setSelect(0,this._greenSelect))},onClickBlueBtn:function(){this._locked?this._skin.buttonSelect[1].active=this._blueSelect:(this._blueSelect=!this._blueSelect,this.setSelect(1,this._blueSelect))},onClickPurpleBtn:function(){this._locked?this._skin.buttonSelect[2].active=this._purpleSelect:(this._purpleSelect=!this._purpleSelect,this.setSelect(2,this._purpleSelect))},onClickYellowBtn:function(){this._locked?this._skin.buttonSelect[2].active=this._yellowSelect:(this._yellowSelect=!this._yellowSelect,this.setSelect(3,this._yellowSelect))},onClickDecompose:function(){game.rune.sendResolveRune()},setSelect:function(e,t){this.setLockTime();var i=game.Quality.Q_GREEN;switch(e){case 0:i=game.Quality.Q_GREEN,this._skin.buttonSelect[0].active=t;break;case 1:i=game.Quality.Q_BLUE,this._skin.buttonSelect[1].active=t;break;case 2:i=game.Quality.Q_PURPLE,this._skin.buttonSelect[2].active=t;break;case 3:i=game.Quality.Q_YELLOW,this._skin.buttonSelect[3].active=t;break;default:i=game.Quality.Q_GREEN,this._skin.buttonSelect[0].active=t}game.rune.resolveBatchSelect(i,t)},setLockTime:function(){this._locked=!0,b8e.Tween.kill(this),b8e.Tween.get(this).wait(500).call(this.lock)},lock:function(){this._locked=!1},resetSelectBtn:function(){this._greenSelect=!1,this._blueSelect=!1,this._purpleSelect=!1,this._yellowSelect=!1,this._skin.buttonSelect[0].active=!1,this._skin.buttonSelect[1].active=!1,this._skin.buttonSelect[2].active=!1,this._skin.buttonSelect[3].active=!1}})},{}],733:[function(e,t,i){"use strict";game.appModule.RuneIntensifyPanel=game.SkinUIPanel.extends({_costSprite:null,_haveSprite:null,_runeInfo:null,_itemGridLeft:null,_itemGridRight:null,_cfg:null,_anim1:null,ctor:function(e){this._super(e)},init:function(){this._costSprite||(this._costSprite=b8e.Sprite.get(),this._costSprite.addToParent(this._skin.icon1),this._costSprite.setSize(30,30)),this._haveSprite||(this._haveSprite=b8e.Sprite.get(),this._haveSprite.addToParent(this._skin.icon2),this._haveSprite.setSize(30,30))},onShow:function(){game.rune.isIntensifying=!1,this.updatePanel(),b8e.evt.onC(this._skin.btn_intensify,this.onClickIntensify,this),b8e.evt.onC(this._skin.lab_get.node,this.onClickGetRune,this),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.updatePanel),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.playEffect),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updatePanel)},onHide:function(){game.rune.isIntensifying=!1,b8e.evt.offC(this._skin.btn_intensify,this.onClickIntensify,this),b8e.evt.offC(this._skin.lab_get.node,this.onClickGetRune,this),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.updatePanel),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.playEffect),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updatePanel)},updatePanel:function(){this._runeInfo=game.rune.nowRuneInfo,this._itemGridLeft||(this._itemGridLeft=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGridLeft.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGridLeft.addToParent(this._skin.node_icon1)),game.GridUtil.setRuneGrid(this._itemGridLeft,this._runeInfo,!1,!1,!1,!1,!1),this._itemGridLeft.sortLayer();var e=0;this._skin.lab_name1.string=this._runeInfo.name,this._skin.lab_lv1.string=game.ccfg.LangCfg.getText(4e4,[this._runeInfo.level]),this._skin.lab_attr1.string=game.rune.getAttrStrById(this._runeInfo.id),this._skin.lab_power1.string=game.rune.getRunePower(this._runeInfo.id),this._skin.lab_cost.string=e,this._skin.lab_max.string="";var t,i=game.ccfg.RuneCfg.getMaxLvByGroup(this._runeInfo.group),n=!(this._runeInfo.level<i);if(this._skin.btn_intensify.active=!n,this._skin.node_right.active=!n,this._skin.img_row.active=!n,this._runeInfo.level<i){this._skin.node_left.x=243;var s=game.ccfg.RuneCfg.getRuneDataBIL(this._runeInfo.group,this._runeInfo.level+1);this._skin.lab_name2.string=s.name,this._skin.lab_lv2.string=game.ccfg.LangCfg.getText(4e4,[this._runeInfo.level+1]),this._skin.lab_attr2.string=game.rune.getAttrStrById(s.id),this._skin.lab_power2.string=game.rune.getRunePower(s.id),e=game.ccfg.RuneCfg.getUpgradeInfoByType(s.id,!0),this._itemGridRight||(this._itemGridRight=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGridRight.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGridRight.addToParent(this._skin.node_icon2)),game.GridUtil.setRuneGrid(this._itemGridRight,s,!1,!1,!1,!1,!1),this._itemGridRight.sortLayer()}else this._skin.node_left.x=380,this._skin.lab_max.string=game.ccfg.LangCfg.getText(29017);t=1==this._runeInfo.level?game.ccfg.RuneCfg.getUpgradeInfoByType(s.id,!1):game.ccfg.RuneCfg.getUpgradeInfoByType(this._runeInfo.id,!1);var a=game.ccfg.ItemInfoCfg.getIconNameById(t);a&&(this._costSprite.loadTexture(game.ClientCfg.getImgUrl(a),null,null,{useManifest:!1}),this._haveSprite.loadTexture(game.ClientCfg.getImgUrl(a),null,null,{useManifest:!1}));var o=game.rune.getRuneEssence(t);this._skin.lab_have.string=o+"",this._skin.lab_cost.string=e+"",this._skin.lab_have.string=o<e&&0!=e?game.html.getText(game.html.Q_RED,o):game.html.getText(game.html.Q_WHITE,o)},onClickIntensify:function(){game.rune.sendUpgradeRune(this._runeInfo.idx)},onClickGetRune:function(){game.TriggerMgr&&game.TriggerMgr.inst().customTriggerById(3155)},playEffect:function(){var e=game.ClientCfg.getUIFxs("10002");e?(this._anim1||(this._anim1=b8e.Animator.get(game.AnimatorType.RUNE_INTENSIFY_EFFECT,1),this._anim1.addToParent(this._skin.effect1)),this._anim1.setVisible(!0),this._anim1.load(e),this._anim1.addFinishCallback(this.onCompleteEffect,this),this._anim1.play(null,0)):this._anim1&&this._anim1.clear()},onCompleteEffect:function(e){game.rune.isIntensifying=!1,this._anim1.setVisible(!1)}})},{}],734:[function(e,t,i){"use strict";game.RuneItem=game.SkinUI.extends({_data:null,_cfg:null,ctor:function(e){this._super("rune/RuneItemSkin","RuneItemSkin"),this._data=e},getWidth:function(){return 545},getHeight:function(){return 120},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.btn_inlay,this.onClickInlay,this)},onHide:function(){b8e.evt.offC(this._skin.btn_inlay,this.onClickInlay,this)},setData:function(e){this._data=e,this._skin&&this._data&&(this._itemGridLeft||(this._itemGridLeft=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGridLeft.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGridLeft.addToParent(this._skin.node_icon)),this._cfg=game.ccfg.RuneCfg.getRuneDataById(e.id),this._cfg&&(e.setupByCfg(this._cfg),game.GridUtil.setRuneGrid(this._itemGridLeft,e,!1,!1,!1,!1),this._itemGridLeft.sortLayer(),game.rune.nowRuneInfo&&e.idx==game.rune.nowRuneInfo.idx?(this._skin.lab_init.string=game.ccfg.LangCfg.getText(29018),this._skin.btn_inlay.active=!1):(this._skin.lab_init.string="",this._skin.btn_inlay.active=!0),this._skin.lab_name.string=e.name,this._skin.lab_lv.string=game.ccfg.LangCfg.getText(4e4,[e.level]),this._skin.lab_attr.string=game.rune.getAttrStrById(e.id),this._skin.lab_power.string=game.rune.getRunePower(e.id)))},onClickInlay:function(){game.rune.nowRuneInfo?game.rune.changeRune(game.rune.nowRuneInfo.idx,this._data.idx):game.rune.sendWearRune(this._data.idx,game.rune.selectRuneSuit,game.rune.slotIndex)}})},{}],735:[function(e,t,i){"use strict";game.RunePackGrid=b8e.BaseDisplay.extends({_runeInfo:null,_itemGrid:null,ctor:function(){this._super()},show:function(){},hide:function(){},getWidth:function(){return 90},getHeight:function(){return 90},setData:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this._runeInfo=e,this._runeInfo&&(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this.addChild(this._itemGrid)),t&&this._itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setRuneGrid(this._itemGrid,this._runeInfo,!1),this._itemGrid.sortLayer())},onClick:function(e){game.rune.showRuneTips(e.faceInfo,game.ContainerId.BACK_CONTAINER_ID)},getItemGrid:function(){return this._itemGrid?this._itemGrid:null}})},{}],736:[function(e,t,i){"use strict";game.appModule.RunePanel=game.SkinUIPanel.extends({_bgSprite:null,_curBianshenGrid:null,_runeSuitGirds:null,slotArr:null,typeArr:null,_list:null,curSelectRuneSuit:1,ctor:function(e){this._super(e),this.slotArr=[],this.typeArr=[]},init:function(){if(this._list=new b8e.List(this._skin.list,game.RuneStateLine),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("rune/runeBg",!0),null,null,{useManifest:!1}),this._curBianshenGrid||(this._curBianshenGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_107),this._curBianshenGrid.gridInfo=new game.GridInfo(game.ContainerId.BIANSHEN_UPGRADE_GRID_CONTAINER_ID),this._curBianshenGrid.addToParent(this._skin.node_bianshen)),!this._runeSuitGirds){this._runeSuitGirds=[];var e=this._skin.runeSuits;if(e&&0<e.length)for(var t=0,i=e.length;t<i;t++){var n=new game.ItemGrid(game.IcoSizeEnum.SIZE_107,-1,!1);n.gridInfo=new game.GridInfo(game.ContainerId.SELECT_BIANSHEN_CONTAINER_ID),n.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),n.setLabNamePos(0,-4),n.sortLayer(),n.addToParent(e[t]),this._runeSuitGirds.push(n)}}this.createSlots()},onShow:function(){this._list.show(),0==this.data?this.onClickRuneSuit1():1==this.data?this.onClickRuneSuit2():this.onClickRuneSuit3(),this.updatePanel(),this.showSelectSuit(this.curSelectRuneSuit),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenhao,this),b8e.evt.onC(this._skin.btn_runeBag,this.onClickRuneBag,this),b8e.evt.onC(this._skin.btn_mount,this.onClickQuickMount,this),b8e.evt.onC(this._skin.btn_unmount,this.onClickQuickUnmount,this),this._runeSuitGirds[0]&&b8e.evt.onC(this._skin.runeSuits[0],this.onClickRuneSuit1,this),this._runeSuitGirds[1]&&b8e.evt.onC(this._skin.runeSuits[1],this.onClickRuneSuit2,this),this._runeSuitGirds[2]&&b8e.evt.onC(this._skin.runeSuits[2],this.onClickRuneSuit3,this),b8e.evt.addG(this,game.RuneEvents.RUNE_UPDATE,this.updatePanel),b8e.evt.addG(this,game.RuneEvents.RUNE_ATTR_CHANGE,this.updateRuneAtt),b8e.evt.addG(this,game.RuneEvents.RUNE_UNFIX_SUCCESS,this.unfixRune),b8e.evt.addG(this,game.RuneEvents.RUNE_UNFIX_SUCCESS,this.updatePanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateSlot)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenhao,this),b8e.evt.offC(this._skin.btn_runeBag,this.onClickRuneBag,this),b8e.evt.offC(this._skin.btn_mount,this.onClickQuickMount,this),b8e.evt.offC(this._skin.btn_unmount,this.onClickQuickUnmount,this),this._runeSuitGirds[0]&&b8e.evt.offC(this._skin.runeSuits[0],this.onClickRuneSuit1,this),this._runeSuitGirds[1]&&b8e.evt.offC(this._skin.runeSuits[1],this.onClickRuneSuit2,this),this._runeSuitGirds[2]&&b8e.evt.offC(this._skin.runeSuits[2],this.onClickRuneSuit3,this),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UPDATE,this.updatePanel),b8e.evt.rmvG(this,game.RuneEvents.RUNE_ATTR_CHANGE,this.updateRuneAtt),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UNFIX_SUCCESS,this.unfixRune),b8e.evt.rmvG(this,game.RuneEvents.RUNE_UNFIX_SUCCESS,this.updatePanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateSlot)},createSlots:function(){var e,t,i,n,s,a=null;s=game.rune.getRuneAlertById(game.rune.selectRuneSuit),game.rune.setRuneSuitInfo(game.rune.selectRuneSuit);for(var o=0;o<7;o++){(n=b8e.Sprite.get()).addToParent(this._skin.node_rune),(a=game.rune.getRuneInfoBySlot(o+1))||((a=new game.RuneInfo).targetSlot=o+1),(i=new game.ItemGrid(game.IcoSizeEnum.SIZE_90)).gridInfo=new game.GridInfo(game.ContainerId.RUNE_SLOT_CONTAINER_ID),i.addToParent(n);e=155*Math.sin(45*(o+1)*Math.PI/180),t=155*Math.cos(45*(o+1)*Math.PI/180),n.setPosition(e,t-40),game.GridUtil.setRuneSlot(i,a,!1),0==a.idx&&game.rune.isOpenSlotBySlot(a.targetSlot)&&i.setRedIcon(s),i.sortLayer(),this.slotArr.push(i),i.fnOnClick(this,this.onClick)}},showSelectSuit:function(e){var t=this._skin.runeSuits[e-1];if(t){var i=t.x,n=t.y;this._skin.runeSuitSelectEffect.setPosition(i,n)}},onClickRuneSuit1:function(){game.rune.selectRuneSuit=game.rune.SUIT_ONE,this.curSelectRuneSuit!==game.rune.selectRuneSuit&&(this.curSelectRuneSuit=game.rune.selectRuneSuit,this.updatePanel(),this.showSelectSuit(1))},onClickRuneSuit2:function(){game.rune.selectRuneSuit=game.rune.SUIT_TWO,this.curSelectRuneSuit!==game.rune.selectRuneSuit&&(this.curSelectRuneSuit=game.rune.selectRuneSuit,this.updatePanel(),this.showSelectSuit(2))},onClickRuneSuit3:function(){game.rune.selectRuneSuit=game.rune.SUIT_THREE,this.curSelectRuneSuit!==game.rune.selectRuneSuit&&(this.curSelectRuneSuit=game.rune.selectRuneSuit,this.updatePanel(),this.showSelectSuit(3))},updatePanel:function(){game.rune.setRuneSuitInfo(game.rune.selectRuneSuit),this.updateRuneSlots(),this.clearSlot(),this.updateSlot(),game.rune.setRuneAtt(game.rune.selectRuneSuit),this.updateRuneAtt();var e=game.bianshen.getBattleBianshenInfo(),t=e[this.curSelectRuneSuit-1];if(t?(game.GridUtil.setBianshenGrid(this._curBianshenGrid,t),this._curBianshenGrid.setRedIcon(!1),this._curBianshenGrid.sortLayer()):game.GridUtil.setBianshenGrid(this._curBianshenGrid,null),e)for(var i=0;i<3;i++)if(e[i]){if(!this._runeSuitGirds[i])continue;game.GridUtil.setBianshenGrid(this._runeSuitGirds[i],e[i]),this._runeSuitGirds[i].sortLayer()}else game.GridUtil.setBianshenGrid(this._runeSuitGirds[i],null);0<game.rune.selectRuneSuit&&game.rune.canWearRuneSuitFlagArr[game.rune.selectRuneSuit-1]?this._skin.quickMountRedPoint.active=!0:this._skin.quickMountRedPoint.active=!1},updateRuneSlots:function(){var e,t,i=null;game.bianshen.getBianshenInfoByidx(game.bianshen.curBianshenIdx);t=game.rune.getRuneAlertById(game.rune.selectRuneSuit);for(var n=this.slotArr.length,s=0;s<n;s++)e=this.slotArr[s],(i=game.rune.getRuneInfoBySlot(s+1))||((i=new game.RuneInfo).targetSlot=s+1),game.GridUtil.setRuneSlot(e,i,!1),0==i.idx&&game.rune.isOpenSlotBySlot(i.targetSlot)&&e.setRedIcon(t),e.sortLayer()},updateSlot:function(){this.typeArr.length=0;var e,t,i=null;t=game.rune.getRuneAlertById(game.rune.selectRuneSuit);for(var n=game.rune.getRuneSuitRuneArr(game.rune.selectRuneSuit),s=0,a=n.length;s<a;s++)i=n[s],e=this.slotArr[i.targetSlot-1],game.GridUtil.setRuneSlot(e,i,!1),0==i.idx&&game.rune.isOpenSlotBySlot(i.targetSlot)&&e.setRedIcon(t),e.sortLayer(),this.typeArr.push(i.type);game.rune.setRuneTypeMap(game.rune.selectRuneSuit,this.typeArr),this.setRuneAlerts()},unfixRune:function(){this._skin.lab_power.string=game.rune.getRuneAllPower();var e=new game.RuneInfo;e.targetSlot=game.rune.slotIndex;var t=this.slotArr[game.rune.slotIndex-1];game.GridUtil.setRuneSlot(t,e,!0),t.sortLayer()},updateRuneAtt:function(){this._skin.lab_power.string=game.rune.getRuneAllPower();var e=game.rune.getRuneAttMap(game.rune.selectRuneSuit).values();this._list.setData(e)},clearSlot:function(){var e,t,i=null;t=game.rune.getRuneAlertById(game.rune.selectRuneSuit);for(var n=this.slotArr.length,s=0;s<n;s++)e=this.slotArr[s],(i=new game.RuneInfo).targetSlot=s+1,game.GridUtil.setRuneSlot(e,i,!0),0==i.idx&&game.rune.isOpenSlotBySlot(i.targetSlot)&&e.setRedIcon(t),e.sortLayer()},onClickQuickMount:function(){game.rune.quickMountRune(game.rune.selectRuneSuit)},onClickQuickUnmount:function(){game.rune.quickUnmountRune(game.rune.selectRuneSuit)},onClickRuneBag:function(){game.TriggerMgr&&game.TriggerMgr.inst().customTriggerById(3154)},onClickWenhao:function(){game.app.show(game.AppConstant.RUNE_RULE_PANEL)},onClick:function(e){var t=e.faceInfo;game.rune.slotIndex=t.targetSlot,game.rune.isOpenSlotBySlot(t.targetSlot)?0==t.idx?game.rune.showSelectPanel():game.rune.showRuneTips(t,e.gridInfo.containerId):game.notice.show("尚未开启该槽位")},setRuneAlerts:function(){}})},{}],737:[function(e,t,i){"use strict";game.appModule.RuneRulePanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},init:function(){this._skin.title.string=game.ccfg.LangCfg.getText(29004),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(29003)},onShow:function(){},onHide:function(){}})},{}],738:[function(e,t,i){"use strict";game.appModule.RuneSelectPanel=game.SkinUIPanel.extends({_list:null,_itemGridLeft:null,isHideInlaied:!1,ctor:function(e){this._super(e)},init:function(){this._list=new b8e.List(this._skin.list,game.RuneItem)},onShow:function(){this._list.show(),this.updatePanel(),b8e.evt.onC(this._skin.btn_show.node,this.onClickBtn,this)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_show.node,this.onClickBtn,this)},updatePanel:function(){var e;e=this.isHideInlaied?game.rune.getUnsetRune():game.rune.getBackRune();var t=game.rune.getRuneTypeArr(game.rune.selectRuneSuit);if(game.rune.nowRuneInfo?(this.setCurRuneInfo(game.rune.nowRuneInfo),this._skin.node_curItem.active=!0,this._skin.list.node.y=657,this._skin.list.node.height=578,this._skin.node_listView.height=578):(this._skin.list.node.y=777,this._skin.list.node.height=698,this._skin.node_listView.height=698,this._skin.node_curItem.active=!1),e&&0<e.length){if(this._skin.lab_tip.string="",t&&0<t.length)for(var i,n=e.length-1;0<=n;n--)i=e[n],game.rune.nowRuneInfo?(i.idx==game.rune.nowRuneInfo.idx||-1!=t.indexOf(i.type)&&i.type!=game.rune.nowRuneInfo.type)&&e.splice(n,1):-1!=t.indexOf(i.type)&&e.splice(n,1);e.sort(this.onSortRune)}else this._skin.lab_tip.string=game.ccfg.LangCfg.getText(29025);this._list.setData(e)},setCurRuneInfo:function(e){e&&(this._itemGridLeft||(this._itemGridLeft=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGridLeft.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGridLeft.addToParent(this._skin.node_icon)),this._cfg=game.ccfg.RuneCfg.getRuneDataById(e.id),this._cfg&&(e.setupByCfg(this._cfg),game.GridUtil.setRuneGrid(this._itemGridLeft,e,!1,!1,!1,!1),this._itemGridLeft.sortLayer(),game.rune.nowRuneInfo&&e.idx==game.rune.nowRuneInfo.idx?(this._skin.lab_init.string=game.ccfg.LangCfg.getText(29018),this._skin.btn_inlay.active=!1):(this._skin.lab_init.string="",this._skin.btn_inlay.active=!0),this._skin.lab_name.string=e.name,this._skin.lab_lv.string=game.ccfg.LangCfg.getText(4e4,[e.level]),this._skin.lab_attr.string=game.rune.getAttrStrById(e.id),this._skin.lab_power.string=game.rune.getRunePower(e.id)))},onSortRune:function(e,t){return e&&t?0<e.runeSuitId&&0===t.runeSuitId?1:0===e.runeSuitId&&0<t.runeSuitId?-1:e.quality>t.quality?-1:e.quality<t.quality?1:e.level>t.level?-1:e.level<t.level?1:e.id<t.id?-1:e.id>t.id?1:0:0},onClickBtn:function(){this.isHideInlaied=!this.isHideInlaied,this.updatePanel()}})},{}],739:[function(e,t,i){"use strict";game.appModule.RuneShowPanel=game.SkinUIPanel.extends({_archivePanel:null,_convertPanel:null,_index:-1,_curPanel:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"runeArchive":return!this._skin||!(t=this._skin.buttonToggle[0].node)||t;case"runeConvert":return!this._skin||!(t=this._skin.buttonToggle[1].node)||t}return null},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"1"!=e||(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]))},onShow:function(){this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this.onSelectPanelByIndex(this._index),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickRuneArchive,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickRuneConvert,this)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickRuneArchive,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickRuneConvert,this)},onClickRuneArchive:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickRuneConvert:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onSelectPanelByIndex:function(e){switch(this._index=e,this._curPanel&&this._curPanel.hide(),e){case 0:this._archivePanel||(this._archivePanel=new game.RuneArchivePanel,this._archivePanel.addToParent(this._skin.page)),this._skin.buttonToggle[0].check(),this._skin.title.string="符文图鉴",this._archivePanel.show(),this._curPanel=this._archivePanel;break;case 1:this._convertPanel||(this._convertPanel=new game.RuneConvertPanel,this._convertPanel.addToParent(this._skin.page)),this._skin.buttonToggle[1].check(),this._skin.title.string="符文兑换",this._convertPanel.show(),this._curPanel=this._convertPanel}}})},{}],740:[function(e,t,i){"use strict";game.RuneStateLine=b8e.BaseDisplay.extends({_data:null,_cfg:null,_stateLine:null,ctor:function(e){this._super(),this._data=e},show:function(){},hide:function(){},getWidth:function(){return 240},getHeight:function(){return 24},setData:function(e){this._data=e,this._data&&(this._stateLine||(this._stateLine=new game.StateLine(!0,-20,80),this._stateLine.addToParent(this)),this._stateLine.setData(this._data,20))}})},{}],741:[function(e,t,i){"use strict";game.appModule.RuneTipsPanel=game.SkinUIPanel.extends({_containerId:0,_runeInfo:null,_itemGrid:null,middle_xx:194,right_xx:270,ctor:function(e){this._super(e)},onShow:function(){this.data?(this._containerId=this.data.containerId,this._runeInfo=this.data.runeInfo):(this._containerId=game.ContainerId.BACK_CONTAINER_ID,this._runeInfo=null),this.updatePanel(),b8e.evt.onC(this._skin.btn_demount,this.onClickDemount,this),b8e.evt.onC(this._skin.btn_intensify,this.onClickIntensify,this),b8e.evt.onC(this._skin.btn_replace,this.onClickReplace,this),b8e.evt.onC(this._skin.btn_decompose,this.onClickDecompose,this)},onHide:function(){b8e.evt.offC(this._skin.btn_demount,this.onClickDemount,this),b8e.evt.offC(this._skin.btn_intensify,this.onClickIntensify,this),b8e.evt.offC(this._skin.btn_replace,this.onClickReplace,this),b8e.evt.offC(this._skin.btn_decompose,this.onClickDecompose,this)},updatePanel:function(){switch(this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.BACK_CONTAINER_ID),this._itemGrid.addToParent(this._skin.node_icon)),game.GridUtil.setRuneGrid(this._itemGrid,this._runeInfo,!1,!1,!1,!1,!1),this._itemGrid.sortLayer(),this._skin.btn_demount.active=!1,this._skin.btn_intensify.active=!1,this._skin.btn_replace.active=!1,this._skin.btn_decompose.active=!1,this._containerId){case game.ContainerId.RUNE_SLOT_CONTAINER_ID:this._skin.btn_demount.active=!0,this._skin.btn_intensify.active=!0,this._skin.btn_replace.active=!0,this._skin.btn_intensify.x=this.middle_xx;break;case game.ContainerId.CSARENA_ILLUSTRATION_CONTAINER_ID:case game.ContainerId.RUNE_CONVERTITEM_CONTAINER_ID:break;case game.ContainerId.BACK_CONTAINER_ID:this._skin.btn_decompose.active=!0,this._skin.btn_intensify.active=!0,this._skin.btn_intensify.x=this.right_xx}this._skin.lab_name.string=game.html.getQualityString(this._runeInfo.quality,this._runeInfo.name);var e="";e=game.mainRole.mainRoleData.getLv()>=this._runeInfo.level?game.html.getText(game.html.Q_GREEN,"等级："+this._runeInfo.level):game.html.getText(game.html.Q_RED,"等级："+this._runeInfo.level),this._skin.lab_lv.string=e,this._skin.lab_desc.node.active=!1,this._skin.lab_power.string=game.rune.getRunePower(this._runeInfo.id);var t="",i=game.ccfg.RuneCfg.getRuneDataBIL(this._runeInfo.group,this._runeInfo.level+1),n=game.ccfg.LangCfg.getText(29020,[game.rune.getAttrStrById(this._runeInfo.id,!0)]);i&&(t=game.ccfg.LangCfg.getText(29021,[game.rune.getAttrStrById(i.id,!0)])),this._skin.lab_attr.string=n+"\n"+t,this.showAlert()},showAlert:function(){this._skin.redPoint_intensify.active=game.rune.canIntensify(this._runeInfo)},onClickDemount:function(){this._runeInfo&&(game.rune.sendUnfixRune(this._runeInfo.idx),this.hide())},onClickIntensify:function(){game.rune.showIntensifyPanel(this._runeInfo),this.hide()},onClickReplace:function(){this.hide(),game.rune.showSelectPanel(this._runeInfo)},onClickDecompose:function(){this._runeInfo&&(this._runeInfo.runeSuitId?game.notice.show(29016):(game.rune.resolveSelect(this._runeInfo.idx),game.rune.sendResolveRune(),this.hide()))}})},{}],742:[function(e,t,i){"use strict";e("./cmd/RuneCmd"),e("./event/RuneEvents"),e("./manager/RuneMgr"),e("./sender/RuneSender"),e("./panel/RuneArchiveItem"),e("./panel/RuneArchivePanel"),e("./panel/RuneBagPanel"),e("./panel/RuneConvertItem"),e("./panel/RuneConvertPanel"),e("./panel/RuneDecomposeGrid"),e("./panel/RuneDecomposePanel"),e("./panel/RuneItem"),e("./panel/RunePackGrid"),e("./panel/RunePanel"),e("./panel/RuneRulePanel"),e("./panel/RuneSelectPanel"),e("./panel/RuneShowPanel"),e("./panel/RuneStateLine"),e("./panel/RuneTipsPanel")},{"./cmd/RuneCmd":723,"./event/RuneEvents":724,"./manager/RuneMgr":725,"./panel/RuneArchiveItem":726,"./panel/RuneArchivePanel":727,"./panel/RuneBagPanel":728,"./panel/RuneConvertItem":729,"./panel/RuneConvertPanel":730,"./panel/RuneDecomposeGrid":731,"./panel/RuneDecomposePanel":732,"./panel/RuneItem":734,"./panel/RunePackGrid":735,"./panel/RunePanel":736,"./panel/RuneRulePanel":737,"./panel/RuneSelectPanel":738,"./panel/RuneShowPanel":739,"./panel/RuneStateLine":740,"./panel/RuneTipsPanel":741,"./sender/RuneSender":743}],743:[function(e,t,i){"use strict";var n=game.RuneSender=function(){};n.runeBagRequest=function(){var e=game.pbmid.Char.RuneBagRequest;b8e.sendN(e)},n.wearRuneRequest=function(e){var t=game.pbmsg.WearRuneRequest;t.runeInfos=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.WearRuneRequest;b8e.sendN(i)},n.unfixRuneRequest=function(e){var t=game.pbmsg.UnfixRuneRequest;if(e){t.idx=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.UnfixRuneRequest;b8e.sendN(i)}},n.upgradeRuneRequest=function(e){var t=game.pbmsg.UpgradeRuneRequest;t.idx=parseInt(e),engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.UpgradeRuneRequest;b8e.sendN(i)},n.resolveRuneRequest=function(e){var t=game.pbmsg.ResolveRuneRequest;t.idx=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ResolveRuneRequest;engine.NetSender.send(i)},n.convertRuneRequest=function(e){var t=game.pbmsg.ConvertRuneRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ConvertRuneRequest;b8e.sendN(i)}},{}],744:[function(e,t,i){"use strict";game.appModule.SanzangJiangjinHintPanel=game.SkinUIPanel.extends({_time:0,ctor:function(e){this._super(e)},onShow:function(){this.onUpdatePanel()},onHide:function(){},onUpdatePanel:function(){if(this._skin){this._skin.lasttime.string="<color=#E7D7A7>剩余时间：</c><color=#74D610>0</color>",this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500);var e=game.ccfg.GlobalParamCfg.getData(2907);e*=100,this._skin.ratetimes.string="<color=#E7D7A7>经验倍率：</c><color=#74D610>"+e+"%</color>"}},updateTime:function(){var e=game.sceneRole.bubbleEndTime-game.SysTime.curTime;0<e?this._skin.lasttime.string="<color=#E7D7A7>剩余时间：</c><color=#74D610>"+b8e.TimeUtil.formatTime(e)+"</color>":(this._timer&&this._timer.stop(),this._skin.lasttime.string="",game.sceneRole.isInBubbleExp=0,this.hide())}})},{}],745:[function(e,t,i){"use strict";game.Sanzangjiangjin=game.SkinUI.extends({_timer:null,ctor:function(){this._super("sanzangjiangjinSkin/SanzangjiangjinSkin","SanzangjiangjinSkin")},onShow:function(){b8e.evt.onC(this._skin.joinbtn,this.onTransmists,this),b8e.evt.addG(this,game.SanzangjiangjinEvent.UPDATE_VIEW,this.updateView),this.updateView()},onHide:function(){b8e.evt.offC(this._skin.joinbtn,this.onTransmists,this),b8e.evt.rmvG(this,game.SanzangjiangjinEvent.UPDATE_VIEW,this.updateView)},updateView:function(){if(this._skin){var e=game.sceneRole.isInBubbleExp,t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.JIANGJIN_EXPPRIZE),i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.JIANGJIN_BEGINITIME),n=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.JIANGJIN_ENDITIME);this._skin.openTime.string="每日   "+i+"-"+n,this._skin.prizeText.string="<color=#74D610>"+t+"倍</c><color=#E7D7A7>挂机经验</color>",e?(this._skin.endTipNode.active=!1,this._skin.joinNode.active=!0,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500)):(this._skin.endTipNode.active=!0,this._skin.joinNode.active=!1)}},replaceStr:function(e){if(!e)return"";for(var t=0;t<2;t++)e=(e=(e=e.replace(",","-")).replace("(","")).replace(")","");return e=e.replace("|","   ")},updateTime:function(){var e=game.sceneRole.bubbleEndTime-game.SysTime.curTime;0<e?this._skin.LastTime.string="结算倒计时"+b8e.TimeUtil.formatTime(e):(this._timer&&this._timer.stop(),this._skin.LastTime.string="",game.sceneRole.isInBubbleExp=0,this.updateView())},onTransmists:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CHANG_AN_SCENE_ID),t=game.ccfg.SceneCfg.getDataById(e);t&&(game.mainRole.mainRoleData.getLv()>=t.unlocklevel?(game.quest.changeAuto(!1),game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,e),this.hide(),game.app.hide(game.AppConstant.FIGHT_PANEL)):game.notice.show("暂时还去不了这里哟"))}})},{}],746:[function(e,t,i){"use strict";game.SanzangjiangjinEvent=b8e.Enum({UPDATE_VIEW:b8e.Event.nextCode()})},{}],747:[function(e,t,i){"use strict";game.SceneDesEvent=b8e.Enum({CHANGE_SCENE:b8e.Event.nextCode()})},{}],748:[function(e,t,i){"use strict";game.SceneDesMgr=b8e.Object.extends({lastExp:-1,lastGold:-1,nowExp:0,nowGold:0,sceneId:0,maxPrizeSceneId:0,maxGold:0,maxExp:0,showPrize:!1,showBoss:!1,showSceneDesPrize:function(e){if(e){this.showPrize=!0,this.showBoss=!1;var t=60*e.GoldRate,i=60*e.ExpRate;-1==this.lastExp&&-1==this.lastGold?(this.lastExp=i,this.lastGold=t):(this.lastExp=this.nowExp,this.lastGold=this.nowGold),this.nowExp=i,this.nowGold=t,this.maxPrizeSceneId=e.MaxRateSceneId,this.maxGold=e.MaxGoldRate,this.maxExp=e.MaxExpRate;var n=game.SceneMgr.inst().sceneId,s=this.isChange();(this.sceneId!=n||s)&&game.app.show(game.AppConstant.SCENE_DES_PANEL),this.sceneId=n,b8e.evt.dptG(game.SceneDesEvent.CHANGE_SCENE)}},showSceneDes:function(){game.SceneMgr.inst().getSceneConfig().type==game.SceneType.DUNGEON&&(this.showPrize=!1,this.showBoss=!0,game.app.show(game.AppConstant.SCENE_DES_PANEL))},isChange:function(){return this.lastExp!=this.nowExp||this.lastGold!=this.nowGold}}),game.SceneDesMgr._instance=null,game.SceneDesMgr.inst=function(){return game.SceneDesMgr._instance||(game.SceneDesMgr._instance=new game.SceneDesMgr),game.SceneDesMgr._instance}},{}],749:[function(e,t,i){"use strict";e("./SceneDesMgr")},{"./SceneDesMgr":748}],750:[function(e,t,i){"use strict";game.appModule.SceneDesPanel=game.SkinUIPanel.extends({_skin:null,ctor:function(e){this._super(e),this._skin=this._skin},onShow:function(){b8e.evt.addG(this,game.SceneDesEvent.CHANGE_SCENE,this.onUpdateDes),this.onUpdateDes()},onHide:function(){b8e.evt.rmvG(this,game.SceneDesEvent.CHANGE_SCENE,this.onUpdateDes)},onUpdateDes:function(){game.SceneDesMgr.inst().showBoss?this.showBossDes():this.showSceneDes(),this.alpha=1,b8e.Tween.kill(this),b8e.Tween.get(this).wait(2e3).to({alpha:0},1500).call(this.autoHide)},showSceneDes:function(){this._skin.prizeNode.active=!0,this._skin.bossNode.active=!1,this._skin.prize.active=!1,this._skin.prizeChange.active=!1;var e=game.SceneDesMgr.inst(),t=this._skin,i=game.SceneMgr.inst().getSceneConfig(),n="???";i&&(n=i.name),t.sceneName.string=n,e.showPrize?(this._skin.bg.node.setScale(1,1),e.isChange()?(this._skin.prizeChange.active=!0,t.nowExp.string=game.html.getText(game.html.Q_GREEN,e.nowExp)+"/小时",t.lastExp.string=e.lastExp+"/小时",t.nowGold.string=game.html.getText(game.html.Q_GREEN,e.nowGold)+"/小时",t.lastGold.string=e.lastGold+"/小时"):(this._skin.prize.active=!0,t.exp.string=e.nowExp+"/小时",t.gold.string=e.nowGold+"/小时")):this._skin.bg.node.setScale(1,.6)},showBossDes:function(){this._skin.prizeNode.active=!1,this._skin.bossNode.active=!0},autoHide:function(){b8e.Tween.kill(this),b8e.evt.rmvG(this,game.SceneDesEvent.CHANGE_SCENE,this.onUpdateDes),this.hide()}})},{}],751:[function(e,t,i){"use strict";game.appModule.ScenePrizeDesPanel=game.SkinUIPanel.extends({onShow:function(){b8e.evt.addG(this,game.SceneDesEvent.CHANGE_SCENE,this.onUpdateDes),b8e.evt.onC(this._skin.gotoScene,this.onGoToScene,this),b8e.evt.onC(this._skin.buyCare,this.onBuyCare,this),b8e.evt.onC(this._skin.buyVip,this.onBuyVip,this),this.onUpdateDes()},onHide:function(){b8e.evt.rmvG(this,game.SceneDesEvent.CHANGE_SCENE,this.onUpdateDes),b8e.evt.offC(this._skin.gotoScene,this.onGoToScene,this),b8e.evt.offC(this._skin.buyCare,this.onBuyCare,this),b8e.evt.offC(this._skin.buyVip,this.onBuyVip,this)},onBuyVip:function(){game.shield.isShieldRecharge()||game.pay.showPayPanel()},onBuyCare:function(){game.shield.isShieldRecharge()||(game.pay.isRechargePanel=!0,game.app.show(game.AppConstant.CARD_RECHARGE_PANEL))},onGoToScene:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.SURA:if(game.sura.crossServer)return}var t=game.SceneMgr.inst().sceneId,i=game.SceneDesMgr.inst();i.maxPrizeSceneId==t&&game.notice.show(17001),game.ccfg.SceneCfg.getSceneById(i.maxPrizeSceneId)?game.SceneSender.moveToRequest(game.SceneTransType.TYPE_NORMAL,i.maxPrizeSceneId):(b8e.warn("mgr.maxPrizeSceneId：》》》》》》》场景配置不存在"+i.maxPrizeSceneId),game.notice.show(17001))},onUpdateDes:function(){var e=game.SceneDesMgr.inst();this._skin.nowSilver.string=e.nowGold+"/小时",this._skin.nowExp.string=e.nowExp+"/小时",e.maxGold>e.nowGold?this._skin.nowSilverDown.active=!0:this._skin.nowSilverDown.active=!1,e.maxExp>e.nowExp?this._skin.nowExpDown.active=!0:this._skin.nowExpDown.active=!1;var t=game.ccfg.SceneCfg.getSceneById(e.maxPrizeSceneId);this._skin.gotoSceneDes.string=t?"前往"+game.html.getText(game.html.Q_GREEN,t.name)+"可获得最高收益":"已经处于最高收益场景";var i=game.mainRole.mainRoleData,n=i.getExp(),s=i.getLv(),a=game.ccfg.ExpCfg.getExpByLevel(s),o="",r=0;0==e.nowExp?o="99+":o=99<=(r=(n<a?a-n:0)/e.nowExp)?"99+":r=r.toFixed(1);this._skin.upgradeTime.string="约"+game.html.getText(game.html.Q_GREEN,o)+"小时后升级"}})},{}],752:[function(e,t,i){"use strict";e("./SceneDesPanel"),e("./ScenePrizeDesPanel")},{"./SceneDesPanel":750,"./ScenePrizeDesPanel":751}],753:[function(e,t,i){"use strict";e("./manager/managerIndex_11"),e("./panel/panelIndex_19"),e("./event/SceneDesEvent")},{"./event/SceneDesEvent":747,"./manager/managerIndex_11":749,"./panel/panelIndex_19":752}],754:[function(e,t,i){"use strict";game.SelectRewardEvent=b8e.Enum({CHANGE_SELECT:b8e.Event.nextCode(),NOTIFY_ITEM_CHANGE_SELECT:b8e.Event.nextCode()})},{}],755:[function(e,t,i){"use strict";game.SelectRewardItem=game.SkinUI.extends({_itemId:0,_itemGrid:null,ctor:function(e){this._super("selectReward/SelectRewardItemSkin","SelectRewardItemSkin"),this._itemId=e},onShow:function(){this.setData(this._itemId),b8e.evt.onC(this._skin.select_toggle.node,this.onClickSelectToggle,this),b8e.evt.addG(this,game.SelectRewardEvent.NOTIFY_ITEM_CHANGE_SELECT,this.onChangeSelect)},onHide:function(){this.clear(),b8e.evt.offC(this._skin.select_toggle.node,this.onClickSelectToggle,this),b8e.evt.rmvG(this,game.SelectRewardEvent.NOTIFY_ITEM_CHANGE_SELECT,this.onChangeSelect)},setData:function(e){if(this._itemId=e,this.clear(),this._skin&&this._itemId){this._itemGrid||(this._itemGrid=game.GridUtil.creatItemGrid(this,this._skin.item_icon_node),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.SELECT_REWARD_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClickGrid));var t=game.ccfg.ItemInfoCfg.getItemInfoById(this._itemId);t&&(game.GridUtil.setItemGrid(this._itemGrid,t),this._itemGrid.sortLayer())}},onClickGrid:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickSelectToggle:function(e){b8e.evt.dptG(game.SelectRewardEvent.CHANGE_SELECT,this)},onChangeSelect:function(e){this._itemId!=e.data&&(this._skin.select_toggle.isChecked=!1)},getItemId:function(){return this._skin.select_toggle.isChecked?this._itemId:0},clear:function(){this._itemGrid&&game.GridUtil.setItemGrid(this._itemGrid,null),this._skin&&(this._skin.select_toggle.isChecked=!1)},getHeight:function(){return 184},getWidth:function(){return 145}})},{}],756:[function(e,t,i){"use strict";game.appModule.SelectRewardPanel=game.SkinUIPanel.extends({_list:null,_itemInfo:null,_isUse:!1,_useCount:0,_selected:null,ctor:function(e){this._super(e)},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.SelectRewardItem))},onShow:function(){this.data&&(this._itemInfo=this.data.itemInfo,this._list.show(),this.updateInfo(),b8e.evt.onC(this._skin.minBtn,this.onMinBtnEvents,this),b8e.evt.onC(this._skin.maxBtn,this.onMaxBtnEvents,this),b8e.evt.onC(this._skin.jianhaoBtn,this.onJianhaoBtnEvents,this),b8e.evt.onC(this._skin.jiahaoBtn,this.onJiahaoBtnEvents,this),b8e.evt.onC(this._skin.useBtn,this.onUseItem,this),b8e.evt.addG(this,game.SelectRewardEvent.CHANGE_SELECT,this.onChangeSelect))},onHide:function(){this._selected=null,this._list&&this._list.hide(),b8e.evt.offC(this._skin.minBtn,this.onMinBtnEvents,this),b8e.evt.offC(this._skin.maxBtn,this.onMaxBtnEvents,this),b8e.evt.offC(this._skin.jianhaoBtn,this.onJianhaoBtnEvents,this),b8e.evt.offC(this._skin.jiahaoBtn,this.onJiahaoBtnEvents,this),b8e.evt.offC(this._skin.useBtn,this.onUseItem,this),b8e.evt.rmvG(this,game.SelectRewardEvent.CHANGE_SELECT,this.onChangeSelect)},onChangeSelect:function(e){this._selected=e.data,b8e.evt.dptG(game.SelectRewardEvent.NOTIFY_ITEM_CHANGE_SELECT,e.data._itemId)},updateInfo:function(){if(this._itemInfo){this._useCount=this._itemInfo.num,this._skin.lab_use_count.string=this._useCount+"";var e=game.ccfg.ItemInfoCfg.getItemInfoById(this._itemInfo.id);if(e){for(var t,i=[],n=e.effects.length,s=0;s<n;s++)"SelectItem"===(t=e.effects[s]).Type&&i.push(t.Value);if(i.length<4){var a=145*i.length+5*(i.length-1);this._list._layout.paddingLeft=.5*(510-a)}else this._list._layout.paddingLeft=5;this._list.setData(i)}}},onMinBtnEvents:function(){this._skin.lab_use_count.string="1",this._useCount=1},onMaxBtnEvents:function(){this._useCount=this._itemInfo.num,this._skin.lab_use_count.string=this._useCount+""},onJianhaoBtnEvents:function(){this._useCount=1<this._useCount?this._useCount-1:1,this._skin.lab_use_count.string=this._useCount+""},onJiahaoBtnEvents:function(){this._useCount=this._useCount<this._itemInfo.num?this._useCount+1:this._itemInfo.num,this._skin.lab_use_count.string=this._useCount+""},onUseItem:function(){var e=this._selected?this._selected.getItemId():0;this._useCount<=0||e<=0?game.notice.show(79210):(game.back.checkUseConditions(this._itemInfo,this._useCount,e),this.hide())}})},{}],757:[function(e,t,i){"use strict";game.ShareCmd=game.BaseBean.extends({start:function(){}})},{}],758:[function(e,t,i){"use strict";game.ShareEvent=b8e.Enum({UPDATE_SHARE:b8e.Event.nextCode(),UPDATE_ADD_SHORTCUT:b8e.Event.nextCode(),UPDATE_WX_ADD_SHORTCUT:b8e.Event.nextCode(),UPDATE_WX_ADD_SHORTCUT_BTN_STATE:b8e.Event.nextCode()})},{}],759:[function(e,t,i){"use strict";game.ShareMgr=b8e.Object.extends({shareTimesDaily:0,nextCanShareTime:0,maxGetPrizeTimes:3,cdTime:0,isShareSuccess:!1,isBearGameSharing:!1,ctor:function(){if(1==game.ShareMgr._singleton)throw new Error("ShareMgr 只能通过单例方法获取");this.maxGetPrizeTimes=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.SHARE_DAILY_TIMES),this.cdTime=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.SHARE_CD_TIMES)*b8e.TimeUtil.MINUTE_MICRO_SECONDS},setup:function(e){this.shareTimesDaily=e.shareTimesDaily,this.nextCanShareTime=e.nextCanShareTime;var t=e.nextCanShareTime-game.SysTime.curTime;b8e.Tween.get(this).wait(t).call(this.updateTime,this)},clickShare:function(){if(this.isShareSuccess&&this.shareTimesDaily<this.maxGetPrizeTimes)this.getPrize();else if(game.SysTime.curTime<this.nextCanShareTime&&this.shareTimesDaily<this.maxGetPrizeTimes){game.SysTime.curTime;var e=b8e.TimeUtil.formatTime(this.nextCanShareTime-game.SysTime.curTime);game.notice.show(e+"后可分享")}else game.sdk.share()},shareSuccess:function(){game.SysTime.curTime>this.nextCanShareTime&&this.shareTimesDaily<this.maxGetPrizeTimes&&(this.isShareSuccess=!0,b8e.evt.dptG(game.ShareEvent.UPDATE_SHARE),game.notice.show("分享成功，请领取奖励"),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE))},getPrize:function(){game.WelfareSender.getSharePrize()},getPrizeSuccess:function(){this.isShareSuccess=!1,this.shareTimesDaily<this.maxGetPrizeTimes&&(this.nextCanShareTime=game.SysTime.curTime+this.cdTime,b8e.Tween.kill(this),b8e.Tween.get(this).wait(this.cdTime).call(this.updateTime,this)),this.shareTimesDaily++,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.ShareEvent.UPDATE_SHARE)},resetDaily:function(){this.shareTimesDaily=0,b8e.evt.dptG(game.ShareEvent.UPDATE_SHARE)},getShareTitle:function(){return game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SHARE_TITLE)},getShareMessage:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SHARE_MESSAGE).split("|");return e&&0<e.length?e[Math.random()*e.length>>0]:"默认内容"},updateTime:function(){b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},getShowAlert:function(){return this.isShareSuccess&&this.shareTimesDaily<this.maxGetPrizeTimes}}),game.ShareMgr._instance=null,game.ShareMgr._singleton=!0,game.ShareMgr.inst=function(){return null==game.ShareMgr._instance&&(game.ShareMgr._singleton=!1,game.ShareMgr._instance=new game.ShareMgr,game.ShareMgr._singleton=!0),game.ShareMgr._instance}},{}],760:[function(e,t,i){"use strict";game.ShortcutMgr=b8e.Object.extends({isShortcutSuccess:!1,clickAddShortcut:function(){b8e.isWeChatGame?game.welfare.isGetAddShortcutPrize?game.notice.show("收藏奖励已经领取过了"):game.WelfareSender.sendDesktopPrizeRequest():this.isShortcutSuccess?game.WelfareSender.sendDesktopPrizeRequest():game.sdk.addShortcut()},addShortcutSuccess:function(){this.isShortcutSuccess=!0,b8e.evt.dptG(game.ShareEvent.UPDATE_ADD_SHORTCUT),game.notice.show("收藏成功，请领取奖励")},prizeResponseSuccess:function(){if(game.welfare.isGetAddShortcutPrize=!0,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.isWeChatGame){game.app.hide(game.AppConstant.WX_ADD_SHORTCUT_PANEL);var e=new game.GameAlertInfo;e.alertType=game.GameAlertType.OneBtn,e.string="奖励领取成功，请到背包查看！",e.isShowTips=!1,game.gameAlert.showAlert(this,null,e),b8e.evt.dptG(game.ShareEvent.UPDATE_WX_ADD_SHORTCUT)}}}),game.ShortcutMgr._instance=null,game.ShortcutMgr._singleton=!0,game.ShortcutMgr.inst=function(){return null==game.ShortcutMgr._instance&&(game.ShortcutMgr._singleton=!1,game.ShortcutMgr._instance=new game.ShortcutMgr,game.ShortcutMgr._singleton=!0),game.ShortcutMgr._instance}},{}],761:[function(e,t,i){"use strict";game.appModule.SharePanel=game.SkinUIPanel.extends({prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.onC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.addG(this,game.ShareEvent.UPDATE_SHARE,this.onUpdatePanel),this.onUpdatePanel()},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.offC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.rmvG(this,game.ShareEvent.UPDATE_SHARE,this.onUpdatePanel),this._timer&&this._timer.stop()},onUpdatePanel:function(){this._timer&&this._timer.stop();var e=game.SysTime.curTime,t=game.ShareMgr.inst(),i=t.nextCanShareTime,n=t.maxGetPrizeTimes-t.shareTimesDaily;i<e||n<=0?(b8e.ShaderUtil.reset(this._skin.btn),this._skin.cdTime.string="00:00:00"):(b8e.ShaderUtil.setGray(this._skin.btn),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,500)),this._skin.dayTimes.string=n+"/"+t.maxGetPrizeTimes,t.isShareSuccess?(this._skin.btn.active=!1,this._skin.prizeBtn.active=!0):(this._skin.btn.active=!0,this._skin.prizeBtn.active=!1)},updateTime:function(){var e=game.SysTime.curTime,t=game.ShareMgr.inst(),i=t.nextCanShareTime-e,n=t.maxGetPrizeTimes-t.shareTimesDaily;i<=0||n<=0?(this._skin.cdTime.string="00:00:00",b8e.ShaderUtil.reset(this._skin.btn),this._timer&&this._timer.stop()):this._skin.cdTime.string=b8e.TimeUtil.formatTime(i)},initPanel:function(){if(!this.prizeList){this.prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this.prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.SHARE_PRIZE);e.setupById(t),this.prizeList.setData(e)}},clickBtn:function(){game.ShareMgr.inst().clickShare()}})},{}],762:[function(e,t,i){"use strict";e("./cmd/ShareCmd"),e("./event/ShareEvent"),e("./manager/ShareMgr"),e("./manager/ShortcutMgr"),e("./panel/SharePanel")},{"./cmd/ShareCmd":757,"./event/ShareEvent":758,"./manager/ShareMgr":759,"./manager/ShortcutMgr":760,"./panel/SharePanel":761}],763:[function(e,t,i){"use strict";game.ShopCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Shop.BuyGoodsResponse,this.onBuyGoodsResponse,this),b8e.addNH(game.pbmid.Shop.QryMysteryResponse,this.onQryMysteryResponse,this),b8e.addNH(game.pbmid.Shop.BuyMysteryResponse,this.onBuyMysteryResponse,this),b8e.addNH(game.pbmid.Shop.RefreshMysteryResponse,this.onRefreshMysteryResponse,this),b8e.addNH(game.pbmid.Shop.RefreshMysteryNotify,this.onRefreshMysteryNotify,this),b8e.addNH(game.pbmid.Shop.QryShopRecordResponse,this.onHonourShopInfoResponse,this)},onBuyGoodsResponse:function(e){var t=e.readProtobuf(game.pbmsg.BuyGoodsResponse);if(t)if(0==t.code){game.app.hide(game.AppConstant.SHOP_BUY_PANEL);var i=t.shopId,n=t.count;game.shop.syncBuyGoods(i,n)}else game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))},onQryMysteryResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryMysteryResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.shop.synMystery(t.goods,t.refreshCount)},onBuyMysteryResponse:function(e){var t=e.readProtobuf(game.pbmsg.BuyMysteryResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.shop.synBuyMystery(t.shopId)},onRefreshMysteryResponse:function(e){var t=e.readProtobuf(game.pbmsg.RefreshMysteryResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.shop.synRefreshMystery(t.goods)},onRefreshMysteryNotify:function(e){var t=e.readProtobuf(game.pbmsg.RefreshMysteryNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.shop.resetRefreshMystery(t.goods)},onHonourShopInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryShopRecordResponse);if(0==t.code){var i=t.record;null!==i&&game.shop.syncGoodsInfo(i)}else game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code))}})},{}],764:[function(e,t,i){"use strict";game.ShopEvents=b8e.Enum({UPDATE_MYSTERY_GOODS:b8e.Event.nextCode(),BUY_MYSTERY_GOODS:b8e.Event.nextCode(),HIDE_MYSTERY_ALERT:b8e.Event.nextCode(),UPDATE_GOODS:b8e.Event.nextCode(),UPDATE_DUJIETYPE_GOODS:b8e.Event.nextCode()})},{}],765:[function(e,t,i){"use strict";game.ShopMgr=b8e.Object.extends({selectType:0,buyCfg:null,checkUpgradeInfo:null,_mysteryMap:null,isInit:!1,refreshCount:0,timeCount:1,isAlertReset:!1,selectDujieType:1,_honourMap:null,_honourDujieMap:null,_dujieLv2TypeMap:null,ctor:function(){this._super(),this.checkUpgradeInfo=new game.UpgradeInfo,this._mysteryMap=b8e.HashMap.get(),this._honourMap=b8e.HashMap.get(),this._honourDujieMap=b8e.HashMap.get(),this._dujieLv2TypeMap=b8e.HashMap.get(),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMysteryOpenCallBack),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMysteryOpenCallBack),this.initDujieLv2TypeMap()},getSelectItems:function(){var e=[],t=game.ccfg.ShopCfg.getDataById(this.selectType);if(!t)return e;for(var i=game.mainRole.mainRoleData.getLv(),n=0;n<t.length;n++){var s=t[n];s.level<=i&&e.push(s)}return e},buyShop:function(e){var t=game.dujie.getSelfDujieLv();e.needDujieLv>t?game.notice.show(game.ClientCfg.shop_jingjielimit):(this.buyCfg=e,game.app.show(game.AppConstant.SHOP_BUY_PANEL))},getBuyShopInfo:function(e){return game.ccfg.ShopCfg.getCfgByGoodsId(e)},getBuyShopInfoEx:function(e,t){return game.ccfg.ShopCfg.getCfg(e,t)},getBuyUpgradeInfo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=this.getBuyShopInfoEx(e,t);return!!i&&(this.checkUpgradeInfo&&this.checkUpgradeInfo.clear(),this.checkUpgradeInfo.setUpgradeInfo(i.items),this.checkUpgradeInfo)},getItemInfoPrice:function(e){var t=this.getBuyUpgradeInfo(e,0);return t?t.amountInfo.getValue(game.AmountType.YUAN_BAO):0},buy:function(e){(this.checkUpgradeInfo&&this.checkUpgradeInfo.clear(),this.checkUpgradeInfo.setUpgradeInfo(this.buyCfg.items),this.checkUpgradeInfo)&&(game.upgrade.costCheck(this,this.checkUpgradeInfo,null,!1,!1,e)&&game.ShopSender.buy(this.buyCfg.id,e))},buyItemInfo:function(e,t){game.ShopSender.buy(e,t)},mysteryResetDaily:function(){game.shop.refreshCount=0,this.isAlertReset=!0},hideMysteryAlert:function(){this.isAlertReset&&(this.isAlertReset=!1,b8e.evt.dptG(game.ShopEvents.HIDE_MYSTERY_ALERT))},checkOpen:function(){game.funcOpen.checkOpen(game.FunctionType.SHOP)&&this.initReq()},onMysteryOpenCallBack:function(){game.funcOpen.checkOpen(game.FunctionType.SHOP)&&(this.initReq(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMysteryOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMysteryOpenCallBack))},initReq:function(){this.isInit||(game.ShopSender.reqMystery(),this.initHonourMap(),this.getShopRecord(),this.isInit=!0)},initDujieLv2TypeMap:function(){for(var e=1;e<31;e++){var t=(e+2)/3|0;this._dujieLv2TypeMap.set(e,t)}},initHonourMap:function(){for(var e=game.ccfg.ShopCfg.getDataById(game.ShopType.Honour),t=0,i=e.length;t<i;t++){var n=e[t],s=this._honourMap.get(n.id);s||(s=new game.ShopGoodInfo),s.setup(n),s.count=0,s.dailyTimes=n.dailyTimes,this._honourMap.set(n.id,s);var a=this._honourDujieMap.get(s.dujieType);a||(a=b8e.HashMap.get(),this._honourDujieMap.set(s.dujieType,a)),a.set(s.id,s)}},getShopRecord:function(){game.ShopSender.reqShopRecord()},getHonourArr:function(){var e=null;return this._honourMap&&0<this._honourMap.count()&&(e=this._honourMap.values()),e},getCurSelectedDujieHonourArr:function(){var e=null;if(this._honourDujieMap&&0<this._honourDujieMap.count()){var t=this._honourDujieMap.get(game.shop.selectDujieType);t&&0<t.count()&&(e=t.values())}return e},getGoodLimitGoodBuyCountById:function(e){var t=this._honourMap.get(e);return t?t.count:0},syncGoodsInfo:function(e){if(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],s=this._honourMap.get(n.id);s&&(s.count=n.num,this._honourMap.set(n.id,s))}b8e.evt.dptG(game.ShopEvents.UPDATE_GOODS)}},syncBuyGoods:function(e,t){if(0<e){var i=this._honourMap.get(e);if(!i)return;i.count+=t,b8e.log("当前限购次数："+t),this._honourMap.set(e,i)}b8e.evt.dptG(game.ShopEvents.UPDATE_GOODS)},goodsResetDaily:function(){this.initHonourMap(),b8e.evt.dptG(game.ShopEvents.UPDATE_GOODS)},synMystery:function(e,t){this.refreshCount=t,game.ccfg.MysteryCfg.setConfigs(e),this.updateMystery(e)},synBuyMystery:function(e){if(this._mysteryMap.get(e)){var t=this._mysteryMap.get(e);t.state=!0,this._mysteryMap.set(e,t)}b8e.evt.dptG(game.ShopEvents.BUY_MYSTERY_GOODS)},synRefreshMystery:function(e){this.refreshCount++,game.ccfg.MysteryCfg.setConfigs(e),this.updateMystery(e)},resetRefreshMystery:function(e){game.ccfg.MysteryCfg.setConfigs(e),this.updateMystery(e)},updateMystery:function(e){var t;this._mysteryMap.clear();for(var i=0;i<e.length;i++){var n=e[i];n&&((t=new game.MysteryInfo).setup(n),0!=t.itemId&&this._mysteryMap.set(n.shopId,t))}b8e.evt.dptG(game.ShopEvents.UPDATE_MYSTERY_GOODS)},showBuyTips:function(e,t){var i=new game.GameAlertInfo;i.alertType=game.GameAlertType.TwoBtn,i.string=e,i.obj={id:t},i.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,i)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ShopSender.reqBuyMystery(e.obj.id);break;case game.GameAlertBtnType.CANCEL:case game.GameAlertBtnType.CLOSE:}},getMysteryArr:function(){return this._mysteryMap&&0<this._mysteryMap.count()?this._mysteryMap.values():null},getRefreshPrice:function(){return game.ccfg.CostCfg.getNextCost(game.SystemId.MYSTERY_REFRESH_COUNT,this.refreshCount)},canRefresh:function(){var e=game.back.getAmountInfo(),t=0;return e&&(t=e.getValue(game.AmountType.YUAN_BAO)),this.getRefreshPrice()<=t},getItemId:function(e){var t=game.ccfg.MysteryCfg.getDataById(e);return t?t.itemId:0},getItemNum:function(e){var t=game.ccfg.MysteryCfg.getDataById(e);return t?t.itemNum:1},getIsShowBg:function(e){var t=game.ccfg.MysteryCfg.getDataById(e);return!!t&&t.isShowSpecialBg},getIsShowDiscount:function(e){var t=game.ccfg.MysteryCfg.getDataById(e);return!!t&&t.isRecommended},getMysteryCost:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=game.ccfg.MysteryCfg.getDataById(e);return s?(t=new game.UpgradeInfo,i?t.setUpgradeInfo(s.discountCost):t.setUpgradeInfo(s.normalCost),n?this.getCostItemId(t):this.getCostNum(t)):0},getCostNum:function(e){if(e){var t=e.getAmountInfo();return 0<t.amountMap.count()?t.getFirstAmountValue():e.getFirstUpgradeInfoNum()}return 0},getCostItemId:function(e){if(e){var t=e.getAmountInfo();if(!(0<t.amountMap.count()))return e.getFirstUpgradeInfoId();switch(t.getFirstAmountType()){case game.AmountType.SILVER:return game.AmountItemId.SILVER;case game.AmountType.YUAN_BAO:return game.AmountItemId.YUAN_BAO}}return 0},getMysteryRemainTime:function(){var e=b8e.TimeUtil.getTodayTime(game.SysTime.curTime)+6*b8e.TimeUtil.HOUR_MICRO_SECONDS*this.timeCount-game.SysTime.curTime;return e<=0&&this.timeCount++,e},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.SHOP_DRAW_ALERT,null,this.isAlert,this)},freeDrawAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.SHOP)&&game.draw.isHasFreeDrawTimes())return!0;return!1},mysteryAlert:function(){return!!game.funcOpen.checkOpen(game.FunctionType.SHOP)&&this.isAlertReset},isAlert:function(){var e=this.freeDrawAlert(),t=this.mysteryAlert();return e||t}}),game.ShopMgr._instance=null,game.ShopMgr.inst=function(){return game.ShopMgr._instance||(game.ShopMgr._instance=new game.ShopMgr),game.ShopMgr._instance}},{}],766:[function(e,t,i){"use strict";game.ShopBianshenPanel=game.SkinUI.extends({_itemAllArr:null,_list:null,ctor:function(){this._super("shop/ShopBianshenSkin","ShopBianshenSkin"),this._itemAllArr=[]},getButtonByName:function(e){var t,i;switch(e){case"bianshenOnceBtn0":return!(this._list&&(t=this._list.getItemRender(0))&&(i=t.getButtonByName("once")))||i;case"bianshenOnceBtn1":return!(this._list&&(t=this._list.getItemRender(1))&&(i=t.getButtonByName("once")))||i}return null},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.DrawItem)),this.onUpdateDrawList(),b8e.evt.addG(this,game.DrawEvents.DRAW_UPDATE,this.onUpdateDrawList),this._list.show()},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.DrawEvents.DRAW_UPDATE,this.onUpdateDrawList)},onUpdateDrawList:function(){this._itemAllArr.length=0,this._itemAllArr=game.draw.getAllDeck(),this._list.setData(this._itemAllArr)}})},{}],767:[function(e,t,i){"use strict";game.appModule.ShopBuyPanel=game.SkinUIPanel.extends({itemGrid:null,count:0,_strCount:"",_shopData:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.addOne,this.onAddOne,this),b8e.evt.onC(this._skin.bg.node,this.onClickBg,this),b8e.evt.onC(this._skin.addTen,this.onAddTen,this),b8e.evt.onC(this._skin.removeOne,this.onRemoveOne,this),b8e.evt.onC(this._skin.removeTen,this.onRemoveTen,this),b8e.evt.onC(this._skin.sure,this.onSure,this),this._skin.count_editBox.node.on("editing-did-began",this.onEditingBegan,this),this._skin.count_editBox.node.on("text-changed",this.onEditingChange,this),this._skin.count_editBox.node.on("editing-did-ended",this.onEditingEnded,this),this.init(),this.initBuyData()},onHide:function(){game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.addOne,this.onAddOne,this),b8e.evt.offC(this._skin.addTen,this.onAddTen,this),b8e.evt.offC(this._skin.bg.node,this.onClickBg,this),b8e.evt.offC(this._skin.removeOne,this.onRemoveOne,this),b8e.evt.offC(this._skin.removeTen,this.onRemoveTen,this),b8e.evt.offC(this._skin.sure,this.onSure,this),this._skin.count_editBox.node.off("editing-did-began",this.onEditingBegan,this),this._skin.count_editBox.node.off("text-changed",this.onEditingChange,this),this._skin.count_editBox.node.off("editing-did-ended",this.onEditingEnded,this)},onClickBg:function(){},onAddOne:function(){var e=this.getCanBuyMaxCount();this.count++,this.count=Math.min(this.count,e),this.count=this.isEnoughCost(this.count),this._strCount=this.count+"",this._skin.count.string=this.count+"",this.updateCost()},onAddTen:function(){var e=this.getCanBuyMaxCount();this.count+=10,this.count=Math.min(this.count,e),this.count=this.isEnoughCost(this.count),this._strCount=this.count+"",this._skin.count.string=this.count+"",this.updateCost()},onRemoveOne:function(){this.count--,this.count<=0&&(this.count=1),this.count=this.isEnoughCost(this.count),this._strCount=this.count+"",this._skin.count.string=this.count+"",this.updateCost()},onRemoveTen:function(){this.count-=10,this.count<=0&&(this.count=1),this.count=this.isEnoughCost(this.count),this._strCount=this.count+"",this._skin.count.string=this.count+"",this.updateCost()},onSure:function(){game.shop.buy(this.count)},init:function(){this._shopData=null,this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.item),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.SHOP_BUY_GRID_CONTAINER_ID),this.itemGrid.fnOnClick(this,this.onClick),this.itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80))},initBuyData:function(){var e=game.shop.buyCfg;if(this._shopData=e){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.goodsId,!0);t.num=1,game.GridUtil.setItemGrid(this.itemGrid,t),this.itemGrid.sortLayer();var i=t?t.name:e.goodsId;this._skin.itemName.string=i;var n=e.items?e.items[0]:null;if(n){switch(this.DisActiveAllCoinIcon(),n.Id){case game.AmountItemId.SILVER:this._skin.costYinBi.active=!0;break;case game.AmountItemId.YUAN_BAO:this._skin.costYuanBao.active=!0;break;case game.AmountItemId.HONOUR:this._skin.costHonour.active=!0}this._skin.cost.string=n.Num+""}else b8e.warn("商城物品",e.id,"未配置消耗");this.count=1,this._strCount="1",this._skin.count_editBox.string="",this._skin.count.string=this.count+"",this.updateCost()}},getCanBuyMaxCount:function(){var e=0,t=999;return this._shopData&&(e=game.shop.getGoodLimitGoodBuyCountById(this._shopData.id),0<this._shopData.dailyTimes&&(t=this._shopData.dailyTimes-e)),t},DisActiveAllCoinIcon:function(){this._skin.costYinBi.active=!1,this._skin.costYuanBao.active=!1,this._skin.costHonour.active=!1},updateCost:function(){var e=game.shop.buyCfg;if(e){var t=e.items?e.items[0]:null;if(t){var i=t.Num*this.count;this._skin.countCost.string=i+""}}},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},onEditingBegan:function(){this._skin.count.string="",this._skin.count_editBox.string=this._strCount},onEditingEnded:function(){if(0==this._skin.count_editBox.string.trim().length)return this._skin.count_editBox.string="",void(this._skin.count.string=this.count+"");var e=0|this._skin.count_editBox.string;this.count=this.isEnoughCost(e),this.count=999<this.count?999:this.count,this._strCount=this.count+"",this._skin.count_editBox.string="",this._skin.count.string=this.count+"",this.updateCost()},onEditingChange:function(){var e=this._skin.count_editBox.string.trim();if(0==e.length)return this._skin.count_editBox.string="",void(this._strCount="1");if(game.CCommonUtil.isNumber(e)){var t=0|this._skin.count_editBox.string;t<1&&(t=1);var i=this.getCanBuyMaxCount();this.count++,this.count=this.isEnoughCost(t),this.count=Math.min(this.count,i),this._strCount=this._skin.count_editBox.string=this.count+""}else this._skin.count_editBox.string=this._strCount;this.updateCost()},isEnoughCost:function(e){var t=game.shop.buyCfg,i=1;if(t){var n=t.items?t.items[0]:null;if(n){var s=game.ccfg.ItemInfoCfg.getItemInfoById(n.Id),a=game.back.getAmountInfo();if(s&&a){switch(s.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.HONOUR:(i=~~(a.getValue(s.type)/n.Num))<=0&&(i=1);break;default:b8e.log("商店配置了一个不是货币的消耗！！！")}return e<i?e:i}}return i}}})},{}],768:[function(e,t,i){"use strict";game.ShopHonourContentPanel=game.SkinUI.extends({_list:null,_btnList:null,ctor:function(){this._super("shop/ShopHonourContentSkin","ShopHonourContentSkin")},onShow:function(){this._skin.root_honour.active=!0,this._list||(this._list=new b8e.List(this._skin.list,game.ShopHonourListItem)),this._btnList||(this._btnList=new b8e.List(this._skin.btnList,game.ShopHonourDujieItem)),this.onUpdateHonour(),this._list.show(),this._btnList.show(),b8e.evt.onC(this._skin.btn_getHonour,this.onClickGetHonourBtn,this),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateHonour),b8e.evt.addG(this,game.ShopEvents.UPDATE_GOODS,this.updateData),b8e.evt.addG(this,game.ShopEvents.UPDATE_DUJIETYPE_GOODS,this.updateDujieTypeData),b8e.evt.dptG(game.ShopEvents.UPDATE_DUJIETYPE_GOODS),b8e.evt.dptG(game.ShopEvents.UPDATE_GOODS)},onHide:function(){this._list&&this._list.hide(),this._btnList&&this._btnList.hide(),b8e.evt.offC(this._skin.btn_getHonour,this.onClickGetHonourBtn,this),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateHonour),b8e.evt.rmvG(this,game.ShopEvents.UPDATE_GOODS,this.updateData),b8e.evt.rmvG(this,game.ShopEvents.UPDATE_DUJIETYPE_GOODS,this.updateDujieTypeData)},onUpdateHonour:function(){var e=game.back.getAmountInfo();if(e){var t=e.getValue(game.AmountType.HONOUR);this._skin.lab_honour.string=game.ValueUtil.formatNumber(t,0,!1,!1,!1,!1)}b8e.log("当前荣誉令数量："+t)},onClickGetHonourBtn:function(){game.app.show(game.AppConstant.WANFA_ARENA_PANEL)},updateData:function(){this.updateGoodData()},updateGoodData:function(){var e=game.shop.getCurSelectedDujieHonourArr();e&&e.sort(this.onSortById),this._list.setData(e)},updateDujieTypeData:function(){for(var e=game.dujie.getSelfDujieLv(),t=(e+2)/3|0,i=[],n=1;n<=t;n++)i.push(n);game.ccfg.DujieCfg.getDataById(3*(t+1))&&i.push(t+1),this._btnList.setData(i);var s=game.ccfg.DujieCfg.getDataById(e).groupName;this._skin.lab_dujieLvName.string="我的境界: "+s},onSortById:function(e,t){return e&&t?e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0:0}})},{}],769:[function(e,t,i){"use strict";game.ShopHonourDujieItem=game.SkinUI.extends({itemGrid:null,_data:null,_isDailyLimit:!1,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"shop/ShopHonourDujieItemSkin",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"ShopHonourDujieItemSkin";this._super(e,t)},getWidth:function(){return 150},getHeight:function(){return 75},onShow:function(){this.setSelect(),b8e.evt.onC(this._skin.btn_bg,this.onClick,this),b8e.evt.addG(this,game.ShopEvents.UPDATE_GOODS,this.setSelect),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.btn_bg,this.onClick,this),b8e.evt.rmvG(this,game.ShopEvents.UPDATE_GOODS,this.setSelect)},setData:function(e){if(this._data=0|e,this._skin&&this._data){var t=game.ccfg.DujieCfg.getDataById(3*this._data).groupName;this._skin.lab_dujieType.string=t+"期"}},onClick:function(){game.shop.selectDujieType=this._data,b8e.evt.dptG(game.ShopEvents.UPDATE_GOODS)},setSelect:function(){game.shop.selectDujieType===this._data?(this._skin.selected_bg.active=!0,this._skin.btn_bg.active=!1):(this._skin.selected_bg.active=!1,this._skin.btn_bg.active=!0)}})},{}],770:[function(e,t,i){"use strict";game.ShopHonourListItem=game.SkinUI.extends({itemGrid:null,_data:null,_isDailyLimit:!1,_isDujieLvLimit:!1,ctor:function(){this._super("shop/ShopHonourItemSkin","ShopItemSkin")},getWidth:function(){return 545},getHeight:function(){return 90},onShow:function(){b8e.evt.onC(this._skin.buy,this.onBuy,this),this.onInit(),this.setData(this._data)},onHide:function(){game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.buy,this.onBuy,this)},onInit:function(){this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.item),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.SHOP_GRID_CONTAINER_ID),this.itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80))},onBuy:function(){this._isDailyLimit?game.notice.show(game.ClientCfg.shop_dailylimit):game.shop.buyShop(this._data)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.goodsId,!0);t.num=1,this.itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this.itemGrid,t),this.itemGrid.setNum(1),this.itemGrid.sortLayer();var i=game.ccfg.ItemInfoCfg.getQualityNameById(e.goodsId);this._skin.itemName.string=i;var n=e.items?e.items[0]:null;if(n?(n.Id==game.AmountItemId.SILVER?(this.DisActiveAllCoinIcon(),this._skin.costYinBi.active=!0):n.Id==game.AmountItemId.YUAN_BAO?(this.DisActiveAllCoinIcon(),this._skin.costYuanBao.active=!0):n.Id==game.AmountItemId.HONOUR&&(this.DisActiveAllCoinIcon(),this._skin.costHorour.active=!0),this._skin.cost.string=n.Num+""):b8e.warn("商城物品",e.id,"未配置消耗"),0<e.dailyTimes){var s=e.count;s<0&&(s=0),s>=e.dailyTimes?(this._isDailyLimit=!0,s=e.dailyTimes):e.count<e.dailyTimes&&(this._isDailyLimit=!1,b8e.ShaderUtil.reset(this._skin.buySp)),this._skin.dailyLimitLab.string=s+"/"+e.dailyTimes,this._skin.dailyLimitRoot.active=!0}else this._skin.dailyLimitRoot.active=!1;var a=game.dujie.getSelfDujieLv();if(e.needDujieLv>a){this._isDujieLvLimit=!0,this._skin.jingjieLimitLab.node.active=!0,this._skin.dailyLimitRoot.active=!1;var o=game.ccfg.DujieCfg.getDataById(e.needDujieLv).name+"可购买";this._skin.jingjieLimitLab.string=o,b8e.ShaderUtil.setGray(this._skin.buySp)}else this._isDujieLvLimit=!1,this._skin.jingjieLimitLab.node.active=!1,this._skin.dailyLimitRoot.active=!0;this._isDailyLimit|this._isDujieLvLimit&&b8e.ShaderUtil.setGray(this._skin.buySp),this._isDujieLvLimit||this._isDailyLimit||b8e.ShaderUtil.reset(this._skin.buySp)}},DisActiveAllCoinIcon:function(){this._skin.costYinBi.active=!1,this._skin.costYuanBao.active=!1,this._skin.costHorour.active=!1},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)}})},{}],771:[function(e,t,i){"use strict";game.ShopHonourPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("shop/ShopHonourContentSkin","ShopHonourContentSkin")},onShow:function(){this._skin.root_honour.active=!0,this._list||(this._list=new b8e.List(this._skin.list,game.ShopHonourListItem)),this.updateData(),this.onUpdateHonour(),this._list.show(),game.shop.getShopRecord(),b8e.evt.onC(this._skin.btn_getHonour,this.onClickGetHonourBtn,this),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateHonour),b8e.evt.addG(this,game.ShopEvents.UPDATE_GOODS,this.updateData)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.btn_getHonour,this.onClickGetHonourBtn,this),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateHonour),b8e.evt.rmvG(this,game.ShopEvents.UPDATE_GOODS,this.updateData)},onUpdateHonour:function(){var e=game.back.getAmountInfo();if(e){var t=e.getValue(game.AmountType.HONOUR);this._skin.lab_honour.string=game.ValueUtil.formatNumber(t,0,!1,!1,!1,!1)}b8e.log("当前荣誉令数量："+t)},onClickGetHonourBtn:function(){game.app.show(game.AppConstant.WANFA_ARENA_PANEL)},updateData:function(){var e=game.shop.getHonourArr();e&&0<e.length&&(e.sort(this.onSortById),this._list.setData(e))},onSortById:function(e,t){return e&&t?e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0:0}})},{}],772:[function(e,t,i){"use strict";game.ShopListItem=game.SkinUI.extends({itemGrid:null,_data:null,_isDailyLimit:!1,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"shop/ShopItemSkin",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"ShopItemSkin";this._super(e,t)},getWidth:function(){return 545},getHeight:function(){return 90},onShow:function(){b8e.evt.onC(this._skin.buy,this.onBuy,this),this.onInit(),this.setData(this._data)},onHide:function(){game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.buy,this.onBuy,this)},onInit:function(){this.itemGrid||(this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.item),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.SHOP_GRID_CONTAINER_ID),this.itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80))},onBuy:function(){this._isDailyLimit?game.notice.show(game.ClientCfg.shop_dailylimit):game.shop.buyShop(this._data)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.goodsId,!0);t.num=1,this.itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this.itemGrid,t),this.itemGrid.setNum(1),this.itemGrid.sortLayer();var i=t?t.name:e.goodsId;this._skin.itemName.string=i;var n=e.items?e.items[0]:null;if(n?(n.Id==game.AmountItemId.SILVER?(this.DisActiveAllCoinIcon(),this._skin.costYinBi.active=!0):n.Id==game.AmountItemId.YUAN_BAO?(this.DisActiveAllCoinIcon(),this._skin.costYuanBao.active=!0):n.Id==game.AmountItemId.HONOUR&&(this.DisActiveAllCoinIcon(),this._skin.costHorour.active=!0),this._skin.cost.string=n.Num+""):b8e.warn("商城物品",e.id,"未配置消耗"),0<e.dailyTimes){var s=e.count;s<0&&(s=0),s>=e.dailyTimes?(this._isDailyLimit=!0,s=e.dailyTimes,b8e.ShaderUtil.setGray(this._skin.buySp)):e.count<e.dailyTimes&&(this._isDailyLimit=!1,b8e.ShaderUtil.reset(this._skin.buySp)),this._skin.dailyLimitLab.string=s+" / "+e.dailyTimes,this._skin.dailyLimitRoot.active=!0}else this._skin.dailyLimitRoot.active=!1}},DisActiveAllCoinIcon:function(){this._skin.costYinBi.active=!1,this._skin.costYuanBao.active=!1,this._skin.costHorour.active=!1},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})}})},{}],773:[function(e,t,i){"use strict";game.ShopMysteryItem=game.SkinUI.extends({itemGrid:null,_data:null,_red:null,_green:null,ctor:function(){this._super("shop/MysteryShopItemSkin","MysteryShopItemSkin"),this._red=b8e.ColorUtil.toCCColor(4294901760),this._green=b8e.ColorUtil.toCCColor(4278255360)},getWidth:function(){return 175},getHeight:function(){return 270},onShow:function(){b8e.evt.onC(this._skin.btn_buy,this.onClickBtnBuy,this),this.setData(this._data)},onHide:function(){game.GridUtil.setItemGrid(this.itemGrid,null),b8e.evt.offC(this._skin.btn_buy,this.onClickBtnBuy,this)},init:function(){this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.item),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.MYSTERY_CONTAINER_ID),this.itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.itemId,!0);if(t){t.num=e.itemNum,this.itemGrid.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(this.itemGrid,t),this.itemGrid.setLabNamePos(150,110),this.itemGrid.setNum(e.itemNum),this.itemGrid.sortLayer(),this._skin.lab_name.string=game.ccfg.ItemInfoCfg.getQualityNameById(t.id);var i=game.shop.getIsShowDiscount(e.shopId);this._skin.bg2.active=i,this._skin.bg1.active=!i,i=game.shop.getIsShowBg(e.shopId),this._skin.bg_discount2.active=i,this._skin.bg_discount1.active=!i,this._skin.lab_price.string=e.discountCost;var n=0,s=0,a=game.back.getAmountInfo();a&&(n=a.getValue(game.AmountType.SILVER),s=a.getValue(game.AmountType.YUAN_BAO));var o=e.discountCostId;o==game.AmountItemId.SILVER?this.updateIcon(n,e.discountCost,!0):o==game.AmountItemId.YUAN_BAO&&this.updateIcon(s,e.discountCost,!1);var r=e.discountCost/e.normalCost*10;r&&(this._skin.lab_discount.string=parseInt(r)+"\n折"),this._skin.btn_buy.active=!e.state}}},updateIcon:function(e,t,i){this._skin.lab_price.node.color=e<t?this._red:this._green,this._skin.node_yinbi.active=i,this._skin.node_yuanbao.active=!i},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},onClickBtnBuy:function(){if(this._data){var e=game.back.getAmountInfo(),t=0,i=0;if(e&&(t=e.getValue(game.AmountType.SILVER),i=e.getValue(game.AmountType.YUAN_BAO)),this._data.discountCostId==game.AmountItemId.SILVER)t>=this._data.discountCost?game.ShopSender.reqBuyMystery(this._data.shopId):game.upgrade.noticeByType(game.AmountType.SILVER);else if(this._data.discountCostId==game.AmountItemId.YUAN_BAO)if(i>=this._data.discountCost){var n=game.ccfg.ItemInfoCfg.getItemInfoById(this._data.itemId),s="是否购买"+(n?n.name:data.itemId)+"*"+this._data.itemNum+"\n消耗:"+this._data.discountCost+"元宝";game.shop.showBuyTips(s,this._data.shopId)}else game.gameAlert.showVipAlert(!0,101)}}})},{}],774:[function(e,t,i){"use strict";game.ShopMysteryPanel=game.SkinUI.extends({_list:null,_timer:null,ctor:function(){this._super("shop/ShopMysterySkin","ShopMysterySkin")},init:function(){this._list=new b8e.List(this._skin.list,game.ShopMysteryItem)},onShow:function(){this.updateData(),this._list.show(),game.shop.hideMysteryAlert(),this.updateTime(),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start(),b8e.evt.onC(this._skin.btn_update,this.onClickUpdate,this),b8e.evt.addG(this,game.ShopEvents.UPDATE_MYSTERY_GOODS,this.updateData),b8e.evt.addG(this,game.ShopEvents.BUY_MYSTERY_GOODS,this.updateData),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateData),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateData)},onHide:function(){this._list&&this._list.hide(),this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_update,this.onClickUpdate,this),b8e.evt.rmvG(this,game.ShopEvents.UPDATE_MYSTERY_GOODS,this.updateData),b8e.evt.rmvG(this,game.ShopEvents.BUY_MYSTERY_GOODS,this.updateData),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateData),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.updateData)},updateData:function(){var e=game.shop.getRefreshPrice(),t=game.shop.canRefresh();this._skin.lab_price.string=t?game.html.getText(game.html.Q_GREEN,e):game.html.getText(game.html.Q_RED,e);var i=game.shop.getMysteryArr();i&&0<i.length&&i.sort(this.onSortById),this._list.setData(i)},onSortById:function(e,t){var i=game.ccfg.MysteryCfg.getDataById(e.shopId),n=game.ccfg.MysteryCfg.getDataById(t.shopId);return i&&n?i.sortId>n.sortId?1:i.sortId<n.sortId?-1:0:0},onClickUpdate:function(){var e=0,t=game.shop.getRefreshPrice(),i=game.back.getAmountInfo();i&&(e=i.getValue(game.AmountType.YUAN_BAO)),t<=e?game.ShopSender.reqRefreshMystery():game.gameAlert.showVipAlert(!0,101)},updateTime:function(){var e=game.shop.getMysteryRemainTime();this._skin.lab_time.string=b8e.TimeUtil.formatTime(e)}})},{}],775:[function(e,t,i){"use strict";game.appModule.ShopPanel=game.SkinUIPanel.extends({selectType:-1,bianshen:null,sundries:null,_curPanel:null,honour:null,ctor:function(e){this._super(e)},getButtonByName:function(e){var t;switch(e){case"bianshenShopOnceBtn0":return!this.bianshen||!(t=this.bianshen.getButtonByName("bianshenOnceBtn0"))||t;case"bianshenShopOnceBtn1":return!this.bianshen||!(t=this.bianshen.getButtonByName("bianshenOnceBtn1"))||t;case"bianShen":return!this._skin||this._skin.bianShenBtn;case"back":return!this._skin||this._skin.closeBtnReturn;case"honour":if(this._skin)return this._skin.honourBtn}return null},onShow:function(){this.data?this.selectType=this.data:-1==this.selectType&&(this.selectType=game.ShopType.Mystery),this._skin.buttonToggle&&this._skin.buttonToggle.length&&this._skin.buttonToggle[this.selectType].check(),this.onSelectPanelByIndex(this.selectType),this.onSpotAlertChange(),b8e.evt.onC(this._skin.itemBtn,this.onSelectItem,this),b8e.evt.onC(this._skin.bianShenBtn,this.onSelectBianShen,this),b8e.evt.onC(this._skin.mysteryBtn,this.onSelectMystery,this),b8e.evt.onC(this._skin.honourBtn,this.onSelectHonour,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.itemBtn,this.onSelectItem,this),b8e.evt.offC(this._skin.bianShenBtn,this.onSelectBianShen,this),b8e.evt.offC(this._skin.mysteryBtn,this.onSelectMystery,this),b8e.evt.offC(this._skin.honourBtn,this.onSelectHonour,this),this.selectType=game.ShopType.Mystery,b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.dptG(game.MiscEvent.UPDATE_MAIN_MUNE_BUTTON_STATE)},onSpotAlertChange:function(){this._skin.drawAlert.active=game.shop.freeDrawAlert(),this._skin.mysteryAlert.active=game.shop.mysteryAlert()},onSelectItem:function(){this.selectType!=game.ShopType.Item&&(this.selectType=game.shop.selectType=game.ShopType.Item,this.onSelectPanelByIndex(game.ShopType.Item),this.ShowSmallBg())},onSelectBianShen:function(){this.selectType!=game.ShopType.BianShen&&(this.onSelectPanelByIndex(game.ShopType.BianShen),this.ShowBigBg())},onSelectMystery:function(){this.selectType!=game.ShopType.Mystery&&(this.onSelectPanelByIndex(game.ShopType.Mystery),this.ShowBigBg())},onSelectHonour:function(){this.selectType!=game.ShopType.Honour&&(this.selectType=game.shop.selectType=game.ShopType.Honour,this.onSelectPanelByIndex(game.ShopType.Honour),this.ShowSmallBg())},ShowBigBg:function(){this._skin.bigBg.active=!0,this._skin.smallBg.active=!1},ShowSmallBg:function(){this._skin.bigBg.active=!1,this._skin.smallBg.active=!0},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[1].check(),this.onSelectPanelByIndex(1),this._skin.buttonToggle[1]):"1"==e?(this._skin.buttonToggle[0].check(),this.onSelectPanelByIndex(0),this._skin.buttonToggle[0]):"2"==e?(this._skin.buttonToggle[2].check(),this.onSelectPanelByIndex(2),this._skin.buttonToggle[2]):"3"!=e||(this._skin.buttonToggle[3].check(),this.onSelectPanelByIndex(3),this._skin.buttonToggle[3]))},onSelectPanelByIndex:function(e){switch(this._curPanel&&this._curPanel.hide(),this.selectType=e,this.selectType){case game.ShopType.Item:this.sundries||(this.sundries=new game.ShopSundriesPanel,this.sundries.addToParent(this._skin.page)),this.sundries.show(),this._curPanel=this.sundries;break;case game.ShopType.BianShen:this.bianshen||(this.bianshen=new game.ShopBianshenPanel,this.bianshen.addToParent(this._skin.page)),this.bianshen.show(),this._curPanel=this.bianshen;break;case game.ShopType.Mystery:this.mystery||(this.mystery=new game.ShopMysteryPanel,this.mystery.addToParent(this._skin.page)),this.mystery.show(),this._curPanel=this.mystery;break;case game.ShopType.Honour:this.honour||(this.honour=new game.ShopHonourContentPanel,this.honour.addToParent(this._skin.page)),this.honour.show(),this._curPanel=this.honour}}})},{}],776:[function(e,t,i){"use strict";game.ShopSundriesPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("shop/ShopSundriesSkin","ShopSundriesSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.ShopListItem)),this.updateData(),this._list.show()},onHide:function(){this._list&&this._list.hide()},updateData:function(){var e=game.shop.getSelectItems();this._list.setData(e)}})},{}],777:[function(e,t,i){"use strict";game.ShopSender={},game.ShopSender.buy=function(e,t){var i=game.pbmsg.BuyGoodsRequest;i.shopId=e,i.count=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Shop.BuyGoodsRequest;b8e.sendN(n)},game.ShopSender.reqMystery=function(){var e=game.pbmid.Shop.QryMysteryRequest;b8e.sendN(e)},game.ShopSender.reqBuyMystery=function(e){var t=game.pbmsg.BuyMysteryRequest;t.shopId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Shop.BuyMysteryRequest;b8e.sendN(i)},game.ShopSender.reqRefreshMystery=function(){var e=game.pbmid.Shop.RefreshMysteryRequest;b8e.sendN(e)},game.ShopSender.reqShopRecord=function(){var e=game.pbmid.Shop.QryShopRecordRequest;b8e.sendN(e)}},{}],778:[function(e,t,i){"use strict";e("./cmd/ShopCmd"),e("./manager/ShopMgr"),e("./panel/ShopBuyPanel"),e("./panel/ShopListItem"),e("./panel/ShopPanel"),e("./sender/ShopSender"),e("./event/ShopEvents")},{"./cmd/ShopCmd":763,"./event/ShopEvents":764,"./manager/ShopMgr":765,"./panel/ShopBuyPanel":767,"./panel/ShopListItem":772,"./panel/ShopPanel":775,"./sender/ShopSender":777}],779:[function(e,t,i){"use strict";game.appModule.SkillDescPanel=game.SkinUIPanel.extends({_spellId:0,_skillIcon:null,_str:"",ctor:function(e){this._super(e)},onShow:function(){if(this.data){if(this._skillIcon||(this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_D)),this._skillIcon.setAnchor(.5,.5),this._skillIcon.addToParent(this._skin.skillIcon),this._skin.lab_power.node.active=!1,this.data.type==game.SkillIconType.TYPE_BEAUTY){var e=game.ccfg.BeautyDataCfg.getBeautyInfoById(this.data.id);if(!e)return;this._skin.lab_skill_name.string=game.html.getText(game.html.getColorByQuality(e.quality),"跟随技能"),this._skin.lab_skill_desc.string=e.followEffectDesc,this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_BEAUTY),this._skillIcon.setBeautySkillData(e.id)}else if(this.data.type==game.SkillIconType.TYPE_WING_SKILL){var t=game.ccfg.ItemInfoCfg.getItemInfoById(this.data.id);if(!t)return;var i=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing);if(!i)return;if(!(r=game.ccfg.AccessorySpellCfg.getDataById(this.data.id)))return;this._skin.lab_skill_name.string=game.html.getText(game.html.getColorByQuality(t.quality),t.name),this._skin.lab_skill_desc.string=t.desc,this._skin.lab_power.node.active=!0,this._skin.lab_power.string=i.getAccessorySkillCombatByIdx(t.id),this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_WING_SKILL),this._skillIcon.setAccessorySkillData(t.id)}else if(this.data.type==game.SkillIconType.TYPE_ORNAMENT_SKILL){var n=this.data.ornamentInfo;if(!n)return;var s=game.ccfg.OrnamentCfg.getQuality(n.itemId,n.level),a=game.ccfg.OrnamentCfg.getSkillName(n.itemId)+"("+n.level+"级)",o=game.html.getColorByQuality(s);this._skin.lab_skill_name.string=game.html.getText(o,a),this._skin.lab_skill_desc.string=game.ccfg.OrnamentCfg.getSkillDesc(n.itemId,n.level),this._skin.lab_power.node.active=!1,this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_ORNAMENT_SKILL),this._skillIcon.setOrnamentSkillData(n,!1,!1,!0)}else{var r;if(this._spellId=this.data.id,!(r=game.ccfg.SpellCfg.getSpellById(this._spellId)))return;this._skin.lab_skill_name.string=game.html.getText(game.html.getColorByQuality(r.quality),r.name),this._skin.lab_skill_desc.string=r.desc,this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_D),this._skillIcon.setData(this._spellId,!1)}this._skillIcon.show()}},onHide:function(){this._skillIcon&&this._skillIcon.removeFromParent(),this._skin.lab_skill_name.string="",this._skin.lab_skill_desc.string=""}})},{}],780:[function(e,t,i){"use strict";game.SkillIcon=game.SkinUI.extends({_iconImg:null,_spellId:0,_lock:!1,_name:null,_skillIconType:-1,_beautyId:0,_quality:0,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._super("skill/SkillIconSkin","SkillIconSkin"),this._skillIconType=e},onShow:function(){switch(this._iconImg||(b8e.log("create skillicon iconimage"),this._iconImg=b8e.Sprite.get(),this._iconImg.addToParent(this._skin.skillImg)),this._skillIconType==game.SkillIconType.TYPE_BEAUTY?this.setBeautySkillData(this._beautyId):this._skillIconType==game.SkillIconType.TYPE_WING_SKILL?this.setAccessorySkillData(this._spellId):this._skillIconType==game.SkillIconType.TYPE_ORNAMENT_SKILL?this.setOrnamentSkillData(this._ornamentInfo,this._showName,this._showNameLv,this._lock):this.setData(this._spellId,this._lock),this._skillIconType){case game.SkillIconType.TYPE_A:this._skin.skillName.node.active=!0,null!=this._name&&this.setSkillName(this._name);break;case game.SkillIconType.TYPE_B:case game.SkillIconType.TYPE_D:case game.SkillIconType.TYPE_BEAUTY:case game.SkillIconType.TYPE_WING_SKILL:this._skin.skillName.node.active=!1;break;case game.SkillIconType.TYPE_C:case game.SkillIconType.TYPE_ORNAMENT_SKILL:this._skin.skillName.node.active=!0}b8e.evt.onC(this._skin.skillImg,this.onClick,this)},onHide:function(){this.clearIcon(),b8e.evt.offC(this._skin.skillImg,this.onClick,this)},setData:function(e,t){if(this._spellId=e,this._lock=t,this._skin){var i=game.ccfg.SpellCfg.getSpellById(this._spellId);if(i){this._quality=i.quality;var n=game.ClientCfg.getSkillUrlByIconName(i.icon);this._iconImg.loadTexture(n,null,null,{useManifest:!1}),t?(b8e.ShaderUtil.setGray(this._iconImg),b8e.ShaderUtil.setGray(this._skin.skillQualityImg)):(b8e.ShaderUtil.reset(this._iconImg),b8e.ShaderUtil.reset(this._skin.skillQualityImg)),this.setQuality(this._quality),this._skin.skillName.string=game.html.getText(game.html.getColorByQuality(this._quality),i.name)}}},setBeautySkillData:function(e){if(e&&(this._beautyId=e,this._skin)){var t=game.ccfg.BeautyDataCfg.getBeautyInfoById(this._beautyId);if(t){var i=game.ClientCfg.getSkillUrlByIconName(t.followEffectIcon);this._iconImg.loadTexture(i,null,null,{useManifest:!1}),this.setQuality(t.quality)}}},setAccessorySkillData:function(e){if(e&&(this._spellId=e,this._skin)){var t=game.ccfg.ItemInfoCfg.getItemInfoById(this._spellId);if(t){var i=game.ClientCfg.getImgUrl(t.iconName);this._iconImg.loadTexture(i,null,null,{useManifest:!1}),this.setQuality(t.quality)}}},setOrnamentSkillData:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(e&&(this._ornamentInfo=e,this._lock=n,this._showName=t,this._showNameLv=i,this._skin)){var s=game.ClientCfg.getImgUrl(game.ccfg.OrnamentCfg.getSkillIconRes(this._ornamentInfo.itemId));if(this._iconImg.loadTexture(s,null,null,{useManifest:!1}),t){var a=game.ccfg.OrnamentCfg.getQuality(this._ornamentInfo.itemId,this._ornamentInfo.level),o=game.ccfg.OrnamentCfg.getSkillName(this._ornamentInfo.itemId)+(i?"("+this._ornamentInfo.level+"级)":""),r=game.html.getColorByQuality(a);this.setSkillName(game.html.getText(r,o))}else this.setSkillName("");this.setQuality(game.ccfg.OrnamentCfg.getQuality(this._ornamentInfo.itemId,this._ornamentInfo.level))}},setSkillName:function(e){this._name=e,this._skin&&(this._skin.skillName.string=this._name)},setQuality:function(e){var t=game.ClientCfg.GRIDS_ALAST_URL;game.resController.setQualitySpriteFrame(this._skin.skillQualityImg,e,t,game.ContainerId.SKILL_CONTAINER_ID)},setSkillIconType:function(e){this._skillIconType=e},addEvent:function(){},removeEvent:function(){},clearIcon:function(){this._iconImg&&this._iconImg.unloadTexture(),this._skin&&(this._skin.skillName.node.active=!0)},onClick:function(){if(!this._lock)switch(this._skillIconType){case game.SkillIconType.TYPE_A:case game.SkillIconType.TYPE_B:game.app.show(game.AppConstant.SKILL_DESC_PANEL,{id:this._spellId,type:game.SkillIconType.TYPE_A});break;case game.SkillIconType.TYPE_C:break;case game.SkillIconType.TYPE_BEAUTY:game.app.show(game.AppConstant.SKILL_DESC_PANEL,{id:this._beautyId,type:game.SkillIconType.TYPE_BEAUTY});break;case game.SkillIconType.TYPE_ORNAMENT_SKILL:game.app.show(game.AppConstant.SKILL_DESC_PANEL,{ornamentInfo:this._ornamentInfo,type:game.SkillIconType.TYPE_ORNAMENT_SKILL})}}})},{}],781:[function(e,t,i){"use strict";game.SkillCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Spell.CastSpellResponse,this.CastSpellResponse,this),b8e.addNH(game.pbmid.Spell.CastSpellNotify,this.CastSpellNotify,this),b8e.addNH(game.pbmid.Scene.InstallBuffsNotify,this.onInstallBuffsNotify,this),b8e.addNH(game.pbmid.Scene.RemoveBuffsNotify,this.onRemoveBuffsNotify,this)},onRemoveBuffsNotify:function(e){var t=e.readProtobuf(game.pbmsg.RemoveBuffsNotify);if(t){var i=game.sceneRole.getDisplayById(t.unitEid);i?game.BuffUtil.removeBuffs(i,t.buffIds):b8e.log("服务器发送添加buff ，但是找不到指定角色",t.unitEid)}},onInstallBuffsNotify:function(e){var t=e.readProtobuf(game.pbmsg.InstallBuffsNotify);if(t){var i=game.sceneRole.getDisplayById(t.unitEid);i?game.BuffUtil.addBuffs(i,t.buffs):b8e.log("服务器发送添加buff ，但是找不到指定角色",t.unitEid)}},CastSpellResponse:function(e){var t=e.readProtobuf(game.pbmsg.CastSpellResponse);if(t)if(0<t.code)switch(t.code){case 1901:case 1902:break;case 1903:case 1904:var i=t.targetEid,n=game.sceneRole.getDisplayById(i);if(n)n.release(),game.ScenePickMgr.inst().getTarget()==i&&game.ScenePickMgr.inst().selectTarget(null)}else{var s=game.skill.getSkillById(t.spellId);s&&t.cdFinishTs>s.cdFinishTime&&(s.cdFinishTime=t.cdFinishTs)}},CastSpellNotify:function(e){var t=e.readProtobuf(game.pbmsg.CastSpellNotify);if(t){game.mainRole.mainRoleData;var i=game.sceneRole.getDisplayById(t.casterEid);if(i&&i.data){var n=game.ccfg.SpellCfg.getSpellById(t.spellId);if(n){if(t.casterPos){var s=i.getGridPosition();0!=i.data.isSelf||s.x==t.casterPos.x&&s.y==t.casterPos.y||i.setGridPosition(t.casterPos.x,t.casterPos.y)}var a=game.SceneMgr.inst().getSceneConfig();if(0==i.data.isSelf||a.type==game.SceneType.ARENA){if(!i.getHierarchyVisible())return;if(!i.getAttachVisible(game.AttachType.BODY))return;var o=game.SpellReleaseHelper.inst().releaseSpellInfo;o.clear(),o.releaseEntityId=i.id,o.releaseSpellId=t.spellId,o.direction=t.direction,o.targetId=t.targetEid,o.targetIds=[];for(var r=0;r<t.victims.length;r++)o.targetIds.push(t.victims[r].victimEid);game.SpellReleaseHelper.inst().releaseSpell(o,!0)}var h=0,g=game.ScenePickMgr.inst().getTarget();for(r=0;r<t.victims.length;r++){var l=t.victims[r],c=game.sceneRole.getDisplayById(l.victimEid);if(c&&c.data){var u;i.data.isSelf&&g&&g.data&&c.data.id==g.data.id&&c.showBar(),c.updateLastAttackMeId(i.data.id);var m=c.data.spriteStat.getStatValue(game.SpriteStatType.HP);if((m+=l.hpDelta)<=0)if(c.data.type==game.RoleType.Hero)c.usable&&!c.getStateMachine().isDeadState()?b8e.log("角色已经死亡了"):c.transitionState(game.RoleStateType.ACTION_DEATH,null,!0);else if(c.data.type==game.RoleType.Monster){c.data.getMonsterType()!=game.MonsterType.WORLD_BOSS&&((u=c.getStateRef(game.DeathFlyReference)).setParams(i.data.id,n.releaseDelay),c.transitionState(game.RoleStateType.ACTION_DEATH_FLY,u))}++h<=5&&((u=c.getStateRef(game.HitEffectReference)).setParams(i.data.id,n.hurtEffect,n.releaseDelay,l.hpDelta),u.hitType=l.resultType,u.isInTarget=n.isInTarget,c.transitionState(game.RoleStateType.CONTROL_HIT_EFFECT,u),b8e.Tween.get(c).wait(n.releaseDelay).call(game.bounceCharacters.hitFace,game.bounceCharacters,[i,c,u.hurtValue,u.hitType,c.data.isSelf]))}}}}}}})},{}],782:[function(e,t,i){"use strict";game.SkillMgr=b8e.Object.extends({_skillDataSet:null,_batchList:null,nextSpellId:0,resetNextSpellTime:0,root:{type:cc.Node,get:function(){return game.PlotMgr.inst().isPlaying()?b8e.layer.getTopLayer():b8e.layer.getGuiLayer()}},ctor:function(){this._super(),this._skillDataSet=[],this._batchList=b8e.HashMap.get()},getNextSpellId:function(){return this.nextSpellId},getSkillById:function(t){var i=null;return this._skillDataSet.some(function(e){if(e.protoId==t)return i=e,!0}),i},sortSkill:function(e,t){var i=game.ccfg.SpellCfg.getSpellById(e.protoId),n=game.ccfg.SpellCfg.getSpellById(t.protoId);return i.sort==n.sort?e.protoId>t.protoId?1:-1:i.sort>n.sort?-1:1},getAllSkillData:function(){return this._skillDataSet},_clearSkillData:function(){this._skillDataSet.forEach(function(e){e.release()}),this._skillDataSet.length=0,this.nextSpellId=0,this.resetNextSpellTime=0,b8e.res.unloadBatchRes(this._batchList.values(),this.batchLoadProcess,this),this._batchList.clear()},initSpell:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._clearSkillData();var t=0;t=e?e.modelId:game.ShapeShiftMgr.inst().getShapeId();var i=game.ccfg.HeroCfg.getSpellListById(t);if(i){b8e.log("初始化技能成功,modelId",t);for(var n=0;n<i.length;n++){var s=i[n],a=game.ccfg.SpellCfg.getSpellById(s);if(a.spellType!=game.SpellType.Passive){var o=game.SkillData.get();o.protoId=s,o.maxDistance=a.releaseDistance,o.cdDuration=a.cd,o.isNormalSpell=a.isNormalSpell,this._skillDataSet.push(o),this.addLoadSpellEffect(s)}}var r=0;if(e?r=e.faBaoResId:game.FaBaoMgr().accessoryData&&(r=game.FaBaoMgr().accessoryData.wearedLv),0<r){var h=game.ccfg.FaBaoCfg.getSpellIdByLv(r);0<h&&(s=h,a=game.ccfg.SpellCfg.getSpellById(s),(o=game.SkillData.get()).protoId=s,o.maxDistance=a.releaseDistance,o.cdDuration=a.cd,o.isNormalSpell=a.isNormalSpell,this._skillDataSet.push(o),this.addLoadSpellEffect(s))}this._skillDataSet.sort(this.sortSkill),b8e.res.loadBatchRes(this._batchList.values(),this.batchLoadProcess,this,null,!0)}else b8e.error("初始化技能失败！！modelId",t)},addLoadSpellEffect:function(e){var t=game.ccfg.SpellCfg.getSpellById(e);if(t){if(t.releaseEffect){var i=game.ClientCfg.getSkillFx(t.releaseEffect);this._batchList.set(i,{url:i,type:b8e.AnimatorResource,useManifest:!1,preload:!0})}if(e==t.nextSpellId)return void b8e.error("技能 ",e," 与 nextSpellId重复！");this.addLoadSpellEffect(t.nextSpellId)}},releaseSpell:function(e){var t=game.ccfg.SpellCfg.getSpellById(e);if(t&&t.nameEffect){var i=b8e.Animator.get(game.AnimatorType.FA_BAO_NAME_EFFECT,e);i.setAnchor(.5,.5),i.addToParent(this.root),i.autoRelease();var n=game.ClientCfg.getUIFxs(t.nameEffect);i.load(n);var s=b8e.stageWidth*t.nameEffectPosX/100,a=b8e.stageHeight*t.nameEffectPosY/100;i.setPosition(s,a),i.play()}},batchLoadProcess:function(e,t,i,n){e||i==n&&(b8e.res.unloadBatchRes(this._batchList.values(),this.batchLoadProcess,this),this._batchList.clear())}}),game.SkillMgr._instance=null,game.SkillMgr._singleton=!0,game.SkillMgr.inst=function(){return null==game.SkillMgr._instance&&(game.SkillMgr._singleton=!1,game.SkillMgr._instance=new game.SkillMgr,game.SkillMgr._singleton=!0),game.SkillMgr._instance}},{}],783:[function(e,t,i){"use strict";e("./SkillMgr")},{"./SkillMgr":782}],784:[function(e,t,i){"use strict";e("./manager/managerIndex_12"),e("./SkillIcon"),e("./cmd/SkillCmd")},{"./SkillIcon":780,"./cmd/SkillCmd":781,"./manager/managerIndex_12":783}],785:[function(e,t,i){"use strict";game.SpriteStatMgr=b8e.Object.extends({type:0,lv:0,nowSpriteStat:null,nextSpriteStat:null,show:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(i){var s=game.ccfg.SpriteStatCfg.getSpriteStatById(i),a=game.ccfg.SpriteStatCfg.getSpriteStatById(n);this.showSpriteStat(e,t,s,a)}else b8e.log("SpriteStatMgr.show nowSpriteStatId 为0")},showSpriteStat:function(e,t,i,n){i?(this.type=e,this.lv=t,this.nowSpriteStat=i,this.nextSpriteStat=n,game.app.show(game.AppConstant.SPRITE_STAT_PANEL)):b8e.log("SpriteStatMgr.showSpriteStat nowSpriteStat 为 null")}}),game.SpriteStatMgr._instance=null,game.SpriteStatMgr.inst=function(){return game.SpriteStatMgr._instance||(game.SpriteStatMgr._instance=new game.SpriteStatMgr),game.SpriteStatMgr._instance}},{}],786:[function(e,t,i){"use strict";game.appModule.SpriteStatPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this.setup()},onHide:function(){this.clearLabel()},clearLabel:function(){this._skin.lab_attr_num.string="",this._skin.lab_attr_name1.string="",this._skin.lab_attr_cur_num.string="",this._skin.lab_attr_next_num.string="",this._skin.lab_attr_name2.string=""},setup:function(){if(this.clearLabel(),this._skin){var e,t=game.spriteStat;switch(t.type){case game.SpriteStatShowType.Beauty:e="美人属性";break;case game.SpriteStatShowType.Mount:e="坐骑属性";break;case game.SpriteStatShowType.Wing:e="翅膀属性";break;case game.SpriteStatShowType.FaBao:e="法宝属性";break;case game.SpriteStatShowType.Bianshen:e="变身属性";break;case game.SpriteStatShowType.XianZhen:e="仙阵属性"}if(t.nextSpriteStat){this._skin.max_level_nodes.active=!1,this._skin.nomax_level_nodes.active=!0,this._skin.lab_title_normal.string=e;var i=this.getSpriteStatAttr(t.nowSpriteStat),n=this.getSpriteStatAttr(t.nextSpriteStat),s=this.getSpriteStatName(t.nowSpriteStat);switch(t.type){case game.SpriteStatShowType.Beauty:this._skin.lab_attr_cur_num.string=game.html.getText(game.html.Q_GREEN,"亲密度"+t.lv+"\n")+i,this._skin.lab_attr_next_num.string=game.html.getText(game.html.Q_GREEN,"亲密度"+(t.lv+1)+"\n")+n;break;case game.SpriteStatShowType.Mount:case game.SpriteStatShowType.Wing:case game.SpriteStatShowType.FaBao:case game.SpriteStatShowType.XianZhen:0==t.lv?this._skin.lab_attr_cur_num.string=game.html.getText(game.html.Q_GREEN,"未激活\n")+i:this._skin.lab_attr_cur_num.string=game.html.getText(game.html.Q_GREEN,t.lv+" 阶\n")+i,this._skin.lab_attr_next_num.string=game.html.getText(game.html.Q_GREEN,t.lv+1+" 阶\n")+n;break;case game.SpriteStatShowType.Bianshen:}this._skin.lab_attr_name2.string=s}else{this._skin.max_level_nodes.active=!0,this._skin.nomax_level_nodes.active=!1,this._skin.lab_title_max.string=e;i=this.getSpriteStatAttr(t.nowSpriteStat),s=this.getSpriteStatName(t.nowSpriteStat);switch(t.type){case game.SpriteStatShowType.Beauty:this._skin.lab_attr_num.string=game.html.getText(game.html.Q_GREEN,"亲密度"+t.lv+"\n")+i;break;case game.SpriteStatShowType.Mount:case game.SpriteStatShowType.Wing:case game.SpriteStatShowType.FaBao:case game.SpriteStatShowType.XianZhen:this._skin.lab_attr_num.string=game.html.getText(game.html.Q_GREEN,t.lv+" 阶\n")+i;break;case game.SpriteStatShowType.Bianshen:var a=game.html.getText(game.html.Q_GREEN,"等级"+t.lv+"\n")+this.getBianshenSpriteStatAttr(t.nowSpriteStat);this._skin.lab_attr_num.string=a}this._skin.lab_attr_name1.string=s}}},getSpriteStatAttr:function(e){var t="",i="",n=e.getSpriteStats();if(n&&0<n.length){for(var s=0;s<n.length;s++){var a=n[s];a&&(s!=n.length-1&&(i="\n"),t+=a.value+i)}return t}},getBianshenSpriteStatAttr:function(e){var t=1,i=0,n=game.bianshen.curBianshenIdx,s=game.bianshen.getBianshenInfoByidx(n);if(s){var a=game.ccfg.BianshenUpgradeLvCfg.getDataByLv(s.level);i=game.ccfg.BianshenUpgradeJieCfg.getAttrCoefByJie(s.jie),t=a.attrCoef*i}var o="",r="",h=e.getSpriteStats();if(h&&0<h.length){for(var g=0;g<h.length;g++){var l=h[g];if(l)g!=h.length-1&&(r="\n"),o+=~~(l.value*t)+r}return o}},getSpriteStatName:function(e){var t="",i="",n="",s=e.getSpriteStats();if(s&&0<s.length){for(var a=0;a<s.length;a++){var o=s[a];o&&(t=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type),a!=s.length-1&&(n="\n"),i+=t+n)}return i}}})},{}],787:[function(e,t,i){"use strict";game.SpriteStatShowType=b8e.Enum({Beauty:1,Mount:2,Wing:3,FaBao:4,Bianshen:5,XianZhen:6,WingSkill:7})},{}],788:[function(e,t,i){"use strict";e("./SpriteStatMgr"),e("./SpriteStatPanel"),e("./SpriteStatShowType")},{"./SpriteStatMgr":785,"./SpriteStatPanel":786,"./SpriteStatShowType":787}],789:[function(e,t,i){"use strict";game.GotoType=b8e.Enum({MOUNT_UP:3105,WING_UP:3106,FABAO_UP:3107})},{}],790:[function(e,t,i){"use strict";game.StrengthenAttType=b8e.Enum({EQUIP_TYPE:0,BIANSHEN_TYPE:1,MOUNT_TYPE:2,FABAO_TYPE:3,WING_TYPE:4,BEAUTY_TYPE:5,GOLD_TYPE:100,DIAMOND_TYPE:101,MOUNT_PILL_TYPE:102,REPUTATION_TYPE:103})},{}],791:[function(e,t,i){"use strict";game.StrengthenKindId=b8e.Enum({STRENGTHEN_SYSTEM_TYPE:1,STRENGTHEN_ITEM_TYPE:2})},{}],792:[function(e,t,i){"use strict";e("./StrengthenAttType"),e("./GotoType")},{"./GotoType":789,"./StrengthenAttType":790}],793:[function(e,t,i){"use strict";game.FailueBannerId=b8e.Enum({FIRST_RECHARGE:1,SALE_DISCOUNT:2,DISCOUNT_DAILY:3,MYSTERY_SHOP:4})},{}],794:[function(e,t,i){"use strict";game.StrengthenEvent=b8e.Enum({CLICK_ATT_ITEMS:b8e.Event.nextCode(),CLICK_STRENGTHEN_BTN:b8e.Event.nextCode(),CLICK_GETRES_BTN:b8e.Event.nextCode(),SELECT_TYPE_CHANGE:b8e.Event.nextCode(),UPDATA_PANEL:b8e.Event.nextCode()})},{}],795:[function(e,t,i){"use strict";e("./StrengthenEvent")},{"./StrengthenEvent":794}],796:[function(e,t,i){"use strict";game.StrengthenMgr=b8e.Object.extends({name:"StrengthenMgr",_zhanli:0,_partPower:0,_partEquipPower:0,_type:0,_strengthenInfoArr:null,_scoreArr:null,_selectAttId:0,_index:-1,_attArr:null,ctor:function(){if(1==game.StrengthenMgr._singleton)throw new Error("StrengthenMgr 只能通过单例方法获取");this._map=b8e.HashMap.get(),this._strengthenInfoArr=[],this._scoreArr=[],this._attArr=[],this._type=1},setAttInfoArrById:function(e){this._strengthenInfoArr.length=0;for(var t,i=game.ccfg.StrengthenCfg.getArrByType(e),n=0;n<i.length;n++)t=i[n],this.addStrengthenAtt(t);b8e.evt.dptG(game.StrengthenEvent.UPDATA_PANEL)},addStrengthenAtt:function(e){var t=new game.StrengthenInfo,i=this.getStrengthenPowerInfo();if(t&&i){switch(e.id){case game.StrengthenAttType.EQUIP_TYPE:this._partEquipPower=game.equip.getEquipTotalPower(),t.score=this._partEquipPower/i.equip,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partEquipPower;break;case game.StrengthenAttType.BIANSHEN_TYPE:this._partPower=game.bianshen.getBattleAllBianshenCombat(),t.score=this._partPower/i.bianshen,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partPower;break;case game.StrengthenAttType.MOUNT_TYPE:var n=game.AccessoryMgr.getMgrByType(game.AccessoryType.Mount).getDataLvCfg();this._partPower=n.power,t.score=this._partPower/i.mount,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partPower;break;case game.StrengthenAttType.FABAO_TYPE:n=game.AccessoryMgr.getMgrByType(game.AccessoryType.FaBao).getDataLvCfg();this._partPower=n.power,t.score=this._partPower/i.fabao,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partPower;break;case game.StrengthenAttType.WING_TYPE:n=game.AccessoryMgr.getMgrByType(game.AccessoryType.Wing).getDataLvCfg();this._partPower=n.power,t.score=this._partPower/i.wing,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partPower;break;case game.StrengthenAttType.BEAUTY_TYPE:this._partPower=game.beauty.getBeautyCombat(),t.score=this._partPower/i.equip,t.grade=game.ccfg.StrengthenGradeCfg.getGrade(1,t.score),t.partPower=this._partPower;break;case game.StrengthenAttType.GOLD_TYPE:case game.StrengthenAttType.DIAMOND_TYPE:case game.StrengthenAttType.MOUNT_PILL_TYPE:}t.kindId=e.kindId,t.id=e.id,t.title=e.title,t.goto=e.goto,t.iconName=e.iconName,t.openId=e.openId,this._strengthenInfoArr.push(t),this._map.set(t.id,t)}},getStrengthenInfoArr:function(){return this._strengthenInfoArr},getItemInfoByType:function(e){return this._map.get(e)},getGotoArrById:function(e){var t=this.getItemInfoByType(e);return t?t.goto.split(","):[]},changeSelectId:function(e){this._selectAttId=e},getSelectId:function(){return this._selectAttId},getZhanli:function(){var e=game.mainRole.mainRoleData;return this._zhanli=e.getZhanLi(),this._zhanli},getBannerPathById:function(e){var t=game.ccfg.FailueBannerCfg.getDataById(e);return t?t.bg:""},getScoreUpArr:function(){return this._scoreArr=this._strengthenInfoArr,this._scoreArr&&0<this._scoreArr.length&&this._scoreArr.sort(this.onSortByScore),this._scoreArr},filterScoreArr:function(e){if(e&&0<e.length){for(var t,i=e.length-1;0<=i;i--)t=e[i],game.funcOpen.checkOpen(t.openId)||e.splice(i,1);return e}return[]},getStrengthenPowerInfo:function(){var e=game.mainRole.mainRoleData;if(e){var t=e.getLv();return game.ccfg.StrengthenPowerCfg.getPowerInfoByLv(t)}},onSortByScore:function(e,t){return e.score>t.score?1:e.score<t.score?-1:0}}),game.StrengthenMgr._instance=null,game.StrengthenMgr._singleton=!0,game.StrengthenMgr.inst=function(){return game.StrengthenMgr._instance||(game.StrengthenMgr._singleton=!1,game.StrengthenMgr._instance=new game.StrengthenMgr,game.StrengthenMgr._singleton=!0),game.StrengthenMgr._instance}},{}],797:[function(e,t,i){"use strict";e("./StrengthenMgr")},{"./StrengthenMgr":796}],798:[function(e,t,i){"use strict";game.StrDefeatedItem=game.SkinUI.extends({_data:null,_scoreInfo:null,ctor:function(e){this._super("strengthen/StrDefeatedItemSkin","StrDefeatedItemSkin"),this._scoreInfo=e},getHeight:function(){return 83},getWidth:function(){return 83},onShow:function(){this.setData(this._scoreInfo),b8e.evt.onC(this._skin.node_click,this.onClickItem,this)},onHide:function(){this._imgSprite&&this._imgSprite.unloadTexture(),b8e.evt.offC(this._skin.node_click,this.onClickItem,this)},setData:function(e){if(this._scoreInfo=e,this._skin&&this._scoreInfo){this.setIcon(this._scoreInfo.iconName),this._imgSprite||(this._imgSprite=b8e.Sprite.get(),this._imgSprite.addToParent(this._skin.img_grade));var t=game.ClientCfg.getImgUrl("strengthen/"+this._scoreInfo.grade);this._imgSprite.loadTexture(t,null,null,{useManifest:!1})}},onClickItem:function(){switch(parseInt(this._scoreInfo.id)){case game.StrengthenAttType.EQUIP_TYPE:game.app.show(game.AppConstant.EQUIP_FORGE_PANEL);break;case game.StrengthenAttType.BIANSHEN_TYPE:game.app.show(game.AppConstant.BIANSHEN_PANEL);break;case game.StrengthenAttType.MOUNT_TYPE:game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.StrengthenAttType.FABAO_TYPE:game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.StrengthenAttType.WING_TYPE:game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;case game.StrengthenAttType.BEAUTY_TYPE:game.app.show(game.AppConstant.BEAUTY_PANEL)}},setIcon:function(e){if(""!=e){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon));var t=game.ClientCfg.getImgUrl(e);this._iconSprite.loadTexture(t,null,null,{useManifest:!1})}}})},{}],799:[function(e,t,i){"use strict";game.StrengthenAtt=game.SkinUI.extends({_id:0,_strengthenAttInfo:null,_attFont:"",_partPower:0,_gradeArr:null,ctor:function(e){this._super("strengthen/StrengthenAttSkin","StrengthenAttSkin"),this._strengthenAttInfo=e,this._attFont="",this._gradeArr=[]},getHeight:function(){return 60},getWidth:function(){return 124},onShow:function(){this.setData(this._strengthenAttInfo),this._id=this._strengthenAttInfo.id,this._partPower=this._strengthenAttInfo.partPower,b8e.evt.onC(this._skin.buttonToggle.node,this.onClickAttItem,this),0==this._id&&this.firstComeIn()},onHide:function(){this._iconSprite&&this._iconSprite.unloadTexture(),this._itemIconSprite&&this._itemIconSprite.unloadTexture(),b8e.evt.offC(this._skin.buttonToggle.node,this.onClickAttItem,this)},firstComeIn:function(){this._skin.buttonToggle.isChecked=!0},setData:function(e){if(this._strengthenAttInfo=e,this._skin&&this._strengthenAttInfo){this._skin.buttonToggle.isChecked=!1;var t=game.strengthen.getSelectId();if(this._strengthenAttInfo.id==t&&(this._skin.buttonToggle.isChecked=!0),e)if(this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon)),this._itemIconSprite||(this._itemIconSprite=b8e.Sprite.get(),this._itemIconSprite.addToParent(this._skin.img_icon)),this._skin.lab_item.string=e.title,1==e.kindId){this._itemIconSprite.unloadTexture();var i=game.ClientCfg.getImgUrl("strengthen/"+e.grade);this._iconSprite.loadTexture(i,null,null,{useManifest:!1})}else{this._iconSprite.unloadTexture();var n=game.ClientCfg.getImgUrl(e.iconName);this._itemIconSprite.setScale(.5,.5),this._itemIconSprite.loadTexture(n,null,null,{useManifest:!1})}}},onClickAttItem:function(){game.strengthen.changeSelectId(this._strengthenAttInfo.id),b8e.evt.dptG(game.StrengthenEvent.CLICK_ATT_ITEMS)}})},{}],800:[function(e,t,i){"use strict";game.StrengthenItem=game.SkinUI.extends({_type:-1,_iconSprite:null,_gotoInfo:null,ctor:function(e){this._super("strengthen/StrengthenItemSkin","StrengthenItemSkin"),this._type=e},onShow:function(){this.setData(this._type),b8e.evt.onC(this._skin.btn_go,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.btn_go,this.onClickItem,this)},setData:function(e){if(this._type=e,this._gotoInfo=game.ccfg.GotoCfg.getDataByKey(e),this._skin&&this._gotoInfo){this._skin.lab_describe.string=this._gotoInfo.describe,this._skin.lab_solution.string=this._gotoInfo.title;var t=parseInt(this._gotoInfo.triggerId);this._skin.lab_close.string="未开启";var i=game.ccfg.ClientTriggerCfg.getDataById(t);if(i){var n=game.ccfg.ClientCommandCfg.getDataById(i.triggerCommandIds);n&&(game.funcOpen.checkOpen(n.functionOpenId)?this._skin.btn_go.active=!0:(this._skin.btn_go.active=!1,this._skin.lab_close.string="未开启"))}}},onClickItem:function(){var e=game.ccfg.ClientTriggerCfg.getDataById(this._gotoInfo.triggerId);if(e)switch(parseInt(e.triggerCommandIds)){case game.GotoType.MOUNT_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Mount);break;case game.GotoType.FABAO_UP:game.AccessoryMgr.showPanel(game.AccessoryType.FaBao);break;case game.GotoType.WING_UP:game.AccessoryMgr.showPanel(game.AccessoryType.Wing);break;default:game.TriggerMgr.inst().customTriggerById(e.triggerCommandIds)}}})},{}],801:[function(e,t,i){"use strict";game.appModule.StrengthenPanel=game.SkinUIPanel.extends({_attArr:null,_itemArr:null,listItems:null,itemPool:null,list:null,_curVisibleArr:null,_curArr:null,_zhanli:0,_index:1,_list:null,ctor:function(e){this._super(e),this._attArr=[],this._itemArr=[],this.listItems=[],this.itemPool=[],this.list=[],this._curVisibleArr=[],this._curArr=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list_attribute,game.StrengthenAtt)),this._list.show(),this._zhanli=game.strengthen.getZhanli(),this._skin.lab_num1.string=this._zhanli,b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickStrengthen,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickGetRes,this),b8e.evt.addG(this,game.StrengthenEvent.CLICK_ATT_ITEMS,this.updataPanel),b8e.evt.addG(this,game.StrengthenEvent.UPDATA_PANEL,this.updataPanel),b8e.evt.addG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updataPower),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.updataPower),b8e.evt.addG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updataPower),b8e.evt.addG(this,game.EquipEvt.PUT_ON_EQUIP,this.updataPower),b8e.evt.addG(this,game.EquipEvt.EQUIP_INTENSISY_SUCCESS,this.updataPower),b8e.evt.addG(this,game.EquipEvt.ALL_EQUIP_INTENSISY_SUCCESS,this.updataPower),b8e.evt.addG(this,game.EquipEvt.EQUIP_UPGRADE_STAR_COMPLETE,this.updataPower),b8e.evt.addG(this,game.EquipEvt.EQUIP_REFINE_SUCCESS,this.updataPower),b8e.evt.addG(this,game.BeautyEvent.REFRESH_BEAUTY,this.updataPower),b8e.evt.addG(this,game.AccessoryEvent.AccessoryUpgrade,this.updataPower),game.strengthen.setAttInfoArrById(game.StrengthenKindId.STRENGTHEN_SYSTEM_TYPE),this.data?this.selectAttByType(this.data):this.onClickStrengthen()},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickStrengthen,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickGetRes,this),b8e.evt.rmvG(this,game.StrengthenEvent.CLICK_ATT_ITEMS,this.updataPanel),b8e.evt.rmvG(this,game.StrengthenEvent.UPDATA_PANEL,this.updataPanel),b8e.evt.rmvG(this,game.BianshenEvent.INTO_BATTLE_SLOT,this.updataPower),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_UPGRADE,this.updataPower),b8e.evt.rmvG(this,game.BianshenEvent.BIANSHEN_JINJIE,this.updataPower),b8e.evt.rmvG(this,game.EquipEvt.PUT_ON_EQUIP,this.updataPower),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_INTENSISY_SUCCESS,this.updataPower),b8e.evt.rmvG(this,game.EquipEvt.ALL_EQUIP_INTENSISY_SUCCESS,this.updataPower),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_UPGRADE_STAR_COMPLETE,this.updataPower),b8e.evt.rmvG(this,game.EquipEvt.EQUIP_REFINE_SUCCESS,this.updataPower),b8e.evt.rmvG(this,game.BeautyEvent.REFRESH_BEAUTY,this.updataPower),b8e.evt.rmvG(this,game.AccessoryEvent.AccessoryUpgrade,this.updataPower)},updataPower:function(){game.strengthen.setAttInfoArrById(game.StrengthenKindId.STRENGTHEN_SYSTEM_TYPE)},updataPanel:function(){this.updateAttItems(),this.updateItems()},updateAttItems:function(){var e=game.strengthen.getStrengthenInfoArr();e&&0<e.length&&this._list.setData(e)},updateItems:function(){this.clearItem();var e,t=game.strengthen.getSelectId(),i=game.strengthen.getGotoArrById(t),n=game.strengthen.getItemInfoByType(t);1==n.kindId&&(this._skin.lab_partPower.string=n.title+"战力:",this._skin.lab_num2.string=n.partPower);for(var s=this._itemArr.length,a=0;a<i.length;a++){var o=i[a];o&&(a<s?(e=this._itemArr[a]).setData(o):(e=new game.StrengthenItem(o),this._itemArr.push(e)),e.setAnchor(.5,1),e.addToParent(this._skin.content1),e.show(),this._curVisibleArr.push(e))}},onClickStrengthen:function(){1!=this._index&&(this._index=1,this.clearItem(),this._skin.buttonToggle[0].check(),this._skin.node_head.active=!0,this._skin.list_attribute.node.y=715,this._skin.list_solution.node.y=715,this._skin.title.string="我要变强",this._skin.lab_partPower.string="装备战力:",this._skin.lab_num1.string=this._zhanli,this._skin.lab_num2.string=game.strengthen._partEquipPower,this._attArr.length=0,game.strengthen.changeSelectId(game.StrengthenAttType.EQUIP_TYPE),game.strengthen.setAttInfoArrById(game.StrengthenKindId.STRENGTHEN_SYSTEM_TYPE))},onClickGetRes:function(){2!=this._index&&(this.clearItem(),this._index=2,this._skin.buttonToggle[1].check(),this._skin.list_attribute.node.y=780,this._skin.list_solution.node.y=780,this._skin.node_head.active=!1,this._skin.title.string="获取资源",this._attArr.length=0,game.strengthen.changeSelectId(game.StrengthenAttType.GOLD_TYPE),game.strengthen.setAttInfoArrById(game.StrengthenKindId.STRENGTHEN_ITEM_TYPE))},selectAttByType:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:game.StrengthenKindId.STRENGTHEN_ITEM_TYPE;this.clearItem(),this._index=t,this._skin.buttonToggle[1].check(),this._skin.list_attribute.node.y=780,this._skin.list_solution.node.y=780,this._skin.node_head.active=!1,this._skin.title.string="获取资源",this._attArr.length=0,game.strengthen.changeSelectId(e),game.strengthen.setAttInfoArrById(t)},clearItem:function(){if(this._curVisibleArr&&!(this._curVisibleArr.length<=0)){for(var e=0;e<this._curVisibleArr.length;e++){var t=this._curVisibleArr[e];t&&(t.removeFromParent(),t.hide())}this._curVisibleArr.length=0}},setTab:function(e){return!!this._skin&&("0"==e?(this.onClickStrengthen(),this._skin.buttonToggle[0]):"1"!=e||(this.onClickGetRes(),this._skin.buttonToggle[1]))}})},{}],802:[function(e,t,i){"use strict";e("./StrengthenItem"),e("./StrengthenPanel"),e("./StrengthenAtt"),e("./StrDefeatedItem")},{"./StrDefeatedItem":798,"./StrengthenAtt":799,"./StrengthenItem":800,"./StrengthenPanel":801}],803:[function(e,t,i){"use strict";e("./panel/panelIndex_84"),e("./enum/attIndex_0"),e("./manager/managerIndex_84")},{"./enum/attIndex_0":792,"./manager/managerIndex_84":797,"./panel/panelIndex_84":802}],804:[function(e,t,i){"use strict";game.SuraCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Sura.QrySuraOverviewResponse,this.onQrySuraOverviewResponse,this),b8e.addNH(game.pbmid.Sura.JoinSuraResponse,this.onJoinSuraResponse,this),b8e.addNH(game.pbmid.Sura.QuitSuraResponse,this.onQuitSuraResponse,this),b8e.addNH(game.pbmid.Sura.SuraLevelDataNotify,this.onSuraLevelDataNotify,this),b8e.addNH(game.pbmid.Sura.SuraScoreUpdateNotify,this.onSuraScoreUpdateNotify,this),b8e.addNH(game.pbmid.Sura.SuraDefeatNotify,this.onSuraDefeatNotify,this),b8e.addNH(game.pbmid.Sura.SuraReliveResponse,this.onSuraReliveResponse,this),b8e.addNH(game.pbmid.Sura.SuraReliveNotify,this.onSuraReliveNotify,this),b8e.addNH(game.pbmid.Sura.SuraEndNotify,this.onSuraEndNotify,this),b8e.addNH(game.pbmid.Sura.SuraOngoingNotify,this.onSuraOngoingNotify,this),b8e.addNH(game.pbmid.Sura.SuraRankResponse,this.onSuraRankResponse,this),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.loadSuraSceneComplete)},loadSuraSceneComplete:function(){game.sura.loadSuraSceneComplete()},onQrySuraOverviewResponse:function(e){var t=e.readProtobuf(game.pbmsg.QrySuraOverviewResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.setupsuraOverViewInit(t)}else b8e.log("获取修罗战场玩法总览数据失败")},onJoinSuraResponse:function(e){var t=e.readProtobuf(game.pbmsg.JoinSuraResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):b8e.log("加入成功")}else b8e.log("加入失败")},onQuitSuraResponse:function(e){var t=e.readProtobuf(game.pbmsg.QuitSuraResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.quitSuraSceneSucceed()}else b8e.log("退出战场失败")},onSuraLevelDataNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraLevelDataNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.suraSceneData(t)}else b8e.log("获取当前所在层数据失败")},onSuraScoreUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraScoreUpdateNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.updataScore(t)}else b8e.log("获取当前积分变更失败")},onSuraDefeatNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraDefeatNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.showRelivePanel(t)}else b8e.log("服务器通知击杀错误")},onSuraReliveResponse:function(e){var t=e.readProtobuf(game.pbmsg.SuraReliveResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):(b8e.log("原地复活成功"),game.sura.hideRelivePanel())}else b8e.log("服务器通知原地复活错误")},onSuraReliveNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraReliveNotify);t||b8e.log("服务器通知原地复活错误");var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.hideRelivePanel()},onSuraEndNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraEndNotify);t||b8e.log("服务器通知大逃杀结束错误");var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.onSuraEnd(t)},onSuraOngoingNotify:function(e){var t=e.readProtobuf(game.pbmsg.SuraOngoingNotify);t||b8e.log("服务器通知活动正在进行错误");var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.onOpenSuraPanel(t)},onSuraRankResponse:function(e){var t=e.readProtobuf(game.pbmsg.SuraRankResponse);t||b8e.log("服务器通知通知已进入修罗战场场景错误");var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.sura.setSuraRank(t)}})},{}],805:[function(e,t,i){"use strict";e("./SuraCmd")},{"./SuraCmd":804}],806:[function(e,t,i){"use strict";game.SuraShowItemType=b8e.Enum({MY_SCORE:0,UP_SCORE:1,DOWN_SCORE:2,RANK_SCORE:3,MYGUILD_SCORE:4,GUILD_SCORE:5,GUILD_RANK:6})},{}],807:[function(e,t,i){"use strict";e("./SuraShowItemType")},{"./SuraShowItemType":806}],808:[function(e,t,i){"use strict";game.SuraEvent=b8e.Enum({INIT_SURA:b8e.Event.nextCode(),UPDATA_SCORE:b8e.Event.nextCode(),SURA_STATE_CHANGE:b8e.Event.nextCode(),SURA_BUFF_UPDATE:b8e.Event.nextCode()})},{}],809:[function(e,t,i){"use strict";e("./SuraEvent")},{"./SuraEvent":808}],810:[function(e,t,i){"use strict";game.SuraMgr=b8e.Object.extends({_qrySuraOverInfo:null,_suraLevelData:null,_suraScore:null,_isRequest:!1,leaveTime:0,_suraDefeatInfo:null,suraEndInfo:null,crossServer:!1,guildRankEntries:null,rankEntries:null,_exitAlertInfo:null,ctor:function(){this._super(),this._qrySuraOverInfo=new game.SuraOvervieInfo,this._suraLevelData=new game.SuraLevelData,this._suraScore=new game.SuraScoreUpdateInfo,this._suraDefeatInfo=new game.SuraDefeatInfo,this.suraEndInfo=new game.SuraEndInfo,this.guildRankEntries=[],this.rankEntries=[]},suraOverViewUpdata:function(e){if(this.crossServer=e){if(!game.funcOpen.checkOpenWithTips(game.FunctionType.CS_SURA))return;if(!game.guild.isHasGuild())return void game.notice.show(82001)}game.SuraSender.qrySuraOverviewRequest(this.crossServer)},setupsuraOverViewInit:function(e){if(this._qrySuraOverInfo.setup(e),b8e.evt.dptG(game.SuraEvent.INIT_SURA),this.crossServer){if(e.openTime>game.SysTime.curTime){var t=b8e.TimeUtil.formatTimestamp(e.openTime,"<color=#00ff00>Y-M-D h:m</c> 开启");return void game.notice.show(t)}e.status!=game.SuraStatus.NONE?game.app.show(game.AppConstant.CS_SURA_PANEL):game.notice.show(54016)}},joinSuraScene:function(){switch(this._qrySuraOverInfo._status){case game.SuraStatus.OPEN:this.crossServer?game.guild.isHasGuild()?game.SuraSender.joinSuraRequest(this.crossServer):game.notice.show(54015):game.SuraSender.joinSuraRequest(this.crossServer);break;case game.SuraStatus.CLOSE:game.notice.show("今日活动尚未开始");break;case game.SuraStatus.END:game.notice.show("今日活动已经结束");break;default:game.notice.show("服务器没有通知")}},loadSuraSceneComplete:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.SURA:game.app.isShow(game.AppConstant.SURA_SCORE_PANEL)||(game.app.hideAllApp(),game.app.show(game.AppConstant.SURA_SCORE_PANEL),game.app.show(game.AppConstant.SURA_LEAVE_PANEL)),this.crossServer?(game.mainGui.hideMainMenu(),game.mainGui.setStrengthenVisibel(!1)):game.app.show(game.AppConstant.SURA_BUFF_PANEL);break;default:this.hideSuraPanel()}},hideSuraPanel:function(){game.app.isShow(game.AppConstant.SURA_SCORE_PANEL)&&(game.app.hide(game.AppConstant.SURA_SCORE_PANEL),game.app.hide(game.AppConstant.SURA_BUFF_PANEL),game.app.hide(game.AppConstant.SURA_LEAVE_PANEL),game.sceneRole.isEnterSuraExpUp=!1)},suraSceneData:function(e){this._suraLevelData.setup(e),b8e.evt.dptG(game.SuraEvent.UPDATA_SCORE),b8e.evt.dptG(game.SuraEvent.SURA_BUFF_UPDATE),this._qrySuraOverInfo.endTs=e.endTs,this._suraScore._score=e.score,game.sceneRole.isEnterSuraExpUp=!0,game.sceneRole.suraExpRate=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SURA_EXPPRIZE)},updataScore:function(e){this._suraScore.setup(e),0<this._suraScore._changeScore?game.notice.show("积分  +"+this._suraScore._changeScore):game.notice.show("积分  "+this._suraScore._changeScore),b8e.evt.dptG(game.SuraEvent.UPDATA_SCORE)},firstRelive:function(){game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)<this._suraDefeatInfo.paid_relive_price?game.gameAlert.showVipAlert(!0,101):game.SuraSender.suraReliveRequest()},quitSuraScene:function(){game.SuraSender.quitSuraRequest()},quitSuraSceneSucceed:function(){game.app.hide(game.AppConstant.SURA_SCORE_PANEL),game.app.hide(game.AppConstant.SURA_LEAVE_PANEL),game.app.hide(game.AppConstant.SURA_BUFF_PANEL),this._suraScore.clearData(),game.app.isShow(game.AppConstant.SURA_RELIVE_PANEL)&&game.app.hide(game.AppConstant.SURA_RELIVE_PANEL),game.sceneRole.isEnterSuraExpUp=!1},onSuraEnd:function(e){this.suraEndInfo&&this.suraEndInfo.setup(e),this._qrySuraOverInfo._status=game.SuraStatus.END,game.app.show(game.AppConstant.SURA_RESULT_PANEL),this.quitSuraSceneSucceed()},getSuraEndInfo:function(){return this.suraEndInfo},onLeave:function(){b8e.Tween.kill(this),game.app.hide(game.AppConstant.SURA_LEAVE_PANEL),this.quitSuraScene()},showRelivePanel:function(e){this._suraDefeatInfo.setup(e),game.app.show(game.AppConstant.SURA_RELIVE_PANEL)},hideRelivePanel:function(){game.app.isShow(game.AppConstant.SURA_RELIVE_PANEL)&&game.app.hide(game.AppConstant.SURA_RELIVE_PANEL)},onOpenSuraPanel:function(e){this.leaveTime=e.endTs,this.crossServer=e.crossServer;game.SceneMgr.inst().getSceneConfig();this._qrySuraOverInfo.endTs=e.endTs,this._qrySuraOverInfo._status=game.SuraStatus.OPEN;var t=this.leaveTime-game.SysTime.curTime;0<t&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(t).call(this.updateTime)),game.app.isShow(game.AppConstant.FIGHT_PANEL)&&b8e.evt.dptG(game.ArenaEvent.UPDATE_SURAPANEL),b8e.evt.dptG(game.SuraEvent.SURA_STATE_CHANGE),game.SceneQuickEnterMgr.inst().addQuickEnter(this,game.SceneType.SURA,this.showQuickEnter)},updateTime:function(){game.app.isShow(game.AppConstant.SURA_ENTRANCE_PANEL)&&game.app.hide(game.AppConstant.SURA_ENTRANCE_PANEL),game.app.isShow(game.AppConstant.FIGHT_PANEL)&&b8e.evt.dptG(game.ArenaEvent.UPDATE_SURAPANEL),this._qrySuraOverInfo._status=game.SuraStatus.END,game.SceneQuickEnterMgr.inst().delQuickEnter(game.SceneType.SURA)},showQuickEnter:function(){game.funcOpen.checkOpen(game.FunctionType.SURA)&&(this._qrySuraOverInfo._status!=game.SuraStatus.OPEN||this.crossServer?game.funcOpen.checkOpen(game.FunctionType.CS_SURA)&&game.app.show(game.AppConstant.SURA_ENTRANCE_PANEL):game.app.show(game.AppConstant.SURA_ENTRANCE_PANEL))},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.SURA_ALERT,null,this.suraAlert,this)},suraAlert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.SURA)||this._qrySuraOverInfo._status!=game.SuraStatus.OPEN||this.crossServer)},exitGuildSura:function(){if(!this._exitAlertInfo){this._exitAlertInfo=new game.GameAlertInfo,this._exitAlertInfo.alertType=game.GameAlertType.TwoBtn;var e=54009;e=this.crossServer?54009:54014,this._exitAlertInfo.string=game.ccfg.LangCfg.getText(e),this._exitAlertInfo.isShowTips=!0}game.gameAlert.showAlert(this,this.onExitClick,this._exitAlertInfo)},onExitClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CANCEL:break;case game.GameAlertBtnType.CONFIRM:game.sura.quitSuraScene()}},setSuraRank:function(e){if(this.guildRankEntries&&this.rankEntries){var t,i=0;if(e.guildRankEntries){this.guildRankEntries.length=0,i=e.guildRankEntries.length;for(var n=0;n<i;++n)(t=new game.SuraGuildScoreRankEntry).setup(e.guildRankEntries[n]),t.type=game.SuraType.CS_GUILDRANK_TYPE,this.guildRankEntries.push(t)}if(e.rankEntries){this.rankEntries.length=0,i=e.rankEntries.length;for(n=0;n<i&&n<5;++n)(t=new game.SuraScoreRankEntry).setup(e.rankEntries[n]),t.type=game.SuraType.CS_RANK_TYPE,this.rankEntries.push(t)}game.app.show(game.AppConstant.SURA_RANK_PANEL)}},getGuildRankEntries:function(){return this.guildRankEntries?this.guildRankEntries:null},getRankEntries:function(){return this.rankEntries?this.rankEntries:null},isCsSuraOpen:function(){return!1}}),game.SuraMgr._instance=null,game.SuraMgr.inst=function(){return game.SuraMgr._instance||(game.SuraMgr._instance=new game.SuraMgr),game.SuraMgr._instance}},{}],811:[function(e,t,i){"use strict";e("./SuraMgr")},{"./SuraMgr":810}],812:[function(e,t,i){"use strict";game.appModule.CsSuraPanel=game.SkinUIPanel.extends({_itemList:null,_itemPool:null,_prizeList:null,_prizeInfo:null,_timer:null,suraBgSp:null,ctor:function(e){this._super(e),this._itemList=[],this._itemPool=[]},init:function(){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.SURA_PRIZRITEN_SHOWICON,this._prizeInfo=new game.PrizeInfo;var e=game.mainRole.mainRoleData.miscData.openServerDay,t=game.ccfg.CsSuraPrizeCfg.getdisplayDropByOpenDays(e);this._prizeInfo.setupById(t),this._prizeList.setData(this._prizeInfo),this._skin.openTime.string=game.ccfg.LangCfg.getText(54020);var i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SURA_EXPPRIZE);this._skin.prizeEXPText.string=game.ccfg.LangCfg.getText(54018,[i]),this.suraBgSp=b8e.Sprite.get(),this.suraBgSp.setAnchor(.5,.5),this.suraBgSp.addToParent(this._skin.surabg),this.suraBgSp.loadTexture(game.ClientCfg.csSuraBgUrl,null,null,{useManifest:!1}),this._skin.csSuraTips.string=game.ccfg.LangCfg.getText(54003)},onShow:function(){b8e.evt.onC(this._skin.openPrizepanel,this.onOpenPrizepanel,this),b8e.evt.onC(this._skin.helpBtn,this.onOpenRulePanel,this),b8e.evt.onC(this._skin.joinSura,this.onJoinSura,this),b8e.evt.onC(this._skin.lastLog,this.onShowLastSuraRank,this),b8e.evt.addG(this,game.SuraEvent.INIT_SURA,this.updateView),this.updateView()},onHide:function(){b8e.evt.offC(this._skin.openPrizepanel,this.onOpenPrizepanel,this),b8e.evt.offC(this._skin.helpBtn,this.onOpenRulePanel,this),b8e.evt.offC(this._skin.joinSura,this.onJoinSura,this),b8e.evt.offC(this._skin.lastLog,this.onShowLastSuraRank,this),b8e.evt.rmvG(this,game.SuraEvent.INIT_SURA,this.updateView),this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateView:function(){var e=game.sura._qrySuraOverInfo;switch(e._status){case game.SuraStatus.OPEN:this._skin.endTipNode.active=!1,this._skin.joinNode.active=!0,this._skin.playerNmb.string=game.ccfg.LangCfg.getText(54019,[e._player_number]),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start();break;default:this._skin.endTipNode.active=!0,this._skin.joinNode.active=!1}},replaceStr:function(e){if(!e)return"";for(var t=0;t<2;t++)e=(e=(e=e.replace(",","-")).replace("(","")).replace(")","");return e=e.replace("|","   ")},updateTime:function(){var e=game.sura._qrySuraOverInfo.endTs-game.SysTime.curTime;0<e?this._skin.LastTime.string="结算倒计时"+b8e.TimeUtil.formatTime(e):(this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null),this._skin.LastTime.string="",game.sura._qrySuraOverInfo._status=game.SuraStatus.CLOSE,this.updateView())},onOpenPrizepanel:function(){game.app.show(game.AppConstant.SURA_GUILDPRIZE_PANEL)},onOpenRulePanel:function(){game.app.show(game.AppConstant.SURA_RULE_PANEL,54002)},onJoinSura:function(){game.sura.joinSuraScene(),this.hide()},onShowLastSuraRank:function(){game.SuraSender.suraRankRequest()}})},{}],813:[function(e,t,i){"use strict";game.appModule.LeaveSuraScenePanel=game.SkinUIPanel.extends({_timer:null,ctor:function(e){this._super(e),this._skin=this._skin},onShow:function(){this._timer=b8e.Timer.add(this,this.updateTime,500),b8e.evt.onC(this._skin.leaveBtn,this.onleaveBtnClick,this)},onHide:function(){this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null),b8e.evt.offC(this._skin.leaveBtn,this.onleaveBtnClick,this)},onleaveBtnClick:function(){game.sura.exitGuildSura()},updateTime:function(){var e=game.sura._qrySuraOverInfo.endTs-game.SysTime.curTime;0<e?this._skin.lastTime.string=b8e.TimeUtil.formatTime(e):(this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null),this._skin.lastTime.string="")}})},{}],814:[function(e,t,i){"use strict";e("./CsSuraPanel"),e("./LeaveSuraScenePanel"),e("./SuraBuffPanel"),e("./SuraBuffTipsPanel"),e("./SuraEntrancePanel"),e("./SuraFightPanel"),e("./SuraFightPrize"),e("./SuraFightPrizeItem"),e("./SuraGuildPrizeItem"),e("./SuraGuildPrizePanel"),e("./SuraPanel"),e("./SuraRankItem"),e("./SuraRankPanel"),e("./SuraRankPrize"),e("./SuraRankPrizeItem"),e("./SuraRelive"),e("./SuraResultPanel"),e("./SuraRulePanel"),e("./SuraScorePanel"),e("./SuraScoretextItem")},{"./CsSuraPanel":812,"./LeaveSuraScenePanel":813,"./SuraBuffPanel":815,"./SuraBuffTipsPanel":816,"./SuraEntrancePanel":817,"./SuraFightPanel":818,"./SuraFightPrize":819,"./SuraFightPrizeItem":820,"./SuraGuildPrizeItem":821,"./SuraGuildPrizePanel":822,"./SuraPanel":823,"./SuraRankItem":824,"./SuraRankPanel":825,"./SuraRankPrize":826,"./SuraRankPrizeItem":827,"./SuraRelive":828,"./SuraResultPanel":829,"./SuraRulePanel":830,"./SuraScorePanel":831,"./SuraScoretextItem":832}],815:[function(e,t,i){"use strict";game.appModule.SuraBuffPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.iconNode,this.onOpenBuffTips,this),b8e.evt.addG(this,game.SuraEvent.SURA_BUFF_UPDATE,this.updatePanel),b8e.evt.addG(this,game.SuraEvent.UPDATA_SCORE,this.updatePanel),this.updatePanel()},onHide:function(){b8e.evt.offC(this._skin.iconNode,this.onOpenBuffTips,this),b8e.evt.rmvG(this,game.SuraEvent.SURA_BUFF_UPDATE,this.updatePanel),b8e.evt.rmvG(this,game.SuraEvent.UPDATA_SCORE,this.updatePanel)},updatePanel:function(){if(this._skin){var e=0,t=game.sura._suraLevelData;t&&(e=t.getBuffCoef()),this._skin.buffText.string="<color=#00ff00>全属性+</c><color=#0fffff>"+e+"%</color>"}},onOpenBuffTips:function(){game.app.show(game.AppConstant.SURA_BUFFTIPS_PANEL)}})},{}],816:[function(e,t,i){"use strict";game.appModule.SuraBuffTipsPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this._skin.tipsText.string=game.ccfg.LangCfg.getText(game.GlobalEnum.SURA_BUFF_TIPS)},onHide:function(){}})},{}],817:[function(e,t,i){"use strict";game.appModule.SuraEntrancePanel=game.SkinUIPanel.extends({_time:10,_data:null,ctor:function(e){this._super(e)},init:function(){this.suraBgSp=b8e.Sprite.get(),this.suraBgSp.setAnchor(.5,.5),this.suraBgSp.addToParent(this._skin.bgSp)},onShow:function(){b8e.evt.onC(this._skin.entranceBnt,this.onEntranceBntClick,this),game.sura.crossServer?(this._skin.panelName.string=game.ccfg.LangCfg.getText(54012),this.suraBgSp.loadTexture(game.ClientCfg.csSuraEnterIcon,null,null,{useManifest:!1})):(this._skin.panelName.string=game.ccfg.LangCfg.getText(54013),this.suraBgSp.loadTexture(game.ClientCfg.suraEnterIcon,null,null,{useManifest:!1}))},onHide:function(){b8e.evt.offC(this._skin.entranceBnt,this.onEntranceBntClick,this)},onEntranceBntClick:function(){game.sura.crossServer?game.sura.suraOverViewUpdata(!0):game.app.show(game.AppConstant.FIGHT_PANEL,2),game.app.hide(game.AppConstant.SURA_ENTRANCE_PANEL)}})},{}],818:[function(e,t,i){"use strict";game.appModule.SuraFightPanel=game.SkinUIPanel.extends({_fightPrize:null,_rankPrize:null,tipsStr_0:null,tipsStr_1:null,_index:-1,list:null,ctor:function(e){this._super(e)},init:function(){this.tipsStr_0=game.ccfg.LangCfg.getText(54010),this.tipsStr_1=game.ccfg.LangCfg.getText(54011)},onShow:function(){-1==this._index&&(this._index=0),this.showIndex(this._index),b8e.evt.onC(this._skin.fightbnt,this.onFightPrizeBntClick,this),b8e.evt.onC(this._skin.rankPanel,this.onRankPrizeBntClick,this)},onHide:function(){b8e.evt.offC(this._skin.fightbnt,this.onFightPrizeBntClick,this),b8e.evt.offC(this._skin.rankPanel,this.onRankPrizeBntClick,this)},showIndex:function(e){switch(this._index=e,this.clearPrize(),e){case 0:this._skin.tipsLabel.string=this.tipsStr_0,this.showFightPrizeContent();break;case 1:this._skin.tipsLabel.string=this.tipsStr_1,this.showRankPrizeContent()}},showFightPrizeContent:function(){this._fightPrize?this._fightPrize.show():(this._fightPrize=new game.SuraFightPrize,this._fightPrize.show(),this._fightPrize.addToParent(this._skin.content))},showRankPrizeContent:function(){this._rankPrize?this._rankPrize.show():(this._rankPrize=new game.SuraRankPrize,this._rankPrize.show(),this._rankPrize.addToParent(this._skin.content))},clearPrize:function(){this._rankPrize&&this._rankPrize.hide(),this._fightPrize&&this._fightPrize.hide()},onFightPrizeBntClick:function(){this.showIndex(0)},onRankPrizeBntClick:function(){this.showIndex(1)}})},{}],819:[function(e,t,i){"use strict";game.SuraFightPrize=game.SkinUI.extends({list:null,ctor:function(){this._super("sura/SuraFightPrizeSkin","SuraFightPrizeSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.SuraFightPrizeItem)),this._list.show();var e=game.sura._qrySuraOverInfo.server_open_days,t=game.ccfg.SuraPrizeCfg.getLevelDropsByOpenDays(e);this._list.setData(t)},onHide:function(){this._list&&this._list.hide()}})},{}],820:[function(e,t,i){"use strict";game.SuraFightPrizeItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("sura/SuraFightPrizeItemSkin","SuraFIghtPrizeItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){},getHeight:function(){return 180},getWidth:function(){return 540},setData:function(e){if(this._data=e,this._data&&this._skin){var t=game.ccfg.SuraLevelCfg.getSuraLevelInfoById(e.index);if(this._skin.tipsLabel.string="<color=#C5D3D5>到达</c><color=#E7D7A7>"+t.name+"</c><color=#C5D3D5>奖励</color>",!this._prizeList){this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,5),this._prizeList.containerId=game.ContainerId.SURA_PRIZE_ITEM_SHOWNAME,this._prizeList.addToParent(this._skin.prizeNode);var i=e.prizeDropId;this._prizeInfo=new game.PrizeInfo,this._prizeInfo.setupById(i),this._prizeList.setData(this._prizeInfo)}}}})},{}],821:[function(e,t,i){"use strict";game.SuraGuildPrizeItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("sura/SuraGuildPrizeItemSkin","SuraGuildPrizeItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){},getHeight:function(){return 180},getWidth:function(){return 540},setData:function(e){if(this._data=e,this._data&&this._skin){var t=0;this.str=e.prizeDropId.split(":"),this.str&&0<this.str.length&&(this.str[0]&&(this.rank=this.str[0]),this.str[1]&&(t=parseInt(this.str[1]))),this._skin.tipsLabel.string="第"+this.rank+"名",this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,5),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.SURA_PRIZE_ITEM_SHOWNAME,this._prizeInfo=new game.PrizeInfo,this._prizeInfo.setupById(t),this._prizeList.setData(this._prizeInfo))}}})},{}],822:[function(e,t,i){"use strict";game.appModule.SuraGuildPrizePanel=game.SkinUIPanel.extends({_fightPrize:null,_rankPrize:null,tipsStr_0:null,tipsStr_1:null,fightList:null,rankList:null,_index:-1,list:null,ctor:function(e){this._super(e)},init:function(){this.tipsStr_0=game.ccfg.LangCfg.getText(54e3),this.tipsStr_1=game.ccfg.LangCfg.getText(54001),this.fightList=new b8e.List(this._skin.fightList,game.SuraGuildPrizeItem),this.rankList=new b8e.List(this._skin.rankList,game.SuraFightPrizeItem);var e=game.sura._qrySuraOverInfo.server_open_days,t=game.ccfg.CsSuraPrizeCfg.getLevelDropsByOpenDays(e);this.rankList.setData(t),this.rankList.show(),t=game.ccfg.CsSuraPrizeCfg.getRankDropsByOpenDays(e),this.fightList.setData(t),this.fightList.show()},onShow:function(){-1==this._index&&(this._index=1),this.showIndex(this._index),b8e.evt.onC(this._skin.fightbtn,this.onFightPrizeBntClick,this),b8e.evt.onC(this._skin.rankBtn,this.onRankPrizeBntClick,this)},onHide:function(){b8e.evt.offC(this._skin.fightbtn,this.onFightPrizeBntClick,this),b8e.evt.offC(this._skin.rankBtn,this.onRankPrizeBntClick,this),this.rankList||this.rankList.hide(),this.fightList||this.fightList.hide()},showIndex:function(e){switch(this._index=e,this.clearPrize(),e){case 0:this._skin.tipsLabel.string=this.tipsStr_0,this.showFightPrizeContent();break;case 1:this._skin.tipsLabel.string=this.tipsStr_1,this.showRankPrizeContent()}},showFightPrizeContent:function(){this._skin.rankPrizeNode.active=!0},showRankPrizeContent:function(){this._skin.fightPrizeNode.active=!0},clearPrize:function(){this._skin.fightPrizeNode.active=!1,this._skin.rankPrizeNode.active=!1},onFightPrizeBntClick:function(){this.showIndex(0)},onRankPrizeBntClick:function(){this.showIndex(1)}})},{}],823:[function(e,t,i){"use strict";game.SuraPanel=game.SkinUI.extends({_itemList:null,_itemPool:null,_prizeList:null,_prizeInfo:null,_timer:null,suraBgSp:null,ctor:function(){this._super("sura/SuraPanelSkin","SuraPanelSkin"),this._itemList=[],this._itemPool=[]},init:function(){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.SURA_PRIZRITEN_SHOWICON,this._prizeInfo=new game.PrizeInfo,this.suraBgSp=b8e.Sprite.get(),this.suraBgSp.setAnchor(.5,.5),this.suraBgSp.addToParent(this._skin.surabg),this.suraBgSp.loadTexture(game.ClientCfg.suraBgUrl,null,null,{useManifest:!1});var e,t=game.sura._qrySuraOverInfo.server_open_days,i=1;game.sura.crossServer?(e=game.ccfg.GlobalParamCfg.getData(2216),i=game.ccfg.CsSuraPrizeCfg.getdisplayDropByOpenDays(t)):(e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SURAOPEN_TIME),i=game.ccfg.SuraPrizeCfg.getdisplayDropByOpenDays(t)),this._prizeInfo.setupById(i),this._prizeList.setData(this._prizeInfo);var n=this.replaceStr(e);this._skin.openTime.string=game.ccfg.LangCfg.getText(54017,[n]);var s=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.SURA_EXPPRIZE);this._skin.prizeEXPText.string=game.ccfg.LangCfg.getText(54018,[s])},onShow:function(){b8e.evt.onC(this._skin.openPrizepanel,this.onOpenPrizepanel,this),b8e.evt.onC(this._skin.helpBtn,this.onOpenRulePanel,this),b8e.evt.onC(this._skin.joinSura,this.onJoinSura,this),b8e.evt.addG(this,game.SuraEvent.INIT_SURA,this.updateView),game.sura.suraOverViewUpdata(!1)},onHide:function(){b8e.evt.offC(this._skin.openPrizepanel,this.onOpenPrizepanel,this),b8e.evt.offC(this._skin.helpBtn,this.onOpenRulePanel,this),b8e.evt.offC(this._skin.joinSura,this.onJoinSura,this),b8e.evt.rmvG(this,game.SuraEvent.INIT_SURA,this.updateView),this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null)},updateView:function(){var e=game.sura._qrySuraOverInfo;switch(e._status){case game.SuraStatus.OPEN:this._skin.endTipNode.active=!1,this._skin.joinNode.active=!0,this._skin.playerNmb.string=game.ccfg.LangCfg.getText(54019,[e._player_number]),this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this._timer.reset(),this._timer.start();break;default:this._skin.endTipNode.active=!0,this._skin.joinNode.active=!1}},replaceStr:function(e){if(!e)return"";for(var t=0;t<2;t++)e=(e=(e=e.replace(",","-")).replace("(","")).replace(")","");return e=e.replace("|","   ")},updateTime:function(){var e=game.sura._qrySuraOverInfo.endTs-game.SysTime.curTime;0<e?this._skin.LastTime.string="结算倒计时"+b8e.TimeUtil.formatTime(e):(this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null),this._skin.LastTime.string="",game.sura._qrySuraOverInfo._status=game.SuraStatus.CLOSE,this.updateView())},onOpenPrizepanel:function(){game.app.show(game.AppConstant.SURA_PRIZE_PANEL)},onOpenRulePanel:function(){game.app.show(game.AppConstant.SURA_RULE_PANEL,10002)},onJoinSura:function(){game.sura._qrySuraOverInfo;game.sura.joinSuraScene()}})},{}],824:[function(e,t,i){"use strict";game.SuraRankItem=game.SkinUI.extends({_data:null,ctor:function(){this._super("sura/SuraRankItemSkin","SuraRankItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){},getHeight:function(){return 60},getWidth:function(){return 550},setData:function(e){if(this._data=e,this._data&&this._skin)switch(e.type){case game.SuraType.NORMAL_SURATYPE:this.setSuraRank(e),this.setRankIcon(0);break;case game.SuraType.CS_GUILDRANK_TYPE:this.setCsSuraGuildRank(e);break;case game.SuraType.CS_RANK_TYPE:this.setCsSuraRank(e);break;case game.SuraType.CS_ENDGUILDRANK_TYPE:this.setCsSuraEndRank(e),this.setRankIcon(0)}},setSuraRank:function(e){this._skin.rank.string=e._rank,this._skin.rankName.string=e._role_name,this._skin.rankName.node.active=!0,this._skin.killeddata.string=e.totalKillTimes+"/"+e.totalDieTimes+"/"+e.maxSuccessiveKillTimes,this._skin.score.string=e._score,this._skin.guildRank.active=!1},setCsSuraEndRank:function(e){this._skin.guildRank.active=!0,this._skin.rank.string=e.rank,this._skin.guildItemName.string=e.guildName,this._skin.severName.string=e.zone,this._skin.rankName.node.active=!1,this._skin.killeddata.string=e.masterName,this._skin.score.string=e.score},setCsSuraGuildRank:function(e){this.setCsSuraEndRank(e),this.setRankIcon(e.rank)},setCsSuraRank:function(e){this._skin.rank.string=e._rank,this._skin.guildItemName.string=e._role_name,this._skin.severName.string=e.zone,this._skin.rankName.node.active=!1,this._skin.killeddata.string=e.totalKillTimes+"/"+e.totalDieTimes+"/"+e.maxSuccessiveKillTimes,this._skin.score.string=e._score,this._skin.guildRank.active=!0,this.setRankIcon(e._rank)},setRankIcon:function(e){switch(this._skin.rank.node.active=!1,this._skin.NO_1.active=!1,this._skin.NO_2.active=!1,this._skin.NO_3.active=!1,e){case 1:this._skin.NO_1.active=!0;break;case 2:this._skin.NO_2.active=!0;break;case 3:this._skin.NO_3.active=!0;break;default:this._skin.rank.node.active=!0}}})},{}],825:[function(e,t,i){"use strict";game.appModule.SuraRankPanel=game.SkinUIPanel.extends({_fightPrize:null,_rankPrize:null,guildtList:null,selfList:null,_index:-1,list:null,ctor:function(e){this._super(e)},init:function(){this.guildtList=new b8e.List(this._skin.guildtList,game.SuraRankItem),this.selfList=new b8e.List(this._skin.selfList,game.SuraRankItem)},onShow:function(){-1==this._index&&(this._index=0),this.showIndex(this._index),b8e.evt.onC(this._skin.guildbtn,this.onFightPrizeBntClick,this),b8e.evt.onC(this._skin.selfBtn,this.onRankPrizeBntClick,this);var e=game.sura.getGuildRankEntries();e&&0<e.length&&(this.guildtList.setData(e),this.guildtList.show());var t=game.sura.getRankEntries();t&&0<t.length&&(this.selfList.setData(t),this.selfList.show())},onHide:function(){b8e.evt.offC(this._skin.guildbtn,this.onFightPrizeBntClick,this),b8e.evt.offC(this._skin.selfBtn,this.onRankPrizeBntClick,this),this.selfList&&(this.selfList.setData(null),this.selfList.hide()),this.guildtList&&(this.guildtList.setData(null),this.guildtList.hide())},showIndex:function(e){switch(this._index=e,this.clearPrize(),e){case 0:this.showFightPrizeContent();break;case 1:this.showRankPrizeContent()}},showFightPrizeContent:function(){this._skin.guildPrizeNode.active=!0},showRankPrizeContent:function(){this._skin.selfPrizeNode.active=!0},clearPrize:function(){this._skin.guildPrizeNode.active=!1,this._skin.selfPrizeNode.active=!1},onFightPrizeBntClick:function(){this.showIndex(0)},onRankPrizeBntClick:function(){this.showIndex(1)}})},{}],826:[function(e,t,i){"use strict";game.SuraRankPrize=game.SkinUI.extends({_list:null,ctor:function(){this._super("sura/SuraRankPrizeSkin","SuraRankPrizeSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.SuraRankPrizeItem)),this._list.show();var e=game.sura._qrySuraOverInfo.server_open_days,t=game.ccfg.SuraPrizeCfg.getRankDropsByOpenDays(e);this._list.setData(t)},onHide:function(){this._list&&this._list.hide()}})},{}],827:[function(e,t,i){"use strict";game.SuraRankPrizeItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,str:null,rank:"",ctor:function(){this._super("sura/SuraRankPrizeItemSkin","SuraRankPrizeItemSkin")},onShow:function(){this.setData(this._data)},onHide:function(){},getHeight:function(){return 130},getWidth:function(){return 540},setData:function(e){if(this._data=e,this._data&&this._skin){var t=0;this.str=e.prizeDropId.split(":"),this.str&&0<this.str.length&&(this.str[0]&&(this.rank=this.str[0]),this.str[1]&&(t=parseInt(this.str[1]))),this._skin.tipsLabel.string="第"+this.rank+"名",this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,5),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.SURA_PRIZE_ITEM_SHOWNAME,this._prizeInfo=new game.PrizeInfo,this._prizeInfo.setupById(t),this._prizeList.setData(this._prizeInfo))}}})},{}],828:[function(e,t,i){"use strict";game.appModule.SuraRelive=game.SkinUIPanel.extends({_time:10,_data:null,_timer:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.reliveBnt,this.onfirstRelive,this),this.updatePanel()},updatePanel:function(){if(this._skin&&(this._skin.lastTime.string="10",game.sura._suraDefeatInfo)){var e=game.sura._suraDefeatInfo;this.setdata(e),this.writeTime(),this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.writeTime,500)}},onHide:function(){b8e.evt.offC(this._skin.reliveBnt,this.onfirstRelive,this),this._timer&&this._timer.stop()},writeTime:function(){var e=game.sura._suraDefeatInfo.auto_relive_ts-game.SysTime.curTime;if(e<=0)return this._timer&&this._timer.stop(),void this.hide();var t=b8e.TimeUtil.formatTimestamp(e,"s");this._skin.lastTime.string=t},removeTimer:function(){this._timer&&this._timer.stop()},onfirstRelive:function(){game.sura.firstRelive()},setdata:function(e){(this._data=e)&&this._skin&&(this._skin.killerName.string=e.killer_name,this._skin.paygold.string=e.paid_relive_price)}})},{}],829:[function(e,t,i){"use strict";game.appModule.SuraResultPanel=game.SkinUIPanel.extends({_timeNumb:60,_data:null,_timer:null,_list:null,_csList:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.SuraRankItem)),this._list.show(),this._csList||(this._csList=new b8e.List(this._skin.guildlist,game.SuraRankItem)),this._csList.show(),b8e.evt.onC(this._skin.confirmBnt,this.onClickCallBack,this),b8e.evt.onC(this._skin.closenode,this.onClickCallBack,this),this.updatePanel()},onHide:function(){b8e.evt.offC(this._skin.confirmBnt,this.onClickCallBack,this),b8e.evt.offC(this._skin.closenode,this.onClickCallBack,this),this._list&&this._list.hide(),this._csList&&this._csList.hide()},updatePanel:function(){if(this._skin){var e=game.sura.getSuraEndInfo();e&&(game.sura.crossServer?this.updataCsSura(e):this.updataSura(e),this._skin.guildNotice.active=game.sura.crossServer,this._skin.normalNotice.active=!game.sura.crossServer,this._skin.myRankItemNode.active=!game.sura.crossServer)}},updataSura:function(e){this._list.setData(e.getRankData()),this._skin.myKilledData.string=e.myTotalKillTimes+"/"+e.myTotalDieTimes+"/"+e.myMaxSuccessiveKillTimes,this._skin.myscore.string=e.myScore,this._skin.resultDesc_1.string=game.ccfg.LangCfg.getText(14e3,[e.level_id]),3<=e.level_id?(this._skin.myscore.node.active=!0,0<e.myRank?this._skin.resultDesc_2.string=game.ccfg.LangCfg.getText(14002,[e.myRank]):this._skin.resultDesc_2.string=game.ccfg.LangCfg.getText(14001)):(this._skin.myscore.node.active=!1,this._skin.resultDesc_2.string=game.ccfg.LangCfg.getText(14003)),this._skin.resultDesc_3.string=game.ccfg.LangCfg.getText(14004)},updataCsSura:function(e){this._csList.setData(e.getGuildRankEntries()),this._skin.resultDesc_1.string=game.ccfg.LangCfg.getText(14e3,[e.level_id]),0<e.myGuildRank?this._skin.resultDesc_2.string=game.ccfg.LangCfg.getText(54006,[e.myGuildRank]):this._skin.resultDesc_2.string=game.ccfg.LangCfg.getText(54005),this._skin.resultDesc_3.string=game.ccfg.LangCfg.getText(54008)},onClickCallBack:function(){this.hide()}})},{}],830:[function(e,t,i){"use strict";game.appModule.SuraRulePanel=game.SkinUIPanel.extends({_RankItems:null,_RankItemPool:null,ctor:function(e){this._super(e),this._RankItemPool=[],this._RankItems=[]},onShow:function(){this._skin.contentText.string=game.ccfg.LangCfg.getText(this.data)},onHide:function(){}})},{}],831:[function(e,t,i){"use strict";game.appModule.SuraScorePanel=game.SkinUIPanel.extends({scoreInfoList:null,scoreInfoPool:null,scoreItemList:null,scoreItemPool:null,selfScoreItem:null,selfGuildScoreItem:null,itemHeigth:26,_Hight:2,_isShow:!0,ctor:function(e){this._super(e),this._skin=this._skin,this.scoreInfoList=[],this.scoreInfoPool=[],this.scoreItemList=[],this.scoreItemPool=[]},onShow:function(){b8e.evt.onC(this._skin.switchBtn,this.onSwitchPanel,this),b8e.evt.addG(this,game.SuraEvent.UPDATA_SCORE,this.updata),this.selfScoreItem||(this.selfScoreItem=new game.SuraScoretextItem,this.selfScoreItem.addToParent(this._skin.myRankNode),this.selfScoreItem.y=0),this.selfGuildScoreItem||(this.selfGuildScoreItem=new game.SuraScoretextItem,this.selfGuildScoreItem.addToParent(this._skin.myRankNode),this.selfGuildScoreItem.y=0),this.onSwitchPanel()},onHide:function(){b8e.evt.offC(this._skin.switchBtn,this.onSwitchPanel,this),b8e.evt.rmvG(this,game.SuraEvent.UPDATA_SCORE,this.updata),this.clearScoreItem()},onSwitchPanel:function(){this._skin.Bg.active=this._isShow,this._skin.upBtn.active=this._isShow,this._skin.downBtn.active=!this._isShow,this._skin.myRankNode.active=!this._isShow,this._isShow=!this._isShow,this.updata()},updata:function(){if(this._skin){this.clearItems();var e=game.sura._suraLevelData,t=game.ccfg.SuraLevelCfg.getSuraLevelInfoById(e._level_id);if(t&&(this.selfScoreItem.setDataByType(e,game.SuraShowItemType.MY_SCORE),this.selfScoreItem.show(),game.sura.crossServer?(this.selfGuildScoreItem.setDataByType(e,game.SuraShowItemType.GUILD_SCORE),this.selfGuildScoreItem.show(),this.selfScoreItem.y=0-this.itemHeigth):this.selfScoreItem.y=0,!this._isShow)){var i;if(game.sura.crossServer){for(var n=0;n<e.guildRankEntries.length;++n)(i=this.getInfo()).levelData=e.guildRankEntries[n],i.type=game.SuraShowItemType.GUILD_RANK,this.scoreInfoList.push(i);(i=this.getInfo()).levelData=e,i.type=game.SuraShowItemType.GUILD_SCORE,this.scoreInfoList.push(i),(i=this.getInfo()).levelData=e,i.type=game.SuraShowItemType.MYGUILD_SCORE,this.scoreInfoList.push(i)}else{for(n=0;n<e._rank_entries.length;++n)(i=this.getInfo()).levelData=e._rank_entries[n],i.type=game.SuraShowItemType.RANK_SCORE,this.scoreInfoList.push(i);(i=this.getInfo()).levelData=e,i.type=game.SuraShowItemType.MY_SCORE,this.scoreInfoList.push(i)}0<t.upScore&&((i=this.getInfo()).levelData=e,i.type=game.SuraShowItemType.UP_SCORE,this.scoreInfoList.push(i)),t.downScore&&((i=this.getInfo()).levelData=e,i.type=game.SuraShowItemType.DOWN_SCORE,this.scoreInfoList.push(i)),this.updateScoreItemList(),this.setBgSize()}}},clearItems:function(){this._skin&&(this.selfScoreItem&&this.selfScoreItem.hide(),this.selfGuildScoreItem&&this.selfGuildScoreItem.hide(),this.clearInfo())},getInfo:function(){return 0<this.scoreInfoPool.length?this.scoreInfoPool.shift():new game.SuraScoreInfo},clearInfo:function(){for(;0<this.scoreInfoList.length;){var e=this.scoreInfoList.shift();this.scoreInfoPool.push(e)}this.scoreInfoList.length=0},getScoreItem:function(){return 0<this.scoreItemPool.length?this.scoreItemPool.shift():new game.SuraScoretextItem},clearScoreItem:function(){for(;0<this.scoreItemList.length;){var e=this.scoreItemList.shift();this.scoreItemPool.push(e),e.hide(),e.removeFromParent()}this.scoreItemList.length=0},updateScoreItemList:function(){var e;this.addItemToScoreItemPool();for(var t=0;t<this.scoreInfoList.length;++t)t<this.scoreItemList.length?(this.scoreItemList[t].setData(this.scoreInfoList[t]),this.scoreItemList[t].y=0-t*this.scoreItemList[t].height):((e=this.getScoreItem()).setData(this.scoreInfoList[t]),e.addToParent(this._skin.scoreListNode),e.show(),e.y=0-t*e.height,this.scoreItemList.push(e))},addItemToScoreItemPool:function(){for(;this.scoreItemList.length>this.scoreInfoList.length;){var e=this.scoreItemList.shift();this.scoreItemPool.push(e),e.hide(),e.removeFromParent()}},setBgSize:function(){this._Hight=this.scoreInfoList.length,this._skin.Bg.height=this._Hight*this.itemHeigth,game.sura.crossServer?this._skin.myRankNode.height=2*this.itemHeigth:this._skin.myRankNode.height=this.itemHeigth,this.resetPosition()}})},{}],832:[function(e,t,i){"use strict";game.SuraScoretextItem=game.SkinUI.extends({_Type:-1,_data:null,ctor:function(){this._super("sura/SuraScoretextItemSkin","SuraScoretextItemSkin")},onShow:function(){this._data&&this.setDataByType(this._data,this._Type)},onHide:function(){},getHeight:function(){return 25},getWidth:function(){return 200},setData:function(e){e&&this.setDataByType(e.levelData,e.type)},setDataByType:function(e,t){if(this._data=e,this._Type=t,e&&this._skin){var i=this._skin,n="",s="",a=0,o=!1,r="",h="";switch(i.scoreLabel.node.active=!0,t){case game.SuraShowItemType.MY_SCORE:s="我的积分",a=game.sura._suraScore._score,0<e._rank_entries.length&&(o=!0),e._my_rank&&(n=e._my_rank);break;case game.SuraShowItemType.GUILD_SCORE:s="本帮积分",a=e.myGuildScore,0<e.guildRankEntries.length&&(o=!0),e.myGuildRank&&(n=e.myGuildRank);break;case game.SuraShowItemType.MYGUILD_SCORE:s="我的积分",a=game.sura._suraScore._score;break;case game.SuraShowItemType.UP_SCORE:s="升层积分：",h=(game.sura.crossServer?game.ccfg.CsSuraLevelCfg.getSuraLevelInfoById(e._level_id):game.ccfg.SuraLevelCfg.getSuraLevelInfoById(e._level_id)).upScore,o=!0,i.scoreLabel.node.active=!1;break;case game.SuraShowItemType.DOWN_SCORE:s="降层积分：",r=(game.sura.crossServer?game.ccfg.CsSuraLevelCfg.getSuraLevelInfoById(e._level_id):game.ccfg.SuraLevelCfg.getSuraLevelInfoById(e._level_id)).downScore,e._level_id==game.SuraLevelType.LEVEL_3&&(o=!0),i.scoreLabel.node.active=!1;break;case game.SuraShowItemType.RANK_SCORE:n=e._rank,s=e._role_name,a=e._score;break;case game.SuraShowItemType.GUILD_RANK:n=e.rank,s=e.guildName,a=e.score}i.rankLabel.string=n,i.playerName.string=s,i.scoreLabel.string=a,i.lastscoreLabel.string=r,i.nextscoreLabel.string=h,i.line.active=o}}})},{}],833:[function(e,t,i){"use strict";game.SuraSender={},game.SuraSender.qrySuraOverviewRequest=function(e){var t=game.pbmsg.QrySuraOverviewRequest;t.crossServer=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Sura.QrySuraOverviewRequest;b8e.sendN(i)},game.SuraSender.joinSuraRequest=function(e){var t=game.pbmsg.JoinSuraRequest;t.crossServer=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Sura.JoinSuraRequest;b8e.sendN(i)},game.SuraSender.quitSuraRequest=function(){var e=game.pbmid.Sura.QuitSuraRequest;b8e.sendN(e)},game.SuraSender.suraReliveRequest=function(){var e=game.pbmid.Sura.SuraReliveRequest;b8e.sendN(e)},game.SuraSender.suraRankRequest=function(){var e=game.pbmid.Sura.SuraRankRequest;b8e.sendN(e)}},{}],834:[function(e,t,i){"use strict";e("./SuraSender")},{"./SuraSender":833}],835:[function(e,t,i){"use strict";e("./cmd/SuraCmdIndex"),e("./enum/enumIndes"),e("./event/eventIndex"),e("./manager/SuramanagerIndex"),e("./panel/SueanPanleIndex"),e("./sender/SuraSenderIndex")},{"./cmd/SuraCmdIndex":805,"./enum/enumIndes":807,"./event/eventIndex":809,"./manager/SuramanagerIndex":811,"./panel/SueanPanleIndex":814,"./sender/SuraSenderIndex":834}],836:[function(e,t,i){"use strict";game.SurfaceCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Surface.SurfaceModuleProto,this.onSurfaceModuleProto,this),b8e.addNH(game.pbmid.Surface.ActivateSurfaceResponse,this.onActivateSurfaceResponse,this),b8e.addNH(game.pbmid.Surface.UpdateSurfaceResponse,this.onUpdateSurfaceResponse,this)},onUpdateSurfaceResponse:function(e){var t=e.readProtobuf(game.pbmsg.UpdateSurfaceResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.surface.updateSurfaceComplete(t))},onActivateSurfaceResponse:function(e){var t=e.readProtobuf(game.pbmsg.ActivateSurfaceResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.surface.activateSurfaceComplete(t))},onSurfaceModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.SurfaceModuleProto);t&&game.surface.setup(t)}})},{}],837:[function(e,t,i){"use strict";game.SurfaceEvent=b8e.Enum({SURFACE_INFO_CHANGE:b8e.Event.nextCode()})},{}],838:[function(e,t,i){"use strict";game.SurfaceMgr=b8e.Object.extends({usingSurface:0,haveSurface:null,isInit:!1,curSurfaceIndex:0,curSurfaceId:0,surfaceMap:null,selectSurfaceType:0,ctor:function(){this._super(),this.surfaceMap=b8e.HashMap.get(),this.haveSurface=[]},setup:function(e){if(e){var t=e.id;t&&0!=t.length&&(this.haveSurface=t),this.usingSurface=e.usingSurface,this.isInit=!0,b8e.evt.dptG(game.SurfaceEvent.SURFACE_INFO_CHANGE)}},getSurfaceInfo:function(){this.isInit?b8e.evt.dptG(game.SurfaceEvent.SURFACE_INFO_CHANGE):game.SurfaceSender.initSurface()},getUsingId:function(){return this.usingSurface},getSurfacesByType:function(e){var t=this.surfaceMap.get(e);if(t)return t;t=[],this.surfaceMap.set(e,t);var i=game.ccfg.SurfaceCfg.getDatas();if(!i)return t;for(var n=game.mainRole.mainRoleData.sex,s=0;s<i.length;s++){var a=i[s];a.surfaceType!=e||0!=a.sex&&a.sex!=n||t.push(a)}return t},clickActive:function(){var e=game.ccfg.SurfaceCfg.getDataById(this.curSurfaceId);if(e){var t=this.getHaveSurface(this.curSurfaceId),i=this.getUsingId();if(t){if(i==this.curSurfaceId)return;this.updateSurface(this.curSurfaceId)}else{this.getSurfaceCanActive(e)?this.activateSurface(this.curSurfaceId):game.notice.show("条件未满足，不可激活时装")}}},selectSurfaceId:function(e){if(this.curSurfaceId!=e){for(var t=this.getSurfacesByType(this.selectSurfaceType),i=0;i<t.length;i++){if(t[i].id==e){this.curSurfaceIndex=i;break}}b8e.evt.dptG(game.SurfaceEvent.SURFACE_INFO_CHANGE)}},getHaveSurface:function(e){return-1!=this.haveSurface.indexOf(e)},activateSurface:function(e){1!=this.getHaveSurface(e)&&game.SurfaceSender.activateSurface(e)},activateSurfaceComplete:function(e){!e||0<e.code||1!=this.getHaveSurface(e.id)&&(this.haveSurface.push(e.id),this.updateSurface(e.id),b8e.evt.dptG(game.SurfaceEvent.SURFACE_INFO_CHANGE),game.notice.show("时装激活成功"))},updateSurface:function(e){game.ccfg.SurfaceCfg.getDataById(e)&&(this.usingSurface!=e?game.SurfaceSender.updateSurface(e):game.notice.show("该装扮当前正在使用中"))},updateSurfaceComplete:function(e){!e||0<e.code||game.ccfg.SurfaceCfg.getDataById(e.id)&&(this.usingSurface=e.id,b8e.evt.dptG(game.SurfaceEvent.SURFACE_INFO_CHANGE),game.notice.show("穿戴成功"))},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.SURFACE_ALERT,game.SpotAlertChildrens.SURFACE_ALERT_CHILDRENS),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.FASHION,null,this.fashionFilter,this)},fashionFilter:function(){if(game.funcOpen.checkOpen(game.FunctionType.SURFACE)){var e=this.getSurfacesByType(game.SurfaceType.Fashion);if(!e||0==e.length)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(this.getSurfaceCanActive(i))return!0}}return!1},getSurfaceCanActive:function(e){var t=e.conditionValue;switch(e.conditionType){case game.SurfaceConditionType.EquipStar:var i=game.equip.getFullEquipStarSuits(t);if(game.equip.EQUIP_MAX_COUNT<=i&&0==this.getHaveSurface(e.id))return!0;break;case game.SurfaceConditionType.None:var n=e.items;if(n)for(var s=0;s<n.length;++s){var a=n[s];if(!(game.back.getItemInfoCountById(a.Id)>=a.Num))return!1;if(0==this.getHaveSurface(e.id))return!0}}return!1}}),game.SurfaceMgr._instance=null,game.SurfaceMgr.inst=function(){return game.SurfaceMgr._instance||(game.SurfaceMgr._instance=new game.SurfaceMgr),game.SurfaceMgr._instance}},{}],839:[function(e,t,i){"use strict";game.FashionItem=game.SkinUI.extends({_icon:null,_data:null,ctor:function(){this._super("surface/FashionItemSkin","FashionItemSkin")},onShow:function(){this.initItem(),this.setData(this._data),b8e.evt.onC(this._skin.touch,this.onClickIcon,this)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onClickIcon,this)},onClickIcon:function(){this._data&&game.surface.selectSurfaceId(this._data.id)},initItem:function(){this._icon||(this._icon=b8e.Sprite.get(),this._icon.addToParent(this._skin.icon))},setData:function(e){if(this._data=e,this._skin){var t=game.surface;t.curSurfaceId==this._data.id?this._skin.isSelect.active=!0:this._skin.isSelect.active=!1,this._skin.nameNode.string=e.name,t.getUsingId()==this._data.id?this._skin.isUsing.active=!0:this._skin.isUsing.active=!1;var i=t.getSurfaceCanActive(e);this._skin.alert.active=!!i,e.icon?this._icon.loadTexture(game.ClientCfg.getSurfaceUrl(e.icon),null,null,{useManifest:!1}):this._icon.unloadTexture(),game.surface.getHaveSurface(this._data.id)?b8e.ShaderUtil.reset(this._icon):b8e.ShaderUtil.setGray(this._icon)}},getHeight:function(){return 180},getWidth:function(){return 107}})},{}],840:[function(e,t,i){"use strict";game.FashionPage=game.SkinUI.extends({_list:null,_iconName:null,_sceneLayer:null,_model:null,_bg:null,ctor:function(){this._super("surface/FashionSkin","FashionSkin")},onShow:function(){b8e.evt.addG(this,game.SurfaceEvent.SURFACE_INFO_CHANGE,this.initPanel),b8e.evt.onC(this._skin.left,this.onLeftClick,this),b8e.evt.onC(this._skin.right,this.onRightClick,this),b8e.evt.onC(this._skin.activeBtn,this.onActiveBtnClick,this),b8e.evt.onC(this._skin.goto,this.onGoToBtnClick,this),this.initList(),this.showPanel(),game.surface.getSurfaceInfo(),this._list.show()},onHide:function(){b8e.evt.rmvG(this,game.SurfaceEvent.SURFACE_INFO_CHANGE,this.initPanel),b8e.evt.offC(this._skin.left,this.onLeftClick,this),b8e.evt.offC(this._skin.right,this.onRightClick,this),b8e.evt.offC(this._skin.activeBtn,this.onActiveBtnClick,this),b8e.evt.offC(this._skin.goto,this.onGoToBtnClick,this);var e=this._model.getAnimator(game.AnimatorType.BODY,1);e&&e.stop(),this._list&&this._list.hide()},onGoToBtnClick:function(){var e=game.surface,t=e.getSurfacesByType(game.SurfaceType.Fashion);if(t&&0!=t.length)switch(t[e.curSurfaceIndex].conditionType){case game.SurfaceConditionType.None:game.pay.showPayPanel();break;case game.SurfaceConditionType.EquipStar:game.funcOpen.checkOpenWithTips(game.FunctionType.EQUIP_SHENG_XING)&&game.app.show(game.AppConstant.EQUIP_FORGE_PANEL,1)}},onLeftClick:function(){var e=game.surface,t=e.getSurfacesByType(game.SurfaceType.Fashion);t&&0!=t.length&&0!=e.curSurfaceIndex&&(e.curSurfaceIndex--,this.initPanel())},onRightClick:function(){var e=game.surface,t=e.getSurfacesByType(game.SurfaceType.Fashion);t&&0!=t.length&&(e.curSurfaceIndex>=t.length-1||(e.curSurfaceIndex++,this.initPanel()))},onActiveBtnClick:function(){game.surface.clickActive()},initList:function(){this._list||(this._list=new b8e.List(this._skin.list,game.FashionItem,20)),this._iconName||(this._iconName=b8e.Sprite.get(),this._iconName.addToParent(this._skin.iconName)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.bgNode),this._bg.loadTexture(game.ClientCfg.IMAGE_URL+"bianshen/bianshenDetalilsBg.jpg",null,null,{useManifest:!1}),this._bg.setSize(545,383)),this._model||(this._model=b8e.SceneEntity.get(),this._model.addToParent(this._skin.model),this._model.setFaceRadian(game.Direction.getRadian(game.Direction.Down)))},showPanel:function(){game.surface.curSurfaceIndex=0,this._skin.list.scrollToBottomLeft(0)},initPanel:function(){var e=game.surface,t=e.getSurfacesByType(game.SurfaceType.Fashion);if(t&&0!=t.length){var i=t[e.curSurfaceIndex];e.curSurfaceId=i.id,this._list.setData(t),i.nameIcon?this._iconName.loadTexture(game.ClientCfg.getSurfaceUrl(i.nameIcon),null,null,{useManifest:!1}):this._iconName.unloadTexture();var n=game.ClientCfg.getAvatarAnim(game.RoleType.UIRole,i.res),s=this._model.getAnimator(game.AnimatorType.BODY,1);n?(s||(s=this._model.addAnimator(game.AnimatorType.BODY,1,-10)),s.load(n),s.play()):s&&s.clear(),this._skin.activeNode.active=!1,this._skin.activeBtn.active=!1;var a=e.getHaveSurface(e.curSurfaceId),o=e.getUsingId();if(a)o==e.curSurfaceId?this._skin.activeBtn.active=!1:(this._skin.activeBtn.active=!0,this._skin.activeBtnLbl.string="穿 戴"),this._skin.activeAlert.active=!1;else{this._skin.activeBtn.active=!0,this._skin.activeBtnLbl.string="激 活";var r,h=i.conditionValue;switch(i.conditionType){case game.SurfaceConditionType.None:var g=!(this._skin.activeNode.active=!0),l=i.items;if(l)for(var c=0;c<l.length;++c){var u=l[c];g=game.back.getItemInfoCountById(u.Id)>=u.Num}g?(this._skin.isActive.active=!0,this._skin.activeAlert.active=!0,this._skin.goto.active=!1,r=b8e.ColorUtil.toCCColor(4285851152),b8e.ShaderUtil.reset(this._skin.activeNode),h=1):(b8e.ShaderUtil.setGray(this._skin.activeNode),r=b8e.ColorUtil.toCCColor(4293387742),this._skin.isActive.active=!1,this._skin.activeAlert.active=!1,this._skin.goto.active=!0,h=0),this._skin.activeNeeds.node.color=r;var m=game.ccfg.LangCfg.replaceStr(i.desc,[h]);this._skin.activeNeeds.string=m;break;case game.SurfaceConditionType.EquipStar:this._skin.activeNode.active=!0;var _=game.equip.getFullEquipStarSuits(h),d=game.equip.EQUIP_MAX_COUNT;d<=_?(this._skin.isActive.active=!0,this._skin.activeAlert.active=!0,this._skin.goto.active=!1,r=b8e.ColorUtil.toCCColor(4285851152),b8e.ShaderUtil.reset(this._skin.activeNode)):(b8e.ShaderUtil.setGray(this._skin.activeNode),r=b8e.ColorUtil.toCCColor(4293387742),this._skin.isActive.active=!1,this._skin.activeAlert.active=!1,this._skin.goto.active=!0),this._skin.activeNeeds.node.color=r,this._skin.activeNeeds.string="所有装备槽达到"+h+"星可激活("+_+"/"+d+")"}}}else this._list.setData(t)}})},{}],841:[function(e,t,i){"use strict";game.appModule.SurfacePanel=game.SkinUIPanel.extends({fashion:null,nickname:null,ornament:null,_curPanel:null,onShow:function(){b8e.evt.onC(this._skin.toggle[0].node,this.onSelectFashion,this),b8e.evt.onC(this._skin.toggle[1].node,this.onSelectNickName,this),b8e.evt.onC(this._skin.toggle[2].node,this.onSelectOrnament,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert),this.showSurface(),this.onSpotAlertChange(),game.ornament.showAlert=game.ornament.checkShowAlert(),this.onOrnamentRefreshAlert()},onHide:function(){this._curPanel&&this._curPanel.hide(),b8e.evt.offC(this._skin.toggle[0].node,this.onSelectFashion,this),b8e.evt.offC(this._skin.toggle[1].node,this.onSelectNickName,this),b8e.evt.offC(this._skin.toggle[2].node,this.onSelectOrnament,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.OrnamentEvent.REFRESH_ALERT,this.onOrnamentRefreshAlert)},onSpotAlertChange:function(){this._skin.fashionAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.FASHION),this._skin.nicknameAlert.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.NICKNAME_ALERT)},onOrnamentRefreshAlert:function(){this._skin.ornamentAlert.active=game.ornament.showAlert},onSelectFashion:function(){game.surface.selectSurfaceType!=game.SurfaceType.Fashion&&(game.surface.selectSurfaceType=game.SurfaceType.Fashion,this.showSurface())},onSelectNickName:function(){game.surface.selectSurfaceType!=game.SurfaceType.NickName&&(game.surface.selectSurfaceType=game.SurfaceType.NickName,this.showSurface())},onSelectOrnament:function(){game.funcOpen.checkOpenWithTips(game.FunctionType.ORNAMENT)&&(game.surface.selectSurfaceType!=game.SurfaceType.Ornament&&(game.surface.selectSurfaceType=game.SurfaceType.Ornament,this.showSurface()))},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.toggle[0].check(),game.surface.selectSurfaceType=game.SurfaceType.Fashion,this.showSurface(),this._skin.toggle[0]):"1"==e?(this._skin.toggle[1].check(),game.surface.selectSurfaceType=game.SurfaceType.NickName,this.showSurface(game.SurfaceType.NickName),this._skin.toggle[1]):"2"!=e||(this._skin.toggle[2].check(),game.surface.selectSurfaceType=game.SurfaceType.Ornament,this.showSurface(game.SurfaceType.Ornament),this._skin.toggle[2]))},showSurface:function(){switch(this._curPanel&&this._curPanel.hide(),game.surface.selectSurfaceType){case game.SurfaceType.Fashion:this.fashion||(this.fashion=new game.FashionPage,this.fashion.addToParent(this._skin.page)),this.fashion.show(),this._skin.title.string="装扮",this._curPanel=this.fashion;break;case game.SurfaceType.NickName:this.nickname||(this.nickname=new game.NickNamePanel,this.nickname.addToParent(this._skin.page)),this.nickname.show(),this._skin.title.string="称号",this._curPanel=this.nickname;break;case game.SurfaceType.Ornament:this.ornament||(this.ornament=new game.OrnamentPanel,this.ornament.addToParent(this._skin.page)),this.ornament.show(),this._skin.title.string="符灵",this._curPanel=this.ornament}}})},{}],842:[function(e,t,i){"use strict";game.SurfaceSender={},game.SurfaceSender.initSurface=function(){var e=game.pbmid.Surface.SurfaceModuleRequest;b8e.sendN(e)},game.SurfaceSender.activateSurface=function(e){var t=game.pbmsg.ActivateSurfaceRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Surface.ActivateSurfaceRequest;b8e.sendN(i)},game.SurfaceSender.updateSurface=function(e){var t=game.pbmsg.UpdateSurfaceRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Surface.UpdateSurfaceRequest;b8e.sendN(i)}},{}],843:[function(e,t,i){"use strict";e("./cmd/SurfaceCmd"),e("./event/SurfaceEvent"),e("./mgr/SurfaceMgr"),e("./panel/FashionItem"),e("./panel/FashionPage"),e("./panel/SurfacePanel"),e("./sender/SurfaceSender")},{"./cmd/SurfaceCmd":836,"./event/SurfaceEvent":837,"./mgr/SurfaceMgr":838,"./panel/FashionItem":839,"./panel/FashionPage":840,"./panel/SurfacePanel":841,"./sender/SurfaceSender":842}],844:[function(e,t,i){"use strict";game.QuestCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.MainQuest.CompleteMainQuestResponse,this.onCompleteMainQuestResponse,this),b8e.addNH(game.pbmid.MainQuest.MainQuestNotify,this.onMainQuestNotify,this),b8e.addNH(game.pbmid.MainQuest.ProgressAwardResponse,this.onProgressAwardResponse,this),b8e.addNH(game.pbmid.MainQuest.ProgressAwardStateResponse,this.onProgressAwardStateResponse,this)},onCompleteMainQuestResponse:function(e){var t,i=game.pbmsg,n=e.readProtobuf(i.CompleteMainQuestResponse).code;game.pbmid.MainQuest.CompleteMainQuestRequest;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):(game.quest.isHasQuest=!1,game.quest.onMainQuestComplete(),game.quest.isAuto=!1,b8e.evt.dptG(game.QuestEvents.MAIN_QUEST_COMPLETE),(t=game.quest.questInfo)&&game.AnalyticsSDK.onFinishMainQuest(t.id),game.quest.isCompleteQuest=!0);if(t=game.quest.questInfo){var s={process:game.ccfg.MainQuestCfg.getProcessById(t.id)};game.sdk.processLog(s)}},onMainQuestNotify:function(e){var t,i,n,s=game.pbmsg,a=e.readProtobuf(s.MainQuestNotify);if(a){var o=game.quest.questInfo;if(o)o.setup(a);else{var r=new game.QuestInfo;r.setup(a),game.quest.questInfo=r}game.quest.gotoQuest(),game.quest.isHasQuest=!0;var h=game.ccfg.ClientTriggerCfg.getAlltaskTriggerList();if(0!=game.quest.triggersSequence&&game.quest.triggersSequence!=game.quest.questInfo.sequence&&(t=h.get(game.quest.triggersSequence)))for(i=0;i<t.length;i++){if(9<i){b8e.warn("单个任务序列不能超过10个触发器!任务序列id：",game.quest.questInfo.sequence);break}n=t[i],game.TriggerMgr.inst().completeTrigger(n)}if(t=h.get(game.quest.questInfo.sequence))for(game.quest.triggersSequence=game.quest.questInfo.sequence,i=0;i<t.length;i++){if(9<i){b8e.warn("单个任务序列不能超过10个触发器! 任务序列id：",game.quest.questInfo.sequence);break}n=t[i],game.TriggerMgr.inst().doTrigger(n)}game.quest.enterGameTriggers(),game.quest.onMainQuest();var g=game.SceneMgr.inst().getSceneConfig();g&&g.type==game.SceneType.NORMAL&&(game.quest.questInfo.completed&&game.quest.questInfo.isAutoComplete?game.quest.autoComplete():game.quest.autoQuest()),game.quest.curQuestId!=game.quest.questInfo.id&&(game.quest.curQuestId=game.quest.questInfo.id,game.quest._isAutoInstance=!1),b8e.evt.dptG(game.QuestEvents.MAIN_QUEST_NOTIFY)}},onProgressAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.ProgressAwardResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.questAward.onProgressAward(t.state)}},onProgressAwardStateResponse:function(e){var t=e.readProtobuf(game.pbmsg.ProgressAwardStateResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.questAward.onProgressAwardState(t.state)}}})},{}],845:[function(e,t,i){"use strict";e("./QuestCmd")},{"./QuestCmd":844}],846:[function(e,t,i){"use strict";game.QuestEvents=b8e.Enum({MAIN_QUEST_NOTIFY:b8e.Event.nextCode(),MAIN_QUEST_COMPLETE:b8e.Event.nextCode(),AUTO_MAIN_QUEST:b8e.Event.nextCode(),MAIN_QUEST_AWARD:b8e.Event.nextCode()})},{}],847:[function(e,t,i){"use strict";e("./QuestEvents")},{"./QuestEvents":846}],848:[function(e,t,i){"use strict";game.QuestMgr=b8e.Object.extends({name:"QuestMgr",_questInfo:null,isHasQuest:!1,isAuto:!1,isOpenAuto:!1,isCanAuto:!1,isRequest:!1,curQuestId:0,isCompleteQuest:!1,_timer:null,_isAutoInstance:!1,triggersSequence:0,isFirstEnterGame:!1,ctor:function(){if(1==game.QuestMgr._singleton)throw new Error("QuestMgr 只能通过单例方法获取");this._super()},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.AUTO_QUEST)&&(game.quest.isRequest=!0,game.quest.isOpenAuto=!0)},onLevelUp:function(){game.funcOpen.checkOpen(game.FunctionType.AUTO_QUEST)&&(this.isRequest||(this.isRequest=!0,this.isOpenAuto=!0))},onMainQuestComplete:function(){game.funcOpen.checkOpen(game.FunctionType.AUTO_QUEST)&&(this.isRequest||(this.isRequest=!0,this.isOpenAuto=!0))},onMainQuest:function(){game.funcOpen.checkOpen(game.FunctionType.AUTO_QUEST)&&(this.isRequest||(this.isRequest=!0,this.isOpenAuto=!0))},questInfo:{set:function(e){this._questInfo=e},get:function(){return this._questInfo}},onKillMonsterQuest:function(e){var t=game.ccfg.MonGenCfg.getMonGenInfoById(e);if(t){var i=t.pos,n=t.mapid,s=game.SceneMgr.inst().sceneId;if(game.TrusteeshipMgr.inst().pause(!0),n==s){var a=game.mainRole.mainRoleEntity;2e3<b8e.MathUtil.getDistance(a.sceneX,a.sceneY,i.X,i.Y)?(game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_MAIN_QUEST,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_MAIN_QUEST,n,[this._questInfo.id])):game.MoveToHelper.inst().moveTo(cc.v2(i.X,i.Y),0,this.moveToMapTask,this,null,!0)}else{var o=game.ccfg.SceneCfg.getSceneById(n);if(!o)return void b8e.warn("sceneId：》》》》》》》"+n);if(game.mainRole.mainRoleData.getLv()<o.unlocklevel)return void game.notice.show(18001,[o.unlocklevel]);game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_MAIN_QUEST,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_MAIN_QUEST,n,[this._questInfo.id])}}else b8e.warn("monGenId：》》》》》》》"+e)},onTalkWithNpcQuest:function(e){var t=game.ccfg.NpcGenCfg.getNpcGenById(e).mapid,i=game.SceneMgr.inst().sceneId;game.TrusteeshipMgr.inst().pause(!0),t==i?game.DialogMgr.inst().questNpcDialog(e):(game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_MAIN_QUEST,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_MAIN_QUEST,t,[this._questInfo.id]))},onClickQuest:function(){var e=game.SceneMgr.inst().getSceneConfig();if((!e||e.type==game.SceneType.NORMAL)&&(game.ScenePickMgr.inst().selectTarget(null),this._questInfo&&(1==this._questInfo.completed&&game.QuestSender.reqCompleteMainQuest(this._questInfo.id),0==this._questInfo.completed)))switch(this._questInfo.conditionType){case game.MainQuestType.ROLE_LV:this._roleLevelQuest();break;case game.MainQuestType.KILL_MONSTER:this._killMonsterQuest();break;case game.MainQuestType.KILL_SCENE_MONSTER:this._killSceneMonsterQuest();break;case game.MainQuestType.COMPLETE_INSTANCE:this._completeInstanceQuest();break;case game.MainQuestType.ARENA_CHALLENGE:case game.MainQuestType.UPGRADE_EQUIP_SLOT:case game.MainQuestType.SMELT_EQUIP:case game.MainQuestType.RAFFLE:case game.MainQuestType.COMPLETE_TYPE_INSTANCE:var t=this._questInfo.conditionParam2;t&&this.questTrigger(t);break;case game.MainQuestType.TALK_WITH_NPC:this._talkWithNpcQuest()}},_roleLevelQuest:function(){this.getTrusteeshipLocation()},_killMonsterQuest:function(){var e=this._questInfo.destinationList[0];this.onKillMonsterQuest(e)},_killSceneMonsterQuest:function(){var e=this._questInfo.destinationList;if(e&&0<e.length){var t=e[0];this.onKillMonsterQuest(t)}else{var i=this._questInfo.conditionParam1,n=game.SceneMgr.inst().sceneId;game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().pause(!0),i==n?this.moveToMapTask():(game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_MAIN_QUEST,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_MAIN_QUEST,i,[this._questInfo.id]))}},_talkWithNpcQuest:function(){var e=this._questInfo.conditionParam1;this.onTalkWithNpcQuest(e)},_completeInstanceQuest:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e)switch(e.type){case game.SceneType.NORMAL:game.SceneSender.enterAloneDungeon();break;case game.SceneType.DUNGEON:game.notice.show(18002)}},arenaChallenge:function(){var e=this._questInfo.conditionParam2;this.openPanel(e)},upgradeEquipSlot:function(){var e=this._questInfo.conditionParam2;if(0<e){var t=game.ccfg.ClientViewDescCfg.getDataById(e);if(!t)return void b8e.log("没有该id的系统，系统id:"+e);var i=t.moduleName,n=game.AppConstant[i];game.app.show(n,0)}},smeltEquip:function(){var e=this._questInfo.conditionParam2;this.questTrigger(e)},raffle:function(){var e=this._questInfo.conditionParam2;if(0<e){var t=game.ccfg.ClientViewDescCfg.getDataById(e);if(!t)return void b8e.log("没有该id的系统，系统id:"+e);var i=t.moduleName,n=game.AppConstant[i];game.app.show(n,game.ShopType.BianShen)}},openPanel:function(e){if(0<e){var t=game.ccfg.ClientViewDescCfg.getDataById(e);if(!t)return void b8e.log("没有该id的系统，系统id:"+e);var i=t.moduleName,n=game.AppConstant[i];game.app.show(n)}},moveToMapTask:function(){if(this._questInfo&&0==this._questInfo.completed)switch(this._questInfo.conditionType){case game.MainQuestType.KILL_MONSTER:case game.MainQuestType.KILL_SCENE_MONSTER:var e=this._questInfo.destinationList[0],t=game.ccfg.MonGenCfg.getMonGenInfoById(e),i=0;t&&(i=t.monid),game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().start(i);break;case game.MainQuestType.TALK_WITH_NPC:var n=this._questInfo.conditionParam1;game.DialogMgr.inst().questNpcDialog(n);break;case game.MainQuestType.ROLE_LV:game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().start()}},StartTrusteeship:function(){game.TrusteeshipMgr.inst().start()},getTrusteeshipLocation:function(){var e=game.mainRole.mainRoleData.getLv();if(e){var t=game.ccfg.ExpCfg.getCfgByLevel(e);if(!t)return;var i=t.guajiPlaces;if(!i||i.length<0)return;var n=i[Math.floor(Math.random()*i.length)];if(!n)return;var s=game.ccfg.MonGenCfg.getMonGenInfoById(n);if(!s)return;s.pos;var a=s.mapid;a==game.SceneMgr.inst().sceneId?game.TrusteeshipMgr.inst().start():(game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_TRUSTEESHIP,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_TRUSTEESHIP,a,[this._questInfo.id]))}},autoQuest:function(){if(this.isOpenAuto&&this._questInfo&&this._questInfo.isAuto&&this.isCanAuto){var e=game.SceneMgr.inst().getSceneConfig();if(!e||e.type==game.SceneType.NORMAL)if(this._questInfo.completed)this.onClickQuest();else switch(this._questInfo.conditionType){case game.MainQuestType.KILL_MONSTER:case game.MainQuestType.KILL_SCENE_MONSTER:this.isAuto?this.moveToMapTask():(this.isAuto=!0,this.onClickQuest()),this._isAutoInstance=!1;break;case game.MainQuestType.COMPLETE_INSTANCE:this._isAutoInstance?this.changeAuto(!1):(this.onClickQuest(),this._isAutoInstance=!0);break;case game.MainQuestType.TALK_WITH_NPC:var t=game.app.isShow(game.AppConstant.DIALOG_PANEL);this.isCanAuto&&!t&&this.onClickQuest(),this._isAutoInstance=!1;break;default:this._isAutoInstance=!1}}},startQuestTimer:function(){this._timer||(this._timer=b8e.Timer.add(this,this.startFindAttack,3e3,0)),this._timer.reset(),this._timer.start()},stopQuestTimer:function(){this._timer&&this._timer.stop()},startFindAttack:function(){switch(this._questInfo.conditionType){case game.MainQuestType.KILL_MONSTER:case game.MainQuestType.KILL_SCENE_MONSTER:b8e.log("------------检测 自动任务");var e=game.mainRole.mainRoleEntity;if(!e)return;if(!e.getStateMachine().isIdle())return;var t=game.TrusteeshipMgr.inst().autoFight;this.isCanAuto&&t&&(b8e.log("------------检测 并执行自动任务"),this.onClickQuest());break;case game.MainQuestType.TALK_WITH_NPC:var i=game.app.isShow(game.AppConstant.DIALOG_PANEL);this.isCanAuto&&!i&&this.onClickQuest();break;default:this._isAutoInstance=!1}},gotoQuest:function(){!this.isOpenAuto&&this._questInfo&&this._questInfo.isAuto&&this.isCompleteQuest&&(this.onClickQuest(),this.isCompleteQuest=!1)},changeAuto:function(e){this.isCanAuto=e,this.isAuto=!1,this._isAutoInstance=!1,b8e.evt.dptG(game.QuestEvents.AUTO_MAIN_QUEST)},questTrigger:function(e){game.TriggerMgr.inst().triggerById(e)},autoComplete:function(){this._questInfo&&this._questInfo.isAutoComplete&&this._questInfo.completed&&this.onClickQuest()},enterGameTriggers:function(){this.isFirstEnterGame||(this.isFirstEnterGame=!0,b8e.Tween.get(this).wait(1e3).call(this.triggerTask,this))},triggerTask:function(){game.TriggerMgr.inst().taskTrigger()}}),game.QuestMgr._instance=null,game.QuestMgr._singleton=!0,game.QuestMgr.inst=function(){return game.QuestMgr._instance||(game.QuestMgr._singleton=!1,game.QuestMgr._instance=new game.QuestMgr,game.QuestMgr._singleton=!0),game.QuestMgr._instance}},{}],849:[function(e,t,i){"use strict";e("./QuestMgr")},{"./QuestMgr":848}],850:[function(e,t,i){arguments[4][263][0].apply(i,arguments)},{dup:263}],851:[function(e,t,i){"use strict";var n=game.QuestSender=function(){};n.reqCompleteMainQuest=function(e){var t=game.pbmsg.CompleteMainQuestRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.MainQuest.CompleteMainQuestRequest;b8e.sendN(i)},n.reqProgressAward=function(e){var t=game.pbmsg.ProgressAwardRequest;t.num=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.MainQuest.ProgressAwardRequest;b8e.sendN(i)},n.reqProgressAwardState=function(){var e=game.pbmid.MainQuest.ProgressAwardStateRequest;b8e.sendN(e)}},{}],852:[function(e,t,i){"use strict";e("./QuestSender")},{"./QuestSender":851}],853:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_5"),e("./event/eventIndex_7"),e("./manager/managerIndex_13"),e("./panel/panelIndex_21"),e("./sender/senderIndex_7")},{"./cmdlistener/cmdlistenerIndex_5":845,"./event/eventIndex_7":847,"./manager/managerIndex_13":849,"./panel/panelIndex_21":850,"./sender/senderIndex_7":852}],854:[function(e,t,i){"use strict";game.TeamCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Team.AllTeamInfoResponse,this.onAllTeamInfoRq,this),b8e.addNH(game.pbmid.Team.TeamCreateResponse,this.onTeamCreateRp,this),b8e.addNH(game.pbmid.Team.TeamJoinResponse,this.onTeamJoinRp,this),b8e.addNH(game.pbmid.Team.TeamJoinNotify,this.onTeamJoinNotify,this),b8e.addNH(game.pbmid.Team.TeamLeaveResponse,this.onTeamLeaveRp,this),b8e.addNH(game.pbmid.Team.TeamKickMemberResponse,this.onTeamKickMemberRp,this),b8e.addNH(game.pbmid.Team.TeamLeaveNotify,this.onTeamLeaveNotify,this),b8e.addNH(game.pbmid.Team.TeamLeaderNotify,this.onTeamLeaderNotify,this),b8e.addNH(game.pbmid.Team.TeamRecommendResponse,this.onTeamRecommendRp,this),b8e.addNH(game.pbmid.Team.TeamInviteResponse,this.onTeamInviteRp,this),b8e.addNH(game.pbmid.Team.TeamBossEnterResponse,this.onTeamBossEnterRp,this),b8e.addNH(game.pbmid.Team.TeamBossFinishNotify,this.onTeamBossFinishNotify,this),b8e.addNH(game.pbmid.Team.TeamModuleResponse,this.onTeamModuleRp,this),b8e.addNH(game.pbmid.Team.TeamKickNotify,this.onTeamKickNotify,this),b8e.addNH(game.pbmid.Team.TeamBuyAwardNumResponse,this.onTeamBuyAwardNumRp,this),b8e.addNH(game.pbmid.Team.TeamCallPlayersResponse,this.onTeamCallPlayersRp,this),b8e.evt.addG(this,game.SceneEvent.LOAD_SCENE_COMPLETE,this.enterScene)},enterScene:function(){game.team.enterScene()},onTeamModuleRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamModuleResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.setTeamModule(t)}},onAllTeamInfoRq:function(e){var t=e.readProtobuf(game.pbmsg.AllTeamInfoResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.setAllTeamInfo(t)}},onTeamCreateRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamCreateResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.createTeamSuccess(t.data)}},onTeamJoinRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamJoinResponse);if(t){var i=t.code;if(0<i)return game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)),void game.team.setCurInsIdById(game.team.curInsId);game.team.joinTeamSuccess(t.data)}},onTeamJoinNotify:function(e){var t=e.readProtobuf(game.pbmsg.TeamJoinNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onJoinNotify(t.member)}},onTeamLeaveRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamLeaveResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):(game.team.onLeaveTeamSuccess(),game.team.setCurInsIdById(game.team.curInsId))}},onTeamKickMemberRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamKickMemberResponse);if(t){var i=t.code;0<i&&game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i))}},onTeamLeaveNotify:function(e){var t=e.readProtobuf(game.pbmsg.TeamLeaveNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onTeamLeave(t)}},onTeamLeaderNotify:function(e){var t=e.readProtobuf(game.pbmsg.TeamLeaderNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onTeamLeader(t.id)}},onTeamRecommendRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamRecommendResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.setTeamRecommendMap(t.datas)}},onTeamInviteRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamInviteResponse);if(t){var i=t.code;0<i&&game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i))}},onTeamBossEnterRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamBossEnterResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.enterScene()}},onTeamBossFinishNotify:function(e){var t=e.readProtobuf(game.pbmsg.TeamBossFinishNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onTeamBossSuccess(t)}},onTeamKickNotify:function(e){var t=e.readProtobuf(game.pbmsg.TeamKickNotify);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):(game.team.onTeamKick(t.name),game.team.setCurInsIdById(game.team.curInsId))}},onTeamBuyAwardNumRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamBuyAwardNumResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onBuyCardSuccess(t.num)}},onTeamCallPlayersRp:function(e){var t=e.readProtobuf(game.pbmsg.TeamCallPlayersResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.team.onPostWorldRecruit(t.nextCallTime)}}})},{}],855:[function(e,t,i){"use strict";game.TeamType=b8e.Enum({JOINTEAM_TYPE:0,CREATTEAM_TYPE:1,BEGIN_TEAMBOSS:2})},{}],856:[function(e,t,i){"use strict";game.TeamEvent=b8e.Enum({TEAM_INIT:b8e.Event.nextCode(),UPDATE_TEAM_MODULE_INFO:b8e.Event.nextCode(),UPDATE_TEAM_INFO:b8e.Event.nextCode(),CREATE_TEAM_SUCCESSS:b8e.Event.nextCode(),BUY_TOKEN_SUCCESS:b8e.Event.nextCode(),BE_RQTEAMINVITE:b8e.Event.nextCode(),UPDATE_TEAM_ROOM:b8e.Event.nextCode(),LEAVE_TEAM:b8e.Event.nextCode(),CHANGE_TEAMMEMBERS:b8e.Event.nextCode(),TEAM_CALLPLAYER:b8e.Event.nextCode()})},{}],857:[function(e,t,i){"use strict";game.TeamMgr=b8e.Object.extends({teamModule:null,dungeonInfoList:null,allTeamInfoMap:null,curTeam:null,teamRecommendMap:null,curInsId:0,curIndex:0,curTeamId:0,isInTeam:!1,maxAwardNum:0,maxBuyCardNum:0,nextDungeonNum:3,teamMaxMember:3,isLeader:!1,isAutoBegin:!1,isrqTeamModule:!1,cdTimer:0,isShowFriendPanel:!0,isShowTeamTips:!0,isAutoStart:!1,enterBossMebers:null,gameAlertInfo:null,postGuildTimer:0,postWorldTimer:0,showDoubleTimeArr:null,ctor:function(){this._super(),this.teamModule=new game.TeamModule,this.dungeonInfoList=[],this.allTeamInfoMap=b8e.HashMap.get(),this.teamRecommendMap=b8e.HashMap.get()},init:function(){game.funcOpen.checkOpen(game.FunctionType.TEAM_BOSS)&&this.onRqTeamModule();var e=game.ccfg.GlobalParamCfg.getData(5206);this.showDoubleTimeArr=e.split("|")},onRqTeamModule:function(){this.isrqTeamModule||(game.TeamSender.rqTeamModule(),this.maxAwardNum=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TEAM_MAXAWARDNUM),this.maxBuyCardNum=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TEAM_BUYCARDNUM))},setTeamModule:function(e){e&&(this.teamModule.setup(e),this.isrqTeamModule=!0)},updatawithPanelOpen:function(){this.setDungeonList(),this.onRqTeamModule(),this.setCurInsId(),this.checkIsInTeam()},getCurAwardNum:function(){return this.teamModule?this.teamModule.awardNum:0},getCurBuyCarNum:function(){return this.teamModule?this.teamModule.buyAwardNum:0},resetData:function(){this.teamModule&&(this.teamModule.awardNum=this.maxAwardNum,this.teamModule.buyAwardNum=0,b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_INFO),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_ROOM))},setCurInsId:function(){var e=game.ccfg.DungeonCfg.getTeamDungeonList();if(e){for(var t=game.mainRole.mainRoleData.getLv(),i=0,n=0;n<e.length&&e[n].limitLv<=t;++n)i=e[n].id,this.curIndex=n;this.setCurInsIdById(i)}},setCurInsIdById:function(e){this.curInsId=e,this.curInsId&&game.TeamSender.rqAllTeamInfo(this.curInsId)},getCurInsId:function(){return this.curInsId},getCurBossInfoById:function(e){return game.ccfg.DungeonCfg.getDataByKey(e)},setDungeonList:function(){this.dungeonInfoList.length=0;var e=game.ccfg.DungeonCfg.getTeamDungeonList();if(e)for(var t=game.mainRole.mainRoleData.getLv(),i=0,n=e.length,s=0;s<n;++s){if(i==this.nextDungeonNum)return;this.dungeonInfoList.push(e[s]),e[s].limitLv>t&&++i}},getDungeonList:function(){return this.dungeonInfoList},checkFirstAwardByDungeonId:function(e){if(!this.teamModule||!e)return!1;var t=this.teamModule.getFirstAwardIds();return!(!t||-1==t.indexOf(e))},setAllTeamInfo:function(e){if(e){var t=this.allTeamInfoMap.get(e.insId);t||(t=new game.AllTeamInfo),t.setup(e),this.allTeamInfoMap.set(t.insId,t),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_INFO)}},checkIsInTeam:function(){if(this.curTeam){if(game.app.show(game.AppConstant.TEAM_ROOM_PANEL),!this.isShowFriendPanel)return;var e=this.enterBossMebers;e&&0<e.length&&game.relation.showFriendsRecommend(75e3,e)}},getAllTeamInfo:function(){return this.allTeamInfoMap.get(this.curInsId)},quickJoinTeam:function(){var e,t=0,i=this.getAllTeamInfo();if(i&&0<i.teams.length)for(var n=0;n<i.teams.length;++n)(e=i.teams[n]).state==game.TeamState.WAIT&&e.count<this.teamMaxMember&&(t=e.id);t?this.onJoinTeamCheck(t):this.onCreateTeamCheck()},onCreateTeamCheck:function(){0<this.teamModule.awardNum||!this.isShowTeamTips?game.TeamSender.rqTeamCreate(this.curInsId):game.app.show(game.AppConstant.TEAM_TIPS_PANEL,game.TeamType.CREATTEAM_TYPE)},onCreateTeam:function(){game.TeamSender.rqTeamCreate(this.curInsId)},onJoinTeamCheck:function(e){this.curTeamId=e,0<this.teamModule.awardNum||!this.isShowTeamTips?this.onJoinTeamByTeamId(this.curInsId,this.curTeamId):game.app.show(game.AppConstant.TEAM_TIPS_PANEL,game.TeamType.JOINTEAM_TYPE)},onJoinTeamByTeamId:function(e,t){game.TeamSender.rqTeamJoin(e,t)},joinTeamSuccess:function(e){this.curTeam||(this.curTeam=new game.Team),this.curTeam.setup(e),this.isInTeam=!0,this.curTeamId=this.curTeam.id,this.curInsId=this.curTeam.insId,game.app.show(game.AppConstant.TEAM_ROOM_PANEL),b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS)},createTeamSuccess:function(e){this.curTeam||(this.curTeam=new game.Team),this.curTeam.setup(e),this.isInTeam=!0,this.isLeader=!0,this.curTeamId=this.curTeam.id,game.app.show(game.AppConstant.TEAM_ROOM_PANEL),b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS)},onJoinNotify:function(e){this.curTeam&&(this.curTeam.addMember(e),b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_ROOM),this.onAutoBegin())},onAutoBegin:function(){3==this.getRoomMembersCount()&&this.isAutoStart&&this.isLeader&&game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.TEAM_BOSS)},onLeaveTeamSuccess:function(){this.curTeam=null,this.isInTeam=!1,this.isLeader=!1,this.curTeamId=0,b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS)},onTeamLeave:function(e){if(this.curTeam){var t=this.curTeam.getNameById(e.id);this.curTeam.leaveMember(e.id);var i="";switch(e.leaveType){case game.LeaveTeamType.INITIATIVE:i=game.ccfg.LangCfg.getText(27018,[t]);break;case game.LeaveTeamType.KICK:i=game.ccfg.LangCfg.getText(27015,[t,this.curTeam.leaderName])}game.notice.show(i),game.chat.addSystemChat(i),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_ROOM),b8e.evt.dptG(game.TeamEvent.LEAVE_TEAM),b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS)}},createInterimArr:function(e){for(var t,i=0;i<this.teamMaxMember;i++)e.length<this.teamMaxMember&&(t=new game.TeamMember,e.push(t));return e},getRoomMembers:function(){return this.curTeam?this.curTeam.members.concat():null},getRoomMembersCount:function(){return this.curTeam&&this.curTeam.members?this.curTeam.members.length:0},getCurLeaderId:function(){return this.curTeam?this.curTeam.getLeaderId():0},onTeamLeader:function(e){this.curTeam&&(this.curTeam.changeLeader(e),game.mainRole.mainRoleData.playerId==e&&(this.isLeader=!0))},onTeamKick:function(e){this.curTeam=null,this.isInTeam=!1,this.isLeader=!1,this.curTeamId=0;var t=game.ccfg.LangCfg.getText(27014,[e]);game.notice.show(t),game.chat.addSystemChat(t),game.app.isShow(game.AppConstant.TEAM_ROOM_PANEL)&&game.app.hide(game.AppConstant.TEAM_ROOM_PANEL),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_INFO),b8e.evt.dptG(game.TeamEvent.CHANGE_TEAMMEMBERS)},setAutoBegin:function(){this.isAutoBegin=!this.isAutoBegin},getIsAutoBegin:function(){return this.isAutoBegin},isEnoughMember:function(){if(!this.curTeam)return!1;var e=this.curTeam.members;return!(!e||e.length!=this.teamMaxMember)},onRqTeamRecommend:function(){this.isLeader&&(0<=game.SysTime.curTime-this.cdTimer?(game.TeamSender.rqTeamRecommend(),this.cdTimer=game.SysTime.curTime+5e3):game.app.show(game.AppConstant.TEAM_INVITE_PANEL))},setTeamRecommendMap:function(e){if(e){this.teamRecommendMap.clear();for(var t=0;t<e.length;++t){var i=new game.TeamRecommendData;i.setup(e[t]),this.teamRecommendMap.set(e[t].id,i)}game.app.show(game.AppConstant.TEAM_INVITE_PANEL)}},getTeamRecommends:function(){var e=this.teamRecommendMap.values();return e.sort(this.sortTeams),e},sortTeams:function(e,t){return t.relation-e.relation},onRqTeamInvite:function(e){this.isLeader&&(game.TeamSender.rqTeamInvite(e),this.setRecommendData(e))},setRecommendData:function(e){var t=this.teamRecommendMap.get(e);t&&t.setBeInVite()},getRecommendData:function(e){var t=this.teamRecommendMap.get(e);return t||null},onBeginTeamBossCheck:function(){0<this.teamModule.awardNum||!this.isShowTeamTips?this.beginTeamBoss():game.app.show(game.AppConstant.TEAM_TIPS_PANEL,game.TeamType.BEGIN_TEAMBOSS)},beginTeamBoss:function(){this.isLeader&&game.TeamSender.rqTeamBossEnter()},onrqTeamKickMember:function(e){this.isLeader&&game.TeamSender.rqTeamKickMember(e)},getMembers:function(){if(!this.curTeam)return null;for(var e=[],t=this.curTeam.members,i=game.mainRole.mainRoleData.playerId,n=0,s=0;s<t.length;++s)i==(n=t[s].id)||game.relation.isFriend(n)||e.push(t[s]);return e},onBuyCards:function(){if(this.teamModule)if(this.teamModule.buyAwardNum>=this.maxBuyCardNum)game.notice.show(game.ccfg.LangCfg.getText(21006));else if(this.teamModule.awardNum>=this.maxAwardNum)game.notice.show(game.ccfg.LangCfg.getText(27019));else if(this.teamModule.awardNum<this.maxAwardNum){var e=game.ccfg.CostCfg.getNextCostInfo(game.SystemId.TEAM_CARD,this.teamModule.buyAwardNum);e&&game.upgrade.costCheck(this,e.upgradeInfo,this.onIsPass,!0)}else;},onIsPass:function(e){e&&game.TeamSender.rqTeamBuyAwardNum()},onBuyCardSuccess:function(e){this.teamModule&&(game.notice.show("购买成功！"),this.teamModule.awardNum=e,this.teamModule.buyAwardNum++,b8e.evt.dptG(game.TeamEvent.BUY_TOKEN_SUCCESS),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_INFO),b8e.evt.dptG(game.TeamEvent.UPDATE_TEAM_ROOM))},enterScene:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e&&e.type==game.SceneType.TEAM_BOSS){game.app.hideAllApp(),this.enterBossMebers=this.getMembers();var t=game.SysTime.curTime+parseInt(game.ccfg.GlobalParamCfg.getData(3400));game.leaveDungeon.show(t,game.SceneType.TEAM_BOSS),this.isAutoStart=!1}},onTeamBossSuccess:function(e){e&&(game.DungeonResultMgr.inst().showResult(!0,e.userItem,game.DungeonType.TYPE_TEAM),e.isFirstAward&&this.teamModule.addFirstAwardId(this.curTeam.insId),0<this.teamModule.awardNum&&this.teamModule.awardNum--,this.setShowFriendPanel(!0))},setShowFriendPanel:function(e){(this.isShowFriendPanel=e)||(this.enterBossMebers=null)},setShowTeamTips:function(e){this.isShowTeamTips=e},joinOthersTeam:function(e,t){game.funcOpen.checkOpenWithTips(game.FunctionType.TEAM_BOSS)&&(this.onRqTeamModule(),this.onJoinTeamByTeamId(e,t))},onleaveRoom:function(){this.gameAlertInfo||(this.gameAlertInfo=new game.GameAlertInfo,this.gameAlertInfo.alertType=game.GameAlertType.TwoBtn,this.gameAlertInfo.string="您将"+game.html.getText(game.html.Q_RED,"退出队伍")+"\n是否退出？",this.gameAlertInfo.obj=null,this.gameAlertInfo.isShowTips=!1,this.gameAlertInfo.confirmString="取消",this.gameAlertInfo.cancelString="退出"),game.gameAlert.showAlert(this,this.onLeaveClick,this.gameAlertInfo)},onLeaveClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CANCEL:game.TeamSender.rqTeamLeave(),game.app.hide(game.AppConstant.TEAM_ROOM_PANEL);break;case game.GameAlertBtnType.CONFIRM:case game.GameAlertBtnType.CLOSE:}},onPostGuildRecruit:function(e){this.postGuildTimer=e,b8e.evt.dptG(game.TeamEvent.TEAM_CALLPLAYER)},onPostWorldRecruit:function(e){this.postWorldTimer=e,b8e.evt.dptG(game.TeamEvent.TEAM_CALLPLAYER)},isShowDoubleIcon:function(){var e=b8e.TimeUtil.getDay(game.SysTime.curTime);if(this.showDoubleTimeArr&&0<this.showDoubleTimeArr.length)for(var t=this.showDoubleTimeArr.length,i=0;i<t;++i)if(parseInt(this.showDoubleTimeArr[i])==e)return!0;return!1}}),game.TeamMgr._instance=null,game.TeamMgr.inst=function(){return game.TeamMgr._instance||(game.TeamMgr._instance=new game.TeamMgr),game.TeamMgr._instance}},{}],858:[function(e,t,i){"use strict";game.TeamBossItem=game.SkinUI.extends({_bossInfo:null,_iconSprite:null,_prizeInfo:null,_prizeList:null,ctor:function(){this._super("team/TeamBossItemSkin","TeamBossItemSkin")},onShow:function(){this.setData(this._bossInfo),b8e.evt.onC(this._skin.node_click,this.onClickItem,this)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClickItem,this)},setData:function(e){if(this._bossInfo=e,this._skin&&this._bossInfo){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.node_boss)),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,2,!0),this._prizeList.addToParent(this._skin.prize));var t=game.mainRole.mainRoleData.getLv();this._skin.mask.active=t<e.limitLv,this._skin.lab_lv.string=game.ccfg.LangCfg.getText(27011,[e.limitLv]),this._skin.node_light.active=game.team.curInsId==e.id,this._skin.lab_name.string=e.name;var i=game.ClientCfg.getHeadportraitUrlByIconName(e.head);i&&this._iconSprite.loadTexture(i,null,null,{useManifest:!1});var n=game.team.checkFirstAwardByDungeonId(e.id);this._skin.prizeMultiple.active=n&&game.team.isShowDoubleIcon();var s=n?"通关奖励":"<color=#74d610>首通奖励</c>";if(this._skin.lab_prize.string=s,e.monster){var a=e.monster[0];if(a){var o=game.ccfg.MonsterCfg.getMonsterModelById(a.Id),r=n?o.dropId:e.dropId;this._prizeInfo.setupById(r),this._prizeList.setData(this._prizeInfo)}}}},onClickItem:function(){game.mainRole.mainRoleData.getLv()<this._bossInfo.limitLv?game.notice.show("等级未满足进入该副本条件"):game.team.setCurInsIdById(this._bossInfo.id)},setLightBgVisible:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._skin&&(this._skin.node_light.active=e)},getHeight:function(){return 298},getWidth:function(){return 180}})},{}],859:[function(e,t,i){"use strict";game.TeamFriendItem=game.SkinUI.extends({_iconSprite:null,_recommendInfo:null,ctor:function(){this._super("team/TeamFriendItemSkin","TeamFriendItemSkin")},init:function(){this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.head_icon)},onShow:function(){this.setData(this._recommendInfo),b8e.evt.onC(this._skin.btn_invite,this.onClickInvite,this)},onHide:function(){b8e.evt.offC(this._skin.btn_invite,this.onClickInvite,this)},setData:function(e){this._recommendInfo=e,this._skin&&this._recommendInfo&&(this._iconSprite.loadTexture(game.ClientCfg.getHeadIconUrlByHeadId(e.head),null,null,{useManifest:!1}),this._skin.lab_name.string=e.name,this._skin.lab_power.string=e.power,this._skin.lab_level.string="Lv."+e.level,game.relation.isFriend(e.id)?this._skin.btn_invite.active=!1:this._skin.btn_invite.active=!0)},onClickInvite:function(){this._recommendInfo&&(game.relation.addFriend(this._recommendInfo.id),this._skin.btn_invite.active=!1)},getHeight:function(){return 100},getWidth:function(){return 540}})},{}],860:[function(e,t,i){"use strict";game.appModule.TeamFriendPanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},init:function(){this.list=new b8e.List(this._skin.list,game.TeamFriendItem)},onShow:function(){this.list.show();var e=game.relation.recMembers;this._skin.desc.string=game.ccfg.LangCfg.getText(game.relation.descId),this.list.setData(e)},onHide:function(){this.list&&this.list.hide(),game.team.setShowFriendPanel(!1)}})},{}],861:[function(e,t,i){"use strict";game.appModule.TeamInvitePanel=game.SkinUIPanel.extends({list:null,ctor:function(e){this._super(e)},init:function(){this.list=new b8e.List(this._skin.list,game.TeamRecommend)},onShow:function(){var e=game.team.getTeamRecommends();e&&0!=e.length?(this._skin.noneTips.active=!1,this.list.setData(e),this.list.show()):this._skin.noneTips.active=!0},onHide:function(){this.list&&(this.list.setData(null),this.list.hide())}})},{}],862:[function(e,t,i){"use strict";game.TeamItem=game.SkinUI.extends({_iconSprite:null,_teamInfo:null,ctor:function(){this._super("team/TeamItemSkin","TeamItemSkin")},init:function(){this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.node_bg),this._iconSprite.loadTexture(game.ClientCfg.getImgUrl("team/teamBg"),null,null,{useManifest:!1})},onShow:function(){this.setData(this._teamInfo),b8e.evt.onC(this._skin.btn_join,this.onClickJoin,this)},onHide:function(){b8e.evt.offC(this._skin.btn_join,this.onClickJoin,this)},setData:function(e){this._teamInfo=e,this._skin&&this._teamInfo&&(this._skin.lab_name.string=e.leaderName,this._skin.lab_member.string=game.ccfg.LangCfg.getText(27007,[e.count,game.team.teamMaxMember]),e.state==game.TeamState.ENTER?(this._skin.btn_join.active=!1,this._skin.img_going.active=!0):(this._skin.btn_join.active=!0,this._skin.img_going.active=!1))},onClickJoin:function(){this._teamInfo&&game.team.onJoinTeamCheck(this._teamInfo.id)},getHeight:function(){return 175},getWidth:function(){return 165}})},{}],863:[function(e,t,i){"use strict";game.TeamMemberItem=game.SkinUI.extends({_memberInfo:null,_iconSprite:null,ctor:function(){this._super("team/TeamMemberItemSkin","TeamMemberItemSkin")},onShow:function(){this.setData(this._memberInfo),b8e.evt.onC(this._skin.btn_invite,this.onClickInvite,this),b8e.evt.onC(this._skin.btn_Tpeople,this.onClickT,this)},onHide:function(){b8e.evt.offC(this._skin.btn_invite,this.onClickInvite,this),b8e.evt.offC(this._skin.btn_Tpeople,this.onClickT,this)},setData:function(e){if(this._memberInfo=e,this._skin&&this._memberInfo)if(0==e.id)this._skin.btn_invite.active=game.team.isLeader,this._skin.lab_wait.string=game.team.isLeader?"":"等待队友",this._skin.node_leader.active=!1,this._skin.btn_Tpeople.active=!1,this._skin.lab_name.string="",this._skin.lab_lv.string="",this._skin.lab_power.string="",this._iconSprite&&this._iconSprite.unloadTexture();else{this._skin.lab_wait.string="",this._skin.btn_invite.active=!1,this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.node_icon));var t=game.ClientCfg.getHeadUrl(e.head);this._iconSprite.loadTexture(t,null,null,{useManifest:!1}),this._iconSprite.setScale(1.3,1.3);var i=game.mainRole.mainRoleData;game.team.isLeader&&i.playerId!=e.id?this._skin.btn_Tpeople.active=!0:this._skin.btn_Tpeople.active=!1;var n=game.team.getCurLeaderId();this._skin.node_leader.active=e.id==n,e.id==n&&(this._skin.btn_Tpeople.active=!1),this._skin.lab_name.string=e.name,this._skin.lab_lv.string=game.ccfg.LangCfg.getText(27009,[e.level]),this._skin.lab_power.string=game.ccfg.LangCfg.getText(27010,[e.power])}},onClickInvite:function(){game.team.onRqTeamRecommend()},onClickT:function(){game.team.onrqTeamKickMember(this._memberInfo.id)},getHeight:function(){return 166},getWidth:function(){return 164}})},{}],864:[function(e,t,i){"use strict";game.TeamPanel=game.SkinUI.extends({count:0,list_boss:null,list_team:null,_iconSprite:null,ctor:function(){this._super("team/TeamSkin","TeamSkin")},init:function(){this.list_boss=new b8e.List(this._skin.list_boss,game.TeamBossItem),this.list_team=new b8e.List(this._skin.list_team,game.TeamItem),this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.node_bg),this._iconSprite.loadTexture(game.ClientCfg.getImgUrl("team/bg",!0),null,null,{useManifest:!1}),this.count=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TEAM_MAXAWARDNUM),this._skin.prizeTips.string=game.ccfg.LangCfg.getText(27021)},onShow:function(){game.team.updatawithPanelOpen(),this.list_boss.show(),this.list_team.show(),this.updatePanel(),b8e.evt.onC(this._skin.btn_creat,this.onClickCreate,this),b8e.evt.onC(this._skin.btn_join,this.onClickJoin,this),b8e.evt.onC(this._skin.btn_add,this.onClickAddCount,this),b8e.evt.onC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.onC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.addG(this,game.TeamEvent.UPDATE_TEAM_INFO,this.updatePanel),this._skin.bossList_content.x=180*-game.team.curIndex},onHide:function(){this.hideList(),b8e.evt.offC(this._skin.btn_creat,this.onClickCreate,this),b8e.evt.offC(this._skin.btn_join,this.onClickJoin,this),b8e.evt.offC(this._skin.btn_add,this.onClickAddCount,this),b8e.evt.offC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.offC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.rmvG(this,game.TeamEvent.UPDATE_TEAM_INFO,this.updatePanel)},clickLeftBtn:function(){this.list_boss&&this.list_boss.scrollLeft()},clickRightBtn:function(){this.list_boss&&this.list_boss.scrollRight()},updatePanel:function(){this.updateBoss(),this.updateTeam(),this.updateTeamToken();var e=game.team.getCurBossInfoById(game.team.curInsId);e&&(this._skin.lab_bossName.string=e.name)},updateBoss:function(){var e=game.team.getDungeonList();this.list_boss.setData(e)},updateTeam:function(){var e=game.team.getAllTeamInfo();if(e){this.list_team.setData(e.teams);var t=0==e.teams.length?"暂无队伍":"";this._skin.lab_noTeam.string=t}else this.list_team.setData(null)},updateTeamToken:function(){this._skin.lab_remainCount.string=game.ccfg.LangCfg.getText(27001,[game.team.teamModule.awardNum,this.count])},onClickCreate:function(){game.team.onCreateTeamCheck()},onClickJoin:function(){game.team.quickJoinTeam()},onClickAddCount:function(){game.app.show(game.AppConstant.TEAM_TOKEN_PANEL)},hideList:function(){this.list_boss&&this.list_boss.hide(),this.list_team&&this.list_team.hide()}})},{}],865:[function(e,t,i){"use strict";e("./TeamBossItem"),e("./TeamFriendItem"),e("./TeamFriendPanel"),e("./TeamInvitePanel"),e("./TeamItem"),e("./TeamMemberItem"),e("./TeamPanel"),e("./TeamRecommend"),e("./TeamRecruitPanel"),e("./TeamRoomPanel"),e("./TeamTipsPanel"),e("./TeamTokenPanel")},{"./TeamBossItem":858,"./TeamFriendItem":859,"./TeamFriendPanel":860,"./TeamInvitePanel":861,"./TeamItem":862,"./TeamMemberItem":863,"./TeamPanel":864,"./TeamRecommend":866,"./TeamRecruitPanel":867,"./TeamRoomPanel":868,"./TeamTipsPanel":869,"./TeamTokenPanel":870}],866:[function(e,t,i){"use strict";game.TeamRecommend=game.SkinUI.extends({_iconSprite:null,_recommendInfo:null,_countDownTimer:null,ctor:function(){this._super("team/TeamRecommendSkin","TeamRecommendSkin")},init:function(){this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.head_icon)},onShow:function(){this.setData(this._recommendInfo),b8e.evt.onC(this._skin.btn_invite,this.onClickInvite,this)},onHide:function(){b8e.evt.offC(this._skin.btn_invite,this.onClickInvite,this),this._countDownTimer&&this._countDownTimer.stop()},updataItem:function(e){if(this._recommendInfo=e,this._skin&&this._recommendInfo)switch(this._iconSprite.loadTexture(game.ClientCfg.getHeadIconUrlByHeadId(e.head),null,null,{useManifest:!1}),this._skin.lab_name.string=e.name,this._skin.lab_power.string=e.power,this._skin.lab_level.string="Lv."+e.level,e.relation){case game.MemberRelationType.NONE:this._skin.guild_icon.active=!1,this._skin.friend_icon.active=!1;break;case game.MemberRelationType.FRIEND:this._skin.guild_icon.active=!1,this._skin.friend_icon.active=!0;break;case game.MemberRelationType.GUILD:this._skin.guild_icon.active=!0,this._skin.friend_icon.active=!1}},oncheckTime:function(){this._skin&&this._recommendInfo&&(this._recommendInfo=game.team.getRecommendData(this._recommendInfo.id),this.countDown(),0<this._recommendInfo.nextInviteTime-game.SysTime.curTime&&(this._countDownTimer||(this._countDownTimer=b8e.Timer.add(this,this.countDown,1e3)),this._countDownTimer.reset(),this._countDownTimer.start()))},countDown:function(){if(this._recommendInfo){var e=this._recommendInfo.nextInviteTime-game.SysTime.curTime+200;if(0<e){this._skin.btn_invite.active=!1,this._skin.timeNode.active=!0;var t=parseInt(b8e.TimeUtil.formatTimestamp(e,"s"));0<t?this._skin.lab_time.string=t+"s":(this._skin.btn_invite.active=!0,this._skin.timeNode.active=!1)}else this._skin.btn_invite.active=!0,this._skin.timeNode.active=!1,this._countDownTimer&&this._countDownTimer.stop()}else this._countDownTimer&&this._countDownTimer.stop()},setData:function(e){this._recommendInfo=e,this._skin&&this._recommendInfo&&(this.updataItem(this._recommendInfo),this.oncheckTime())},onClickInvite:function(){this._recommendInfo&&(game.team.onRqTeamInvite(this._recommendInfo.id),this.oncheckTime())},getHeight:function(){return 80},getWidth:function(){return 540}})},{}],867:[function(e,t,i){"use strict";game.appModule.TeamRecruitPanel=game.SkinUIPanel.extends({_countDownTimer:null,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.addG(this,game.TeamEvent.TEAM_CALLPLAYER,this.onCheckTime),b8e.evt.onC(this._skin.world_Btn,this.onPostWorld,this),this.setData()},onHide:function(){b8e.evt.rmvG(this,game.TeamEvent.TEAM_CALLPLAYER,this.onCheckTime),b8e.evt.offC(this._skin.world_Btn,this.onPostWorld,this),this._countDownTimer&&this._countDownTimer.stop()},setData:function(){var e="",t="",i=game.mainRole.mainRoleData;i&&(e=i.name);var n=game.team.getCurBossInfoById(game.team.curTeam.insId);n&&(t=n.name),this._skin.contenstr.string=game.ccfg.LangCfg.getText(27022,[e,t]),this.onCheckTime()},onCheckTime:function(){if(this._skin){this.countDown();var e=game.team.postGuildTimer-game.SysTime.curTime,t=game.team.postWorldTimer-game.SysTime.curTime;(0<e||0<t)&&(this._countDownTimer||(this._countDownTimer=b8e.Timer.add(this,this.countDown,1e3)),this._countDownTimer.reset(),this._countDownTimer.start(),this._skin.world_Btn_3.active=!0)}},countDown:function(){var e=game.team.postGuildTimer-game.SysTime.curTime,t=game.team.postWorldTimer-game.SysTime.curTime,i="";0<e||0<t?(i=0<e?parseInt(b8e.TimeUtil.formatTimestamp(e,"s"))+"s":"",this._skin.time_guild.string=i,i=0<t?parseInt(b8e.TimeUtil.formatTimestamp(t,"s"))+"s":"",this._skin.time_world.string=i):(this._countDownTimer&&this._countDownTimer.stop(),this._skin.time_guild.string="",this._skin.time_world.string="",this._skin.world_Btn_3.active=!1)},onPostWorld:function(){0<game.team.postWorldTimer-game.SysTime.curTime||game.TeamSender.rqTeamCallPlayers()}})},{}],868:[function(e,t,i){"use strict";game.appModule.TeamRoomPanel=game.SkinUIPanel.extends({count:0,_countDown:5,_iconSprite:null,_bossItem:null,list_member:null,_timer:null,ctor:function(e){this._super(e)},init:function(){this.list_member=new b8e.List(this._skin.list_member,game.TeamMemberItem),this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.node_bg),this._iconSprite.loadTexture(game.ClientCfg.getImgUrl("team/bg",!0),null,null,{useManifest:!1}),this.count=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TEAM_MAXAWARDNUM),this._countDown=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TEAM_COUNT_DOWN)>>0},onShow:function(){var e=game.team.getCurBossInfoById(game.team.curTeam.insId);e&&(this._skin.lab_bossName.string=e.name),this._skin.toTeamRecruit.active=game.team.isLeader,this.updateBoss(e),this.list_member.show(),this.updatePanel(),this._skin.btn_auto.isChecked=game.team.isAutoStart,b8e.evt.onC(this._skin.btn_leave,this.onClickLeave,this),b8e.evt.onC(this._skin.btn_close,this.onCloseTeamPanel,this),b8e.evt.onC(this._skin.btn_return,this.onCloseTeamPanel,this),b8e.evt.onC(this._skin.toTeamRecruit,this.onToTeamRecruit,this),b8e.evt.onC(this._skin.btn_start,this.onClickStart,this),b8e.evt.onC(this._skin.btn_auto.node,this.onClickAuto,this),b8e.evt.onC(this._skin.btn_add,this.onClickAdd,this),b8e.evt.addG(this,game.TeamEvent.UPDATE_TEAM_ROOM,this.updatePanel),b8e.evt.addG(this,game.TeamEvent.LEAVE_TEAM,this.stopCountDown)},onHide:function(){this.list_member&&this.list_member.hide(),this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_leave,this.onClickLeave,this),b8e.evt.offC(this._skin.btn_close,this.onCloseTeamPanel,this),b8e.evt.offC(this._skin.btn_return,this.onCloseTeamPanel,this),b8e.evt.offC(this._skin.btn_start,this.onClickStart,this),b8e.evt.offC(this._skin.btn_auto.node,this.onClickAuto,this),b8e.evt.offC(this._skin.toTeamRecruit,this.onToTeamRecruit,this),b8e.evt.offC(this._skin.btn_add,this.onClickAdd,this),b8e.evt.rmvG(this,game.TeamEvent.UPDATE_TEAM_ROOM,this.updatePanel),b8e.evt.rmvG(this,game.TeamEvent.LEAVE_TEAM,this.stopCountDown)},updatePanel:function(){this.updateTeam(),this.updateTeamToken(),game.team.isLeader?(this._skin.btn_start.active=!0,this._skin.node_auto.active=!0,this._skin.btn_leave.x=204):(this._skin.btn_start.active=!1,this._skin.node_auto.active=!1,this._skin.btn_leave.x=298)},updateTeam:function(){if(game.team.getRoomMembers()){var e=game.team.getRoomMembers();3==e.length&&game.team.isAutoStart&&game.team.isLeader&&(this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateTime,1e3));var t=game.team.createInterimArr(e);this.list_member.setData(t)}else this.hide()},updateBoss:function(e){this._bossItem||(this._bossItem=new game.TeamBossItem(e),this._bossItem.setSize(124,140),this._bossItem.setAnchor(.5,.5),this._bossItem.addToParent(this._skin.node_boss)),this._bossItem.show(),this._bossItem.setData(e),this._bossItem.setLightBgVisible()},updateTeamToken:function(){this._skin.lab_remainCount.string=game.ccfg.LangCfg.getText(27001,[game.team.teamModule.awardNum,this.count])},updateTime:function(){this._countDown<=0?(this.stopCountDown(),game.team.beginTeamBoss()):(this._skin.node_auto.active=!1,this._skin.lab_time.string=game.ccfg.LangCfg.getText(27006,[this._countDown]),this._countDown--)},stopCountDown:function(){this._timer&&this._timer.stop(),game.team.isLeader&&(this._skin.node_auto.active=!0,this._skin.lab_time.string="",this._countDown=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TEAM_COUNT_DOWN))},onClickLeave:function(){game.team.onleaveRoom()},onClickStart:function(){game.team.onBeginTeamBossCheck()},onClickAuto:function(){game.team.isAutoStart=!game.team.isAutoStart,this.updatePanel()},onClickAdd:function(){game.app.show(game.AppConstant.TEAM_TOKEN_PANEL)},onCloseTeamPanel:function(){this.hide(),game.app.hide(game.AppConstant.DUNGEON_PANEL)},onToTeamRecruit:function(){game.app.show(game.AppConstant.TEAM_RECRUIT_PANEL)}})},{}],869:[function(e,t,i){"use strict";game.appModule.TeamTipsPanel=game.SkinUIPanel.extends({type:0,ctor:function(e){this._super(e)},init:function(){var e=game.ccfg.LangCfg.getText(27005);this._skin.lab_desc.string=e},onShow:function(){null!=this.data&&(this.type=this.data),b8e.evt.onC(this._skin.displayBtn.node,this.onDisplayBtnBack,this),b8e.evt.onC(this._skin.btn_buy,this.onClickBuy,this),b8e.evt.onC(this._skin.continueBtn,this.onContinue,this),game.team.isShowTeamTips?this._skin.displayBtn.uncheck():this._skin.displayBtn.check()},onHide:function(){b8e.evt.offC(this._skin.displayBtn.node,this.onDisplayBtnBack,this),b8e.evt.offC(this._skin.btn_buy,this.onClickBuy,this),b8e.evt.offC(this._skin.continueBtn,this.onContinue,this)},onDisplayBtnBack:function(){game.team.setShowTeamTips(!game.team.isShowTeamTips)},onClickBuy:function(){game.app.show(game.AppConstant.TEAM_TOKEN_PANEL),this.hide()},onContinue:function(){switch(this.type){case game.TeamType.JOINTEAM_TYPE:game.team.onJoinTeamByTeamId(game.team.curInsId,game.team.curTeamId);break;case game.TeamType.CREATTEAM_TYPE:game.team.onCreateTeam();break;case game.TeamType.BEGIN_TEAMBOSS:game.team.beginTeamBoss()}this.hide()}})},{}],870:[function(e,t,i){"use strict";game.appModule.TeamTokenPanel=game.SkinUIPanel.extends({buyCount:0,ctor:function(e){this._super(e)},init:function(){var e=game.ccfg.LangCfg.getText(27002);this._skin.lab_desc.string=e,this.buyCount=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TEAM_BUYCARDNUM)},onShow:function(){this.updateRemainCount(),b8e.evt.onC(this._skin.btn_buy,this.onClickBuy,this),b8e.evt.addG(this,game.TeamEvent.BUY_TOKEN_SUCCESS,this.updateRemainCount)},onHide:function(){b8e.evt.offC(this._skin.btn_buy,this.onClickBuy,this),b8e.evt.rmvG(this,game.TeamEvent.BUY_TOKEN_SUCCESS,this.updateRemainCount)},updateRemainCount:function(){this._skin;var e=this.buyCount-game.team.teamModule.buyAwardNum,t=game.ccfg.CostCfg.getNextCost(game.SystemId.TEAM_CARD,game.team.teamModule.buyAwardNum);if(t){var i=game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO),n=0==e?game.html.Q_RED:game.html.GRAY_WHITE;this._skin.lab_remainCount.string=game.html.getText(n,e),n=i<t?game.html.Q_RED:game.html.Q_YELLOW,this._skin.lab_cost.string=game.html.getText(n,t)}else b8e.log("没有配置竞技场次数消耗表，或次数超出配置范围 兄弟")},onClickBuy:function(){game.team.onBuyCards()}})},{}],871:[function(e,t,i){"use strict";game.TeamSender={},game.TeamSender.rqAllTeamInfo=function(e){var t=game.pbmsg.AllTeamInfoRequest;t.insId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Team.AllTeamInfoRequest;b8e.sendN(i)},game.TeamSender.rqTeamCreate=function(e){var t=game.pbmsg.TeamCreateRequest;t.insId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Team.TeamCreateRequest;b8e.sendN(i)},game.TeamSender.rqTeamJoin=function(e,t){var i=game.pbmsg.TeamJoinRequest;i.insId=e,i.id=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Team.TeamJoinRequest;b8e.sendN(n)},game.TeamSender.rqTeamLeave=function(){var e=game.pbmid.Team.TeamLeaveRequest;b8e.sendN(e)},game.TeamSender.rqTeamKickMember=function(e){var t=game.pbmsg.TeamKickMemberRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Team.TeamKickMemberRequest;b8e.sendN(i)},game.TeamSender.rqTeamRecommend=function(){var e=game.pbmid.Team.TeamRecommendRequest;b8e.sendN(e)},game.TeamSender.rqTeamInvite=function(e){var t=game.pbmsg.TeamInviteRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Team.TeamInviteRequest;b8e.sendN(i)},game.TeamSender.rqTeamBossEnter=function(){var e=game.pbmid.Team.TeamBossEnterRequest;b8e.sendN(e)},game.TeamSender.rqTeamModule=function(){var e=game.pbmid.Team.TeamModuleRequest;b8e.sendN(e)},game.TeamSender.rqTeamBuyAwardNum=function(){var e=game.pbmid.Team.TeamBuyAwardNumRequest;b8e.sendN(e)},game.TeamSender.rqTeamCallPlayers=function(){var e=game.pbmid.Team.TeamCallPlayersRequest;b8e.sendN(e)}},{}],872:[function(e,t,i){"use strict";e("./cmd/TeamCmd"),e("./enum/TeamType"),e("./event/TeamEvent"),e("./manager/TeamMgr"),e("./panel/TeamPanelIndex"),e("./sender/TeamSender")},{"./cmd/TeamCmd":854,"./enum/TeamType":855,"./event/TeamEvent":856,"./manager/TeamMgr":857,"./panel/TeamPanelIndex":865,"./sender/TeamSender":871}],873:[function(e,t,i){"use strict";game.TianGongCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.TianGong.TianGongInfoResponse,this.onTGInfoRp,this),b8e.addNH(game.pbmid.TianGong.TianGongGuildRanksNotify,this.onTGGuildRanksNf,this),b8e.addNH(game.pbmid.TianGong.TianGongCollectResponse,this.onTGCollectRp,this),b8e.addNH(game.pbmid.TianGong.TianGongNoticeResponse,this.onTGNoticeRp,this),b8e.addNH(game.pbmid.TianGong.TianGongAwardResponse,this.onTGAwardRp,this),b8e.addNH(game.pbmid.TianGong.TianGongEnterResponse,this.onTGEnterRp,this),b8e.addNH(game.pbmid.TianGong.TianGongLeaveResponse,this.onTGLeaveRp,this),b8e.addNH(game.pbmid.TianGong.TianGongLastInfoResponse,this.onTGLastInfoRp,this),b8e.addNH(game.pbmid.TianGong.TianGongNotifyState,this.onTGNfState,this),b8e.addNH(game.pbmid.TianGong.TianGongNotifyScore,this.onTGNfScore,this),b8e.addNH(game.pbmid.TianGong.TianGongNotifyBattleInfo,this.onTGNfBattleInfo,this)},onTGInfoRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongInfoResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.synTianGongInfo(t)},onTGGuildRanksNf:function(e){var t=e.readProtobuf(game.pbmsg.TianGongGuildRanksNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.setTianGongRanks(t)},onTGCollectRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongCollectResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_COLLECT_FAIL)):b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_COLLECT_SUCCESS)},onTGNoticeRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongNoticeResponse);if(0<t.code)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code));else{game.notice.show("修改昭告成功");var i=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer);i&&(i.notice=game.tianGong.notice,i.noticeCount++,game.tianGong.notice=""),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_UPDATE_NOTICE)}},onTGAwardRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongAwardResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),game.tianGong.onSetAwardsState(!1)):game.tianGong.onSetAwardsState(!0)},onTGEnterRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongEnterResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_ENTER_FAIL)):game.tianGong.enterSuccess()},onTGLeaveRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongLeaveResponse);0<t.code?(game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_LEAVE_FAIL)):game.tianGong.leaveSuccess()},onTGLastInfoRp:function(e){var t=e.readProtobuf(game.pbmsg.TianGongLastInfoResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.synTianGongLastInfo(t)},onTGNfState:function(e){var t=e.readProtobuf(game.pbmsg.TianGongNotifyState);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.updateTianGongOpenState(t)},onTGNfScore:function(e){var t=e.readProtobuf(game.pbmsg.TianGongNotifyScore);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.updateSelfScore(t.score)},onTGNfBattleInfo:function(e){var t=e.readProtobuf(game.pbmsg.TianGongNotifyBattleInfo);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.tianGong.syncBattleInfo(t)}})},{}],874:[function(e,t,i){"use strict";e("./TianGongCmd")},{"./TianGongCmd":873}],875:[function(e,t,i){"use strict";game.TianGongEvt=b8e.Enum({TIAN_GONG_SYN_INFO:b8e.Event.nextCode(),TIAN_GONG_ENTER_SUCCESS:b8e.Event.nextCode(),TIAN_GONG_ENTER_FAIL:b8e.Event.nextCode(),TIAN_GONG_LEAVE_SUCCESS:b8e.Event.nextCode(),TIAN_GONG_LEAVE_FAIL:b8e.Event.nextCode(),TIAN_GONG_COLLECT_SUCCESS:b8e.Event.nextCode(),TIAN_GONG_COLLECT_FAIL:b8e.Event.nextCode(),TIAN_GONG_WORSHIP_SUCCESS:b8e.Event.nextCode(),TIAN_GONG_SAN_JIE_AWARDS_SUCCESS:b8e.Event.nextCode(),TIAN_GONG_WORSHIP_FAIL:b8e.Event.nextCode(),TIAN_GONG_UPDATE_SELF_GUILD_RANK:b8e.Event.nextCode(),TIAN_GONG_UPDATE_SELF_SCORE:b8e.Event.nextCode(),TIAN_GONG_UPDATE_GUILD_RANK:b8e.Event.nextCode(),TIAN_GONG_UPDATE_NOTICE:b8e.Event.nextCode(),TIAN_GONG_SYN_LAST_INFO:b8e.Event.nextCode(),TIAN_GONG_OPEN_STATE:b8e.Event.nextCode(),TIAN_GONG_UPDATE_ICON_STATE:b8e.Event.nextCode(),TIAN_GONG_SYNC_BATTLE_INFO:b8e.Event.nextCode()})},{}],876:[function(e,t,i){"use strict";e("./TianGongEvt")},{"./TianGongEvt":875}],877:[function(e,t,i){"use strict";game.TianGongMgr=b8e.Object.extends({name:"TianGongMgr",TIAN_GONG:1,CS_TIAN_GONG:2,_tgMap:null,_ranks:null,_selfGuildRank:null,_tianGongLastInfo:null,notice:"",selfScore:0,isInActive:!1,_tianGongBattleInfo:null,_positions:null,isOpening:!1,isWin:!1,occupyGuildName:null,isResetDaily:!1,_collectPosArr:null,_posDic:null,_collectX:0,_collectY:0,isCrossServer:!1,isLoging:!1,isClickAlertIcon:!1,ctor:function(){if(1==game.TianGongMgr._singleton)throw new Error("TianGongMgr 只能通过单例方法获取");this._super(),this._ranks=[],this._positions=[],this._posDic=[],this._tgMap=b8e.HashMap.get()},firstEnterScene:function(){game.guild.isHasGuild()&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(2e3).call(this.delayReq,this))},delayReq:function(){b8e.Tween.kill(this),game.funcOpen.checkOpen(game.FunctionType.GUILD)&&(this.isLoging=!0,game.shield.isShield(game.ShieldEnum.SAN_JIE)||game.TianGongSender.reqTianGongInfo(!0),game.TianGongSender.reqTianGongInfo())},resetData:function(){0!=this.selfScore&&(this.selfScore=0),this.isInActive&&(this.isInActive=!1),this._tianGongBattleInfo&&(this._tianGongBattleInfo=null)},synTianGongInfo:function(e){if(e){var t,i=e.crossServer?this.CS_TIAN_GONG:this.TIAN_GONG,n=this._tgMap.get(i);n||(n=new game.TianGongInfo),n.setData(e),t=n.isCrossServer?game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_DAILY_OPEN_TIME):game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_TIAN_GONG_DAILY_OPEN_TIME),n.nextOpenTime=n.nextOpenTime+t,n.csLastNextOpenTime=n.nextOpenTime,this._tgMap.set(i,n),e.master?b8e.log("天宫争霸数据： 是否是跨服crossServer："+e.crossServer+"，城主发布的公告notice："+e.notice+"，下次开启时间nextOpenTime："+b8e.TimeUtil.formatTimestamp(e.nextOpenTime)+"，是否有膜拜奖励award："+e.award+"，占领帮会id："+e.master.id+"，占领帮会名字name："+e.master.name+"，占领帮会帮主masterId："+e.master.masterId+"，占领帮会帮主名字masterName："+e.master.masterName+"，外形masterProtoid："+e.master.masterProtoid+"，装扮masterSurface："+e.master.masterSurface+"，翅膀masterWing："+e.master.masterWing):(b8e.log("天宫争霸数据： 是否是跨服crossServer："+e.crossServer),b8e.log("天宫争霸占领帮会数据data.master为空："+e.master)),this.isLoging||b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_SYN_INFO),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_UPDATE_ICON_STATE),!this.isLoging&&n.isCrossServer&&0<n.nextOpenTime?game.app.show(game.AppConstant.TIAN_GONG_PANEL,!0):this.isClickAlertIcon&&n.isCrossServer&&0<n.nextOpenTime&&(this.isClickAlertIcon=!1,game.app.show(game.AppConstant.TIAN_GONG_PANEL,!0))}else b8e.log("天宫争霸数据为空："+e)},setTianGongRanks:function(e){if(e){var t;if(0<this._ranks.length&&(this._ranks.length=0),e.ranks&&0<e.ranks.length){for(var i,n=0;n<e.ranks.length;n++)(i=e.ranks[n])&&((t=new game.TianGongRankInfo).setData(i),this._ranks.push(t));b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_UPDATE_GUILD_RANK)}e.guildRank&&(this._selfGuildRank||(this._selfGuildRank=new game.TianGongRankInfo),this._selfGuildRank.setData(e.guildRank),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_UPDATE_SELF_GUILD_RANK))}},synTianGongLastInfo:function(e){e&&(this._tianGongLastInfo||(this._tianGongLastInfo=new game.TianGongLastInfo),this._tianGongLastInfo.setData(e),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_SYN_LAST_INFO))},updateTianGongOpenState:function(e){if(game.funcOpen.checkOpen(game.FunctionType.GUILD)){var t=e.state,i=e.crossServer,n=e.crossServer?this.CS_TIAN_GONG:this.TIAN_GONG,s=this._tgMap.get(n);s&&(b8e.log(e.crossServer?"三界争霸开放通知：三界争霸没数据":"天宫争霸开放通知：天宫争霸没数据"),s.isOpen=e.state,s.isCrossServer=e.crossServer),this.isOpening=t,game.app.isShow(game.AppConstant.TIAN_GONG_PANEL)&&game.TianGongSender.reqTianGongInfo(i),t?game.app.show(game.AppConstant.TIAN_GONG_ENTER_ALERT,i):(game.app.isShow(game.AppConstant.TIAN_GONG_ENTER_ALERT)&&game.app.hide(game.AppConstant.TIAN_GONG_ENTER_ALERT),this.isWin=e.win,this.occupyGuildName=e.master,game.app.show(game.AppConstant.RESULT_PANEL),game.collect.hide(),b8e.Tween.kill(this),b8e.Tween.get(this).wait(2e3).call(this.delayIcon,this)),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_OPEN_STATE)}},delayIcon:function(){b8e.Tween.kill(this),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_OPEN_STATE)},updateSelfScore:function(e){var t=e;0!=this.selfScore&&(t=e-this.selfScore),this.selfScore=e,game.notice.show(game.ccfg.LangCfg.getText(11025),[t]),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_UPDATE_SELF_SCORE)},syncBattleInfo:function(e){if(e){switch(this._tianGongBattleInfo||(this._tianGongBattleInfo=new game.TianGongBattleInfo),this._tianGongBattleInfo.setData(e),this._tianGongBattleInfo.state){case 0:case 1:game.collect.hide()}b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_SYNC_BATTLE_INFO)}},enter:function(e){if(game.guild.isHasGuild()){var t=game.SceneMgr.inst().getSceneConfig();t?t.type!=game.SceneType.TIANGONG?game.TianGongSender.reqTianGongEnter(e):game.notice.show(game.ccfg.LangCfg.getText(11011)):game.notice.show(game.ccfg.LangCfg.getText(11010))}else game.notice.show(game.ccfg.LangCfg.getText(e?11033:11024))},enterSuccess:function(){game.app.isShow(game.AppConstant.TIAN_GONG_PANEL)&&game.app.hide(game.AppConstant.TIAN_GONG_PANEL),game.app.isShow(game.AppConstant.TIAN_GONG_ENTER_ALERT)&&game.app.hide(game.AppConstant.TIAN_GONG_ENTER_ALERT),game.app.isShow(game.AppConstant.GUILD_PANEL)&&game.app.hide(game.AppConstant.GUILD_PANEL);var e=0,t=this._tgMap.get(this.isCrossServer?this.CS_TIAN_GONG:this.TIAN_GONG);t&&(e=t.endTime),this.isCrossServer&&(game.mainGui.hideMainMenu(),game.mainGui.setStrengthenVisibel(!this.isCrossServer)),game.leaveDungeon.show(e,game.SceneType.TIANGONG),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_ENTER_SUCCESS)},leave:function(){game.TianGongSender.reqTianGongLeave()},leaveSuccess:function(){game.collect.hide(),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_LEAVE_SUCCESS)},worship:function(e){this.isHasWorshipAwards(e)?game.TianGongSender.reqTianGongAward(e):game.notice.show(game.ccfg.LangCfg.getText(11012))},onSetAwardsState:function(e){var t=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer);t&&(game.tianGong.isCrossServer?(e&&(t.crossServerAward=!1),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS)):e&&(t.isHasAward=!1),b8e.evt.dptG(game.TianGongEvt.TIAN_GONG_WORSHIP_SUCCESS))},reqShareAward:function(e){game.TianGongSender.reqTianGongAward(e,!0)},collect:function(){if(this._tgMap.get(this.isCrossServer?this.CS_TIAN_GONG:this.TIAN_GONG))if(0!=this._collectX&&0!=this._collectY)game.MoveToHelper.inst().moveTo({x:this._collectX,y:this._collectY},0,this._moveComplete,this);else{var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TIAN_GONG_COLLECT_POSITION);this._collectPosArr=e.split(";"),this._collectPosArr&&1<this._collectPosArr.length&&(this._collectX=Number(this._collectPosArr[0]),this._collectY=Number(this._collectPosArr[1]),game.MoveToHelper.inst().moveTo({x:this._collectX,y:this._collectY},0,this._moveComplete,this))}},_moveComplete:function(){game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().pause(!0),game.TianGongSender.reqTianGongCollect()},isHasOverLord:function(e){var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);return!!t&&!(!t.guildInfo||0==t.guildInfo.id)},isHasWorshipAwards:function(e){if(!this.isHasOverLord(e))return!1;var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);return!!t&&(t.isCrossServer?t.crossServerAward:t.isHasAward)},isOverlord:function(e){if(!this.isHasOverLord(e))return!1;var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);if(!t)return!1;if(!t.guildInfo)return!1;var i=game.mainRole.mainRoleData;return t.guildInfo.masterId==i.playerId},isFirstNotice:function(e){var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);return!!t&&!(0<t.noticeCount)},isCollector:function(){if(!this._tianGongBattleInfo)return!1;if(!this._tianGongBattleInfo.collector)return!1;var e=game.mainRole.mainRoleData;return this._tianGongBattleInfo.collector.roleId==e.playerId},moveToTarget:function(){game.MoveToHelper.inst().moveTo(this.getRandomPos(),0,this._clickMapMoveComplete,this)},_clickMapMoveComplete:function(){game.TrusteeshipMgr.inst().resume(!0)},getRandomPos:function(){if(this._positions&&0<this._positions.length)return this.getPos(this._positions);var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.TIAN_GONG_POS);return this._positions=e.split("|"),this._positions&&this._positions.length?this.getPos(this._positions):{x:3356,y:875}},getPos:function(e){var t=Math.random()*(e.length-1)>>0;if(this._posDic[t]){var i=this._posDic[t];return i?{x:i.x,y:i.y}:{x:3356,y:875}}if(e[t]){var n=e[t].split(";");return this._posDic[t]={x:Number(n[0]),y:Number(n[1])},{x:this._posDic[t].x,y:this._posDic[t].y}}return{x:3356,y:875}},_nextOpenTime:null,_timeStr:null,_lastState:null,getNextOpenTimeString:function(e){var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);if(!t)return"";var i=game.SysTime.curTime;if(t.nextOpenTime<i)return"";if(this._lastState==t.isCrossServer)return this._timeStr;this._lastState=t.isCrossServer,this._nextOpenTime=t.nextOpenTime;var n=b8e.TimeUtil._date;n.setTime(t.nextOpenTime);var s=n.getTime(),a=b8e.TimeUtil.getDayString(n.getDay()),o=b8e.TimeUtil.formatTimestamp(s,game.ccfg.LangCfg.getText(11006));return this._timeStr=game.ccfg.LangCfg.getText(o,[a]),this._timeStr},getRemainDay:function(e){var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);if(!t)return-1;var i=game.SysTime.curTime;if(t.nextOpenTime<i)return-1;var n=-1,s=e?game.GlobalEnum.CS_TIAN_GONG_OPEN_TIME:game.GlobalEnum.TIAN_GONG_OPEN_TIME,a=game.ccfg.GlobalParamCfg.getData(s);if(""==a)return-1;var o=a.split(":");if(!o||o.length<=0)return-1;var r=(0|o[0])*b8e.TimeUtil.HOUR_MICRO_SECONDS+(0|o[1])*b8e.TimeUtil.MINUTE_MICRO_SECONDS,h=t.nextOpenTime-r,g=h-b8e.TimeUtil.DAY_MICRO_SECONDS,l=g-b8e.TimeUtil.DAY_MICRO_SECONDS;b8e.TimeUtil.formatTimestamp(h),b8e.TimeUtil.formatTimestamp(g),b8e.TimeUtil.formatTimestamp(l);return l<=i&&i<g?n=2:g<=i&&i<h?n=1:h<=i&&(n=0),this.isResetDaily=!1,n},isOpened:function(e){var t=this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG);return!t&&(0!=t.lastNextOpenTime&&t.lastNextOpenTime!=t.nextOpenTime&&t.nextOpenTime>t.lastNextOpenTime)},isOpenServerThirdWeek:function(){var e=game.SysTime.curTime;return this.getOpenServerThirdWeekTm()<=e},getOpenServerThirdWeekTm:function(){var e=game.SysTime.curTime-game.mainRole.mainRoleData.miscData.openServerDay*b8e.TimeUtil.DAY_MICRO_SECONDS,t=b8e.TimeUtil.getDay(e),i=b8e.TimeUtil.getTodayTime(e,0),n=0;switch(t){case 0:n=1;break;default:n=7-t+1}return i+(n+7)*b8e.TimeUtil.DAY_MICRO_SECONDS},getTGInfoByIsCS:function(e){return this._tgMap.get(e?this.CS_TIAN_GONG:this.TIAN_GONG)},getTianGongLastInfo:function(){return this._tianGongLastInfo},getRanks:function(){return this._ranks},getSelfGuildRank:function(){return this._selfGuildRank},getTianGongBattleInfo:function(){return this._tianGongBattleInfo},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.TIAN_GONG_WORSHIPALERT,null,this.tiangGongWorshiplert,this),game.spotAlert.addSpotAlert(game.SpotAlertTargetType.CS_TIAN_GONG_WORSHIPALERT,null,this.csTiangGongWorshiplert,this)},tiangGongWorshiplert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!this.isHasWorshipAwards(!1))},csTiangGongWorshiplert:function(){return!(!game.funcOpen.checkOpen(game.FunctionType.GUILD)||!this.isHasWorshipAwards(!0))}}),game.TianGongMgr._instance=null,game.TianGongMgr._singleton=!0,game.TianGongMgr.inst=function(){return game.TianGongMgr._instance||(game.TianGongMgr._singleton=!1,game.TianGongMgr._instance=new game.TianGongMgr,game.TianGongMgr._singleton=!0),game.TianGongMgr._instance}},{}],878:[function(e,t,i){"use strict";e("./TianGongMgr")},{"./TianGongMgr":877}],879:[function(e,t,i){"use strict";game.appModule.ResultPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this.showInfo(),b8e.evt.onC(this._skin.sure_btn,this.onSureBtnClick,this)},onHide:function(){b8e.evt.offC(this._skin.sure_btn,this.onSureBtnClick,this)},showInfo:function(){this._skin.winEffect.active=game.tianGong.isWin,this._skin.img_result_sucess.active=game.tianGong.isWin,this._skin.img_result_failure.active=!game.tianGong.isWin,game.tianGong.isWin?this._skin.lab_title.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11034:11026):this._skin.lab_title.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11035:11027),this._skin.lab_content.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11038:11037),""==game.tianGong.occupyGuildName?this._skin.lab_name.string=game.ccfg.LangCfg.getText(11028):this._skin.lab_name.string=game.tianGong.occupyGuildName},onSureBtnClick:function(){this.hide()}})},{}],880:[function(e,t,i){"use strict";game.appModule.TianGongEditorPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){this.updateInfo(),b8e.evt.onC(this._skin.btn_cancel,this.onHidePanel,this),b8e.evt.onC(this._skin.btn_confirm,this.onSender,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_NOTICE,this.updateInfo)},onHide:function(){b8e.evt.offC(this._skin.btn_cancel,this.onHidePanel,this),b8e.evt.offC(this._skin.btn_confirm,this.onSender,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_NOTICE,this.updateInfo)},onHidePanel:function(){this.hide()},updateInfo:function(){if(game.tianGong.isFirstNotice(game.tianGong.isCrossServer))this._skin.lab_first.active=!0,this._skin.lab_cost.node.active=!1;else{this._skin.lab_first.active=!1,this._skin.lab_cost.node.active=!0;var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NOTICE_ID),t=0,i=game.back.getAmountInfo();i&&(t=i.getValue(game.AmountType.YUAN_BAO));var n=e<=t?game.html.Q_GREEN:game.html.Q_RED;this._skin.lab_cost.node.color=b8e.ColorUtil.toCCColor(n),this._skin.lab_cost.string=e}},onSender:function(){if(game.tianGong.isFirstNotice(game.tianGong.isCrossServer)){if(b8e.SensitiveWords.match(this._skin.editbox.string))return void b8e.Toast.launch("含有敏感词！");this.noticeSender()}else{var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TIAN_GONG_NOTICE_ID);game.upgrade.costCheckMoney(game.AmountType.YUAN_BAO,e,!0,!0)&&this.noticeSender()}},noticeSender:function(){var e;""!=(e=b8e.SensitiveWords.filter(this._skin.editbox.string,"*"))?(game.tianGong.notice=e,game.TianGongSender.reqTianGongNotice(e,game.tianGong.isCrossServer),this.hide()):game.notice.show(game.ccfg.LangCfg.getText(11001))}})},{}],881:[function(e,t,i){"use strict";game.appModule.TianGongEnterAlert=game.SkinUIPanel.extends({_isCrossServer:!1,ctor:function(e){this._super(e)},onShow:function(){this._isCrossServer=!!this.data&&this.data,this._skin.icon.active=!this._isCrossServer,this._skin.sjzb_icon.active=this._isCrossServer,this._skin.title.string=this._isCrossServer?"三界争霸":"天宫争霸",b8e.evt.onC(this._skin.btn_enter,this.onEnter,this)},onHide:function(){b8e.evt.offC(this._skin.btn_enter,this.onEnter,this)},onEnter:function(){this._isCrossServer?(game.tianGong.isClickAlertIcon=!0,game.TianGongSender.reqTianGongInfo(!0)):game.app.show(game.AppConstant.TIAN_GONG_PANEL,this._isCrossServer),this.hide()}})},{}],882:[function(e,t,i){"use strict";game.TianGongGuildRankPanel=game.SkinUI.extends({ctor:function(){this._super("tiangong/TianGongGuildRankSkin","TianGongGuildRankSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.TianGongRankItem)},onShow:function(){this._list.show(),this.onSyncInfo(),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SYN_LAST_INFO,this.onSyncInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SYN_LAST_INFO,this.onSyncInfo)},onSyncInfo:function(){var e=game.tianGong.getTianGongLastInfo();if(!e)return this._skin.lab_tip.node.active=!0,this._skin.lab_Node.active=!1,void(this._skin.lab_guildName.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11030:11003));e.guildInfo?this._skin.lab_guildName.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11031:11004,[e.guildInfo.name]):this._skin.lab_guildName.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11032:11005),this._list.setData(e.guildRanks),e.guildRanks&&0<e.guildRanks.length?(this._skin.lab_Node.active=!0,this._skin.lab_tip.node.active=!1):(this._skin.lab_Node.active=!1,this._skin.lab_tip.node.active=!0)}})},{}],883:[function(e,t,i){"use strict";game.TianGongIndividualRankPanel=game.SkinUI.extends({ctor:function(){this._super("tiangong/TianGongIndividualRankSkin","TianGongIndividualRankSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.TianGongRankItem)},onShow:function(){this._list.show(),this.onSyncInfo(),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SYN_LAST_INFO,this.onSyncInfo)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SYN_LAST_INFO,this.onSyncInfo)},onSyncInfo:function(){var e=game.tianGong.getTianGongLastInfo();if(!e)return this._skin.lab_tip.node.active=!0,void(this._skin.lab_Node.active=!1);this._list.setData(e.playerRanks),e.playerRanks&&0<e.playerRanks.length?(this._skin.lab_Node.active=!0,this._skin.lab_tip.node.active=!1):(this._skin.lab_Node.active=!1,this._skin.lab_tip.node.active=!0)}})},{}],884:[function(e,t,i){"use strict";game.appModule.TianGongLastRankPanel=game.SkinUIPanel.extends({_tabIndex:-1,_tianGongGuildRankPanel:null,_tianGongIndividualRankPanel:null,ctor:function(e){this._super(e)},onShow:function(){-1==this._tabIndex&&(this._tabIndex=0),this._tianGongGuildRankPanel||(this._tianGongGuildRankPanel=new game.TianGongGuildRankPanel,this._tianGongGuildRankPanel.addToParent(this._skin.panelNode)),this._tianGongIndividualRankPanel||(this._tianGongIndividualRankPanel=new game.TianGongIndividualRankPanel,this._tianGongIndividualRankPanel.addToParent(this._skin.panelNode)),this.onSelectPanelByIndex(this._tabIndex),this._skin.toggleBtn_node[this._tabIndex].check(),game.TianGongSender.reqTianGongLastInfo(game.tianGong.isCrossServer),b8e.evt.onC(this._skin.toggleBtn_node[0].node,this.onSelectGuildPanel,this),b8e.evt.onC(this._skin.toggleBtn_node[1].node,this.onSelectIndividualRankPanel,this)},onHide:function(){b8e.evt.offC(this._skin.toggleBtn_node[0].node,this.onSelectGuildPanel,this),b8e.evt.offC(this._skin.toggleBtn_node[1].node,this.onSelectIndividualRankPanel,this)},onSelectGuildPanel:function(){0!=this._tabIndex&&this.onSelectPanelByIndex(0)},onSelectIndividualRankPanel:function(){1!=this._tabIndex&&this.onSelectPanelByIndex(1)},onSelectPanelByIndex:function(e){switch(this._tabIndex=e,this._tabIndex){case 0:this._tianGongGuildRankPanel.show(),this._tianGongIndividualRankPanel.hide();break;case 1:this._tianGongGuildRankPanel.hide(),this._tianGongIndividualRankPanel.show()}}})},{}],885:[function(e,t,i){"use strict";game.appModule.TianGongPanel=game.SkinUIPanel.extends({_info:null,_animModel:null,_animWingModel:null,_timerObj:null,_nickNameAnim:null,_anim:null,_isCrossServer:!1,_prizeList:null,_prizeInfo:null,_bgImg:null,ctor:function(e){this._super(e)},onShow:function(){game.tianGong.isLoging=!1,this.clearAnimator(),this.data?(game.tianGong.isCrossServer=this.data,this._skin.title.string="三界争霸"):(this._skin.title.string="天宫争霸",game.tianGong.isCrossServer=!1),this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.setAnchor(.5,.5),this._bgImg.addToParent(this._skin.bgImg)),this._skin.lab_guildName.node.active=!1,this._skin.lab_name.node.active=!1,this._skin.nickNameSp.active=!0,this._skin.btn_mobai.active=!1,this._skin.btn_edit.active=!1,this._skin.lab_openTime.string="",game.tianGong.isCrossServer?this._bgImg.loadTexture(game.ClientCfg.csTianGongBgUrl,null,null,{useManifest:!1}):this._bgImg.loadTexture(game.ClientCfg.tianGongBgUrl,null,null,{useManifest:!1}),this._skin.lab_notice.string=game.ccfg.LangCfg.getText(11008),game.TianGongSender.reqTianGongInfo(game.tianGong.isCrossServer),this.updatePrizeInfo(),b8e.evt.onC(this._skin.btn_mobai,this.onOpenWorshipPanel,this),b8e.evt.onC(this._skin.btn_sjjl,this.onOpenSJPanel,this),b8e.evt.onC(this._skin.btn_edit,this.onOpenEditorPanel,this),b8e.evt.onC(this._skin.lab_lastSituation,this.onOpenLastRankPanel,this),b8e.evt.onC(this._skin.lab_rules,this.onOpenRulesPanel,this),b8e.evt.onC(this._skin.btn_tg,this.onTravelToTianGong,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SYN_INFO,this.onSyncInfo),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_UPDATE_NOTICE,this.updateNotice),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_WORSHIP_SUCCESS,this.updateMoBai),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateSanJieAwards),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),this.onSpotAlertChange()},clearAnimator:function(){this._animModel&&this._animModel.clear(),this._animWingModel&&this._animWingModel.clear(),this._nickNameAnim&&this._nickNameAnim.clear()},onHide:function(){this._timerObj&&(b8e.Timer.remove(this,this.updateEndTime),this._timerObj=null),this.clearNickNameAnimator(),this.clearEffect(),b8e.evt.offC(this._skin.btn_mobai,this.onOpenWorshipPanel,this),b8e.evt.offC(this._skin.btn_sjjl,this.onOpenSJPanel,this),b8e.evt.offC(this._skin.btn_edit,this.onOpenEditorPanel,this),b8e.evt.offC(this._skin.lab_lastSituation,this.onOpenLastRankPanel,this),b8e.evt.offC(this._skin.lab_rules,this.onOpenRulesPanel,this),b8e.evt.offC(this._skin.btn_tg,this.onTravelToTianGong,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SYN_INFO,this.onSyncInfo),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_UPDATE_NOTICE,this.updateNotice),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_WORSHIP_SUCCESS,this.updateMoBai),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateSanJieAwards),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onSpotAlertChange:function(){game.tianGong.isCrossServer?this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.CS_TIAN_GONG_WORSHIPALERT):this._skin.img_redPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.TIAN_GONG_WORSHIPALERT)},updatePrizeInfo:function(){var e;this._prizeList||(this._prizeList=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prizeNode),this._prizeList.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),e=game.tianGong.isCrossServer?game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_OVERLORD_AWARDS_ID):game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.OVERLORD_AWARDS_ID),this._prizeInfo.setupById(e),this._prizeList.setData(this._prizeInfo)},onSyncInfo:function(){this._info=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer),this._info&&(this._info.isOpen?b8e.ShaderUtil.reset(this._skin.btn_tg):b8e.ShaderUtil.setGray(this._skin.btn_tg),this.updateRoleInfo(),this.updateMoBai(),this._skin.btn_sjjl.active=!1,this._skin.img_rewardsj.active=!1,this._skin.img_redPointsj.active=!1,this.updateNotice(),this.updateState(),this.showNickNameModel(game.ccfg.NickNameCfg.getResById(game.tianGong.isCrossServer?2001:1012)))},updateMoBai:function(){this._skin.btn_mobai.active=game.tianGong.isHasOverLord(game.tianGong.isCrossServer),game.tianGong.isCrossServer?(this._skin.img_reward.active=!(!game.tianGong.isHasOverLord(game.tianGong.isCrossServer)||this._info.crossServerAward),game.tianGong.isHasOverLord(game.tianGong.isCrossServer)&&!this._info.crossServerAward?b8e.ShaderUtil.setGray(this._skin.btn_mobai):b8e.ShaderUtil.reset(this._skin.btn_mobai)):(this._skin.img_reward.active=!(!game.tianGong.isHasOverLord(game.tianGong.isCrossServer)||this._info.isHasAward),game.tianGong.isHasOverLord(game.tianGong.isCrossServer)&&!this._info.isHasAward?b8e.ShaderUtil.setGray(this._skin.btn_mobai):b8e.ShaderUtil.reset(this._skin.btn_mobai))},updateSanJieAwards:function(){this._skin.btn_sjjl.active=0<=this._info.crossServerRank,this._skin.img_rewardsj.active=!this._info.crossServerRankAward},updateState:function(){this._info.isOpen?(this._timerObj||(this._timerObj=b8e.Timer.add(this,this.updateEndTime,1e3)),this._timerObj.start(),this.playEffect("10019")):(this._skin.lab_openTime.string=game.tianGong.getNextOpenTimeString(this._info.isCrossServer),this.clearEffect())},updateEndTime:function(){var e=game.SysTime.curTime;(this._info.endTime-e)/1e3<0?(b8e.Timer.remove(this,this.updateEndTime),this._timerObj=null,this._skin.lab_openTime.string=game.ccfg.LangCfg.getText(11006)):this._skin.lab_openTime.string=game.ccfg.LangCfg.getText(11007,[b8e.TimeUtil.formatTime(this._info.endTime-e)])},updateNotice:function(){this._skin.btn_edit.active=game.tianGong.isOverlord(game.tianGong.isCrossServer),""!=this._info.notice?this._skin.lab_notice.string=b8e.SensitiveWords.filter(this._info.notice,"*"):this._skin.lab_notice.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11029:11008)},updateRoleInfo:function(){var e=game.tianGong.isHasOverLord(game.tianGong.isCrossServer);this._skin.nickNameSp.active=!0,this._skin.img_xw.active=!e,this._skin.lab_xw.active=!e,this._skin.lab_guildName.node.active=e,(this._skin.lab_name.node.active=e)&&this._info.guildInfo&&(this.showModel(this._info.guildInfo.protoId,this._info.guildInfo.surface),this.showWing(this._info.guildInfo.wing),this._skin.lab_guildName.string=this._info.guildInfo.name,this._skin.lab_name.string=this._info.guildInfo.masterName)},showNickNameModel:function(e){this._nickNameAnim||(this._nickNameAnim=b8e.Animator.get(game.AnimatorType.TIAN_GONGBA_ZHU_EFFECT,1),this._nickNameAnim.addToParent(this._skin.nickNameSp));var t=game.ClientCfg.getUIFxs(e);t?(this._nickNameAnim.load(t),this._nickNameAnim.play()):this._nickNameAnim&&this._nickNameAnim.clear()},clearNickNameAnimator:function(){this._nickNameAnim&&this._nickNameAnim.clear()},showModel:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(0!=e){var i,n;if(this._animModel||(this._animModel=b8e.Animator.get(game.AnimatorType.BODY,1),this._animModel.addToParent(this._skin.node_model)),0<t){var s=game.ccfg.SurfaceCfg.getDataById(t);s?(i=s.res,n=game.ClientCfg.getAvatarAnim(game.RoleType.UIRole,i)):(i=game.ccfg.HeroCfg.getResIdById(e),n=game.ClientCfg.getUiUnits(i))}else i=game.ccfg.HeroCfg.getResIdById(e),n=game.ClientCfg.getUiUnits(i);n?(this._animModel.load(n),this._animModel.play(),this._animModel.setScale(.95,.95)):this._animModel&&this._animModel.clear()}},showWing:function(e){if(!(e<=0)){this._animWingModel||(this._animWingModel=b8e.Animator.get(game.AnimatorType.WING,1),this._animWingModel.addToParent(this._skin.node_wing));var t=game.ccfg.WingCfg.getDataById(e);if(t){var i=game.ClientCfg.getWing(t.res);i?(this._animWingModel.load(i),this._animWingModel.play(),this._animWingModel.setScale(1.5,1.5)):this._animWingModel&&this._animWingModel.clear()}}},playEffect:function(e){var t=game.ClientCfg.getUIFxs(e);t?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.TIAN_GONG_TRACK_BAR_EFFECT,1),this._anim.addToParent(this._skin.effect)),this._anim.load(t),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.clear()},onOpenWorshipPanel:function(){this._info&&game.app.show(game.AppConstant.TIAN_GONG_WORSHIP_PANEL)},onOpenSJPanel:function(){this._info&&game.app.show(game.AppConstant.TIAN_GONG_SAN_JIE_AWARDS_PANEL)},onOpenEditorPanel:function(){game.app.show(game.AppConstant.TIAN_GONG_EDITOR_PANEL)},onOpenLastRankPanel:function(){game.app.show(game.AppConstant.TIAN_GONG_LAST_RANK_PANEL)},onOpenRulesPanel:function(){game.app.show(game.AppConstant.TIANGONG_RULE_DESC_PANEL)},onTravelToTianGong:function(){this._info&&(this._info.isOpen?game.tianGong.enter(this._info.isCrossServer):(this._info.isCrossServer,game.notice.show(game.ccfg.LangCfg.getText(11009))))}})},{}],886:[function(e,t,i){"use strict";game.TianGongRankItem=game.SkinUI.extends({_rankData:null,_bianshenShowList:null,ctor:function(){this._super("tiangong/TianGongRankItemSkin","TianGongRankItemSkin")},getWidth:function(){return 540},getHeight:function(){return 130},onShow:function(){this.setData(this._rankData),b8e.evt.onC(this._skin.lab_name.node,this.onShowMenu,this)},onHide:function(){b8e.evt.offC(this._skin.lab_name.node,this.onShowMenu,this)},setData:function(e){if(this._rankData=e,this._skin&&this._rankData){switch(this._rankData.rank){case 1:this._skin.rank_one.active=!0,this._skin.rank_two.active=!1,this._skin.rank_three.active=!1,this._skin.lab_rank.node.active=!1;break;case 2:this._skin.rank_one.active=!1,this._skin.rank_two.active=!0,this._skin.rank_three.active=!1,this._skin.lab_rank.node.active=!1;break;case 3:this._skin.rank_one.active=!1,this._skin.rank_two.active=!1,this._skin.rank_three.active=!0,this._skin.lab_rank.node.active=!1;break;default:this._skin.lab_rank.node.active=!0,this._skin.lab_rank.string=this._rankData.rank}game.tianGong.isCrossServer?(this._skin.lab_name.string=this._rankData.name1+".s"+this._rankData.zone,this._skin.guildName.string=this._rankData.name1+".s"+this._rankData.zone):(this._skin.lab_name.string=this._rankData.name1,this._skin.guildName.string=this._rankData.name1),this._skin.lab_guildName.string=this._rankData.name2,this._skin.lab_jf.string=this._rankData.score;var t=game.mainRole.mainRoleData;switch(this._rankData.type){case 1:this._skin.line.active=!1,this._skin.lab_name.node.active=!1,this._skin.lab_guildName.node.active=!0,this._skin.guildName.node.active=!0,this._rankData.guildId==t.guildId?this._skin.img_select_wfg.active=!0:this._skin.img_select_wfg.active=!1,this._skin.img_select.active=this._rankData.rank%2==0;break;case 2:this._skin.lab_guildName.node.active=!1,this._skin.guildName.node.active=!1,this._skin.lab_name.node.active=!0,this._skin.line.active=!game.tianGong.isCrossServer,this._skin.line.width=this._skin.lab_name.node.width+5,this._rankData.playerId==t.playerId?this._skin.img_select_wfg.active=!0:this._skin.img_select_wfg.active=!1,this._skin.img_select.active=this._rankData.rank%2!=0;break;default:this._skin.img_select.active=this._rankData.rank%2!=0}this._bianshenShowList||(this._bianshenShowList=new game.BianShenShowList,this._bianshenShowList.addToParent(this._skin.bianshen_node)),this._rankData.bianshens&&this._bianshenShowList.setData(this._rankData.bianshens)}},onShowMenu:function(e){if(!game.tianGong.isCrossServer&&this._rankData&&1!=this._rankData.type){var t=game.mainRole.mainRoleData;if(this._rankData.playerId!=t.playerId){var i=new game.MenuData;i.roleId=this._rankData.playerId,i.roleName=this._rankData.name1,game.relation.isFriend(i.roleId)?game.menu.show(this,e,game.MenuList.COMMON_FRIEND_MASTER_MENU,i):game.menu.show(this,e,game.MenuList.COMMON_NORMAL_MASTER_MENU,i)}}}})},{}],887:[function(e,t,i){"use strict";game.appModule.TianGongSanJieAwardsPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},init:function(){if(this._info=game.tianGong.getTGInfoByIsCS(!0),this._info){var e=game.ccfg.CSTianGongGuildAwardCfg.getDataById(this._info.crossServerRank);if(e){var t=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80);t.addToParent(this._skin.bz_prize),t.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID;var i=new game.PrizeInfo;i.setupById(e.dropId0),t.setData(i);var n=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80);n.addToParent(this._skin.other_prize),n.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID;var s=new game.PrizeInfo;s.setupById(e.dropId1),n.setData(s);var a=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80);a.addToParent(this._skin.prize3),a.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID;var o=new game.PrizeInfo;o.setupById(e.dropId2),a.setData(o)}}},onShow:function(){this.updateState(),b8e.evt.onC(this._skin.btn_mb,this.worship,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateState)},onHide:function(){b8e.evt.offC(this._skin.btn_mb,this.worship,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateState)},updateState:function(){this._info&&(this._info.crossServerRankAward?b8e.ShaderUtil.reset(this._skin.btn_mb):b8e.ShaderUtil.setGray(this._skin.btn_mb))},worship:function(){game.tianGong.reqShareAward(this._info.isCrossServer)}})},{}],888:[function(e,t,i){"use strict";game.appModule.TianGongWorshipPanel=game.SkinUIPanel.extends({_prizeList1:null,_prizeList2:null,_prizeInfo1:null,_prizeInfo2:null,ctor:function(e){this._super(e)},onShow:function(){var e,t;this._prizeList1||(this._prizeList1=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList1.addToParent(this._skin.bz_prize),this._prizeList1.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID,this._prizeInfo1=new game.PrizeInfo),this._prizeList2||(this._prizeList2=new game.PrizeList(6,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList2.addToParent(this._skin.other_prize),this._prizeList2.containerId=game.ContainerId.TIAN_GONG_OVERLORD_CONTAINER_ID,this._prizeInfo2=new game.PrizeInfo),this._skin.labdesc1.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11048:11047),this._skin.labdesc2.string=game.ccfg.LangCfg.getText(game.tianGong.isCrossServer?11050:11049),game.tianGong.isCrossServer?(e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_OVERLORD_GUILD_MEMBER_AWARDS_ID),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.CS_OTHER_GUILD_MEMBER_AWARDS_ID)):(e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.OVERLORD_GUILD_MEMBER_AWARDS_ID),t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.OTHER_GUILD_MEMBER_AWARDS_ID)),this._prizeInfo1.setupById(e),this._prizeList1.setData(this._prizeInfo1),this._prizeInfo2.setupById(t),this._prizeList2.setData(this._prizeInfo2),this.updateState(),b8e.evt.onC(this._skin.btn_mb,this.worship,this),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_WORSHIP_SUCCESS,this.updateState),b8e.evt.addG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateState)},onHide:function(){b8e.evt.offC(this._skin.btn_mb,this.worship,this),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_WORSHIP_SUCCESS,this.updateState),b8e.evt.rmvG(this,game.TianGongEvt.TIAN_GONG_SAN_JIE_AWARDS_SUCCESS,this.updateState)},_tianGongInfo:null,updateState:function(){this._tianGongInfo=game.tianGong.getTGInfoByIsCS(game.tianGong.isCrossServer),this._tianGongInfo&&(game.tianGong.isCrossServer?this._tianGongInfo.crossServerAward?b8e.ShaderUtil.reset(this._skin.btn_mb):b8e.ShaderUtil.setGray(this._skin.btn_mb):this._tianGongInfo.isHasAward?b8e.ShaderUtil.reset(this._skin.btn_mb):b8e.ShaderUtil.setGray(this._skin.btn_mb))},worship:function(){this._tianGongInfo&&game.tianGong.worship(this._tianGongInfo.isCrossServer)}})},{}],889:[function(e,t,i){"use strict";e("./TianGongRankItem"),e("./TianGongGuildRankPanel"),e("./TianGongIndividualRankPanel"),e("./TianGongEditorPanel"),e("./TianGongLastRankPanel"),e("./TianGongPanel"),e("./TianGongWorshipPanel"),e("./TianGongEnterAlert"),e("./ResultPanel")},{"./ResultPanel":879,"./TianGongEditorPanel":880,"./TianGongEnterAlert":881,"./TianGongGuildRankPanel":882,"./TianGongIndividualRankPanel":883,"./TianGongLastRankPanel":884,"./TianGongPanel":885,"./TianGongRankItem":886,"./TianGongWorshipPanel":888}],890:[function(e,t,i){"use strict";var n=game.TianGongSender=function(){};n.reqTianGongInfo=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=game.pbmsg.TianGongInfoRequest;t.crossServer=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.TianGong.TianGongInfoRequest;b8e.sendN(i)},n.reqTianGongEnter=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=game.pbmsg.TianGongEnterRequest;t.crossServer=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.TianGong.TianGongEnterRequest;b8e.sendN(i)},n.reqTianGongLeave=function(){var e=game.pbmid.TianGong.TianGongLeaveRequest;b8e.sendN(e)},n.reqTianGongCollect=function(){var e=game.pbmid.TianGong.TianGongCollectRequest;b8e.sendN(e)},n.reqTianGongNotice=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.pbmsg.TianGongNoticeRequest;i.notice=e,i.crossServer=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.TianGong.TianGongNoticeRequest;b8e.sendN(n)},n.reqTianGongAward=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.pbmsg.TianGongAwardRequest;i.crossServer=e,i.share=t,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.TianGong.TianGongAwardRequest;b8e.sendN(n)},n.reqTianGongLastInfo=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=game.pbmsg.TianGongLastInfoRequest;t.crossServer=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.TianGong.TianGongLastInfoRequest;b8e.sendN(i)}},{}],891:[function(e,t,i){"use strict";e("./TianGongSender")},{"./TianGongSender":890}],892:[function(e,t,i){"use strict";e("./panel/tiangongPanelIndex_0"),e("./event/tiangongEventIndex_0"),e("./sender/TianGongSender"),e("./cmdlistener/tiangongCmdlistenerIndex_0"),e("./manager/tiangongMgrIndex_0")},{"./cmdlistener/tiangongCmdlistenerIndex_0":874,"./event/tiangongEventIndex_0":876,"./manager/tiangongMgrIndex_0":878,"./panel/tiangongPanelIndex_0":889,"./sender/TianGongSender":890}],893:[function(e,t,i){"use strict";game.appModule.AwardTipsPanel=game.SkinUIPanel.extends({_prizeInfo:null,_prizeList:null,dropId:0,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_95,game.IcoSizeEnum.SIZE_95,game.IconScale.PERCENT_80,6,!0),this._prizeList.addToParent(this._skin.prize)},onShow:function(){this.data&&(this.dropId=this.data),this._prizeInfo.setupById(this.dropId),this._prizeList.setData(this._prizeInfo);var e=this._prizeInfo.getPrizeList();if(e&&!(e.length<=0)){var t=Math.round(e.length/3),i=game.IcoSizeEnum.SIZE_95*t+10*(t-1)+40;this._skin.content_bg.higth=i<150?150:i,this._skin.bg.node.higth=this._skin.content_bg.higth+70}},onHide:function(){}})},{}],894:[function(e,t,i){"use strict";game.appModule.EquipSuitsTips=game.SkinUIPanel.extends({_type:0,_isHasEquip:!1,_color:0,ctor:function(e){this._super(e)},onShow:function(){if(null!=this.data)switch(this.clearData(),this._type=this.data,this._type){case game.equip.QUALITY_SUITS:this._skin.lab_title.string="装备品质套装",this.updateEquipSuitsInfo(this._type);break;case game.equip.STAR_SUITS:this._skin.lab_title.string="部位星级套装",this.updateEquipSuitsInfo(this._type)}},onHide:function(){},updateEquipSuitsInfo:function(e){var t,i,n,s,a,o,r,h,g;switch(e){case game.equip.QUALITY_SUITS:(a=game.equip.getCurEquipQualitySuits())?(t=a.level,i=a.quality,n=game.ccfg.EquipQualitySuitsCfg.getSuitsInfoByLevelAndQuality(t,i),o=t+"级"+game.html.getQNameByQuality(i)+"套装",game.equip.isMaxEquipQualitySuits()?(h=!(g=r=!0),this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h)):game.equip.isActiveEquipQualitySuits()?(h=r=!0,s=game.equip.getNextEquipQualitySuits(),this.onUpdateCurEquipSuitsInfo(n,r,o),this.onUpdateNextEquipSuitsInfo(e,s.level,s.quality,s.suitsSpriteStat),this.updateEquipSuitsCount(e,s.level,s.quality,g,h)):(h=r=!1,this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h))):(t=game.ccfg.EquipQualitySuitsCfg.getFirstLevel(),i=game.ccfg.EquipQualitySuitsCfg.getFirstQuality(),n=game.ccfg.EquipQualitySuitsCfg.getSuitsInfoByLevelAndQuality(t,i),o=t+"级"+game.html.getQNameByQuality(i)+"套装",g=h=r=!1,this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h));break;case game.equip.STAR_SUITS:(a=game.equip.getCorrEquipStarSuits())?(t=a.level,i=a.star,n=game.ccfg.EquipStarSuitsCfg.getSuitsInfoByLevelAndStar(t,i),o=t+"级"+i+"星套装",game.equip.isMaxEquipStarSuits()?(h=!(g=r=!0),this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h)):game.equip.isActiveEquipStarSuits()?(h=r=!0,s=game.equip.getNextEquipStarSuits(),this.onUpdateCurEquipSuitsInfo(n,r,o),this.onUpdateNextEquipSuitsInfo(e,s.level,s.star,s.suitsSpriteStat),this.updateEquipSuitsCount(e,s.level,s.star,g,h)):(h=r=!1,this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h))):(t=game.ccfg.EquipStarSuitsCfg.getFirstLevel(),i=game.ccfg.EquipStarSuitsCfg.getFirstStar(),n=game.ccfg.EquipStarSuitsCfg.getSuitsInfoByLevelAndStar(t,i),o=t+"级"+i+"星套装",g=h=r=!1,this.onUpdateCurEquipSuitsInfo(n,r,o),this.updateEquipSuitsCount(e,t,i,g,h))}this.layoutTips(e,r,g,h)},onUpdateCurEquipSuitsInfo:function(e,t,i){if(e){var n=e.suitsSpriteStat;if(n){var s,a=this.getSpriteStatStr(n);t?(s="当前激活："+i,a=game.html.getText(game.html.Q_YELLOW,a)):(s=game.html.getText(game.html.GRAY,"未激活："+i),a=game.html.getText(game.html.GRAY,a)),this._skin.lab_title1.string=s,this._skin.lab_curState.string=a}}},onUpdateNextEquipSuitsInfo:function(e,t,i,n){var s="";switch(e){case game.equip.QUALITY_SUITS:s="下一级品质："+(t+"级"+game.html.getQNameByQuality(i)+"套装");break;case game.equip.STAR_SUITS:s="下一级星级："+(t+"级"+i+"星套装")}if(n){var a=this.getSpriteStatStr(n);this._skin.lab_title2.string=game.html.getText(game.html.GRAY,s),this._skin.lab_nextState.string=game.html.getText(game.html.GRAY,a)}},getSpriteStatStr:function(e){if(!e)return"";var t=e.getSpriteStats();if(!t||t.length<=0)return"";for(var i="",n="",s=0,a=0;a<t.length;a++){var o=t[a];if(o){var r=game.ccfg.AttrRulesCfg.getAttrNameByType(o.type);n=a!=t.length-1?"\n":"";var h=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(o.type);if(h)switch(h.format){case game.AttrRulesFormat.FORMAT_1:s=o.value;break;case game.AttrRulesFormat.FORMAT_2:s=game.ValueUtil.getDigitsValueByNum(o.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:s=game.ValueUtil.getDigitsValueByNum(o.value/100,2)}i+=r+" +"+s+n}}return i},updateEquipSuitsCount:function(e,t,i,n,s){var a,o="",r=game.equip.maxEquipSlotCount;switch(e){case game.equip.QUALITY_SUITS:n?o="已达到最高级套装":(a=s?game.equip.getNextActiveEquipQualitySuits():game.equip.getCurActiveEquipQualitySuits(),o="激活需穿戴8件"+t+"级及以上"+game.equip.getQualityNameByQuality(i)+"："+game.html.getText(game.html.Q_GREEN,a+"/"+r));break;case game.equip.STAR_SUITS:n?o="已达到最高级套装":(a=s?game.equip.getNextActiveEquipStarSuits():game.equip.getCurActiveEquipStarSuits(),o="激活需穿戴8件"+t+"级及以上"+i+"星装备："+game.html.getText(game.html.Q_GREEN,a+"/"+r))}this._skin.lab_maxState.string=o},layoutTips:function(e,t,i,n){i?(this._skin.lab_curState.node.y=this._skin.lab_maxState.node.y+this._skin.lab_curState.node.height+35,this._skin.lab_nextState.node.active=!1,this._skin.img_gray2.active=!1,this._skin.img_ungray2.active=!1,this._skin.lab_title2.node.active=!1):t?(this._skin.lab_nextState.node.y=this._skin.lab_maxState.node.y+this._skin.lab_nextState.node.height+15,this._skin.img_line2.y=this._skin.lab_nextState.node.y+this._skin.img_line2.height+5,this._skin.lab_curState.node.y=this._skin.img_line2.y+this._skin.lab_curState.node.height+15,this._skin.lab_nextState.node.active=!0,this._skin.img_gray2.active=!0,this._skin.img_ungray2.active=!1,this._skin.lab_title2.node.active=!0):(this._skin.lab_curState.node.y=this._skin.lab_maxState.node.y+this._skin.lab_curState.node.height+35,this._skin.lab_nextState.node.active=!1,this._skin.img_gray2.active=!1,this._skin.img_ungray2.active=!1,this._skin.lab_title2.node.active=!1),this._skin.img_line1.y=this._skin.lab_curState.node.y+this._skin.img_line1.height+5,this._skin.lab_title.node.y=this._skin.img_line1.y+this._skin.lab_title.node.height+20;var s=this._skin.lab_title.node.y+25;this._skin.lab_curState.node.active=!0,this._skin.img_gray1.active=!t,this._skin.img_ungray1.active=t,this._skin.lab_maxState.node.active=!0,this._skin.bg_2.height=s-90,this._skin.bg.node.height=s,this.height=s,this.resetPosition()},clearData:function(){this._skin.lab_curState.string="",this._skin.lab_nextState.string="",this._skin.lab_maxState.string="",this._skin.lab_nextState.node.active=!1,this._skin.img_gray2.active=!1,this._skin.img_ungray2.active=!1,this._skin.lab_title2.node.active=!1,this._skin.lab_maxState.node.active=!1}})},{}],895:[function(e,t,i){"use strict";game.appModule.ShowTipsPanel=game.SkinUIPanel.extends({_skin:null,_itemInfo:null,_iconSprite:null,ctor:function(e){this._super(e)},onShow:function(){this.clearData(),this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon)),this._itemInfo=this._data,this.updateInfo()},onHide:function(){},updateInfo:function(){this._skin.lab_name.string=this._itemInfo.name,this._skin.lab_level.string=this._itemInfo.level,this._skin.lab_desc.string=this._itemInfo.desc;var e=game.ClientCfg.GRIDS_QUALITY_ALAST_URL+this._itemInfo.quality;game.resController.setAtlasSpriteFrame(this._skin.img_quality.node,e);e=game.ClientCfg.getItemIconUrlByIconName(this._itemInfo.iconName);this._iconSprite.loadTexture(e,null,null,{useManifest:!1})},clearData:function(){this._skin.lab_name.string="",this._skin.lab_count.string="",this._skin.lab_level.string="",this._skin.lab_desc.string=""}})},{}],896:[function(e,t,i){"use strict";e("./EquipSuitsTips")},{"./EquipSuitsTips":894}],897:[function(e,t,i){"use strict";e("./panel/panelIndex_27")},{"./panel/panelIndex_27":896}],898:[function(e,t,i){"use strict";game.TowerCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Instance.EnterTowerResponse,this.onEnterTowerRq,this),b8e.addNH(game.pbmid.Instance.TowerInfoResponse,this.onTowerInforRq,this),b8e.addNH(game.pbmid.Instance.CollectTowerAwardResponse,this.onCollectTowerAwardRq,this),b8e.addNH(game.pbmid.Instance.FinishTowerInstanceNotify,this.onFinishTowerInstanceNotify,this)},onEnterTowerRq:function(e){var t=e.readProtobuf(game.pbmsg.EnterTowerResponse);if(t){var i=t.code;if(0<i)return game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)),void b8e.evt.dptG(game.TowerEvent.TOWER_ENTER_FAILED);game.tower.enterSussces(),b8e.evt.dptG(game.TowerEvent.TOWER_ENTER_SUCCESS)}},onTowerInforRq:function(e){var t=e.readProtobuf(game.pbmsg.TowerInfoResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.tower.synTowerInfo(t)}},onCollectTowerAwardRq:function(e){var t=e.readProtobuf(game.pbmsg.CollectTowerAwardResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):b8e.evt.dptG(game.TowerEvent.TOWER_DAILY_AWARD_SUCCESS,t.count)}},onFinishTowerInstanceNotify:function(e){var t=e.readProtobuf(game.pbmsg.FinishTowerInstanceNotify);t&&game.tower.onFinishedInstance(t)}})},{}],899:[function(e,t,i){"use strict";game.TowerType=b8e.Enum({})},{}],900:[function(e,t,i){"use strict";game.TowerEvent=b8e.Enum({TOWER_SYN_INFO:b8e.Event.nextCode(),TOWER_ENTER_SUCCESS:b8e.Event.nextCode(),TOWER_ENTER_FAILED:b8e.Event.nextCode(),TOWER_DAILY_AWARD_SUCCESS:b8e.Event.nextCode()})},{}],901:[function(e,t,i){"use strict";game.TowerMgr=b8e.Object.extends({name:"TowerMgr",_towerInfo:null,needPower:0,ctor:function(){if(1==game.TowerMgr._singleton)throw new Error("TowerMgr 只能通过单例方法获取");this._super()},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.TOWER)&&this.rqTowerInfo()},rqRank:function(){game.rank.reqRanInfoByType(game.RankType.RANK_TOWER)},showRank:function(){game.app.show(game.AppConstant.RANK_PANEL),game.rank.selectType(game.RankType.RANK_TOWER)},rqTowerInfo:function(){game.TowerSender.rqTowerInfo()},synTowerInfo:function(e){if(e){this._towerInfo||(this._towerInfo=new game.TowerInfo),this._towerInfo.setup(e);var t=game.ccfg.DungeonCfg.getDungeonById(game.tower.getEnterInsId());t&&(this.needPower=t.recommendPower),game.rune.setUnLockRuneSlot(),game.rune.setIsCanWearRune(),b8e.evt.dptG(game.TowerEvent.TOWER_SYN_INFO)}},rqEnterTower:function(){game.TowerSender.rqEnterTower()},enterSussces:function(){game.app.isShow(game.AppConstant.TOWER_PANEL)&&game.app.hide(game.AppConstant.TOWER_PANEL),game.app.isShow(game.AppConstant.CHALLANGE_PANEL)&&game.app.hide(game.AppConstant.CHALLANGE_PANEL);var e=game.SysTime.curTime+game.ccfg.GlobalParamCfg.getNumber(6003);game.leaveDungeon.show(e,game.SceneType.TOWER)},onFinishedInstance:function(e){if(e)if(e.state==game.BattleState.Victory){game.DungeonResultMgr.inst().showResult(!0,e.userItem),game.rune.changeSlots();var t=game.ccfg.DungeonCfg.getDungeonById(game.tower.getEnterInsId());t&&(this.needPower=t.recommendPower)}else game.DungeonResultMgr.inst().showResult(!1)},rqCollectTowerAward:function(e){0<this.getDailyAwardState()?game.notice.show("今日已领取"):game.TowerSender.rqCollectTowerAward(e)},getLatelyInfo:function(){if(this._towerInfo)return this._towerInfo.latelyInfo},getDailyAwardState:function(){return this._towerInfo?this._towerInfo.collect_count:1},setDailyAwardState:function(e){this._towerInfo&&(this._towerInfo.collect_count=e)},getEnterInsId:function(){return this.getInsId()+50001},getInsId:function(){return this._towerInfo?this._towerInfo.insId:0},getBattleFloor:function(){return this.calFloor(this.getInsId()+1)},getBattleHeaven:function(){return this.calHeaven(this.getInsId()+1)},getFloor:function(){return this.calFloor(this.getInsId())},getHeaven:function(){return this.calHeaven(this.getInsId())},calHeaven:function(e){return Math.ceil(e/6)},calFloor:function(e){var t=e%6;return 0==t?6:t},checkIniOpen:function(){return!!game.ccfg.DungeonCfg.getDungeonById(this.getEnterInsId())},convertPassString:function(e){return this.calHeaven(e)+"重天"+this.calFloor(e)+"层"},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.TOWER_ALERT,null,this.towerAlert,this)},towerAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.TOWER)){if(this._towerInfo&&this.getDailyAwardState()<1&&0<this._towerInfo.insId)return!0;if(!this.checkIniOpen())return!1;if(game.mainRole.mainRoleData.getZhanLi()>=this.needPower)return!0}return!1}}),game.TowerMgr._instance=null,game.TowerMgr._singleton=!0,game.TowerMgr.inst=function(){return game.TowerMgr._instance||(game.TowerMgr._singleton=!1,game.TowerMgr._instance=new game.TowerMgr,game.TowerMgr._singleton=!0),game.TowerMgr._instance}},{}],902:[function(e,t,i){"use strict";game.appModule.TowerDailyAwardPanel=game.SkinUIPanel.extends({_prizeInfo:null,_prizeList:null,ctor:function(e){this._super(e)},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.node_prize)},onShow:function(){this.createDailyAwardIcons(),this.updateCost(),this.updateAwardState(),b8e.evt.onC(this._skin.btn_get_1,this.onGetAward1,this),b8e.evt.onC(this._skin.btn_get_2,this.onGetAward2,this),b8e.evt.onC(this._skin.btn_get_3,this.onGetAward3,this),b8e.evt.addG(this,game.TowerEvent.TOWER_DAILY_AWARD_SUCCESS,this.onAwardSuccess),this._skin.lab_get_hint.string=game.ccfg.LangCfg.getText(5e4),this._skin.lab_pass_info.string=game.ccfg.LangCfg.getText(50001,[game.tower.getHeaven(),game.tower.getFloor()])},onHide:function(){b8e.evt.offC(this._skin.btn_get_1,this.onGetAward1,this),b8e.evt.offC(this._skin.btn_get_2,this.onGetAward2,this),b8e.evt.offC(this._skin.btn_get_3,this.onGetAward3,this),b8e.evt.rmvG(this,game.TowerEvent.TOWER_DAILY_AWARD_SUCCESS,this.onAwardSuccess)},updateAwardState:function(){var e=game.tower.getDailyAwardState();if(0<e)b8e.ShaderUtil.setGray(this._skin.btn_get_1),b8e.ShaderUtil.setGray(this._skin.btn_get_2),b8e.ShaderUtil.setGray(this._skin.btn_get_3),b8e.ShaderUtil.setGray(this._skin.yuanBao_1),b8e.ShaderUtil.setGray(this._skin.yuanBao_2),this._skin.complete_di.active=!0,e<=3&&(this._skin.complete_di.setPosition(this._skin.btn_get_award[e-1].getPosition()),this._skin.btn_get_award[e-1].active=!1);else{b8e.ShaderUtil.reset(this._skin.btn_get_1),b8e.ShaderUtil.reset(this._skin.btn_get_2),b8e.ShaderUtil.reset(this._skin.btn_get_3),b8e.ShaderUtil.reset(this._skin.yuanBao_1),b8e.ShaderUtil.reset(this._skin.yuanBao_2);for(var t=0;t<this._skin.btn_get_award.length;t++)this._skin.btn_get_award[t].active=!0;this._skin.complete_di.active=!1}},updateCost:function(){for(var e,t=0,i=0;i<3;i++)(e=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.TOWER_DAILY_AWARD,i+1))&&this._skin.lab_get_award[i]&&(e.upgradeInfo&&e.upgradeInfo.amountInfo&&(t=e.upgradeInfo.amountInfo.getValue(game.AmountType.YUAN_BAO)),this._skin.lab_get_award[i].string=""+t<=0?"免费":t)},onAwardSuccess:function(e){game.tower.setDailyAwardState(e.data),this.updateAwardState()},onGetAward1:function(){game.tower.rqCollectTowerAward(1)},onGetAward2:function(){game.tower.rqCollectTowerAward(2)},onGetAward3:function(){game.tower.rqCollectTowerAward(3)},createDailyAwardIcons:function(){var e=game.ccfg.TowerCfg.getDataById(game.tower.getInsId());if(e&&(this._prizeInfo.setupById(e.dailyAward),this._prizeInfo)){this._prizeList.setData(this._prizeInfo);var t=this._prizeList.realShowCount,i=.5*(590-game.IcoSizeEnum.SIZE_80*t);this._prizeList.setPosition(i,0)}}})},{}],903:[function(e,t,i){"use strict";game.appModule.TowerPanel=game.SkinUIPanel.extends({_towerInfo:null,_prizeList:null,_towerBg:null,_towerImg:null,_prizeInfo:null,_bsGrids:null,_noticeGrid:null,_runeIconList:null,_runeInfoMap:null,ctor:function(e){this._super(e)},init:function(){this._runeIconList=[],this._bsGrids=[],this._runeInfoMap=b8e.HashMap.get(),this._prizeInfo=new game.PrizeInfo,this._towerBg=b8e.Sprite.get(),this._towerBg.addToParent(this._skin.img_tower_bg),this._towerBg.loadTexture(game.ClientCfg.getTowerBgUrl(),null,null,{useManifest:!1}),this._towerImg=b8e.Sprite.get(),this._towerImg.addToParent(this._skin.img_tower),this._towerImg.loadTexture(game.ClientCfg.getTowerImgUrl(),null,null,{useManifest:!1}),this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.setPosition(20,90),this._prizeList.addToParent(this._skin.node_pass_prize)},onShow:function(){game.tower.rqTowerInfo(),game.tower.rqRank(),b8e.evt.onC(this._skin.btn_challenge,this.onChallenge,this),b8e.evt.onC(this._skin.btn_daily_prize,this.onGetDailyPrize,this),b8e.evt.onC(this._skin.btn_rank,this.showRank,this),b8e.evt.addG(this,game.RankEvents.UPDATE_RANK_INFO,this.updateRank),b8e.evt.addG(this,game.TowerEvent.TOWER_SYN_INFO,this.synTowerInfo),b8e.evt.addG(this,game.TowerEvent.TOWER_DAILY_AWARD_SUCCESS,this.onAwardSuccess)},onHide:function(){b8e.Tween.kill(this._skin.img_light),b8e.evt.offC(this._skin.btn_challenge,this.onChallenge,this),b8e.evt.offC(this._skin.btn_daily_prize,this.onGetDailyPrize,this),b8e.evt.offC(this._skin.btn_rank,this.showRank,this),b8e.evt.rmvG(this,game.RankEvents.UPDATE_RANK_INFO,this.updateRank),b8e.evt.rmvG(this,game.TowerEvent.TOWER_SYN_INFO,this.synTowerInfo),b8e.evt.rmvG(this,game.TowerEvent.TOWER_DAILY_AWARD_SUCCESS,this.onAwardSuccess)},synTowerInfo:function(){this.createPassAward(),this.createLatelyInfo(),this.updateDailyAwardState(),this.updatePass(),this.createRuneNotice()},showRank:function(){game.tower.showRank()},updateRank:function(){var e=game.rank.getRankListByType(game.RankType.RANK_TOWER);if(e&&!(e.length<=0))for(var t=0;t<3;t++)e[t]?(this._skin.lab_rank[t].node.active=!0,this._skin.lab_palyer_name[t].node.active=!0,this._skin.lab_pass_info[t].node.active=!0,this._skin.lab_palyer_name[t].string=e[t].name,this._skin.lab_pass_info[t].string=this.convertPassString(e[t].score)):(this._skin.lab_rank[t].node.active=!1,this._skin.lab_palyer_name[t].node.active=!1,this._skin.lab_pass_info[t].node.active=!1)},convertPassString:function(e){var t=e%6,i=0==t?6:t;return Math.ceil(e/6)+"重天"+i+"层"},onAwardSuccess:function(e){game.tower.setDailyAwardState(e.data),this.updateDailyAwardState()},updateDailyAwardState:function(){game.ccfg.TowerCfg.getDataById(game.tower.getInsId())?(this._skin.node_prize.active=!0,0<game.tower.getDailyAwardState()?(this._skin.icon_red_point.active=!1,this._skin.lab_prize_status.string=game.ccfg.LangCfg.getText(50002),this._skin.complete_di.active=!0):(this._skin.icon_red_point.active=!0,this._skin.lab_prize_status.string=game.ccfg.LangCfg.getText(50003),this._skin.complete_di.active=!1)):this._skin.node_prize.active=!1},updatePass:function(){game.tower.getInsId()<=0?this._skin.lab_heaven.string="1重天":this._skin.lab_heaven.string=game.tower.getBattleHeaven()+"重天";var e=game.tower.getEnterInsId(),t=game.ccfg.DungeonCfg.getDungeonById(e);t&&(game.mainRole.mainRoleData.getZhanLi()>=t.recommendPower?this._skin.lab_recommend_power.string=game.html.getText(game.html.Q_GREEN,t.recommendPower):this._skin.lab_recommend_power.string=game.html.getText(game.html.Q_RED,t.recommendPower));var i=game.tower.getBattleFloor();this._skin.img_light.setPosition(this._skin.img_floors[i].getPosition()),this.lightAnimation()},lightAnimation:function(){this._skin.img_light.setScale(1,1),this._skin.img_light.opacity=255,b8e.Tween.kill(this._skin.img_light),b8e.Tween.get(this._skin.img_light,{loop:!0}).to({scaleX:1.02,scaleY:1.05,opacity:191},660).to({scaleX:1,scaleY:1,opacity:255},660)},createPassAward:function(){this._skin.lab_pass_prize.string="通关第"+game.tower.getBattleFloor()+"层奖励";var e=game.tower.getEnterInsId(),t=game.ccfg.DungeonCfg.getDungeonById(e);if(!t)return this._skin.node_pass_prize.active=!1,void(this._skin.lab_open_state.node.active=!0);this._skin.node_pass_prize.active=!0,this._skin.lab_open_state.node.active=!1;var i=t.monster[0];if(i){var n=game.ccfg.MonsterCfg.getMonsterModelById(i.Id);if(n&&(this._prizeInfo.setupById(n.dropId),this._prizeInfo)){this._prizeList.setData(this._prizeInfo);var s=this._prizeList.realShowCount,a=20+1.5*game.IcoSizeEnum.SIZE_80-s*game.IcoSizeEnum.SIZE_80*.5;this._prizeList.setPosition(a,90)}}},clearNoticeGrid:function(){if(this._noticeGrid&&(game.GridUtil.setRuneSlotNotice(this._noticeGrid,null),this._noticeGrid.sortLayer()),this._runeIconList)for(var e,t=0;t<this._runeIconList.length;t++)(e=this._runeIconList[t])&&(game.GridUtil.setRuneGrid(e,null),e.sortLayer())},createRuneNotice:function(){this.clearNoticeGrid();var e,t=game.ccfg.TowerCfg.getRuneNotice(game.tower.getInsId()+1);if(t){if(this._skin.img_notice_bg.active=!0,this._skin.lab_notice_title.string="通关"+game.tower.calHeaven(t.layer)+"重天",t.unlockIndex)this._skin.lab_notice_details.string="解锁新槽位",this._noticeGrid?(e=this._noticeGrid).setVisible(!0):((e=new game.ItemGrid(game.IcoSizeEnum.SIZE_72)).gridInfo=new game.GridInfo(game.ContainerId.TOWER_NOTICE_ID),e.addToParent(this._skin.node_notice),this._noticeGrid=e),game.GridUtil.setRuneSlotNotice(e,t.unlockIndex,!1,!0),e.setSize(game.IcoSizeEnum.SIZEx_72,game.IcoSizeEnum.SIZE_72),e.setPosition(.5*this._skin.node_notice.width,0),e.sortLayer();else if(t.unlockRuneId){var i,n=0,s=0;this._skin.lab_notice_details.string="解锁新类型";for(var a=0,o=0;o<t.unlockRuneId.length;o++)if(a=t.unlockRuneId[o],i=game.ccfg.RuneCfg.getRuneDataById(a)){var r=this._runeInfoMap.get(a);r||((r=new game.RuneInfo).setupByCfg(i),this._runeInfoMap.set(a,r)),(e=this._runeIconList[s])?e.setVisible(!0):((e=new game.ItemGrid(game.IcoSizeEnum.SIZE_72)).gridInfo=new game.GridInfo(game.ContainerId.TOWER_NOTICE_ID),e.fnOnClick(this,this.onClick),e.addToParent(this._skin.node_notice),this._runeIconList.push(e)),game.GridUtil.setRuneGrid(e,r,!1,!0),e.setSize(game.IcoSizeEnum.SIZE_72,game.IcoSizeEnum.SIZE_72),e.sortLayer(),s++}if(0<s){var h=s*(game.IcoSizeEnum.SIZE_72+4)-4,g=.5*(this._skin.node_notice.width-h+(game.IcoSizeEnum.SIZE_72+4));for(o=0;o<s;o++)n=g+o*((e=this._runeIconList[o])._iconSize+4),e.setPosition(n,0)}}}else this._skin.img_notice_bg.active=!1},onClick:function(e){game.rune.showRuneTips(e.faceInfo,game.ContainerId.CSARENA_ILLUSTRATION_CONTAINER_ID)},createLatelyInfo:function(){if(this.clearGrids(),this._skin.lab_player_name.string="",this._skin.lab_palyer_bp.string="",game.tower.checkIniOpen()){var e=game.tower.getLatelyInfo();if(e&&(e.name?(0<e.rebirthLevel?this._skin.lab_player_name.string=e.name+"  "+e.rebirthLevel+"转"+e.level+"级":this._skin.lab_player_name.string=e.name+"  "+e.level+"级",this._skin.lab_palyer_bp.string="战力："+e.power):(this._skin.lab_player_name.string="",this._skin.lab_palyer_bp.string=""),e.bianshens))for(var t,i,n,s=this._bsGrids.length,a=0,o=e.bianshens.length;a<o;a++)(i=e.bianshens[a])&&(a<s?n=this._bsGrids[a]:((n=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.TOWER_NOTICE_ID),n.addToParent(this._skin.grid),n.x=20+80*a,n.setScale(game.IconScale.PERCENT_60,game.IconScale.PERCENT_60),this._bsGrids.push(n)),(t=game.ItemInfoUtil.createBianshenInfo(i.bianshen)).battle=!1,game.GridUtil.setBianshenGrid(n,t),n.sortLayer())}},clearGrids:function(){if(this._bsGrids&&!(this._bsGrids.length<=0))for(var e,t=0;t<this._bsGrids.length;t++)(e=this._bsGrids[t])&&game.GridUtil.setItemGrid(e,null)},onChallenge:function(){game.tower.checkIniOpen()?game.tower.rqEnterTower():game.notice.show(game.ccfg.LangCfg.getText("暂未开放"))},onGetDailyPrize:function(){0<game.tower.getInsId()?game.app.show(game.AppConstant.TOWER_DAILY_AWARD_PANEL):game.notice.show(game.ccfg.LangCfg.getText(50004))}})},{}],904:[function(e,t,i){"use strict";game.TowerSender={},game.TowerSender.rqEnterTower=function(){var e=game.pbmid.Instance.EnterTowerRequest;b8e.sendN(e)},game.TowerSender.rqTowerInfo=function(){var e=game.pbmid.Instance.TowerInfoRequest;b8e.sendN(e)},game.TowerSender.rqCollectTowerAward=function(e){var t=game.pbmsg.CollectTowerAwardRequest;t.count=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.CollectTowerAwardRequest;b8e.sendN(i)}},{}],905:[function(e,t,i){arguments[4][263][0].apply(i,arguments)},{dup:263}],906:[function(e,t,i){"use strict";game.TransgerNoticeCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Scene.SendTransferNoticeResponse,this.onSendTransferNoticeResponse,this),b8e.addNH(game.pbmid.Scene.TransferNoticeNotify,this.onTransferNoticeNotify,this),b8e.addNH(game.pbmid.Scene.TransferNoticeCDTimeResponse,this.onTransferNoticeCDTimeResponse,this)},onSendTransferNoticeResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.SendTransferNoticeResponse);if(i){var n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.transferNotice.sendTransferNoticeFinish(i.time)}},onTransferNoticeNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.TransferNoticeNotify);i&&game.transferNotice.receiveTransferNotice(i)},onTransferNoticeCDTimeResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.TransferNoticeCDTimeResponse);if(i){var n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.transferNotice.sendTransferNoticeFinish(i.time)}}})},{}],907:[function(e,t,i){"use strict";e("./TransgerNoticeCmd")},{"./TransgerNoticeCmd":906}],908:[function(e,t,i){"use strict";game.TransferType=b8e.Enum({NotionalBoss:0,TeamBoss:1,GuildExpCure:2,Escort:3,NeutralBoss:4})},{}],909:[function(e,t,i){"use strict";game.TransferNoticeEvents=b8e.Enum({RECEIVE_TRANSGER:b8e.Event.nextCode(),DEL_TRANSGER:b8e.Event.nextCode(),SEND_TRANSGER_SUCCSE:b8e.Event.nextCode()})},{}],910:[function(e,t,i){"use strict";e("./TransferNoticeEvents")},{"./TransferNoticeEvents":909}],911:[function(e,t,i){"use strict";game.TransferNoticeMgr=b8e.Object.extends({name:"TransferNoticeMgr",noticeMap:null,cd:0,key:0,callCd:0,isFirstSendTransfer:!1,_curTransferNotice:null,_timer:null,_shineMap:null,count:0,ctor:function(){if(1==game.TransferNoticeMgr._singleton)throw new Error("TransferNoticeMgr 只能通过单例方法获取");this._super(),this.noticeMap=b8e.HashMap.get(),this._shineMap=b8e.HashMap.get()},sendTransferNotice:function(e){game.TransferNoticeSender.sendTransferNoticeRequest(e)},sendTransferNoticeFinish:function(e){game.notice.show("发射成功"),this.callCd=e,b8e.evt.dptG(game.TransferNoticeEvents.SEND_TRANSGER_SUCCSE)},receiveTransferNotice:function(e){var t=this._shineMap.get(e.roleId);t||(this.count++,t=this.count,this._shineMap.set(e.roleId,t));var i=b8e.CommonUtil.xyToInt(t,e.sceneId),n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.TRANSFER_USE_TIME);e.time=e.time+1e3*n,this.noticeMap.set(i,e),b8e.evt.dptG(game.TransferNoticeEvents.RECEIVE_TRANSGER);var s=e.time-game.SysTime.curTime;(s<this.cd||0==this.cd)&&(this.key=i,this.cd=s,b8e.Tween.kill(this),b8e.Tween.get(this).wait(this.cd).call(this.updateCdTime))},updateCdTime:function(){var e=this.noticeMap.has(this.key);e&&this.noticeMap.del(this.key),this.key=0,this.cd=0;var t=this.noticeMap.keys();if(t&&!(t.length<0)){for(var i=0;i<t.length;i++){var n=t[i];if(e=this.noticeMap.has(n)){var s=this.noticeMap.get(n).time-game.SysTime.curTime;s<=0?this.noticeMap.del(n):(this.cd<=0||this.cd>s)&&(this.cd=s,this.key=n)}}0<this.cd&&0!=this.key&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(this.cd).call(this.updateCdTime)),b8e.evt.dptG(game.TransferNoticeEvents.DEL_TRANSGER)}},ignoreNotice:function(e){var t=this._shineMap.get(e.roleId);if(t){var i=b8e.CommonUtil.xyToInt(t,e.sceneId);i==this.key?(b8e.Tween.kill(this),this.updateCdTime()):this.noticeMap.del(i),0==this.noticeMap.count()&&game.app.isShow(game.AppConstant.TRANSFER_NOTICE_PANEL)&&game.app.hide(game.AppConstant.TRANSFER_NOTICE_PANEL)}},gotoTransfer:function(e){if(e){switch(this._curTransferNotice=e,this._curTransferNotice.sceneType){case game.TransferType.NotionalBoss:case game.TransferType.NeutralBoss:game.nationalBoss.sendEnterNationalBossScene(this._curTransferNotice.sceneId,!0);break;case game.TransferType.TeamBoss:this._curTransferNotice.teamId&&game.team.joinOthersTeam(this._curTransferNotice.sceneId,this._curTransferNotice.teamId);break;case game.TransferType.GuildExpCure:game.guild.reqGuildExpCure(this._curTransferNotice.roleId);break;case game.TransferType.Escort:game.escort.escortAcceptInviteRequest(this._curTransferNotice.roleId);break;default:b8e.warn("gotoTransfer transferNotice.sceneType warn"+this._curTransferNotice.sceneType)}game.transferNotice.ignoreNotice(this._curTransferNotice)}},gotoTransferSuccess:function(){this._curTransferNotice&&this.ignoreNotice(this._curTransferNotice)},getAllNotice:function(){return this.noticeMap.values()},getNoticeCount:function(){return this.noticeMap.count()}}),game.TransferNoticeMgr._instance=null,game.TransferNoticeMgr._singleton=!0,game.TransferNoticeMgr.inst=function(){return game.TransferNoticeMgr._instance||(game.TransferNoticeMgr._singleton=!1,game.TransferNoticeMgr._instance=new game.TransferNoticeMgr,game.TransferNoticeMgr._singleton=!0),game.TransferNoticeMgr._instance}},{}],912:[function(e,t,i){"use strict";e("./TransferNoticeMgr")},{"./TransferNoticeMgr":911}],913:[function(e,t,i){"use strict";game.TransferNoticeItem=game.SkinUI.extends({_transferNotice:null,_timer:null,ctor:function(){this._super("transferNotice/TransferNoticeItemSkin","TransferNoticeItemSkin"),this._showList=[]},getWidth:function(){return 580},getHeight:function(){return 100},onShow:function(){this.setData(this._transferNotice),b8e.evt.onC(this._skin.btn_go,this.onClickBtnGo,this),b8e.evt.onC(this._skin.btn_ignore,this.onClickBtnIgnore,this)},onHide:function(){b8e.evt.offC(this._skin.btn_go,this.onClickBtnGo,this),b8e.evt.offC(this._skin.btn_ignore,this.onClickBtnIgnore,this),this._timer&&(b8e.Timer.remove(this,this.updateGoTime),this._timer=null)},setData:function(e){if(this._transferNotice=e,this._transferNotice&&this._skin){switch(this._skin.lab_go.string=game.ccfg.LangCfg.getText(79023),this._transferNotice.sceneType){case game.TransferType.NotionalBoss:if(!(t=game.ccfg.NationalBossCfg.getNationalBossById(this._transferNotice.sceneId)))return;this._skin.lab_notice.string=game.ccfg.LangCfg.getText(10204,[this._transferNotice.roleName,t.unlockLevel,t.name]);break;case game.TransferType.NeutralBoss:var t;if(!(t=game.ccfg.NationalBossCfg.getNationalBossById(this._transferNotice.sceneId)))return;var i=game.ccfg.DujieCfg.getDataByLevel(t.dujieLevel);if(!i)return;this._skin.lab_notice.string=game.ccfg.LangCfg.getText(10205,[this._transferNotice.roleName,i.name,t.name]);break;case game.TransferType.TeamBoss:var n=game.ccfg.DungeonCfg.getDungeonById(this._transferNotice.sceneId);if(n){var s=n.name;this._skin.lab_notice.string=game.ccfg.LangCfg.getText(27017,[this._transferNotice.roleName,s])}break;case game.TransferType.GuildExpCure:var a=game.guild.getMemberInfo(this._transferNotice.roleId);if(a){var o=game.guild.getGuildExpCurePrizeString(a.level);this._skin.lab_notice.string=game.ccfg.LangCfg.getText(77003,[this._transferNotice.roleName,o])}break;case game.TransferType.Escort:this._skin.lab_notice.string=game.ccfg.LangCfg.getText(79021,[this._transferNotice.roleName]),this._skin.lab_go.string=game.ccfg.LangCfg.getText(79024)}this.updateGoTime(),this._timer||(this._timer=b8e.Timer.add(this,this.updateGoTime,1e3)),this._timer.reset(),this._timer.start()}},onClickBtnGo:function(){game.transferNotice.gotoTransfer(this._transferNotice)},onClickBtnIgnore:function(){game.transferNotice.ignoreNotice(this._transferNotice)},updateGoTime:function(){var e=this._transferNotice.time-game.SysTime.curTime;e<=0?this._timer&&(b8e.Timer.remove(this,this.updateGoTime),this._timer=null):this._skin.lab_cd_time.string=~~(.001*e)+"秒后失效"}})},{}],914:[function(e,t,i){"use strict";game.appModule.TransferNoticePanel=game.SkinUIPanel.extends({_list:null,_showList:null,ctor:function(e){this._super(e),this._showList=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.TransferNoticeItem)),this._list.show(),this.setTransferNotice(),b8e.evt.addG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.setTransferNotice),b8e.evt.addG(this,game.TransferNoticeEvents.DEL_TRANSGER,this.setTransferNotice),b8e.evt.addG(this,game.NationalBossEvents.ENTER_SCENE_FINISH,this.hide)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.TransferNoticeEvents.RECEIVE_TRANSGER,this.setTransferNotice),b8e.evt.rmvG(this,game.TransferNoticeEvents.DEL_TRANSGER,this.setTransferNotice),b8e.evt.rmvG(this,game.NationalBossEvents.ENTER_SCENE_FINISH,this.hide)},setTransferNotice:function(){this._showList.length=0,this._showList=game.transferNotice.getAllNotice(),!this._showList||this._showList.length<0||(this._showList.sort(this.onSortList),this._list.setData(this._showList))},onSortList:function(e,t){return e.time<t.time?-1:e.time>t.time?1:0}})},{}],915:[function(e,t,i){"use strict";e("./TransferNoticePanel"),e("./TransferNoticeItem")},{"./TransferNoticeItem":913,"./TransferNoticePanel":914}],916:[function(e,t,i){"use strict";var n=game.TransferNoticeSender=function(){};n.sendTransferNoticeRequest=function(e){var t=game.pbmsg.SendTransferNoticeRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.SendTransferNoticeRequest;b8e.sendN(i)},n.TransferNoticeCDTimeRequest=function(e){var t=game.pbmid.Scene.TransferNoticeCDTimeRequest;b8e.sendN(t)}},{}],917:[function(e,t,i){"use strict";e("./TransferNoticeSender")},{"./TransferNoticeSender":916}],918:[function(e,t,i){"use strict";e("./cmdlistener/transgerCmdIndex_0"),e("./events/transgerEventsIndex_0"),e("./sender/transgerSenderIndex_0"),e("./manager/transgerMgrIndex_0"),e("./panel/transgerPanelIndex_0")},{"./cmdlistener/transgerCmdIndex_0":907,"./events/transgerEventsIndex_0":910,"./manager/transgerMgrIndex_0":912,"./panel/transgerPanelIndex_0":915,"./sender/transgerSenderIndex_0":917}],919:[function(e,t,i){"use strict";game.VipCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Recharge.VipDataNotify,this.onVipDataNotify,this),b8e.addNH(game.pbmid.Recharge.VipPrizeResponse,this.onVipPrizeResponse,this)},onVipDataNotify:function(e){var t=e.readProtobuf(game.pbmsg.VipDataNotify);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.vip.synVipDataNotify(t.vipLv,t.vipExp)},onVipPrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.VipPrizeResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.vip.synVipPrizeResponse(t.lv)}})},{}],920:[function(e,t,i){"use strict";e("./VipCmd")},{"./VipCmd":919}],921:[function(e,t,i){"use strict";game.VipEvents=b8e.Enum({RES_VIP_PRIZE_SUCCESS:b8e.Event.nextCode(),UPDATA_VIP_INFO:b8e.Event.nextCode()})},{}],922:[function(e,t,i){"use strict";game.VipMgr=b8e.Object.extends({name:"VipMgr",_vipInfo:null,_nextVipInfo:null,_prizeInfo:null,_vipLv:0,_vipExp:0,collectedVipPrize:0,vipShowLvArr:null,showVipLv:0,panelShowVipLv:0,ctor:function(){if(1==game.VipMgr._singleton)throw new Error("VipMgr 只能通过单例方法获取");this._super(),this._payInfoArr=[],this._countArr=[],this.vipShowLvArr=[],this._prizeInfo=new game.PrizeInfo},openVipPanelToLv:function(e){this.panelShowVipLv=e,this.openVipPanel()},openVipPanel:function(){game.pay.isRechargePanel=!1,game.app.show(game.AppConstant.PAY_PANEL)},vipTips:function(){game.gameAlert.showVipAlert(!1,102)},synVipInfo:function(e,t){this._vipLv=e,this._vipExp=t,game.mainRole.mainRoleData.setVipLv(this._vipLv),0==game.app.isShow(game.AppConstant.WELFARE_PANEL)&&(game.welfare.selectSubType=game.WelfareType.COVER_PANEL),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE),b8e.evt.dptG(game.VipEvents.UPDATA_VIP_INFO)},synVipDataNotify:function(e,t){this._vipLv=e,this._vipExp=t,game.mainRole.mainRoleData.setVipLv(this._vipLv),b8e.evt.dptG(game.VipEvents.UPDATA_VIP_INFO)},synVipPrizeResponse:function(e){this.collectedVipPrize=this.collectedVipPrize|1<<e-1,this.setOpenPanelVipLv(),b8e.evt.dptG(game.VipEvents.RES_VIP_PRIZE_SUCCESS)},getInfoByVipLv:function(e){if(this._vipInfo=game.ccfg.VipCfg.getInfoByLv(e),this._vipInfo)return this._vipInfo},getCurVipLvNeedExp:function(){return game.ccfg.VipCfg.getVipExpByLv(this._vipLv)},getCollectedVipPrize:function(){return this.collectedVipPrize},isGetVipPrize:function(e){return 0!=(this.collectedVipPrize&1<<e-1)},isShowVipBtn:function(){return this._vipLv<game.ccfg.VipCfg.getMaxVipShowLv()},setMinShowLv:function(){if(this.vipShowLvArr.length<=0&&(this.vipShowLvArr=game.ccfg.VipCfg.getVipShowMapKeys()),this.vipShowLvArr&&0<this.vipShowLvArr.length)for(var e,t=this.vipShowLvArr.length,i=0;i<t;i++)e=this.vipShowLvArr[i],this._vipLv<e&&(this.showVipLv=e)},setOpenPanelVipLv:function(){for(var e,t=game.ccfg.VipCfg.getMaxVipLv(),i=1;i<t;i++)if(!this.isGetVipPrize(i))return void(this.panelShowVipLv=i);e=this._vipLv==t?t:this._vipLv+1,this.panelShowVipLv=e},getVipLv:function(){return this._vipLv},getVipExp:function(){return this._vipExp},getVipPrizeInfo:function(e){var t=game.ccfg.VipCfg.getInfoByLv(e).prize;return this._prizeInfo.setupById(t),this._prizeInfo},getPrivilegeArr:function(){return this._countArr},getNextVipInfo:function(){var e=this._vipLv,t=game.ccfg.VipCfg.getMaxVipLv();if(this._nextVipInfo=t<=e?game.ccfg.VipCfg.getInfoByLv(t):game.ccfg.VipCfg.getInfoByLv(e+1),this._nextVipInfo)return this._nextVipInfo},isMaxVip:function(){var e=game.ccfg.VipCfg.getMaxVipLv();return this._vipLv>=e},getCoverGoldCount:function(){return game.ccfg.VipCfg.getUseConvertGoldTimesByLv(this._vipLv)},getBuyPowerTimes:function(){return game.ccfg.VipCfg.getBuyPowerTimesByLv(this._vipLv)},getQuickPassTimes:function(){return game.ccfg.VipCfg.getQuickPassTimesByLv(this._vipLv)},getBuyArenaTimesByLv:function(){return game.ccfg.VipCfg.getBuyArenaTimesByLv(this._vipLv)},getBuyInstanceTimes:function(){return game.ccfg.VipCfg.getBuyInstanceTimesByLv(this._vipLv)},getBuyMaterialTimes:function(){return game.ccfg.VipCfg.buyMaterialTimesByLv(this._vipLv)},getRebirthItemUseCount:function(){return game.ccfg.VipCfg.rebirthItemUseCountByLv(this._vipLv)},getAddExpRate:function(){return game.ccfg.VipCfg.addExpRate(this._vipLv)},getAddGoldRate:function(){return game.ccfg.VipCfg.addGoldRate(this._vipLv)},getVipRebateCount:function(){return game.ccfg.VipCfg.vipRebateCountByLv(this._vipLv)},getDailyRebateCount:function(){return game.ccfg.VipCfg.dailyRebateCountByLv(this._vipLv)},getRetrieveDays:function(){return game.ccfg.VipCfg.getMaxRetrieveDayCount(this._vipLv)},getVipAwardDesId:function(){return game.ccfg.VipCfg.getVipAwardDesIdByLv(this._vipLv)},isShowVipCustomer:function(){return 6<=this._vipLv},vipAlert:function(){for(var e=1;e<=this._vipLv;e++){if(0==this.isGetVipPrize(e))return!0}return!1}}),game.VipMgr._instance=null,game.VipMgr._singleton=!0,game.VipMgr.inst=function(){return game.VipMgr._instance||(game.VipMgr._singleton=!1,game.VipMgr._instance=new game.VipMgr,game.VipMgr._singleton=!0),game.VipMgr._instance}},{}],923:[function(e,t,i){"use strict";e("./VipMgr")},{"./VipMgr":922}],924:[function(e,t,i){"use strict";game.appModule.VipCustomerChatPanel=game.SkinUIPanel.extends({_list:null,onShow:function(){this.initPanel(),this.onChatSendSuccess(),b8e.evt.addG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.addG(this,game.RelationEvent.CHAT_TARGET_CHANGE,this.onChatChange),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.roleInfoChange),b8e.evt.onC(this._skin.send,this.sendMsg,this),this.onChatChange(),this.roleInfoChange(),this._list.show(!1,!1)},onHide:function(){this._list&&this._list.hide(!1),b8e.evt.rmvG(this,game.ChatEvent.CHAT_SEND_SUCCESS,this.onChatSendSuccess),b8e.evt.rmvG(this,game.RelationEvent.CHAT_TARGET_CHANGE,this.onChatChange),b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.roleInfoChange),b8e.evt.offC(this._skin.send,this.sendMsg,this),b8e.Tween.kill(this),game.relationChat.setChatTarget(0)},initPanel:function(){this._list||(this._list=new b8e.List(this._skin.list,game.TalkItem))},roleInfoChange:function(){var e=game.mainRole.mainRoleData;this._skin.roleName.string="s."+game.LoginConfig.serverId+" "+e.name,this._skin.roleId.string="您的ID: "+e.playerId,this._skin.level.string=game.rebirth.getSelfRebirthAndLv()},onChatChange:function(){var e=game.relationChat.getChatTarget();e?(this._list.setData(e.chats),e.chats&&0!=e.chats.length?this._skin.lab_tip.node.active=!1:this._skin.lab_tip.node.active=!0,4<e.chats.length&&(b8e.Tween.kill(this),b8e.Tween.get(this).wait(300).call(this.onScrollToBottom))):(this._skin.lab_tip.node.active=!0,this._list.setData([]))},onScrollToBottom:function(){this._skin.list.scrollToBottom(0),this._list._onScrolling()},sendMsg:function(){game.relationChat.sendChat(this._skin.content.string)},onChatSendSuccess:function(){this._skin&&(this._skin.content.string="")}})},{}],925:[function(e,t,i){"use strict";game.VipCustomerItem=game.SkinUI.extends({_itemGrid:null,_itemInfo:null,ctor:function(){this._super("vip/VipCustomerItemSkin","VipCustomerItemSkin")},init:function(){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_72),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.VIP_CUSTOMER_CONTAINER_ID),this._itemGrid.addToParent(this._skin.prize),this._itemGrid.fnOnClick(this,this.onClick))},onShow:function(){this.setData(this._data)},onHide:function(){},onClick:function(e){if(this._itemInfo){this._itemInfo.isEquip?game.app.show(game.AppConstant.EQUIP_TIPS,this._itemInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.VIP_CUSTOMER_CONTAINER_ID})}},setData:function(e){this._data=e,this._skin&&(this._itemInfo=game.ccfg.ItemInfoCfg.getItemInfoById(e.award),game.GridUtil.setItemGrid(this._itemGrid,this._itemInfo,!1),this._skin.money.string="充值"+e.money,this._itemGrid.sortLayer())}})},{}],926:[function(e,t,i){"use strict";game.VipCustomerList=game.SkinUI.extends({_vipLevel:null,isInit:!1,ctor:function(){this._super("vip/VipCustomerListSkin","VipCustomerListSkin")},init:function(){this._vipLevel||(this._vipLevel=b8e.Sprite.get(),this._vipLevel.setAnchor(.5,.5),this._vipLevel.addToParent(this._skin.vipLevel))},onShow:function(){this.setData(this._datas)},onHide:function(){},setData:function(e){if(this._datas=e,this._skin&&!this.isInit&&e&&3==e.length){var t=e[0],i=game.ClientCfg.getVipAwardLevel(t.vipMinLv);this._vipLevel.loadTexture(i,null,null,{useManifest:!1});for(var n=0,s=e.length;n<s;n++){t=e[n];var a=n+1,o=this._skin["rechrigeItem_"+a];if(o&&t){var r=new game.VipCustomerItem;r.addToParent(o),r.show(),r.setData(t)}}this.isInit=!0}},getHeight:function(){return 126},getWidth:function(){return 555}})},{}],927:[function(e,t,i){"use strict";game.appModule.VipCustomerPanel=game.SkinUIPanel.extends({_list:null,_bgSprite:null,init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.VipCustomerList));var e=game.ccfg.VipAwardCfg.getDatas();e?(this._list.setData(e),this._skin.chatBtn.active=game.LoginConfig.isQQvip,this._bgSprite||(this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.bg_node)),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl(game.ClientCfg.vipCustomer,!0),null,null,{useManifest:!1})):b8e.warn("VipCustomerPanel init warn")},onShow:function(){this._list.show(),b8e.evt.onC(this._skin.chatBtn,this.onOpenChat,this),b8e.evt.addG(this,game.VipEvents.UPDATA_VIP_INFO,this.updatePanel),this.updatePanel()},onHide:function(){this._list.hide(),b8e.evt.offC(this._skin.chatBtn,this.onOpenChat,this),b8e.evt.rmvG(this,game.VipEvents.UPDATA_VIP_INFO,this.updatePanel)},updatePanel:function(){var e=game.mainRole.mainRoleData;game.vip.isMaxVip()?this._skin.vipLevel.string="您已达到最高VIP等级":this._skin.vipLevel.string="尊贵的VIP"+e.getVipLv()+"会员";var t=game.vip.getVipAwardDesId();this._skin.vipDes.string=game.ccfg.LangCfg.getText(t)},onOpenChat:function(){game.RelationChatMgr.inst().setVipCustomerChat()}})},{}],928:[function(e,t,i){"use strict";game.appModule.VipShowPanel=game.SkinUIPanel.extends({_prizeSprite:null,_bgSprite:null,_rechargeSprite:null,_descSprite:null,_prizeList:null,_prizeInfo:null,_showVipLv:0,_animModel:null,_iconSprite:null,_prizeList1:null,_prizeInfo1:null,ctor:function(e){this._super(e)},init:function(){this._beautyInfo=game.ccfg.BeautyDataCfg.getBeautyInfoById(3),this._prizeInfo1=new game.PrizeInfo,this._prizeList1=new game.PrizeList(1,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80),this._prizeList1.addToParent(this._skin.prize_item),this._iconSprite=b8e.Sprite.get(),this._iconSprite.setAnchor(.5,1),this._iconSprite.addToParent(this._skin.img_beautyName),this._skillIcon=new game.SkillIcon(game.SkillIconType.TYPE_BEAUTY),this._skillIcon.setSkillIconType(game.SkillIconType.TYPE_BEAUTY),this._skillIcon.setAnchor(.5,.5),this._skillIcon.addToParent(this._skin.img_skill),this._prizeSprite=b8e.Sprite.get(),this._prizeSprite.addToParent(this._skin.img_kuang),this._prizeSprite.loadTexture(game.ClientCfg.getImgUrl("vip/vipShow/prizeBg",!1),null,null,{useManifest:!1}),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.img_banner),this._rechargeSprite=b8e.Sprite.get(),this._rechargeSprite.addToParent(this._skin.img_rechargeDesc),this._descSprite=b8e.Sprite.get(),this._descSprite.addToParent(this._skin.img_desc),this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,0,!0),this._prizeList.addToParent(this._skin.prize),this._prizeInfo=new game.PrizeInfo,game.vip.setMinShowLv(),this.updateDatas()},onShow:function(){this.updatePanel(),b8e.evt.onC(this._skin.btn_recharge,this.onClickBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_recharge,this.onClickBtn,this)},updatePanel:function(){this._showVipLv!=game.vip.showVipLv&&this.updateDatas()},updateDatas:function(){this._showVipLv=game.vip.showVipLv;var e=game.ccfg.VipCfg.getVipShowInfoByLv(this._showVipLv);if(e){this._bgSprite.loadTexture(game.ClientCfg.getBeautyIconUrlByIconName("bg",!0),null,null,{useManifest:!1}),this._rechargeSprite.loadTexture(game.ClientCfg.getImgUrl(e.rechargeDescImg,!1),null,null,{useManifest:!1}),this._descSprite.loadTexture(game.ClientCfg.getImgUrl(e.descImg,!1),null,null,{useManifest:!1}),this._prizeInfo.setupById(e.showPrize),this._prizeList.setData(this._prizeInfo),this.showModel();var t=game.ClientCfg.getBeautyNameUrlByIconName(this._beautyInfo.nameRes);this._iconSprite.loadTexture(t,null,null,{useManifest:!1});var i=game.ccfg.BeautyFavorCfg.getBeautyInfoById(this._beautyInfo.id,1);this._skin.lab_power.string=i.fightAmount;var n=i.basePrize;0!=n&&(this._prizeInfo1.setupById(n),this._prizeList1.setData(this._prizeInfo1)),this._skillIcon.setBeautySkillData(this._beautyInfo.id),this._skillIcon.show()}},onClickBtn:function(){game.pay.showPayPanel()},showModel:function(){if(this._beautyInfo){this._animModel||(this._animModel=b8e.Animator.get(1,1),this._animModel.addToParent(this._skin.model_beauty));var e=game.ClientCfg.getBeauty(this._beautyInfo.res);e?(this._animModel.load(e),this._animModel.play()):this._animModel&&this._animModel.clear()}}})},{}],929:[function(e,t,i){"use strict";(game.VipSender=function(){}).reqVipPrize=function(e){var t=game.pbmsg.VipPrizeRequest;t.lv=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Recharge.VipPrizeRequest;b8e.sendN(i)}},{}],930:[function(e,t,i){"use strict";e("./VipSender")},{"./VipSender":929}],931:[function(e,t,i){"use strict";e("./manager/managerIndex_87"),e("./cmdlistener/cmdlistenerIndex_87"),e("./sender/senderIndex_87")},{"./cmdlistener/cmdlistenerIndex_87":920,"./manager/managerIndex_87":923,"./sender/senderIndex_87":930}],932:[function(e,t,i){"use strict";game.appModule.AddShortcutPanel=game.SkinUIPanel.extends({_prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.onC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.addG(this,game.ShareEvent.UPDATE_ADD_SHORTCUT,this.onUpdatePanel),this.onUpdatePanel()},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.offC(this._skin.prizeBtn,this.clickBtn,this),b8e.evt.rmvG(this,game.ShareEvent.UPDATE_ADD_SHORTCUT,this.onUpdatePanel)},onUpdatePanel:function(){game.ShortcutMgr.inst().isShortcutSuccess?(this._skin.btn.active=!1,this._skin.prizeBtn.active=!0):(this._skin.btn.active=!0,this._skin.prizeBtn.active=!1)},initPanel:function(){if(!this._prizeList){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this._prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_SHORTCUT_PRIZE);e.setupById(t),this._prizeList.setData(e)}},clickBtn:function(){game.ShortcutMgr.inst().clickAddShortcut()}})},{}],933:[function(e,t,i){"use strict";game.appModule.BlueDiamondPanel=game.SkinUIPanel.extends({_bgImg:null,_btnOpenImg:null,_list:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.DiamondItem)),this._list.show(),this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this._skin.imgBg),this._bgImg.setAnchor(.5,.5),this._bgImg.loadTexture(game.ClientCfg.blueDiamondBgUrl,null,null,{useManifest:!1})),this._btnOpenImg||(this._btnOpenImg=b8e.Sprite.get(),this._btnOpenImg.addToParent(this._skin.btn_open),this._btnOpenImg.setAnchor(.5,.5),this._btnOpenImg.loadTexture(game.ClientCfg.blueDiamondBtnOpenUrl,null,null,{useManifest:!1})),b8e.evt.onC(this._skin.toggle[0].node,this.onNewGiftBag,this),b8e.evt.onC(this._skin.toggle[1].node,this.onDailyGiftBag,this),b8e.evt.onC(this._skin.toggle[2].node,this.onUpLevelGiftBag,this),b8e.evt.onC(this._skin.toggle[3].node,this.onLuxuryGiftBag,this),b8e.evt.onC(this._skin.toggle[4].node,this.onYearsGiftBag,this),b8e.evt.onC(this._skin.toggle[5].node,this.onPrivilegeShow,this),b8e.evt.onC(this._skin.btn_open,this.onRenewal,this)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.toggle[0].node,this.onNewGiftBag,this),b8e.evt.offC(this._skin.toggle[1].node,this.onDailyGiftBag,this),b8e.evt.offC(this._skin.toggle[2].node,this.onUpLevelGiftBag,this),b8e.evt.offC(this._skin.toggle[3].node,this.onLuxuryGiftBag,this),b8e.evt.offC(this._skin.toggle[4].node,this.onYearsGiftBag,this),b8e.evt.offC(this._skin.toggle[5].node,this.onPrivilegeShow,this),b8e.evt.offC(this._skin.btn_open,this.onRenewal,this)},onNewGiftBag:function(){},onDailyGiftBag:function(){},onUpLevelGiftBag:function(){},onLuxuryGiftBag:function(){},onYearsGiftBag:function(){},onPrivilegeShow:function(){},onRenewal:function(){}})},{}],934:[function(e,t,i){"use strict";game.DiamondItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("wanba/DiamondItemSkin","DiamondItemSkin")},getWidth:function(){return 395},getHeight:function(){return 120},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_95,game.IcoSizeEnum.SIZE_95,game.IconScale.PERCENT_80),this._prizeList.addToParent(this._skin.prize)),this.setData(this._data),b8e.evt.onC(this._skin.btn_get,this.onGetAwards,this),b8e.evt.onC(this._skin.btn_no_get,this.onNoGetAwards,this)},onHide:function(){b8e.evt.offC(this._skin.btn_get,this.onGetAwards,this),b8e.evt.offC(this._skin.btn_no_get,this.onNoGetAwards,this)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=game.ccfg.WorldBossAwardCfg.getCfgByLevel();t&&(this._prizeInfo.setupById(t.activityShowPrize),this._prizeList.setData(this._prizeInfo)),this._skin.lab_desc.string="蓝钻Lv5可领取"}},onGetAwards:function(){},onNoGetAwards:function(){}})},{}],935:[function(e,t,i){"use strict";game.appModule.FocusPanel=game.SkinUIPanel.extends({_prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.onC(this._skin.prizeBtn,this.clickBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.offC(this._skin.prizeBtn,this.clickBtn,this)},onRefresh:function(){this.onUpdatePanel()},onUpdatePanel:function(){game.LoginConfig.isFocus?game.LoginConfig.isFocus&&game.welfare.isGetFocusPrize?(this._skin.btn.active=!1,this._skin.prizeBtn.active=!1,this._skin.isGetPrize.active=!0):(this._skin.btn.active=!1,this._skin.prizeBtn.active=!0,this._skin.isGetPrize.active=!1):(this._skin.btn.active=!0,this._skin.prizeBtn.active=!1,this._skin.isGetPrize.active=!1)},initPanel:function(){if(!this._prizeList){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6),this._prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.FOCUS_PRIZE);e.setupById(t),this._prizeList.setData(e)}},clickBtn:function(){game.LoginConfig.isFocus?(game.WelfareSender.sendFocusPrizeRequest(),this.hide()):game.sdk.focus()}})},{}],936:[function(e,t,i){"use strict";game.WanBaGameEvent=b8e.Enum({GET_WAB_BA_GAME_VIP_PRIZE:b8e.Event.nextCode()})},{}],937:[function(e,t,i){"use strict";game.appModule.WanbaPrizePanel=game.SkinUIPanel.extends({_prizeList:null,onShow:function(){this.initPanel(),b8e.evt.onC(this._skin.btn,this.clickBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this)},initPanel:function(){if(!this._prizeList){this._prizeList=new game.PrizeList(3,100,100,game.IconScale.PERCENT_100,6),this._prizeList.addToParent(this._skin.prize);var e=new game.PrizeInfo,t=game.ccfg.WanbaPrizeCfg.getData(game.LoginConfig.wanbaGiftId);if(t){var i=t.prizeId;e.setupById(i),this._prizeList.setData(e)}}},clickBtn:function(){b8e.Toast.launch("奖励领取成功，请到背包查看！"),this.hide()}})},{}],938:[function(e,t,i){"use strict";game.appModule.YellowDiamondPanel=game.SkinUIPanel.extends({_bgImg:null,_btnOpenImg:null,_list:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.DiamondItem)),this._list.show(),this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this._skin.imgBg),this._bgImg.setAnchor(.5,.5),this._bgImg.loadTexture(game.ClientCfg.yellowDiamondBgUrl,null,null,{useManifest:!1})),this._btnOpenImg||(this._btnOpenImg=b8e.Sprite.get(),this._btnOpenImg.addToParent(this._skin.btn_open),this._btnOpenImg.setAnchor(.5,.5),this._btnOpenImg.loadTexture(game.ClientCfg.yellowDiamondBtnOpenUrl,null,null,{useManifest:!1})),b8e.evt.onC(this._skin.toggle[0].node,this.onNewGiftBag,this),b8e.evt.onC(this._skin.toggle[1].node,this.onDailyGiftBag,this),b8e.evt.onC(this._skin.toggle[2].node,this.onUpLevelGiftBag,this),b8e.evt.onC(this._skin.toggle[3].node,this.onLuxuryGiftBag,this),b8e.evt.onC(this._skin.toggle[4].node,this.onYearsGiftBag,this),b8e.evt.onC(this._skin.toggle[5].node,this.onPrivilegeShow,this),b8e.evt.onC(this._skin.btn_open,this.onRenewal,this)},onHide:function(){this._list&&this._list.hide(),b8e.evt.offC(this._skin.toggle[0].node,this.onNewGiftBag,this),b8e.evt.offC(this._skin.toggle[1].node,this.onDailyGiftBag,this),b8e.evt.offC(this._skin.toggle[2].node,this.onUpLevelGiftBag,this),b8e.evt.offC(this._skin.toggle[3].node,this.onLuxuryGiftBag,this),b8e.evt.offC(this._skin.toggle[4].node,this.onYearsGiftBag,this),b8e.evt.offC(this._skin.toggle[5].node,this.onPrivilegeShow,this),b8e.evt.offC(this._skin.btn_open,this.onRenewal,this)},onNewGiftBag:function(){},onDailyGiftBag:function(){},onUpLevelGiftBag:function(){},onLuxuryGiftBag:function(){},onYearsGiftBag:function(){},onPrivilegeShow:function(){},onRenewal:function(){}})},{}],939:[function(e,t,i){"use strict";e("./WanbaPrizePanel"),e("./AddShortcutPanel"),e("./FocusPanel"),e("./WanBaGameEvent"),e("./DiamondItem"),e("./BlueDiamondPanel"),e("./YellowDiamondPanel")},{"./AddShortcutPanel":932,"./BlueDiamondPanel":933,"./DiamondItem":934,"./FocusPanel":935,"./WanBaGameEvent":936,"./WanbaPrizePanel":937,"./YellowDiamondPanel":938}],940:[function(e,t,i){"use strict";game.WanbaPrizeType=b8e.Enum({WANBA_FIRST:0,WANBA_DAILY:1,WANBA_PF_VIP:2,WANBA_GAME_VIP:3,WANBA_QZONE:4,WANBA_INTEGRAL:5})},{}],941:[function(e,t,i){"use strict";game.WanBaGameVipEvent=b8e.Enum({UPDATE_WANBAPRIZELIST:b8e.Event.nextCode()})},{}],942:[function(e,t,i){"use strict";game.WanBaGameVipItem=game.SkinUI.extends({m_data:null,_prizeList:null,ctor:function(){this._super("wanbagamevip/WanBaGameVipItemSkin","WanBaGameVipItemSkin"),this._prizeInfo=new game.PrizeInfo},init:function(){this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3)},onShow:function(){this.m_data&&(this.setData(this.m_data),b8e.evt.onC(this._skin.getPrizeBnt,this.onClickGetPrizeBnt,this))},onHide:function(){b8e.evt.offC(this._skin.getPrizeBnt,this.onClickGetPrizeBnt,this)},onClickGetPrizeBnt:function(){game.welfare.collectedWanbaGameVipPrize||this.m_data&&game.WelfareSender.wanbaPrizeRequest(this.m_data.id)},getHeight:function(){return 173},getWidth:function(){return 543},setData:function(e){e&&(this.m_data=e,this._skin&&this._prizeList&&(this._prizeList.addToParent(this._skin.prizeNode),this._prizeInfo.setupById(e.prizeId),this._prizeList.setData(this._prizeInfo),this.m_data.vip==game.LoginConfig.wanBaGameVipLevel?(this._skin.prizeDescLab.string="当前VIP等级可领取特权礼包内容",this._skin.getPrizeBnt.active=!0,game.welfare.collectedWanbaGameVipPrize?(this._skin.getPrizeLab.string="已领取",b8e.ShaderUtil.setGray(this._skin.getPrizeBnt)):(this._skin.getPrizeLab.string="领取",b8e.ShaderUtil.reset(this._skin.getPrizeBnt))):(this.m_data.vip<game.LoginConfig.wanBaGameVipLevel?this._skin.prizeDescLab.string="上一档VIP等级可领取特权礼包内容":this.m_data.vip>game.LoginConfig.wanBaGameVipLevel&&(this._skin.prizeDescLab.string="下一档VIP等级可领取特权礼包内容"),this._skin.getPrizeBnt.active=!1,this._skin.getPrizeLab.string="...",b8e.ShaderUtil.reset(this._skin.getPrizeBnt))))}})},{}],943:[function(e,t,i){"use strict";game.appModule.WanBaGameVipPanel=game.SkinUIPanel.extends({_list:null,ctor:function(e){this._super(e)},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.WanBaGameVipItem)),this._list.show(),this.updateWanBaItems(),game.QzoneSDK.getGameVipLevel(this.updateWanBaItems,this),b8e.evt.addG(this,game.WanBaGameEvent.GET_WAB_BA_GAME_VIP_PRIZE,this.updateWanBaItems)},onHide:function(){b8e.evt.rmvG(this,game.WanBaGameEvent.GET_WAB_BA_GAME_VIP_PRIZE,this.updateWanBaItems),this._list&&this._list.hide()},updateWanBaItems:function(){this._skin.selfVipLab.string="VIP"+game.LoginConfig.wanBaGameVipLevel;var e=game.ccfg.WanBaGameVipCfg.getWanBaGameVipDatas();this._list.setData(e)}})},{}],944:[function(e,t,i){"use strict";game.WanfaItemType=b8e.Enum({CAILIAOBAOKU:1,JINGYINBOOS:2,TIANTIANZHANGYAO:3,FENGSHENBANG:4,QUANMINGBOSS:5,SURA:6,SANZAHNGJIANGJIN:7,WORLDBOSS:8,CS_ARENA:9,CS_SURA:12,TOWER:13,ESCORT:10,CHUMO:15})},{}],945:[function(e,t,i){"use strict";game.WanfaMgr=b8e.Object.extends({name:"WanfaMgr",page:1,ctor:function(){if(1==game.WanfaMgr._singleton)throw new Error("WanfaMgr 只能通过单例方法获取")},getWanfaArr:function(){return game.ccfg.WanfaCfg.getWanfaArrByType(this.page)}}),game.WanfaMgr._instance=null,game.WanfaMgr._singleton=!0,game.WanfaMgr.inst=function(){return game.WanfaMgr._instance||(game.WanfaMgr._singleton=!1,game.WanfaMgr._instance=new game.WanfaMgr,game.WanfaMgr._singleton=!0),game.WanfaMgr._instance}},{}],946:[function(e,t,i){"use strict";game.appModule.WanfaArenaPanel=game.SkinUIPanel.extends({_thisServer:null,_crossServer:null,_index:-1,ctor:function(e){this._super(e)},init:function(){this._thisServer||(this._thisServer=new game.WanfaThisServerPanel,this._thisServer.addToParent(this._skin.page)),this._crossServer||(this._crossServer=new game.WanfaCrossServerPanel,this._crossServer.addToParent(this._skin.page))},onShow:function(){this.data&&(this._index=Math.max(this.data,0)),this._index=Math.max(this.data,0),this.onSelectPanelByIndex(this._index),this.changeRedPoint(),this.onUpdateAmountInfo(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickThisServerBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickCrossServerBtn,this),b8e.evt.onC(this._skin.btn_exchange,this.onGotoHonourStore,this),b8e.evt.addG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateAmountInfo),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.CSArenaEvent.GET_INFO,this.changeRedPoint)},onHide:function(){b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickThisServerBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickCrossServerBtn,this),b8e.evt.offC(this._skin.btn_exchange,this.onGotoHonourStore,this),b8e.evt.rmvG(this,game.AmountEvents.AMOUNT_UPDATE,this.onUpdateAmountInfo),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.CSArenaEvent.GET_INFO,this.changeRedPoint)},hidePanel:function(){this._thisServer.hide(),this._crossServer.hide(),this._index=-1},changeRedPoint:function(){this._skin.crossServerPoint.active||(this._skin.crossServerPoint.active=game.csArena.getCanGetLevelPrize())},onClickThisServerBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickCrossServerBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onGotoHonourStore:function(){b8e.log("准备跳转荣誉商店"),game.app.show(game.AppConstant.SHOP_PANEL,game.ShopType.Honour),b8e.log("结束跳转荣誉商店")},onUpdateAmountInfo:function(){var e=game.back.getAmountInfo();if(e){var t=e.getValue(game.AmountType.HONOUR);this._skin.lab_honour.string=game.ValueUtil.formatNumber(t,0,!1,!1,!1,!1)}b8e.log("当前荣誉令数量：")},onSpotAlertChange:function(){this._skin&&(this._skin.thisServerPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_WANFA_ARENA_THISSERVER_ALERT),this._skin.crossServerPoint.active=!1)},onSelectPanelByIndex:function(e){switch(this.hidePanel(),this._index=e,game.wanfa.page=e+2,this._skin.title.string=game.ClientCfg.wanfa_arena,e){case 0:this._skin.buttonToggle[e].check(),this._thisServer.show();break;case 1:this._skin.buttonToggle[e].check(),this._crossServer.show()}},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(0|e),this._skin.buttonToggle[e]):"1"!=e||(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(0|e),this._skin.buttonToggle[e]))},getButtonByName:function(e){var t=null;switch(e){case game.ClientCfg.arenaThisServer:this._skin&&(t=this._skin.buttonToggle[0].node);break;case game.ClientCfg.arenaCrossServer:this._skin&&(t=this._skin.buttonToggle[1].node);break;case"arena":if(this._skin&&this._thisServer&&(t=this._thisServer.getButtonByName("arena")))return t}return t}})},{}],947:[function(e,t,i){"use strict";game.WanfaCrossServerPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaCrossServerSkin","WanfaCrossServerSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},getButtonByName:function(e){switch(e){case"arena":if(this._list){var t=this._list.getItemRender(3);if(t){var i=t.getButtonByName("node_click");if(i)return i}}return!0}return null},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],948:[function(e,t,i){"use strict";game.WanfaCrossServerPanle=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaCrossServerSkin","WanfaCrossServerSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],949:[function(e,t,i){"use strict";game.WanfaDoublePanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaDoubleSkin","WanfaDoubleSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],950:[function(e,t,i){"use strict";game.WanfaItem=game.SkinUI.extends({_list:null,_wanfaInfo:null,_cardSprite:null,ctor:function(){this._super("wanfa/WanfaItemSkin","WanfaItemSkin")},onShow:function(){this.setData(this._wanfaInfo),b8e.evt.onC(this._skin.node_click,this.onClick,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},onHide:function(){b8e.evt.offC(this._skin.node_click,this.onClick,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange)},getButtonByName:function(e){switch(e){case"node_click":return!this._skin||this._skin.node_click}return null},setData:function(e){if(this._wanfaInfo=e,this._skin&&this._wanfaInfo){this._cardSprite||(this._cardSprite=b8e.Sprite.get(),this._cardSprite.addToParent(this._skin.node_img),this._cardSprite.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!0),null,null,{useManifest:!1})),""!=e.timeDesc&&(this._skin.lab_desc.string=e.timeDesc);var t=game.ccfg.ClientTriggerCfg.getDataById(e.triggerId);if(t){var i=game.ccfg.ClientCommandCfg.getDataById(t.triggerCommandIds);if(i&&i.functionOpenId){var n=game.ccfg.ClientFunctionOpenCfg.getDataById(i.functionOpenId);if(n){var s="";if(-1<(s=n.closeTips).indexOf("{TaskDiffSeq}")){var a,o=0,r=game.quest.questInfo;r&&(o=r.sequence);var h=n.questId;s=0<(a=((r=0<h?game.ccfg.MainQuestCfg.getQuestById(h):null)?r.sequence:0)-o+1)?s.replace("{TaskDiffSeq}",a):""}game.mainRole.mainRoleData.getLv()<n.minLevel?this._skin.lab_task.string=s:this._skin.lab_task.string=""}}}}},onSpotAlertChange:function(){this._skin&&this._wanfaInfo&&(this._skin.red_point.active=this.isShowRedPoint(this._wanfaInfo.id))},isShowRedPoint:function(e){var t=!1;if(!this._wanfaInfo)return t;switch(e){case game.WanfaItemType.FENGSHENBANG:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ARENA_ALERT);break;case game.WanfaItemType.SURA:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.SURA_ALERT);break;case game.WanfaItemType.SANZAHNGJIANGJIN:t=game.sceneRole.isInBubbleExp;break;case game.WanfaItemType.CS_SURA:t=game.sura.isCsSuraOpen();break;case game.WanfaItemType.CS_ARENA:t=game.csArena.csArenaAlert();break;case game.WanfaItemType.ESCORT:t=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ESCORT_ALERT)}return t},onClick:function(){if(this._wanfaInfo.id!=game.WanfaItemType.CS_SURA){if(this._wanfaInfo.id==game.WanfaItemType.CS_ARENA)if(null==game.bianshen.getHasBianshenSlotIndex())return void game.notice.show(26008);if(this._wanfaInfo.id==game.WanfaItemType.ESCORT&&!game.escort.isOpen()){var e=game.escort.getEscortInfo();if(e){var t=b8e.TimeUtil.formatTimestamp(e.openTime,game.ccfg.LangCfg.getText(79026));return void game.notice.show(t)}}this._wanfaInfo.triggerId&&game.TriggerMgr.inst().customTriggerById(this._wanfaInfo.triggerId),this._wanfaInfo.functionId&&game.funcOpen.checkOpen(this._wanfaInfo.functionId)&&(game.app.hide(game.AppConstant.CHALLANGE_PANEL),game.app.hide(game.AppConstant.WANFA_ARENA_PANEL))}else game.sura.suraOverViewUpdata(!0)},getHeight:function(){return 153},getWidth:function(){return 540}})},{}],951:[function(e,t,i){"use strict";game.WanfaLimitPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaLimitSkin","WanfaLimitSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],952:[function(e,t,i){"use strict";game.appModule.WanfaPanel=game.SkinUIPanel.extends({solo:null,limit:null,crossSever:null,_index:-1,ctor:function(e){this._super(e)},init:function(){this.solo||(this.solo=new game.WanfaSoloPanel,this.solo.addToParent(this._skin.page)),this.limit||(this.limit=new game.WanfaLimitPanel,this.limit.addToParent(this._skin.page)),this.crossSever||(this.crossSever=new game.WanfaCrossServerPanle,this.crossSever.addToParent(this._skin.page))},onShow:function(){this.data&&(this._index=this.data),-1==this._index&&(this._index=0),this.onSelectPanelByIndex(this._index),this.changeRedPoint(),b8e.evt.onC(this._skin.buttonToggle[0].node,this.onClickSoloBtn,this),b8e.evt.onC(this._skin.buttonToggle[1].node,this.onClickLimitBtn,this),b8e.evt.onC(this._skin.buttonToggle[2].node,this.onClickCrossSeverBtn,this),b8e.evt.addG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.addG(this,game.CSArenaEvent.GET_INFO,this.changeRedPoint)},onHide:function(){this.hidePanel(),b8e.evt.offC(this._skin.buttonToggle[0].node,this.onClickSoloBtn,this),b8e.evt.offC(this._skin.buttonToggle[1].node,this.onClickLimitBtn,this),b8e.evt.offC(this._skin.buttonToggle[2].node,this.onClickCrossSeverBtn,this),b8e.evt.rmvG(this,game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE,this.onSpotAlertChange),b8e.evt.rmvG(this,game.CSArenaEvent.GET_INFO,this.changeRedPoint)},hidePanel:function(){this.solo.hide(),this.limit.hide(),this.crossSever.hide(),this._index=-1},changeRedPoint:function(){this._skin.csPoint.active=game.csArena.getCanGetLevelPrize()},onClickSoloBtn:function(){0!=this._index&&this.onSelectPanelByIndex(0)},onClickLimitBtn:function(){1!=this._index&&this.onSelectPanelByIndex(1)},onClickCrossSeverBtn:function(){2!=this._index&&this.onSelectPanelByIndex(2)},onSelectPanelByIndex:function(e){switch(this.hidePanel(),this._index=e,game.wanfa.page=e){case 0:this._skin.buttonToggle[e].check(),this._skin.title.string="个人玩法",this.solo.show()}},setTab:function(e){return!!this._skin&&("0"==e?(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(e),this._skin.buttonToggle[e]):"1"==e?(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(e),this._skin.buttonToggle[e]):"2"!=e||(this._skin.buttonToggle[e].check(),this.onSelectPanelByIndex(e),this._skin.buttonToggle[e]))},getButtonByName:function(e){var t;switch(e){case"solo":return!this._skin||!(t=this._skin.buttonToggle[0].node)||t;case"limit":return!this._skin||!(t=this._skin.buttonToggle[1].node)||t;case"crossSever":return!this._skin||!(t=this._skin.buttonToggle[2].node)||t;case"arena":return!(this._skin&&this.solo&&(t=this.solo.getButtonByName("arena")))||t;case"material":return!(this._skin&&this.solo&&(t=this.solo.getButtonByName("material")))||t}return null},onSpotAlertChange:function(){this._skin&&(this._skin.soloPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_FIGHT_ALERT),this._skin.limitPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_XIANSHI_ALERT),this._skin.csPoint.active=game.spotAlert.getSpotAlertState(game.SpotAlertTargetType.ROOT_KUAFU_ALERT))}})},{}],953:[function(e,t,i){"use strict";game.WanfaSoloPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaSoloSkin","WanfaSoloSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},getButtonByName:function(e){switch(e){case"material":if(this._list)if(t=this._list.getItemRender(0))if(i=t.getButtonByName("node_click"))return i;return!0;case"arena":var t,i;if(this._list)if(t=this._list.getItemRender(3))if(i=t.getButtonByName("node_click"))return i;return!0}return null},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],954:[function(e,t,i){"use strict";game.WanfaThisServerPanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("wanfa/WanfaCrossServerSkin","WanfaCrossServerSkin")},init:function(){this._list=new b8e.List(this._skin.list,game.WanfaItem)},onShow:function(){this._list.show(),this.updatePanel()},onHide:function(){this._list&&this._list.hide()},getButtonByName:function(e){switch(e){case"arena":if(this._list){var t=this._list.getItemRender(0);if(t){var i=t.getButtonByName("node_click");if(i)return i}}return!0}return null},updatePanel:function(){var e=game.wanfa.getWanfaArr();this._list.setData(e)}})},{}],955:[function(e,t,i){"use strict";game.appModule.WxAddShortcutPanel=game.SkinUIPanel.extends({_bgImg:null,onShow:function(){if(this._bgImg||(this._bgImg=b8e.Sprite.get(),this._bgImg.addToParent(this._skin.bgImg),this._bgImg.setAnchor(.5,.5)),this._bgImg.loadTexture(game.ClientCfg.wxAddShortcutImgUrl,null,null,{useManifest:!1}),this._skin.btn.active=!1,b8e.isWeChatGame)if(game.LoginConfig.wxScene)this.updateBtnState(game.LoginConfig.wxScene);else{var e=wx.getLaunchOptionsSync();e&&(b8e.log("微信小游戏收藏scene："+e.scene),this.updateBtnState(e.scene))}b8e.evt.onC(this._skin.btn,this.clickBtn,this),b8e.evt.addG(this,game.ShareEvent.UPDATE_WX_ADD_SHORTCUT,this.onUpdatePanel),b8e.evt.addG(this,game.ShareEvent.UPDATE_WX_ADD_SHORTCUT_BTN_STATE,this.updateBtnState)},onHide:function(){b8e.evt.offC(this._skin.btn,this.clickBtn,this),b8e.evt.rmvG(this,game.ShareEvent.UPDATE_WX_ADD_SHORTCUT,this.onUpdatePanel),b8e.evt.rmvG(this,game.ShareEvent.UPDATE_WX_ADD_SHORTCUT_BTN_STATE,this.updateBtnState)},updateBtnState:function(e){b8e.log("小游戏回到前台，更新按钮状态--scene："+e);var t=wx.getSystemInfoSync();if(t){var i=/iPad|iPhone|iOS|iPod/.test(t.system),n=-1<t.system.indexOf("Android");i&&1104==e?(this._skin.btn.active=!0,this.onUpdatePanel()):n&&1023==e&&(this._skin.btn.active=!0,this.onUpdatePanel())}},onUpdatePanel:function(){game.welfare.isGetAddShortcutPrize?b8e.ShaderUtil.setGray(this._skin.btn):b8e.ShaderUtil.reset(this._skin.btn)},clickBtn:function(){game.ShortcutMgr.inst().clickAddShortcut()}})},{}],956:[function(e,t,i){"use strict";game.appModule.WxFocusPanel=game.SkinUIPanel.extends({_bgImg:null,onShow:function(){},onHide:function(){},updateBtnState:function(e){b8e.log("小游戏回到前台，更新按钮状态--scene："+e);var t=wx.getSystemInfoSync();if(t){var i=/iPad|iPhone|iOS|iPod/.test(t.system),n=-1<t.system.indexOf("Android");i&&1104==e?(this._skin.btn.active=!0,this.onUpdatePanel()):n&&1023==e&&(this._skin.btn.active=!0,this.onUpdatePanel())}},onUpdatePanel:function(){game.welfare.isGetAddShortcutPrize?b8e.ShaderUtil.setGray(this._skin.btn):b8e.ShaderUtil.reset(this._skin.btn)},clickBtn:function(){game.ShortcutMgr.inst().clickAddShortcut()}})},{}],957:[function(e,t,i){"use strict";e("./panel/WxAddShortcutPanel"),e("./panel/WxFocusPanel")},{"./panel/WxAddShortcutPanel":955,"./panel/WxFocusPanel":956}],958:[function(e,t,i){"use strict";game.appModule.WelcomePanel=game.SkinUIPanel.extends({_welcomeImg:null,_btnImg:null,ctor:function(e){this._super(e)},init:function(){this._welcomeImg=b8e.Sprite.get(),this._welcomeImg.setAnchor(.5,.5),this._welcomeImg.addToParent(this._skin.welcomeBg),this._welcomeImg.loadTexture(game.ClientCfg.welcomeBgUrl,null,null,{useManifest:!1}),b8e.Tween.kill(this),b8e.Tween.get(this).wait(1e4).call(this.onWelcome,this)},getButtonByName:function(e,t){switch(e){case"welcome":return!this._skin||this._skin.welcomeBtn}return null},onShow:function(){b8e.evt.onC(this._skin.welcomeBtn,this.onWelcome,this)},onHide:function(){b8e.Tween.kill(this),b8e.evt.offC(this._skin.welcomeBtn,this.onWelcome,this)},onWelcome:function(){game.quest.onClickQuest(),game.app.isShow(game.AppConstant.WELCOME_PANEL)&&game.app.hide(game.AppConstant.WELCOME_PANEL)}})},{}],959:[function(e,t,i){"use strict";game.RetrieveCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Retrieve.RetrieveModuleProto,this.onRetrieveModuleProto,this),b8e.addNH(game.pbmid.Retrieve.SingleRetrieveResponse,this.onSingleRetrieveResponse,this),b8e.addNH(game.pbmid.Retrieve.BatchRetrieveResponse,this.onBatchRetrieveResponse,this)},onBatchRetrieveResponse:function(e){var t=e.readProtobuf(game.pbmsg.BatchRetrieveResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.retrieve.retrieveAllRp())},onSingleRetrieveResponse:function(e){var t=e.readProtobuf(game.pbmsg.SingleRetrieveResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.retrieve.retrieveByTypeRp(t))},onRetrieveModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.RetrieveModuleProto);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.retrieve.initDatas(t))}})},{}],960:[function(e,t,i){"use strict";game.WelfareCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Welfare.WelfareModuleProto,this.onWelfareModuleProto,this),b8e.addNH(game.pbmid.Welfare.ConvertGoldResponse,this.onConvertGoldResponse,this),b8e.addNH(game.pbmid.Welfare.SignResponse,this.onSignResponse,this),b8e.addNH(game.pbmid.Welfare.ShareAwardResponse,this.onShareAwardResponse,this),b8e.addNH(game.pbmid.Welfare.SendDesktopPrizeResponse,this.onSendDesktopPrizeResponse,this),b8e.addNH(game.pbmid.Welfare.WanbaPrizeResponse,this.onWanbaPrizeResponse,this),b8e.addNH(game.pbmid.Welfare.FocusPrizeResponse,this.onFocusPrizeResponse,this),b8e.addNH(game.pbmid.Welfare.ExchangeCouponResponse,this.onExchangeCouponResponse,this),b8e.addNH(game.pbmid.Welfare.MicroPrizeResponse,this.onMicroPrizeResponse,this),b8e.addNH(game.pbmid.Welfare.CollectOnlineAwardResponse,this.onCollectOnlineAwardResponse,this),b8e.addNH(game.pbmid.Welfare.MillionAwardNotify,this.onMillionAwardNotify,this),b8e.addNH(game.pbmid.Welfare.MillionAwardDataResponse,this.onMillionAwardDataResponse,this),b8e.addNH(game.pbmid.Welfare.MillionAwardResponse,this.onMillionAwardResponse,this),b8e.addNH(game.pbmid.Welfare.WeekSignResponse,this.onWeekSignResponse,this),b8e.addNH(game.pbmid.Welfare.MondayAwardCollectResponse,this.onMondayAwardCollectResponse,this),b8e.addNH(game.pbmid.Welfare.VerifyAwardResponse,this.onRealVerifyPrizeResponse,this),b8e.addNH(game.pbmid.Welfare.JDAwardResponse,this.onJDAwardResponse,this)},onWeekSignResponse:function(e){var t=e.readProtobuf(game.pbmsg.WeekSignResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.welfare.weekSignResponse(t.weekSignDays))},onShareAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.ShareAwardResponse);if(t){if(b8e.log("onShareAwardResponse Code:"+t.code),0<t.code){var i=new game.GameAlertInfo;return i.alertType=game.GameAlertType.OneBtn,i.string=game.ccfg.ServerCodeCfg.getDesc(t.code),i.isShowTips=!1,void game.gameAlert.showAlert(this,null,i)}game.ShareMgr.inst().getPrizeSuccess()}},onSendDesktopPrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.SendDesktopPrizeResponse);if(t){if(b8e.log("onSendDesktopPrizeResponse Code:"+t.code),0<t.code){var i=new game.GameAlertInfo;return i.alertType=game.GameAlertType.OneBtn,i.string=game.ccfg.ServerCodeCfg.getDesc(t.code),i.isShowTips=!1,void game.gameAlert.showAlert(this,null,i)}game.ShortcutMgr.inst().prizeResponseSuccess()}},onWanbaPrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.WanbaPrizeResponse);if(t){b8e.log("onWanbaPrizeResponse Code:"+t.code);var i=game.ccfg.WanBaGameVipCfg.getWanBaDataById(t.id);if(i){var n;if(i.prizeType==game.WanbaPrizeType.WANBA_GAME_VIP)if(0==t.code)game.welfare.collectedWanbaGameVipPrize=!0,b8e.evt.dptG(game.WanBaGameEvent.GET_WAB_BA_GAME_VIP_PRIZE);else(n=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,n.string=game.ccfg.ServerCodeCfg.getDesc(t.code),n.isShowTips=!1,game.gameAlert.showAlert(this,null,n);else if(0==t.code)game.app.show(game.AppConstant.WANBA_PRIZE_PANEL);else(n=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,n.string=game.ccfg.ServerCodeCfg.getDesc(t.code),n.isShowTips=!1,game.gameAlert.showAlert(this,null,n)}else{var s="玩吧福利没有配置，ID:"+t.id;b8e.Toast.launch(s),b8e.error(s)}}},onFocusPrizeResponse:function(e){var t,i=e.readProtobuf(game.pbmsg.FocusPrizeResponse);i&&(b8e.log("onFocusPrizeResponse Code:"+i.code),0==i.code?(game.welfare.isGetFocusPrize=!0,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),(t=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,t.string="奖励领取成功，请到背包查看！"):((t=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,t.string=game.ccfg.ServerCodeCfg.getDesc(i.code)),t.isShowTips=!1,game.gameAlert.showAlert(this,null,t))},onExchangeCouponResponse:function(e){var t=e.readProtobuf(game.pbmsg.ExchangeCouponResponse);if(t){var i;if(b8e.log("onExchangeCouponResponse Code:"+t.code),0<t.code)return(i=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,i.string=game.ccfg.ServerCodeCfg.getDesc(t.code),i.isShowTips=!1,void game.gameAlert.showAlert(this,null,i);(i=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,i.string="领取奖励成功",i.isShowTips=!1,game.gameAlert.showAlert(this,null,i)}},onMicroPrizeResponse:function(e){var t=e.readProtobuf(game.pbmsg.MicroPrizeResponse);t&&(b8e.log("onMicroPrizeResponse Code:"+t.code),0==t.code&&game.app.show(game.AppConstant.MICRO_PANEL))},onWelfareModuleProto:function(e){var t=e.readProtobuf(game.pbmsg.WelfareModuleProto);game.welfare.synWelfareInfo(t)},onConvertGoldResponse:function(e){var t=e.readProtobuf(game.pbmsg.ConvertGoldResponse);0<t.code?game.notice.show("服务器发生错误："+t.code):game.welfare.synIsCrit(t.isCrit)},onSignResponse:function(e){var t=e.readProtobuf(game.pbmsg.SignResponse);0<t.code?game.notice.show("服务器发生错误："+t.code):game.welfare.synSignInfo(t.signType,t.signDays)},onCollectOnlineAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.CollectOnlineAwardResponse);0<t.code?game.notice.show("服务器发生错误："+t.code):game.welfare.collectOnlineAward(t.time)},onMillionAwardNotify:function(e){var t=e.readProtobuf(game.pbmsg.MillionAwardNotify);t?0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.welfare.setMillionAwardState(t):b8e.log("百万元宝状态通知数据为空")},onMillionAwardDataResponse:function(e){var t=e.readProtobuf(game.pbmsg.MillionAwardDataResponse);t?0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.welfare.setMillionAwardData(t):b8e.log("百万元宝数据请求失败")},onMillionAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.MillionAwardResponse);t?0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.welfare.resMillionAward(t):b8e.log("请求瓜分元宝失败")},onMondayAwardCollectResponse:function(e){var t=e.readProtobuf(game.pbmsg.MondayAwardCollectResponse);t&&(0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.welfare.mondayAwardIsCollected=!0,b8e.evt.dptG(game.WelfareEvents.COLLECT_MONDAY_AWARD)))},onRealVerifyPrizeResponse:function(e){var t,i=e.readProtobuf(game.pbmsg.VerifyAwardResponse);i&&(0==i.code?(game.welfare.isGetVerifyPrize=!0,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),(t=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,t.string="奖励领取成功，请到背包查看！"):((t=new game.GameAlertInfo).alertType=game.GameAlertType.OneBtn,t.string=game.ccfg.ServerCodeCfg.getDesc(i.code)),t.isShowTips=!1,game.gameAlert.showAlert(this,null,t))},onJDAwardResponse:function(e){var t=e.readProtobuf(game.pbmsg.JDAwardResponse);if(t){var i=new game.GameAlertInfo;0<t.code?(i.alertType=game.GameAlertType.OneBtn,i.string=game.ccfg.ServerCodeCfg.getDesc(t.code)):(game.welfare.isCollectedJDPrize=!0,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.COLLECT_JD_AWARD),i.alertType=game.GameAlertType.OneBtn,i.string="奖励领取成功，请到背包查看！"),i.isShowTips=!1,game.gameAlert.showAlert(this,null,i)}}})},{}],961:[function(e,t,i){"use strict";e("./WelfareCmd")},{"./WelfareCmd":960}],962:[function(e,t,i){"use strict";game.RetrieveType=b8e.Enum({RETRIEVE_NONE:0,RETRIEVE_MOUNT:4,RETRIEVE_WING:5,RETRIEVE_GOLD:6,RETRIEVE_FABAO:7,RETRIEVE_STAR:8,RETRIEVE_EXP:9,RETRIEVE_XIANZHEN:13})},{}],963:[function(e,t,i){"use strict";game.SignType=b8e.Enum({NORMAL_TURN:1,NEW_TURN:101})},{}],964:[function(e,t,i){"use strict";game.WelfareType=b8e.Enum({COVER_PANEL:1,SIGN_PANEL:2,FUND_PANEL:3,CDKEY_PANEL:4,ONLINE_PANEL:5,FORESHOW_PANEL:6,FAQ_PANEL:7,ROULETTE:8,MONDAY:9,VIP_ROULETTE:10,WEEK_SIGN_PANEL:11,RETRIEVE_PANEL:12})},{}],965:[function(e,t,i){"use strict";e("./SignType"),e("./WelfareType")},{"./SignType":963,"./WelfareType":964}],966:[function(e,t,i){"use strict";game.RetrieveEvent=b8e.Enum({DATAS_CHANGE:b8e.Event.nextCode()})},{}],967:[function(e,t,i){"use strict";game.WelfareEvents=b8e.Enum({COVER_GLOD_SUCCESS:b8e.Event.nextCode(),CHANGE_TURN:b8e.Event.nextCode(),SIGN_SUCCESS:b8e.Event.nextCode(),COLLECT_ONLINE_SUCCESS:b8e.Event.nextCode(),WELFARE_BTN_CHANGE:b8e.Event.nextCode(),UPDATE_MILLIONAWARDPANEL:b8e.Event.nextCode(),WEEK_SIGN_SUCCESS:b8e.Event.nextCode(),COLLECT_MONDAY_AWARD:b8e.Event.nextCode(),INIT_SELECT_TYPE:b8e.Event.nextCode(),COLLECT_JD_AWARD:b8e.Event.nextCode()})},{}],968:[function(e,t,i){"use strict";e("./WelfareEvents")},{"./WelfareEvents":967}],969:[function(e,t,i){"use strict";game.RetrieveMgr=b8e.Object.extends({retrieveDatas:null,_isInit:!1,moneyRatio:.6,goldRatio:1,retrieveCostItem:0,ctor:function(){this._super(),this.retrieveDatas=[]},getDatas:function(){this._isInit?b8e.evt.dptG(game.RetrieveEvent.DATAS_CHANGE):game.RetrieveSender.getDatas()},initDatas:function(e){var t;this._isInit=!0,this.retrieveCostItem=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.RETRIEVE_COST_ITEM),this.moneyRatio=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.RETRIEVE_MONEY_RETIO),this.goldRatio=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.RETRIEVE_GLOD_RETIO);for(var i=this.retrieveDatas.length=0,n=e.retrieve.length;i<n;i++)(t=e.retrieve[i])&&game.ccfg.WelfareRetrieveCfg.getDataById(t.retrieveType)&&this.retrieveDatas.push(t);b8e.evt.dptG(game.RetrieveEvent.DATAS_CHANGE),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE)},getAllRetrieveCost:function(e){var t,i,n=0;if(!this.retrieveDatas||0==this.retrieveDatas.length)return n;for(var s=0,a=this.retrieveDatas.length;s<a;s++)!(t=this.retrieveDatas[s])||t.count<=0||(i=game.ccfg.WelfareRetrieveCfg.getDataById(t.retrieveType))&&(n+=e?i.goldCost*t.count:i.diamondCost*t.count);return n},getMaxCountByType:function(e){var t=0,i=game.VipMgr.inst().getRetrieveDays();switch(e){case game.RetrieveType.RETRIEVE_MOUNT:case game.RetrieveType.RETRIEVE_WING:case game.RetrieveType.RETRIEVE_GOLD:case game.RetrieveType.RETRIEVE_FABAO:case game.RetrieveType.RETRIEVE_STAR:case game.RetrieveType.RETRIEVE_EXP:case game.RetrieveType.RETRIEVE_XIANZHEN:t=i*game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MATERIAL_MAX_FIGHT_COUNT);break;default:b8e.warn("getMaxCountByType传入类型错误"+e)}return t},getRetrievePrize:function(e){var t;switch(e){case game.RetrieveType.RETRIEVE_MOUNT:case game.RetrieveType.RETRIEVE_WING:case game.RetrieveType.RETRIEVE_GOLD:case game.RetrieveType.RETRIEVE_FABAO:case game.RetrieveType.RETRIEVE_STAR:case game.RetrieveType.RETRIEVE_EXP:case game.RetrieveType.RETRIEVE_XIANZHEN:return(t=game.material.getCurDungeonByType(e))||(t=game.material.getMinDungeonByType(e)),t.retrieveDrop;default:b8e.warn("getRetrievePrize传入类型错误"+e)}},retrieveAll:function(e){var t;this.retrieveDatas&&0!=this.retrieveDatas.length&&(t=e?game.BackMgr.inst().getAmountValue(game.AmountType.SILVER):game.BackMgr.inst().getAmountValue(game.AmountType.YUAN_BAO),this.getAllRetrieveCost(e)<=t?game.RetrieveSender.batchRetrieveRequest(e):game.notice.show(70001))},retrieveAllRp:function(){if(this.retrieveDatas&&0!=this.retrieveDatas.length){for(var e=0,t=this.retrieveDatas.length;e<t;e++){var i=this.retrieveDatas[e];i&&(i.count=0)}b8e.evt.dptG(game.RetrieveEvent.DATAS_CHANGE),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE)}},retrieveByType:function(e,t){var i=game.ccfg.WelfareRetrieveCfg.getDataById(e);if(i){var n,s=t?i.goldCost:i.diamondCost;if(t)n=game.BackMgr.inst().getAmountValue(game.AmountType.SILVER);else{if(0<game.BackMgr.inst().getItemInfoCountById(this.retrieveCostItem))return void game.RetrieveSender.singleRetrieveRequest(e,!1);n=game.BackMgr.inst().getAmountValue(game.AmountType.YUAN_BAO)}s<=n?game.RetrieveSender.singleRetrieveRequest(e,t):game.notice.show(70001)}},retrieveByTypeRp:function(e){var t=this.getRetrieveDataByType(e.retrieveType);t&&(0<t.count&&t.count--,b8e.evt.dptG(game.RetrieveEvent.DATAS_CHANGE),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE))},getRetrieveDataByType:function(e){if(!this.retrieveDatas||0==this.retrieveDatas.length)return null;for(var t=0,i=this.retrieveDatas.length;t<i;t++){var n=this.retrieveDatas[t];if(n.retrieveType==e)return n}return null},haveRetrieveTimes:function(){if(!this.retrieveDatas||0==this.retrieveDatas.length)return!1;for(var e,t=0,i=this.retrieveDatas.length;t<i;t++)if((e=this.retrieveDatas[t])&&0<e.count)return!0;return!1},resetDaily:function(){this._isInit=!1,this.getDatas()}}),game.RetrieveMgr._inst=null,game.RetrieveMgr.inst=function(){return game.RetrieveMgr._inst||(game.RetrieveMgr._inst=new game.RetrieveMgr),game.RetrieveMgr._inst}},{}],970:[function(e,t,i){"use strict";game.WelfareMgr=b8e.Object.extends({name:"WelfareMgr",_allWelfareInfo:null,_isCrit:!1,_isChangeTurn:!1,_allGridInfoArr:null,isGetFocusPrize:!1,isGetVerifyPrize:!1,isGetAddShortcutPrize:!1,collectOnlineAwards:null,collectedWanbaGameVipPrize:!1,_timer:null,nowTime:0,resetOnline:!1,_selectSubType:1,welfareBtns:null,dailyOnlineTime:0,firstClickArr:null,isShowOnlineAlert:!1,ismillionAward:!0,millionAwardData:null,collectedMillionAwardNum:0,_date:null,isShowMondayWelfare:!1,dayList:null,day:0,isMondayAwardCanGet:!1,mondayAwardIsCollected:!1,isCollectedJDPrize:!1,_showMondayPanel:!1,ctor:function(){if(1==game.WelfareMgr._singleton)throw new Error("WelfareMgr 只能通过单例方法获取");this._gridInfoArr=[],this.collectOnlineAwards=[],this.welfareBtns=[],this.firstClickArr=[],this.dayList=[]},synWelfareInfo:function(e){var t=new game.WelfareInfo;t.convertGoldTimes=e.convertGoldTimes,t.signId=e.signId,t.signDays=e.signDays,t.todayIsSign=e.hasWeekSigned,t.weekSignDays=e.weekSignDays,this._date||(this._date=new Date);var i=game.SysTime.curTime;this._date.setTime(i),this._date.setHours(0),this._date.setMinutes(0),this._date.setSeconds(0);var n=this._date.getTime(),s=this._date.getDay();if(0==s&&(s=7),t.weekStartTime=n-b8e.TimeUtil.DAY_MICRO_SECONDS*s,t.weekEndTime=t.weekStartTime+7*b8e.TimeUtil.DAY_MICRO_SECONDS,t.today=s,this.hasSigned=e.hasSigned,this._allWelfareInfo=t,this.isGetAddShortcutPrize=e.collectedSendDesktopPrize,this.isGetFocusPrize=e.collectedFocusPrize,this.isGetVerifyPrize=e.collectedVerifyAward,this.collectOnlineAwards=e.onlineAwardRecord,this.collectedWanbaGameVipPrize=e.collectedWanbaGameVipPrize,this.mondayAwardIsCollected=e.mondayAwardIsCollected,this.isCollectedJDPrize=e.collectedJdPrize,game.ShareMgr.inst().setup(e),this.collectedMillionAwardNum=e.collectedMillionAwardNum,this.checkOnlinePrize(!0),this.dayList.length<=0){var a=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.MONDAY_WELFARE);this.dayList=a.split("|")}this.isShowMonday(),this.openWeekPanel()},synIsCrit:function(e){this._isCrit=e,this._allWelfareInfo.convertGoldTimes++,b8e.evt.dptG(game.WelfareEvents.COVER_GLOD_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},synSignInfo:function(e,t){this._allWelfareInfo.signDays=t,this._allWelfareInfo.hasSigned=!0,b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.SIGN_SUCCESS)},collectOnlineAward:function(e){-1==this.collectOnlineAwards.indexOf(e)&&this.collectOnlineAwards.push(e),this.checkOnlinePrize(!1),b8e.evt.dptG(game.WelfareEvents.COLLECT_ONLINE_SUCCESS),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},welfareResetDaily:function(){this._allWelfareInfo&&(this._allWelfareInfo.convertGoldTimes=0,this._allWelfareInfo.hasSigned=!1,30==this._allWelfareInfo.signDays&&101==this._allWelfareInfo.signId&&(this._allWelfareInfo.signId=1,this._allWelfareInfo.signDays=0),30==this._allWelfareInfo.signDays&&1==this._allWelfareInfo.signId&&(this._allWelfareInfo.signDays=0)),this.collectOnlineAwards.length=0,this.resetOnline=!0,this.nowTime=game.SysTime.curTime,this.dailyOnlineTime=0,this._timer&&(b8e.Timer.remove(this,this.showAlert),this._timer=null),this.checkOnlinePrize(!1),this.collectedMillionAwardNum=0,this.isShowMonday(),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE)},isHideVipRoullete:function(){var e=game.vip.getVipLv();return e<0&&(e=0),e<game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.VIP_ROULLETE_LIMIT)},showSignTips:function(e){var t=new game.GameAlertInfo;t.alertType=game.GameAlertType.TwoBtn,t.string="VIP"+e+"可领取双倍奖励，是否确定现在领取？",t.confirmString="提升VIP",t.cancelString="残忍领取",t.isShowTips=!1,game.gameAlert.showAlert(this,this.onClickBtn,t)},onClickBtn:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.app.isShow(game.AppConstant.WELFARE_PANEL)&&game.app.hide(game.AppConstant.WELFARE_PANEL),game.pay.showPayPanel();break;case game.GameAlertBtnType.CANCEL:game.WelfareSender.reqSign();break;case game.GameAlertBtnType.CLOSE:}},getIsCrit:function(e){return this._isCrit},getConvertGoldTimes:function(){return this._allWelfareInfo.convertGoldTimes},getChangeTurn:function(){return this._isChangeTurn},getHasSigned:function(){return this._allWelfareInfo.hasSigned},getSignId:function(){return this._allWelfareInfo.signId},getAllGridsInfo:function(e){return this._allGridInfoArr=game.ccfg.WelfareCfg.getWelfareExlInfoByType(e),this._allGridInfoArr},getAllWelfareInfo:function(){return this._allWelfareInfo},getSignDays:function(){return this._allWelfareInfo.signDays},getOnlineArr:function(){var e=game.ccfg.OnlineAwardCfg.getDatas();return e&&0<e.length?e:[]},getOnlineTime:function(e){var t,i=game.mainRole.mainRoleData.miscData;return 0<(t=this.resetOnline?60*e*1e3-(game.SysTime.curTime-this.nowTime):60*e*1e3-(game.SysTime.curTime-i.loginTime)-i.dailyOnlineTime)?t:0},selectSubType:{set:function(e){this._selectSubType=e},get:function(){return this._selectSubType}},selectType:function(e){this.selectSubType!=e&&(this.selectSubType=e,-1==this.firstClickArr.indexOf(e)&&this.firstClickArr.push(e),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE))},getIsShowEffect:function(e){if(-1!=this.firstClickArr.indexOf(e))return!1;switch(e){case game.WelfareType.SIGN_PANEL:case game.WelfareType.CDKEY_PANEL:case game.WelfareType.ONLINE_PANEL:case game.WelfareType.FORESHOW_PANEL:case game.WelfareType.FAQ_PANEL:}return!0},getWelfareBar:function(){return this.welfareBtns=game.ccfg.WelfareBarCfg.getDatas(),this.isShowMondayWelfare||this.delBtn(this.welfareBtns,game.WelfareType.MONDAY),this.delBtn(this.welfareBtns,game.WelfareType.FUND_PANEL),this.delBtn(this.welfareBtns,game.WelfareType.ROULETTE),this.delBtn(this.welfareBtns,game.WelfareType.VIP_ROULETTE),"72usa6_recharge_client"==game.VERSION_NAME&&this.delBtn(this.welfareBtns,game.WelfareType.CDKEY_PANEL),this.welfareBtns},getWelfareRouleteBtn:function(){var e;return this.welfareBtns||(this.welfareBtns=[]),this.welfareBtns.length=0,(e=game.ccfg.WelfareBarCfg.getDataById(game.WelfareType.ROULETTE))&&this.welfareBtns.push(e),this.isHideVipRoullete()||(e=game.ccfg.WelfareBarCfg.getDataById(game.WelfareType.VIP_ROULETTE))&&this.welfareBtns.push(e),this.welfareBtns},getWelfareFundBtn:function(){this.welfareBtns||(this.welfareBtns=[]),this.welfareBtns.length=0;var e=game.ccfg.WelfareBarCfg.getDataById(game.WelfareType.FUND_PANEL);return e&&(game.fund.isDisappear()||this.welfareBtns.push(e)),this.welfareBtns},delBtn:function(e,t){if(e&&0<e.length){for(var i=0;i<e.length;i++)e[i].id==t&&e.splice(i,1);return e}return[]},getAlertByType:function(e){return e==game.WelfareType.SIGN_PANEL?this.isAlertSigned():e==game.WelfareType.ONLINE_PANEL?this.isShowOnlineAlert:e==game.WelfareType.ROULETTE?!game.roulette.getFreeUsedByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER):e==game.WelfareType.WEEK_SIGN_PANEL?this.weekSignAlert():e==game.WelfareType.RETRIEVE_PANEL?game.retrieve.haveRetrieveTimes():e==game.WelfareType.MONDAY&&(this.isMondayAwardCanGet&&!this.mondayAwardIsCollected)},checkOnlinePrize:function(e){if(e){var t=game.mainRole.mainRoleData.miscData;this.dailyOnlineTime=t.dailyOnlineTime}else if(this.resetOnline)this.dailyOnlineTime=game.SysTime.curTime-this.nowTime;else{t=game.mainRole.mainRoleData.miscData;this.dailyOnlineTime=game.SysTime.curTime-t.loginTime+t.dailyOnlineTime}var i,n,s=this.getOnlineArr();this.isShowOnlineAlert=!1;for(var a=0;a<s.length;a++){var o=s[a];if((i=o.time*b8e.TimeUtil.MINUTE_MICRO_SECONDS)<=this.dailyOnlineTime&&-1==this.collectOnlineAwards.indexOf(o.time)&&(this.isShowOnlineAlert=!0),i>this.dailyOnlineTime&&!this._timer){n=i-this.dailyOnlineTime,this._timer=b8e.Timer.add(this,this.showAlert,n,0,0);break}}},showAlert:function(){this._timer&&(b8e.Timer.remove(this,this.showAlert),this._timer=null),this.checkOnlinePrize(!1),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE)},mondayGetPrize:function(){game.WelfareSender.reqMondayAwardCollectRequest()},isShowMonday:function(){this.day=b8e.TimeUtil.getDay(game.SysTime.curTime)+"";this.dayList.indexOf(this.day);this.isShowMondayWelfare=-1!=this.dayList.indexOf(this.day),this.isMondayAwardCanGet=1==this.dayList.indexOf(this.day),this.isShowMondayWelfare||game.welfare.selectSubType!=game.WelfareType.MONDAY||b8e.evt.dptG(game.WelfareEvents.INIT_SELECT_TYPE)},isAlert:function(){var e=this.isShowOnlineAlert,t=game.fund.isAlertFund(),i=this.weekSignAlert(),n=game.retrieve.haveRetrieveTimes();return!!(t||e||i||n)},isAlertSigned:function(){return this._allWelfareInfo&&0==this._allWelfareInfo.hasSigned},setMillionAwardState:function(e){game.funcOpen.checkOpen(game.FunctionType.MILLION_AWARD)&&(this.ismillionAward=e.isEnd,b8e.evt.dptG(game.WelfareEvents.UPDATE_MILLIONAWARDPANEL),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE))},getMillionAwardState:function(){return this.ismillionAward},setMillionAwardData:function(e){this.millionAwardData||(this.millionAwardData=new game.MillionAwardData),this.millionAwardData.setup(e),b8e.evt.dptG(game.WelfareEvents.UPDATE_MILLIONAWARDPANEL),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE)},getMillionAwardData:function(){return this.millionAwardData},reqMillionAward:function(){if(this.isGetMillionAward())game.notice.show("您今日已经瓜分元宝，请明日再来");else if(this.isCanMillionAward())game.WelfareSender.reqMillionAwardRequest();else{var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.MILLIONAWARD_LV),t=game.ccfg.LangCfg.getText(13004,[e]);game.notice.show(t)}},resMillionAward:function(e){if(e.isPrecious){var t=game.mainRole.mainRoleData,i=new game.MillionAwardRecord;i.name=t.name,i.num=e.num,i.time=game.SysTime.curTime,this.millionAwardData.addRecord(i)}this.millionAwardData.surplusNum-=e.num,0==this.millionAwardData.surplusNum&&(this.ismillionAward=!0),this.collectedMillionAwardNum=e.num,b8e.evt.dptG(game.WelfareEvents.UPDATE_MILLIONAWARDPANEL),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE),game.app.show(game.AppConstant.MILLIONAWARDTIPS_PANEL)},isGetMillionAward:function(){return 0<this.collectedMillionAwardNum},isMillionAlert:function(){return!!(!this.ismillionAward&&this.collectedMillionAwardNum<=0&&this.isCanMillionAward())},isCanMillionAward:function(){var e=game.mainRole.mainRoleData;if(!e)return!1;var t=e.getLv();return game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.MILLIONAWARD_LV)<=t},_weekAlertInfo:null,_showWeekPanel:!1,weekSignAlert:function(){return!!this._allWelfareInfo&&0==this._allWelfareInfo.todayIsSign},weekSignResetDaily:function(){this.weekReset()},weekSignReset:function(){this._allWelfareInfo.weekSignDays=0,this.weekReset()},weekReset:function(){this._allWelfareInfo.todayIsSign=!1,this._showWeekPanel=!1;var e=game.SysTime.curTime;this._date.setTime(e),this._date.setHours(0),this._date.setMinutes(0),this._date.setSeconds(0);var t=this._date.getTime(),i=this._date.getDay();0==i&&(i=7),this._allWelfareInfo.weekStartTime=t-b8e.TimeUtil.DAY_MICRO_SECONDS*i,this._allWelfareInfo.weekEndTime=this._allWelfareInfo.weekStartTime+7*b8e.TimeUtil.DAY_MICRO_SECONDS,this._allWelfareInfo.today=i,this.openWeekPanel(),b8e.evt.dptG(game.WelfareEvents.WEEK_SIGN_SUCCESS)},weekSign:function(e){var t;if(this.isSignDay(e))return t=game.ccfg.GlobalParamCfg.getData(6201),game.notice.show(t),!1;if(this.isRepairSign(e)){if(this._allWelfareInfo.todayIsSign){if(!this._weekAlertInfo){this._weekAlertInfo=new game.GameAlertInfo,this._weekAlertInfo.alertType=game.GameAlertType.TwoBtn;var i=game.ccfg.GlobalParamCfg.getData(6010).split("|")[1];this._weekAlertInfo.string="是否花费"+i+"元宝进行补签？",this._weekAlertInfo.isShowTips=!0}game.gameAlert.showAlert(this,this._weekSign,this._weekAlertInfo)}else game.WelfareSender.weekSignRequest();return!0}return t=game.ccfg.GlobalParamCfg.getData(6200),game.notice.show(t),!1},_weekSign:function(e,t){t==game.GameAlertBtnType.CONFIRM&&game.WelfareSender.weekSignRequest()},isTodaySign:function(){return this._allWelfareInfo.todayIsSign},isSignDay:function(e){return this._allWelfareInfo.weekSignDays>=e},isRepairSign:function(e){return this._allWelfareInfo.today>=e&&this._allWelfareInfo.weekSignDays+1==e},weekSignResponse:function(e){this._allWelfareInfo.weekSignDays=e,this._allWelfareInfo.todayIsSign=!0,b8e.evt.dptG(game.WelfareEvents.WEEK_SIGN_SUCCESS),b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE)},openWeekPanel:function(){var e=!1,t=!1,i=game.WelfareType.WEEK_SIGN_PANEL,n=game.MainRoleMgr.inst().mainRoleData.getLv(),s=game.SceneMgr.inst().getSceneConfig();s&&s.type==game.SceneType.SURA||(e=!this.isTodaySign()&&1!=n&&1!=this._showWeekPanel,t=0!=this.isMondayAwardCanGet&&1!=this.mondayAwardIsCollected&&1!=n&&1!=this._showMondayPanel,(e||t)&&(t?i=game.WelfareType.MONDAY:e&&!t&&(i=game.WelfareType.WEEK_SIGN_PANEL),this._showWeekPanel=!0,this._showMondayPanel=!0,game.welfare.selectSubType=i,b8e.evt.dptG(game.WelfareEvents.WELFARE_BTN_CHANGE),game.IS_SHIELD_IOS_RECHARGE||0==game.app.isShow(game.AppConstant.WELFARE_PANEL)&&game.app.show(game.AppConstant.WELFARE_PANEL)))}}),game.WelfareMgr._instance=null,game.WelfareMgr._singleton=!0,game.WelfareMgr.inst=function(){return game.WelfareMgr._instance||(game.WelfareMgr._singleton=!1,game.WelfareMgr._instance=new game.WelfareMgr,game.WelfareMgr._singleton=!0),game.WelfareMgr._instance}},{}],971:[function(e,t,i){"use strict";e("./WelfareMgr")},{"./WelfareMgr":970}],972:[function(e,t,i){"use strict";game.DailyOnlineItem=game.SkinUI.extends({_data:null,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super("welfare/DailyOnlineItemSkin","DailyOnlineItemSkin"),this._prizeInfo=new game.PrizeInfo,this._data=e},onShow:function(){this.initItem(),this.setData(this._data),b8e.evt.onC(this._skin.btn_receive,this.onClickReceiveBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_receive,this.onClickReceiveBtn,this)},initItem:function(){this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prize))},setData:function(e){(this._data=e,this._skin&&this._data)&&(this._skin.lab_desc.string="在线"+e.time+"分钟可领取",this._prizeInfo.setupById(e.dropId),this._prizeList.setData(this._prizeInfo),this._skin.btn_receive.active=!0,-1!=game.welfare.collectOnlineAwards.indexOf(e.time)?this._skin.btn_receive.active=!1:0<game.welfare.getOnlineTime(e.time)?b8e.ShaderUtil.setGray(this._skin.btn_receive):(this._skin.lab_time.string="",b8e.ShaderUtil.reset(this._skin.btn_receive)))},onClickReceiveBtn:function(){0<game.welfare.getOnlineTime(this._data.time)?game.notice.show("暂时还无法领取"):game.WelfareSender.reqCollectOnlineAward(this._data.time)},getWidth:function(){return 535},getHeight:function(){return 140}})},{}],973:[function(e,t,i){"use strict";game.appModule.MillionAwardPanel=game.SkinUIPanel.extends({_list:null,_itemList:null,_itemPool:null,_dataList:null,_dataPool:null,millionBg:null,_upgrade_effect:null,_upanim:null,firstPoY:0,lastPosY:0,itemHeight:26,maxShowNum:7,ctor:function(e){this._super(e)},init:function(){this.millionBg=b8e.Sprite.get(),this.millionBg.setAnchor(.5,.5),this.millionBg.loadTexture("images/image/active/discount/millionawardBG.jpg",null,null,{useManifest:!1}),this.millionBg.addToParent(this._skin.millionawardNode),this._skin.acticeDesc.string=game.ccfg.LangCfg.getText(13e3),this._itemList=[],this._itemPool=[],this._dataList=[],this._dataPool=[],this._millioneffect_1||(this._millioneffect_1=b8e.Animator.get(game.AnimatorType.MILLION_GOLDEFFECT_1,1),this._millioneffect_1.setAnchor(.5,.5),this._millioneffect_1.setPosition(0,0),this._millioneffect_1.addToParent(this._skin.millioneffect)),this._millioneffect_2||(this._millioneffect_2=b8e.Animator.get(game.AnimatorType.MILLION_GOLDEFFECT_1,2),this._millioneffect_2.setAnchor(.5,.5),this._millioneffect_2.setPosition(0,0),this._millioneffect_2.addToParent(this._skin.millioneffect),this._millioneffect_2.setBlendMode(b8e.BlendMode.ADD))},onShow:function(){this._upgrade_effect||(this._upgrade_effect=b8e.BaseDisplay.get(),this._upgrade_effect.addToParent(this._skin.getawardBnt)),game.WelfareSender.reqMillionAwardDataRequest(),b8e.evt.addG(this,game.WelfareEvents.UPDATE_MILLIONAWARDPANEL,this.updatePanel),b8e.evt.onC(this._skin.getawardBnt,this.clickBtnGetAward,this),this._millioneffect_1.load(game.ClientCfg.getUIFxs(10079)),this._millioneffect_1.play(0),this._millioneffect_2.load(game.ClientCfg.getUIFxs(10080)),this._millioneffect_2.play(0)},onHide:function(){b8e.evt.offC(this._skin.getawardBnt,this.clickBtnGetAward,this),b8e.evt.rmvG(this,game.WelfareEvents.UPDATE_MILLIONAWARDPANEL,this.updatePanel),this.reset(),this._millioneffect_1&&this._millioneffect_1.clear(),this._millioneffect_2&&this._millioneffect_2.clear()},updatePanel:function(){if(this._skin){var e=game.welfare.getMillionAwardData();if(e){this._skin.surplusNumLab.string=e.surplusNum;var t=e.records;if(t||!(t.length<=0)){var i;this.reset();for(var n=0;n<t.length;++n)n<this.maxShowNum?((i=this.getItem()).setData(t[n]),this.addRecordItemNode(i),i.addToParent(this._skin.recordNode),i.show(),this._itemList.push(i),this._dataList.push(t[n])):this._dataPool.push(t[n]);this.critAnimation(),this._skin.noneTiplab.node.active=!(0<e.records.length);var s=game.welfare.collectedMillionAwardNum;this._skin.getawardBnt.active=!(0<s),this._skin.selfawardlab.node.active=0<s,this._skin.selfawardlab.string=game.ccfg.LangCfg.getText(13001,[s]),0<s?this.removeEffect():this.addEffect()}}}},clickBtnGetAward:function(){game.welfare.reqMillionAward()},addEffect:function(){var e=game.ClientCfg.getUIFxs("10019");e?(this._upanim||(this._upanim=b8e.Animator.get(game.AnimatorType.MILLIONAWARD_BNTEFFECT,1),this._upgrade_effect.addChild(this._upanim)),this._upgrade_effect.setVisible(!0),this._upanim.load(e),this._upanim.play(null,0)):this._upanim&&this._upanim.clear()},removeEffect:function(){this._upanim&&this._upanim.stop(),this._upgrade_effect&&this._upgrade_effect.setVisible(!1)},addRecordItemNode:function(e){e&&(this.lastPosY-=e.height,e.y=this.lastPosY)},critAnimation:function(){this._skin.recordNode.y!=this.firstPoY&&this.changeItemPosition(),b8e.Tween.kill(this._skin.recordNode);var e=this._skin.recordNode.y;b8e.Tween.get(this._skin.recordNode).to({y:e+this.itemHeight},2e3).call(this.critAnimation,this)},changeItemPosition:function(){if(0<this._itemList.length){var e=this._itemList.shift(),t=this._dataList.shift();this._dataPool.push(t);var i=this._dataPool.shift();e.setData(i),this._dataList.push(i),this.addRecordItemNode(e),this._itemList.push(e)}},getItem:function(){return 0<this._itemPool.length?this._itemPool.shift():new game.MillionAwardRecordItem},clearItem:function(){for(;0<this._itemList.length;){var e=this._itemList.shift();e.hide(),this._itemPool.push(e)}this._itemList.length=0},reset:function(){this.lastPosY=0,this.clearItem(),b8e.Tween.kill(this._skin.recordNode),this._skin.recordNode.y=this.firstPoY,this._dataList&&(this._dataList.length=0),this._dataPool&&(this._dataPool.length=0)}})},{}],974:[function(e,t,i){"use strict";game.MillionAwardRecordItem=game.SkinUI.extends({m_data:null,ctor:function(){this._super("welfare/MillionAwardRecordSkin","MillionAwardRecordSkin")},getHeight:function(){return 26},getWidth:function(){return 410},onShow:function(){this.m_data&&this.setData(this.m_data)},onHide:function(){},setData:function(e){if(this.m_data=e,this._skin&&e){var t=b8e.TimeUtil.formatTimestamp(e.time,"h:m"),i=game.ccfg.LangCfg.getText(13002,[t,e.name,e.num]);this._skin.recordlab.string=i}}})},{}],975:[function(e,t,i){"use strict";game.appModule.MillionAwardTipsPanel=game.SkinUIPanel.extends({itemGrid:null,ctor:function(e){this._super(e)},init:function(){this.itemGrid=game.GridUtil.creatItemGrid(this,this._skin.grid),this.itemGrid.gridInfo=new game.GridInfo(game.ContainerId.MILION_CONTAINER_ID),this.itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80)},onShow:function(){this.updatePanel(),b8e.evt.onC(this._skin.btn_yes,this.onClickYes,this)},onHide:function(){b8e.evt.offC(this._skin.btn_yes,this.onClickYes,this)},updatePanel:function(){if(this._skin){var e=game.welfare.collectedMillionAwardNum,t=game.ccfg.ItemInfoCfg.getItemInfoById(500002,!0);t&&(t.num=e,game.GridUtil.setItemGrid(this.itemGrid,t),this.itemGrid.setName(t.name,game.html.getColorByQuality(t.quality),null,200,30,24),this.itemGrid.setNum(e),this.itemGrid.setVisible(!0),this.itemGrid.fnOnClick(this,this.onClick),this.itemGrid.sortLayer()),this._skin.lab_desc.string=game.ccfg.LangCfg.getText(13003,[e])}},onClick:function(e){e&&e.faceInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo})},onClickYes:function(){this.hide()}})},{}],976:[function(e,t,i){"use strict";game.SignGrid=game.SkinUI.extends({_gridInfo:null,_iconSprite:null,_sceneLayer:null,ctor:function(e){this._super("welfare/SignGridSkin","SignGridSkin"),this._gridInfo=e},getHeight:function(){return 86},getWidth:function(){return 86},onShow:function(){this.setData(this._gridInfo),b8e.evt.onC(this._skin.node_click,this.onClickGrid,this)},onHide:function(){this._iconSprite&&this._iconSprite.unloadTexture(),this.clearAnimator(),b8e.evt.offC(this._skin.node_click,this.onClickGrid,this)},init:function(){this._sceneLayer||(this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.node_animation))},setData:function(e){if(this._gridInfo=e,this._skin&&this._gridInfo){game.welfare.getChangeTurn();var t=game.welfare.getSignDays(),i=game.welfare.getHasSigned();this._skin.lab_num.string=e.itemNum;var n=game.ccfg.ItemInfoCfg.getItemInfoById(e.itemId);n&&this.setIcon(n.iconName),0!=e.vipLv?(this._skin.node_tag.active=!0,this._skin.lab_vip.string=e.vipLv):this._skin.node_tag.active=!1,this._skin.node_select.active=!1,e.signTimes-1<t?(this._skin.node_select.active=!0,this.clearAnimator(),b8e.ShaderUtil.setGray(this._iconSprite),b8e.ShaderUtil.setGray(this._skin.img_vip)):e.signTimes-1==t&&0==i&&this.showModel()}},onClickGrid:function(){var e=game.welfare.getSignDays(),t=game.welfare.getHasSigned();game.welfare.getChangeTurn();if(this._gridInfo.signTimes-1<e)this.showTips(this._gridInfo);else if(this._gridInfo.signTimes-1==e){var i=game.vip.getVipLv();i<0&&(i=0),1==t?this.showTips(this._gridInfo):i<this._gridInfo.vipLv?game.welfare.showSignTips(this._gridInfo.vipLv):game.WelfareSender.reqSign()}else this.showTips(this._gridInfo),b8e.ShaderUtil.reset(this._iconSprite),b8e.ShaderUtil.reset(this._skin.img_vip)},showTips:function(e){var t=game.ccfg.ItemInfoCfg.getItemInfoById(e.itemId,!0);t.num=e.itemNum,game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:t,containerId:game.ContainerId.TIPS_CONTAINER_ID})},setIcon:function(e){if(""!=e){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.addToParent(this._skin.img_icon));var t=game.ClientCfg.getImgUrl(e);this._iconSprite.loadTexture(t,null,null,{useManifest:!1})}},showModel:function(){var e;(e=game.ClientCfg.getUIFxs("10008"))?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.SIGN_GRIDS_EFFECT,1),this._sceneLayer.addChild(this._anim)),this._sceneLayer.setVisible(!0),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearAnimator:function(){this._anim&&this._anim.clear(),this._sceneLayer&&this._sceneLayer.setVisible(!1)}})},{}],977:[function(e,t,i){"use strict";game.WelfareBtn=game.SkinUI.extends({_data:null,_normal:null,_select:null,_effect:null,ctor:function(){this._super("welfare/WelfareBtnSkin","WelfareBtnSkin")},init:function(){this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle),this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle)},onShow:function(){this._effect||(this._effect=b8e.Animator.get(game.AnimatorType.ACTIVE_ALERT_EFFECT),this._effect.setAnchor(.5,.5),this._effect.addToParent(this)),b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},onTouchThis:function(){game.welfare.selectType(this._data.id)},setData:function(e){if(this._data=e,this._skin){var t=game.welfare.getAlertByType(e.id);this._skin.alert.active=!!t,this._skin.normalTitle.active=!1,this._skin.selectTitle.active=!1;var i=game.welfare.selectSubType;this._data.id==i?(this._skin.selectTitle.active=!0,this._select.loadTexture(game.ClientCfg.getImgUrl(e.clickBg,!1),null,null,{useManifest:!1}),this._effect.clear()):(this._skin.normalTitle.active=!0,this._normal.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!1),null,null,{useManifest:!1}))}},getHeight:function(){return 95},getWidth:function(){return 85}})},{}],978:[function(e,t,i){"use strict";game.WelfareCDKeyPanel=game.SkinUI.extends({ctor:function(){this._super("welfare/WelfareCDKeySkin","WelfareCDKeySkin")},onShow:function(){game.IS_HUO_SHU?game.LoginConfig.isCouponRemark?(this._skin.labCdkDesc.node.active=!0,this._skin.labCdkDesc.string=game.ccfg.LangCfg.getText(10306)):this._skin.labCdkDesc.node.active=!1:game.IS_QZONE?(this._skin.labCdkDesc.node.active=!0,this._skin.labCdkDesc.string=game.ccfg.LangCfg.getText(10306)):this._skin.labCdkDesc.node.active=!1,b8e.evt.onC(this._skin.btn_cdkey,this.clickBtnCdkey,this)},onHide:function(){b8e.evt.offC(this._skin.btn_cdkey,this.clickBtnCdkey,this)},clickBtnCdkey:function(){var e=this._skin.input_cdkey.string;0!=e.length?game.WelfareSender.exchangeCouponRequest(e):b8e.Toast.launch("请输入激活码！")}})},{}],979:[function(e,t,i){"use strict";game.WelfareFAQPanel=game.SkinUI.extends({ctor:function(){this._super("welfare/WelfareFAQSkin","WelfareFAQSkin")},onShow:function(){this.updateFAQPanel()},onHide:function(){},updateFAQPanel:function(){var e=game.ccfg.LangCfg.getText(10031);this._skin.lab_faq.string=e+""}})},{}],980:[function(e,t,i){"use strict";game.WelfareForeshowPanel=game.SkinUI.extends({ctor:function(){this._super("welfare/WelfareForeshowSkin","WelfareForeshowSkin")},init:function(){this._sprite=b8e.Sprite.get(),this._sprite.addToParent(this._skin.node_bg),this._sprite.loadTexture(game.ClientCfg.getImgUrl("welfare/bgForeShow"),null,null,{useManifest:!1})},onShow:function(){},onHide:function(){}})},{}],981:[function(e,t,i){"use strict";game.WelfareFundPanel=game.SkinUI.extends({_allWelfareInfo:null,_sceneLayerBtn:null,_btnAnim:null,_timer:null,_red:null,_white:null,_reward:null,ctor:function(){this._super("welfare/WelfareFundSkin","WelfareFundSkin"),this._myDate=new Date,this._red=b8e.ColorUtil.toCCColor(4294901760),this._white=b8e.ColorUtil.toCCColor(4294967295),this._reward=b8e.ColorUtil.toCCColor(4293384103)},init:function(){this._fundList=new b8e.List(this._skin.list_fund,game.FundItem),this._sceneLayerBtn=b8e.BaseDisplay.get(),this._sceneLayerBtn.addToParent(this._skin.btn_buyFund),this._btnAnim=b8e.Animator.get(game.AnimatorType.FUND_BTN_EFFECT,1),this._sceneLayerBtn.addChild(this._btnAnim)},onShow:function(){this._timer&&this._timer.start(),this._fundList.show(),this.updateFundPanel(),b8e.evt.onC(this._skin.btn_buyFund,this.clickBuyFund,this),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateFundPanel),b8e.evt.addG(this,game.FundEvents.FUND_BUY_SUCCESS,this.updateFundPanel),b8e.evt.addG(this,game.FundEvents.FUND_COLLECT_SUCCESS,this.updateFundPanel)},onHide:function(){this._timer&&this._timer.stop(),this._fundList&&this._fundList.hide(),b8e.evt.offC(this._skin.btn_buyFund,this.clickBuyFund,this),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.updateFundPanel),b8e.evt.rmvG(this,game.FundEvents.FUND_BUY_SUCCESS,this.updateFundPanel),b8e.evt.rmvG(this,game.FundEvents.FUND_COLLECT_SUCCESS,this.updateFundPanel)},updateFundPanel:function(){if(game.fund.isBuyFund)this._skin.lab_remainTime.string="",this._timer&&(b8e.Timer.remove(this,this.updateTime),this._timer=null),this._skin.node_buy.active=!1,this.clearFundAnimator();else{this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3));var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FUND_VIP_LEVEL),t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FUND_PRICE),i=game.back.getAmountInfo();if(i){var n=i.getValue(game.AmountType.YUAN_BAO);this._skin.lab_fundPrice.node.color=n<t?this._red:this._reward}this._skin.node_buy.active=!0,this._skin.lab_fundPrice.string=t,this._skin.lab_fundVipLv.string="VIP"+e+"购买",this.showBtnModel()}var s=game.fund.getFundArr();s&&0<s.length&&(s.sort(this.onSort),this._fundList.setData(s))},onSort:function(e,t){return game.pay.setFundState(e),game.pay.setFundState(t),0==e.state&&0==t.state?e.level>t.level?1:-1:0==e.state&&0!=t.state?-1:0!=e.state&&0==t.state?1:2==e.state&&2==t.state?e.level>t.level?1:-1:2==e.state&&2!=t.state?-1:2!=e.state&&2==t.state?1:1==e.state&&1==t.state?e.level>t.level?-1:1:1==e.state&&1!=t.state?1:1!=e.state&&1==t.state?-1:0},clickBuyFund:function(){var e=game.vip.getVipLv(),t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FUND_VIP_LEVEL),i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FUND_PRICE);if(e<0&&(e=0),t<=e){var n=game.back.getAmountInfo();if(n)i<=n.getValue(game.AmountType.YUAN_BAO)?game.PaySender.reqBuyFund():game.pay.diamondRechargeTips()}else game.vip.vipTips()},clearFundAnimator:function(){this._btnAnim&&this._btnAnim.clear(),this._sceneLayerBtn&&this._sceneLayerBtn.setVisible(!1)},updateTime:function(){var e,t=this._myDate.getDate(),i=game.SysTime.curTime;(e=t%2==1?b8e.TimeUtil.getNextDateTime(i,1)-i:b8e.TimeUtil.getNextDateTime(i,2)-i)<0&&(e=b8e.TimeUtil.getNextDateTime(i,2)-i),this._skin.lab_remainTime.string=game.ccfg.LangCfg.getText("剩余时间:$",[game.html.getText(game.html.Q_GREEN,b8e.TimeUtil.formatTime(e))])},showBtnModel:function(){var e=game.ClientCfg.getUIFxs("10019");e?(this._btnAnim.load(e),this._btnAnim.play()):this._btnAnim&&this._btnAnim.clear()}})},{}],982:[function(e,t,i){"use strict";game.WelfareMondayPanel=game.SkinUI.extends({_timer:null,_prizeList:null,_prizeInfo:null,_discount:null,_str:"",_endTime:0,dropId:0,isCanGet:!1,isGet:!1,ctor:function(){this._super("welfare/WelfareMondaySkin","WelfareMondaySkin")},init:function(){this._prizeInfo=new game.PrizeInfo,this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,6,!0),this._prizeList.addToParent(this._skin.prize),0==this.dropId&&(this.dropId=0|game.ccfg.GlobalParamCfg.getData(6102)),this._prizeInfo.setupById(this.dropId),this._prizeList.setData(this._prizeInfo),this._discount=b8e.Sprite.get(),this._discount.addToParent(this._skin.discount),this._discount.loadTexture("images/image/welfare/monday_bg.jpg",null,null,{useManifest:!1})},onShow:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,500)),this.updatePanel(),b8e.evt.onC(this._skin.get_btn,this.clickGetBtn,this),b8e.evt.addG(this,game.WelfareEvents.COLLECT_MONDAY_AWARD,this.updatePanel)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.get_btn,this.clickGetBtn,this),b8e.evt.rmvG(this,game.WelfareEvents.COLLECT_MONDAY_AWARD,this.updatePanel)},updatePanel:function(){this.isCanGet=game.welfare.isMondayAwardCanGet,this.isGet=game.welfare.mondayAwardIsCollected,this.isCanGet&&!this.isGet?b8e.ShaderUtil.reset(this._skin.get_btn):b8e.ShaderUtil.setGray(this._skin.get_btn),this.isCanGet?(this._timer&&this._timer.stop(),this._endTime=0,this._skin.time.node.active=!1):(this._endTime=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime,1),this._skin.time.node.active=!0,this._timer&&(this._timer.reset(),this._timer.start())),this.isGet?this._skin.get_lab.string=game.ccfg.LangCfg.getText(21014):this._skin.get_lab.string=game.ccfg.LangCfg.getText(21015)},clickGetBtn:function(){if(this.isCanGet&&!this.isGet)game.welfare.mondayGetPrize();else if(0<this._endTime){var e=this._endTime-game.SysTime.curTime;0<e&&(this._str=b8e.TimeUtil.formatTime(e),game.notice.show(21013,[this._str]))}else game.notice.show(21014)},updateTime:function(){if(0<this._endTime){var e=this._endTime-game.SysTime.curTime;0<e?(this._str=b8e.TimeUtil.formatTime(e),this._skin.time.string=game.ccfg.LangCfg.getText(21013,[this._str])):(this._timer&&this._timer.stop(),game.welfare.isShowMonday(),this.updatePanel())}}})},{}],983:[function(e,t,i){"use strict";game.WelfareOnlinePanel=game.SkinUI.extends({_onlineList:null,_timer:null,ctor:function(){this._super("welfare/WelfareOnlineSkin","WelfareOnlineSkin")},init:function(){this._onlineList=new b8e.List(this._skin.list_online,game.DailyOnlineItem)},onShow:function(){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3)),this._timer.start(),this._onlineList.show(),this.updateOnlinePanel(),b8e.evt.addG(this,game.WelfareEvents.COLLECT_ONLINE_SUCCESS,this.updateOnlinePanel),b8e.evt.addG(this,game.WelfareEvents.WELFARE_BTN_CHANGE,this.updateOnlinePanel)},onHide:function(){this._onlineList&&this._onlineList.hide(),this._timer&&this._timer.stop(),b8e.evt.rmvG(this,game.WelfareEvents.COLLECT_ONLINE_SUCCESS,this.updateOnlinePanel),b8e.evt.rmvG(this,game.WelfareEvents.WELFARE_BTN_CHANGE,this.updateOnlinePanel)},updateTime:function(){var e;if(game.welfare.resetOnline)e=game.SysTime.curTime-game.welfare.nowTime;else{var t=game.mainRole.mainRoleData.miscData;e=game.SysTime.curTime-t.loginTime+t.dailyOnlineTime}this._skin.lab_onlineTime.string=0<e?game.html.getText(game.html.Q_WHITE,"今日累计在线：")+b8e.TimeUtil.formatTime(e):""},updateOnlinePanel:function(){var e=game.welfare.getOnlineArr();e.sort(this.onSort),this._onlineList.setData(e)},onSort:function(e,t){var i=game.welfare.collectOnlineAwards.indexOf(e.time);return i==game.welfare.collectOnlineAwards.indexOf(t.time)?e.time>t.time?1:-1:-1!=i?1:-1}})},{}],984:[function(e,t,i){"use strict";game.appModule.WelfarePanel=game.SkinUIPanel.extends({_panelIndex:-1,_selectType:-1,_btnList:null,weekSign:null,totem:null,sign:null,fund:null,cdkey:null,online:null,foreshow:null,faq:null,roulette:null,vipRoulette:null,monday:null,welfareBtns:null,retrieve:null,_curPanel:null,ctor:function(e){this._super(e),this.welfareBtns=[]},init:function(){this._btnList=new b8e.List(this._skin.list_btns,game.WelfareBtn,7)},onShow:function(){this.data&&game.welfare.selectType(this.data),this._btnList.show(),this.selectTypeChange(),b8e.evt.addG(this,game.WelfareEvents.WELFARE_BTN_CHANGE,this.selectTypeChange),b8e.evt.addG(this,game.WelfareEvents.SIGN_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.WelfareEvents.COLLECT_ONLINE_SUCCESS,this.updateBtns),b8e.evt.addG(this,game.FundEvents.FUND_COLLECT_SUCCESS,this.updateBtns),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange),b8e.evt.addG(this,game.WelfareEvents.INIT_SELECT_TYPE,this.initSelectType)},onHide:function(){this._curPanel&&this._curPanel.hide(),game.welfare.selectSubType=game.WelfareType.COVER_PANEL,this._btnList&&this._btnList.hide(),b8e.evt.rmvG(this,game.WelfareEvents.WELFARE_BTN_CHANGE,this.selectTypeChange),b8e.evt.rmvG(this,game.WelfareEvents.SIGN_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.WelfareEvents.COLLECT_ONLINE_SUCCESS,this.updateBtns),b8e.evt.rmvG(this,game.FundEvents.FUND_COLLECT_SUCCESS,this.updateBtns),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.selectTypeChange),b8e.evt.rmvG(this,game.WelfareEvents.INIT_SELECT_TYPE,this.initSelectType)},initSelectType:function(){this.welfareBtns&&0<this.welfareBtns.length&&(game.welfare.selectType(this.welfareBtns[0].id),this.selectTypeChange())},selectTypeChange:function(){this.updateBtns(),this.updatePanel()},updateBtns:function(){if(this.data)switch(this.data){case game.WelfareType.FUND_PANEL:this.welfareBtns=game.welfare.getWelfareFundBtn(),this._skin.title.string=game.ccfg.LangCfg.getText(89003);break;case game.WelfareType.ROULETTE:this.welfareBtns=game.welfare.getWelfareRouleteBtn(),this._skin.title.string=game.ccfg.LangCfg.getText(89002);break;default:this._skin.title.string=game.ccfg.LangCfg.getText(89001)}else this.welfareBtns=game.welfare.getWelfareBar(),this._skin.title.string=game.ccfg.LangCfg.getText(89001);this.welfareBtns&&0<this.welfareBtns.length&&this.welfareBtns.sort(this.onSortBtn),this._btnList.setData(this.welfareBtns)},onSortBtn:function(e,t){return e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0},updatePanel:function(){this._curPanel&&this._curPanel.hide();var e=game.welfare.selectSubType;switch(this._skin.bgList.height=590,this._skin.bgList.active=!0,e){case game.WelfareType.COVER_PANEL:this.totem||(this.totem=new game.WelfareTotemPanel,this.totem.addToParent(this._skin.page)),this.totem.show(),this._curPanel=this.totem;break;case game.WelfareType.SIGN_PANEL:this.sign||(this.sign=new game.WelfareSignPanel,this.sign.addToParent(this._skin.page)),this.sign.show(),this._curPanel=this.sign;break;case game.WelfareType.FUND_PANEL:this.fund||(this.fund=new game.WelfareFundPanel,this.fund.addToParent(this._skin.page)),this.fund.show(),this._curPanel=this.fund;break;case game.WelfareType.CDKEY_PANEL:this.cdkey||(this.cdkey=new game.WelfareCDKeyPanel,this.cdkey.addToParent(this._skin.page)),this.cdkey.show(),this._curPanel=this.cdkey;break;case game.WelfareType.ONLINE_PANEL:this.online||(this.online=new game.WelfareOnlinePanel,this.online.addToParent(this._skin.page)),this.online.show(),this._curPanel=this.online;break;case game.WelfareType.FORESHOW_PANEL:this.foreshow||(this.foreshow=new game.WelfareForeshowPanel,this.foreshow.addToParent(this._skin.page)),this.foreshow.show(),this._curPanel=this.foreshow;break;case game.WelfareType.FAQ_PANEL:this.faq||(this.faq=new game.WelfareFAQPanel,this.faq.addToParent(this._skin.page)),this.faq.show(),this._curPanel=this.faq;break;case game.WelfareType.ROULETTE:this.roulette||(this.roulette=new game.WelfareRoulettePanel,this.roulette.addToParent(this._skin.page)),this.roulette.show(),this._curPanel=this.roulette;break;case game.WelfareType.WEEK_SIGN_PANEL:this.weekSign||(this.weekSign=new game.WelfareWeekSignPanel,this.weekSign.addToParent(this._skin.page)),this.weekSign.show(),this._curPanel=this.weekSign,this._skin.bgList.height=645;break;case game.WelfareType.VIP_ROULETTE:this.vipRoulette||(this.vipRoulette=new game.WelfareVipPanel,this.vipRoulette.addToParent(this._skin.page)),this._skin.bgList.active=!1,this.vipRoulette.show(),this._curPanel=this.vipRoulette;break;case game.WelfareType.MONDAY:this.monday||(this.monday=new game.WelfareMondayPanel,this.monday.addToParent(this._skin.page)),this.monday.show(),this._curPanel=this.monday;break;case game.WelfareType.RETRIEVE_PANEL:this.retrieve||(this.retrieve=new game.WelfareRetrievePanel,this.retrieve.addToParent(this._skin.page)),this._skin.bgList.height=570,this.retrieve.show(),this._curPanel=this.retrieve}},setTab:function(e){return!!this._skin&&("0"==e?(game.welfare.selectSubType=game.WelfareType.COVER_PANEL,this.selectTypeChange()):"1"==e?(game.welfare.selectSubType=game.WelfareType.SIGN_PANEL,this.selectTypeChange()):"2"==e?(game.welfare.selectSubType=game.WelfareType.FUND_PANEL,this.selectTypeChange()):"3"==e?(game.welfare.selectSubType=game.WelfareType.CDKEY_PANEL,this.selectTypeChange()):"4"==e?(game.welfare.selectSubType=game.WelfareType.ONLINE_PANEL,this.selectTypeChange()):"5"==e?(game.welfare.selectSubType=game.WelfareType.FORESHOW_PANEL,this.selectTypeChange()):"6"==e?(game.welfare.selectSubType=game.WelfareType.FAQ_PANEL,this.selectTypeChange()):"7"==e?(game.welfare.selectSubType=game.WelfareType.WEEK_SIGN_PANEL,this.selectTypeChange()):"8"==e?(game.welfare.selectSubType=game.WelfareType.MONDAY,this.selectTypeChange()):"9"==e&&(game.welfare.selectSubType=game.WelfareType.RETRIEVE_PANEL,this.selectTypeChange()),!0)}})},{}],985:[function(e,t,i){"use strict";game.WelfareRetrieveItem=game.SkinUI.extends({_prizeInfo:null,_prizeList:null,_data:null,_bg:null,ctor:function(){this._super("welfare/WelfareRetrieveItemSkin","WelfareRetrieveItemSkin"),this._prizeInfo=new game.PrizeInfo},init:function(){this._prizeList||(this._prizeList=new game.PrizeList(3,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_100,1),this._prizeList.addToParent(this._skin.prize)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(.5,.5),this._bg.addToParent(this._skin.itemBg),this._bg.loadTexture(game.ClientCfg.getImgUrl("welfare/retrieve_bg",!0),null,null,{useManifest:!1}))},onShow:function(){b8e.evt.onC(this._skin.moneyRetrieve,this.moneyRetrieve,this),b8e.evt.onC(this._skin.goldRetrieve,this.goldRetrieve,this),b8e.evt.onC(this._skin.vipAlert,this.goToVip,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.moneyRetrieve,this.moneyRetrieve,this),b8e.evt.offC(this._skin.goldRetrieve,this.goldRetrieve,this),b8e.evt.offC(this._skin.vipAlert,this.goToVip,this)},setData:function(e){if(this._data=e,this._skin){var t=game.ccfg.WelfareRetrieveCfg.getDataById(e.retrieveType);if(t){var i=game.retrieve.getRetrievePrize(this._data.retrieveType);i&&(this._prizeInfo.setupById(i),this._prizeList.setData(this._prizeInfo)),this._skin.itemName.string=t.title;var n=game.retrieve.getMaxCountByType(this._data.retrieveType);this._skin.times.string=game.ccfg.LangCfg.getText(70002,[this._data.count,n]);var s=game.vip.getVipLv();0<this._data.count?(this._skin.have.active=!0,this._skin.dontHave.active=!1,this._skin.vipAlert.active=!1,this._skin.money.string=game.ValueUtil.formatNumber(t.goldCost),this._skin.gold.string=game.ValueUtil.formatNumber(t.diamondCost)):(this._skin.have.active=!1,3<=s?(this._skin.dontHave.active=!0,this._skin.vipAlert.active=!1):(this._skin.dontHave.active=!1,this._skin.vipAlert.active=!0))}}},moneyRetrieve:function(){this._data&&game.retrieve.retrieveByType(this._data.retrieveType,!0)},goldRetrieve:function(){this._data&&game.retrieve.retrieveByType(this._data.retrieveType,!1)},goToVip:function(){game.VipMgr.inst().openVipPanelToLv(3)},getHeight:function(){return 188},getWidth:function(){return 540}})},{}],986:[function(e,t,i){"use strict";game.WelfareRetrievePanel=game.SkinUI.extends({_list:null,ctor:function(){this._super("welfare/WelfareRetrieveSkin","WelfareRetrieveSkin")},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.WelfareRetrieveItem))},onShow:function(){b8e.evt.onC(this._skin.moneyRetrieve,this.moneyRetrieve,this),b8e.evt.onC(this._skin.goldRetrieve,this.goldRetrieve,this),b8e.evt.onC(this._skin.help,this.onHelp,this),b8e.evt.addG(this,game.RetrieveEvent.DATAS_CHANGE,this.updatePanel),game.retrieve.getDatas(),this._list&&this._list.show()},onHide:function(){b8e.evt.offC(this._skin.moneyRetrieve,this.moneyRetrieve,this),b8e.evt.offC(this._skin.goldRetrieve,this.goldRetrieve,this),b8e.evt.offC(this._skin.help,this.onHelp,this),b8e.evt.rmvG(this,game.RetrieveEvent.DATAS_CHANGE,this.updatePanel),this._list&&this._list.hide()},updatePanel:function(){var e=game.retrieve.retrieveDatas;if(!e||0==e.length)return this._skin.dontHave.active=!0,void(this._skin.have.active=!1);if(!game.retrieve.haveRetrieveTimes())return this._skin.dontHave.active=!0,void(this._skin.have.active=!1);this._skin.dontHave.active=!1,this._skin.have.active=!0,e.sort(this.sortDatas),this._list.setData(e);var t=game.retrieve.getAllRetrieveCost(!0),i=game.retrieve.getAllRetrieveCost(!1);this._skin.money.string=game.ValueUtil.formatNumber(t),this._skin.gold.string=game.ValueUtil.formatNumber(i)},sortDatas:function(e,t){return 0!=e.count&&0!=t.count?t.sortId-e.sortId:t.count-e.count},moneyRetrieve:function(){game.retrieve.retrieveAll(!0)},goldRetrieve:function(){game.retrieve.retrieveAll(!1)},onHelp:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.RETRIEVE_RULE_ID)}})},{}],987:[function(e,t,i){"use strict";game.WelfareRoulettePanel=game.SkinUI.extends({_prizeList:null,_prizeInfo:null,_timer:null,_marqueeController:null,posArrayX:null,posArrayY:null,isEnd:!0,rewardBoxes:null,ctor:function(){this._super("welfare/WelfareRouletteSkin","WelfareRouletteSkin")},init:function(){game.active.selectSubType=game.ActiveSubType.ST_ZHUANPAN_FOREVER,this.posArrayX=[],this.posArrayY=[],this.rewardBoxes=[],this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("active/discount/bgRoulette",!0),null,null,{useManifest:!1}),this.createGrids(),this.creatBoxes(),this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.icon_item1),this._onceCostSprite.setSize(30,30),this._tenCostSprite=b8e.Sprite.get(),this._tenCostSprite.addToParent(this._skin.icon_item10),this._tenCostSprite.setSize(30,30),this._skin.lab_desc.string="",this._anim=b8e.Animator.get(game.AnimatorType.ROULETTE_EFFECT,1),this._anim.addToParent(this._skin.effect),this._anim.setBlendMode(b8e.BlendMode.ADD)},onShow:function(){game.active.selectSubType=game.ActiveSubType.ST_ZHUANPAN_FOREVER,this.updatePanel(),b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.addG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.addG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes)},onHide:function(){this._timer&&this._timer.stop(),b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack),b8e.evt.rmvG(this,game.RouletteEvents.RESET_ROULETTE,this.updatePrice),b8e.evt.rmvG(this,game.RouletteEvents.COLLECT_COUNT_AWARD_SUCCESS,this.updateBoxes)},zhuanPanCallBack:function(){this.updatePanel(),game.roulette.zhuanPanCallBack()},updatePanel:function(){this.updatePrice(),this.updateProgress(),this.updateBoxes()},updateTime:function(){var e=b8e.TimeUtil.getNextDateTime(game.SysTime.curTime)-game.SysTime.curTime;this._skin.lab_freeTime.string=0<e?b8e.TimeUtil.formatTime(e)+"后免费":""},updateProgress:function(){var e=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER),t=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER);0<e&&(this._skin.progress_bar_node.width=this._skin.progress_mask.width*t/e),this._skin.lab_buyCount.string=t+"次"},updatePrice:function(){var e=game.ccfg.ZhuanPanCostCfg.getRaffleCountByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER),t=game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER);if(0<e&&(this._skin.lab_remainTimes.string="剩余购买次数:"+(e-t)+"次"),game.roulette.getFreeUsedByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER)){this._timer||(this._timer=b8e.Timer.add(this,this.updateTime,1e3)),this._timer.start(),this._skin.lab_free.string="",this._skin.node_priceOne.active=!0;var i=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_FOREVER,game.ZhuanPanCostType.ONCE_COST);if(this._skin.lab_onePrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_FOREVER,game.ZhuanPanCostType.ONCE_COST),i==game.AmountItemId.SILVER)this._skin.node_yinbi.active=!0,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!1;else if(i==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!0,this._skin.icon_item1.active=!1;else{this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!0;var n=game.ccfg.ItemInfoCfg.getIconNameById(i);if(n){var s=game.ClientCfg.getImgUrl(n);this._onceCostSprite.loadTexture(s,null,null,{useManifest:!1})}}}else this._timer&&this._timer.stop(),this._skin.lab_freeTime.string="",this._skin.lab_free.string="免费",this._skin.node_priceOne.active=!1;var a=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_FOREVER,game.ZhuanPanCostType.MULTIPLE_COST);if(this._skin.lab_tenPrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_FOREVER,game.ZhuanPanCostType.MULTIPLE_COST),a==game.AmountItemId.SILVER)this._skin.node_yinbi10.active=!0,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!1;else if(a==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!0,this._skin.icon_item10.active=!1;else{this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!0;var o=game.ccfg.ItemInfoCfg.getIconNameById(a);if(o){s=game.ClientCfg.getImgUrl(o);this._tenCostSprite.loadTexture(s,null,null,{useManifest:!1})}}},creatBoxes:function(){var e,t,i=game.roulette.getRouletteBox(game.ActiveSubType.ST_ZHUANPAN_FOREVER);if(i&&0<i.length)for(var n=game.ccfg.CountAwardCfg.getMaxAwardCountByType(game.ActiveSubType.ST_ZHUANPAN_FOREVER),s=i.length,a=0;a<s;a++)(t=i[a])&&((e=new game.RouletteBox).addToParent(this._skin.box),0<n&&e.setPosition(t.count/parseInt(n)*this._skin.progress_mask.width,0),e.setData(t),e.setVisible(!0),e.show(),this.rewardBoxes.push(e))},updateBoxes:function(){var e,t=game.roulette.getRouletteBox(game.ActiveSubType.ST_ZHUANPAN_FOREVER);if(this.rewardBoxes&&0<this.rewardBoxes.length)for(var i=this.rewardBoxes.length,n=0;n<i;n++)e=t[n],this.rewardBoxes[n].setData(e)},createGrids:function(){var e,t,i,n,s,a=[],o=game.roulette.getZhuanPanArr();if(o&&0<o.length){for(var r=0;r<10;r++)(i=game.GridUtil.creatItemGrid(this,this._skin.item)).gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),s=o[r],(n=game.ccfg.ItemInfoCfg.getItemInfoById(s.itemId,!0))&&(n.num=s.itemNum,game.GridUtil.setItemGrid(i,n),i.fnOnClick(this,this.onClick),i.setNum(s.itemNum),e=198*Math.sin((36*r+18)*Math.PI/180),t=198*Math.cos((36*r+18)*Math.PI/180),this.posArrayX.push(e),this.posArrayY.push(t),i.setPosition(e,t),i.sortLayer(),a.push(i));this._marqueeController=new game.Roulette(this,[[5,1]],this.posArrayX,this.posArrayY,this.runingFun,this.runCompleteFun)}},runingFun:function(e){var t=game.roulette.getZhuanPanArr();t&&t.length&&(e==t.length&&(e=0),this._skin.effect.x=this._skin.item.x+this.posArrayX[e],this._skin.effect.y=this._skin.item.y+this.posArrayY[e])},runCompleteFun:function(){this.isEnd=!0,game.roulette.zhuanPanCallBack()},startMarquee:function(){this.isEnd=!1,this.showEffect();var e=game.roulette.zpStopIndex,t=game.roulette.getZhuanPanArr();t&&0<t.length&&(0==e&&(e=t.length),this._marqueeController.run(this._skin.effect,e))},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClick:function(e){e&&e.faceInfo&&game.CCommonUtil.showItemTips(e)},onClickBuyOnce:function(){this.isEnd&&game.roulette.clickBuyOnce(game.ActiveSubType.ST_ZHUANPAN_FOREVER)},onClickBuyZehnmal:function(){this.isEnd&&game.roulette.clickBuyZehnmal(game.ActiveSubType.ST_ZHUANPAN_FOREVER)},showEffect:function(){this._anim&&this._anim.setVisible(!0);var e=game.ClientCfg.getUIFxs("10073");e?(this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}})},{}],988:[function(e,t,i){"use strict";game.WelfareSignPanel=game.SkinUI.extends({_allWelfareInfo:null,_gridsArr:null,_curGridArr:null,_nextCostInfo:null,_nextCost:-1,_list:null,ctor:function(){this._super("welfare/WelfareSignSkin","WelfareSignSkin"),this._gridsArr=[],this._curGridArr=[]},init:function(){this._list=new b8e.List(this._skin.list_signIn,game.SignGrid,5)},onShow:function(){this._list.show(),this.updateGrids(),b8e.evt.addG(this,game.WelfareEvents.CHANGE_TURN,this.updateGrids),b8e.evt.addG(this,game.WelfareEvents.SIGN_SUCCESS,this.updateGrids)},onHide:function(){b8e.evt.rmvG(this,game.WelfareEvents.SIGN_SUCCESS,this.updateGrids),b8e.evt.rmvG(this,game.WelfareEvents.CHANGE_TURN,this.updateGrids),this._list&&this._list.hide()},updateGrids:function(){this._allWelfareInfo=game.welfare.getAllWelfareInfo(),this._allWelfareInfo.signId=game.welfare.getSignId();var e=game.welfare.getAllGridsInfo(this._allWelfareInfo.signId);e&&0<e.length&&this._list.setData(e)}})},{}],989:[function(e,t,i){"use strict";game.WelfareTotemPanel=game.SkinUI.extends({_allWelfareInfo:null,_count:0,_red:null,_white:null,_reward:null,_oldy:-1,_totemSprite:null,ctor:function(){this._super("welfare/WelfareTotemSkin","WelfareTotemSkin"),this._red=b8e.ColorUtil.toCCColor(4294901760),this._white=b8e.ColorUtil.toCCColor(4294967295),this._reward=b8e.ColorUtil.toCCColor(4293384103)},init:function(){this._totemSprite=b8e.Sprite.get(),this._totemSprite.addToParent(this._skin.img_totemBg),this._totemSprite.loadTexture(game.ClientCfg.getImgUrl("welfare/totemBg"),null,null,{useManifest:!1}),this._sceneLayer=b8e.BaseDisplay.get(),this._sceneLayer.addToParent(this._skin.node_animation),this._anim=b8e.Animator.get(game.AnimatorType.WELFARE_EFFECT,1),this._sceneLayer.addChild(this._anim)},onShow:function(){this._skin.img_crit.opacity=0,-1==this._oldy&&(this._oldy=this._skin.img_crit.y),this.updateCoverGlodPanel(null),this.showModel(),b8e.evt.onC(this._skin.btn_use,this.clickUseTotem,this),b8e.evt.addG(this,game.WelfareEvents.COVER_GLOD_SUCCESS,this.updateCoverGlodPanel)},onHide:function(){this.clearAnimator(),b8e.Tween.kill(this._skin.img_crit),b8e.evt.offC(this._skin.btn_use,this.clickUseTotem,this),b8e.evt.rmvG(this,game.WelfareEvents.COVER_GLOD_SUCCESS,this.updateCoverGlodPanel)},updateCoverGlodPanel:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._allWelfareInfo=game.welfare.getAllWelfareInfo(),this.showNowPrice(),this.updateCoverReward(),this.showTotemCount(),e&&this.playCritAnimation()},clickUseTotem:function(){var e=game.vip.getCoverGoldCount();game.back.getAmountInfo().getValue(game.AmountType.YUAN_BAO)>=this._nextCost?game.welfare.getConvertGoldTimes()<e?(this.showTotemCount(),game.WelfareSender.reqConvertGold()):game.gameAlert.showVipAlert(!1,100):game.gameAlert.showVipAlert(!0,101);this.showNowPrice()},updatePrice:function(){var e=game.vip.getCoverGoldCount(),t=game.welfare.getConvertGoldTimes();e<t?t=e:t<1&&(t=0);var i=game.ccfg.CostCfg.getMaxBuyCountById(game.SystemId.TOTEM_COUNT);this._nextCostInfo=i<=t?game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.TOTEM_COUNT,i):game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.TOTEM_COUNT,t+1),this._nextCost=this._nextCostInfo.upgradeInfo.amountInfo.getValue(game.AmountType.YUAN_BAO)},updateCoverReward:function(){var e=game.mainRole.mainRoleData.getLv(),t=game.ccfg.WelfareGoldCfg.getCoverGoldByLv(e),i=game.ccfg.LangCfg.getText("本次使用可获得$银币",[game.html.getText(game.html.REWARD_COLOR,t)]);this._skin.lab_reward.string=i},showNowPrice:function(){this.updatePrice(),this._skin.lab_price.string=this._nextCost+""},playCritAnimation:function(){game.welfare.getIsCrit()&&this.critAnimation()},critAnimation:function(){this._skin.img_crit.y=this._oldy,this._skin.img_crit.opacity=255,b8e.Tween.kill(this._skin.img_crit),this._skin.img_crit.scaleX=1.7,this._skin.img_crit.scaleY=1.7,b8e.Tween.get(this._skin.img_crit).to({scaleX:1,scaleY:1},100).call(this.scaleAnim,this)},scaleAnim:function(){b8e.Tween.kill(this._skin.img_crit);var e=this._skin.img_crit.x,t=this._skin.img_crit.y;b8e.Tween.get(this._skin.img_crit).to({x:e,y:t},500,b8e.Ease.getElasticInOut).call(this.riseAnim,this,[t])},riseAnim:function(e){b8e.Tween.kill(this._skin.img_crit),b8e.Tween.get(this._skin.img_crit).to({y:e+20,opacity:0},500).call(this.restoreAnim,this)},restoreAnim:function(){b8e.Tween.kill(this._skin.img_crit),this._skin.img_crit.opacity=0,this._skin.img_crit.y=this._oldy},showTotemCount:function(){var e=game.vip.getCoverGoldCount(),t=game.welfare.getConvertGoldTimes();e<=t?(t=e,this._skin.lab_count.node.color=this._red):this._skin.lab_count.node.color=this._white,this._skin.lab_count.string=(e-t).toString()+"/"+e},showModel:function(){var e=game.ClientCfg.getUIFxs("10014");e?(this._anim.load(e),this._sceneLayer.setVisible(!0),this._anim.setScale(4,4),this._anim.play()):this._anim&&this._anim.clear()},clearAnimator:function(){this._anim&&this._anim.clear(),this._sceneLayer&&this._sceneLayer.setVisible(!1)}})},{}],990:[function(e,t,i){"use strict";game.WelfareVipPanel=game.SkinUI.extends({_bgSprite:null,_descSprite:null,_onceCostSprite:null,_tenCostSprite:null,vipArr:null,commonArr:null,ctor:function(){this._super("welfare/WelfareVipSkin","WelfareVipSkin"),this.vipArr=[],this.commonArr=[]},init:function(){game.active.selectSubType=game.ActiveSubType.ST_ZHUANPAN_VIP;var e=game.roulette.getZhuanPanArr();this.setArr(e),game.CCommonUtil.createRectGrids(this.commonArr,this,this._skin.item,this.onClick,8),this.creatBianshenGrids(),this._bgSprite=b8e.Sprite.get(),this._bgSprite.addToParent(this._skin.node_bg),this._bgSprite.loadTexture(game.ClientCfg.getImgUrl("welfare/vipBg",!0),null,null,{useManifest:!1}),this._descSprite=b8e.Sprite.get(),this._descSprite.addToParent(this._skin.node_desc),this._descSprite.loadTexture(game.ClientCfg.getImgUrl("welfare/vipDesc",!1),null,null,{useManifest:!1}),this._onceCostSprite||(this._onceCostSprite=b8e.Sprite.get(),this._onceCostSprite.addToParent(this._skin.icon_item1),this._onceCostSprite.setSize(30,30)),this._tenCostSprite||(this._tenCostSprite=b8e.Sprite.get(),this._tenCostSprite.addToParent(this._skin.icon_item10),this._tenCostSprite.setSize(30,30)),this.updatePrice()},onShow:function(){game.active.selectSubType=game.ActiveSubType.ST_ZHUANPAN_VIP,b8e.evt.onC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.onC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.onC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.addG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},onHide:function(){b8e.evt.offC(this._skin.btn_wenhao,this.onClickWenHao,this),b8e.evt.offC(this._skin.btn_one,this.onClickBuyOnce,this),b8e.evt.offC(this._skin.btn_ten,this.onClickBuyZehnmal,this),b8e.evt.rmvG(this,game.RouletteEvents.ZHUANPAN_SUCCESS,this.zhuanPanCallBack)},zhuanPanCallBack:function(){game.roulette.zhuanPanCallBack()},setArr:function(e){if(e&&!(e.length<=0))for(var t,i=0;i<e.length;i++)(t=e[i]).vip?this.vipArr.push(t):this.commonArr.push(t)},updatePrice:function(){game.roulette.getZhuanPanCountByType(game.ActiveSubType.ST_ZHUANPAN_VIP);var e=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_VIP,game.ZhuanPanCostType.ONCE_COST);if(this._skin.lab_onePrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_VIP,game.ZhuanPanCostType.ONCE_COST),e==game.AmountItemId.SILVER)this._skin.node_yinbi.active=!0,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!1;else if(e==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!0,this._skin.icon_item1.active=!1;else{this._skin.node_yinbi.active=!1,this._skin.node_yuanbao.active=!1,this._skin.icon_item1.active=!0;var t=game.ccfg.ItemInfoCfg.getIconNameById(e);if(t){var i=game.ClientCfg.getImgUrl(t);this._onceCostSprite.loadTexture(i,null,null,{useManifest:!1})}}var n=game.ccfg.ZhuanPanCostCfg.getCostItemId(game.ActiveSubType.ST_ZHUANPAN_VIP,game.ZhuanPanCostType.MULTIPLE_COST);if(this._skin.lab_tenPrice.string=game.ccfg.ZhuanPanCostCfg.getCostNum(game.ActiveSubType.ST_ZHUANPAN_VIP,game.ZhuanPanCostType.MULTIPLE_COST),n==game.AmountItemId.SILVER)this._skin.node_yinbi10.active=!0,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!1;else if(n==game.AmountItemId.YUAN_BAO)this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!0,this._skin.icon_item10.active=!1;else{this._skin.node_yinbi10.active=!1,this._skin.node_yuanbao10.active=!1,this._skin.icon_item10.active=!0;var s=game.ccfg.ItemInfoCfg.getIconNameById(n);if(s){i=game.ClientCfg.getImgUrl(s);this._tenCostSprite.loadTexture(i,null,null,{useManifest:!1})}}},creatBianshenGrids:function(){if(this.vipArr&&!(this.vipArr.length<=0))for(var e,t,i,n=0;n<3;n++)e=this.vipArr[n],t=game.ccfg.BianshenCfg.getBianshenCfgById(e.itemId),(i=new game.ItemGrid(game.IcoSizeEnum.SIZE_107)).gridInfo=new game.GridInfo(game.ContainerId.VIP_SHOW_BIANSHEN_GRID),i.addToParent(this._skin.vipItem),i.setPosition(135*n,0),i.fnOnClick(this,this.onClickBianshen),game.GridUtil.setBianshenGrid(i,t,!0,!1,!1,!0,!1,!1),i.setTag(!0,e.vip),i.setRedIcon(!1),i.sortLayer()},onClickWenHao:function(){game.active.openDescPanel(game.active.ACTIVE_DESC)},onClickBuyOnce:function(){game.roulette.clickBuyOnce(game.ActiveSubType.ST_ZHUANPAN_VIP)},onClickBuyZehnmal:function(){game.roulette.clickBuyZehnmal(game.ActiveSubType.ST_ZHUANPAN_VIP)},onClick:function(e){e&&e.faceInfo&&(game.back.isBianshenCard(e.faceInfo.id)?game.bianshen.showBianshenDetail(e.faceInfo):game.CCommonUtil.showItemTips(e))},onClickBianshen:function(e){e.faceInfo&&game.bianshen.showBianshenDetail(e.faceInfo)}})},{}],991:[function(e,t,i){"use strict";game.WelfareWeekSignPanel=game.SkinUI.extends({_dayItems:null,_bg:null,ctor:function(){this._super("welfare/WelfareWeekSign","WelfareWeekSignSkin")},init:function(){var e,t,i;this._dayItems=[];for(var n=1;n<=7;n++)(t=game.ccfg.WeekSignCfg.getDataById(n))&&(i=this._skin["item_"+n],(e=new game.WelfareDayItem).setCfg(t),e.show(),e.addToParent(i),this._dayItems.push(e));this._bg||(this._bg=b8e.Sprite.get(),this._bg.setAnchor(.5,.5),this._bg.addToParent(this._skin.bigBg),this._bg.loadTexture(game.ClientCfg.getImgUrl("welfare/weekSign",!0),null,null,{useManifest:!1}));var s=game.welfare.getAllWelfareInfo(),a=s.weekStartTime+b8e.TimeUtil.DAY_MICRO_SECONDS;this._skin.time.string="活动时间:"+b8e.TimeUtil.formatTimestamp(a,"Y-M-D",!0)+" - "+b8e.TimeUtil.formatTimestamp(s.weekEndTime,"Y-M-D",!0)},onShow:function(){b8e.evt.addG(this,game.WelfareEvents.WEEK_SIGN_SUCCESS,this.showItems),this.showItems()},onHide:function(){b8e.evt.rmvG(this,game.WelfareEvents.WEEK_SIGN_SUCCESS,this.showItems)},showItems:function(){for(var e=this._dayItems.length,t=0;t<e;t++)this._dayItems[t].updateData()}}),game.WelfareDayItem=game.SkinUI.extends({cfg:null,_items:null,repairSign:null,_effect:null,ctor:function(){this._super("welfare/WelfareDayItemSkin","WelfareDayItemSkin")},init:function(){this.setCfg(this.cfg)},onShow:function(){this.updateData(),b8e.evt.onC(this._skin.touch,this.onClick,this)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onClick,this)},setCfg:function(e){if(this.cfg=e,this._skin&&e.items){this._items=[];for(var t=e.items.length,i=t*game.IcoSizeEnum.SIZE_90/2*-1,n=0;n<t;n++){var s=e.items[n],a=new game.ItemInfo;game.ItemInfoUtil.createCfgItemInfo(a,s.Id),a.num=s.Num;var o=new game.ItemGrid(game.IcoSizeEnum.SIZE_90);o.gridInfo=new game.GridInfo(game.ContainerId.WELFARE_WEEK_SIGN_CONTAINER_ID),o.addToParent(this._skin.item),o.fnOnClick(this,this.onClick),game.GridUtil.setItemGrid(o,a,!1),o.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),o.iconSize=game.IcoSizeEnum.SIZE_90,o.setImgSelect(!1,1),o.sortLayer(),o.setPosition(i+(n+.5)*game.IcoSizeEnum.SIZE_90,0),this._items.push(o)}this._skin.touch.width=t*game.IcoSizeEnum.SIZE_100,this.repairSign||(this.repairSign=b8e.Sprite.get(),this.repairSign.setAnchor(.5,.5),this.repairSign.addToParent(this),this.repairSign.setPosition(7==this.cfg.signDay?100:40,-40),this.repairSign.loadTexture(game.ClientCfg.getImgUrl("welfare/repairSign"),null,null,{useManifest:!1}))}},updateData:function(){if(this._skin&&this.cfg){for(var e=game.WelfareMgr.inst(),t=e.isSignDay(this.cfg.signDay),i=e.isRepairSign(this.cfg.signDay),n=e.isTodaySign(),s=this._items.length,a=0;a<s;a++){var o=this._items[a];t?(o.setImgSelect(!0,1),o.clearEffect()):(o.setImgSelect(!1,1),i?o.setEffect("10009",game.AnimatorType.ITEM_EFFECT):o.clearEffect(),o.sortLayer())}t?this.repairSign.setVisible(!1):i&&n?this.repairSign.setVisible(!0):this.repairSign.setVisible(!1)}},onClick:function(){game.WelfareMgr.inst().weekSign(this.cfg.signDay)}})},{}],992:[function(e,t,i){"use strict";e("./WelfarePanel"),e("./SignGrid"),e("./MillionAwardRecordItem"),e("./MillionAwardPanel"),e("./WelfareMondayPanel")},{"./MillionAwardPanel":973,"./MillionAwardRecordItem":974,"./SignGrid":976,"./WelfareMondayPanel":982,"./WelfarePanel":984}],993:[function(e,t,i){"use strict";game.RetrieveSender={},game.RetrieveSender.getDatas=function(){var e=game.pbmid.Retrieve.RetrieveModuleRequest;b8e.sendN(e)},game.RetrieveSender.singleRetrieveRequest=function(e,t){var i=game.pbmsg.SingleRetrieveRequest;i.retrieveType=e,i.costType=t?1:2,engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Retrieve.SingleRetrieveRequest;b8e.sendN(n)},game.RetrieveSender.batchRetrieveRequest=function(e){var t=game.pbmsg.BatchRetrieveRequest;t.costType=e?1:2,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Retrieve.BatchRetrieveRequest;b8e.sendN(i)}},{}],994:[function(e,t,i){"use strict";var n=game.WelfareSender=function(){};n.reqWelfareInfo=function(){var e=game.pbmid.Welfare.WelfareModuleRequest;b8e.sendN(e)},n.reqConvertGold=function(){var e=game.pbmid.Welfare.ConvertGoldRequest;b8e.sendN(e)},n.reqSign=function(){var e=game.pbmid.Welfare.SignRequest;b8e.sendN(e)},n.getSharePrize=function(){var e=game.pbmid.Welfare.ShareAwardRequest;b8e.sendN(e)},n.sendDesktopPrizeRequest=function(){var e=game.pbmid.Welfare.SendDesktopPrizeRequest;b8e.sendN(e)},n.wanbaPrizeRequest=function(e){var t=game.pbmsg.WanbaPrizeRequest;t.id=e,t.openId=game.QzoneSDK.getOpenid(),t.openKey=game.QzoneSDK.getOpenkey(),t.pf=game.QzoneSDK.getPf(),t.qua=game.QzoneSDK.getQua(),b8e.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Welfare.WanbaPrizeRequest;b8e.sendN(i)},n.sendFocusPrizeRequest=function(){var e=game.pbmid.Welfare.FocusPrizeRequest;b8e.sendN(e)},n.exchangeCouponRequest=function(e){var t=game.pbmsg.ExchangeCouponRequest;t.serialNum=e,b8e.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Welfare.ExchangeCouponRequest;b8e.sendN(i)},n.sendMicroPrizeRequest=function(){var e=game.pbmid.Welfare.MicroPrizeRequest;b8e.sendN(e)},n.reqCollectOnlineAward=function(e){var t=game.pbmsg.CollectOnlineAwardRequest;t.time=e,b8e.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Welfare.CollectOnlineAwardRequest;b8e.sendN(i)},n.reqMillionAwardDataRequest=function(){if(game.funcOpen.checkOpen(game.FunctionType.MILLION_AWARD)){var e=game.pbmid.Welfare.MillionAwardDataRequest;b8e.sendN(e)}},n.reqMillionAwardRequest=function(){var e=game.pbmid.Welfare.MillionAwardRequest;b8e.sendN(e)},n.weekSignRequest=function(){var e=game.pbmid.Welfare.WeekSignRequest;b8e.sendN(e)},n.reqMondayAwardCollectRequest=function(){var e=game.pbmid.Welfare.MondayAwardCollectRequest;b8e.sendN(e)},n.sendRealVerifyPrizeRequest=function(){var e=game.pbmid.Welfare.VerifyAwardRequest;b8e.sendN(e)},n.sendJDAwardRequest=function(){var e=game.pbmid.Welfare.JDAwardRequest;b8e.NetSender.send(e)}},{}],995:[function(e,t,i){"use strict";e("./WelfareSender")},{"./WelfareSender":994}],996:[function(e,t,i){"use strict";e("./cmdlistener/cmdlistenerIndex_81"),e("./manager/managerIndex_81"),e("./panel/panelIndex_81"),e("./sender/senderIndex_81"),e("./enum/signIndex_81"),e("./event/eventIndex_81"),e("./sender/senderIndex_81")},{"./cmdlistener/cmdlistenerIndex_81":961,"./enum/signIndex_81":965,"./event/eventIndex_81":968,"./manager/managerIndex_81":971,"./panel/panelIndex_81":992,"./sender/senderIndex_81":995}],997:[function(e,t,i){"use strict";game.appModule.WingPanel=game.SkinUIPanel.extends({_skin:null,_model:null,_protoId:0,ctor:function(e){this._super(e),this._skin=this._skin,this.init()},init:function(){if(0==this._protoId){var e=game.mainRole.mainRoleData.wingModuleData;0<e.defaultProtoId?this.setProtoId(e.defaultProtoId):this.setProtoId(10001)}},setProtoId:function(e){if(0<e){if(this._protoId==e)return;this._protoId=e,this._loadModel()}},onShow:function(){this.registerOrUnregisterEvent(!0),b8e.log("this wing skin is open!!!!")},onHide:function(){this.registerOrUnregisterEvent(!1)},registerOrUnregisterEvent:function(e){e?(b8e.evt.onC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.onC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.onC(this._skin.useBtn,this._onClickUseBtn,this)):(b8e.evt.offC(this._skin.prevBtn,this._onClickPrevBtn,this),b8e.evt.offC(this._skin.nextBtn,this._onClickNextBtn,this),b8e.evt.offC(this._skin.useBtn,this._onClickUseBtn,this))},_loadModel:function(){var n=this;this._model?this._model.show(this._protoId):b8e.res.loadRes("UIWingModel","UIWingModel",function(e,t){var i=cc.instantiate(t);n._skin.modelRoot.addChild(i),n._model=i.getComponent("UIWingModel"),n._loadModel()},this)},_onClickPrevBtn:function(){if(0<this._protoId){var e=cc.clampf(this._protoId-1,10001,10011);e!=this._protoId&&this.setProtoId(e)}},_onClickNextBtn:function(){if(0<this._protoId){var e=cc.clampf(this._protoId+1,10001,10011);e!=this._protoId&&this.setProtoId(e)}},_onClickUseBtn:function(){if(0<this._protoId){var e=game.mainRole.mainRoleData.wingModuleData;e.defaultProtoId=this._protoId,e.isWeared=!0}}})},{}],998:[function(e,t,i){"use strict";e("./WingPanel")},{"./WingPanel":997}],999:[function(e,t,i){"use strict";e("./panel/panelIndex_23")},{"./panel/panelIndex_23":998}],1e3:[function(e,t,i){"use strict";game.WorldBossMgr=b8e.Object.extends({name:"WorldBossMgr",damage:0,yinbiInspire:0,yuanbaoInspire:0,worldBossMap:null,ranks:null,urank:null,bossId:0,bossHp:0,eid:0,maxRankIndex:10,maxSceneRankIndex:5,worldBossAwardInfo:null,serverDate:30,bossTestHp:200,bool:!1,_timer:null,_activeWorldBossInfo:null,isCsWorldBoss:!1,ctor:function(){if(1==game.WorldBossMgr._singleton)throw new Error("WorldBossMgr 只能通过单例方法获取");this._super(),this.worldBossMap=b8e.HashMap.get(),this.ranks=[],this.init()},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.sendWorldBossModule),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.sendWorldBossModule),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.sendWorldBossModule)},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.WORLD_BOSS)&&(this.isRequest=!0,game.SceneSender.bossActivityListRequest())},sendWorldBossModule:function(){game.funcOpen.checkOpen(game.FunctionType.WORLD_BOSS)&&(this.isRequest||(this.isRequest=!0,game.SceneSender.bossActivityListRequest()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.sendWorldBossModule),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.sendWorldBossModule),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.sendWorldBossModule))},resetDaily:function(){game.SceneSender.bossActivityListRequest()},setWorldBoss:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null).list;if(e&&!(e.length<0)){for(var t=0;t<e.length;t++){var i=e[t],n=new game.WorldBossUnit;n.setData(i);var s=i.ranks;if(!s)return;for(var a,o,r=game.mainRole.mainRoleData,h=!1,g=0;g<s.length&&!(g>=this.maxRankIndex);g++)o=s[g],(a=new game.WorldBossRankInfo).setData(o),o.roleId==r.playerId&&(n.urank=a,h=!0),n.ranks.push(a);if(!h)for(var l=0;l<s.length;l++)if((o=s[l]).roleId==r.playerId){n.urank||(n.urank=new game.WorldBossRankInfo),n.urank.setData(o);break}this.worldBossMap.set(n.id,n)}b8e.evt.dptG(game.SceneEvent.UPDATE_ALL_WORLD_BOSS)}},setWorldBossById:function(e){if(e.ranks&&!(e.ranks.length<0)){var t;this.ranks.length=0;var i=e.ranks;if(i&&0<=i.length)for(var n=0;n<i.length&&!(n>=this.maxSceneRankIndex);n++){var s=i[n];(t=new game.WorldBossRankInfo).setData(s),this.ranks.push(t)}this.urank=null,e.urank&&((t=new game.WorldBossRankInfo).setData(e.urank),this.urank=t),this.damage=e.damage,this.yinbiInspire=e.inspireCount1,this.yuanbaoInspire=e.inspireCount2,this.eid=e.unitId,this.bossHp=e.hp,b8e.evt.dptG(game.SceneEvent.UPDATE_WORLD_BOSS),this.setSceneWorldBoss(!1)}},setSceneWorldBoss:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(0!=this.eid){var t,i=game.sceneRole.getDisplayById(this.eid),n=this.bossHp;i&&i.data&&(i.data.spriteStat.setStatValue(game.SpriteStatType.HP,n),t=i.data.spriteStat.getStatValue(game.SpriteStatType.HP),e?this.setSceneBossDead(i):t<=0&&this.setSceneBossDead(i),b8e.evt.dptG(game.AttributesEvents.ATTR_UPDATA),i.updateHpBar())}},setActiveWorldBossInfo:function(e){if(e){this._activeWorldBossInfo||(this._activeWorldBossInfo=new game.ActiveWorldBossInfo);var t=e.ranks;if(t){this._activeWorldBossInfo.setData(e);var i,n,s=game.mainRole.mainRoleData,a=!1,o=0;for(o=this._activeWorldBossInfo.ranks.length=0;o<t.length&&!(o>=this.maxRankIndex);o++)n=t[o],this._activeWorldBossInfo.ranks.length>o?this._activeWorldBossInfo.ranks[o].setData(n):((i=new game.WorldBossRankInfo).setData(n),this._activeWorldBossInfo.ranks.push(i)),n.roleId==s.playerId&&(this._activeWorldBossInfo.urank=this._activeWorldBossInfo.ranks[o],a=!0);if(!a)for(o=0;o<t.length;o++)if((n=t[o]).roleId==s.playerId){this._activeWorldBossInfo.urank||(this._activeWorldBossInfo.urank=new game.WorldBossRankInfo),this._activeWorldBossInfo.urank.setData(n);break}b8e.evt.dptG(game.ActiveEvent.GET_ACTIVE_BOSS)}}},setActiveBossHp:function(e){this._activeWorldBossInfo&&(e<0||(this._activeWorldBossInfo.hp=e))},setSceneBossDead:function(e){e.usable&&!e.getStateMachine().isDeadState()&&(e.transitionState(game.RoleStateType.ACTION_DEATH,null,!0),this.stopTimer())},setWorldBossAwardInfo:function(e){this.worldBossAwardInfo||(this.worldBossAwardInfo=new game.WorldBossAwardInfo),this.worldBossAwardInfo.setData(e),b8e.Tween.kill(this),b8e.Tween.get(this).wait(3e3).call(this.showResultPanle)},showResultPanle:function(){b8e.Tween.kill(this),game.app.show(game.AppConstant.WORLD_BOSS_RESULT_PANEL)},clearResult:function(){b8e.Tween.kill(this)},setTimer:function(){this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateWorldBossInfo,2500)},stopTimer:function(){this._timer&&this._timer.stop()},updateWorldBossInfo:function(){0!=this.bossId&&this.sendWorldBossInfoById(this.bossId)},setWorldBossStateById:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=game.mainRole.mainRoleData.miscData.openServerDay,n=game.ccfg.WorldBossCfg.getData(e,this.getServerByCurServerDate(i));if(n)if(n.actId&&game.ActiveSender.ActivityBossInfoRequest(n.actId),t==game.WorldBossStateType.OPENING){var s=this.worldBossMap.get(e);s&&(s.state=game.WorldBossStateType.OPENING,this.worldBossMap.set(e,s)),game.funcOpen.checkOpen(game.FunctionType.WORLD_BOSS)&&game.SceneQuickEnterMgr.inst().addQuickEnter(this,game.SceneType.WORLDBOSS,this.showQuickEnter,e),b8e.evt.dptG(game.SceneEvent.UPDATE_ALL_WORLD_BOSS)}else this.setSceneWorldBoss(!0),game.SceneQuickEnterMgr.inst().delQuickEnter(game.SceneType.WORLDBOSS),game.app.hide(game.AppConstant.WORLD_BOSS_ENTER_SHOW_PANEL),game.SceneSender.bossActivityListRequest()},showQuickEnter:function(e){game.app.show(game.AppConstant.WORLD_BOSS_ENTER_SHOW_PANEL,e)},inspireComplete:function(e){e&&(this.setDamage(e.damage),e.type==game.AmountType.SILVER?this.yinbiInspire++:this.yuanbaoInspire++,game.notice.show(game.html.getText(game.html.Q_GREEN,"鼓舞成功")),b8e.evt.dptG(game.SceneEvent.UPDATE_WORLD_BOSS_INSPIRE))},enterSceneComplete:function(){this.isCsWorldBoss=!1,game.app.hide(game.AppConstant.DUNGEON_PANEL),game.leaveDungeon.show(0,game.SceneType.WORLDBOSS),this.sendWorldBossInfoById(this.bossId),b8e.evt.dptG(game.SceneEvent.ENTER_WORLD_BOSS)},onLeaveScene:function(){game.SceneSender.leaveAloneDungeon(),this.clearResult(),b8e.evt.dptG(game.SceneEvent.LEAVE_WORLD_BOSS)},setDamage:function(e){this.damage=e},sendWorldBossInfoById:function(e){game.SceneSender.bossActivityInfoRequest(e)},sendYinbiInspire:function(e){this.getInspireDamageIsOver()&&game.notice.show("不能继续提升鼓舞伤害"),game.upgrade.costCheck(this,e,this.yinbiInspireCallBack,!1)},yinbiInspireCallBack:function(e){e?game.SceneSender.bossAcitivtyInspireRequest(game.AmountType.SILVER):game.notice.show(game.html.getText(game.html.Q_RED,"鼓舞失败,银币不足"))},sendYuanbiInspire:function(e){this.getInspireDamageIsOver()&&game.notice.show("不能继续提升鼓舞伤害"),game.upgrade.costCheck(this,e,this.yuanbaoInspireCallBack,!1)},yuanbaoInspireCallBack:function(e){e&&game.SceneSender.bossAcitivtyInspireRequest(game.AmountType.YUAN_BAO)},getInspireIsOver:function(){return!(this.inspire<this.maxYinbiInspire)},getInspireDamageIsOver:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_MAX_INSPIRE_DAMAGE);return!(this.damage<100*e)},getWorldBossRankData:function(e){var t=this.worldBossMap.get(e);return t||null},getWorldBossList:function(){var e=this.worldBossMap.values();return!e&&e.length<0?[]:e},getServerByCurServerDate:function(e){for(var t=e,i=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_SERVER).split("|"),n=i.length-1;0<=n;n--){var s=parseInt(i[n]);if(s<=t)return s}return parseInt(i[0])},getActiveBossInfo:function(){return this._activeWorldBossInfo},getActiveBossIsAlert:function(){if(!this._activeWorldBossInfo)return!1;switch(this._activeWorldBossInfo.state){case game.WorldBossStateType.NO_OPEN:case game.WorldBossStateType.OVER:return!1;case game.WorldBossStateType.OPENING:return!0;default:return!1}return!1},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.WORLD_BOSS_ALERT,null,this.worldBossAlert,this)},worldBossAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.WORLD_BOSS))for(var e=this.worldBossMap.values(),t=0;t<e.length;t++)if(e[t].state==game.WorldBossStateType.OPENING)return!0;return!1},setisCsWorldBoss:function(e){this.isCsWorldBoss=e}}),game.WorldBossMgr._instance=null,game.WorldBossMgr._singleton=!0,game.WorldBossMgr.inst=function(){return game.WorldBossMgr._instance||(game.WorldBossMgr._singleton=!1,game.WorldBossMgr._instance=new game.WorldBossMgr,game.WorldBossMgr._singleton=!0),game.WorldBossMgr._instance}},{}],1001:[function(e,t,i){"use strict";e("./WorldBossMgr")},{"./WorldBossMgr":1e3}],1002:[function(e,t,i){"use strict";game.appModule.InspirePanel=game.SkinUIPanel.extends({_yinbiUpgradeInfo:null,_yuanbaoUpgradeInfo:null,ctor:function(e){this._super(e)},onShow:function(){this.setData(),b8e.evt.onC(this._skin.btn_yinbi_inspire,this.onClickYinbiInspire,this),b8e.evt.onC(this._skin.btn_yuanbao_inspire,this.onClickYuanbaoInspire,this),b8e.evt.addG(this,game.SceneEvent.UPDATE_WORLD_BOSS_INSPIRE,this.setData)},onHide:function(){b8e.evt.offC(this._skin.btn_yinbi_inspire,this.onClickYinbiInspire,this),b8e.evt.offC(this._skin.btn_yuanbao_inspire,this.onClickYuanbaoInspire,this),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_WORLD_BOSS_INSPIRE,this.setData)},setData:function(){this.setMaxInspireDamage(),this.setCurInspireDamage(),this.setYinbiCostCount(),this.setYinbiCost(),this.setYuanbaoCost()},setMaxInspireDamage:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_MAX_INSPIRE_DAMAGE),t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_ONCE_INSPIRE_DAMAGE);this._skin.lab_max_inspire_desc.string="每次鼓舞可提升"+100*t+"%伤害(上限"+100*e+"%)"},setCurInspireDamage:function(){var e=game.worldBoss.damage;this._skin.lab_cur_inspire.string=game.ccfg.LangCfg.getText(game.html.getText(game.html.GRAY_WHITE,"当前提升  ")+"$%",[game.html.getText(game.html.Q_GREEN,e)])},setYinbiCostCount:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_BOSS_MAX_YINBI_INSPIRE_COUNT)-game.worldBoss.yinbiInspire,t="";t=0<e?game.ccfg.LangCfg.getText(game.html.getText(game.html.GRAY_WHITE,"剩余：")+"$次",[game.html.getText(game.html.Q_GREEN,e)]):game.ccfg.LangCfg.getText(game.html.getText(game.html.GRAY_WHITE,"剩余：")+"$次",[game.html.getText(game.html.Q_RED,e)]),this._skin.lab_yinbi_count.string=t},setYinbiCost:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_BOSS_MAX_YINBI_INSPIRE_COUNT);if(game.worldBoss.yinbiInspire>=e)this._skin.lab_inspire_yinbi_cost.string="0/次";else{var t=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.YINBI_INSPIRE_COUNT,game.worldBoss.yinbiInspire+1);if(t&&(this._yinbiUpgradeInfo=t.upgradeInfo,this._yinbiUpgradeInfo)){var i=this._yinbiUpgradeInfo.getAmountInfo();if(i){var n=i.getValue(game.AmountType.SILVER);this._skin.lab_inspire_yinbi_cost.string=n+"/次"}}}},setYuanbaoCost:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_BOSS_MAX_YUANBAO_INSPIRE_COUNT);if(game.worldBoss.yuanbaoInspire>=e)this._skin.lab_inspire_yuanbao_cost.string="0/次";else{var t=game.ccfg.CostCfg.getCostInfoByIdAndNum(game.SystemId.YUANBAO_INSPIRE_COUNT,game.worldBoss.yuanbaoInspire+1);if(t&&(this._yuanbaoUpgradeInfo=t.upgradeInfo,this._yuanbaoUpgradeInfo)){var i=this._yuanbaoUpgradeInfo.getAmountInfo();if(i){var n=i.getValue(game.AmountType.YUAN_BAO);this._skin.lab_inspire_yuanbao_cost.string=n+"/次"}}}},onClickYinbiInspire:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_BOSS_MAX_YINBI_INSPIRE_COUNT);game.worldBoss.yinbiInspire>=e?game.notice.show("银币鼓舞次数已用尽"):this._yinbiUpgradeInfo&&game.worldBoss.sendYinbiInspire(this._yinbiUpgradeInfo)},onClickYuanbaoInspire:function(){var e=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.WORLD_BOSS_MAX_YUANBAO_INSPIRE_COUNT);game.worldBoss.yuanbaoInspire>=e?game.notice.show("元宝鼓舞次数已用尽"):this._yuanbaoUpgradeInfo&&game.worldBoss.sendYuanbiInspire(this._yuanbaoUpgradeInfo)}})},{}],1003:[function(e,t,i){"use strict";game.WorldBossDamageRankCheckItem=game.SkinUI.extends({_worldBossRankInfo:null,_bianshenShowList:null,ctor:function(){this._super("worldBoss/WorldBossDamageRankCheckItemSkin","WorldBossDamageRankCheckItemSkin")},getWidth:function(){return 540},getHeight:function(){return 130},onShow:function(){this.setData(this._worldBossRankInfo)},onHide:function(){},setData:function(e){if(this._worldBossRankInfo=e,this._worldBossRankInfo&&this._skin){switch(this._skin.img_lab_rank_1.active=!1,this._skin.img_lab_rank_2.active=!1,this._skin.img_lab_rank_3.active=!1,this._skin.lab_rank.node.active=!1,this._worldBossRankInfo.rank){case 1:this._skin.img_lab_rank_1.active=!0;break;case 2:this._skin.img_lab_rank_2.active=!0;break;case 3:this._skin.img_lab_rank_3.active=!0;break;default:this._skin.lab_rank.node.active=!0,this._skin.lab_rank.string=this._worldBossRankInfo.rank}this._skin.lab_name.string=this._worldBossRankInfo.name,this._skin.lab_guild_name.string=this._worldBossRankInfo.guildName,this._skin.lab_damage.string=game.ValueUtil.formatNumber(this._worldBossRankInfo.score,1),this._bianshenShowList||(this._bianshenShowList=new game.BianShenShowList,this._bianshenShowList.addToParent(this._skin.bianshen_node)),this._bianshenShowList.setData(this._worldBossRankInfo.bianshens)}}})},{}],1004:[function(e,t,i){"use strict";game.appModule.WorldBossDamageRankCheckPanel=game.SkinUIPanel.extends({_list:null,_bossId:0,_info:null,_isActiveBoss:!1,ctor:function(e){this._super(e)},onShow:function(){this.data&&(this._bossId=this.data.id,this.data.isActiveBoss?this._isActiveBoss=this.data.isActiveBoss:this._isActiveBoss=!1),this._list||(this._list=new b8e.List(this._skin.list,game.WorldBossDamageRankCheckItem)),this._list.show(),this.setWorldBossList()},onHide:function(){this._list&&this._list.hide()},setWorldBossList:function(){if(this._isActiveBoss?this._info=game.worldBoss.getActiveBossInfo():this._info=game.worldBoss.getWorldBossRankData(this._bossId),this._info){var e=this._info.urank;this.setMineRank(e);var t=this._info.ranks;!t||t.length<0||(10<t.length&&t.splice(10),t.sort(this.onSortList),this._list.setData(t))}},setMineRank:function(e){if(!e)return this._skin.mine_rank_node.active=!1,void(this._skin.no_rank_node.active=!0);0<e.score&&(this._skin.mine_rank_node.active=!0,this._skin.no_rank_node.active=!1,this._skin.lab_mine_guildName.string=e.guildName,this._skin.lab_mine_damage.string=game.ValueUtil.formatNumber(e.score,1))},onSortList:function(e,t){return e.rank<t.rank?-1:e.rank>t.rank?1:0}})},{}],1005:[function(e,t,i){"use strict";game.WorldBossDamageRankItem=game.SkinUI.extends({_worldBossRankInfo:null,ctor:function(){this._super("worldBoss/WorldBossDamageRankItemSkin","WorldBossDamageRankItemSkin")},getWidth:function(){return 200},getHeight:function(){return 22},onShow:function(){this.setData(this._worldBossRankInfo)},onHide:function(){},setData:function(e){this._worldBossRankInfo=e,this._worldBossRankInfo&&this._skin&&(this._skin.lab_rank.string=this._worldBossRankInfo.rank,this._skin.lab_name.string=this._worldBossRankInfo.name,this._skin.lab_damage.string=game.ValueUtil.formatNumber(this._worldBossRankInfo.score,1))}})},{}],1006:[function(e,t,i){"use strict";game.WorldBossDamageRankPanel=game.SkinUI.extends({_strList:null,ctor:function(){this._super("worldBoss/WorldBossDamageRankSkin","WorldBossDamageRankSkin")},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.WorldBossDamageRankItem)),this._list.show(),this.setFirstIn(),this.setData(),game.worldBoss.setTimer(),this.onResize(),b8e.evt.onC(this._skin.img_on,this.onClickShowRank,this),b8e.evt.onC(this._skin.img_off,this.onClickNoShowRank,this),b8e.evt.onC(this._skin.img_inspire,this.onClickInspire,this),b8e.evt.addG(this,game.SceneEvent.UPDATE_WORLD_BOSS,this.setData),b8e.evt.addG(this,game.SceneEvent.UPDATE_WORLD_BOSS_INSPIRE,this.setInspire)},setData:function(){this.setDamageRank(),this.setMineDamage(),this.setInspire()},onHide:function(){this._list&&this._list.hide(),game.worldBoss.stopTimer(),b8e.evt.offC(this._skin.img_on,this.onClickShowRank,this),b8e.evt.offC(this._skin.img_off,this.onClickNoShowRank,this),b8e.evt.offC(this._skin.img_inspire,this.onClickInspire,this),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_WORLD_BOSS,this.setData),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_WORLD_BOSS_INSPIRE,this.setInspire)},setFirstIn:function(){this.showRank(!0)},setDamageRank:function(){var e=game.worldBoss.ranks;e&&0<e.length&&this._list.setData(e)},setInspire:function(){var e=game.worldBoss.damage+"%";e&&(this._skin.lab_inspire.string="伤害  "+game.html.getText(game.html.Q_GREEN,"+"+e))},setMineDamage:function(){var e=game.worldBoss.urank,t="无",i="";e&&(t=game.ValueUtil.formatNumber(e.score,1),e.rank<=10&&(i=e.rank)),this._skin.lab_mine_damage1.string=t,this._skin.lab_mine_damage2.string=t,this._skin.lab_mine_rank1.string=i,this._skin.lab_mine_rank2.string=i},onClickShowRank:function(){this.showRank(!0)},onClickNoShowRank:function(){this.showRank(!1)},showRank:function(e){this._skin.img_off.active=e,this._skin.img_on.active=!e,this._skin.show_rank_node.active=e,this._skin.no_show_rand_node.active=!e},onClickInspire:function(){game.app.show(game.AppConstant.INSPIRE_PANEL)},onResize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._skin&&(this.x=b8e.stageWidth-this.width+e,this.y=b8e.stageHeight-this.height-221)}})},{}],1007:[function(e,t,i){"use strict";game.WorldBossDropPreviewItem=game.SkinUI.extends({_prizeId:0,_prizeList:null,_prizeInfo:null,bossRankList:null,pRank:21,ctor:function(){this._super("worldBoss/WorldBossDropPreviewItemSkin","WorldBossDropPreviewItemSkin")},getHeight:function(){return 100},getWidth:function(){return 500},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this.setData(this._obj)},onHide:function(){},setData:function(e){if(this._obj=e,this._obj){this._obj.startRank,this._obj.endRank;if(this._skin){if(this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,4),this._prizeList.addToParent(this._skin.prizeList)),0!=this._obj.prizeId&&(this._prizeInfo.setupById(this._obj.prizeId),this._prizeList.setData(this._prizeInfo)),!this.bossRankList){var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_RANK);this.bossRankList=t.split("|")}this.pRank=21,this.bossRankList&&0<this.bossRankList.length&&(this.pRank=parseInt(this.bossRankList[this.bossRankList.length-1])),this._obj.startRank>=this.pRank?this._skin.lab_rank.string="参与奖":this._obj.startRank==this._obj.endRank?this._skin.lab_rank.string="第"+this._obj.startRank+"名":this._skin.lab_rank.string="第"+this._obj.startRank+"-"+this._obj.endRank+"名"}}}})},{}],1008:[function(e,t,i){"use strict";game.appModule.WorldBossDropPreviewPanel=game.SkinUIPanel.extends({_id:0,_list:null,_showList:null,bossRankList:null,_isActiveBoss:!1,ctor:function(e){this._super(e),this._showList=[]},onShow:function(){this.data&&(this._id=this.data.id,this.data.isActiveBoss?this._isActiveBoss=this.data.isActiveBoss:this._isActiveBoss=!1),this._list||(this._list=new b8e.List(this._skin.list,game.WorldBossDropPreviewItem)),this._list.show();game.mainRole.mainRoleData.miscData.openServerDay;this.setWorldBossList(),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.setWorldBossList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.setWorldBossList)},init:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.WORLD_BOSS_RANK);this.bossRankList=e.split("|")},setWorldBossList:function(){if(!this._showList||this._showList.length<=0?this._showList=[]:this._showList.length=0,this.bossRankList&&!(this.bossRankList.length<=0)){var e=game.ccfg.WorldBossAwardCfg.getCfgByLevel();if(e){var t;t=this._isActiveBoss?e.activityDropIds:e.dropIds;for(var i=0;i<this.bossRankList.length;i++){var n=this.bossRankList[i].split(",");if(n&&2==n.length)var s=parseInt(n[0]),a=parseInt(n[1]);else s=a=parseInt(this.bossRankList[i]);if(t[s-1]){var o={startRank:s,endRank:a,prizeId:t[s-1]};this._showList.push(o)}}this._list.setData(this._showList)}}}})},{}],1009:[function(e,t,i){"use strict";game.appModule.WorldBossEnterShowPanel=game.SkinUIPanel.extends({_bossId:0,_poster:null,_leaveTime:0,ctor:function(e){this._super(e)},onShow:function(){if(this._poster||(this._poster=b8e.Sprite.get(),this._poster.addToParent(this._skin.img_boss_head)),b8e.evt.onC(this._skin.btn_challenge,this.onClickBtnChallenge,this),this.data){this._bossId=this.data;var e=game.mainRole.mainRoleData.miscData.openServerDay;if(this._worldBossInfo=game.ccfg.WorldBossCfg.getData(this._bossId,game.worldBoss.getServerByCurServerDate(e)),this._worldBossInfo){var t=game.ClientCfg.getLoneyDungeonHead(this._worldBossInfo.head);this._poster.loadTexture(t,null,null,{useManifest:!1}),this._poster.setAnchor(.5,.5),this._poster.setSize(70,70),this._skin.title.string=this._worldBossInfo.title}}},onHide:function(){b8e.evt.offC(this._skin.btn_challenge,this.onClickBtnChallenge,this)},updateChallengeTime:function(){0<this._leaveTime?(this._leaveTime--,this._skin.lab_challenge_btn.string="挑战("+this._leaveTime+"s)"):this.onClickBtnChallenge()},onClickBtnChallenge:function(){this._worldBossInfo&&(this._worldBossInfo.actId?game.app.show(game.AppConstant.FESTIVAL_LOGIN_PANEL,{activeType:game.ActiveType.FESTIVAL,activeSubType:game.ActiveSubType.ST_WORLD_BOSS}):game.app.show(game.AppConstant.DUNGEON_PANEL,game.DungeonTabType.WORLD_BOSS)),this.hide()}})},{}],1010:[function(e,t,i){"use strict";game.WorldBossItem=game.SkinUI.extends({_worldBossUnit:null,_id:0,_worldBossInfo:null,_poster:null,_name:null,_bg:null,_prizeList:null,_prizeInfo:null,ctor:function(){this._super("worldBoss/WorldBossItemSkin","WorldBossItemSkin")},getWidth:function(){return 545},getHeight:function(){return 230},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._poster||(this._poster=b8e.Sprite.get(),this._poster.addToParent(this._skin.img_boss)),this._name||(this._name=b8e.Sprite.get(),this._name.addToParent(this._skin.img_name)),this._bg||(this._bg=b8e.Sprite.get(),this._bg.addToParent(this._skin.node_bg)),this.setData(this._worldBossUnit),b8e.evt.onC(this._skin.btn_challenge,this.onClickBtnChallenge,this),b8e.evt.onC(this._skin.btn_drop_preview,this.onClickDropPreview,this),b8e.evt.onC(this._skin.lab_damage_rank,this.onClickLabDamageRank,this)},onHide:function(){b8e.evt.offC(this._skin.btn_challenge,this.onClickBtnChallenge,this),b8e.evt.offC(this._skin.btn_drop_preview,this.onClickDropPreview,this),b8e.evt.offC(this._skin.lab_damage_rank,this.onClickLabDamageRank,this)},setData:function(e){if(this._worldBossUnit=e,this._skin){if(!this._worldBossUnit)return this._skin.lab_state.string="未开启",this._skin.lab_state.node.active=!0,this._skin.mask.active=!1,this._skin.btn_challenge.active=!1,void(this._skin.lab_damage_rank.active=!1);this._id=this._worldBossUnit.id,this.setWorldBossState(this._worldBossUnit.state);var t=game.mainRole.mainRoleData.miscData.openServerDay;if(this._worldBossInfo=game.ccfg.WorldBossCfg.getData(this._id,game.worldBoss.getServerByCurServerDate(t)),this._worldBossInfo){this.setWorldBossBg(),this.setWorldBossPoster(this._worldBossInfo.poster);var i=game.ccfg.WorldBossAwardCfg.getCfgByLevel();i&&this.setWorldBossDropItem(i.showPrize),this.setWorldBossName(this._worldBossInfo.name),this._skin.lab_boss_revive_time.string="复活时间："+game.html.getText(game.html.Q_GREEN,"每日 "+this._worldBossInfo.reviceTime)}}},setWorldBossPoster:function(e){var t=game.ClientCfg.getWorldBossImgUrlByString(e);this._poster.loadTexture(t,null,null,{useManifest:!1}),this._poster.setSize(169,226),this._poster.setAnchor(0,0)},setWorldBossName:function(e){var t=game.ClientCfg.getWorldBossImgUrlByString(e);this._name.loadTexture(t,null,null,{useManifest:!1}),this._name.setSize(121,27),this._name.setAnchor(0,.5)},setWorldBossBg:function(){var e=game.ClientCfg.getWorldBossImgUrlByString("worldBoss_bg",!0);this._bg.loadTexture(e,null,null,{useManifest:!1}),this._bg.setSize(543,228),this._bg.setAnchor(.5,.5)},setWorldBossDropItem:function(e){this._prizeList||(this._prizeList=new game.PrizeList(5,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,3),this._prizeList.containerId=game.ContainerId.WORLD_BOSS_DROP_ID,this._prizeList.addToParent(this._skin.item_list)),0!=e&&(this._prizeInfo.setupById(e),this._prizeList.setData(this._prizeInfo))},setWorldBossState:function(e){switch(e){case game.WorldBossStateType.NO_OPEN:this._skin.lab_state.string="未开启",this._skin.lab_state.node.active=!0,this._skin.mask.active=!1,this._skin.btn_challenge.active=!1,this._skin.lab_damage_rank.active=!1;break;case game.WorldBossStateType.OPENING:this._skin.lab_state.node.active=!1,this._skin.mask.active=!1,this._skin.btn_challenge.active=!0,this._skin.lab_damage_rank.active=!1;break;case game.WorldBossStateType.OVER:this._skin.lab_state.node.active=!1,this._skin.mask.active=!0,this._skin.btn_challenge.active=!1,this._skin.lab_damage_rank.active=!0;break;default:this._skin.lab_state.node.active=!1,this._skin.mask.active=!1,this._skin.btn_challenge.active=!1,this._skin.lab_damage_rank.active=!1}},onClickBtnChallenge:function(){game.worldBoss.bossId=this._id,game.SceneSender.enterWorldBossSceneRequest(this._id)},onClickLabDamageRank:function(){game.app.show(game.AppConstant.WORLD_BOSS_DAMAGE_RANK_CHECK_PANEL,{id:this._id})},onClickDropPreview:function(){game.app.show(game.AppConstant.WORLD_BOSS_DROP_PREVIEW_PANEL,{id:this._id})}})},{}],1011:[function(e,t,i){"use strict";game.WorldBossPanel=game.SkinUI.extends({_list:null,_showList:null,ctor:function(){this._super("worldBoss/WorldBossSkin","WorldBossSkin"),this._showList=[]},onShow:function(){this._list||(this._list=new b8e.List(this._skin.list,game.WorldBossItem)),this._list.show(),this.setWorldBossList(),b8e.evt.addG(this,game.SceneEvent.UPDATE_ALL_WORLD_BOSS,this.setWorldBossList),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.setWorldBossList)},onHide:function(){this._list&&this._list.hide(),b8e.evt.rmvG(this,game.SceneEvent.UPDATE_ALL_WORLD_BOSS,this.setWorldBossList),b8e.evt.rmvG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.setWorldBossList)},setWorldBossList:function(){var e=game.worldBoss.getWorldBossList();e&&0<e.length&&e.sort(this.onSortList),this._list.setData(e)},onSortList:function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}})},{}],1012:[function(e,t,i){"use strict";game.appModule.WorldBossResultPanel=game.SkinUIPanel.extends({_prizeList:null,_prizeInfo:null,_leaveTime:0,_timer:null,ctor:function(e){this._super(e)},onShow:function(){this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this.showResult(),b8e.evt.onC(this._skin.sure_btn,this.onSureBtnClick,this)},onHide:function(){b8e.evt.offC(this._skin.sure_btn,this.onSureBtnClick,this),this._timer&&(b8e.Timer.remove(this,this.updateSureTime),this._timer=null)},onSureBtnClick:function(){this._timer&&(b8e.Timer.remove(this,this.updateSureTime),this._timer=null),game.worldBoss.onLeaveScene(),this.hide()},showResult:function(){var e=game.worldBoss.worldBossAwardInfo;e&&(e.rank<=game.worldBoss.maxRankIndex?(this._skin.lab_rank.string="第"+e.rank+"名",this._skin.lab_rank_award.string="第"+e.rank+"名"):(this._skin.lab_rank.string="未上榜",this._skin.lab_rank_award.string="参与奖"),this._prizeList||(this._prizeList=new game.PrizeList(4,game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90,game.IconScale.PERCENT_80),this._prizeList.containerId=game.ContainerId.DUNGEON_DROP_PRIZE_LIST_ID,this._prizeList.addToParent(this._skin.list_item.content)),this._prizeInfo.setup(e.userItem),this._prizeList.setData(this._prizeInfo),this._leaveTime=10,this._timer?(this._timer.reset(),this._timer.start()):this._timer=b8e.Timer.add(this,this.updateSureTime,500))},updateSureTime:function(){0<this._leaveTime?(this._leaveTime--,this._skin.lab_sure_btn.string="确定("+this._leaveTime+"s)"):this.onSureBtnClick()}})},{}],1013:[function(e,t,i){"use strict";e("./InspirePanel"),e("./WorldBossDamageRankPanel"),e("./WorldBossEnterShowPanel"),e("./WorldBossItem"),e("./WorldBossPanel"),e("./WorldBossDropPreviewItem"),e("./WorldBossDropPreviewPanel"),e("./WorldBossDamageRankCheckItem"),e("./WorldBossDamageRankCheckPanel"),e("./WorldBossResultPanel"),e("./WorldBossDamageRankItem")},{"./InspirePanel":1002,"./WorldBossDamageRankCheckItem":1003,"./WorldBossDamageRankCheckPanel":1004,"./WorldBossDamageRankItem":1005,"./WorldBossDamageRankPanel":1006,"./WorldBossDropPreviewItem":1007,"./WorldBossDropPreviewPanel":1008,"./WorldBossEnterShowPanel":1009,"./WorldBossItem":1010,"./WorldBossPanel":1011,"./WorldBossResultPanel":1012}],1014:[function(e,t,i){"use strict";e("./manager/managerIndex_21"),e("./panel/panelIndex_32")},{"./manager/managerIndex_21":1001,"./panel/panelIndex_32":1013}],1015:[function(e,t,i){"use strict";game.WorldCupCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Activity.WorldCupCfgResponse,this.onWorldCupCfgRp,this),b8e.addNH(game.pbmid.Activity.WorldCupPredictionResponse,this.onWorldCupQuizRp,this),b8e.addNH(game.pbmid.Activity.WorldCupActivityResponse,this.onWorldCupActivityRp,this)},onWorldCupCfgRp:function(e){var t=e.readProtobuf(game.pbmsg.WorldCupCfgResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.worldcup.setWorldCupCfgInfo(t)},onWorldCupQuizRp:function(e){var t=e.readProtobuf(game.pbmsg.WorldCupPredictionResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.worldcup.setQuizData(t)},onWorldCupActivityRp:function(e){var t=e.readProtobuf(game.pbmsg.WorldCupActivityResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.worldcup.setWorldCupActivity(t)}})},{}],1016:[function(e,t,i){"use strict";game.WorldCupQuizType=b8e.Enum({QUIZ_WIN:1,QUIZ_LOSE:2,QUIZ_DRAW:3})},{}],1017:[function(e,t,i){"use strict";game.WorldCupScheduleType=b8e.Enum({TEAM:1,R16:2,QUATER_FINAL:3,SEMI_FINAL:4,THIRD:5,FINAL:6})},{}],1018:[function(e,t,i){"use strict";game.WorldCupType=b8e.Enum({JINGCAI:1,XIAOZUSAI:2,TAORAISAI:3,JIFENDUIHUANG:385,DAOJUDUIHUANG:386})},{}],1019:[function(e,t,i){"use strict";game.WorldCupZoneType=b8e.Enum({FIRST_HALF:1,SECOND_HALF:2})},{}],1020:[function(e,t,i){"use strict";game.WorldCupEvent=b8e.Enum({SELECT_GROUP:b8e.Event.nextCode(),UPDATE_WORLDCUPPANEL:b8e.Event.nextCode(),UPDATE_WORLDQUIZPAGE:b8e.Event.nextCode(),UPDATA_WORLDCUPSCORE:b8e.Event.nextCode()})},{}],1021:[function(e,t,i){"use strict";game.WorldCupMgr=b8e.Object.extends({name:"WorldCupMgr",worldcupCfgActives:null,selectSubType:0,worldCupScheduleMap:null,worldCupTeamMap:null,worldCupQuizRecordsMap:null,worldCupRankRanks:null,worldCupQuizMap:null,endQuizRecordsMap:null,showRecordList:null,score:0,qiuzItemNum:0,expirationTime:0,worldCupR16Map:null,isR16Begin:!1,worldCupR16WinnerMap:null,isGameFinal:!1,_groupList:null,groupIndex:0,bettingRollsId:305002,_rankingRewards:null,worldBtns:null,finalSchedule:null,ctor:function(){if(1==game.WorldCupMgr._singleton)throw new Error("WorldCupMgr 只能通过单例方法获取");this.worldCupScheduleMap=b8e.HashMap.get(),this.worldCupTeamMap=b8e.HashMap.get(),this.worldCupQuizRecordsMap=b8e.HashMap.get(),this.endQuizRecordsMap=b8e.HashMap.get(),this.worldCupR16Map=b8e.HashMap.get(),this.worldCupR16WinnerMap=b8e.HashMap.get(),this.worldCupQuizMap=b8e.HashMap.get(),this.worldCupRankRanks=[],this.showRecordList=[],this._groupList=[],this._rankingRewards=b8e.HashMap.get();for(var e=[1024,1023,1022,1021,1021,1021,1021,1021,1021,1021],t=e.length,i=0;i<t;++i)this._rankingRewards.set(i+1,e[i])},getCfgActives:function(){return this.worldcupCfgActives=game.ccfg.WorldCupBarCfg.getDatas(),this.worldcupCfgActives},rqWorldCupCfgInfo:function(){game.active.hasActive(game.ActiveType.WORLD_CUP)&&(b8e.log("已经有了世界杯活动，请求世界杯配置----"),game.SysTime.curTime>this.expirationTime?game.WorldCupSender.reqWorldCupCfg():game.app.show(game.AppConstant.WORLD_CUP_PANEL))},setWorldCupCfgInfo:function(e){var t=e.schedule,i=e.teams;if(t&&0!=t.length){var n,s,a,o,r;this.cleanWorldCupData();var h=t.length;for(r=0;r<h;++r)(n=new game.WorldCupSchedule).setup(t[r]),(s=this.worldCupScheduleMap.get(n.zone))||(s=[],this.worldCupScheduleMap.set(n.zone,s)),s.push(n),this.worldCupQuizMap.set(n.match,n),n.isEnd()&&this.endQuizRecordsMap.set(n.match,n),n.type>=game.WorldCupScheduleType.R16&&n.zone&&((o=this.worldCupR16Map.get(n.zone))||(o=b8e.HashMap.get(),this.worldCupR16Map.set(n.zone,o)),(a=o.get(n.type))||(a=[],o.set(n.type,a)),a.push(n),n.isEnd()&&n.getWinnerName()&&worldCupR16WinnerMap.set(n.getWinnerName(),n)),n.type==game.WorldCupScheduleType.FINAL&&(this.isGameFinal=!0,this.finalSchedule=n);if(this.worldCupR16Map.keys()&&0<this.worldCupR16Map.keys().length?this.isR16Begin=!0:this.isR16Begin=!1,i&&0!=i.length){var g,l;for(h=i.length,r=this._groupList.length=0;r<h;++r)(l=this.worldCupTeamMap.get(i[r].group))||(l=[],this.worldCupTeamMap.set(i[r].group,l)),-1==this._groupList.indexOf(i[r].group)&&this._groupList.push(i[r].group),(g=new game.WorldCupTeam).setup(i[r]),l.push(g);this.expirationTime=game.SysTime.curTime+3e5,game.app.show(game.AppConstant.WORLD_CUP_PANEL),this.rqWorldCupActivity()}else b8e.log("世界杯活动数据为空")}else b8e.log("世界杯活动数据为空")},rqWorldCupActivity:function(){game.WorldCupSender.reqWorldCupActivity()},setWorldCupActivity:function(e){var t,i,n,s=e.records,a=e.ranks,o=s.length;if(this.score=e.score,b8e.evt.dptG(game.WorldCupEvent.UPDATA_WORLDCUPSCORE),s&&0<s.length){for(this.worldCupQuizRecordsMap.clear(),t=0;t<o;++t)(i=new game.WorldCupQuiz).setup(s[t]),this.worldCupQuizRecordsMap.set(s[t].match,i);b8e.evt.dptG(game.WorldCupEvent.UPDATE_WORLDQUIZPAGE)}if(a&&0<a.length)for(o=a.length,t=this.worldCupRankRanks.length=0;t<o;++t)(n=new game.WorldCupRank).setup(a[t]),this.worldCupRankRanks.push(n)},cleanWorldCupData:function(){this.worldCupScheduleMap.clear(),this.worldCupTeamMap.clear(),this.endQuizRecordsMap.clear(),this.worldCupR16Map.clear(),this.worldCupR16WinnerMap.clear(),this.worldCupQuizMap.clear()},getAllQuizDataList:function(){var e=this.worldCupQuizMap.values();if(!e)return null;for(var t,i,n=[],s=e.length,a=0;a<s;++a){if((t=e[a]).isQuizEnd()){if(t.isEnd())continue}else if(i=t.time-game.SysTime.curTime,t.type<game.WorldCupScheduleType.R16&&i>b8e.TimeUtil.DAY_MICRO_SECONDS)continue;t.type!=game.WorldCupScheduleType.FINAL&&n.push(t)}return n},getQuizDataByMatch:function(e){return this.worldCupQuizMap.get(e)},getWorldCupScheduleList:function(){return this.worldCupScheduleMap.values()},getFirstHalfTeams:function(){return this.worldCupScheduleMap.get(game.WorldCupZoneType.FIRST_HALF)},getSecondHalfTeams:function(){return this.worldCupScheduleMap.get(game.WorldCupZoneType.SECOND_HALF)},getTeamList:function(){return this.worldCupTeamMap},getGroupList:function(){return this._groupList},getQuizRecordsByMatch:function(e){return this.worldCupQuizRecordsMap.get(e)},getShowRecords:function(){var e=this.worldCupQuizRecordsMap.keys();if(e&&0!=e.length){for(var t,i=e.length,n=this.showRecordList.length=0;n<i;++n)(t=this.endQuizRecordsMap.get(e[n]))&&this.showRecordList.push(t);return this.showRecordList&&0<this.showRecordList.length?this.showRecordList:null}},getWorldCupScoreRanks:function(){return this.worldCupRankRanks},getNickNameByRank:function(e){return this._rankingRewards.get(e)},onQuizMatch:function(e,t){var i=this.getQuizDataByMatch(e);if(i){var n={checkedQuizData:i,checkedType:t};game.app.show(game.AppConstant.WORLD_CUP_BETTING_PANEL,n)}},rqWorldCupQuiz:function(e,t,i){var n=this.getQuizDataByMatch(e);n&&(n.isQuizEnd()?game.notice.show(86009):game.WorldCupSender.reqWorldCupQuiz(e,t,i))},setQuizData:function(e){var t=this.worldCupQuizRecordsMap.get(e.match);t||(t=new game.WorldCupQuiz,this.worldCupQuizRecordsMap.set(e.match,t)),t.addNum(e),b8e.evt.dptG(game.WorldCupEvent.UPDATE_WORLDQUIZPAGE)},setSelectSubType:function(e){if(this.selectSubType!=e){this.selectSubType=e;var t=game.active.getSubTypes(game.ActiveType.WORLD_CUP);if(t)-1!=t.indexOf(this.selectSubType)&&game.active.selectType(this.selectSubType);b8e.evt.dptG(game.WorldCupEvent.UPDATE_WORLDCUPPANEL)}},getWorldBtns:function(){if(this.worldBtns||(this.worldBtns=game.ccfg.WorldCupBarCfg.getDatas(),this.worldBtns&&0<this.worldBtns.length&&this.worldBtns.sort(this.onSortBtn)),!this.isR16Begin&&this.worldBtns)for(var e=0;e<this.worldBtns.length;++e)3==this.worldBtns[e].id&&this.worldBtns.splice(e,1);return this.worldBtns},onSortBtn:function(e,t){return e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0},isWorldCupR16:function(){return this.isR16Begin},getFirstR16Teams:function(){return this.worldCupR16Map.get(game.WorldCupZoneType.FIRST_HALF)},getSecondR16Teams:function(){return this.worldCupR16Map.get(game.WorldCupZoneType.SECOND_HALF)},getFinalSchedule:function(){return this.finalSchedule},getR16ByType:function(e,t){var i=this.worldCupR16Map.get(e);if(!i)return null;var n=i.get(t);return n&&0!=n.length?n:null},getScore:function(){return this.score},getQuizItemNum:function(){return this.qiuzItemNum=game.back.getItemInfoCountById(305002),this.qiuzItemNum},goToQuiz:function(){this.setSelectSubType(game.WorldCupType.JINGCAI)},onServerTip:function(){game.active.selectSubType=game.ActiveSubType.ST_COLLECT_EXCHANGE_2,game.active.openDescPanel(game.active.ACTIVE_DESC)},goToGetQuizItem:function(){},onOpenRecordPanel:function(){game.app.show(game.AppConstant.WORLD_CUP_RECORD_PANEL)},getWorldCupActiveAlert:function(){return game.active.getTargetIsAlert(game.WorldCupType.JIFENDUIHUANG)||game.active.getTargetIsAlert(game.WorldCupType.DAOJUDUIHUANG)}}),game.WorldCupMgr._instance=null,game.WorldCupMgr._singleton=!0,game.WorldCupMgr.inst=function(){return game.WorldCupMgr._instance||(game.WorldCupMgr._singleton=!1,game.WorldCupMgr._instance=new game.WorldCupMgr,game.WorldCupMgr._singleton=!0),game.WorldCupMgr._instance}},{}],1022:[function(e,t,i){"use strict";game.appModule.WorldCupBettingPanel=game.SkinUIPanel.extends({scheduleInfo:null,checkedType:0,itemCount:0,ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.bettingBtn,this.onBettingBtnClick,this),b8e.evt.onC(this._skin.addBtn,this.onAddBtnClick,this),b8e.evt.onC(this._skin.lessBtn,this.onLessBtnClick,this),this._skin.count_editBox.node.on("editing-did-began",this.onEditingBegan,this),this._skin.count_editBox.node.on("text-changed",this.onEditingChange,this),this._skin.count_editBox.node.on("editing-did-ended",this.onEditingEnded,this),this.count=1,this._strCount="1",this._skin.count_editBox.string="",this._skin.count.string=this.count+"",this.itemCount=0,this.data&&(this.scheduleInfo=this.data.checkedQuizData,this.checkedType=this.data.checkedType,this.setData())},onHide:function(){b8e.evt.offC(this._skin.bettingBtn,this.onBettingBtnClick,this),b8e.evt.offC(this._skin.addBtn,this.onAddBtnClick,this),b8e.evt.offC(this._skin.lessBtn,this.onLessBtnClick,this),this._skin.count_editBox.node.off("editing-did-began",this.onEditingBegan,this),this._skin.count_editBox.node.off("text-changed",this.onEditingChange,this),this._skin.count_editBox.node.off("editing-did-ended",this.onEditingEnded,this)},setData:function(){switch(this._skin.vsDesc.string=game.ccfg.LangCfg.getText(86008,[this.scheduleInfo.teamName1,this.scheduleInfo.teamName2]),this.checkedType){case game.WorldCupQuizType.QUIZ_WIN:this._skin.bettingTeam.string=game.ccfg.LangCfg.getText(86002,[this.scheduleInfo.teamName1]);break;case game.WorldCupQuizType.QUIZ_LOSE:this._skin.bettingTeam.string=game.ccfg.LangCfg.getText(86002,[this.scheduleInfo.teamName2]);break;case game.WorldCupQuizType.QUIZ_DRAW:this._skin.bettingTeam.string=game.ccfg.LangCfg.getText(86003)}this._skin.lab_desc.string=game.ccfg.LangCfg.getText(86001),this.itemCount=game.worldcup.getQuizItemNum(),this._skin.bettingCount.string=this.itemCount},onBettingBtnClick:function(){this.itemCount<=0?game.notice.show(86004):(game.worldcup.rqWorldCupQuiz(this.scheduleInfo.match,this.checkedType,this.count),this.hide())},onAddBtnClick:function(){this.count++,this.count=this.count>this.itemCount?this.itemCount:this.count,this.count<1&&(this.count=1),this._strCount=this.count+"",this._skin.count.string=this.count+""},onLessBtnClick:function(){this.count--,this.count=this.count>this.itemCount?this.itemCount:this.count,this.count<1&&(this.count=1),this._strCount=this.count+"",this._skin.count.string=this.count+""},onEditingBegan:function(){this._skin.count.string="",this._skin.count_editBox.string=this._strCount},onEditingEnded:function(){if(0==this._skin.count_editBox.string.trim().length)return this._skin.count_editBox.string="",void(this._skin.count.string=this.count+"");var e=0|this._skin.count_editBox.string;e<=0&&(e=1),this.count=e>this.itemCount?this.itemCount:e,this._strCount=this.count+"",this._skin.count_editBox.string="",this._skin.count.string=this.count+""},onEditingChange:function(){var e=this._skin.count_editBox.string.trim();if(0==e.length)return this._skin.count_editBox.string="",void(this._strCount="1");if(game.CCommonUtil.isNumber(e)){var t=0|this._skin.count_editBox.string;t<1&&(t=1),this.count=t>this.itemCount?this.itemCount:t,this._strCount=this._skin.count_editBox.string=this.count+""}else this._skin.count_editBox.string=this._strCount}})},{}],1023:[function(e,t,i){"use strict";game.WorldCupBtn=game.SkinUI.extends({_data:null,_normal:null,_select:null,_effect:null,ctor:function(){this._super("worldcup/WorldCupBtnSkin","WorldCupBtnSkin")},init:function(){this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle),this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle)},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},onTouchThis:function(){this._data&&game.worldcup.setSelectSubType(this._data.id)},setData:function(e){if(this._data=e,this._skin&&this._data){var t=!1;switch(this._data.id){case game.WorldCupType.JIFENDUIHUANG:case game.WorldCupType.DAOJUDUIHUANG:t=game.active.getTargetIsAlert(this._data.id)}this._skin.alert.active=!!t,this._skin.normalTitle.active=!1,this._skin.selectTitle.active=!1;var i=game.worldcup.selectSubType;this._data.id==i?(this._skin.selectTitle.active=!0,this._select.loadTexture(game.ClientCfg.getImgUrl(e.clickBg,!1),null,null,{useManifest:!1})):(this._skin.normalTitle.active=!0,this._normal.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!1),null,null,{useManifest:!1}))}},getHeight:function(){return 95},getWidth:function(){return 105}})},{}],1024:[function(e,t,i){"use strict";game.WorldCupGroupItem=game.SkinUI.extends({_data:null,getWidth:function(){return 110},getHeight:function(){return 75},ctor:function(){this._super("worldcup/WorldCupGroupItemSkin","WorldCupGroupItemSkin")},onShow:function(){b8e.evt.onC(this._skin.node,this.onClick,this),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.node,this.onClick,this)},setData:function(e){if(this._data=e,this._skin&&this._data){this._skin.group.string=this._data;var t=this.itemRenderIndex==game.worldcup.groupIndex;this._skin.check_mark.active=t}},onClick:function(){this._skin.check_mark.active=!0,b8e.evt.dptG(game.WorldCupEvent.SELECT_GROUP,{data:this._data,index:this.itemRenderIndex})}})},{}],1025:[function(e,t,i){"use strict";game.WorldCupGroupPanel=game.SkinUI.extends({_groupList:null,_teamList:null,listTest:null,_map:null,_groupArr:null,_groupBg:null,ctor:function(){this._super("worldcup/WorldCupGroupSkin","WorldCupGroupSkin")},init:function(){this._groupList||(this._groupList=new b8e.List(this._skin.group_list,game.WorldCupGroupItem,1)),this._teamList||(this._teamList=new b8e.List(this._skin.team_list,game.WorldCupGroupTeamItem,1)),this._map=game.worldcup.getTeamList(),this._groupBg||(this._groupBg=b8e.Sprite.get(),this._groupBg.addToParent(this._skin.group_bg)),this._groupBg.loadTexture(game.ClientCfg.worldCupGroupBgUrl,null,null,{useManifest:!1})},onShow:function(){this._groupList.show(),this._teamList.show(),this._map=game.worldcup.getTeamList(),this._groupArr=game.worldcup.getGroupList(),this.setGropList();var e=null;0<this._groupArr.length&&(e=this._map.get(this._groupArr[0])),game.worldcup.groupIndex=0,this.setTeamList(e),b8e.evt.addG(this,game.WorldCupEvent.SELECT_GROUP,this.updateTeamList),b8e.evt.onC(this._skin.goto_betting_btn,this.onGotoBettingBtnClick,this)},onHide:function(){this._groupList&&this._groupList.hide(),this._teamList&&this._teamList.hide(),b8e.evt.rmvG(this,game.WorldCupEvent.SELECT_GROUP,this.updateTeamList),b8e.evt.offC(this._skin.goto_betting_btn,this.onGotoBettingBtnClick,this)},updateTeamList:function(e){if(e&&e.data){game.worldcup.groupIndex=e.data.index,this.setGropList();var t=this._map.get(e.data.data);this.setTeamList(t)}},setGropList:function(){this._groupList.setData(this._groupArr)},setTeamList:function(e){this._teamList.setData(e)},onGotoBettingBtnClick:function(){game.worldcup.goToQuiz()}})},{}],1026:[function(e,t,i){"use strict";game.WorldCupGroupTeamItem=game.SkinUI.extends({_iconSprite:null,_contentBg:null,getWidth:function(){return 390},getHeight:function(){return 111},ctor:function(){this._super("worldcup/WorldCupGroupTeamItemSkin","WorldCupGroupTeamItemSkin")},onShow:function(){this._iconSprite||(this._iconSprite=b8e.Sprite.get(),this._iconSprite.setAnchor(.5,0),this._iconSprite.setScale(.8),this._iconSprite.addToParent(this._skin.img_icon)),this._contentBg||(this._contentBg=b8e.Sprite.get(),this._contentBg.addToParent(this._skin.content_bg),this._contentBg.loadTexture(game.ClientCfg.worldCupRankBgUrl,this.onRuleSpriteComplete,this,{useManifest:!1})),this.setData(this._data)},onHide:function(){},setData:function(e){if(this._data=e,this._skin&&this._data&&(this._skin.team_name.string=this._data.name,this._skin.lab_result.string=game.ccfg.LangCfg.getText(86007,[this._data.won,this._data.draw,this._data.lost]),this._skin.lab_points.string=this._data.points,this._skin.goals.string=this._data.goalsFor,""!=this._data.icon)){var t=game.ClientCfg.getNationalFlag(this._data.icon);this._iconSprite.loadTexture(t,null,null,{useManifest:!1})}},onRuleSpriteComplete:function(){this._contentBg.width=390}})},{}],1027:[function(e,t,i){"use strict";game.appModule.WorldCupPanel=game.SkinUIPanel.extends({_spBg:null,_list:null,worldBtns:null,_worldcuQuizPage:null,_worldCupGroupPanel:null,activeCollectExchangePanel:null,worldCupR16Page:null,ctor:function(e){this._super(e)},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.worldcupBg),this._spBg.loadTexture(game.ClientCfg.worldCupBgUrl,null,null,{useManifest:!1}),this._list=new b8e.List(this._skin.list_btns,game.WorldCupBtn),this._worldCupGroupPanel=new game.WorldCupGroupPanel,this._worldCupGroupPanel.addToParent(this._skin.pageNode),this._worldcuQuizPage=new game.WorldCupQuizPage,this._worldcuQuizPage.addToParent(this._skin.pageNode),this.activeCollectExchangePanel=new game.ActiveCollectExchangePanel,this.activeCollectExchangePanel.addToParent(this._skin.pageNode),this.worldCupR16Page=new game.WorldCupR16Page,this.worldCupR16Page.addToParent(this._skin.pageNode)},onShow:function(){this._list.show(),game.worldcup.setSelectSubType(game.WorldCupType.JINGCAI),this.updataWorldCupPanel(),this.updateScoreNode(),b8e.evt.onC(this._skin.getItemNode,this.onGetAwayClick,this),b8e.evt.addG(this,game.WorldCupEvent.UPDATE_WORLDCUPPANEL,this.updataWorldCupPanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateScoreNode),b8e.evt.addG(this,game.WorldCupEvent.UPDATA_WORLDCUPSCORE,this.updateScoreNode)},onHide:function(){b8e.evt.rmvG(this,game.WorldCupEvent.UPDATE_WORLDCUPPANEL,this.updataWorldCupPanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateScoreNode),b8e.evt.rmvG(this,game.WorldCupEvent.UPDATA_WORLDCUPSCORE,this.updateScoreNode),b8e.evt.offC(this._skin.getItemNode,this.onGetAwayClick,this),this._list&&this._list.hide()},updataWorldCupPanel:function(){this.worldBtns||(this.worldBtns=game.worldcup.getWorldBtns()),this._list.setData(this.worldBtns),this.setWorldCupActivePage(game.worldcup.selectSubType)},updateScoreNode:function(){this._skin.scoreLab.string=game.ccfg.LangCfg.getText(86005,[game.worldcup.getScore()]),this._skin.costItemNum.string=game.ccfg.LangCfg.getText(86006,[game.worldcup.getQuizItemNum()])},setWorldCupActivePage:function(e){switch(this.hideAllPage(),e){case game.WorldCupType.JINGCAI:this._worldcuQuizPage.show();break;case game.WorldCupType.XIAOZUSAI:this._worldCupGroupPanel.show();break;case game.WorldCupType.TAORAISAI:this.worldCupR16Page.show();break;case game.WorldCupType.JIFENDUIHUANG:case game.WorldCupType.DAOJUDUIHUANG:this.activeCollectExchangePanel.show()}},hideAllPage:function(){this._worldCupGroupPanel.hide(),this._worldcuQuizPage.hide(),this.activeCollectExchangePanel.hide(),this.worldCupR16Page.hide()},onGetAwayClick:function(){game.worldcup.goToGetQuizItem()}})},{}],1028:[function(e,t,i){"use strict";game.WorldCupQuizItem=game.SkinUI.extends({_data:null,_spBg:null,_team1Icon:null,_team2Icon:null,_endTimer:null,ctor:function(){this._super("worldcup/WorldCupQuizItemSkin","WorldCupQuizItemSkin")},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.itemBg),this._spBg.loadTexture(game.ClientCfg.worldCupVsBgUrl,null,null,{useManifest:!1}),this._team1Icon=b8e.Sprite.get(),this._team1Icon.setAnchor(.5,.5),this._team1Icon.setScale(.8),this._team1Icon.addToParent(this._skin.team1_icon),this._team2Icon=b8e.Sprite.get(),this._team2Icon.setAnchor(.5,.5),this._team2Icon.setScale(.8),this._team2Icon.addToParent(this._skin.team2_icon)},onShow:function(){this.setData(this._data),b8e.evt.onC(this._skin.winBtn_1,this.onQuizWinBtn,this),b8e.evt.onC(this._skin.dramBtn_1,this.onQuizDramBtn,this),b8e.evt.onC(this._skin.lostBtn_1,this.onQuizLostBtn,this),b8e.evt.addG(this,game.WorldCupEvent.UPDATE_WORLDQUIZPAGE,this.updateQuizNum),this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start()},onHide:function(){b8e.evt.offC(this._skin.winBtn_1,this.onQuizWinBtn,this),b8e.evt.offC(this._skin.dramBtn_1,this.onQuizDramBtn,this),b8e.evt.offC(this._skin.lostBtn_1,this.onQuizLostBtn,this),this._endTimer&&this._endTimer.stop(),b8e.evt.rmvG(this,game.WorldCupEvent.UPDATE_WORLDQUIZPAGE,this.updateQuizNum)},getWidth:function(){return 532},getHeight:function(){return 229},setData:function(e){this._data=e,this._skin&&this._data&&(this._skin.dramNode.active=!(e.type>game.WorldCupScheduleType.TEAM),this._skin.time.string=b8e.TimeUtil.formatTimestamp(e.time,game.ccfg.LangCfg.getText(86013)),this._team1Icon.loadTexture(game.ClientCfg.getNationalFlag(e.teamIcon1),null,null,{useManifest:!1}),this._team2Icon.loadTexture(game.ClientCfg.getNationalFlag(e.teamIcon2),null,null,{useManifest:!1}),this._skin.team1Name.string=e.teamName1,this._skin.team2Name.string=e.teamName2,this.updateQuizNum(),game.SysTime.curTime>=e.time?this.setQuizBtn(!1):this.setQuizBtn(!0))},setQuizBtn:function(e){this._skin.winBtn_1.active=e,this._skin.dramBtn_1.active=e,this._skin.lostBtn_1.active=e},updateQuizNum:function(){if(this._data){var e=game.worldcup.getQuizRecordsByMatch(this._data.match);e?(this._skin.winQuizNum.string=e.num1,this._skin.lostQuizNum.string=e.num2,this._skin.dramQuizNum.string=e.num3):(this._skin.winQuizNum.string="0",this._skin.lostQuizNum.string="0",this._skin.dramQuizNum.string="0")}},updateEndTime:function(){if(this._data){var e=this._data.time-game.SysTime.curTime,t=0;if(e>b8e.TimeUtil.DAY_MICRO_SECONDS)t=e/b8e.TimeUtil.DAY_MICRO_SECONDS>>0;var i=e-b8e.TimeUtil.DAY_MICRO_SECONDS*t;0<e?(this._skin.lastTime.string=0<t?game.ccfg.LangCfg.getText(86010,[t,b8e.TimeUtil.formatTime(i)]):game.ccfg.LangCfg.getText(86011,[b8e.TimeUtil.formatTime(i)]),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)):(this._endTimer&&this._endTimer.stop(),this._skin.lastTime.string=game.ccfg.LangCfg.getText(86012),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_RED))}else this._endTimer&&this._endTimer.stop(),this._skin.lastTime.string=game.ccfg.LangCfg.getText(86012),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_RED)},onQuizWinBtn:function(){this._data&&game.worldcup.onQuizMatch(this._data.match,game.WorldCupQuizType.QUIZ_WIN)},onQuizDramBtn:function(){this._data&&game.worldcup.onQuizMatch(this._data.match,game.WorldCupQuizType.QUIZ_DRAW)},onQuizLostBtn:function(){this._data&&game.worldcup.onQuizMatch(this._data.match,game.WorldCupQuizType.QUIZ_LOSE)}})},{}],1029:[function(e,t,i){"use strict";game.WorldCupQuizPage=game.SkinUI.extends({_data:null,_spBg:null,_spTitleBg:null,_quizList:null,_rankList:null,_spQuizBg:null,_listIndex:1,ctor:function(){this._super("worldcup/WorldCupQuizPageSkin","WorldCupQuizPageSkin")},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.quizBg),this._spBg.loadTexture(game.ClientCfg.worldCupQuizBgUrl,null,null,{useManifest:!1}),this._spTitleBg=b8e.Sprite.get(),this._spTitleBg.setAnchor(.5,.5),this._spTitleBg.addToParent(this._skin.titleBg),this._spTitleBg.loadTexture(game.ClientCfg.worldCupTitleBgUrl,null,null,{useManifest:!1}),this._quizList=new b8e.List(this._skin.quizList,game.WorldCupQuizItem),this._rankList=new b8e.List(this._skin.rankList,game.WorldCupRankItem)},onShow:function(){var e;(b8e.evt.onC(this._skin.quizeToggleBtn[0].node,this.onClickQuizBtn,this),b8e.evt.onC(this._skin.quizeToggleBtn[1].node,this.onClickRankBtn,this),b8e.evt.onC(this._skin.helpBtn,this.onHelpBtn,this),b8e.evt.onC(this._skin.serverTipsBtn,this.onShowSeverTips,this),b8e.evt.onC(this._skin.recordBtn,this.showRecordPanel,this),(e=game.worldcup.getAllQuizDataList())&&0<e.length)?(this._quizList.show(),this._quizList.setData(e),this._listIndex=1,this._skin.quizeToggleBtn[0].check(),this._skin.scoreNode.active=!1,this._skin.toggleNode.active=!0,this._skin.quizListNode.active=!0,this._skin.rankListNdoe.active=!1):((e=game.worldcup.getWorldCupScoreRanks())&&(this._rankList.show(),this._rankList.setData(e)),this._skin.quizListNode.active=!1,this._skin.rankListNdoe.active=!0,this._skin.scoreNode.active=!0,this._skin.toggleNode.active=!1)},onHide:function(){b8e.evt.offC(this._skin.quizeToggleBtn[0].node,this.onClickQuizBtn,this),b8e.evt.offC(this._skin.quizeToggleBtn[1].node,this.onClickRankBtn,this),b8e.evt.offC(this._skin.helpBtn,this.onHelpBtn,this),b8e.evt.offC(this._skin.serverTipsBtn,this.onShowSeverTips,this),b8e.evt.offC(this._skin.recordBtn,this.showRecordPanel,this),this._quizList&&this._quizList.hide(),this._rankList&&this._rankList.hide()},onClickQuizBtn:function(){if(1!=this._listIndex){this._listIndex=1;var e=game.worldcup.getAllQuizDataList();e&&(this._quizList.show(),this._quizList.setData(e)),this._skin.quizListNode.active=!0,this._skin.rankListNdoe.active=!1}},onClickRankBtn:function(){if(0!=this._listIndex){this._listIndex=0;var e=game.worldcup.getWorldCupScoreRanks();e&&(this._rankList.show(),this._rankList.setData(e)),this._skin.quizListNode.active=!1,this._skin.rankListNdoe.active=!0}},onHelpBtn:function(){game.app.show(game.AppConstant.RULE_PANEL,game.ClientRuleImgId.WORLDCUP_RULE_ID)},onShowSeverTips:function(){game.worldcup.onServerTip()},showRecordPanel:function(){game.app.show(game.AppConstant.WORLD_CUP_RECORD_PANEL)}})},{}],1030:[function(e,t,i){"use strict";game.WorldCupR16Page=game.SkinUI.extends({_data:null,_spBg:null,_spBg1:null,_team1Icon:null,_team2Icon:null,_listIndex:1,_r16TeamItemList:null,_r16TeamItemPool:null,_finalSchedule:null,_itemGrid:null,ctor:function(){this._super("worldcup/WorldCupR16PageSkin","WorldCupR16PageSkin"),this._r16TeamItemList=[],this._r16TeamItemPool=[]},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.spBg),this._spBg.loadTexture(game.ClientCfg.worldCupR16Bg1Url,null,null,{useManifest:!1}),this._spBg1=b8e.Sprite.get(),this._spBg1.setAnchor(.5,.5),this._spBg1.addToParent(this._skin.spBg1),this._spBg1.loadTexture(game.ClientCfg.worldCupR16Bg2Url,null,null,{useManifest:!1})},onShow:function(){b8e.evt.onC(this._skin.gameToggleBtn[0].node,this.onFirstClick,this),b8e.evt.onC(this._skin.gameToggleBtn[1].node,this.onSecondClick,this),b8e.evt.onC(this._skin.gameToggleBtn[2].node,this.onJueSaiClick,this),b8e.evt.onC(this._skin.team1WinBtn,this.onQuizWinBtn,this),b8e.evt.onC(this._skin.team2WinBtn,this.onQuizLostBtn,this),b8e.evt.onC(this._skin.showServersBtn,this.goToQuiz,this),b8e.evt.onC(this._skin.showRecordBtn,this.showRecordPanel,this),b8e.evt.addG(this,game.WorldCupEvent.UPDATE_WORLDQUIZPAGE,this.updateQuizNum),this.updataTeamInfoByType(game.WorldCupZoneType.FIRST_HALF),this.updataTeamInfoByType(game.WorldCupZoneType.SECOND_HALF),this.setFinalGame(),this.setIndex(1),this._skin.gameToggleBtn[0].check()},onHide:function(){b8e.evt.offC(this._skin.gameToggleBtn[0].node,this.onFirstClick,this),b8e.evt.offC(this._skin.gameToggleBtn[1].node,this.onSecondClick,this),b8e.evt.offC(this._skin.gameToggleBtn[2].node,this.onJueSaiClick,this),b8e.evt.offC(this._skin.team1WinBtn,this.onQuizWinBtn,this),b8e.evt.offC(this._skin.team2WinBtn,this.onQuizLostBtn,this),b8e.evt.offC(this._skin.showServersBtn,this.goToQuiz,this),b8e.evt.offC(this._skin.showRecordBtn,this.showRecordPanel,this),b8e.evt.rmvG(this,game.WorldCupEvent.UPDATE_WORLDQUIZPAGE,this.updateQuizNum),this._quizList&&this._quizList.hide(),this._rankList&&this._rankList.hide(),this.clearR16Items(),this._endTimer&&this._endTimer.stop()},setIndex:function(e){if(this.index!=e)switch(this.index=e){case 1:this._skin.firstHalfNode.active=!0,this._skin.secondHalfNode.active=!1,this._skin.jueSaiNode.active=!1,this._skin.showServersBtn.active=!0,this._skin.showRecordBtn.active=!1,this._spBg1.setVisible(!0),this._spBg1.setScale(1,1);break;case 2:this._skin.firstHalfNode.active=!1,this._skin.secondHalfNode.active=!0,this._skin.jueSaiNode.active=!1,this._skin.showServersBtn.active=!0,this._skin.showRecordBtn.active=!1,this._spBg1.setVisible(!0),this._spBg1.setScale(-1,1);break;case 3:this._skin.firstHalfNode.active=!1,this._skin.secondHalfNode.active=!1,this._skin.jueSaiNode.active=!0,this._skin.showServersBtn.active=!1,this._skin.showRecordBtn.active=!0,this._spBg1.setVisible(!1)}},updataTeamInfoByType:function(e){var t=game.worldcup.getR16ByType(e,game.WorldCupScheduleType.R16);if(t&&0!=t.length){var i,n=0;e!=game.WorldCupZoneType.FIRST_HALF&&(n=1);var s,a,o,r=t.length;for(i=0;i<r&&i<4;++i)s=2*i,(a=new game.WorldCupWinTeam).winnerName=t[i].teamName1,a.winnerIcon=t[i].teamIcon1,(o=this.getR16Item()).setData(a),o.show(),o.addToParent(this._skin["teamR16Node_"+n][s]),(a=new game.WorldCupWinTeam).winnerName=t[i].teamName2,a.winnerIcon=t[i].teamIcon2,(o=this.getR16Item()).setData(a),o.show(),o.addToParent(this._skin["teamR16Node_"+n][s+1]),(o=this.getR16Item()).setData(t[i].worldCupWinTeam),o.show(),o.addToParent(this._skin["teamR8Node_"+n][i]),t[i].isGameEnd&&(this._skin["teamR16Winline_"+n][i].active=t[i].isWin,this._skin["teamR16Lostline_"+n][i].active=!t[i].isWin);var h=game.worldcup.getR16ByType(e,game.WorldCupScheduleType.QUATER_FINAL);if(h&&0!=h.length){for(r=h.length,i=0;i<r&&i<2;++i)(o=this.getR16Item()).setData(h[i].worldCupWinTeam),o.show(),o.addToParent(this._skin["teamR4Node_"+n][i]),h[i].isGameEnd&&(this._skin["teamR8Winline_"+n][i].active=h[i].isWin,this._skin["teamR8Lostline_"+n][i].active=!h[i].isWin);var g=game.worldcup.getR16ByType(e,game.WorldCupScheduleType.SEMI_FINAL);g&&0!=g.length&&((o=this.getR16Item()).setData(g[0].worldCupWinTeam),o.show(),o.addToParent(this._skin["teamFanelNode_"+n]),g[0].isGameEnd&&(this._skin["teamR4Winline_"+n][0].active=g[0].isWin,this._skin["teamR4Lostline_"+n][0].active=!g[0].isWin))}}},setFinalGame:function(){this._finalSchedule=game.worldcup.getFinalSchedule(),this._finalSchedule?(b8e.ShaderUtil.reset(this._skin.finalBtn),this._team1Icon||(this._team1Icon=b8e.Sprite.get(),this._team1Icon.setAnchor(.5,.5),this._team1Icon.addToParent(this._skin.team1Icon)),this._team2Icon||(this._team2Icon=b8e.Sprite.get(),this._team2Icon.setAnchor(.5,.5),this._team2Icon.addToParent(this._skin.team2Icon)),this._skin.gameBeginTime.string=b8e.TimeUtil.formatTimestamp(this._finalSchedule.time,game.ccfg.LangCfg.getText(86013)),this._team1Icon.loadTexture(game.ClientCfg.getNationalFlag(this._finalSchedule.teamIcon1),null,null,{useManifest:!1}),this._team2Icon.loadTexture(game.ClientCfg.getNationalFlag(this._finalSchedule.teamIcon2),null,null,{useManifest:!1}),this._skin.team1Name.string=this._finalSchedule.teamName1,this._skin.team2Name.string=this._finalSchedule.teamName2,this._endTimer||(this._endTimer=b8e.Timer.add(this,this.updateEndTime,500)),this._endTimer.reset(),this._endTimer.start(),game.SysTime.curTime>=this._finalSchedule.time?this.setQuizBtn(!1):this.setQuizBtn(!0),this._skin.fanalGameTips.string=game.ccfg.LangCfg.getText(86014),this.showBestPrize(),this.updateQuizNum()):b8e.ShaderUtil.setGray(this._skin.finalBtn)},setQuizBtn:function(e){this._skin.team1WinBtn.active=e,this._skin.team2WinBtn.active=e},updateQuizNum:function(){if(this._finalSchedule){var e=game.worldcup.getQuizRecordsByMatch(this._finalSchedule.match);e?(this._skin.team1QuizNum.string=e.num1,this._skin.team2QuizNum.string=e.num2,0<e.num1&&(this._skin.team2WinBtn.active=!1),0<e.num2&&(this._skin.team1WinBtn.active=!1)):(this._skin.team1QuizNum.string="0",this._skin.team2QuizNum.string="0")}},updateEndTime:function(){if(this._finalSchedule){var e=this._finalSchedule.time-game.SysTime.curTime,t=0;if(e>b8e.TimeUtil.DAY_MICRO_SECONDS)t=e/b8e.TimeUtil.DAY_MICRO_SECONDS>>0;var i=e-b8e.TimeUtil.DAY_MICRO_SECONDS*t;0<e?(this._skin.lastTime.string=0<t?game.ccfg.LangCfg.getText(86010,[t,b8e.TimeUtil.formatTime(i)]):game.ccfg.LangCfg.getText(86011,[b8e.TimeUtil.formatTime(i)]),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_GREEN)):(this._endTimer&&this._endTimer.stop(),this._skin.lastTime.string=game.ccfg.LangCfg.getText(86012),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_RED))}else this._endTimer&&this._endTimer.stop(),this._skin.lastTime.string=game.ccfg.LangCfg.getText(86012),this._skin.lastTime.node.color=b8e.ColorUtil.toCCColor(game.html.Q_RED)},showBestPrize:function(){var e=game.ccfg.ItemInfoCfg.getItemInfoById(606030,!0);if(e){this._itemGrid||(this._itemGrid=new game.ItemGrid(game.IcoSizeEnum.SIZE_90),this._itemGrid.gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),this._itemGrid.addToParent(this._skin.prizeItem)),game.GridUtil.setItemGrid(this._itemGrid,e);var t=e.num;this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.setName(e.name,game.html.getColorByQuality(e.quality),null,200,30,20),this._itemGrid.fnOnClick(this,this.onClick),this._itemGrid.setNum(t),this._itemGrid.sortLayer(),this._itemGrid.fnOnClick(this,this.onClick)}},onClick:function(e){e&&e.faceInfo&&(game.back.isBianshenCard(e.faceInfo.id)?game.bianshen.showBianshenDetail(e.faceInfo):e.faceInfo.isEquip?game.app.show(game.AppConstant.EQUIP_BASE_TIPS,e.faceInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId}))},getR16Item:function(){if(0<this._r16TeamItemPool.length)e=this._r16TeamItemPool.shift();else var e=new game.WorldCupR16TeamItem;return this._r16TeamItemList.push(e),e},clearR16Items:function(){for(;0<this._r16TeamItemList.length;){var e=this._r16TeamItemList.shift();e.hide(),e.removeFromParent(),this._r16TeamItemPool.push(e)}},onFirstClick:function(){this.setIndex(1)},onSecondClick:function(){this.setIndex(2)},onJueSaiClick:function(){this._finalSchedule?this.setIndex(3):this._skin.gameToggleBtn[this.index-1].check()},goToQuiz:function(){game.worldcup.goToQuiz()},showRecordPanel:function(){game.app.show(game.AppConstant.WORLD_CUP_RECORD_PANEL)},onQuizWinBtn:function(){this._finalSchedule&&game.worldcup.onQuizMatch(this._finalSchedule.match,game.WorldCupQuizType.QUIZ_WIN)},onQuizLostBtn:function(){this._finalSchedule&&game.worldcup.onQuizMatch(this._finalSchedule.match,game.WorldCupQuizType.QUIZ_LOSE)}})},{}],1031:[function(e,t,i){"use strict";game.WorldCupR16TeamItem=game.SkinUI.extends({_data:null,_iconName:null,_teamName:null,_isBegin:!1,teamIcon:null,ctor:function(){this._super("worldcup/WorldCupR16TeamItemSkin","WorldCupR16TeamItemSkin")},init:function(){this.teamIcon=b8e.Sprite.get(),this.teamIcon.setAnchor(.5,.5),this.teamIcon.addToParent(this._skin.teamIcon)},onShow:function(){this.setData(this._data)},onHide:function(){},setData:function(e){this._data=e,this._skin&&e&&(e.winnerIcon?(this.teamIcon.loadTexture(game.ClientCfg.getNationalFlag(e.winnerIcon),null,null,{useManifest:!1}),this.teamIcon.setScale(.73)):(this.teamIcon.loadTexture(game.ClientCfg.worldCupNoneNationalFlag,null,null,{useManifest:!1}),this.teamIcon.setScale(1)),e.winnerName?this._skin.teamName.string=e.winnerName:this._skin.teamName.string="",this._skin.isBegin.active=game.SysTime.curTime<e._beginTime)},setIcon:function(e){this._skin&&(e?this.teamIcon.loadTexture(game.ClientCfg.getNationalFlag(e),null,null,{useManifest:!1}):this.teamIcon.loadTexture(game.ClientCfg.worldCupNoneNationalFlag,null,null,{useManifest:!1}))},setName:function(e){this._skin&&(e?this._skin.teamName.string=e:this._skin.teamName.tring="")},setBegin:function(e){this._skin&&(this._skin.isBegin.active=e)}})},{}],1032:[function(e,t,i){"use strict";game.WorldCupRankItem=game.SkinUI.extends({_data:null,_spBg:null,nicknameicon:null,ctor:function(){this._super("worldcup/WorldCupRankItemSkin","WorldCupRankItemSkin")},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.itemBg),this._spBg.loadTexture(game.ClientCfg.worldCupRankBgUrl,null,null,{useManifest:!1}),this.nicknameicon=b8e.Sprite.get(),this.nicknameicon.setAnchor(.5,.5),this.nicknameicon.addToParent(this._skin.nickNameIcon)},onShow:function(){this.setData(this._data)},onHide:function(){},getWidth:function(){return 532},getHeight:function(){return 111},setData:function(e){if(this._data=e,this._skin&&this._data){this._skin.rankLab.string=game.ccfg.LangCfg.getText(86015,[e.rank]),this._skin.playerName.string=e.name+"s."+e.zone,this._skin.score.string=game.ccfg.LangCfg.getText(86016,[e.score]);var t=game.worldcup.getNickNameByRank(e.rank);t&&this.nicknameicon.loadTexture(game.ClientCfg.getNickNameIconUrl(t),null,null,{useManifest:!1})}}})},{}],1033:[function(e,t,i){"use strict";game.WorldCupRecordItem=game.SkinUI.extends({_data:null,_spBg:null,_team1Icon:null,_team2Icon:null,ctor:function(){this._super("worldcup/WorldCupRecordItemSkin","WorldCupRecordItemSkin")},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.itemBg),this._spBg.loadTexture(game.ClientCfg.worldCupVsBgUrl,null,null,{useManifest:!1}),this._team1Icon=b8e.Sprite.get(),this._team1Icon.setAnchor(.5,.5),this._team1Icon.setScale(.8),this._team1Icon.addToParent(this._skin.team1_icon),this._team2Icon=b8e.Sprite.get(),this._team2Icon.setAnchor(.5,.5),this._team2Icon.setScale(.8),this._team2Icon.addToParent(this._skin.team2_icon)},onShow:function(){this.setData(this._data)},onHide:function(){},getWidth:function(){return 532},getHeight:function(){return 229},setData:function(e){if(this._data=e,this._skin&&this._data){this._skin.dramNode.active=!(e.type>game.WorldCupScheduleType.TEAM),this._skin.time.string=b8e.TimeUtil.formatTimestamp(e.time,game.ccfg.LangCfg.getText(86013)),this._team1Icon.loadTexture(game.ClientCfg.getNationalFlag(e.teamIcon1),null,null,{useManifest:!1}),this._team2Icon.loadTexture(game.ClientCfg.getNationalFlag(e.teamIcon2),null,null,{useManifest:!1}),this._skin.team1Name.string=e.teamName1,this._skin.team2Name.string=e.teamName2;var t=game.worldcup.getQuizRecordsByMatch(this._data.match);if(t){this._skin.winQuizNum.string=t.num1,this._skin.lostQuizNum.string=t.num2,this._skin.dramQuizNum.string=t.num3;var i=0|game.ccfg.GlobalParamCfg.getData(7002),n=t.getQuizNUmByType(e.resultType)*i;this._skin.resultTips.string=0<n?game.ccfg.LangCfg.getText(86017,[n]):game.ccfg.LangCfg.getText(86018)}else this._skin.winQuizNum.string="0",this._skin.lostQuizNum.string="0",this._skin.dramQuizNum.string="0";switch(e.resultType){case game.WorldCupQuizType.QUIZ_WIN:this._skin.winLab.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW),this._skin.winQuizNum.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW);break;case game.WorldCupQuizType.QUIZ_LOSE:this._skin.loseLab.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW),this._skin.lostQuizNum.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW);break;case game.WorldCupQuizType.QUIZ_DRAW:this._skin.dramLab.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW),this._skin.dramQuizNum.node.color=b8e.ColorUtil.toCCColor(game.html.Q_YELLOW)}}}})},{}],1034:[function(e,t,i){"use strict";game.appModule.WorldCupRecordPanel=game.SkinUIPanel.extends({_spBg:null,_list:null,_recordBg:null,ctor:function(e){this._super(e)},init:function(){this._spBg=b8e.Sprite.get(),this._spBg.setAnchor(.5,.5),this._spBg.addToParent(this._skin.worldcupBg),this._spBg.loadTexture(game.ClientCfg.worldCupBgUrl,null,null,{useManifest:!1}),this._recordBg=b8e.Sprite.get(),this._recordBg.setAnchor(.5,.5),this._recordBg.addToParent(this._skin.recordBg),this._recordBg.loadTexture(game.ClientCfg.worldCupRecordBgUrl,null,null,{useManifest:!1}),this._list=new b8e.List(this._skin.recordList,game.WorldCupRecordItem)},onShow:function(){var e=game.worldcup.getShowRecords();e&&(this._list.show(),this._list.setData(e)),this._skin.socreTip.string="我的投注收益:+"+game.worldcup.getScore()},onHide:function(){this._list&&this._list.hide()}})},{}],1035:[function(e,t,i){"use strict";var n=game.WorldCupSender=function(){};n.reqWorldCupCfg=function(){var e=game.pbmid.Activity.WorldCupCfgRequest;b8e.sendN(e)},n.reqWorldCupQuiz=function(e,t,i){var n=game.pbmsg.WorldCupPredictionRequest;n.match=e,n.type=t,n.num=i,engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Activity.WorldCupPredictionRequest;b8e.sendN(s)},n.reqWorldCupActivity=function(){var e=game.pbmid.Activity.WorldCupActivityRequest;b8e.sendN(e)}},{}],1036:[function(e,t,i){"use strict";game.XiandanCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Xiandan.QryXiandanModuleResponse,this.onQryXiandanModuleResponse,this),b8e.addNH(game.pbmid.Xiandan.UseXiandanResponse,this.onUseXiandanResponse,this)},onQryXiandanModuleResponse:function(e){var t=e.readProtobuf(game.pbmsg.QryXiandanModuleResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.xiandan.synXiandanModule(t.xiandanList)},onUseXiandanResponse:function(e){var t=e.readProtobuf(game.pbmsg.UseXiandanResponse);0<t.code?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)):game.xiandan.syncBatchUseXiandanRespone(t.usedTimes)}})},{}],1037:[function(e,t,i){"use strict";game.XiandanType=b8e.Enum({XIANDAN_HP:0,XIANDAN_ATK:1,XIANDAN_DEF:2,XIANDAN_HIT:3,XIANDAN_AVD:4,XIANDAN_CIRT:5,XIANDAN_CIRT_RE:6})},{}],1038:[function(e,t,i){"use strict";game.XiandanEvents=b8e.Enum({UPDATE_XIANDAN:b8e.Event.nextCode(),USE_XIANDAN_SUCCESS:b8e.Event.nextCode(),BTN_CHANGE:b8e.Event.nextCode()})},{}],1039:[function(e,t,i){"use strict";game.XiandanMgr=b8e.Object.extends({name:"XiandanMgr",_xiandanUsedMap:null,isInit:!1,selectSubType:0,ctor:function(){if(1==game.XiandanMgr._singleton)throw new Error("XiandanMgr 只能通过单例方法获取");this._xiandanUsedMap=b8e.HashMap.get(),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onXiandanOpenCallBack),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onXiandanOpenCallBack)},checkOpen:function(){game.funcOpen.checkOpen(game.FunctionType.XIAN_DAN)&&this.initReq()},onXiandanOpenCallBack:function(){game.funcOpen.checkOpen(game.FunctionType.XIAN_DAN)&&(this.initReq(),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onXiandanOpenCallBack),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onXiandanOpenCallBack))},initReq:function(){this.isInit||(game.XiandanSender.reqXiandanModule(),this.isInit=!0)},synXiandanModule:function(e){for(var t,i=0;i<e.length;i++){var n=e[i];(t=new game.XiandanInfo).setup(n),this._xiandanUsedMap.set(t.id,t)}b8e.evt.dptG(game.XiandanEvents.UPDATE_XIANDAN)},_synUseXiandanResponse:function(e,t){var i=this._xiandanUsedMap.get(e);if(i)i.usedTimes=t,this._xiandanUsedMap.set(e,i);else{var n=new game.XiandanInfo;n.id=e,n.usedTimes=t,this._xiandanUsedMap.set(e,n)}},syncBatchUseXiandanRespone:function(e){for(var t=0,i=e.length;t<i;t++)if(e[t]){var n=e[t].id,s=e[t].usedTimes;this._synUseXiandanResponse(n,s)}b8e.evt.dptG(game.XiandanEvents.USE_XIANDAN_SUCCESS)},getXiandanAllPower:function(){if(this._xiandanUsedMap&&0<this._xiandanUsedMap.count()){for(var e,t,i=this._xiandanUsedMap.values(),n=game.mainRole.mainRoleData.getLv(),s=0,a=0;a<i.length;a++){var o=i[a];t=game.ccfg.XiandanCfg.getAttrById(o.id),e=game.ccfg.SpriteStatCfg.getSpriteStatById(t),s+=game.CCommonUtil.getPower(e,n)*o.usedTimes}return s}return 0},getUsedArr:function(){return this._xiandanUsedMap.values()},getXiandanBtns:function(){var e=game.ccfg.XiandanBarCfg.getDatas();return e&&0<e.length?(e.sort(this.setSort),e):null},setSort:function(e,t){return e.sortId>t.sortId?1:e.sortId<t.sortId?-1:0},getUsedTimesById:function(e){var t=this._xiandanUsedMap.get(e);return t?t.usedTimes:0},selectType:function(e){this.selectSubType!=e&&(this.selectSubType=e,b8e.evt.dptG(game.XiandanEvents.BTN_CHANGE))},isXiandanAlert:function(e){var t=game.back.getItemListByType(game.GoodsType.XIANDAN);if(t&&0<t.length)for(var i,n,s,a=game.dujie.getSelfDujieLv(),o=0;o<t.length;o++){var r=t[o];if(r){var h=game.ccfg.XiandanCfg.getDataByKey(r.id);if(h&&(i=game.back.getItemInfoCountById(r.id),n=this.getUsedTimesById(h.id),s=h.useTimesLimits[a],0<i&&n<s&&h.type==e))return!0}}return!1},canUseXiandan:function(){var e=game.back.getItemListByType(game.GoodsType.XIANDAN);if(!(e&&0<e.length))return!1;for(var t=0;t<e.length;t++){var i=e[t];if(i)return this.canUseXiandanById(i.id)}},canUseXiandanById:function(e){var t=game.dujie.getSelfDujieLv(),i=game.ccfg.XiandanCfg.getDataByKey(e);if(!i)return!1;var n=game.back.getItemInfoCountById(e),s=this.getUsedTimesById(i.id),a=i.useTimesLimits[t];return 0<n&&s<a},useAllxiandan:function(){var e=[],t=game.back.getItemListByType(game.GoodsType.XIANDAN);if(t&&0<t.length)for(var i,n,s,a=game.dujie.getSelfDujieLv(),o=0,r=t.length;o<r;o++){var h=t[o];if(h){var g=game.ccfg.XiandanCfg.getDataByKey(h.id);if(g&&(i=game.back.getItemInfoCountById(h.id),n=this.getUsedTimesById(g.id),s=g.useTimesLimits[a],0<i&&n<s)){var l=b8e.ProtobufUtil.createMessage(game.pbmsg.ItemView);l.id=h.id,l.num=Math.min(s-n,i),e.push(l)}}}0<e.length?game.XiandanSender.reqUseAllXiandan(e):game.notice.show(game.ccfg.LangCfg.getText(51002))},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.XIANDAN_ALERT,null,this.xiandanAlert,this)},xiandanAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.XIAN_DAN)&&this.canUseXiandan())return!0;return!1}}),game.XiandanMgr._instance=null,game.XiandanMgr._singleton=!0,game.XiandanMgr.inst=function(){return game.XiandanMgr._instance||(game.XiandanMgr._singleton=!1,game.XiandanMgr._instance=new game.XiandanMgr,game.XiandanMgr._singleton=!0),game.XiandanMgr._instance}},{}],1040:[function(e,t,i){"use strict";game.XiandanBtn=game.SkinUI.extends({_data:null,_normal:null,_select:null,ctor:function(){this._super("xiandan/XiandanBtnSkin","XiandanBtnSkin")},onShow:function(){b8e.evt.onC(this._skin.touch,this.onTouchThis,this),this.initItem(),this.setData(this._data)},onHide:function(){b8e.evt.offC(this._skin.touch,this.onTouchThis,this)},initItem:function(){this._normal||(this._normal=b8e.Sprite.get(),this._normal.addToParent(this._skin.normalTitle)),this._select||(this._select=b8e.Sprite.get(),this._select.addToParent(this._skin.selectTitle))},onTouchThis:function(){game.xiandan.selectType(this._data.type)},setData:function(e){if(this._data=e,this._skin){var t=game.xiandan.isXiandanAlert(e.type);this._skin.alert.active=!!t,this._normal.loadTexture(game.ClientCfg.getImgUrl(e.titleBg,!1),null,null,{useManifest:!1}),this._skin.normalTitle.active=!0,this._skin.selectTitle.active=!1;var i=game.xiandan.selectSubType;this._data.type==i&&(this._skin.selectTitle.active=!0)}},getHeight:function(){return 95},getWidth:function(){return 85}})},{}],1041:[function(e,t,i){"use strict";game.appModule.XiandanDetailsPanel=game.SkinUIPanel.extends({_hp:0,_atk:0,_def:0,_hit:0,_avd:0,_crit:0,_critReduction:0,ctor:function(e){this._super(e)},onShow:function(){this.showAttr()},onHide:function(){this.clearData()},showAttr:function(){for(var e=game.xiandan.getUsedArr(),t=0;t<e.length;t++){var i=e[t],n=game.ccfg.XiandanCfg.getAttrById(i.id),s=game.ccfg.SpriteStatCfg.getSpriteStatById(n);this.setSpriteStatAttrValue(s,i.usedTimes)}this.setAttrLab()},setSpriteStatAttrValue:function(e,t){if(e){var i=e.getSpriteStats();if(i&&0<i.length)for(var n=0;n<i.length;n++){var s=i[n];if(s)switch(s.type){case game.SpriteStatType.MAXHP:this._hp+=s.value*t;break;case game.SpriteStatType.ATK:this._atk+=s.value*t;break;case game.SpriteStatType.DEF:this._def+=s.value*t;break;case game.SpriteStatType.HIT:this._hit+=s.value*t;break;case game.SpriteStatType.DODGE:this._avd+=s.value*t;break;case game.SpriteStatType.CRIT:this._crit+=s.value*t;break;case game.SpriteStatType.CRIT_REDUCTION:this._critReduction+=s.value*t}}}},setAttrLab:function(){var e=(0<this._hp?"生命          "+[game.html.getText(game.html.Q_GREEN,"+"+this._hp)]+"\n\n":"")+(0<this._atk?"攻击          "+[game.html.getText(game.html.Q_GREEN,"+"+this._atk)]+"\n\n":"")+(0<this._def?"防御          "+[game.html.getText(game.html.Q_GREEN,"+"+this._def)]+"\n\n":"")+(0<this._hit?"命中          "+[game.html.getText(game.html.Q_GREEN,"+"+this._hit)]+"\n\n":"")+(0<this._avd?"闪避          "+[game.html.getText(game.html.Q_GREEN,"+"+this._avd)]+"\n\n":"")+(0<this._crit?"暴击          "+[game.html.getText(game.html.Q_GREEN,"+"+this._crit)]+"\n\n":"")+(0<this._critReduction?"抗暴          "+[game.html.getText(game.html.Q_GREEN,"+"+this._critReduction)]+"\n\n":"");0==this._hp&&0==this._atk&&0==this._def&&0==this._hit&&0==this._avd&&0==this._crit&&0==this._critReduction&&(e="您没有使用过任何仙丹"),this._skin.lab_attr.string=e},clearData:function(){this._hp=0,this._atk=0,this._def=0,this._hit=0,this._avd=0,this._crit=0,this._critReduction=0}})},{}],1042:[function(e,t,i){"use strict";game.XiandanItem=game.SkinUI.extends({_red:null,_white:null,_itemInfo:null,_xiandanInfo:null,ctor:function(e){this._super("xiandan/XiandanItemSkin","XiandanItemSkin"),this._red=b8e.ColorUtil.toCCColor(4294901760),this._green=b8e.ColorUtil.toCCColor(4278255360),this._xiandanInfo=e},getHeight:function(){return 135},getWidth:function(){return 535},onShow:function(){this.setData(this._xiandanInfo),b8e.evt.onC(this._skin.btn_use,this.onClickUseBtn,this)},onHide:function(){b8e.evt.offC(this._skin.btn_use,this.onClickUseBtn,this)},setData:function(e){if(this._xiandanInfo=e,this._skin&&this._xiandanInfo){var t,i=game.dujie.getSelfDujieLv();this._curCount=game.xiandan.getUsedTimesById(e.id),t=i&&0<=i?e.useTimesLimits[i]:e.useTimesLimits[0],this._skin.progress.string=this._curCount+"/"+t,this._skin.bar.width=this._curCount/t*this._skin.progressBar.width;var n=game.back.getItemInfoCountById(e.id);0<(this._skin.lab_remainNum.string=n)?(this._skin.lab_remainNum.node.color=this._green,this._skin.btnBg_blue.active=!1):(this._skin.lab_remainNum.node.color=this._red,this._skin.btnBg_blue.active=!0),0<this._curCount?this._skin.lab_use.string=game.html.getText(game.html.Q_GREEN,this._curCount)+"个":this._skin.lab_use.string=game.html.getText(game.html.Q_RED,this._curCount)+"个";var s=game.ccfg.ItemInfoCfg.getItemInfoById(e.id);this._itemInfo=s,this._itemGrid||(this._itemGrid=game.GridUtil.creatItemGrid(this,this._skin.node_icon,null,game.ContainerId.TIPS_CONTAINER_ID),this._itemGrid.fnOnClick(this,this.onClick)),game.GridUtil.setItemGrid(this._itemGrid,s),this._itemGrid.setName(s.name,game.html.getColorByQuality(s.quality),null,200,30,24),this._itemGrid.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),this._itemGrid.sortLayer();var a=game.ccfg.XiandanCfg.getAttrById(e.id),o=game.ccfg.SpriteStatCfg.getSpriteStatById(a);this._skin.lab_attr.string=this.getSpriteStatAttrStr(o,!0)}},onClick:function(e){this._itemInfo&&game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:this._itemInfo,containerId:game.ContainerId.TIPS_CONTAINER_ID})},onClickUseBtn:function(){if(this._xiandanInfo){var e=game.dujie.getSelfDujieLv();if(0<=e){var t=this._xiandanInfo.useTimesLimits[e],i=game.back.getItemInfoCountById(this._xiandanInfo.id);if(0<i&&this._curCount<t){var n=b8e.ProtobufUtil.createMessage(game.pbmsg.ItemView);n.id=this._xiandanInfo.id,n.num=1;var s=[];s.push(n),game.XiandanSender.reqUseAllXiandan(s)}else i<=0?game.notice.show(game.ccfg.LangCfg.getText(51001)):this._curCount>=t&&game.notice.show(game.ccfg.LangCfg.getText(51e3))}}},getSpriteStatAttrStr:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i="",n="",s="";if(e){var a=e.getSpriteStats();if(a&&0<a.length)for(var o=0;o<a.length;o++){var r=a[o];r&&(n=game.ccfg.AttrRulesCfg.getAttrNameByType(r.type),o!=a.length-1&&(s="\n"),i+=t?n+game.html.getText(game.html.Q_GREEN," +"+r.value*this._curCount)+s:game.html.getText(game.html.Q_GREEN," +"+r.value*this._curCount)+s)}}return i}})},{}],1043:[function(e,t,i){"use strict";game.appModule.XiandanPanel=game.SkinUIPanel.extends({_list:null,_btnList:null,_tabIndex:-1,_xiandanArr:null,ctor:function(e){this._super(e),this._xiandanArr=[]},init:function(){this._list||(this._list=new b8e.List(this._skin.list,game.XiandanItem)),this._btnList||(this._btnList=new b8e.List(this._skin.list_btn,game.XiandanBtn,7))},onShow:function(){this._xiandanArr=game.ccfg.XiandanCfg.getDatas(),this._list.show(),this._btnList.show(),this.data?this._tabIndex=this.data:-1==this._tabIndex&&(this._tabIndex=game.XiandanType.XIANDAN_HP),this._skin.buttonToggle&&this._skin.buttonToggle.length&&this._skin.buttonToggle[this._tabIndex].check(),this.updateBtn(),this.onSelectPanelByIndex(this._tabIndex),b8e.evt.onC(this._skin.btn_watch,this.clickWatchBtn,this),b8e.evt.onC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.onC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.onC(this._skin.btn_useAll,this.clickUseAllBtn,this),b8e.evt.addG(this,game.XiandanEvents.UPDATE_XIANDAN,this.selectHp),b8e.evt.addG(this,game.XiandanEvents.USE_XIANDAN_SUCCESS,this.updateCurPanel),b8e.evt.addG(this,game.XiandanEvents.BTN_CHANGE,this.updateCurPanel),b8e.evt.addG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCurPanel)},onHide:function(){this._list&&this._list.hide(),this._btnList&&this._btnList.hide(),b8e.evt.offC(this._skin.btn_watch,this.clickWatchBtn,this),b8e.evt.offC(this._skin.btn_left,this.clickLeftBtn,this),b8e.evt.offC(this._skin.btn_right,this.clickRightBtn,this),b8e.evt.offC(this._skin.btn_useAll,this.clickUseAllBtn,this),b8e.evt.rmvG(this,game.XiandanEvents.UPDATE_XIANDAN,this.selectHp),b8e.evt.rmvG(this,game.XiandanEvents.USE_XIANDAN_SUCCESS,this.updateCurPanel),b8e.evt.rmvG(this,game.XiandanEvents.BTN_CHANGE,this.updateCurPanel),b8e.evt.rmvG(this,game.BackEvt.BACK_UPDATE_ITEMINFO,this.updateCurPanel)},updateCurPanel:function(){this.updateBtn(),this.onSelectPanelByIndex(game.xiandan.selectSubType)},updateBtn:function(){var e=game.xiandan.getXiandanBtns();this._btnList.setData(e)},onSelectPanelByIndex:function(e){this._tabIndex=e;var t=[];this._skin.lab_power.string=game.xiandan.getXiandanAllPower();for(var i=0;i<this._xiandanArr.length;i++){var n=this._xiandanArr[i];n.type==this._tabIndex&&t.push(n)}t&&0<t.length&&this._list.setData(t)},clickLeftBtn:function(){this._btnList&&this._btnList.scrollLeft()},clickRightBtn:function(){this._btnList&&this._btnList.scrollRight()},clickWatchBtn:function(){game.app.show(game.AppConstant.XIANDAN_DETAILS_PANEL)},clickUseAllBtn:function(){game.xiandan.useAllxiandan()},selectHp:function(){0!=this._tabIndex&&this.onSelectPanelByIndex(0)},setTab:function(e){return!!this._skin&&("0"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_HP,this.onSelectPanelByIndex(0)):"1"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_ATK,this.onSelectPanelByIndex(1)):"2"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_DEF,this.onSelectPanelByIndex(2)):"3"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_HIT,this.onSelectPanelByIndex(3)):"4"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_AVD,this.onSelectPanelByIndex(4)):"5"==e?(game.xiandan.selectSubType=game.XiandanType.XIANDAN_CIRT,this.onSelectPanelByIndex(5)):"6"==e&&(game.xiandan.selectSubType=game.XiandanType.XIANDAN_CIRT_RE,this.onSelectPanelByIndex(6)),!0)}})},{}],1044:[function(e,t,i){"use strict";var n=game.XiandanSender=function(){};n.reqXiandanModule=function(){var e=game.pbmid.Xiandan.QryXiandanModuleRequest;b8e.sendN(e)},n.reqUseXiandan=function(e){var t=game.pbmsg.UseXiandanRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Xiandan.UseXiandanRequest;b8e.sendN(i)},n.reqUseAllXiandan=function(e){var t=game.pbmsg.UseXiandanRequest;t.xiandans=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Xiandan.UseXiandanRequest;b8e.sendN(i)}},{}],1045:[function(e,t,i){"use strict";e("./event/XiandanEvents"),e("./sender/XiandanSender"),e("./manager/XiandanMgr"),e("./cmdlistener/XiandanCmd"),e("./panel/XiandanDetailsPanel"),e("./panel/XiandanItem"),e("./panel/XiandanPanel")},{"./cmdlistener/XiandanCmd":1036,"./event/XiandanEvents":1038,"./manager/XiandanMgr":1039,"./panel/XiandanDetailsPanel":1041,"./panel/XiandanItem":1042,"./panel/XiandanPanel":1043,"./sender/XiandanSender":1044}],1046:[function(e,t,i){"use strict";game.ZhanyaoCmd=game.BaseBean.extends({start:function(){b8e.addNH(game.pbmid.Instance.ZhanYaoQuestInfoResponse,this.onZhanYaoQuestInfoResponse,this),b8e.addNH(game.pbmid.Instance.ZhanYaoCompleteResponse,this.onZhanYaoCompleteResponse,this),b8e.addNH(game.pbmid.Instance.ZhanYaoScoreAwardCollectResponse,this.onZhanYaoScoreAwardCollectResponse,this),b8e.addNH(game.pbmid.Instance.ZhanYaoQuestProgressNotify,this.onZhanYaoQuestProgressNotify,this),b8e.addNH(game.pbmid.Instance.ZhanYaoQuickCompleteResponse,this.onZhanYaoQuickCompleteResponse,this)},onZhanYaoQuestInfoResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ZhanYaoQuestInfoResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.zhanyao.setZhanyaoQuestInfo(i)},onZhanYaoCompleteResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ZhanYaoCompleteResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.zhanyao.zhanYaoComplete(i)},onZhanYaoScoreAwardCollectResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ZhanYaoScoreAwardCollectResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.zhanyao.zhanYaoScoreAwardCollect(i)},onZhanYaoQuestProgressNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ZhanYaoQuestProgressNotify);i&&game.zhanyao.zhanyaoQuestProgressUpdate(i)},onZhanYaoQuickCompleteResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.ZhanYaoQuickCompleteResponse),n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.zhanyao.zhanYaoComplete(i)}})},{}],1047:[function(e,t,i){"use strict";e("./ZhanyaoCmd")},{"./ZhanyaoCmd":1046}],1048:[function(e,t,i){"use strict";game.ZhanyaoEvents=b8e.Enum({UPDATE_ZHANYAO_QUEST:b8e.Event.nextCode(),UPDATE_ZHANYAO_AWARD:b8e.Event.nextCode()})},{}],1049:[function(e,t,i){"use strict";e("./ZhanyaoEvents")},{"./ZhanyaoEvents":1048}],1050:[function(e,t,i){"use strict";game.ZhanyaoMgr=b8e.Object.extends({curQuestId:1,score:0,totalProgress:0,awardScoreList:null,isRequest:!1,zhanyaoMaxScore:0,_gameAlertInfo:null,ctor:function(){if(1==game.ZhanyaoMgr._singleton)throw new Error("ZhanyaoMgr 只能通过单例方法获取");this.awardScoreList=[],this.init()},init:function(){b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.addG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onLevelUp)},firstEnterScene:function(){game.funcOpen.checkOpen(game.FunctionType.ZHANYAO)&&(this.sendZhanYaoQuestInfo(),this.isRequest||(this.isRequest=!0,b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.rmvG(this,game.QuestEvents.MAIN_ROLE_LEVEL_UP,this.onLevelUp)))},onLevelUp:function(){game.funcOpen.checkOpen(game.FunctionType.ZHANYAO)&&(this.isRequest||(this.isRequest=!0,this.sendZhanYaoQuestInfo()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.rmvG(this,game.QuestEvents.MAIN_ROLE_LEVEL_UP,this.onLevelUp))},onMainQuestComplete:function(){game.funcOpen.checkOpen(game.FunctionType.ZHANYAO)&&(this.isRequest||(this.isRequest=!0,this.sendZhanYaoQuestInfo()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest),b8e.evt.rmvG(this,game.QuestEvents.MAIN_ROLE_LEVEL_UP,this.onLevelUp))},onMainQuest:function(){game.funcOpen.checkOpen(game.FunctionType.ZHANYAO)&&(this.isRequest||(this.isRequest=!0,this.sendZhanYaoQuestInfo()),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_COMPLETE,this.onMainQuestComplete),b8e.evt.rmvG(this,game.QuestEvents.MAIN_QUEST_NOTIFY,this.onMainQuest))},setZhanyaoQuestInfo:function(e){e&&(this.curQuestId=e.questId,this.score=e.score,this.totalProgress=e.progress,this.awardScoreList=e.collectScores)},zhanYaoComplete:function(e){if(e){this.score=e.score;var t=e.collectScoreAwards;if(t){var i=t.length,n=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_ZHANYAO_SCORE);n|=0;for(var s=0;s<i;s++)this.awardScoreList.push(t[s]*n);b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_QUEST)}else b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_QUEST)}},zhanYaoScoreAwardCollect:function(e){if(e){var t=e.score;-1==this.awardScoreList.indexOf(t)?(this.awardScoreList.push(t),b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_AWARD)):b8e.error("该积分奖励已经领取！")}},zhanyaoQuestProgressUpdate:function(e){this.curQuestId=e.questId,this.totalProgress=e.progress;var t="",i=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);if(i){var n=i.conditionParam2;this.totalProgress==n&&game.app.showAppNoHide(game.AppConstant.ZHANYAO_GOTO_PANEL),t=this.totalProgress+"/"+n}game.notice.show(1000008,[t]),b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_QUEST)},zhanyaoQuestScoreUpdate:function(e){this.score=e.score,b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_AWARD)},sendZhanYaoQuestInfo:function(){game.ZhanyaoSender.zhanYaoQuestInfoRequest()},sendZhanYaoComplete:function(){var e=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);if(e){var t=e.conditionParam2;this.totalProgress<t?game.notice.show("当前任务未完成"):game.ZhanyaoSender.zhanYaoCompleteRequest()}},sendZhanYaoScoreAwardCollect:function(e){0!=e?-1==this.awardScoreList.indexOf(e)?e>this.score?game.notice.show("当前积分未达到"):game.ZhanyaoSender.zhanYaoScoreAwardCollectRequest(e):game.notice.show("当前奖励已领取"):game.notice.show("当前没有可领取奖励")},resetDaily:function(){this.score=0,this.awardScoreList.length=0},gotoZhanyao:function(){var e=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);e||b8e.error("该任务id不存在！");var t=e.destinationList[0],i=game.ccfg.MonGenCfg.getMonGenInfoById(t);if(i){i.pos;var n=i.mapid;i.monid,game.TrusteeshipMgr.inst().pause(!0),game.SceneMgr.inst().sceneTransType=game.SceneTransType.TYPE_ZHANYAO,game.SceneSender.moveToRequest(game.SceneTransType.TYPE_ZHANYAO,n),game.quest.changeAuto(!1),game.app.isShow(game.AppConstant.ZHANYAO_PANEL)&&game.app.hide(game.AppConstant.ZHANYAO_PANEL),game.notice.show(12001)}else b8e.warn("monGenId：》》》》》》》"+t)},moveToMapTask:function(){var e=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);e||b8e.error("该任务id不存在！");var t=e.destinationList[0],i=game.ccfg.MonGenCfg.getMonGenInfoById(t);if(i){var n;n=i.monid,game.TrusteeshipMgr.inst().start(n)}else b8e.warn("monGenId：》》》》》》》"+t)},getAwardIsGet:function(e){return-1!=this.awardScoreList.indexOf(e)},getAwardIsCanGet:function(e){return this.score>=e},quickComplete:function(){var e=this._gameAlertInfo?this._gameAlertInfo:new game.GameAlertInfo;e.alertType=game.GameAlertType.TwoYuanBaoBtn,e.isShowTips=!1,e.string=game.ccfg.LangCfg.getText(85021),e.confirmString=game.ccfg.LangCfg.getText(85002),e.cancelString=game.ccfg.LangCfg.getText(85003);var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.QUEST_ZHANYAO_COMPLETE);if(t){var i=t.split("|"),n=i[0],s=0|i[1];if(game.ccfg.ItemInfoCfg.getItemInfoById(n)){e.oneTimeCount=s;var a=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_ZHANYAO_SCORE),o=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.ADD_ZHANYAO_SCORE),r=Math.max((a-this.score)/o,0);r>>=0,e.allclearCount=r*s,game.gameAlert.showAlert(this,this.onClick,e)}}else b8e.warn("一键斩妖参数配置表不对？")},onClick:function(e,t){if(e)switch(t){case game.GameAlertBtnType.CONFIRM:game.ZhanyaoSender.zhanYaoQuickCompleteRequest(!0);break;case game.GameAlertBtnType.CANCEL:game.ZhanyaoSender.zhanYaoQuickCompleteRequest(!1);break;case game.GameAlertBtnType.CLOSE:}},quickCompleteRep:function(e){this.score=e.score,b8e.evt.dptG(game.ZhanyaoEvents.UPDATE_ZHANYAO_AWARD)},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.ZHANYAO_ALERT,null,this.ZhanyaoAlert,this)},ZhanyaoAlert:function(){if(game.funcOpen.checkOpen(game.FunctionType.ZHANYAO)){var e=game.ccfg.ZhanYaoAwardCfg.getAwardScoreList();if(!e||e.length<=0)return!1;if(!this.awardScoreList||this.awardScoreList.length<0)return!1;for(var t=0;t<e.length;t++){var i=e[t];if(-1==this.awardScoreList.indexOf(i)&&i<=this.score)return!0}var n=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);if(!n)return!1;this.zhanyaoMaxScore<=0&&(this.zhanyaoMaxScore=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_ZHANYAO_SCORE));var s=n.conditionParam2;if(this.totalProgress>=s&&this.score<this.zhanyaoMaxScore)return!0}return!1}}),game.ZhanyaoMgr._instance=null,game.ZhanyaoMgr._singleton=!0,game.ZhanyaoMgr.inst=function(){return null==game.ZhanyaoMgr._instance&&(game.ZhanyaoMgr._singleton=!1,game.ZhanyaoMgr._instance=new game.ZhanyaoMgr,game.ZhanyaoMgr._singleton=!0),game.ZhanyaoMgr._instance}},{}],1051:[function(e,t,i){"use strict";e("./ZhanyaoMgr")},{"./ZhanyaoMgr":1050}],1052:[function(e,t,i){"use strict";game.appModule.ZhanyaoGotoPanel=game.SkinUIPanel.extends({ctor:function(e){this._super(e)},onShow:function(){b8e.evt.onC(this._skin.btn_goto,this.clickGoTo,this)},onHide:function(){b8e.evt.offC(this._skin.btn_goto,this.clickGoTo,this)},clickGoTo:function(){game.TriggerMgr.inst().triggerById(3139),this.hide()}})},{}],1053:[function(e,t,i){"use strict";game.appModule.ZhanyaoPanel=game.SkinUIPanel.extends({_activeItemVec:null,curQuestId:0,_prizeList:null,_prizeInfo:null,ctor:function(e){this._super(e),this._activeItemVec=[]},onShow:function(){this.updateInfo(),this.setQuickCompleteCost(),b8e.evt.onC(this._skin.btn_get,this.clickGetPrize,this),b8e.evt.onC(this._skin.btn_goto,this.clickGoTo,this),b8e.evt.onC(this._skin.quick_complete_btn,this.clickQuickComplete,this),b8e.evt.addG(this,game.ZhanyaoEvents.UPDATE_ZHANYAO_QUEST,this.updateInfo),b8e.evt.addG(this,game.ZhanyaoEvents.UPDATE_ZHANYAO_AWARD,this.updateInfo),b8e.evt.addG(this,game.PayEvents.RECHARGE_SUCCESS,this.setQuickCompleteCost)},onHide:function(){this.clearGrid(),b8e.evt.offC(this._skin.btn_get,this.clickGetPrize,this),b8e.evt.offC(this._skin.btn_goto,this.clickGoTo,this),b8e.evt.offC(this._skin.quick_complete_btn,this.clickQuickComplete,this),b8e.evt.rmvG(this,game.ZhanyaoEvents.UPDATE_ZHANYAO_QUEST,this.updateInfo),b8e.evt.rmvG(this,game.ZhanyaoEvents.UPDATE_ZHANYAO_AWARD,this.updateInfo),b8e.evt.rmvG(this,game.PayEvents.RECHARGE_SUCCESS,this.setQuickCompleteCost)},init:function(){this._skin.lab_desc.string=game.ccfg.LangCfg.getText(1034),this._prizeInfo||(this._prizeInfo=new game.PrizeInfo),this._prizeList||(this._prizeList=new game.PrizeList(2,game.IcoSizeEnum.SIZE_80,game.IcoSizeEnum.SIZE_80,game.IconScale.PERCENT_80,2),this._prizeList.addToParent(this._skin.prize_node))},updateInfo:function(){this.updateQuestInfo(),this.updateActiveAwards()},setQuickCompleteCost:function(){var e=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.QUEST_ZHANYAO_COMPLETE);if(e){var t=e.split("|"),i=game.ccfg.ItemInfoCfg.getItemInfoById(t[0]);if(i){switch(i.type){case game.AmountType.SILVER:this._skin.img_yuanbao.active=!1,this._skin.img_silver.active=!0;break;case game.AmountType.YUAN_BAO:this._skin.img_yuanbao.active=!0,this._skin.img_silver.active=!1}var n=game.upgrade.costCheckMoney(i.type,t[1],!1,!1);this._skin.lab_cost_num.string=n?game.html.getText(game.html.Q_GREEN,t[1]):game.html.getText(game.html.Q_RED,t[1])}}},updateQuestInfo:function(){this.curQuestId=game.zhanyao.curQuestId;var e=game.ccfg.ZhanYaoCfg.getDataById(this.curQuestId);if(!e)return this._skin.lab_quest.node.active=!1,void(this._skin.quest_node.active=!1);this._skin.lab_quest.node.active=!0;var t=e.conditionParam2,i=game.zhanyao.totalProgress,n=i+"/"+t;this._skin.lab_quest.string=e.desc+game.html.getText(game.html.Q_GREEN,n),i<t?(this._skin.btn_goto.active=!0,this._skin.btn_get.active=!1,this._skin.quick_complete.active=!0):(this._skin.btn_goto.active=!1,this._skin.btn_get.active=!0,this._skin.quick_complete.active=!1),this._prizeInfo.setupById(e.dropId),this._prizeList.setData(this._prizeInfo)},updateActiveAwards:function(){var e=game.zhanyao.score,t=game.ccfg.GlobalParamCfg.getNumber(game.GlobalEnum.MAX_ZHANYAO_SCORE),i=e+"/"+t;this._skin.lab_complete_quest_count.string="今日已完成斩妖任务:"+game.html.getText(game.html.Q_GREEN,i);var n=game.zhanyao.score/t*this._skin.progressBarNode.width;this._skin.maskNode.width=n,t<=e?(this._skin.quest_node.active=!1,this._skin.complete_quest_node.active=!0):(this._skin.quest_node.active=!0,this._skin.complete_quest_node.active=!1),this.updateGridInfo()},updateGridInfo:function(){var e=this._activeItemVec.length,t=game.ccfg.ZhanYaoAwardCfg.getAwardScoreList();if(t&&!(t.length<=0))for(var i,n,s=0;s<t.length;s++){var a=t[s];if(a){var o=game.ccfg.ZhanYaoAwardCfg.getAwardByScore(a);if(!o||o.length<=0)continue;if(!(n=game.ccfg.ItemInfoCfg.getItemInfoById(o[0].Id)))continue;var r=this._skin["grid_"+s];s<e?i=this._activeItemVec[s]:(i=game.GridUtil.creatItemGrid(this,r,null,game.ContainerId.GUILD_ACTIVE_CONTAINER_ID,this.onClick),this._activeItemVec.push(i)),game.GridUtil.setItemGrid(i,n),this.updateActiveGrids(i,a),i.faceInfo=a,i.setNum(o[0].Num),i.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),i.sortLayer()}}},updateActiveGrids:function(e,t){var i;game.zhanyao.getAwardIsCanGet(t)?(i=game.html.Q_GREEN,e.setEffect("10009",game.AnimatorType.GUILD_SCORE_EFFECT,.8,.8)):(i=game.html.Q_WHITE,e.clearEffect()),game.zhanyao.getAwardIsGet(t)?(i=game.html.Q_GREEN,e.setIsReceive(!0),e.clearEffect()):e.setIsReceive(!1),e.setName(t,i),e.setLabNamePos(0,120),e.sortLayer()},onClick:function(e){e&&e.faceInfo&&(game.zhanyao.getAwardIsGet(e.faceInfo)?game.notice.show("当前奖励已领取"):game.zhanyao.sendZhanYaoScoreAwardCollect(e.faceInfo))},clickGetPrize:function(){game.zhanyao.sendZhanYaoComplete()},clickGoTo:function(){game.zhanyao.gotoZhanyao()},clickQuickComplete:function(){game.zhanyao.quickComplete()},clearGrid:function(){for(var e=0;e<this._activeItemVec.length;e++){var t=this._activeItemVec[e];t&&game.GridUtil.setItemGrid(t,null)}}})},{}],1054:[function(e,t,i){"use strict";e("./ZhanyaoPanel")},{"./ZhanyaoPanel":1053}],1055:[function(e,t,i){"use strict";var n=game.ZhanyaoSender=function(){};n.zhanYaoQuestInfoRequest=function(){var e=game.pbmid.Instance.ZhanYaoQuestInfoRequest;b8e.sendN(e)},n.zhanYaoCompleteRequest=function(){var e=game.pbmid.Instance.ZhanYaoCompleteRequest;b8e.sendN(e)},n.zhanYaoScoreAwardCollectRequest=function(e){var t=game.pbmsg.ZhanYaoScoreAwardCollectRequest;t.score=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.ZhanYaoScoreAwardCollectRequest;b8e.sendN(i)},n.zhanYaoQuickCompleteRequest=function(e){var t=game.pbmsg.ZhanYaoQuickCompleteRequest;t.completeAll=!!e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Instance.ZhanYaoQuickCompleteRequest;b8e.sendN(i)}},{}],1056:[function(e,t,i){"use strict";e("./ZhanyaoSender")},{"./ZhanyaoSender":1055}],1057:[function(e,t,i){"use strict";e("./cmdlistener/zhanyaoCmdlistenerIndex"),e("./event/zhanyaoEventIndex"),e("./manager/zhanyaoMgrIndex"),e("./panel/ZhanyaoPanelIndex"),e("./sender/zhanyaoSenderIndex")},{"./cmdlistener/zhanyaoCmdlistenerIndex":1047,"./event/zhanyaoEventIndex":1049,"./manager/zhanyaoMgrIndex":1051,"./panel/ZhanyaoPanelIndex":1054,"./sender/zhanyaoSenderIndex":1056}],1058:[function(e,t,i){"use strict";game.initApp=function(){var e={BACK_PANEL:game.AppInfo.create("BackPanel","back/BackSkin","BackSkin","back/BackSkin_BanShu","BackSkin",game.AppPosType.MIDDLE_CENTRAL),REWARDS_PANEL:game.AppInfo.create("RewardsPanel","back/RewardsSkin","RewardsSkin","","BackSkin",game.AppPosType.MIDDLE_CENTRAL),BACK_SMELT_PANEL:game.AppInfo.create("BackSmeltPanel","back/BackSmeltSkin","BackSmeltSkin","","BackSmeltSkin",game.AppPosType.MIDDLE_CENTRAL),ROLE_PANEL:game.AppInfo.create("RolePanel","role/RoleSkin","RoleSkin","role/RoleSkin_BanShu","RoleSkin",game.AppPosType.MIDDLE_CENTRAL),ROLE_ATTRIBUTE_PANEL:game.AppInfo.create("RoleAttributePanel","role/RoleAttributeSkin","RoleAttributeSkin","","RoleAttributeSkin",game.AppPosType.MIDDLE_CENTRAL),ACCESSORY_PANEL:game.AppInfo.create("AccessoryPanel","accessory/AccessorySkin","AccessorySkin","","AccessorySkin",game.AppPosType.MIDDLE_CENTRAL),WING_PANEL:game.AppInfo.create("WingPanel","wing/WingSkin","WingSkin","","WingSkin",game.AppPosType.MIDDLE_CENTRAL),RELATION_PANEL:game.AppInfo.create("RelationPanel","relation/RelationSkin","RelationPanelSkin","","RelationPanelSkin",game.AppPosType.MIDDLE_CENTRAL),MAIL_DETAILS_PANEL:game.AppInfo.create("MailDetailsPanel","mail/MailDetailsSkin","MailDetailsSkin","","MailDetailsSkin",game.AppPosType.MIDDLE_CENTRAL),WORLD_MAP_PANEL:game.AppInfo.create("WorldMapPanel","map/WorldMapSkin","WorldMapSkin","","WorldMapSkin",game.AppPosType.MIDDLE_CENTRAL),MAP_PANEL:game.AppInfo.create("MapPanel","map/MapSkin","MapSkin","","MapSkin",game.AppPosType.MIDDLE_CENTRAL),ITEM_TIPS:game.AppInfo.create("ItemTips","tips/ItemTipsSkin","ItemTipsSkin","","ItemTipsSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_TIPS:game.AppInfo.create("EquipTips","tips/EquipTipsSkin","EquipTipsSkin","","EquipTipsSkin",game.AppPosType.MIDDLE_CENTRAL),ROLE_EQUIP_TIPS:game.AppInfo.create("RoleEquipTips","tips/RoleEquipTipsSkin","RoleEquipTipsSkin","","RoleEquipTipsSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_BASE_TIPS:game.AppInfo.create("EquipBaseTips","tips/EquipBaseTipsSkin","EquipBaseTipsSkin","","EquipBaseTipsSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_SELECT_PANEL:game.AppInfo.create("EquipSelectPanel","equip/EquipSelectSkin","EquipSelectSkin","","EquipSelectSkin",game.AppPosType.MIDDLE_CENTRAL),HIGHEQUIP_PANEL:game.AppInfo.create("HighEquipPanel","equip/HighEquipSkin","HighEquipSkin","","HighEquipSkin",game.AppPosType.MIDDLE_CENTRAL),RESOLVE_HIGHEQUIP_PANEL:game.AppInfo.create("ResolveHighEquipPanel","equip/ResolveHighEquipSkin","ResolveHighEquipSkin","","ResolveHighEquipSkin",game.AppPosType.MIDDLE_CENTRAL),DUNGEON_RESULT_PANEL:game.AppInfo.create("DungeonResultPanel","dungeon/DungeonResultSkin","DungeonResultSkin","","DungeonResultSkin",game.AppPosType.MIDDLE_CENTRAL),RELIVE_PANEL:game.AppInfo.create("RelivePanel","relive/ReliveSkin","ReliveSkin","","ReliveSkin",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_SELECT_PANEL:game.AppInfo.create("BianshenSelectPanel","bianshen/BianshenSelectSkin","BianshenSelectSkin","","BianshenSelectSkin",game.AppPosType.MIDDLE_CENTRAL),DUNGEON_PANEL:game.AppInfo.create("DungeonPanel","dungeon/DungeonSkin","DungeonSkin","","DungeonSkin",game.AppPosType.MIDDLE_CENTRAL),SCENE_DES_PANEL:game.AppInfo.create("SceneDesPanel","sceneDes/SceneDesSkin","SceneDesSkin","","SceneDesSkin",game.AppPosType.MIDDLE_CENTRAL,0,200),TEST_PANEL:game.AppInfo.create("TestPanel","test/TestSkin","TestSkin","","TestSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_FORGE_PANEL:game.AppInfo.create("EquipForgePanel","equip/EquipForgeSkin","EquipForgeSkin","","EquipForgeSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_UP_STAR_SELECT_PANEL:game.AppInfo.create("EquipUpStarSelectPanel","equip/EquipUpStarSelectSkin","EquipUpStarSelectSkin","","EquipUpStarSelectSkin",game.AppPosType.MIDDLE_CENTRAL),GM_PANEL:game.AppInfo.create("GMPanel","gm/GMSkin","GMSkin","","GMSkin",game.AppPosType.MIDDLE_CENTRAL),GM_DESC_PANEL:game.AppInfo.create("GMDescPanel","gm/GMDescSkin","GMDescSkin","","GMDescSkin",game.AppPosType.MIDDLE_CENTRAL),BEAUTY_PANEL:game.AppInfo.create("BeautyPanel","beauty/BeautySkin","BeautySkin","","BeautySkin",game.AppPosType.MIDDLE_CENTRAL),BEAUTY_PRIZE_PANEL:game.AppInfo.create("BeautyPrizePanel","beauty/BeautyPrizeSkin","BeautyPrizeSkin","","BeautyPrizeSkin",game.AppPosType.MIDDLE_CENTRAL),SPRITE_STAT_PANEL:game.AppInfo.create("SpriteStatPanel","beauty/BeautyAttrSkin","BeautyAttrSkin","","BeautyAttrSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_SUITS_TIPS:game.AppInfo.create("EquipSuitsTips","tips/EquipSuitsTipsSkin","EquipSuitsTipsSkin","","EquipSuitsTipsSkin",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_DETAILS_PANEL:game.AppInfo.create("BianshenDetailsPagePanel","bianshen/BianshenDetailsPageSkin","BianshenDetailsPageSkin","","BianshenDetailsPageSkin",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_MATERIAL_PANEL:game.AppInfo.create("BianshenSelectBackPanel","bianshen/BianshenSelectBackSkin","BianshenSelectBackSkin","","BianshenSelectBackSkin",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_AUTO_SELECT_PANEL:game.AppInfo.create("BianshenAutoSelectPanel","bianshen/BianshenAutoSelectSkin","BianshenAutoSelectSkin","","BianshenAutoSelectSkin",game.AppPosType.MIDDLE_CENTRAL),EQUIP_REFINE_PANEL:game.AppInfo.create("EquipRefinePanel","equip/EquipRefineSkin","EquipRefineSkin","","EquipRefineSkin",game.AppPosType.MIDDLE_CENTRAL),FUNCTION_PREPARE_PANEL:game.AppInfo.create("FunctionPreparePanel","funcs/FunctionPrepareSkin","FunctionPrepareSkin","","FunctionPrepareSkin",game.AppPosType.BOTTOM_RIGHT,0,710),FUNCTION_OPEN_PANEL:game.AppInfo.create("FunctionOpenPanel","funcs/FunctionOpenSkin","FunctionOpenSkin","","FunctionOpenSkin",game.AppPosType.MIDDLE_CENTRAL),FUNCTION_PREVIEW_PANEL:game.AppInfo.create("FunctionPreviewPanel","funcs/FunctionPreviewSkin","FunctionPreviewSkin","","FunctionPreviewSkin",game.AppPosType.MIDDLE_CENTRAL),DRESS_EQUIP_PANEL:game.AppInfo.create("DressEquipPanel","guide/DressEquipSkin","DressEquipSkin","","DressEquipSkin",game.AppPosType.BOTTOM_RIGHT,-120,220),DIALOG_PANEL:game.AppInfo.create("DialogPanel","dialog/DialogSkin","DialogSkin","","DialogSkin",game.AppPosType.BOTTOM_CENTRAL,0,300),DRAW_PANEL:game.AppInfo.create("DrawPanel","draw/DrawSkin","DrawSkin","","DrawSkin",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_PREVIEW_PANEL:game.AppInfo.create("BianshenPreviewPanel","draw/BianshenPreviewSkin","BianshenPreviewSkin","","BianshenPreviewSkin",game.AppPosType.MIDDLE_CENTRAL),HIGH_STAR_PANEL:game.AppInfo.create("HighStarPanel","draw/HighStarSkin","HighStarSkin","","HighStarSkin",game.AppPosType.MIDDLE_CENTRAL),DRAW_ONCE_PANEL:game.AppInfo.create("DrawOncePanel","draw/DrawOnceSkin","DrawOnceSkin","","DrawOnceSkin",game.AppPosType.MIDDLE_CENTRAL),DRAW_QUINTIC_PANEL:game.AppInfo.create("DrawQuinticPanel","draw/DrawQuinticSkin","DrawQuinticSkin","","DrawQuinticSkin",game.AppPosType.MIDDLE_CENTRAL),DRAW_REWARD_PANEL:game.AppInfo.create("DrawRewardPanel","draw/DrawRewardSkin","DrawRewardSkin","","DrawRewardSkin",game.AppPosType.MIDDLE_CENTRAL),CHAT_PANEL:game.AppInfo.create("ChatPanel","chat/ChatSkin","ChatSkin","","ChatSkin",game.AppPosType.MIDDLE_CENTRAL),WELFARE_PANEL:game.AppInfo.create("WelfarePanel","welfare/WelfareSkin","WelfareSkin","","WelfareSkin",game.AppPosType.MIDDLE_CENTRAL),RANK_PANEL:game.AppInfo.create("RankPanel","rank/RankSkin","RankSkin","","RankSkin",game.AppPosType.MIDDLE_CENTRAL),OFFLINE_AWARD_PANEL:game.AppInfo.create("OfflineAwardPanel","offlineAward/OfflineAwardSkin","OfflineAwardSkin","","OfflineAwardSkin",game.AppPosType.MIDDLE_CENTRAL),SHOP_PANEL:game.AppInfo.create("ShopPanel","shop/ShopSkin","ShopSkin","shop/ShopSkin_BanShu","ShopSkin",game.AppPosType.MIDDLE_CENTRAL),SHOP_BUY_PANEL:game.AppInfo.create("ShopBuyPanel","shop/ShopBuySkin","ShopBuySkin","","ShopBuySkin",game.AppPosType.MIDDLE_CENTRAL),DUNGEON_BUY_PANEL:game.AppInfo.create("DungeonFightCountBuyPanel","dungeon/DungeonFightCountBuySkin","DungeonFightCountBuySkin","","DungeonFightCountBuySkin",game.AppPosType.MIDDLE_CENTRAL),FIGHT_PANEL:game.AppInfo.create("FightPanel","arena/FightPanelSkin","FightPanelSkin","","FightPanelSkin",game.AppPosType.MIDDLE_CENTRAL),PRIZERULE_PANEL:game.AppInfo.create("PrizeRulePanel","arena/PrizeRulePanelSkin","PrizeRulePanelSkin","","PrizeRulePanelSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_LOG_PANEL:game.AppInfo.create("ArenaLogPanel","arena/ArenaLogPanelSkin","ArenaLogPanelSkin","","ArenaLogPanelSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_BUY_TIMES_PANEL:game.AppInfo.create("ArenaBuyTimesPanel","arena/ArenaBuyTimesPanelSkin","ArenaBuyTimesPanelSkin","","ArenaBuyTimesPanelSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_RANK_PANEL:game.AppInfo.create("ArenaRankPanel","arena/ArenaRankPanelSkin","ArenaRankPanelSkin","","ArenaRankPanelSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_COMBATDATA_PANEL:game.AppInfo.create("ArenaCombatDataPanel","arena/ArenaCombatDataPanelSkin","ArenaCombatDataPanelSkin","","ArenaCombatDataPanelSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_RESULT_PANEL:game.AppInfo.create("ArenaResultPanel","arena/ArenaResultSkin","ArenaResultSkin","","ArenaResultSkin",game.AppPosType.MIDDLE_CENTRAL),ARENA_FIGHT_PANEL:game.AppInfo.create("ArenaFightPanel","arena/ArenaFightPanelSkin","ArenaFightPanelSkin","","ArenaFightPanelSkin",game.AppPosType.TOP_CENTRAL),ARENA_RECORDHIGH_PANEL:game.AppInfo.create("ArenaRecordHighPanel","arena/ArenaRecordHighPanelSkin","ArenaRecordHighPanelSkin","","ArenaRecordHighPanelSkin",game.AppPosType.MIDDLE_CENTRAL),OTHERSROLE_PANEL:game.AppInfo.create("OthersRolePanel","othersrole/OthersRoleSkin","OthersRoleSkin","","OthersRoleSkin",game.AppPosType.MIDDLE_CENTRAL),OTHERSROLE_ATTIBUTE_PANEL:game.AppInfo.create("OthersRoleAttibutePanel","othersrole/OthersRoleAttributeSkin","OthersRoleAttributeSkin","","OthersRoleAttributeSkin",game.AppPosType.MIDDLE_CENTRAL),OTHERS_ACCESSORY_PANEL:game.AppInfo.create("OthersAccessoryPanel","othersrole/OthersAccessorySkin","OthersAccessorySkin","","OthersAccessorySkin",game.AppPosType.MIDDLE_CENTRAL),OTHERSROLE_EQUIP_TIPS:game.AppInfo.create("OtherRoleEquipTips","tips/OtherRoleEquipTipsSkin","OtherRoleEquipTipsSkin","","OtherRoleEquipTipsSkin",game.AppPosType.MIDDLE_CENTRAL),OTHEREQUIP_SUITS_TIPS:game.AppInfo.create("OthersEquipSuitsTips","othersrole/OthersEquipSuitsTipsSkin","OthersEquipSuitsTipsSkin","","OthersEquipSuitsTipsSkin",game.AppPosType.MIDDLE_CENTRAL),STRENGTHEN_PANEL:game.AppInfo.create("StrengthenPanel","strengthen/StrengthenSkin","StrengthenSkin","","StrengthenSkin",game.AppPosType.MIDDLE_CENTRAL),DEMO_PANEL:game.AppInfo.create("DemoPanel","demo/DemoSkin","DemoSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_PANEL:game.AppInfo.create("GuildPanel","guild/GuildSkin","GuildSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_ADMINISTER_PANEL:game.AppInfo.create("GuildAdministerPanel","guild/GuildAdministerSkin","GuildAdministerSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_CREATE_TIP:game.AppInfo.create("GuildCreateTip","guild/GuildCreateTipSkin","GuildCreateTipSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_EDIT_NOTICE_PANEL:game.AppInfo.create("GuildEditNoticePanel","guild/GuildEditNoticeSkin","GuildEditNoticeSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_SETTING_PANEL:game.AppInfo.create("GuildSettingPanel","guild/GuildSettingSkin","GuildSettingSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_STATE_DESC_PANEL:game.AppInfo.create("GuildStateDescPanel","guild/GuildStateDescSkin","GuildStateDescSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_ACTIVE_PANEL:game.AppInfo.create("GuildActivePanel","guild/GuildActiveSkin","GuildActiveSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_LEVEL_TIPS:game.AppInfo.create("GuildLevelTips","guild/GuildLevelTipsSkin","GuildLevelTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_BATTLE_LIST_PANEL:game.AppInfo.create("BianshenBattleListPanel","bianshen/BianshenBattleListSkin","BianshenBattleListSkin","","",game.AppPosType.MIDDLE_CENTRAL),TALK_PANEL:game.AppInfo.create("TalkPanel","relation/TalkPanelSkin","TalkPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),ADD_FRIEND_PANEL:game.AppInfo.create("AddFriendPanel","relation/AddFriendPanelSkin","AddFriendPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),INSPIRE_PANEL:game.AppInfo.create("InspirePanel","worldBoss/InspireSkin","InspireSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_BOSS_DAMAGE_RANK_CHECK_PANEL:game.AppInfo.create("WorldBossDamageRankCheckPanel","worldBoss/WorldBossDamageRankCheckSkin","WorldBossDamageRankCheckSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_BOSS_DROP_PREVIEW_PANEL:game.AppInfo.create("WorldBossDropPreviewPanel","worldBoss/WorldBossDropPreviewSkin","WorldBossDropPreviewSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_BOSS_ENTER_SHOW_PANEL:game.AppInfo.create("WorldBossEnterShowPanel","worldBoss/WorldBossEnterShowSkin","WorldBossEnterShowSkin","","",game.AppPosType.BOTTOM_CENTRAL,120,220),WORLD_BOSS_RESULT_PANEL:game.AppInfo.create("WorldBossResultPanel","worldBoss/WorldBossResultSkin","WorldBossResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),GOTO_PANEL:game.AppInfo.create("GotoPanel","goto/GotoSkin","GotoSkin","","",game.AppPosType.MIDDLE_CENTRAL),PAY_PANEL:game.AppInfo.create("PayPanel","pay/PaySkin","PaySkin","","",game.AppPosType.MIDDLE_CENTRAL),LOGIN_PRIZE_PANEL:game.AppInfo.create("LoginPrizePanel","active/LoginPrizeSkin","LoginPrizeSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURA_RULE_PANEL:game.AppInfo.create("SuraRulePanel","sura/SurarulePanelSkin","SurarulePanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURA_PRIZE_PANEL:game.AppInfo.create("SuraFightPanel","sura/SuraFightPanelSkin","SuraFightPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURA_LEAVE_PANEL:game.AppInfo.create("LeaveSuraScenePanel","sura/LeaveSuraSceneSkin","LeaveSuraSceneSkin","","LeaveSuraSceneSkin",game.AppPosType.TOP_LEFT,90,-220),SURA_SCORE_PANEL:game.AppInfo.create("SuraScorePanel","sura/SuraScorePanelSkin","SuraScorePanelSkin","","SuraScorePanelSkin",game.AppPosType.TOP_RIGHT,-120,-220),SURA_ENTRANCE_PANEL:game.AppInfo.create("SuraEntrancePanel","sura/SuraEntrancePanelSkin","SuraEntrancePanelSkin","","SuraEntrancePanelSkin",game.AppPosType.BOTTOM_CENTRAL,120,220),SURA_RELIVE_PANEL:game.AppInfo.create("SuraRelive","sura/SuraReliveSkin","SuraReliveSkin","","SuraReliveSkin",game.AppPosType.MIDDLE_CENTRAL),SURA_BUFF_PANEL:game.AppInfo.create("SuraBuffPanel","sura/SuraBuffPanelSkin","SuraBuffPanelSkin","","SuraBuffPanelSkin",game.AppPosType.MIDDLE_RIGHT,70,-50),SURA_BUFFTIPS_PANEL:game.AppInfo.create("SuraBuffTipsPanel","sura/SuraBuffTipsPanelSkin","SuraBuffTipsPanelSkin","","SuraBuffTipsPanelSkin",game.AppPosType.MIDDLE_CENTRAL),SURA_RESULT_PANEL:game.AppInfo.create("SuraResultPanel","sura/SuraResultSkin","SuraResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_SERVER_PANEL:game.AppInfo.create("ActiveServerPanel","active/ActiveServerSkin","ActiveServerSkin","","",game.AppPosType.MIDDLE_CENTRAL,0,-20),RECHARGE_ACTIVE_PANEL:game.AppInfo.create("RechargeActivesPanel","active/RechargeActivesSkin","RechargeActivesSkin","","",game.AppPosType.MIDDLE_CENTRAL),CLIENT_SETTING_PANEL:game.AppInfo.create("ClientSettingPanel","setting/ClientSettingSkin","ClientSettingSkin","","",game.AppPosType.MIDDLE_CENTRAL),SKILL_DESC_PANEL:game.AppInfo.create("SkillDescPanel","skill/SkillDescSkin","SkillDescSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACCESSORY_UPGRADE_PANEL:game.AppInfo.create("AccessoryUpgradePanel","accessory/AccessoryUpgradeSkin","AccessoryUpgradeSkin","","",game.AppPosType.MIDDLE_CENTRAL),FIRST_RECHARGE_PANEL:game.AppInfo.create("FirstRechargePanel","firstRecharge/FirstRechargeSkin","FirstRechargeSkin","","",game.AppPosType.MIDDLE_CENTRAL),CARD_RECHARGE_PANEL:game.AppInfo.create("CardRechargePanel","cardRecharge/CardRechargeSkin","CardRechargeSkin","","",game.AppPosType.MIDDLE_CENTRAL),DUJIE_SUCCEED_PANEL:game.AppInfo.create("DujieSucceedPanel","dujie/DujieSucceedSkin","DujieSucceedSkin","","",game.AppPosType.MIDDLE_CENTRAL),CORNUCOPIA_LOG_PANEL:game.AppInfo.create("CornucopiaLogPanel","cornucopia/CornucopiaLogSkin","CornucopiaLogSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURFACE_PANEL:game.AppInfo.create("SurfacePanel","surface/SurfaceSkin","SurfaceSkin","","",game.AppPosType.MIDDLE_CENTRAL),SHARE_PANEL:game.AppInfo.create("SharePanel","micro/SharePanelSkin","SharePanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),MICRO_PANEL:game.AppInfo.create("MicroPanel","micro/MicroPanelSkin","MicroPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),WANBA_PRIZE_PANEL:game.AppInfo.create("WanbaPrizePanel","wanba/WanbaPrizeSkin","WanbaPrizeSkin","","",game.AppPosType.MIDDLE_CENTRAL),ADD_SHORTCUT_PANEL:game.AppInfo.create("AddShortcutPanel","wanba/AddShortcutSkin","AddShortcutSkin","","",game.AppPosType.MIDDLE_CENTRAL),FOCUS_PANEL:game.AppInfo.create("FocusPanel","wanba/FocusSkin","FocusSkin","","",game.AppPosType.MIDDLE_CENTRAL),REAL_VERIFY_PANEL:game.AppInfo.create("RealVerifyPanel","aiweiyou/RealVerifySkin","RealVerifySkin","","",game.AppPosType.MIDDLE_CENTRAL),NATIONAL_BOSS_KILL_PANEL:game.AppInfo.create("NationalBossKillPanel","nationalBoss/NationalBossKillSkin","NationalBossKillSkin","","",game.AppPosType.MIDDLE_CENTRAL),NATIONAL_BOSS_RESULT_PANEL:game.AppInfo.create("NationalBossResultPanel","nationalBoss/NationalBossResultSkin","NationalBossResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),CALL_PANEL:game.AppInfo.create("CallPanel","nationalBoss/CallSkin","CallSkin","","",game.AppPosType.MIDDLE_CENTRAL),TRANSFER_NOTICE_PANEL:game.AppInfo.create("TransferNoticePanel","transferNotice/TransferNoticeSkin","TransferNoticeSkin","","",game.AppPosType.MIDDLE_CENTRAL),XIANDAN_PANEL:game.AppInfo.create("XiandanPanel","xiandan/XiandanSkin","XiandanSkin","","",game.AppPosType.MIDDLE_CENTRAL),XIANDAN_DETAILS_PANEL:game.AppInfo.create("XiandanDetailsPanel","xiandan/XiandanDetailsSkin","XiandanDetailsSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACHIEVEMENT_PANEL:game.AppInfo.create("AchievementPanel","achievement/AchievementSkin","AchievementSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACHIEVEMENT_AWARD_PANEL:game.AppInfo.create("AchievementSpriteStat","achievement/AchievementSpriteStatSkin","AchievementSpriteStatSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACHIEVEMENT_PRIZE_PANEL:game.AppInfo.create("AchievementPrizePanel","achievement/AchievementPrizeSkin","AchievementPrizeSkin","","",game.AppPosType.MIDDLE_CENTRAL),EQUIP_REFINE_ALERT:game.AppInfo.create("EquipRefineAlert","equip/EquipRefineAlertSkin","EquipRefineAlertSkin","","",game.AppPosType.MIDDLE_CENTRAL),REBIRTH_PANEL:game.AppInfo.create("RebirthPanel","rebirth/RebirthSkin","RebirthSkin","","",game.AppPosType.MIDDLE_CENTRAL),REBIRTH_BUY_PANEL:game.AppInfo.create("RebirthBuyPanel","rebirth/RebirthBuySkin","RebirthBuySkin","","",game.AppPosType.MIDDLE_CENTRAL),BUBBLE_EXP_ALERT:game.AppInfo.create("BubbleExpAlert","notice/BubbleExpSkin","BubbleExpSkin","","",game.AppPosType.BOTTOM_CENTRAL,120,220),SANZANG_JIANGJIN_PANEL:game.AppInfo.create("SanzangJiangjinHintPanel","sanzangjiangjinSkin/SanzangJiangjinHintPanelSkin","SanzangJiangjinHintPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL,0,-180),BEAUTY_BUY_POWER_PANEL:game.AppInfo.create("BeautyBuyPowerPanel","beauty/BeautyBuyPowerSkin","BeautyBuyPowerSkin","","",game.AppPosType.MIDDLE_CENTRAL),FESTIVAL_LOGIN_PANEL:game.AppInfo.create("FestivalLoginPanel","active/FestivalLoginSkin","FestivalLoginSkin","","",game.AppPosType.MIDDLE_CENTRAL,0,-20),RED_PACKET_PANEL:game.AppInfo.create("RedPacketPanel","redPacket/RedPacketSkin","RedPacketSkin","","",game.AppPosType.TOP_DOWN_FIXED),RED_PACKET_DETAIL_PANEL:game.AppInfo.create("RedPacketDetailPanel","redPacket/RedPacketDetailSkin","RedPacketDetailSkin","","",game.AppPosType.MIDDLE_CENTRAL),ZHANYAO_GOTO_PANEL:game.AppInfo.create("ZhanyaoGotoPanel","zhanyao/ZhanyaoGotoSkin","ZhanyaoGotoSkin","","",game.AppPosType.MIDDLE_CENTRAL),ROULETTE_TIPS_PANEL:game.AppInfo.create("RouletteTipsPanel","roulette/RouletteTipsSkin","RouletteTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),ROULETTE_SMALL_TIPS_PANEL:game.AppInfo.create("RouletteSmallTipsPanel","roulette/RouletteSmallTipsSkin","RouletteSmallTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),BAOZHU_DESC_PANEL:game.AppInfo.create("BaozhuDescPanel","roulette/BaozhuDescSkin","BaozhuDescSkin","","",game.AppPosType.MIDDLE_CENTRAL),AUTOEQUIP_PANEL:game.AppInfo.create("AutoEquipPanel","autoequip/AutoEquipSkin","AutoEquipSkin","","",game.AppPosType.BOTTOM_RIGHT,-120,220),TIANGONG_RULE_DESC_PANEL:game.AppInfo.create("TianGongRuleDescPanel","tiangong/TianGongRuleDescSkin","TianGongRuleDescSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_PANEL:game.AppInfo.create("TianGongPanel","tiangong/TianGongSkin","TianGongSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_EDITOR_PANEL:game.AppInfo.create("TianGongEditorPanel","tiangong/TianGongEditorSkin","TianGongEditorSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_LAST_RANK_PANEL:game.AppInfo.create("TianGongLastRankPanel","tiangong/TianGongLastRankSkin","TianGongLastRankSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_WORSHIP_PANEL:game.AppInfo.create("TianGongWorshipPanel","tiangong/TianGongWorshipSkin","TianGongWorshipSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_SAN_JIE_AWARDS_PANEL:game.AppInfo.create("TianGongSanJieAwardsPanel","tiangong/TianGongSanJieAwardsSkin","TianGongSanJieAwardsSkin","","",game.AppPosType.MIDDLE_CENTRAL),TIAN_GONG_ENTER_ALERT:game.AppInfo.create("TianGongEnterAlert","tiangong/TianGongEnterAlertSkin","TianGongEnterAlertSkin","","",game.AppPosType.BOTTOM_CENTRAL,120,220),RESULT_PANEL:game.AppInfo.create("ResultPanel","tiangong/ResultSkin","ResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_TIP_PANEL:game.AppInfo.create("GuildTipPanel","guild/GuildTipSkin","GuildTipSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_SHAOXIANG_PANEL:game.AppInfo.create("GuildShaoXiangPanel","guild/GuildShaoXiangPanelSkin","GuildShaoXiangPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_XINFA_PANEL:game.AppInfo.create("GuildXinFaPanel","guild/GuildXinFaPanelSkin","GuildXinFaPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),AMULET_PANEL:game.AppInfo.create("AmuletPanel","amulet/AmuletPanelSkin","AmuletPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),WANFA_PANEL:game.AppInfo.create("WanfaPanel","wanfa/WanfaSkin","WanfaSkin","","",game.AppPosType.MIDDLE_CENTRAL),CHALLANGE_PANEL:game.AppInfo.create("ChallangePanel","challange/ChallangeSkin","ChallangeSkin","","",game.AppPosType.MIDDLE_CENTRAL),CHALLANGE_DUNGEON_PANEL:game.AppInfo.create("ChallangeDungeonPanel","challange/ChallangeDungeonSkin","ChallangeDungeonSkin","","ChallangeDungeonSkin",game.AppPosType.MIDDLE_CENTRAL),WANFA_ARENA_PANEL:game.AppInfo.create("WanfaArenaPanel","wanfa/WanfaArenaSkin","WanfaArenaSkin","","",game.AppPosType.MIDDLE_CENTRAL),WANBAGAME_VIPPANEL:game.AppInfo.create("WanBaGameVipPanel","wanbagamevip/WanBaGameVipSkin","WanBaGameVipSkin","","",game.AppPosType.MIDDLE_CENTRAL),MILLIONAWARD_PANEL:game.AppInfo.create("MillionAwardPanel","welfare/MillionAwardSkin","MillionAwardSkin","","",game.AppPosType.MIDDLE_CENTRAL),MILLIONAWARDTIPS_PANEL:game.AppInfo.create("MillionAwardTipsPanel","welfare/MillionAwardTipsSkin","MillionAwardTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),SCENE_PRIZE_DES_PANEL:game.AppInfo.create("ScenePrizeDesPanel","sceneDes/ScenePrizeDesSkin","ScenePrizeDesSkin","","",game.AppPosType.MIDDLE_CENTRAL),CHANGE_NAME_PANEL:game.AppInfo.create("ChangeNamePanel","setting/ChangeNameSkin","ChangeNameSkin","","",game.AppPosType.MIDDLE_CENTRAL),ANNOUNCEMENT_PANEL:game.AppInfo.create("AnnouncementPanel","announcement/AnnouncementSkin","AnnouncementSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_ROOM_PANEL:game.AppInfo.create("TeamRoomPanel","team/TeamRoomSkin","TeamRoomSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_TOKEN_PANEL:game.AppInfo.create("TeamTokenPanel","team/TeamTokenSkin","TeamTokenSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_INVITE_PANEL:game.AppInfo.create("TeamInvitePanel","team/TeamInviteSkin","TeamInviteSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_FRIEND_PANEL:game.AppInfo.create("TeamFriendPanel","team/TeamFriendSkin","TeamFriendSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_TIPS_PANEL:game.AppInfo.create("TeamTipsPanel","team/TeamTipsSkin","TeamTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),TEAM_RECRUIT_PANEL:game.AppInfo.create("TeamRecruitPanel","team/TeamRecruitSkin","TeamRecruitSkin","","",game.AppPosType.MIDDLE_CENTRAL),CSARENA_PANEL:game.AppInfo.create("CSArenaPanel","csArena/CSArenaSkin","CSArenaSkin","","",game.AppPosType.MIDDLE_CENTRAL),CSARENA_LOG_PANEL:game.AppInfo.create("CSArenaLogPanel","arena/ArenaLogPanelSkin","ArenaLogPanelSkin","","ArenaLogPanelSkin",game.AppPosType.MIDDLE_CENTRAL),RULE_PANEL:game.AppInfo.create("RulePanel","common/RuleSkin","RuleSkin","","",game.AppPosType.MIDDLE_CENTRAL),CSARENA_BUY_PANEL:game.AppInfo.create("CSArenaFightCountBuyPanel","csArena/CSArenaFightCountBuySkin","CSArenaFightCountBuySkin","","",game.AppPosType.MIDDLE_CENTRAL),AWARD_TIPS_PANEL:game.AppInfo.create("AwardTipsPanel","tips/AwardTipsSkin","AwardTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),CSARENA_RESULT_PANEL:game.AppInfo.create("CSArenaResultPanel","csArena/CSArenaResultSkin","CSArenaResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),TOWER_PANEL:game.AppInfo.create("TowerPanel","tower/TowerSkin","TowerSkin","","",game.AppPosType.MIDDLE_CENTRAL),TOWER_DAILY_AWARD_PANEL:game.AppInfo.create("TowerDailyAwardPanel","tower/TowerDailyAwardSkin","TowerDailyAwardSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_PANEL:game.AppInfo.create("RunePanel","rune/RuneSkin","RuneSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_RULE_PANEL:game.AppInfo.create("RuneRulePanel","rune/RuneRuleSkin","RuneRuleSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_SELECT_PANEL:game.AppInfo.create("RuneSelectPanel","rune/RuneSelectSkin","RuneSelectSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_TIPS_PANEL:game.AppInfo.create("RuneTipsPanel","rune/RuneTipsSkin","RuneTipsSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_INTENSITY_PANEL:game.AppInfo.create("RuneIntensifyPanel","rune/RuneIntensifySkin","RuneIntensifySkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_DECOMPOSE_PANEL:game.AppInfo.create("RuneDecomposePanel","rune/RuneDecomposeSkin","RuneDecomposeSkin","","",game.AppPosType.MIDDLE_CENTRAL),RUNE_SHOW_PANEL:game.AppInfo.create("RuneShowPanel","rune/RuneShowSkin","RuneShowSkin","","",game.AppPosType.MIDDLE_CENTRAL),VIP_SHOW_PANEL:game.AppInfo.create("VipShowPanel","vip/VipShowSkin","VipShowSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURA_RANK_PANEL:game.AppInfo.create("SuraRankPanel","sura/SuraRankPanelSkin","SuraRankPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),SURA_GUILDPRIZE_PANEL:game.AppInfo.create("SuraGuildPrizePanel","sura/SuraGuildPrizePanelSkin","SuraGuildPrizePanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),CS_SURA_PANEL:game.AppInfo.create("CsSuraPanel","sura/CsSuraPanelSkin","CsSuraPanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),FUNC_ACTIVATION_PANEL:game.AppInfo.create("FunctionActivationPanel","funcs/FunctionActivationSkin","FunctionActivationSkin","","",game.AppPosType.MIDDLE_CENTRAL),CROSS_ACTIVE_PANEL:game.AppInfo.create("CrossActivePanel","active/CrossActiveSkin","CrossActiveSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_INSPIRE:game.AppInfo.create("GuildInspire","guildBoss/GuildInspireSkin","GuildInspireSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILDBOSS_DROPPREVIEW:game.AppInfo.create("GuildBossDropPreview","guildBoss/GuildBossDropPreviewSkin","GuildBossDropPreviewSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILDBOSS:game.AppInfo.create("GuildBoss","guildBoss/GuildBossSkin","GuildBossSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILDBOSS_DAMAGERANKCHECK:game.AppInfo.create("GuildBossDamageRankCheck","guildBoss/GuildBossDamageRankCheckSkin","GuildBossDamageRankCheckSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_BOSS_ENTER_SHOW_PANEL:game.AppInfo.create("GuildBossEnterShowPanel","guildBoss/GuildBossEnterShowSkin","GuildBossEnterShowSkin","","",game.AppPosType.BOTTOM_CENTRAL,120,220),ACCESSORY_SKILL_PANEL:game.AppInfo.create("AccessorySkillPanel","accessory/AccessorySkillSkin","AccessorySkillSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACCESSORY_SKILL_CONVERT_PANEL:game.AppInfo.create("AccessorySkillConvertPanle","accessory/AccessorySkillConvertSkin","AccessorySkillConvertSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACCESSORY_SKILL_SELECT_PANEL:game.AppInfo.create("AccessorySkillSelectPanel","accessory/AccessorySkillSelectSkin","AccessorySkillSelectSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACCESSORY_STAT_SPRITE_PANEL:game.AppInfo.create("AccessoryStatSpritePanel","accessory/AccessoryStatSpriteSkin","AccessoryStatSpriteSkin","","",game.AppPosType.MIDDLE_CENTRAL),GUILD_EXP_CURE_PANEL:game.AppInfo.create("GuildExpCurePanel","guild/GuildExpCurePanel","GuildExpCureSkin","","",game.AppPosType.MIDDLE_CENTRAL),CHUMO_PANEL:game.AppInfo.create("ChumoPanel","nationalBoss/ChumoSkin","ChumoSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_CONVERSION_PANEL:game.AppInfo.create("ActiveConversionPanel","active/ActiveConversionSkin","ActiveConversionSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_BUY_CONVERSION_PANEL:game.AppInfo.create("ActiveBuyConversionPanel","active/ActiveBuyConversionSkin","ActiveBuyConversionSkin","","",game.AppPosType.MIDDLE_CENTRAL),VIP_CUSTOMER_PANEL:game.AppInfo.create("VipCustomerPanel","vip/VipCustomerSkin","VipCustomerSkin","","",game.AppPosType.MIDDLE_CENTRAL),VIP_CUSTOMER_CHAT_PANEL:game.AppInfo.create("VipCustomerChatPanel","vip/VipCustomerChatSkin","VipCusomerChatSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_MAIN_PANEL:game.AppInfo.create("EscortMainPanel","escort/EscortMainSkin","EscortMainSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_FINISH_PANEL:game.AppInfo.create("EscortFinishPanel","escort/EscortFinishSkin","EscortFinishSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_LOG_PANEL:game.AppInfo.create("EscortLogPanel","escort/EscortLogSkin","EscortLogSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_PILLAGE_PANEL:game.AppInfo.create("EscortPillagePanel","escort/EscortPillageSkin","EscortPillageSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_REVENGE_PANEL:game.AppInfo.create("EscortRevengePanel","escort/EscortRevengeSkin","EscortRevengeSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_SELECT_PANEL:game.AppInfo.create("EscortSelectPanel","escort/EscortSelectSkin","EscortSelectSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_FRIEND_INVITE_PANEL:game.AppInfo.create("EscortFriendInvitePanel","escort/EscortFriendInviteSkin","EscortFriendInviteSkin","","",game.AppPosType.MIDDLE_CENTRAL),ESCORT_BATTLE_RESULT_PANEL:game.AppInfo.create("EscortBattleResultPanel","escort/EscortBattleResultSkin","EscortBattleResultSkin","","",game.AppPosType.MIDDLE_CENTRAL),ZHANYAO_PANEL:game.AppInfo.create("ZhanyaoPanel","zhanyao/ZhanyaoSkin","ZhanyaoSkin","","",game.AppPosType.MIDDLE_CENTRAL),BLUE_DIAMOND_PANEL:game.AppInfo.create("BlueDiamondPanel","wanba/BlueDiamondSkin","BlueDiamondSkin","","",game.AppPosType.MIDDLE_CENTRAL),YELLOW_DIAMOND_PANEL:game.AppInfo.create("YellowDiamondPanel","wanba/YellowDiamondSkin","YellowDiamondSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_MYSTERY_DEPOT_PANEL:game.AppInfo.create("ActiveMysteryDepotPanel","active/ActiveMysteryDepotSkin","ActiveMysteryDepotSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_CUP_PANEL:game.AppInfo.create("WorldCupPanel","worldcup/WorldCupSkin","WorldCupSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_CUP_BETTING_PANEL:game.AppInfo.create("WorldCupBettingPanel","worldcup/WorldCupBettingSkin","WorldCupBettingSkin","","",game.AppPosType.MIDDLE_CENTRAL),WORLD_CUP_RECORD_PANEL:game.AppInfo.create("WorldCupRecordPanel","worldcup/WorldCupRecordSkin","WorldCupRecordSkin","","",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_FETTER_PANEL:game.AppInfo.create("BianshenFetterPanel","bianshen/BianshenFetterSkin","BianshenFetterSkin","","",game.AppPosType.MIDDLE_CENTRAL),WELCOME_PANEL:game.AppInfo.create("WelcomePanel","welcome/WelcomeSkin","WelcomeSkin","","",game.AppPosType.MIDDLE_CENTRAL),DUJIE_PANEL:game.AppInfo.create("DujiePanel","dujie/DujiePanelSkin","DujiePanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),DUJIE_PRE_PANEL:game.AppInfo.create("DujiePrePanel","dujie/DujiePrePanelSkin","DujiePrePanelSkin","","",game.AppPosType.MIDDLE_CENTRAL),JD_618_GIFT_BAG_PANEL:game.AppInfo.create("Jd618GiftBagPanel","jingdong/Jd618GiftBagSkin","Jd618GiftBagSkin","","",game.AppPosType.MIDDLE_CENTRAL),BIANSHEN_CONVERT_PANEL:game.AppInfo.create("BianshenConvertPanel","bianshen/BianshenConvertSkin","BianshenConvertSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_COMPETE_PANEL:game.AppInfo.create("ActiveCompetePanel","activeCompete/ActiveCompeteSkin","ActiveCompeteSkin","","",game.AppPosType.MIDDLE_CENTRAL),ACTIVE_COMPETE_SHOW_PANEL:game.AppInfo.create("ActiveCompeteShowPanel","activeCompete/ActiveCompeteShowSkin","ActiveCompeteShowSkin","","",game.AppPosType.MIDDLE_CENTRAL),MOUNTEQUIP_PANEL:game.AppInfo.create("MountEquipPanel","mountEquip/MountEquipSkin","MountEquipSkin","","",game.AppPosType.MIDDLE_CENTRAL),MOUNTRESOLVEEQUIP_PANEL:game.AppInfo.create("MountResolveEquipPanel","mountEquip/MountResolveEquipSkin","MountResolveEquipSkin","","",game.AppPosType.MIDDLE_CENTRAL),SELECT_REWARD_PANEL:game.AppInfo.create("SelectRewardPanel","selectReward/SelectRewardSkin","SelectRewardSkin","","",game.AppPosType.MIDDLE_CENTRAL),SWAP_BATTLE_SHAPE_PANEL:game.AppInfo.create("SwapBattleShapePanel","bianshen/SwapBattleShapeSkin","SwapBattleShapeSkin","","",game.AppPosType.MIDDLE_CENTRAL),ORNAMENT_UPGRADE_PANEL:game.AppInfo.create("OrnamentUpgradePanel","ornament/OrnamentUpgradeSkin","OrnamentUpgradeSkin","","",game.AppPosType.MIDDLE_CENTRAL),ORNAMENT_JINJIE_PANEL:game.AppInfo.create("OrnamentJinjiePanel","ornament/OrnamentJinjieSkin","OrnamentJinjieSkin","","",game.AppPosType.MIDDLE_CENTRAL),WX_ADD_SHORTCUT_PANEL:game.AppInfo.create("WxAddShortcutPanel","weixin/WxAddShortcutSkin","WxAddShortcutSkin","","",game.AppPosType.MIDDLE_CENTRAL),WX_FOCUS_PANEL:game.AppInfo.create("WxFocusPanel","weixin/WxFocusSkin","WxFocusSkin","","",game.AppPosType.MIDDLE_CENTRAL)};game.AppConstant=b8e.Enum(e)}},{}],1059:[function(e,t,i){"use strict";game.appModule={},game.AppMgr=b8e.Object.extends({name:"AppMgr",_moduleClassMap:null,_showApps:null,_zorderStartIndex:100,ctor:function(){if(1==game.AppMgr._singleton)throw new Error("AppMgr 只能通过单例方法获取");this._super(),this._moduleClassMap=b8e.HashMap.get(),this._showApps=[]},show:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return this.preTurnModule(e,t,!1,i)},shopToggleApp:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this.preTurnModule(e,t,!0)},showAppNoHide:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this.preTurnModule(e,t,!1)},showAppHideOtherApp:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this.preTurnModule(e,t,!1)},hideAllApp:function(){this._moduleClassMap.forEach(function(e,t){t&&this.isShow(e)&&t.hide()},this)},hide:function(e){var t=this._moduleClassMap.get(e);t&&t.isShow()&&(t.appInfo&&b8e.log("hide panel name：",t.appInfo.moduleName),t.hide())},isShow:function(e){var t=this._moduleClassMap.get(e);return!(!t||!t.isShow())},preTurnModule:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return this.turnModule(e,t,i,n)},turnModule:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;if(null!=e){var s=this.getApp(e);return s.isShow()&&i?s.hide():(this.isShow(e)&&!s.getVisible()&&s.hide(),s.data=t,s._panelParent=n,this._zorderStartIndex++,s.zorderStartIndex=this._zorderStartIndex,s.show()),s}b8e.log("打开界面，传进来的moduleName为什么是undefined，腿打断！！！")},getApp:function(e){var t=this._moduleClassMap.get(e);if(!t){var i=game.AppInfo.getAppInfo(e);(t=new game.appModule[i.moduleName](i)).depth=this._moduleClassMap.count,this._moduleClassMap.set(i.moduleName,t)}return t},addAppInShowList:function(e){e.appInfo&&e.appInfo.moduleName==game.AppConstant.FUNCTION_PREPARE_PANEL||e&&-1==this._showApps.indexOf(e)&&(this._showApps.push(e),this.sortAppShowList())},removeAppFromShowList:function(e){if(!e.appInfo||e.appInfo.moduleName!=game.AppConstant.FUNCTION_PREPARE_PANEL){var t=this._showApps.indexOf(e);e&&-1!=t&&(this._showApps.splice(t,1),this.sortAppShowList())}},sortAppShowList:function(){if(0!=this._showApps.length){this._showApps.sort(this._sortShowApp);for(var e=!1,t=0;t<this._showApps.length;t++){var i=this._showApps[t];i&&(i.width<300||i.height<400?i.setVisible(!0):500<i.width&&750<i.height&&0==e?(i.setVisible(!0),e=!0):0==e?i.setVisible(!0):i.setVisible(!1))}}},_sortShowApp:function(e,t){return t.zorderStartIndex-e.zorderStartIndex}}),game.AppMgr._instance=null,game.AppMgr._singleton=!0,game.AppMgr.inst=function(){return game.AppMgr._instance||(game.AppMgr._singleton=!1,game.AppMgr._instance=new game.AppMgr,game.AppMgr._singleton=!0),game.AppMgr._instance}},{}],1060:[function(e,t,i){"use strict";e("./AppConstant"),e("./AppMgr"),e("./enum/enumIndex_0"),e("./view/viewIndex_0"),e("./ui/uiIndex")},{"./AppConstant":1058,"./AppMgr":1059,"./enum/enumIndex_0":1062,"./ui/uiIndex":1068,"./view/viewIndex_0":1073}],1061:[function(e,t,i){"use strict";game.FunctionType=b8e.Enum({BACK_PACK:1,ROLE:2,EQUIP_MAKE:3,MOUNT:4,FRIEND:5,BIAN_SHEN:6,GUILD:7,SHOP:8,GUA_JI:9,PK_MODE:10,MAIL:12,EQUIP_QIANG_HUA:13,TIAO_ZHAN:14,GE_REN_BOSS:15,MI_JING_BOSS:16,WING:17,FA_BAO:18,CHAT:19,EQUIP_TI_LIAN:20,CARD_RECHARGE:23,FIRST_RECHARGE:24,WELFARE:25,OPEN_SERVER:26,RANK:27,GM:28,DAILY_TASK:32,FIGHTING:33,JING_JIE:37,ZHUANG_SHENG:38,CHENG_JIU:39,XIAN_DAN:40,YUAN_SHEN:41,ZHUANG_BAN:42,CHENG_HAO:43,EQUIP_SHENG_XING:47,BEAUTY:30,WORLD_BOSS:46,CORNUCOPIA:48,SURA:49,MATERIAL:50,SURFACE:51,NATIONAL_BOSS:52,REBIRTH:53,ZHANYAO:54,AUTO_QUEST:55,MATERIAL_GLOD:56,MATERIAL_EXP:57,MATERIAL_MOUNT:58,MATERIAL_WING:59,MATERIAL_EQUIP:60,MATERIAL_FABAO:61,AMULET:62,JIANGJING:63,FENG_SHEN_BANG:64,SEVEN_DAY_LOGIN:65,SHARE:66,MICRO:67,SHOU_CANG:68,GUAN_ZHU:69,FESTIVAL_ACTIVES:70,COMPETION_BTN:71,MILLION_AWARD:72,WANBAGAME_VIP:73,HIGHEQUIP:74,ENCHANT:75,CSARENA:76,TEAM_BOSS:77,TOWER:78,RUNE:79,CS_SURA:80,XIANZHEN:82,MATERIAL_XIANZHEN:83,GUILD_EXP_CURE:85,ESCORT:86,FETTER:87,SHIJIEBEI:88,NEUTRAL_BOSS:89,COMPETE_ACTIVE:90,MOUNT_EQUIP:91,ORNAMENT:92})},{}],1062:[function(e,t,i){"use strict";e("./FunctionType")},{"./FunctionType":1061}],1063:[function(e,t,i){"use strict";game.BaseIcon=b8e.Sprite.extends({_iconResUrl:"",_iconSize:90,ctor:function(e){this._super(),this.setIconSize(e)},setIconSize:function(e){this._iconSize=e<=0?game.IcoSizeEnum.SIZE_90:e,this.setSize(this._iconSize,this._iconSize)},setBgImage:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(""!=e&&this._iconResUrl!=e){this._iconResUrl=e,this.setAnchor(.5,.5),this.setSize(this._iconSize,this._iconSize);var t=""!=this._iconResUrl?game.ClientCfg.getGridBg(this._iconResUrl):"";this.loadTexture(t,null,null,{useManifest:!1}),this.updateLayout()}},updateLayout:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;switch(this._iconSize){case game.IcoSizeEnum.SIZE_68:case game.IcoSizeEnum.SIZE_90:0!=e&&0!=t?this.setPosition(e,t):this.setPosition(0,0)}},clearData:function(){},iconSize:{set:function(e){this._iconSize=e},get:function(){return this._iconSize}},iconResUrl:{get:function(){return this._iconResUrl}}})},{}],1064:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.BgIcon=game.BaseIcon.extends((s(n={_starBar:null,_selectImg:null,_iconImg:null,_iconResName:""},"_selectImg",null),s(n,"_selectRes",""),s(n,"_timeLimitImg",null),s(n,"_tagImg",null),s(n,"_tagDesc",null),s(n,"_vipText","VIP "),s(n,"_isReceiveImg",null),s(n,"_redMask",null),s(n,"_wuxingBg",null),s(n,"_wuxingIcon",null),s(n,"_wuxingIconName",""),s(n,"_star",null),s(n,"_chuzhenIcon",null),s(n,"_activeIcon",null),s(n,"_yBHIcon",null),s(n,"_battleStatus",!1),s(n,"_eqWearIcon",null),s(n,"_eqWearIconRes",""),s(n,"_eqRefinIcon",null),s(n,"_eqRefinIconRes",""),s(n,"_eqEnchantIcon",null),s(n,"_eqEnchantIconRes",""),s(n,"_redIcon",null),s(n,"_redIconRes",""),s(n,"_addIcon",null),s(n,"_tLImg",null),s(n,"_tRImg",null),s(n,"_bLImg",null),s(n,"_bRImg",null),s(n,"_tLLabel",null),s(n,"_tRLabel",null),s(n,"_bLLabel",null),s(n,"_bRLabel",null),s(n,"_labNameText",null),s(n,"_tLLabelString",null),s(n,"_tRLabelString",null),s(n,"_bLLabelString",null),s(n,"_bRLabelString",null),s(n,"_labNameTextString",null),s(n,"_tLLabelColor",0),s(n,"_tRLabelColor",0),s(n,"_bLLabelColor",0),s(n,"_bRLabelColor",0),s(n,"_labNameTextColor",0),s(n,"_effectNode",null),s(n,"_effect",null),s(n,"_anim",null),s(n,"_effectId",""),s(n,"isShow",!1),s(n,"isShowCount",!0),s(n,"_isSelect",!1),s(n,"_battleStatus",!1),s(n,"_wearImg",null),s(n,"_bCurGray",!1),s(n,"_bGray",!1),s(n,"ctor",function(e){this._super(e)}),s(n,"setIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;""!=e?this._iconResName!=e?(this._iconImg||(this._iconImg=b8e.Sprite.get(),this._iconImg.setAnchor(.5,.5)),this._iconImg.setScale(t,i),this._iconImg.setVisible(!0),this._iconResName=e,this._iconImg.loadTexture(this._iconResName,null,null,{useManifest:!1,recycleDelay:6e5})):this._iconImg&&(this._iconImg.setScale(t,i),this._iconImg.setVisible(!0)):this._iconImg.setVisible(!1)}),s(n,"setSelectImg",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(""!=e)if(this._selectRes!=e){this._selectImg||(this._selectImg=b8e.Sprite.get(),this._selectImg.setAnchor(.5,.5),this._selectImg.setVisible(!1)),this._selectRes=e,this._selectImg.setVisible(!0);var t=game.ClientCfg.getImgUrl("icon/"+this._selectRes);this._selectImg.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5})}else this._selectImg||this._selectImg.setVisible(!0)}),s(n,"setEqWearIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._eqWearIcon){this._eqWearIcon=b8e.Sprite.get(),this._eqWearIcon.setAnchor(0,0),this._eqWearIcon.setPosition(-41,15);var t=game.ClientCfg.getImgUrl("icon/eq_kzb");this._eqWearIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._eqWearIcon.setVisible(!1)}this._eqWearIcon.setVisible(e)}else this._eqWearIcon&&this._eqWearIcon.setVisible(e)}),s(n,"setEqRefineIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._eqRefinIcon){this._eqRefinIcon=b8e.Sprite.get(),this._eqRefinIcon.setAnchor(0,0),this._eqRefinIcon.setPosition(-41,15);var t=game.ClientCfg.getImgUrl("icon/eq_ktl");this._eqRefinIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._eqRefinIcon.setVisible(!1)}this._eqRefinIcon.setVisible(e)}else this._eqRefinIcon&&this._eqRefinIcon.setVisible(e)}),s(n,"setEqEnchantIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._eqEnchantIcon){this._eqEnchantIcon=b8e.Sprite.get(),this._eqEnchantIcon.setAnchor(.5,.5),this._eqEnchantIcon.setPosition(0,0);var t=game.ClientCfg.getImgUrl("icon/enchant_Icon");this._eqEnchantIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._eqEnchantIcon.setVisible(!1)}this._eqEnchantIcon.setVisible(e)}else this._eqEnchantIcon&&this._eqEnchantIcon.setVisible(e)}),s(n,"setTimelimit",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._timeLimitImg){this._timeLimitImg=b8e.Sprite.get(),this._timeLimitImg.setAnchor(.5,.5),this._timeLimitImg.setScale(.5,.5),this._timeLimitImg.setPosition(-23,22);var t=game.ClientCfg.getImgUrl("icon/timeLimit");this._timeLimitImg.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._timeLimitImg.setVisible(!1)}this._timeLimitImg.setVisible(e)}else this._timeLimitImg&&this._timeLimitImg.setVisible(e)}),s(n,"setTag",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";e?(this._tagImg||(this._tagImg=b8e.Sprite.get(),this._tagImg.setAnchor(.5,.5),this._tagImg.setScale(.75,.75),this._tagImg.setPosition(-23,22),this._tagImg.loadTexture(game.ClientCfg.getImgUrl("icon/tag"),null,null,{useManifest:!1,recycleDelay:6e5}),this._tagImg.setVisible(e)),this._tagDesc||(this._tagDesc=b8e.Label.get(),this._tagDesc.setFontSize(20),this._tagDesc.setPosition(-42,3),this._tagDesc.setRotation(-49,-49,-49),this._tagDesc.setText(this._vipText+t))):this._tagImg&&this._tagImg.setVisible(e)}),s(n,"setRedIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(e){if(!this._redIcon){this._redIcon=b8e.Sprite.get(),this._redIcon.setAnchor(.5,.5),this._redIcon.setPosition(37+t,37+i);var n=game.ClientCfg.getImgUrl("icon/redIcon");this._redIcon.loadTexture(n,null,null,{useManifest:!1,recycleDelay:6e5}),this._redIcon.setVisible(!1)}this._redIcon.setVisible(e)}else this._redIcon&&this._redIcon.setVisible(e)}),s(n,"setAddIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._addIcon){this._addIcon=b8e.Sprite.get(),this._addIcon.setAnchor(.5,.5),this._addIcon.setPosition(0,0);var t=game.ClientCfg.getImgUrl("icon/jiahao");this._addIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._addIcon.setVisible(!1)}this._addIcon.setVisible(e)}else this._addIcon&&this._addIcon.setVisible(e)}),s(n,"setImgSelect",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this.isSelect=e,!this._selectImg){var i;switch(this._selectImg=b8e.Sprite.get(),this._selectImg.setAnchor(.5,.5),this._selectImg.setPosition(0,0),t){case 0:i=game.ClientCfg.getImgUrl("bianshen/icon_bsxuanding");break;case 1:i=game.ClientCfg.getImgUrl("goldedPig/icon_xuanding");break;case 2:i=game.ClientCfg.getImgUrl("grids/grids_1/choosebtn");break;case 3:i=game.ClientCfg.getImgUrl("bianshen/pic_select")}this._selectImg.loadTexture(i,null,null,{useManifest:!1,recycleDelay:6e5}),this._selectImg.setVisible(!1)}this._selectImg.setVisible(e),this._selectImg.setSize(this.iconSize,this.iconSize)}),s(n,"setImgSelectScale",function(e,t){this._selectImg&&this._selectImg.setScale(e,t)}),s(n,"setImgSelectPos",function(e,t){this._selectImg&&this._selectImg.setPosition(e,t)}),s(n,"setStarBar",function(e,t,i){if(-1!=e&&0!=t){switch(this._starBar||(this._starBar=new game.StarBarCtr,this._starBar.setAnchor(.5,.5)),e){case game.StarType.EQUIP_UP_STAR:this._starBar.setVisible(!0),this._starBar.setData(t,e);break;case game.StarType.BIANSHEN_STAR:case game.StarType.BIANSHEN_DETAILS_STAR:this._starBar.setVisible(!0),this._starBar.setStarGradeData(t,i,e)}this.setStarBarPos()}else this._starBar&&this._starBar.setVisible(!1)}),s(n,"bianshenStarBoom",function(e,t){this._starBar&&this._starBar.upgradeStar(e,t,game.StarType.BIANSHEN_STAR)}),s(n,"setStarBarPos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._starBar){var i=-(this._starBar.starWidth>>1)-1,n=5-(this.iconSize>>1);this._starBar.setPosition(i+e,n+t)}}),s(n,"setIsReceive",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this._isReceiveImg||e){if(!this._isReceiveImg){this._isReceiveImg=b8e.Sprite.get(),this._isReceiveImg.setAnchor(.5,.5),this._isReceiveImg.setPosition(0,0);var t=game.ClientCfg.getImgUrl("icon/yi_ling_qu");this._isReceiveImg.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._isReceiveImg.setVisible(!1)}this._isReceiveImg.setVisible(e),this._isReceiveImg.setSize(this.iconSize,this.iconSize)}else this._isReceiveImg&&this._isReceiveImg.setVisible(e)}),s(n,"setRedMask",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e){if(!this._redMask){this._redMask=b8e.Sprite.get(),this._redMask.setAnchor(.5,.5),this._redMask.setPosition(0,0),this._redMask.setSize(this.iconSize,this.iconSize);var n=game.ClientCfg.getImgUrl("icon/red_mask");this._redMask.loadTexture(n,null,null,{scale9Inset:{top:2,bottom:2,left:2,right:2},useManifest:!1,recycleDelay:6e5}),this._redMask.setVisible(!1)}this._redMask.setVisible(e),this._redMask.setScale(t,i)}else this._redMask&&this._redMask.setVisible(e)}),s(n,"setWuxinBg",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._wuxingBg){this._wuxingBg=b8e.Sprite.get(),this._wuxingBg.setAnchor(.5,.5),this._wuxingBg.setScale(1.05,1.05);var t=game.ClientCfg.getImgUrl("bianshen/pic_wxbg");this._wuxingBg.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._wuxingBg.setPosition(10-(this.iconSize>>1),(this.iconSize>>1)-10),this._wuxingBg.setVisible(!1)}this._wuxingBg.setVisible(e)}else this._wuxingBg&&this._wuxingBg.setVisible(e)}),s(n,"setBattle",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!this._chuzhenIcon){this._chuzhenIcon=b8e.Sprite.get(),this._chuzhenIcon.setAnchor(.5,.5);var i="";switch(t){case 0:i=game.ClientCfg.getImgUrl("bianshen/pic_czz"),this._chuzhenIcon.setPosition((this.iconSize>>1)-11-5,0);break;case 1:i=game.ClientCfg.getImgUrl("bianshen/pic_inbattle"),this._chuzhenIcon.setPosition(0,-20)}this._chuzhenIcon.loadTexture(i,null,null,{useManifest:!1,recycleDelay:6e5}),this._chuzhenIcon.setVisible(!1)}this._chuzhenIcon.setVisible(e)}),s(n,"setCanActive",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(!this._activeIcon){this._activeIcon=b8e.Sprite.get(),this._activeIcon.setAnchor(.5,.5);var t=game.ClientCfg.getImgUrl("bianshen/pic_active");this._activeIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._activeIcon.setPosition(0,-20),this._activeIcon.setVisible(!1)}this._activeIcon.setVisible(e)}),s(n,"setRuneWear",function(e){if(!this._wearImg){this._wearImg=b8e.Sprite.get(),this._wearImg.setAnchor(.5,.5);var t=game.ClientCfg.getImgUrl("rune/wear");this._wearImg.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._wearImg.setPosition(0,13-(this.iconSize>>1)),this._wearImg.setVisible(!1)}this._wearImg.setVisible(e)}),s(n,"setProtected",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(e){if(!this._yBHIcon){this._yBHIcon=b8e.Sprite.get(),this._yBHIcon.setAnchor(.5,.5);var t=game.ClientCfg.getImgUrl("bianshen/pic_ybh");this._yBHIcon.loadTexture(t,null,null,{useManifest:!1,recycleDelay:6e5}),this._yBHIcon.setPosition((this.iconSize>>1)-11-5,0),this._yBHIcon.setVisible(!1)}this._yBHIcon.setVisible(e)}else this._yBHIcon&&this._yBHIcon.setVisible(e)}),s(n,"setWuxingIcon",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return""==e?(this._wuxingBg&&this._wuxingBg.setVisible(!1),void(this._wuxingIcon&&this._wuxingIcon.setVisible(!1))):this._wuxingIconName==e?(this._wuxingBg&&this.setWuxinBg(!0),void(this._wuxingIcon&&this._wuxingIcon.setVisible(!0))):(this._wuxingIcon||(this._wuxingIcon=b8e.Sprite.get(),this._wuxingIcon.setAnchor(.5,.5),this._wuxingIcon.setPosition(10-(this.iconSize>>1),(this.iconSize>>1)-10)),this.setWuxinBg(!0),this._wuxingIcon.setVisible(!0),this._wuxingIconName=e,void this._wuxingIcon.loadTexture(this._wuxingIconName,null,null,{useManifest:!1,recycleDelay:6e5}))}),s(n,"setTLLabel",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0;""!=e?(t=t||4294967295,i=i||(i=game.ClientCfg.MFYueHei),n=n||this.iconSize,s=s||24,a=a||28,o=o||28,this._tLLabel||(this._tLLabel=this.getLabText(n,s,0,1,a,o,t,b8e.OverflowType.SHRINK,b8e.HorizontalAlign.LEFT,b8e.VerticalAlign.TOP,i,r)),this._tLLabel.node.active=!0,this._tLLabelString!=e&&(this._tLLabelString=e,this._tLLabel.string=e),this._tLLabelColor!=t&&(this._tLLabelColor=t,this._tLLabel.node.color=b8e.ColorUtil.toCCColor(t)),this.setTLLPos()):this._tLLabel&&(this._tLLabelString=e,this._tLLabel.string=e,this._tLLabel.node.active=!1)}),s(n,"setTLLPos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._tLLabel){var i=this.iconSize>>1;this._tLLabel.node.setPosition(0+e,i+t)}}),s(n,"setTRLabel",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0;""!=e?(t=t||4294967295,i=i||(i=game.ClientCfg.MFYueHei),n=n||this.iconSize,s=s||24,a=a||28,o=o||28,this._tRLabel||(this._tRLabel=this.getLabText(n,s,1,1,a,o,t,b8e.OverflowType.SHRINK,b8e.HorizontalAlign.RIGHT,b8e.VerticalAlign.TOP,i,r)),this._tRLabel.node.active=!0,this._tRLabelString!=e&&(this._tRLabelString=e,this._tRLabel.string=e),this._tRLabelColor!=t&&(this._tRLabelColor=t,this._tRLabel.node.color=b8e.ColorUtil.toCCColor(t)),this.setTRLPos()):this._tRLabel&&(this._tRLabelString=e,this._tRLabel.string=e,this._tRLabel.node.active=!1)}),s(n,"setTRLPos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._tRLabel){var i=(this.iconSize>>1)-1,n=(this.iconSize>>1)-1;this._tRLabel.node.setPosition(i+e,n+t)}}),s(n,"setBLLabel",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,g=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0;""!=e?(t=t||4294967295,i=i||(i=game.ClientCfg.MFYueHei),n=n||this.iconSize,s=s||24,a=a||28,o=o||28,this._bLLabel||(this._bLLabel=this.getLabText(n,s,0,0,a,o,t,b8e.OverflowType.SHRINK,b8e.HorizontalAlign.LEFT,b8e.VerticalAlign.TOP,i,r)),this._bLLabel.node.active=!0,this._bLLabelString!=e&&(this._bLLabelString=e,this._bLLabel.string=e),this._bLLabelColor!=t&&(this._bLLabelColor=t,this._bLLabel.node.color=b8e.ColorUtil.toCCColor(t)),this.setBLLPos(h,g)):this._bLLabel&&(this._bLLabelString=e,this._bLLabel.string=e,this._bLLabel.node.active=!1)}),s(n,"setBLLPos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._bLLabel){var i=-(this.iconSize>>1),n=2-(this.iconSize>>1);this._bLLabel.node.setPosition(i+e,n+t)}}),s(n,"setNum",function(e,t,i,n,s,a,o){var r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0;e<=1?this.setSubString("",t,i,n,s,a,o,r):this.setSubString(e+"",t,i,n,s,a,o,r)}),s(n,"setSubString",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:1;""!=e?(t=t||4294967295,i=i||(i=game.ClientCfg.MFYueHei),n=n||this.iconSize,s=s||22,a=a||18,o=o||22,r=r||1,this._bRLabel||(this._bRLabel=this.getLabText(n,s,1,0,a,o,t,b8e.OverflowType.SHRINK,b8e.HorizontalAlign.RIGHT,b8e.VerticalAlign.TOP,i,r)),this._bRLabel.node.active=!0,this.isShowCount?this._bRLabelString!=e&&(this._bRLabelString,this._bRLabel.string=e):this._bRLabel.string="",this._bRLabelColor!=t&&(this._bRLabelColor=t,this._bRLabel.node.color=b8e.ColorUtil.toCCColor(t)),this.setBRLPos()):this._bRLabel&&(this._bRLabelString,this._bRLabel.string=e,this._bRLabel.node.active=!1)}),s(n,"setBRLPos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._bRLabel){var i=(this.iconSize>>1)-5,n=2-(this.iconSize>>1);this._bRLabel.node.setPosition(i+e,n+t)}}),s(n,"setName",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:2;""!=e?(t=t||4294967295,i=i||(i=game.ClientCfg.MFYueHei),n=n||this.iconSize+15,s=s||24,a=a||20,o=o||24,h=0<=h?h:b8e.OverflowType.SHRINK,r=0<r?r:0,this._labNameText||(this._labNameText=this.getLabText(n,s,.5,1,a,o,t,h,b8e.HorizontalAlign.CENTER,b8e.VerticalAlign.MIDDLE,i,r)),this._labNameText.node.active=!0,this._labNameTextString!=e&&(this._labNameTextString=e,this._labNameText.string=e),this._labNameTextColor!=t&&(this._labNameTextColor=t,this._labNameText.node.color=b8e.ColorUtil.toCCColor(t)),this.setLabNamePos()):this._labNameText&&(this._labNameTextString=e,this._labNameText.string=e,this._labNameText.node.active=!1)}),s(n,"setLabNamePos",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._labNameText){var i=-(this.iconSize>>1)-1;this._labNameText.node.setPosition(0+e,i+t)}}),s(n,"getLabText",function(e,t,i,n,s,a,o,r,h,g,l,c){var u=b8e.BaseDisplay.get().getNode().addComponent(cc.Label);if(0<c){var m=u.node.addComponent(cc.LabelOutline);m.color=b8e.ColorUtil.toCCColor(0),m.width=c}switch(u.overflow=r,u.horizontalAlign=h,u.verticalAlign=g,u.fontSize=s,u.node.width=e,u.node.height=t,u.lineHeight=a,u.node.color=b8e.ColorUtil.toCCColor(o),u.node.setAnchorPoint(i,n),l){case game.ClientCfg.digits4_0:this.loadFont(u,l)}return u}),s(n,"loadFont",function(i,e){b8e.res.loadRes(e,null,function(e,t){e?b8e.error(e):i.font=t},this)}),s(n,"playEffect",function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(""==e||!e)return this.clearEffect(),void(this._effectNode&&(this._effectNode.active=!1,this._effectId=""));if(!this._effectNode){var s=b8e.BaseDisplay.get();this._effectNode=s.getNode(),this._effectNode.setAnchorPoint(.5,.5)}this._effectNode.active=!0,this._effectId=e;var a=game.ClientCfg.getUIFxs(e);this.addEffect(a,t,i,n)}),s(n,"addEffect",function(e,t,i,n){this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._effectNode)),e?(this._anim||(this._anim=b8e.Animator.get(t,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._effect.setScale(i,n),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()}),s(n,"clearEffect",function(){this._anim&&this._anim.clear(),this._effect&&this._effect.setVisible(!1)}),s(n,"sortLayer",function(){this.addIconImage(),this.addChuZhenIcon(),this.addCanActiveIcon(),this.addWearImg(),this.addYBHIcon(),this.addEqEnchantIcon(),this.addStarBar(),this.addEqWearIcon(),this.addEqRefineIcon(),this.addTimeLimitImage(),this.addTagImage(),this.addTLLabel(),this.addTRLabel(),this.addBLLabel(),this.addBRLabel(),this.addLabNameText(),this.addRedIcon(),this.addJiaHao(),this.addSelectImg(),this.addReceiveImage(),this.addRedMask(),this.addWuxingBg(),this.addWuxingIcon(),this.addEffectNode(),this._bCurGray!==this._bGray&&(this._setGray(this,this._bGray),this._bCurGray=this._bGray)}),s(n,"addIconImage",function(){this._iconImg&&!this._iconImg.parent&&this.addChild(this._iconImg)}),s(n,"addStarBar",function(){this._starBar&&!this._starBar.parent&&this.addChild(this._starBar)}),s(n,"addEqWearIcon",function(){this._eqWearIcon&&!this._eqWearIcon.parent&&this.addChild(this._eqWearIcon)}),s(n,"addEqRefineIcon",function(){this._eqRefinIcon&&!this._eqRefinIcon.parent&&this.addChild(this._eqRefinIcon)}),s(n,"addEqEnchantIcon",function(){this._eqEnchantIcon&&!this._eqEnchantIcon.parent&&this.addChild(this._eqEnchantIcon)}),s(n,"addTimeLimitImage",function(){this._timeLimitImg&&!this._timeLimitImg.parent&&this.addChild(this._timeLimitImg)}),s(n,"addTagImage",function(){this._tagImg&&!this._tagImg.parent&&this.addChild(this._tagImg),this._tagDesc&&!this._tagDesc.parent&&this.addChild(this._tagDesc)}),s(n,"addTLLabel",function(){this._tLLabel&&!this._tLLabel.parent&&this.addChild(this._tLLabel.node)}),s(n,"addTRLabel",function(){this._tRLabel&&!this._tRLabel.parent&&this.addChild(this._tRLabel.node)}),s(n,"addBLLabel",function(){this._bLLabel&&!this._bLLabel.parent&&this.addChild(this._bLLabel.node)}),s(n,"addBRLabel",function(){this._bRLabel&&!this._bRLabel.parent&&this.addChild(this._bRLabel.node)}),s(n,"addLabNameText",function(){this._labNameText&&!this._labNameText.parent&&this.addChild(this._labNameText.node)}),s(n,"addRedIcon",function(){this._redIcon&&!this._redIcon.parent&&this.addChild(this._redIcon)}),s(n,"addEffectNode",function(){this._effectNode&&!this._effectNode.parent&&this.addChild(this._effectNode)}),s(n,"addJiaHao",function(){this._addIcon&&!this._addIcon.parent&&this.addChild(this._addIcon)}),s(n,"addSelectImg",function(){this._selectImg&&!this._selectImg.parent&&this.addChild(this._selectImg)}),s(n,"addRedMask",function(){this._redMask&&!this._redMask.parent&&this.addChild(this._redMask)}),s(n,"addReceiveImage",function(){this._isReceiveImg&&!this._isReceiveImg.parent&&this.addChild(this._isReceiveImg)}),s(n,"addWuxingBg",function(){this._wuxingBg&&!this._wuxingBg.parent&&this.addChild(this._wuxingBg)}),s(n,"addWuxingIcon",function(){this._wuxingIcon&&!this._wuxingIcon.parent&&this.addChild(this._wuxingIcon)}),s(n,"addChuZhenIcon",function(){this._chuzhenIcon&&!this._chuzhenIcon.parent&&this.addChild(this._chuzhenIcon)}),s(n,"addCanActiveIcon",function(){this._activeIcon&&!this._activeIcon.parent&&this.addChild(this._activeIcon)}),s(n,"addWearImg",function(){this._wearImg&&!this._wearImg.parent&&this.addChild(this._wearImg)}),s(n,"addYBHIcon",function(){this._yBHIcon&&!this._yBHIcon.parent&&this.addChild(this._yBHIcon)}),s(n,"setGray",function(e){this._bGray=e}),s(n,"_setGray",function(e,t){if(e){t?b8e.ShaderUtil.setGray(e):b8e.ShaderUtil.reset(e);var i=e.getChildren();if(i&&0<i.length)for(var n=0;n<i.length;n++)this._setGray(i[n],t)}}),s(n,"setImgSelectGray",function(e){this._selectImg&&(e?b8e.ShaderUtil.setGray(this._selectImg):b8e.ShaderUtil.reset(this._selectImg))}),s(n,"setRedIconGray",function(e){this._redIcon&&(e?b8e.ShaderUtil.setGray(this._redIcon):b8e.ShaderUtil.reset(this._redIcon))}),s(n,"setActiveIconGray",function(e){this._activeIcon&&(e?b8e.ShaderUtil.setGray(this._activeIcon):b8e.ShaderUtil.reset(this._activeIcon))}),s(n,"clearData",function(){this._tLLabel&&(this._tLLabel.node.removeFromParent(),this._tLLabel.node.active=!1),this._tRLabel&&(this._tRLabel.node.removeFromParent(),this._tRLabel.node.active=!1),this._bLLabel&&(this._bLLabel.node.removeFromParent(),this._bLLabel.node.active=!1),this._bRLabel&&(this._bRLabel.node.removeFromParent(),this._bRLabel.node.active=!1),this._labNameText&&(this._labNameText.node.removeFromParent(),this._labNameText.node.active=!1),this._iconImg&&(this._iconImg.removeFromParent(),this._iconImg.setVisible(!1)),this._starBar&&(this._starBar.removeFromParent(),this._starBar.setVisible(!1)),this._selectImg&&(this._selectImg.removeFromParent(),this._selectImg.setVisible(!1)),this._eqWearIcon&&(this._eqWearIcon.removeFromParent(),this._eqWearIcon.setVisible(!1)),this._eqRefinIcon&&(this._eqRefinIcon.removeFromParent(),this._eqRefinIcon.setVisible(!1)),this._eqEnchantIcon&&(this._eqEnchantIcon.removeFromParent(),this._eqEnchantIcon.setVisible(!1)),this._timeLimitImg&&(this._timeLimitImg.removeFromParent(),this._timeLimitImg.setVisible(!1)),this._tagImg&&(this._tagImg.removeFromParent(),this._tagImg.setVisible(!1)),this._tagDesc&&(this._tagDesc.removeFromParent(),this._tagDesc.setVisible(!1)),this._redIcon&&(this._redIcon.removeFromParent(),this._redIcon.setVisible(!1)),this._addIcon&&(this._addIcon.removeFromParent(),this._addIcon.setVisible(!1)),this._selectImg&&(this._selectImg.removeFromParent(),this._selectImg.setVisible(!1)),this._redMask&&(this._redMask.removeFromParent(),this._redMask.setVisible(!1)),this._wuxingBg&&(this._wuxingBg.removeFromParent(),this._wuxingBg.setVisible(!1)),this._wuxingIcon&&(this._wuxingIcon.removeFromParent(),this._wuxingIcon.setVisible(!1)),this._chuzhenIcon&&(this._chuzhenIcon.removeFromParent(),this._chuzhenIcon.setVisible(!1)),this._activeIcon&&(this._activeIcon.removeFromParent(),this._activeIcon.setVisible(!1)),this._wearImg&&(this._wearImg.removeFromParent(),this._wearImg.setVisible(!1)),this._yBHIcon&&(this._yBHIcon.removeFromParent(),this._yBHIcon.setVisible(!1)),this._isReceiveImg&&(this._isReceiveImg.removeFromParent(),this._isReceiveImg.setVisible(!1)),this._effectNode&&(this._effectNode.removeFromParent(),this._effectNode.active=!1),this.clearEffect(),this._effectId="",this._super()}),s(n,"isSelect",{set:function(e){this._isSelect=e},get:function(){return this._isSelect}}),s(n,"battleStatus",{set:function(e){this._battleStatus=e},get:function(){return this._battleStatus}}),s(n,"tLLabel",{get:function(){return this._tLLabel}}),s(n,"tRLabel",{get:function(){return this._tRLabel}}),s(n,"bLLabel",{get:function(){return this._bLLabel}}),s(n,"bRLabel",{get:function(){return this._bRLabel}}),n))},{}],1065:[function(e,t,i){"use strict";game.IconCDFace=game.BgIcon.extends({_faceInfo:null,ctor:function(e){this._super(e||game.IcoSizeEnum.SIZE_90)},faceInfo:{set:function(e){this._faceInfo=e},get:function(){return this._faceInfo}}})},{}],1066:[function(e,t,i){"use strict";game.ItemGrid=game.IconCDFace.extends({_gridInfo:null,_index:-1,_clickFun:null,_thisArg:null,ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this._super(e||game.IcoSizeEnum.SIZE_90),this._index=t,i&&b8e.evt.onC(this,this.fnOnClickGrid,this)},setGridEmpty:function(){this.clearData()},setEffect:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;this.playEffect(e,t,i,n)},fnOnClick:function(e,t){this._thisArg=e,this._clickFun=t},fnOnClickGrid:function(e){this._clickFun&&null!=this._clickFun&&this._clickFun.call(this._thisArg,this)},containerId:{get:function(){return this._gridInfo?this._gridInfo.containerId:0}},index:{get:function(){return this._gridInfo?this._gridInfo.index:-1}},gridInfo:{set:function(e){this._gridInfo=e},get:function(){return this._gridInfo}}})},{}],1067:[function(e,t,i){"use strict";game.StateLine=b8e.BaseDisplay.extends({_labName:null,_labValue:null,MAX_WIDTH:140,LAB_MAX_HEIGHT:40,_isShowAdd:!1,_nameColor:0,_valueColor:0,_nameDistance:0,_valueDistance:0,ctor:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:game.html.Q_WHITE,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:game.html.Q_GREEN;this._super(),this._isShowAdd=e,this._nameColor=n,this._valueColor=s,this._nameDistance=t,this._valueDistance=i,this.init()},init:function(){this._labName=b8e.Label.get(),this.addChild(this._labName),this._labName.setAnchor(0,.5),this._labName.setFontSize(24),this._labName.setOverflow(b8e.OverflowType.SHRINK),this._labName.setVerticalAlign(b8e.VerticalAlign.CENTER),this._labName.setLineHeight(this.LAB_MAX_HEIGHT),this._labName.setSize(this.MAX_WIDTH,this.LAB_MAX_HEIGHT),this._labName.x=this._nameDistance,this._labName.setColor(this._nameColor),this._labValue=b8e.Label.get(),this.addChild(this._labValue),this._labValue.setAnchor(0,.5),this._labValue.setFontSize(24),this._labValue.setOverflow(b8e.OverflowType.SHRINK),this._labValue.setVerticalAlign(b8e.VerticalAlign.CENTER),this._labValue.setLineHeight(this.LAB_MAX_HEIGHT),this._labValue.setSize(this.MAX_WIDTH,this.LAB_MAX_HEIGHT),this._labValue.x=this._valueDistance,this._labValue.setColor(this._valueColor)},setData:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._data=e,this._data&&e){this._labName.setText(game.ccfg.AttrRulesCfg.getAttrNameByType(e.type));var i=game.ccfg.AttrRulesCfg.getAttrRulesInfoByType(e.type);if(i){var n="";switch(i.format){case game.AttrRulesFormat.FORMAT_1:n=e.value;break;case game.AttrRulesFormat.FORMAT_2:n=game.ValueUtil.getDigitsValueByNum(100*e.value,1)+"%";break;case game.AttrRulesFormat.FORMAT_3:n=game.ValueUtil.getDigitsValueByNum(100*e.value,2)}this._isShowAdd&&(n="+"+n),this._labValue.setText(n)}0!=t&&(this._labValue.setFontSize(t),this._labName.setFontSize(t))}}})},{}],1068:[function(e,t,i){"use strict";e("./icon/BaseIcon"),e("./icon/BgIcon"),e("./icon/IconCDFace"),e("./icon/ItemGrid")},{"./icon/BaseIcon":1063,"./icon/BgIcon":1064,"./icon/IconCDFace":1065,"./icon/ItemGrid":1066}],1069:[function(e,t,i){"use strict";game.GameWidget=b8e.BaseDisplay.extends({name:"GameWidget",_isLoaded:!1,_isLoading:!1,_options:null,_refreshCallbackVec:null,_isShowUI:!1,_skin:null,_skinName:"",_display:null,_scriptName:"",ctor:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this._super(),this._skinName=null,this._display=null,this._isLoaded=!1,this._isLoading=!1,"string"==typeof e?(this._skinName=e,this._scriptName=t):e&&(this._skin=e,i instanceof cc.Node?(i.active=!0,this._display=b8e.BaseDisplay.get(),this._display.addChild(i)):i instanceof b8e.BaseDisplay&&(this._display=i)),this._options=n},show:function(){if(!this._isShowUI)if(this._isShowUI=!0,this._display||(this._display=new b8e.PrefabDisplay),this.addChild(this._display),this._isLoaded)this.__onShow();else if(!this._isLoading)if(this._isLoading=!0,this._skinName){var e=this._skinName,t=this._scriptName;this._display.loadPrefab(e,t,this.onComplete,this,this._options)}else this._display&&this.onComplete();this._isLoaded&&(this.onRefresh(),this.onRefreshCallback())},hide:function(){this._isShowUI&&this.__doHide()},__doHide:function(){this._isShowUI&&(this._isShowUI=!1,this._isLoaded&&this.onHide(),this._display.removeFromParent(),this._skinName&&this._isLoading&&!this._display.isLoaded()&&(this._isLoading=!1,this._isLoaded=!1,this._display.unloadPrefab()))},onComplete:function(){if(this._isLoading=!1,this._isLoaded=!0,this._display._script){this._skin=this._display._script,this._display.setSize(this._skin.node.width,this._skin.node.height);var e=this.getAnchor();this._display.setAnchor(e.x,e.y),this.setSize(this._skin.node.width,this._skin.node.height)}this.init(),this.__onLoaded()},onRefreshCallback:function(){this._refreshCallbackVec&&0<this._refreshCallbackVec.count()&&b8e.CallBackUtil.exceteCallBackData(this,this._refreshCallbackVec)},isLoaded:function(){return this._isLoaded},isShow:function(){return this._isShowUI},addRefreshCallback:function(e,t,i){this._refreshCallbackVec||(this._refreshCallbackVec=b8e.HashMap.get()),b8e.CallBackUtil.addCallBackData(this._refreshCallbackVec,e,t,i)},removeRefreshCallback:function(e,t){this._refreshCallbackVec&&0<this._refreshCallbackVec.count()&&b8e.CallBackUtil.removeCallBackData(this._refreshCallbackVec,e,t)},__onShow:function(){this.onShow(),this.onRefresh(),this.onRefreshCallback()},__onLoaded:function(){this.__onShow()},setAnchor:function(e,t){this._display&&this._display.setAnchor(e,t),this._super(e,t)},init:function(){},onShow:function(){},onHide:function(){},onRefresh:function(){},dispose:function(){this.__doHide(),this._isLoaded=!1,this._isLoading=!1,this._refreshCallbackVec&&(b8e.CallBackUtil.removeAllCallBackData(this._refreshCallbackVec),this._refreshCallbackVec.release(),this._refreshCallbackVec=null),this._isShowUI=!1,this._skin=null,this._skinName=null,this._display&&(this._display.release(),this._display=null),this._scriptName=null,this._options=null,this._super()}})},{}],1070:[function(e,t,i){"use strict";game.GameWindowWidget=game.GameWidget.extends({name:"WindowWidget",appInfo:null,depth:null,modalHideScene:!0,zorderStartIndex:null,_modalBgNode:null,_screenOriginPos:null,_graphicsModalImg:null,_modalBgColor:null,_panelParent:null,_resetZOrder:!1,ctor:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this.appInfo=e,this._super(null==t?this.appInfo.skinName:t,this.appInfo.scriptName,i,n)},show:function(){(this._super(),this._isLoaded)&&(this._panelParent?this._panelParent.addChild(this):b8e.layer.getGuiLayer().addChild(this))},__onShow:function(){(this.setAnchor(0,0),this.setSize(this._skin.node.width,this._skin.node.height),this.appInfo.layer)?this.appInfo.layer.addChild(this):this._panelParent?this._panelParent.addChild(this):b8e.layer.getGuiLayer().addChild(this);this.onStageResize(b8e.stageWidth,b8e.stageHeight),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.______onStageResize),this._skin.isHideOnClickScreen||this._skin.title&&""==this._skin.title.string&&(this._skin.title.string="标题"),null!=this._skin.isNeedTweenPanel&&this._skin.isNeedTweenPanel?null!=this._skin.openTweenType&&this.onTweenEnd(!0):this.onTweenEnd(!0)},registerEvent:function(){this._modalBgNode&&(this._modalBgNode.touchEffectDisabled=!1,this._skin.isHideOnClickScreen?b8e.evt.onC(this._modalBgNode,this.onModalBgNode,this):b8e.evt.onC(this._modalBgNode,this.onModalBgNodeNoHide,this)),this._skin.closeBtn&&b8e.evt.onC(this._skin.closeBtn,this.onClickCloseBtn,this),this._skin.closeBtnReturn&&b8e.evt.onC(this._skin.closeBtnReturn,this.onClickClostBtnReturn,this),this._skin.isThrough||this._skin.bg&&(this._skin.bg.node.touchEffectDisabled=!1,b8e.evt.onC(this._skin.bg.node,this.onNode,this))},unregisterEvent:function(){this._modalBgNode&&(this._skin.isHideOnClickScreen?b8e.evt.offC(this._modalBgNode,this.onModalBgNode,this):b8e.evt.offC(this._modalBgNode,this.onModalBgNodeNoHide,this)),this._skin.closeBtn&&b8e.evt.offC(this._skin.closeBtn,this.onClickCloseBtn,this),this._skin.closeBtnReturn&&b8e.evt.offC(this._skin.closeBtnReturn,this.onClickClostBtnReturn,this),this._skin.isThrough||this._skin.bg&&b8e.evt.offC(this._skin.bg.node,this.onNode,this)},onClickCloseBtn:function(){this.hide()},onClickClostBtnReturn:function(){this.hide()},onModalBgNode:function(){this.hide()},onModalBgNodeNoHide:function(){},onNode:function(){this._skin.isHideOnClickBg&&this.hide()},hide:function(){this.isShow()&&this._skin&&(null!=this._skin.isNeedTweenPanel&&this._skin.isNeedTweenPanel?null!=this._skin.hideTweenType&&this.onTweenEnd(!1):this.onTweenEnd(!1))},______onStageResize:function(e){this.onStageResize()},onStageResize:function(){this.resetPosition(),this.updateModalBgPosition()},updateModalBgPosition:function(){this._addModalBg()},_addModalBg:function(){if(this._skin.isModal){if(null==this._modalBgNode){var e=b8e.BaseDisplay.get();this._modalBgNode=e.getNode(),this._modalBgNode.touchEffectDisabled=!1}this.addChild(this._modalBgNode),null==this._screenOriginPos&&(this._screenOriginPos=this.convertToNodeSpaceAR(cc.Vec2.ZERO)),this._modalBgNode.setAnchorPoint(0,0),this._modalBgNode.setPosition(this._screenOriginPos),this.setBgNodeSize(this._modalBgNode)}},setBgNodeSize:function(e){e.setContentSize(b8e.stageWidth,b8e.stageHeight),this._graphicsModalImg||(this._graphicsModalImg=b8e.Graphics.get(),this._graphicsModalImg.addToParent(e)),this._graphicsModalImg.clear();var t=this.x,i=this.y;this._modalBgNode.x=-t,this._modalBgNode.y=-i-55,this._modalBgNode.width=b8e.stageWidth+t+100,this._modalBgNode.height=b8e.stageHeight+i+100;var n=this._graphicsModalImg.getGraphics();this._modalBgColor||(this._skin.isTransparentBg?this._modalBgColor=b8e.ColorUtil.toCCColor(0):this._modalBgColor=b8e.ColorUtil.toCCColor(3003121664)),n.fillColor=this._modalBgColor,n.rect(-t,-i-55,b8e.stageWidth+t+100,b8e.stageHeight+i+10+100),n.fill(),e.setLocalZOrder(-999999999)},resetPosition:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(null!=this.appInfo){var i,n,s=b8e.stageWidth;0!=e&&(s=e);var a=b8e.stageHeight;switch(0!=t&&(a=t),this.appInfo.posType){case game.AppPosType.MIDDLE_CENTRAL:i=(s-this.width)/2,n=(a-this.height)/2;break;case game.AppPosType.TOP_LEFT:i=0,n=a-this.height;break;case game.AppPosType.TOP_CENTRAL:i=(s-this.width)/2,n=a-this.height;break;case game.AppPosType.TOP_RIGHT:i=s-this.width,n=a-this.height;break;case game.AppPosType.MIDDLE_RIGHT:i=s-this.width,n=(a-this.height)/2;break;case game.AppPosType.BOTTOM_RIGHT:i=s-this.width,n=0;break;case game.AppPosType.BOTTOM_CENTRAL:i=(s-this.width)/2,n=0;break;case game.AppPosType.BOTTOM_LEFT:n=i=0;break;case game.AppPosType.MIDDLE_LEFT:i=0,n=(a-this.height)/2;break;case game.AppPosType.TOP_DOWN_FIXED:i=(s-this.width)/2,n=.25*a;break;default:i=(s-this.width)/2,n=(a-this.height)/2}this.x=i+this.appInfo.pX,this.y=n+this.appInfo.pY,this.updateModalBgPosition()}},tweenPanelByType:function(e){switch(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0){case game.AppTweenType.TWEEN_TYPE_FADED:this.fadeFaded(e);break;case game.AppTweenType.TWEEN_TYPE_ZOOM:this.zoom(e)}},fadeFaded:function(e){e?this.alpha=0:this.alpha=1,this.onTweenEnd(e)},zoom:function(e){e?this.setScale(0,0):this.setScale(1,1),this.onTweenEnd(e)},onTweenEnd:function(e){e?(this.registerEvent(),this.onShow(),this.onRefresh(),this.onRefreshCallback()):(this.__doHide(),this.unregisterEvent(),this.removeFromParent())},__doHide:function(){this.isShow()&&(b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.______onStageResize),this._modalBgNode&&this._modalBgNode.removeFromParent(),this._resetZOrder&&(this._resetZOrder=!1,this.setLocalZOrder(0)),this._panelParent=null,this._super())},init:function(){this._super()},onShow:function(){this._super()},onHide:function(){this._super()},onRefresh:function(){this._super()},dispose:function(){this._super()}})},{}],1071:[function(e,t,i){"use strict";game.SkinUI=game.GameWidget.extends({name:"SkinUI",ctor:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;this._super("string"==typeof e?"app/prefabs/app_module_skin/"+e:e,t,s,a)},init:function(){this._super()},onShow:function(){this._super()},onHide:function(){this._super()},onRefresh:function(){this._super()},dispose:function(){this._super()}}),game.BUILD_LOG&&cc.log("初始化 SkinUI 成功")},{}],1072:[function(e,t,i){"use strict";game.SkinUIPanel=game.GameWindowWidget.extends({name:"SkinUIPanel",ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;null!=e&&this._super(e,"app/prefabs/app_module_skin/"+e.skinName,t,i)},__onShow:function(){switch(this.modalHideScene&&this._skin.isModal&&!this._skin.isTransparentBg&&game.SceneMgr.inst().addModalRef(this),this.appInfo.moduleName){case game.AppConstant.HIGH_STAR_PANEL:case game.AppConstant.ACCESSORY_UPGRADE_PANEL:case game.AppConstant.SKILL_DESC_PANEL:case game.AppConstant.DUJIE_SUCCEED_PANEL:case game.AppConstant.ANNOUNCEMENT_PANEL:this.setLocalZOrder(99999999);break;case game.AppConstant.DIALOG_PANEL:this.setLocalZOrder(1e8);break;case game.AppConstant.FUNCTION_OPEN_PANEL:this.setLocalZOrder(9999e4);break;case game.AppConstant.FUNCTION_PREPARE_PANEL:break;default:0==this.getLocalZOrder()?(this.setLocalZOrder(this.zorderStartIndex),this._resetZOrder=!0):this._resetZOrder=!1,game.app.addAppInShowList(this)}this._super()},hide:function(){this.isShow()&&this._skin&&(game.CommandMgr.inst().closeView(this),this._super())},resetPosition:function(){if(null!=this.appInfo){var e=b8e.stageWidth,t=b8e.stageHeight;switch(this.appInfo.moduleName){case game.AppConstant.HIGH_STAR_PANEL:case game.AppConstant.ACCESSORY_UPGRADE_PANEL:case game.AppConstant.DUJIE_SUCCEED_PANEL:t=b8e.stageHeight;break;default:t=b8e.stageHeight+55}this._super(e,t)}},__doHide:function(){this.isShow()&&(game.app.removeAppFromShowList(this),this.modalHideScene&&this._skin.isModal&&!this._skin.isTransparentBg&&game.SceneMgr.inst().removeModalRef(this),this._super())},init:function(){this._super()},onShow:function(){this._super()},onHide:function(){this._super()},onRefresh:function(){this._super()},dispose:function(){this._super()}}),game.BUILD_LOG&&cc.log("初始化 SkinUIPanel 成功")},{}],1073:[function(e,t,i){"use strict";e("./GameWidget"),e("./GameWindowWidget"),e("./SkinUI"),e("./SkinUIPanel")},{"./GameWidget":1069,"./GameWindowWidget":1070,"./SkinUI":1071,"./SkinUIPanel":1072}],1074:[function(e,t,i){"use strict";game.BaseBean=b8e.Object.extends({start:function(){}}),game.BUILD_LOG&&cc.log("初始化 BaseBean")},{}],1075:[function(e,t,i){"use strict";game.BaseSender=b8e.Object.extends({bytes:{get:function(){return b8e.NetSender.getBytes()}},send:function(e){b8e.sendN(e)}}),game.BUILD_LOG&&cc.log("初始化 basesender")},{}],1076:[function(e,t,i){"use strict";game.BeanMgr=b8e.Object.extends({_beans:null,ctor:function(){this._beans=b8e.HashMap.get()},add:function(e,t){if(1==this._beans.has(e))throw new Error("预注册已存在");var i=new t;this._beans.set(e,i)},register:function(){this._beans.forEach(function(e,t){if(!(t instanceof game.BaseBean))throw new Error("不是可运行的注册");t.start()})}}),game.BeanMgr._instance=null,game.BeanMgr._singleton=!0,game.BeanMgr.inst=function(){return null==game.BeanMgr._instance&&(game.BeanMgr._singleton=!1,game.BeanMgr._instance=new game.BeanMgr,game.BeanMgr._singleton=!0),game.BeanMgr._instance}},{}],1077:[function(e,t,i){"use strict";game.BeanRegisterMgr=b8e.Object.extends({_beanConfigList:null,ctor:function(){this._super(),this._beanConfigList=[]},setup:function(){this._configBean()},register:function(e,t){if(-1!=this._beanConfigList.indexOf(e))throw new Error("重复添加Bean:"+e);this._beanConfigList.push(e),game.BeanMgr.inst().add(e,t)},_configBean:function(){this.register("SceneRoleCmd",game.SceneRoleCmd),this.register("ActiveCmd",game.ActiveCmd),this.register("BackCmd",game.BackCmd),this.register("PkModeCmd",game.PkModeCmd),this.register("QuestCmd",game.QuestCmd),this.register("EquipCmd",game.EquipCmd),this.register("BianshenCmd",game.BianshenCmd),this.register("LoneyDungeonCmd",game.LoneyDungeonCmd),this.register("ReliveCmd",game.ReliveCmd),this.register("RoleLoginCmd",game.RoleLoginCmd),this.register("GMCmd",game.GMCmd),this.register("AccessoryCmd",game.AccessoryCmd),this.register("ResetDailyCmd",game.ResetDailyCmd),this.register("MailCmd",game.MailCmd),this.register("BeautyCmd",game.BeautyCmd),this.register("ChatCmd",game.ChatCmd),this.register("DrawCmd",game.DrawCmd),this.register("WelfareCmd",game.WelfareCmd),this.register("RankCmd",game.RankCmd),this.register("ShopCmd",game.ShopCmd),this.register("ArenaCmd",game.ArenaCmd),this.register("MiscCmd",game.MiscCmd),this.register("RelationCmd",game.RelationCmd),this.register("GuildCmd",game.GuildCmd),this.register("SuraCmd",game.SuraCmd),this.register("PayCmd",game.PayCmd),this.register("VipCmd",game.VipCmd),this.register("DujieCmd",game.DujieCmd),this.register("SurfaceCmd",game.SurfaceCmd),this.register("SkillCmd",game.SkillCmd),this.register("MaterialCmd",game.MaterialCmd),this.register("CornucopiaCmd",game.CornucopiaCmd),this.register("ShareCmd",game.ShareCmd),this.register("AchievementCmd",game.AchievementCmd),this.register("NationalBossCmd",game.NationalBossCmd),this.register("TransgerNoticeCmd",game.TransgerNoticeCmd),this.register("XiandanCmd",game.XiandanCmd),this.register("NickNameCmd",game.NickNameCmd),this.register("RebirthCmd",game.RebirthCmd),this.register("RedPacketCmd",game.RedPacketCmd),this.register("ZhanyaoCmd",game.ZhanyaoCmd),this.register("AmuletCmd",game.AmuletCmd),this.register("TianGongCmd",game.TianGongCmd),this.register("TeamCmd",game.TeamCmd),this.register("CSArenaCmd",game.CSArenaCmd),this.register("TowerCmd",game.TowerCmd),this.register("RuneCmd",game.RuneCmd),this.register("RetrieveCmd",game.RetrieveCmd),this.register("EscortCmd",game.EscortCmd),this.register("WorldCupCmd",game.WorldCupCmd),this.register("MountEquipCmd",game.MountEquipCmd),this.register("OrnamentCmd",game.OrnamentCmd)}}),game.BeanRegisterMgr._instance=null,game.BeanRegisterMgr._singleton=!0,game.BeanRegisterMgr.inst=function(){return null==game.BeanRegisterMgr._instance&&(game.BeanRegisterMgr._singleton=!1,game.BeanRegisterMgr._instance=new game.BeanRegisterMgr,game.BeanRegisterMgr._singleton=!0),game.BeanRegisterMgr._instance}},{}],1078:[function(e,t,i){"use strict";e("./BaseBean"),e("./BaseSender"),e("./BeanMgr"),e("./BeanRegisterMgr")},{"./BaseBean":1074,"./BaseSender":1075,"./BeanMgr":1076,"./BeanRegisterMgr":1077}],1079:[function(e,t,i){"use strict";e("./bean/beanIndex_0"),e("./manager/managerIndex_18")},{"./bean/beanIndex_0":1078,"./manager/managerIndex_18":1087}],1080:[function(e,t,i){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};game.CommandMgr=b8e.Object.extends({_currCommands:null,_bindTrigger:null,_skinUiByModuleName:null,_needUpdateList:null,_orgLocalZOrderByPanel:null,ctor:function(){this._super(),this._currCommands=b8e.HashMap.get(),this._bindTrigger=b8e.HashMap.get(),this._skinUiByModuleName=b8e.HashMap.get(),this._needUpdateList=b8e.HashMap.get(),this._orgLocalZOrderByPanel=b8e.HashMap.get(),b8e.Timer.add(this,this.onUpdate,500)},registerSkinUI:function(e,t){this._skinUiByModuleName.set(e,t)},updateCommands:function(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._currCommands.forEach(function(e,t){var i=t.hideViewInSceneTypes;if(!(0<c)||i){var n=t.viewDescId,s=1==t.openView;if(0<c){var a=i.split(","),o=game.SceneMgr.inst().getSceneConfig();-1<a.indexOf(o.type+"")&&(s=!1)}if(!(n<=0)){var r=game.ccfg.ClientViewDescCfg.getDataById(n);if(r){var h=r.moduleName;if(h){var g=null,l=game.AppConstant[h];null!=l?(g=game.app.getApp(l))&&(0<c&&(s?game.app.show(l):game.app.hide(l)),g.isLoaded()&&g.isShow()&&this.triggerOption(g,h,!0)):(g=this._skinUiByModuleName.get(h))&&(0<c&&(s?g.show():g.hide()),g.isLoaded()&&g.isShow()&&this.triggerOption(g,h,!0))}}}}},this)},updateCommandById:function(e){var t=this._currCommands.get(e);if(t){var i=t.viewDescId;if(i<=0)return;var n=game.ccfg.ClientViewDescCfg.getDataById(i);if(!n)return;var s=n.moduleName;if(!s)return;var a=null,o=game.AppConstant[s];(a=null!=o?game.app.getApp(o):this._skinUiByModuleName.get(s))&&a.isLoaded()&&a.isShow()&&this.triggerOption(a,s,!0)}},triggerCommandById:function(e){var t=game.ccfg.ClientCommandCfg.getDataById(e);t?this.doCommand(t):b8e.warn("命令"+e+"没有找到！")},doCommand:function(e){this._currCommands.set(e.id,e);var t=e.viewDescId,i=1==e.openView,n=e.hideViewInSceneTypes;if(n){var s=n.split(","),a=game.SceneMgr.inst().getSceneConfig();a&&-1<s.indexOf(a.type+"")&&(i=!1)}if(0<t){var o=game.ccfg.ClientViewDescCfg.getDataById(t);if(o){var r=o.moduleName;if(r){var h=null,g=game.AppConstant[r];if(null!=g){if(h=game.app.getApp(g)){if(i)if(game.app.show(g),0!=e.viewLocalZOrder)void 0===this._orgLocalZOrderByPanel.get(h,this)&&this._orgLocalZOrderByPanel.set(h,h.getLocalZOrder(),this),h.setLocalZOrder(e.viewLocalZOrder);h.isLoaded()&&h.isShow()?this.triggerOption(h,r,!0):h.addRefreshCallback(this.onPanelRefresh,this,[r])}}else if(h=this._skinUiByModuleName.get(r)){if(i)if(h.show(),0!=e.viewLocalZOrder)void 0===this._orgLocalZOrderByPanel.get(h,this)&&this._orgLocalZOrderByPanel.set(h,h.getLocalZOrder(),this),h.setLocalZOrder(e.viewLocalZOrder);h.isLoaded()&&h.isShow()?this.triggerOption(h,r,!0):h.addRefreshCallback(this.onPanelRefresh,this,[r])}else b8e.warn("模块"+r+"没有注册！")}else b8e.warn("界面描述"+t+"没有配置moduleName！")}else b8e.warn("界面描述"+t+"没有找到！")}var l=e.transportParams;if(l){var c=l.split(","),u=parseInt(c[0]),m=parseInt(c[1]),_=parseInt(c[2]),d=b8e.scene.getGridPosByPixel(m,_);game.SceneSender.moveToRequest(game.SceneTransType.TYPE_TARGET_POS,u,[d.x,d.y])}var f=e.useBianshenId;if(0<f){var p=new game.BianshenBattleSlotInfo;p.index=0,p.isUnlocked=!0,p.bianshenId=p.dataId=f,game.mainGui.mainui.getShapeBar().setSlotInfos([p]),game.ShapeShiftMgr.inst().selfShape(p.dataId)}var S=e.sendWanbaGamebarMsg;S&&(game.IS_QZONE&&game.QzoneSDK.sendGamebarMsg(S),b8e.info("玩吧游戏消息："+S)),b8e.evt.dptG(game.CommandEvent.TRIGGER_COMMAND,e)},onPanelRefresh:function(e,t){this.triggerOption(e,t,!0)},doTargetOption:function(e,t,i,n){var s=i.optionName;if(s)if("function"==typeof t[s]){var a=i.optionValue;if(n){if(!this._needUpdateList.get(i.id)){var o={cmdData:i,moduleName:e,panel:t,optionName:s,optionValue:a};this._needUpdateList.set(i.id,o),this.processOption(o.cmdData,o.moduleName,o.panel,o.optionName,o.optionValue,!0)}}else this.processOption(i,e,t,s,a,!1)}else b8e.warn("模块"+e+"配置选项"+s+"没有找到！")},processOption:function(e,t,i,n,s,a){var o,r=!1;if("setTriggerData"==n){var h=this._bindTrigger.get(e.id),g=game.ccfg.ClientTriggerCfg.getDataById(h);(o=i[n].call(i,g))&&(r=!0)}else if("setTab"==n)s?(o=i[n].call(i,s))&&(r=!0):(r=!0,b8e.warn("模块"+t+"配置选项setTab的值不能为空！"));else{var l=!1;(o=i[n].call(i,s))?"object"===(void 0===o?"undefined":c(o))?(o instanceof cc.Sprite&&(o=o.node),o instanceof cc.Node?(r=l=!0,this.setWidgetState(i,e,o,a)):o instanceof b8e.BaseDisplay?(r=l=!0,this.setWidgetState(i,e,o,a)):o instanceof Array?r=l=!0:l=!1):l=!0:l=!1,l||(r=!0,b8e.warn("模块"+t+"配置选项"+n+"的值"+s+"无效！"))}r&&this._needUpdateList.del(e.id)},closeView:function(g){this._currCommands.forEach(function(e,t){var i=this._bindTrigger.get(t.id);if(i){var n=t.viewDescId;if(0<n){var s=game.ccfg.ClientTriggerCfg.getDataById(i),a=game.ccfg.ClientViewDescCfg.getDataById(n);if(a&&a.moduleName){var o,r=a.moduleName,h=game.AppConstant[r];if(o=null!=h?game.app.getApp(h):this._skinUiByModuleName.get(r)){if(o==g)switch(t.handleWhenCloseView){case 1:game.TriggerMgr.inst().cancelTrigger(s);break;case 2:game.TriggerMgr.inst().cancelTrigger(s,!0)}}else b8e.warn("模块"+r+"没有注册！")}}}},this)},triggerOption:function(s,a,o){s.isLoaded()&&this._currCommands.forEach(function(e,t){var i=t.viewDescId;if(0<i){var n=game.ccfg.ClientViewDescCfg.getDataById(i);n&&n.moduleName&&n.moduleName==a&&this.doTargetOption(a,s,t,o)}},this)},preventCommandById:function(e,t,i){if(this._currCommands.get(t)){var n=game.ccfg.ClientCommandCfg.getDataById(t);if(n){var s=n.viewDescId,a=n.closeViewWhenPrevent&&!n.handleWhenCloseView;if(i){var o=!1;e.triggerType==game.TriggerType.GOODS&&(o=1==n.useGoodsWhenPrevent),o&&(e.equipType?this.useEquipById(e.equipType,e.goodsId):e.goodsType?this.useGoodsById(e.goodsType,e.goodsId):e.prizeType&&this.usePrizeById(e.prizeType,e.goodsId))}if(0<s){var r=game.ccfg.ClientViewDescCfg.getDataById(s);if(r){var h=r.moduleName;if(h){var g,l=game.AppConstant[h];if(g=null!=l?game.app.getApp(l):this._skinUiByModuleName.get(h)){g.removeRefreshCallback(this.onPanelRefresh,this),this.triggerOption(g,h,!1);var c=this._orgLocalZOrderByPanel.get(g,this);null!=c&&(g.setLocalZOrder(c),this._orgLocalZOrderByPanel.del(g,this)),a&&g.hide()}else b8e.warn("模块"+h+"没有注册！")}else b8e.warn("界面描述"+s+"没有配置moduleName！")}else b8e.warn("界面描述"+s+"没有找到！")}0<n.useBianshenId&&(game.mainGui.mainui.getShapeBar().setSlot(),game.ShapeShiftMgr.inst().defaultShape()),this._currCommands.del(t),this._bindTrigger.del(t),this._needUpdateList.del(t),b8e.evt.dptG(game.CommandEvent.PREVENT_COMMAND,n)}else b8e.warn("命令"+t+"没有找到！")}else b8e.warn("命令"+t+"没有在执行中！")},triggerCommands:function(e){var t=e.triggerCommandIds;t?t.split(",").forEach(function(e){this.triggerCommandById(e)},this):b8e.warn("命令"+e.id+"没有配置触发命令！")},setWidgetState:function(e,t,i,n){if(0<t.viewDescId){var s=this._bindTrigger.get(t.id);if(s){var a=game.ccfg.ClientTriggerCfg.getDataById(s);a.triggerType==game.TriggerType.CLICK&&(n?i.onCommandClickTrigger||(i.onCommandClickTrigger=function(){0<t.functionOpenId&&!game.funcOpen.checkOpenWithTips(t.functionOpenId)||game.CommandMgr.inst().triggerCommands(t)},b8e.evt.offAllClickEvent(i),b8e.evt.onC(i,i.onCommandClickTrigger,i)):i.onCommandClickTrigger&&(b8e.evt.offC(i,i.onCommandClickTrigger,i),i.onCommandClickTrigger=null)),0<a.guideId&&(n?game.guide.triggerGuide(s,e,i):game.guide.removeGuide(s,e,i))}var o=t.widgetCloseStyle,r=t.widgetCloseStyleWhenPrevent;if(0<t.functionOpenId){var h=game.funcOpen.checkOpen(t.functionOpenId);if(n)if(h)i.active=!0,b8e.ShaderUtil.reset(i,!0);else if(o)switch(o){case"hide":i.active=!1;break;case"gray":b8e.ShaderUtil.setGray(i,!0)}else switch(r){case"hide":i.active=!0;break;case"gray":b8e.ShaderUtil.reset(i,!0)}else if(h)if(o)switch(o){case"hide":i.active=!0;break;case"gray":b8e.ShaderUtil.reset(i,!0)}else switch(r){case"hide":i.active=!1;break;case"gray":b8e.ShaderUtil.setGray(i,!0)}}else if(n);else switch(o){case"remove":i instanceof b8e.BaseDisplay&&i.release()}}},bindTrigger:function(e,t){this._bindTrigger.set(t,e)},onUpdate:function(){this._needUpdateList.forEach(function(e,t){this.processOption(t.cmdData,t.moduleName,t.panel,t.optionName,t.optionValue,!0)},this)},useEquipById:function(e,t){var i=game.back.getItemInfoById(t);if(i)switch(i.type){case game.GoodsType.WEAPON:case game.GoodsType.ARMOR:case game.GoodsType.BELT:case game.GoodsType.RING:case game.GoodsType.HELM:case game.GoodsType.NECKLACE:case game.GoodsType.LEGGUARD:case game.GoodsType.SHOE:game.equip.wearEquip(i)}},useGoodsById:function(e,t){var i=game.back.getItemInfoById(t);i&&game.back.useItem(i,i.num)},usePrizeById:function(e,t){}}),game.CommandMgr._instance=null,game.CommandMgr._singleton=!0,game.CommandMgr.inst=function(){return null==game.CommandMgr._instance&&(game.CommandMgr._singleton=!1,game.CommandMgr._instance=new game.CommandMgr,game.CommandMgr._singleton=!0),game.CommandMgr._instance}},{}],1081:[function(e,t,i){"use strict";game.DialogMgr=b8e.Object.extends({_currTriggerData:null,_currPlotData:null,ctor:function(){this._super()},triggerDialog:function(e){if(this._currTriggerData=null,this._currPlotData=null,e&&0<e.dialogId){var t=game.ccfg.DialogCfg.getDialogById(e.dialogId);t&&(this._currTriggerData=e,this.startDialog(t))}},pickNpcDialog:function(e){this._currTriggerData=null,this._currPlotData=null;var t=game.ccfg.NpcGenCfg.getNpcGenById(e);t&&game.MoveToHelper.inst().moveTo({x:t.pos.X,y:t.pos.Y},t.dialogRange,this._onPickMoveToNpcComplete,this,[t])},plotDialog:function(e){this._currTriggerData=null,this._currPlotData=null;var t=game.ccfg.DialogCfg.getDialogById(e.dialogId);t&&(this._currPlotData=e,this.startDialog(t))},questNpcDialog:function(e){var t=game.ccfg.NpcGenCfg.getNpcGenById(e);t&&game.MoveToHelper.inst().moveTo({x:t.pos.X,y:t.pos.Y},t.dialogRange,this._onQuestMoveToNpcComplete,this,[t])},_onPickMoveToNpcComplete:function(e){var t=null,i=game.quest.questInfo;i&&(0==i.completed&&i.conditionType==game.MainQuestType.TALK_WITH_NPC&&i.conditionParam1==e.id&&(t=game.ccfg.DialogCfg.getDialogByQuestId(i.id)));t||e.dialogId&&(t=game.ccfg.DialogCfg.getDialogById(e.dialogId)),this.startDialog(t,e)},_onQuestMoveToNpcComplete:function(e){var t=null,i=game.quest.questInfo;i&&(0==i.completed&&i.conditionType==game.MainQuestType.TALK_WITH_NPC&&i.conditionParam1==e.id&&(t=game.ccfg.DialogCfg.getDialogByQuestId(i.id)));this.startDialog(t,e)},startDialog:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e){var i=null;i=game.PlotMgr.inst().isPlaying()?b8e.layer.getTopLayer():b8e.layer.getGuiLayer(),game.app.show(game.AppConstant.DIALOG_PANEL,{diaCfg:e,npcCfg:t},i)}},stopDialog:function(){game.app.hide(game.AppConstant.DIALOG_PANEL),this._currTriggerData=null,this._currPlotData=null},completeDialog:function(e,t){if(t){var i=game.quest.questInfo;i&&0==i.completed&&i.conditionType==game.MainQuestType.TALK_WITH_NPC&&e.questId==i.id&&game.SceneSender.endTalkWithNpc(t.id)}(game.app.hide(game.AppConstant.DIALOG_PANEL),this._currTriggerData)?-1<this._currTriggerData.completeType.split(",").indexOf(game.TriggerCompleteType.DIALOG_COMPLETE)&&(game.TriggerMgr.inst().completeTrigger(this._currTriggerData),this._currTriggerData=null):this._currPlotData&&(game.PlotMgr.inst().storyLineNextPart(this._currPlotData),this._currPlotData=null)}}),game.DialogMgr._instance=null,game.DialogMgr._singleton=!0,game.DialogMgr.inst=function(){return null==game.DialogMgr._instance&&(game.DialogMgr._singleton=!1,game.DialogMgr._instance=new game.DialogMgr,game.DialogMgr._singleton=!0),game.DialogMgr._instance}},{}],1082:[function(e,t,i){"use strict";game.FunctionOpenMgr=b8e.Object.extends({ctor:function(){this._super()},checkOpen:function(e){var t=game.ccfg.ClientFunctionOpenCfg.getDataById(e);if(t){var i=game.mainRole.mainRoleData,n=i.getLv(),s=t.minLevel,a=t.maxLevel,o=0,r=game.quest.questInfo;r&&(o=r.sequence);var h=i.miscData.openServerDay,g=t.questId;if(r=0<g?game.ccfg.MainQuestCfg.getQuestById(g):null,s<=n&&(0==a||n<=a)&&(!r||o>r.sequence)&&(0==t.openServerDay||h>=t.openServerDay))return!0}else b8e.warn("功能开放"+e+"配置没有找到！");return!1},checkOpenWithTips:function(e){var t=this.checkOpen(e);if(!t){var i=game.ccfg.ClientFunctionOpenCfg.getDataById(e);if(i){var n="";n=i.closeTips;var s=game.mainRole.mainRoleData.miscData.openServerDay;if(a=i.openServerDay-s,0!=i.openServerDay&&0<a)n=game.ccfg.LangCfg.getText(25001,[a]);else if(-1<n.indexOf("{TaskDiffSeq}")){var a=0,o=0,r=game.quest.questInfo;r&&(o=r.sequence);var h=i.questId;a=((r=0<h?game.ccfg.MainQuestCfg.getQuestById(h):null)?r.sequence:0)-o+1,n=n.replace("{TaskDiffSeq}",a)}game.notice.show(n)}else game.notice.show("功能开放"+e+"配置没有找到！")}return t}}),game.FunctionOpenMgr._instance=null,game.FunctionOpenMgr._singleton=!0,game.FunctionOpenMgr.inst=function(){return null==game.FunctionOpenMgr._instance&&(game.FunctionOpenMgr._singleton=!1,game.FunctionOpenMgr._instance=new game.FunctionOpenMgr,game.FunctionOpenMgr._singleton=!0),game.FunctionOpenMgr._instance}},{}],1083:[function(e,t,i){"use strict";game.GuideMgr=b8e.Object.extends({_modalLeft:null,_modalRight:null,_modalTop:null,_modalBottom:null,_modalTarget:null,_targetWidgets:null,_targetWidgetRects:null,_currGuideViews:null,_guideViewPool:null,_currGuideDialogViews:null,_guideDialogViewPool:null,_currGuideBubbleViews:null,_guideBubbleViewPool:null,_currGuideFirstRechargeViews:null,_guideFirstRechargeViewPool:null,_currTriggerDatas:null,_currGuideDatas:null,_targetEffectAnims:null,_targetPanels:null,_orgLocalZOrderByPanel:null,_timer:null,ctor:function(){this._super(),this._currGuideDatas=b8e.HashMap.get(),this._currTriggerDatas=b8e.HashMap.get(),this._targetEffectAnims=b8e.HashMap.get(),this._currGuideDialogViews=b8e.HashMap.get(),this._guideDialogViewPool=[],this._currGuideViews=b8e.HashMap.get(),this._guideViewPool=[],this._currGuideBubbleViews=b8e.HashMap.get(),this._guideBubbleViewPool=[],this._currGuideFirstRechargeViews=b8e.HashMap.get(),this._guideFirstRechargeViewPool=[],this._targetWidgets=b8e.HashMap.get(),this._targetWidgetRects=b8e.HashMap.get(),this._targetPanels=b8e.HashMap.get(),this._orgLocalZOrderByPanel=b8e.HashMap.get(),this._modalLeft=b8e.Graphics.get(),b8e.evt.onC(this._modalLeft,this.onClickModal,this),this._modalRight=b8e.Graphics.get(),b8e.evt.onC(this._modalRight,this.onClickModal,this),this._modalTop=b8e.Graphics.get(),b8e.evt.onC(this._modalTop,this.onClickModal,this),this._modalBottom=b8e.Graphics.get(),b8e.evt.onC(this._modalBottom,this.onClickModal,this),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize,!1,-9999)},onClickModal:function(){this._currTriggerDatas.values().forEach(function(e){-1<e.completeType.split(",").indexOf(game.TriggerCompleteType.CLICK_MODAL)&&game.TriggerMgr.inst().completeTriggerById(e.id)},this)},modalGuide:function(e){this._modalTarget=e;var t=b8e.layer.getGuiLayer();this._modalLeft.setLocalZOrder(9999992),this._modalRight.setLocalZOrder(9999992),this._modalTop.setLocalZOrder(9999992),this._modalBottom.setLocalZOrder(9999992),t.addChild(this._modalLeft),t.addChild(this._modalRight),t.addChild(this._modalTop),t.addChild(this._modalBottom),this.resizeModal()},removeModalGuide:function(){this._modalTarget=null,this._modalLeft.clear(),this._modalLeft.removeFromParent(),this._modalRight.clear(),this._modalRight.removeFromParent(),this._modalTop.clear(),this._modalTop.removeFromParent(),this._modalBottom.clear(),this._modalBottom.removeFromParent()},onResize:function(){0<this._currTriggerDatas.count()&&(this.resizeModal(),this._currGuideDatas.forEach(function(e,t){this.updateGuideView(e)},this))},onUpdate:function(){0<this._targetWidgets.count()&&(this.resizeModal(),this._targetWidgets.forEach(function(e,t){var i=null;if(t instanceof cc.Node)i=b8e.CommonUtil.convertToStageSpace(t);else{if(!(t instanceof b8e.BaseDisplay))return;i=t.localToGlobal()}var n=this._targetWidgetRects.get(e);n.x==i.x&&n.y==i.y&&n.width==t.width&&n.height==t.height||(n.x=i.x,n.y=i.y,n.width=t.width,n.height=t.height,this.updateGuideView(e))},this))},resizeModal:function(){if(this._modalTarget){var e=2852126720,t=this._modalTarget.width,i=this._modalTarget.height,n=null;if(this._modalTarget instanceof cc.Node)n=b8e.CommonUtil.convertToStageSpace(this._modalTarget);else{if(!(this._modalTarget instanceof b8e.BaseDisplay))return;n=this._modalTarget.localToGlobal()}if(this._modalTarget instanceof cc.Node)this._modalTarget.getAnchorPoint();else{if(!(this._modalTarget instanceof b8e.BaseDisplay))return;this._modalTarget.getAnchor()}var s=n.x,a=n.y;this._modalLeft.setPosition(0,0),this._modalLeft.setSize(s,b8e.stageHeight),this._modalLeft.clear(),this._modalLeft.fillColor(e),this._modalLeft.fillRect(0,0,this._modalLeft.width,this._modalLeft.height),this._modalRight.setPosition(s+t,0),this._modalRight.setSize(b8e.stageWidth-t-s,b8e.stageHeight),this._modalRight.clear(),this._modalRight.fillColor(e),this._modalRight.fillRect(0,0,this._modalRight.width,this._modalRight.height),this._modalTop.setPosition(s,a+i),this._modalTop.setSize(t,b8e.stageHeight-i-a),this._modalTop.clear(),this._modalTop.fillColor(e),this._modalTop.fillRect(0,0,this._modalTop.width,this._modalTop.height),this._modalBottom.setPosition(s,0),this._modalBottom.setSize(t,a),this._modalBottom.clear(),this._modalBottom.fillColor(e),this._modalBottom.fillRect(0,0,this._modalBottom.width,this._modalBottom.height)}},triggerGuide:function(e,t,i){if(!this._currTriggerDatas.get(e)&&!this._currGuideDatas.get(e)){var n=game.ccfg.ClientTriggerCfg.getDataById(e);if(n){var s=game.ccfg.ClientGuideCfg.getDataById(n.guideId);if(s){if(this._targetPanels.set(e,t),s.isModal)void 0===this._orgLocalZOrderByPanel.get(t,this)&&this._orgLocalZOrderByPanel.set(t,t.getLocalZOrder(),this),t.setLocalZOrder(9999990);this._targetWidgets.set(e,i);this._targetWidgetRects.set(e,{x:0,y:0,width:0,height:0}),this._currTriggerDatas.set(e,n),this._currGuideDatas.set(e,s),-1<n.completeType.split(",").indexOf(game.TriggerCompleteType.CLICK)&&(i.onGuideClickTrigger||(i.onGuideClickTrigger=function(){game.TriggerMgr.inst().completeTriggerById(e)},b8e.evt.onC(i,i.onGuideClickTrigger,i,1e3))),this.showGuideView(t,i,e,s),this._timer||(this._timer=b8e.Timer.add(this,this.onUpdate,200)),this._timer.reset(),this._timer.start()}else b8e.warn("指引"+n.guideId+"没有找到！")}}},removeGuide:function(e,t,i){if(this._currTriggerDatas.get(e)){var n=this._currGuideDatas.get(e);if(n){if(i.onGuideClickTrigger&&(b8e.evt.offC(i,i.onGuideClickTrigger,i),i.onGuideClickTrigger=null),this._targetPanels.del(e),n.isModal){var s=this._orgLocalZOrderByPanel.get(t,this);null!=s&&(t.setLocalZOrder(s),this._orgLocalZOrderByPanel.del(t,this))}this._modalTarget==i&&this.removeModalGuide();var a=this._currGuideViews.get(e);a&&(a.removeRefreshCallback(this.onGuideViewRefresh,this),a.hide(),a.removeFromParent(),this._currGuideViews.del(e),this._guideViewPool.push(a));var o=this._currGuideDialogViews.get(e);o&&(o.removeRefreshCallback(this.onGuideViewRefresh,this),o.hide(),o.removeFromParent(),this._currGuideDialogViews.del(e),this._guideDialogViewPool.push(o));var r=this._currGuideBubbleViews.get(e);r&&(r.removeRefreshCallback(this.onGuideViewRefresh,this),r.hide(),r.removeFromParent(),this._currGuideBubbleViews.del(e),this._guideBubbleViewPool.push(r));var h=this._currGuideFirstRechargeViews.get(e);h&&(h.removeRefreshCallback(this.onGuideViewRefresh,this),h.hide(),h.removeFromParent(),this._currGuideFirstRechargeViews.del(e),this._guideFirstRechargeViewPool.push(h));var g=this._targetEffectAnims.get(e);g&&(g.release(),this._targetEffectAnims.del(e)),this._targetWidgets.del(e),this._targetWidgetRects.del(e),this._currTriggerDatas.del(e),this._currGuideDatas.del(e),this._currTriggerDatas.count()<1&&this._timer&&this._timer.stop()}}},onGuideViewRefresh:function(i){i instanceof game.GuideView?this._currGuideViews.every(function(e,t){return i!=t||(this._modalTarget==this._targetWidgets.get(e)&&this.resizeModal(),this.updateGuideView(e),!1)},this):i instanceof game.GuideDialogView?this._currGuideDialogViews.every(function(e,t){return i!=t||(this._modalTarget==this._targetWidgets.get(e)&&this.resizeModal(),this.updateGuideView(e),!1)},this):i instanceof game.GuideBubbleView?this._currGuideBubbleViews.every(function(e,t){return i!=t||(this._modalTarget==this._targetWidgets.get(e)&&this.resizeModal(),this.updateGuideView(e),!1)},this):i instanceof game.GuideFirstRechargeView&&this._currGuideFirstRechargeViews.every(function(e,t){return i!=t||(this._modalTarget==this._targetWidgets.get(e)&&this.resizeModal(),this.updateGuideView(e),!1)},this)},showGuideView:function(e,t,i,n){n.isModal&&this.modalGuide(t);var s=n.direction,a=n.guideViewType;if(a)if("guide_view"==a){var o=this._guideViewPool.pop();o||(o=new game.GuideView),o.addRefreshCallback(this.onGuideViewRefresh,this),o.data={content:n.description},o.setLocalZOrder(9999998),o.show(),this._currGuideViews.set(i,o)}else if("guide_dialog_view"==a)if(s&&"top"!=s&&"bottom"!=s)b8e.warn("不支持的指引界面方向："+s);else{var r=this._guideDialogViewPool.pop();r||(r=new game.GuideDialogView),r.addRefreshCallback(this.onGuideViewRefresh,this),r.data={content:n.description},r.setLocalZOrder(9999997),r.show(),this._currGuideDialogViews.set(i,r)}else if("guide_bubble_view"==a){var h=this._guideBubbleViewPool.pop();h||(h=new game.GuideBubbleView),h.addRefreshCallback(this.onGuideViewRefresh,this),h.data={content:n.description,direction:n.direction},h.setLocalZOrder(9999996),h.show(),this._currGuideBubbleViews.set(i,h)}else if("guide_first_recharge_view"==a){var g=this._guideFirstRechargeViewPool.pop();g||(g=new game.GuideFirstRechargeView),g.addRefreshCallback(this.onGuideViewRefresh,this),g.data={content:n.description,direction:n.direction},g.setLocalZOrder(9999995),g.show(),this._currGuideFirstRechargeViews.set(i,g)}else b8e.warn("未知的指引界面类型："+a);var l=n.targetEffect;if(l){var c=game.ClientCfg.getUIFxs(l),u=this._targetEffectAnims.get(i);u||(u=b8e.Animator.get(),this._targetEffectAnims.set(i,u)),u.load(c),u.play(),u.setLocalZOrder(9999996)}this.updateGuideView(i)},updateGuideView:function(e){var t,i=this._currGuideDatas.get(e),n=this._targetWidgets.get(e),s=n.width,a=n.height,o=null,r=!1;if(n instanceof cc.Node)o=b8e.CommonUtil.convertToStageSpace(n),n.getAnchorPoint(),r=n._activeInHierarchy;else{if(!(n instanceof b8e.BaseDisplay))return;o=n.localToGlobal(),n.getAnchor(),r=n._hierarchyVisible}var h=this._currGuideViews.get(e),g=this._currGuideDialogViews.get(e),l=this._currGuideBubbleViews.get(e),c=this._currGuideFirstRechargeViews.get(e),u=this._targetEffectAnims.get(e);if(r){var m=b8e.layer.getGuiLayer(),_=this._targetPanels.get(e);h&&(i.isModal?m.addChild(h):_.addChild(h)),g&&(i.isModal?m.addChild(g):_.addChild(g)),l&&(i.isModal?m.addChild(l):_.addChild(l)),c&&(i.isModal?m.addChild(c):_.addChild(c)),u&&(i.isModal?m.addChild(u):_.addChild(u));var d,f,p,S,T,I,v,A,C=o.x,E=o.y,b=i.guideViewOffset,y=i.direction;if("top"!=y&&"bottom"!=y&&"left"!=y&&"right"!=y&&"left_top"!=y&&"right_top"!=y&&"left_bottom"!=y&&"right_bottom"!=y&&(y="top"),"top"==y||"left_top"==y||"right_top"==y?(h&&(d=C+.5*(s-h.width),"left_top"==y?d-=b.X:"right_top"==y&&(d+=b.X),f=E+a+b.Y),g&&(p=.5*(b8e.stageWidth-g.width),"left_top"==y?p-=b.X:"right_top"==y&&(p+=b.X),S=E+a+b.Y),l&&(T=C+.5*(s-l.width),"left_top"==y?T-=b.X:"right_top"==y&&(T+=b.X),I=E+a+b.Y)):"bottom"==y||"left_bottom"==y||"right_bottom"==y?(h&&(d=C+.5*(s-h.width),"left_bottom"==y?d-=b.X:"right_bottom"==y&&(d+=b.X),f=E-h.height-b.Y),g&&(p=.5*(b8e.stageWidth-g.width),"left_bottom"==y?p-=b.X:"right_bottom"==y&&(p+=b.X),S=E-g.height-b.Y),l&&(T=C+.5*(s-l.width),"left_bottom"==y?T-=b.X:"right_bottom"==y&&(T+=b.X),I=E-l.height-b.Y)):"left"==y?(h&&(d=C-h.width-b.X,f=E+.5*(a-h.height)),l&&(T=C-l.width-b.X,I=E+.5*(a-l.height))):"right"==y&&(h&&(d=C+s+b.X,f=E+.5*(a-h.height)),l&&(T=C+s+b.X,I=E+.5*(a-l.height)),c&&(v=C+s+b.X,A=E+.5*(a-c.height)-b.Y)),h&&(i.isModal||(d-=(t=h.parent.localToGlobal()).x,f-=t.y),h.setPosition(d,f)),g&&(i.isModal||(p-=(t=g.parent.localToGlobal()).x,S-=t.y),g.setPosition(p,S)),l&&(i.isModal||(T-=(t=l.parent.localToGlobal()).x,I-=t.y),l.setPosition(T,I)),c&&(i.isModal||(v-=(t=c.parent.localToGlobal()).x,A-=t.y),c.setPosition(v,A)),u){var k=i.targetEffectOffset;t=u.parent.localToGlobal();var R=C+.5*s+k.X,N=E+.5*a+k.Y;i.isModal||(R-=t.x,N-=t.y),u.setPosition(R,N)}}else h&&h.removeFromParent(),g&&g.removeFromParent(),l&&l.removeFromParent(),c&&c.removeFromParent(),u&&u.removeFromParent()}}),game.GuideMgr._instance=null,game.GuideMgr.inst=function(){return null==game.GuideMgr._instance&&(game.GuideMgr._instance=new game.GuideMgr),game.GuideMgr._instance}},{}],1084:[function(e,t,i){"use strict";game.PerfMgr=b8e.Object.extends({_timer:null,_fpsLessCount:0,_setttingFps:0,level:2,_lastLeve:2,ctor:function(){this._super()},stop:function(){0!=b8e.isMobile&&(this._timer&&this._timer.stop(),this._fpsLessCount=0)},reset:function(){0!=b8e.isMobile&&(this._timer||(this._timer=b8e.Timer.add(this,this.onTimer,500,0,0)),this._timer.reset(),this._timer.start(),this._fpsLessCount=0,this.level=game.PerfMgr.Level.LOW)},setFrameRate:function(e){this._setttingFps=e,this._fpsLessCount=0,b8e.startup.setFrameRate(e)},onTimer:function(){if(b8e.isActivated){var e=b8e.Ticker.getFps();30==this._setttingFps?e<15?(this._fpsLessCount++,10<this._fpsLessCount&&(this.level=game.PerfMgr.Level.LOW)):this._fpsLessCount<=0?this.level=game.PerfMgr.Level.HIGH:this._fpsLessCount--:e<30?(this._fpsLessCount++,10<this._fpsLessCount&&(this.level=game.PerfMgr.Level.LOW)):this._fpsLessCount<=0?this.level=game.PerfMgr.Level.HIGH:this._fpsLessCount--,this._lastLeve!==this.level&&(this._lastLeve=this.level)}else this._fpsLessCount=0}}),game.PerfMgr.Level=engine.Enum({LOW:1,HIGH:2}),game.PerEvents=b8e.Enum({PER_CHANGE_QUAILTY:b8e.Event.nextCode()}),game.PerfMgr._instance=null,game.PerfMgr._singleton=!0,game.PerfMgr.inst=function(){return null==game.PerfMgr._instance&&(game.PerfMgr._singleton=!1,game.PerfMgr._instance=new game.PerfMgr,game.PerfMgr._singleton=!0),game.PerfMgr._instance}},{}],1085:[function(e,t,i){"use strict";game.PlotMgr=b8e.Object.extends({_triggerData:null,_rootPlotId:0,_plotLayer:null,_imageByUrl:null,_effectByUrl:null,_screenEffectByUrl:null,_tweenByPlotId:null,_currStoryLines:null,_modalGrah:null,_maskGraphs:null,_skipButton:null,_skipPlotData:null,_progressPlotData:null,_currSkipToLine:0,_currScenePlot:null,_isPlaying:!1,_orgMainRoleBaseSpriteStat:null,_orgMainRoleSpriteStat:null,_playToProgress:0,ctor:function(){this._super(),this._plotLayer=b8e.BaseDisplay.get(),this._imageByUrl=b8e.HashMap.get(),this._effectByUrl=b8e.HashMap.get(),this._screenEffectByUrl=b8e.HashMap.get(),this._tweenByPlotId=b8e.HashMap.get(),this._currStoryLines=[],this._maskGraphs=[],b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onResize,!1,-9999),this._modalGrah=b8e.Graphics.get(),this._modalGrah.setPosition(0,0),this._plotLayer.addChild(this._modalGrah),b8e.evt.onC(this._plotLayer,this.onClickLayer,this)},onClickLayer:function(){this._skipPlotData&&(this._currSkipToLine=this._skipPlotData.skipToLine,this.playStoryLine(this._skipPlotData.id))},modalGrahUpdate:function(){this._modalGrah.clear(),this._modalGrah.fillColor(new cc.Color({r:0,g:0,b:0,a:255*this._modalGrah.alpha})),this._modalGrah.fillRect(0,0,b8e.stageWidth,b8e.stageHeight),this._modalGrah.setSize(b8e.stageWidth,b8e.stageHeight)},isPlaying:function(){return this._isPlaying},onResize:function(){this._triggerData&&(this._plotLayer.setSize(b8e.stageWidth,b8e.stageHeight),this._imageByUrl.forEach(function(e,t){this.updateScreenDisplayPos(t,t.width,t.height)},this),this.modalGrahUpdate(),this._screenEffectByUrl.forEach(function(e,t){this.updateScreenDisplayPos(t)},this),this._skipButton&&this._skipButton.setPosition(b8e.stageWidth-170,b8e.stageHeight-80))},triggerPlot:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._isPlaying)b8e.warn("剧情正在播放中试图再次播放！");else{0==t&&game.sdk.sceneLog("1：开始播放剧情"),this.stopPlot(),this._triggerData=e;var i=b8e.layer.getTopLayer();i.addChild(this._plotLayer),this._skipButton||(this._skipButton=b8e.Sprite.get(),this._skipButton.loadTexture(game.ClientCfg.IMAGE_URL+"plot/plot1013.png",null,null,{useManifest:!1}),b8e.evt.onC(this._skipButton,this.onClickSkipButton,this)),i.addChild(this._skipButton),this._isPlaying=!0,this._playToProgress=t,game.SceneMgr.inst().updateRenderNum(),b8e.scene.getCamera().setMode(b8e.SceneCamera.ThirdPersonMode);var n=game.mainRole.mainRoleData;this._orgMainRoleBaseSpriteStat=n.baseSpriteStat,this._orgMainRoleSpriteStat=n.spriteStat,n.baseSpriteStat=this._orgMainRoleBaseSpriteStat.clone(),n.spriteStat=this._orgMainRoleSpriteStat.clone(),game.skill.initSpell(),game.MoveToHelper.inst().stopMove(),game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().stop(),game.FightTargetMgr.inst().stop(),game.SceneMgr.inst().updateSceneShowState();var s=game.mainRole.mainRoleEntity;s.getStateMachine().removeState(game.RoleStateType.CONTROL_RIDE),game.AvatarUtil.updateAvatar(s),s.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),game.mainGui.mainui.getShapeBar().setSlot(),b8e.layer.getGuiLayer().setVisible(!1),this._skipButton.setVisible(!1),this._skipButton.setPosition(b8e.stageWidth-170,b8e.stageHeight-80),this._skipButton.setLocalZOrder(99999),this._modalGrah.alpha=0,this._plotLayer.setSize(b8e.stageWidth,b8e.stageHeight),this.modalGrahUpdate(),this.playPlot(this._triggerData.plotId)}},onClickSkipButton:function(){this._skipButton&&this._skipButton.removeFromParent(),this._progressPlotData&&(this._playToProgress=1e7,this.playStoryLine(this._progressPlotData.id))},playPlot:function(e){this._isPlaying&&(this._rootPlotId=e,this._skipPlotData=null,this._progressPlotData=null,this._currSkipToLine=0,this.parsePreload(this._rootPlotId),this.parseStoryLine(this._rootPlotId))},parsePreload:function(t){if(this._isPlaying){var e=game.ccfg.ClientPlotCfg.getDataById(t);if(e)if(e.storyLine)e.storyLine.split(",").forEach(function(e){e!=t&&this.resPreload(parseInt(e))},this)}},resPreload:function(e){var t=game.ccfg.ClientPlotCfg.getDataById(e);if(t){var i=0;if(0<t.progress&&(i=this._playToProgress,t.progress>=i&&(i=0)),i<1){var n=t.effectResName,s=t.addSceneEffectRes,a=t.addScreenEffectRes,o=t.addSceneImageRes;if(o&&!this._imageByUrl.get(o)){var r=b8e.Sprite.get();this._imageByUrl.set(o,r),r.loadTexture(game.ClientCfg.IMAGE_URL+"plot/"+o,null,null,{useManifest:!1})}if(s&&n&&!this._effectByUrl.get(n)){var h=game.ClientCfg.getAnimation(s),g=b8e.SceneEntity.get(),l=g.addAnimator(1,1);this._effectByUrl.set(n,g),l.load(h,null,null,{preload:!0})}if(a&&n&&!this._screenEffectByUrl.get(n)){var c=game.ClientCfg.getAnimation(a),u=b8e.SceneEntity.get(),m=u.addAnimator(1,1);this._screenEffectByUrl.set(n,u),m.load(c,null,null,{preload:!0})}t.playBgm&&b8e.sound.preload(b8e.SoundMgr.BACKGROUND_MUSIC_DIR+"/"+t.playBgm),t.playEax&&b8e.sound.preload(b8e.SoundMgr.ENVIRONMENT_AUDIO_DIR+"/"+t.playEax),t.playEs&&t.playEsName&&b8e.sound.preload(b8e.SoundMgr.EFFECT_SOUND_DIR+"/"+t.playEs)}}this.parsePreload(e)},parseStoryLine:function(t){if(this._isPlaying){var i=game.ccfg.ClientPlotCfg.getDataById(t);if(!i)return b8e.warn("剧情"+t+"没有找到"),void this.stopPlot();var e=this._currStoryLines.indexOf(t);if(-1<e&&this._currStoryLines.splice(e,1),i.storyLine)i.storyLine.split(",").forEach(function(e){e==t?b8e.warn("剧情"+t+"存在和ID相同的剧情线ID！"+i.storyLine):this.playStoryLine(parseInt(e))},this);else this._currStoryLines.length<1&&this.stopPlot()}},playStoryLine:function(e){if(this._isPlaying){var n=game.ccfg.ClientPlotCfg.getDataById(e);if(n){var t=this._tweenByPlotId.get(e);t&&(t.kill(),this._tweenByPlotId.del(e));var i=0;0<n.progress?(this._progressPlotData=n,i=this._playToProgress,n.progress>=i&&(this._playToProgress=i=0),this._skipButton.setVisible(!0)):(this._progressPlotData=null,this._skipButton.setVisible(!1)),0<n.skipToLine?this._skipPlotData=n:this._skipPlotData=null;var s=!0,a=!1;if(this._skipPlotData&&0<this._currSkipToLine&&this._skipPlotData.id!=this._currSkipToLine?a=!0:this._currSkipToLine=0,this._currStoryLines.indexOf(e)<0&&this._currStoryLines.push(e),0<n.sceneId)return this._currScenePlot=n,void(game.SceneMgr.inst().isFirstEnterScene||game.mainProcess.runSceneProcess());if(0<n.jumpHeight){var o=game.mainRole.mainRoleEntity;if(0<i)game.MoveToHelper.inst().stopMove(),o.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),o.setScenePosition(n.jumpToX,n.jumpToY);else{var r=o.getStateRef(game.JumpStateReference);r.setParams({x:n.jumpToX,y:n.jumpToY},100,n.jumpUpTime,n.jumpDownTime,n.jumpHeight,n.ghostSpacing,n.ghostDuration),o.transitionState(game.RoleStateType.ACTION_JUMP,r)}}if(n.useBianshenId){var h=game.mainRole.mainRoleData,g=0,l=n.useBianshenId.split("|");if(h.sex==game.Sex.WOMAN&&(g=Number(l[1])),g||(g=Number(l[0])),g){var c=game.ccfg.HeroCfg.getHeroCfgById(g);if(c){var u={};u.modelId=g,u.bodyRes=c.resID,0<n.useWingId&&(u.wingResId=n.useWingId),0<n.useMountId&&(u.mountResId=n.useMountId),0<n.useFaBaoId&&(u.faBaoResId=n.useFaBaoId);var m=game.mainRole.mainRoleEntity,_=m.getStateMachine();0<u.mountResId?m.transitionState(game.RoleStateType.CONTROL_RIDE):_.removeState(game.RoleStateType.CONTROL_RIDE),game.AvatarUtil.updateAvatar(m,u),h.spriteStat=this._orgMainRoleSpriteStat.clone(),h.baseSpriteStat=this._orgMainRoleBaseSpriteStat.clone();var d=game.ccfg.BianshenCfg.getBianshenCfgById(g);if(d){var f=game.ccfg.SpriteStatCfg.getSpriteStatById(d.attr);h.baseSpriteStat.setStatValue(game.SpriteStatType.ATK,f.getStatValue(game.SpriteStatType.ATK)),h.baseSpriteStat.setStatValue(game.SpriteStatType.DEF,f.getStatValue(game.SpriteStatType.DEF)),h.spriteStat.setStatValue(game.SpriteStatType.MAXHP,f.getStatValue(game.SpriteStatType.MAXHP))}h.spriteStat.setStatValue(game.SpriteStatType.HP,h.spriteStat.getStatValue(game.SpriteStatType.MAXHP)),m.getStateMachine().isDeadState()&&m.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),game.skill.initSpell(u),m.updateHpBar(),n.showBianshenShiftFx?game.ShapeShiftMgr.inst().showShapeShiftFx(m,g):game.ShapeShiftMgr.inst().playEffect(m)}}}if(0<n.dialogId&&(0<i?game.DialogMgr.inst().stopDialog():(a=s=!1,game.DialogMgr.inst().plotDialog(n))),0<n.collectId&&(0<i?game.collect.hide():game.collect.show(n.collectId,n.animTime)),n.genMonsterType)n.genMonsterType.split("|").forEach(function(e){var t=game.ccfg.ClientMonsterGenCfg.getListByGenType(e);t&&t.forEach(function(e){b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e.id)?0<i||b8e.warn("剧情怪物ID:"+e.id+"已经存在！"):game.sceneRole.createClientMonster(e)},this)},this);else if(n.delMonsterType){n.delMonsterType.split("|").forEach(function(e){var t=game.ccfg.ClientMonsterGenCfg.getListByGenType(e);t&&t.forEach(function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e.id);t&&t.release()},this)},this)}if(n.attackMeMonsterType){var p=n.attackMeMonsterType.split("|"),S=n.chaseMeMonsterType.split("|");if(p.forEach(function(n){var e=game.ccfg.ClientMonsterGenCfg.getListByGenType(n);e&&e.forEach(function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e.id);if(t){var i=t.getAiMachine();i.autoRun(),-1<S.indexOf(n)?i.autoChase=!0:i.autoChase=!1}},this)},this),n.killMeComplete){var T=game.mainRole.mainRoleEntity;if(0<i)n.killMeTween&&(n.killMeTween.kill(),n.killMeTween=null);else{var I=b8e.Tween.get(T,{loop:!0}).wait(200).call(function(){T.getStateMachine().isDeadState()&&(I.kill(),n.killMeTween=null,this.storyLineNextPart(n))},this);n.killMeTween=I,a=s=!1}}}else if(n.unattackMeMonsterType){n.unattackMeMonsterType.split("|").forEach(function(e){var t=game.ccfg.ClientMonsterGenCfg.getListByGenType(e);t&&t.forEach(function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e.id);t&&t.getAiMachine().clear()},this)},this)}if(n.attackMonsterType){var v=n.attackMonsterType.split("|"),A=[];if(v.forEach(function(e){var t=game.ccfg.ClientMonsterGenCfg.getListByGenType(e);t&&t.forEach(function(e){A.push(e.id)},this)},this),0<A.length){game.ScenePickMgr.inst().pickTarget(null);var C=game.TrusteeshipMgr.inst();C.start(0,!1),C.setTargets(A)}if(0<i);else if(n.killMonsterTypeComplete)A=[],n.killMonsterTypeComplete.split("|").forEach(function(e){var t=game.ccfg.ClientMonsterGenCfg.getListByGenType(e);t&&t.forEach(function(e){var t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e.id);t&&!t.getStateMachine().isDeadState()&&(A.push(t.id),t.addReleaseCallback(function(){var e=A.indexOf(t.id);-1<e&&(A.splice(e,1),A.length<1&&this.storyLineNextPart(n))},this))},this)},this),0<A.length&&(a=s=!1)}else if(n.stopAttackMonster){game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().stop()}if(n.walkToPos&&0<n.walkToPos.X&&0<n.walkToPos.Y){var E={x:n.walkToPos.X,y:n.walkToPos.Y};if(0<i){var b=game.mainRole.mainRoleEntity;game.MoveToHelper.inst().stopMove(),b.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),b.setScenePosition(E.x,E.y)}else game.MoveToHelper.inst().selfMoveTo(E)}if(n.battleSlotBianshenId){var y=n.battleSlotBianshenId.split("|"),k=[];y.forEach(function(e){var t=new game.BianshenBattleSlotInfo;t.index=0,t.isUnlocked=!0,t.bianshenId=t.dataId=Number(e),k.push(t)},this),game.mainGui.mainui.getShapeBar().setSlotInfos(k)}if(0<n.triggerId&&(0<i?game.TriggerMgr.inst().completeTriggerByPlot(n):(game.TriggerMgr.inst().triggerByPlot(n),a=s=!1)),n.cameraFocusPos&&0<n.cameraFocusPos.X&&0<n.cameraFocusPos.Y?(b8e.scene.getCamera().setMode(b8e.SceneCamera.FirstPersonMode),b8e.scene.getCamera().setFocus(n.cameraFocusPos.X,n.cameraFocusPos.Y,n.cameraTransitionTime)):b8e.scene.getCamera().setMode(b8e.SceneCamera.ThirdPersonMode),n.playBgm?b8e.sound.playBackgroundMusic(b8e.SoundMgr.BACKGROUND_MUSIC_DIR+"/"+n.playBgm):n.stopBgm&&b8e.sound.stopBackgroundMusic(),n.playEax?b8e.sound.playEnvironmentAudio(b8e.SoundMgr.ENVIRONMENT_AUDIO_DIR+"/"+n.playEax):n.stopEax&&b8e.sound.stopEnvironmentAudio(),n.playEs&&n.playEsName?b8e.sound.playEffectSound(b8e.SoundMgr.EFFECT_SOUND_DIR+"/"+n.playEs,n.playEsName):n.stopEsName&&b8e.sound.stopEffectSound(n.stopEsName),1==n.veilEffectType){b8e.Tween.kill(this._modalGrah);var R=n.veilEffectAlpha/255;this.modalGrahUpdate(),!a&&0<n.animTime?b8e.Tween.get(this._modalGrah,{onUpdate:this.modalGrahUpdate,onUpdateThis:this}).to({alpha:R},n.animTime):(this._modalGrah.alpha=R,this.modalGrahUpdate())}else 2==n.veilEffectType&&(b8e.Tween.kill(this._modalGrah),!a&&0<n.animTime?b8e.Tween.get(this._modalGrah,{onUpdate:this.modalGrahUpdate,onUpdateThis:this}).to({alpha:0},n.animTime):(this._modalGrah.alpha=0,this.modalGrahUpdate()));var N,B=n.sceneImageUnmask;if(B)for(var P=B.split(","),L=P.length,G=0;G<L;G++){var M=parseInt(P[G]),D=this._maskGraphs[M];D&&(b8e.Tween.kill(D),i<1&&!a&&0<n.animTime?b8e.Tween.get(D,{onUpdate:function(){this.clear(),this.fillColor(new cc.Color({r:0,g:0,b:0,a:255*this.alpha})),this.fillRect(0,0,this.width,this.height)},onUpdateThis:D}).to({alpha:0},n.animTime):(D.alpha=0,D.clear()))}if(n.hidePlayer)(w=game.mainRole.mainRoleEntity)&&w.setVisible(!1);else if(n.showPlayer){var w;(w=game.mainRole.mainRoleEntity)&&w.setVisible(!0)}0<n.shakeSpace&&0<n.shakeCount&&(0<i||game.SpellReleaseHelper.inst().shake(n.shakeSpace,n.shakeCount));var O,U=n.targetSceneImageRes;if(U&&(N=this._imageByUrl.get(U))){b8e.Tween.kill(N);var x=n.targetSceneImageAlpha,H=n.targetSceneImageOffsetX,F=n.targetSceneImageOffsetY,q=0<n.targetSceneImageScale?.01*n.targetSceneImageScale:1,W=x/255;i<1&&!a&&0<n.animTime?b8e.Tween.get(N).to({alpha:W,offsetX:H,offsetY:F,scaleX:q,scaleY:q},n.animTime):(N.alpha=W,N.offsetX=H,N.offsetY=F,N.scaleX=q,N.scaleY=q)}var z=n.effectResName,V=n.addSceneEffectRes,Q=n.addScreenEffectRes,Y=n.addSceneImageRes,Z=n.removeSceneEffectResName,K=n.removeScreenEffectResName,j=n.removeSceneImageRes;if(Y&&(N=this._imageByUrl.get(Y))&&(this._plotLayer.addChild(N),N.loadTexture(game.ClientCfg.IMAGE_URL+"plot/"+Y,function(){var e=n.imageEffectOffsetX,t=n.imageEffectOffsetY,i=n.imageEffectDirection;N._plotLayerOffsetX=e,N._plotLayerOffsetY=t,N._plotLayerDirection=i,this.updateScreenDisplayPos(N,N.width,N.height)},this,{useManifest:!1})),V&&z&&(O=this._effectByUrl.get(z))){var X=O.getAnimator(1,1),J=n.sceneEffectPos,$=b8e.scene.sceneUIToGLPos(J.X,J.Y);O.setPosition($.x,$.y),b8e.scene.addDisplay(O,void 0,!1,!1,!1);var ee=game.ClientCfg.getAnimation(V);X.load(ee,function(e,t){t.play()},this,{preload:!0})}if(Q&&z&&(O=this._screenEffectByUrl.get(z))){X=O.getAnimator(1,1);var te=n.screenEffectOffsetX,ie=n.screenEffectOffsetY,ne=n.screenEffectDirection;O._plotLayerOffsetX=te,O._plotLayerOffsetY=ie,O._plotLayerDirection=ne,this.updateScreenDisplayPos(O),O.setLocalZOrder(99999),this._plotLayer.addChild(O);ee=game.ClientCfg.getAnimation(Q);X.load(ee,function(e,t){t.play()},this,{preload:!0})}j&&(N=this._imageByUrl.get(j))&&(b8e.Tween.kill(N),N.release(),this._imageByUrl.del(j),this._maskGraphs.forEach(function(e){b8e.Tween.kill(e),e.release()},this),this._maskGraphs.length=0),Z&&(O=this._effectByUrl.get(Z))&&(O.release(),this._effectByUrl.del(Z)),K&&(O=this._screenEffectByUrl.get(K))&&(O.release(),this._screenEffectByUrl.del(K)),s&&this.storyLineNextPart(n,a)}else b8e.error("剧情"+e+"没有找到")}},updateScreenDisplayPos:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n={x:.5*(this._plotLayer.width-t),y:.5*(this._plotLayer.height-i)};switch(e._plotLayerDirection){case"top":n.y=this._plotLayer.height-i;break;case"bottom":n.y=0;break;case"left":n.x=0;break;case"right":n.x=this._plotLayer.width-t;break;case"left_top":n.x=0,n.y=this._plotLayer.height-i;break;case"right_top":n.x=this._plotLayer.width-t,n.y=this._plotLayer.height-i;break;case"left_bottom":n.x=0,n.y=0;break;case"right_bottom":n.x=this._plotLayer.width-t,n.y=0}n.x+=e._plotLayerOffsetX?e._plotLayerOffsetX:0,n.y+=e._plotLayerOffsetY?e._plotLayerOffsetY:0,e.setPosition(n.x,n.y)},storyLineNextPart:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._isPlaying){var i=e.addSceneImageRes,n=this._imageByUrl.get(i);if(n){var s=e.sceneImageMask;if(s)s.split(";").forEach(function(e){var t=e.split(","),i=b8e.Graphics.get();i.alpha=1,i.setSize(parseInt(t[2]),parseInt(t[3])),i.fillColor(new cc.Color({r:0,g:0,b:0,a:255*i.alpha})),i.fillRect(0,0,i.width,i.height),n.addChild(i),i.setPosition(parseInt(t[0]),n.height-parseInt(t[1])-parseInt(t[3])),this._maskGraphs.push(i)},this)}if(b8e.Tween.kill(e),t)this.parseStoryLine(e.id);else if(this._playToProgress<1&&0<e.duration){var a=b8e.Tween.get(e).wait(e.duration).call(this.completeStoryLine,this,[e]);this._tweenByPlotId.set(e.id,a)}else this.completeStoryLine(e)}},completeStoryLine:function(e){this._isPlaying&&(this._playToProgress<1&&this._triggerData&&game.TriggerMgr.inst().setTriggerProgress(this._triggerData,e.progress),this.parseStoryLine(e.id))},getCurrScenePlot:function(){return this._currScenePlot},stopPlot:function(){if(this._isPlaying){this._tweenByPlotId.forEach(function(e,t){t.kill()},this),this._tweenByPlotId.clear(),this._imageByUrl.forEach(function(e,t){b8e.Tween.kill(t),b8e.Sprite.put(t)},this),this._imageByUrl.clear(),this._effectByUrl.forEach(function(e,t){t.release()},this),this._effectByUrl.clear(),this._screenEffectByUrl.forEach(function(e,t){t.release()},this),this._screenEffectByUrl.clear(),this._skipButton&&this._skipButton.removeFromParent(),this._modalGrah.alpha=0,this._modalGrah.clear(),this._maskGraphs.forEach(function(e){b8e.Tween.kill(e),e.release()},this),this._maskGraphs.length=0,b8e.Tween.kill(this._modalGrah),this._rootPlotId=0,this._skipPlotData=null,this._progressPlotData=null,this._currSkipToLine=0,this._plotLayer.removeFromParent();var e=game.mainRole.mainRoleEntity;e&&e.setVisible(!0),this._currScenePlot=null,this._isPlaying=!1,this._playToProgress=0,game.SceneMgr.inst().updateRenderNum(),b8e.scene.getCamera().setMode(b8e.SceneCamera.ThirdPersonMode);var t=game.mainRole.mainRoleData;t.baseSpriteStat=this._orgMainRoleBaseSpriteStat,t.spriteStat=this._orgMainRoleSpriteStat,game.skill.initSpell(),game.MoveToHelper.inst().stopMove(),game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().stop(),game.FightTargetMgr.inst().stop(),game.SceneMgr.inst().updateSceneShowState();var i=game.mainRole.mainRoleEntity;if(i.getStateMachine().removeState(game.RoleStateType.CONTROL_RIDE),game.AvatarUtil.updateAvatar(i),i.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),i.updateHpBar(),game.mainGui.mainui.getShapeBar().setSlot(),b8e.layer.getGuiLayer().setVisible(!0),game.mainGui.showMainUI(),this._triggerData){var n=this._triggerData;this._triggerData=null,game.TriggerMgr.inst().completeTrigger(n),n=null}game.mainProcess.runSceneProcess()}}}),game.PlotMgr._instance=null,game.PlotMgr._singleton=!0,game.PlotMgr.inst=function(){return null==game.PlotMgr._instance&&(game.PlotMgr._singleton=!1,game.PlotMgr._instance=new game.PlotMgr,game.PlotMgr._singleton=!0),game.PlotMgr._instance}},{}],1086:[function(e,t,i){"use strict";game.TriggerMgr=b8e.Object.extends({_isSetuped:!1,_isTrigging:null,_isRootTrigging:null,_triggersLimitCount:null,_durationTweens:null,_cancelDurationTweens:null,_isReady:!1,_hasTriggerTimesDatas:!1,_hasRebirthData:!1,_hangUpList:null,_timingTriggerList:null,_queueTriggerByGroup:null,_isPlotComplete:!1,ctor:function(){this._super(),this._isTrigging=[],this._isRootTrigging=[],this._triggersLimitCount={},this._durationTweens={},this._cancelDurationTweens={},this._hangUpList=[],this._timingTriggerList=b8e.HashMap.get(),this._queueTriggerByGroup=b8e.HashMap.get()},setTriggerTimesDatas:function(e){e.forEach(function(e){this._triggersLimitCount[e.id]=e.triggerTimes},this),this._hasTriggerTimesDatas=!0,this.initTriggers()},setRebirthData:function(){this._hasRebirthData=!0,this.initTriggers(),this.triggerLevelCondition()},setup:function(){this._isSetuped=!0,this.initTriggers()},initTriggers:function(){this._isReady||this._isSetuped&&this._hasTriggerTimesDatas&&(this._isReady=!0,this.triggerLevelCondition(),this.registerClickTrigger(),this.doHangUpTrigger(),this.initTimingTrigger(),b8e.evt.addG(this,game.RoleDataEvent.MAIN_ROLE_LEVEL_UP,this.onLevelUp),b8e.Timer.add(this,this.onTiming,1e3))},onLevelUp:function(){this._isReady&&(this.triggerLevelCondition(),game.CommandMgr.inst().updateCommands())},triggerLevelCondition:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(this._isReady)for(var s=game.mainRole.mainRoleData.getLv(),a=game.rebirth.rebirthLevel,t=game.ccfg.ClientTriggerCfg.getLevelTriggerList(),o=[];0<s&&(t.forEach(function(e,t){if(o.indexOf(t.id)<0){var i=-999999999,n=999999999;0<t.minLevel&&(i=t.minLevel),0<t.maxLevel&&(n=t.maxLevel),i<=s&&s<=n&&(!t.rebirthLevel||this._hasRebirthData&&parseInt(t.rebirthLevel)==a)?this.doTrigger(t):(this.completeTrigger(t),this._isPlotComplete||100001!=t.plotId||(this._isPlotComplete=!0)),o.push(t.id)}},this),e);)s--},initTimingTrigger:function(){game.ccfg.ClientTriggerCfg.getTimingTriggerList().forEach(function(e,t){1e3<=t.timingDelay&&(t.currTime=0,t.currTimeCount=0,this._timingTriggerList.set(t.id,t))},this)},onTiming:function(){game.ccfg.ClientTriggerCfg.getTimingTriggerList().forEach(function(e,t){this._timingTriggerList.get(e)&&(t.currTime+=1e3,t.currTime>=t.timingDelay&&((t.currTime=0)==t.currTimeCount?this.doTriggerWithDelay(t):this.doTrigger(t),t.currTimeCount++,0<t.timingCount&&t.currTimeCount>=t.timingCount&&this._timingTriggerList.del(e)))},this)},registerClickTrigger:function(){game.ccfg.ClientTriggerCfg.getClickTriggerList().forEach(function(t,e){var i=e.triggerCommandIds;i&&i.split(",").forEach(function(e){game.CommandMgr.inst().bindTrigger(t,e),game.CommandMgr.inst().triggerCommandById(e)},this)},this)},sceneTrigger:function(e){var t=game.ccfg.ClientTriggerCfg.getTriggerListByScene(e);t&&t.forEach(function(e){this.doTrigger(e)},this),game.CommandMgr.inst().updateCommands(e)},goodsTrigger:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];switch(e.type){case game.GoodsType.WEAPON:case game.GoodsType.ARMOR:case game.GoodsType.BELT:case game.GoodsType.RING:case game.GoodsType.HELM:case game.GoodsType.NECKLACE:case game.GoodsType.LEGGUARD:case game.GoodsType.SHOE:this.equipTypeTrigger(e,t),this.updateGoodsTrigger();break;default:this.goodsTypeTrigger(e.type,t),this.updateGoodsTrigger()}},equipTypeTrigger:function(t){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=t.type,n=game.ccfg.ClientTriggerCfg.getTriggerListByEquipType(e);n&&n.forEach(function(e){e.canRefine?game.equip.isCanRefine(t)&&this.doTrigger(e,0,!1,i):this.doTrigger(e,0,!1,i)},this)},goodsTypeTrigger:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.ccfg.ClientTriggerCfg.getTriggerListByGoodsType(e);i&&i.forEach(function(e){this.doTrigger(e,0,!1,t)},this)},prizeTypeTrigger:function(e){var t=game.ccfg.ClientTriggerCfg.getTriggerListByPrizeType(e);t&&t.forEach(function(e){this.doTrigger(e)},this)},achievementTypeTrigger:function(e){var t=game.ccfg.ClientTriggerCfg.getAchievementListById(e);t&&t.forEach(function(e){this.doTrigger(e)},this)},updateGoodsTrigger:function(){var n=[];this._isTrigging.forEach(function(e){if(e.equipType||e.goodsType||e.prizeType){var t,i=e.triggerCommandIds;if(i)i.split(",").forEach(function(e){game.CommandMgr.inst().updateCommandById(e)},this);e.equipType?(!(t=game.back.getItemInfoById(e.goodsId))||t.num<1)&&n.push(e):e.goodsType?(!(t=game.back.getItemInfoById(e.goodsId))||t.num<1)&&n.push(e):e.prizeType}},this),n.forEach(function(e){this.cancelTrigger(e,!0)},this),n.length=0,n=null},taskTrigger:function(){var s=0,e=game.quest.questInfo;e&&(s=e.sequence);for(var t=game.ccfg.ClientTriggerCfg.getTaskTriggerList(),a=[];0<s;)t.forEach(function(e,t){if(a.indexOf(t.id)<0){var i=-999999999,n=999999999;0<t.minTaskSequence&&(i=t.minTaskSequence),0<t.maxTaskSequence&&(n=t.maxTaskSequence),i<=s&&s<=n?this.doTrigger(t):this.completeTrigger(t),a.push(t.id)}},this),s--;game.CommandMgr.inst().updateCommands()},joinGuildTrigger:function(){var e=game.ccfg.ClientTriggerCfg.getJoinGuildTriggerList();e&&e.forEach(function(e,t){this.doTrigger(t)},this)},dujieSucceedTrigger:function(){var e=game.ccfg.ClientTriggerCfg.getDujieSucceedTriggerList();e&&e.forEach(function(e,t){this.doTrigger(t)},this)},cherishBeautyTrigger:function(){var e=game.ccfg.ClientTriggerCfg.getCherishBeautyTriggerList();e&&e.forEach(function(e,t){this.doTrigger(t)},this)},bianShenTrigger:function(i){var e=game.ccfg.ClientTriggerCfg.getBianShenTriggerList();e&&e.forEach(function(e,t){(t.bianshenStar<1||i==t.bianshenStar)&&this.doTrigger(t)},this)},bianShenBattleTrigger:function(){var e=game.ccfg.ClientTriggerCfg.getBianShenBattleTriggerList();e&&e.forEach(function(e,t){this.doTrigger(t)},this)},doHangUpTrigger:function(){this._hangUpList.forEach(function(e){this.doTrigger(e)},this),this._hangUpList.length=0},doTriggerWithDelay:function(e){var t=this._durationTweens[e.id];t&&(t.kill(),this._durationTweens[e.id]=null,delete this._durationTweens[e.id]),0<e.triggerDelay?(t=b8e.Tween.get(this).wait(e.triggerDelay).call(this.doTrigger,this,[e]),this._durationTweens[e.id]=t):this.doTrigger(e)},doTrigger:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];4<arguments.length&&void 0!==arguments[4]&&arguments[4];if(!this._isReady)return this._hangUpList.indexOf(t)<0&&this._hangUpList.push(t),!1;if(!i&&-1<this._isTrigging.indexOf(t))return!1;if(t.chainTriggerId==t.id)return b8e.warn("触发器"+t.id+"链式触发ID不能和ID相同！"),!1;if(t.nextTriggerId==t.id)return b8e.warn("触发器"+t.id+"下一个触发ID不能和ID相同！"),!1;if(0<t.nextTriggerId&&t.nextTriggerId==t.chainTriggerId)return b8e.warn("触发器"+t.id+"下一个触发ID不能和链式触发ID相同！"),!1;if(n&&t.disabledInitTrigger)return!1;if(t.usedOnlyHasMicroClient&&(!game.LoginConfig.canDownloadMicro||game.LoginConfig.isMicroLogin))return!1;if(t.usedOnlyADServing){var s=game.sdk.gamePFData();if(!s||s.indexOf(t.usedOnlyADServing)<0)return!1}t.rootTriggerId=0<e?e:t.id;var a=game.ccfg.ClientTriggerCfg.getDataById(t.rootTriggerId);if(!i&&0==e&&-1<this._isRootTrigging.indexOf(a))return!1;var o,r=0;if(!i&&0==e&&0<a.triggerLimitCount){var h=this._triggersLimitCount[a.id];if(null!=h&&(r=(h=parseInt(h))>>16,(65535&h)>=a.triggerLimitCount))return this._isPlotComplete||100001!=a.id||(this._isPlotComplete=!0),!1}if(0==e&&0<t.queueGroup)if((l=this._queueTriggerByGroup.get(t.queueGroup))&&0<l.length){if(l[0]!=t&&l.indexOf(t)<0)return l.indexOf(t)<0&&l.push(t),!1}else l=[t],this._queueTriggerByGroup.set(t.queueGroup,l);(o=this._durationTweens[t.id])&&(o.kill(),this._durationTweens[t.id]=null,delete this._durationTweens[t.id]),(o=this._cancelDurationTweens[t.id])&&(o.kill(),this._cancelDurationTweens[t.id]=null,delete this._cancelDurationTweens[t.id]);var g=!1;if(0==e&&this._isRootTrigging.indexOf(a)<0&&this._isRootTrigging.push(a),this._isTrigging.indexOf(t)<0&&this._isTrigging.push(t),t.triggerType)if(t.triggerType==game.TriggerType.LEVEL)g=!1;else if(t.triggerType==game.TriggerType.CLICK)g=!1;else if(t.triggerType==game.TriggerType.GOODS){var l;if(g=!1,t.goodsId=0,t.equipType)switch(t.equipType){case game.GoodsType.WEAPON:case game.GoodsType.ARMOR:case game.GoodsType.BELT:case game.GoodsType.RING:case game.GoodsType.HELM:case game.GoodsType.NECKLACE:case game.GoodsType.LEGGUARD:case game.GoodsType.SHOE:if((l=game.back.getItemListByType(t.equipType))&&0<l.length){l.sort(this.onSortByPowers);var c=l[0];t.goodsId=c.id}}else if(t.goodsType&&(l=game.back.getItemListByType(t.goodsType))&&0<l.length){l.sort(this.onSortByPowers);c=l[0];t.goodsId=c.id}}else g=!1;else g=!0;0<t.guideId&&(g=!1),0<t.plotId&&(g=!1,game.PlotMgr.inst().triggerPlot(t,r)),0<t.dialogId&&(g=!1,game.DialogMgr.inst().triggerDialog(t));var u=t.triggerCommandIds;u&&u.split(",").forEach(function(e){game.CommandMgr.inst().bindTrigger(t.id,e),game.CommandMgr.inst().triggerCommandById(e)},this);if(this.chainTrigger(t),g)this.completeTrigger(t);else{if(0<t.guideId||0<t.dialogId){var m=t.completeType.split(",");m.indexOf(game.TriggerCompleteType.CLICK)<0&&m.indexOf(game.TriggerCompleteType.CLICK_MODAL)<0&&m.indexOf(game.TriggerCompleteType.DIALOG_COMPLETE)<0&&b8e.warn("该类型触发器"+t.id+"的完成类型必须配置！")}0<t.cancelDuration&&(o=b8e.Tween.get(this).wait(t.cancelDuration).call(this.cancelTriggerById,this,[t.id]),this._cancelDurationTweens[t.id]=o),0<t.duration&&(o=b8e.Tween.get(this).wait(t.duration).call(this.completeTriggerById,this,[t.id]),this._durationTweens[t.id]=o)}return!0},chainTrigger:function(e){var t=e.chainTriggerId,i=e.chainTriggerDelay;if(0<t){var n=game.ccfg.ClientTriggerCfg.getDataById(t);if(!n)return void b8e.warn("触发器"+t+"没有找到");if(n.triggerType)return void b8e.warn("触发器"+n.id+"作为主触发器不能用于并行触发！");var s=this._durationTweens[t];s&&(s.kill(),this._durationTweens[t]=null,delete this._durationTweens[t]),0<i?(s=b8e.Tween.get(this).wait(i).call(this.doTrigger,this,[n]),this._durationTweens[t]=s):this.doTrigger(n)}},customTriggerById:function(e){var t=game.ccfg.ClientTriggerCfg.getDataById(e);if(t){var i=game.ccfg.ClientCommandCfg.getDataById(t.triggerCommandIds);i&&i.functionOpenId?game.funcOpen.checkOpenWithTips(i.functionOpenId)&&game.TriggerMgr.inst().triggerById(e,0,!1,!0):game.TriggerMgr.inst().triggerById(e,0,!1,!0)}},triggerByPlot:function(e){var t=e.triggerId,i=game.ccfg.ClientTriggerCfg.getDataById(t);i?(i.plotData=e,game.TriggerMgr.inst().triggerById(t)):b8e.warn("触发器"+t+"没有找到")},triggerById:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!this._isReady)return!1;var s=game.ccfg.ClientTriggerCfg.getDataById(e);return s?this.doTrigger(s,t,i,!1,n):(b8e.warn("触发器"+e+"没有找到"),!1)},gotoNextTrigger:function(e){var t=e.nextTriggerId,i=e.nextTriggerDelay;if(0<t){var n=game.ccfg.ClientTriggerCfg.getDataById(t);if(!n)return void b8e.warn("触发器"+t+"没有找到");if(n.triggerType)return void b8e.warn("触发器"+n.id+"作为主触发器不能用于串行触发！");var s=this._durationTweens[t];s&&(s.kill(),this._durationTweens[t]=null,delete this._durationTweens[t]),0<i?(s=b8e.Tween.get(this).wait(i).call(this.doTrigger,this,[n,e.rootTriggerId]),this._durationTweens[t]=s):this.doTrigger(n,e.rootTriggerId)}else this.cancelRootTrigger(e,!0)},nextQueueTrigger:function(e){if(0<e.queueGroup){var t=this._queueTriggerByGroup.get(e.queueGroup);if(t){var i=t.indexOf(e);-1<i&&t.splice(i,1),0<t.length?this.doTrigger(t[0]):this._queueTriggerByGroup.del(e.queueGroup)}}},cancelTrigger:function(t){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=t.id,n=this._isTrigging.indexOf(t);if(-1<n){this._isTrigging.splice(n,1);var s=t.preventCommandIds;if(s)s.split(",").forEach(function(e){game.CommandMgr.inst().preventCommandById(t,e,!i)},this);var a=this._durationTweens[e];a&&(a.kill(),this._durationTweens[e]=null,delete this._durationTweens[e]),(a=this._cancelDurationTweens[e])&&(a.kill(),this._cancelDurationTweens[e]=null,delete this._cancelDurationTweens[e])}i&&this.cancelRootTrigger(t)},cancelRootTrigger:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=game.ccfg.ClientTriggerCfg.getDataById(e.rootTriggerId),n=this._isRootTrigging.indexOf(i);if(-1<n&&this._isRootTrigging.splice(n,1),t&&0<i.triggerLimitCount){var s,a=this._triggersLimitCount[i.id];s=null!=a?65535&parseInt(a):0,s+=1,(this._triggersLimitCount[i.id]=s)>=i.triggerLimitCount&&this._timingTriggerList.del(i.id),this.saveTriggerTimes(i.id,s)}this.nextQueueTrigger(i)},setTriggerProgress:function(e,t){var i=game.ccfg.ClientTriggerCfg.getDataById(e.rootTriggerId);if(0<i.triggerLimitCount){var n,s=this._triggersLimitCount[i.id];n=null!=s?65535&parseInt(s):0,n|=t<<16,this._triggersLimitCount[i.id]=n,this.saveTriggerTimes(i.id,n)}},completeTriggerByPlot:function(e){var t=e.triggerId,i=game.ccfg.ClientTriggerCfg.getDataById(t);i?-1<this._isTrigging.indexOf(i)&&(this.cancelTrigger(i),i.plotData=null,this.gotoNextTrigger(i)):b8e.warn("触发器"+t+"没有找到")},completeTrigger:function(e){-1<this._isTrigging.indexOf(e)&&(this.cancelTrigger(e),e.plotData&&(game.PlotMgr.inst().storyLineNextPart(e.plotData),e.plotData=null),this.gotoNextTrigger(e))},saveTriggerTimes:function(e,t){game.MiscSender.saveClientTriggerRequest(e,t)},completeTriggerById:function(e){var t=game.ccfg.ClientTriggerCfg.getDataById(e);t?this.completeTrigger(t):b8e.warn("触发器"+e+"没有找到")},cancelTriggerById:function(e){var t=game.ccfg.ClientTriggerCfg.getDataById(e);t?this.cancelTrigger(t,!0):b8e.warn("触发器"+e+"没有找到")},isPlotComplete:function(){return this._isPlotComplete},onSortByPowers:function(e,t){return e.basePower>t.basePower?-1:e.basePower<t.basePower?1:e.quality>t.quality?-1:e.quality<t.quality?1:0}}),game.TriggerMgr._instance=null,game.TriggerMgr._singleton=!0,game.TriggerMgr.inst=function(){return null==game.TriggerMgr._instance&&(game.TriggerMgr._singleton=!1,game.TriggerMgr._instance=new game.TriggerMgr,game.TriggerMgr._singleton=!0),game.TriggerMgr._instance}},{}],1087:[function(e,t,i){"use strict";e("./TriggerMgr"),e("./CommandMgr"),e("./FunctionOpenMgr"),e("./DialogMgr"),e("./GuideMgr"),e("./PlotMgr"),e("./PerfMgr")},{"./CommandMgr":1080,"./DialogMgr":1081,"./FunctionOpenMgr":1082,"./GuideMgr":1083,"./PerfMgr":1084,"./PlotMgr":1085,"./TriggerMgr":1086}],1088:[function(e,t,i){"use strict";var n=game.ClientCfg=function(){};n.getMap=function(e){return"maps/"+e+"/map.bmc"},n.getAvatarAnim=function(e,t){switch(e){case game.RoleType.Hero:case game.RoleType.Monster:return"animations/units/"+t+"/animate.bac";case game.RoleType.Door:return"animations/scenefxs/"+t+"/animate.bac";case game.RoleType.DropItem:return"";case game.RoleType.Follower:return game.ClientCfg.getFaBao(t);case game.RoleType.Ornament:return game.ClientCfg.getUIOrnament(t);case game.RoleType.Beauty:return game.ClientCfg.getSceneBeauty(t);case game.RoleType.UIRole:return game.ClientCfg.getUiUnits(t);case 1e8:return"animations/units/"+t+"/animate.bac";default:return"animations/"+t+"/animate.bac"}},n.getBianshen=function(e){return"animations/units/"+e+"/animate.bac"},n.getMount=function(e){return"animations/"+e+"/animate.bac"},n.getWing=function(e){return"animations/"+e+"/animate.bac"},n.getFaBao=function(e){return"animations/"+e+"/animate.bac"},n.getXianZhen=function(e){return"animations/"+e+"/animate.bac"},n.getUiUnits=function(e){return"animations/ui-units/"+e+"/animate.bac"},n.getAvatarDefault=function(e){return"animations/units/default/animate.bac"},n.getAnimation=function(e){return"animations/"+e+"/animate.bac"},n.getSceneFx=function(e){return"animations/scenefxs/"+e+"/animate.bac"},n.getSkillFx=function(e){return"animations/skillfxs/"+e+"/animate.bac"},n.getBeauty=function(e){return"animations/beauty/"+e+"/animate.bac"},n.getSceneBeauty=function(e){return"animations/se-beauty/"+e+"/animate.bac"},n.getUIFxs=function(e){return"animations/uifxs/"+e+"/animate.bac"},n.getDujie=function(e){return"animations/"+e+"/animate.bac"},n.getUIOrnament=function(e){return"animations/"+e+"/animate.bac"},n.ALAST_URL="app/images/atlas/",n.GRIDS_ALAST_URL=n.ALAST_URL+"grids/grids",n.Bianshen_ALAST_URL=n.ALAST_URL+"bianshenGrid/bianshenGrid",n.Bianshen_STAR_ALAST_URL=n.ALAST_URL+"bianshen/bianshen",n.PKMODE_ALAST_URL=n.ALAST_URL+"pkMode/pkMode",n.BEAUTY_GRID_ALAST_URL=n.ALAST_URL+"beautyGrid/beautyGrid",n.BEAUTY_ALAST_URL=n.ALAST_URL+"beauty/beauty",n.GRIDS_QUALITY="quality_",n.BIANSHEN_ALAST="quality_",n.BIANSHEN_SLOT_ALAST="circle_quality_",n.BEAUTY_ALAST="beauty_quality_",n.IMAGE_URL="images/image/",n.PNG=".png",n.JPG=".jpg",n.MFYueHei="app/fonts/MFYueHei_Noncommercial-Regular.ttf",n.digits4_0="app/fonts/digits4_0.fnt",n.digits10_0="app/fonts/digits10.fnt",n.getTextureUrl=function(e){return"textures/"+e},n.HEAD_BAR="app/images/atlas/headBar/headBar",n.getImgUrl=function(e){return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?n.IMAGE_URL+e+n.JPG:n.IMAGE_URL+e+n.PNG},n.getGridBg=function(e){return n.IMAGE_URL+"grids/grids_1/"+e+n.PNG},n.getImageObj=function(e,t){return{atlasUrl:e,iconName:t}},n.getItemIconUrlByIconName=function(e){return"images/image/item/"+e+n.PNG},n.getHeadUrl=function(e){return"images/image/head/"+e+n.PNG},n.getLoneyDungeonHead=function(e){return"images/image/Headportrait/"+e+n.PNG},n.getPosterUrl=function(e){return"images/poster/"+e+n.PNG},n.getSkillUrlByIconName=function(e){return"images/image/skill/"+e+n.PNG},n.getSceneMap=function(e){return"maps/"+e+"/map"},n.getWordMapItem=function(e){return"images/image/worldMap/"+e+n.PNG},n.getHeadportraitUrlByIconName=function(e){return"images/image/Headportrait/"+e+n.PNG},n.getAmountIconUrlByIconName=function(e){return"images/image/amount/"+e+n.PNG},n.getBianshenIconUrlByIconName=function(e){return"images/image/Headportrait/"+e+n.PNG},n.getBianshenIconUrlByIdName=function(e){return"images/image/"+e+n.PNG},n.getTextLv=function(e){return 1==(e+="").length&&(e="0"+e),"images/image/text/lv/icon_pinjie_"+e+n.PNG},game.ClientCfg.getBeautyIconUrlByIconName=function(e){return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"images/image/beauty/"+e+n.JPG:"images/image/beauty/"+e+n.PNG},game.ClientCfg.getBeautyNameUrlByIconName=function(e){return"images/image/beautyName/"+e+n.PNG},game.ClientCfg.getHeadIconUrlByHeadId=function(e){return"images/image/head/"+e+n.PNG},game.ClientCfg.getDayUrl=function(e){return n.IMAGE_URL+"days/"+e+n.PNG},game.ClientCfg.getActiveTitleBg=function(e){return n.IMAGE_URL+e+n.PNG},game.ClientCfg.getActiveTitleBgSelect=function(e){return n.IMAGE_URL+e+"_select"+n.PNG},game.ClientCfg.getWorldBossImgUrlByString=function(e){return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"images/image/worldBoss/"+e+n.JPG:"images/image/worldBoss/"+e+n.PNG},game.ClientCfg.getParticleUrl=function(e){return"res/raw-assets/resources/particle/"+e},game.ClientCfg.getDujieLvIconUrl=function(e){return"images/image/dujieLvIcon/"+e+n.PNG},game.ClientCfg.getSurfaceUrl=function(e){return n.IMAGE_URL+"surface/"+e+n.PNG},game.ClientCfg.getMaterialTitleUrl=function(e){return n.IMAGE_URL+"materialDungeon/title_"+e+n.PNG},game.ClientCfg.getFogUrl=function(e){return n.IMAGE_URL+"fog/"+e+n.PNG},game.ClientCfg.getCornucopiaImgUrlByString=function(e){return"images/image/cornucopia/"+e+n.JPG},game.ClientCfg.getAccessoryUrl=function(e){return"images/image/"+e+n.PNG},game.ClientCfg.getVipImageUrlByLv=function(e){return"images/image/vipImag/vip_"+e+n.PNG},game.ClientCfg.getNickNameIconUrl=function(e){return"images/image/nicknameimag/"+e+n.PNG},game.ClientCfg.getQualityBg=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:90,i=t+"_0";switch(e){case game.Quality.Q_WHITE:i=t+"_0";break;case game.Quality.Q_GREEN:i=t+"_1";break;case game.Quality.Q_BLUE:i=t+"_2";break;case game.Quality.Q_PURPLE:i=t+"_3";break;case game.Quality.Q_YELLOW:i=t+"_4";break;case game.Quality.Q_RED:i=t+"_5"}return i},game.ClientCfg.getRuneSlotBg=function(e){return"rune_"+e},game.ClientCfg.getWuxingIcon=function(e){var t="";switch(e){case game.BianshenWuxingType.JIN:t=game.ClientCfg.getImgUrl("bianshen/icon_wx_jin");break;case game.BianshenWuxingType.MU:t=game.ClientCfg.getImgUrl("bianshen/icon_wx_mu");break;case game.BianshenWuxingType.SHUI:t=game.ClientCfg.getImgUrl("bianshen/icon_wx_shui");break;case game.BianshenWuxingType.TU:t=game.ClientCfg.getImgUrl("bianshen/icon_wx_tu");break;case game.BianshenWuxingType.HUO:t=game.ClientCfg.getImgUrl("bianshen/icon_wx_huo")}return t},game.ClientCfg.getXinFaIcon=function(e){return"images/image/xinfaIcon/xinfaIcon_"+e+n.PNG},game.ClientCfg.getAmuletIcon=function(e){return"images/image/amuletimage/amulet_"+e+n.PNG},game.ClientCfg.getHighEquipBg=function(e){return"images/image/highequipBg/"+e+n.PNG},game.ClientCfg.getCSArenaLvIcon=function(e){return"images/image/csArena/icon/icon_"+e+n.PNG},game.ClientCfg.getCSArenaLvName=function(e){return"images/image/csArena/icon/name_"+e+n.PNG},game.ClientCfg.getCSVsUrl=function(e){return"images/image/csArena/vs/"+e+n.PNG},game.ClientCfg.getTowerBgUrl=function(){return"images/image/tower/tower_bg.jpg"},game.ClientCfg.getTowerImgUrl=function(){return"images/image/tower/tower.png"},game.ClientCfg.getVipAwardLevel=function(e){return"images/image/vip/customer/customerLevel_"+e+n.PNG},game.ClientCfg.getNationalFlag=function(e){return"images/image/worldcup/nationalFlag/"+e+n.PNG},game.ClientCfg.bar_juesexuetiao_1="bar_juesexuetiao_1",game.ClientCfg.bar_juesexuetiao_2="bar_juesexuetiao_2",game.ClientCfg.bar_juesexuetiao_3="bar_juesexuetiao_3",game.ClientCfg.suraBgUrl="images/image/sura/sura_0"+n.JPG,game.ClientCfg.csSuraBgUrl="images/image/sura/kuafuSura"+n.JPG,game.ClientCfg.guildBossBg="images/image/guild/boss/guildBoss"+n.JPG,game.ClientCfg.suraEnterIcon="images/image/strengthen/btn_dataosha"+n.PNG,game.ClientCfg.csSuraEnterIcon="images/image/strengthen/btn_sanjie"+n.PNG,game.ClientCfg.guildExpCureEffect="animations/scenefxs/10083/animate.bac",game.ClientCfg.guildExpCureBg="images/image/guild/expCure/bg"+n.PNG,game.ClientCfg.guildExpCureTitle="images/image/guild/expCure/title"+n.JPG,game.ClientCfg.ActiveConversionTitle="images/image/active/discount/chaozhiduihuan"+n.JPG,game.ClientCfg.ActiveConversionBg="images/image/active/discount/chaozhiduihuanBg"+n.PNG,game.ClientCfg.tianGongBgUrl="images/image/guild/tg"+n.JPG,game.ClientCfg.csTianGongBgUrl="images/image/guild/cstg"+n.JPG,game.ClientCfg.challange_task="instance",game.ClientCfg.challange_daily="daily",game.ClientCfg.challange="挑战",game.ClientCfg.arenaThisServer="localServer",game.ClientCfg.arenaCrossServer="crossServer",game.ClientCfg.wanfa_arena="竞技",game.ClientCfg.wanfa_arena_honour="荣誉令",game.ClientCfg.challange_material="material",game.ClientCfg.challange_arena="arena",game.ClientCfg.shop_dailylimit="已达到今日限购次数",game.ClientCfg.shop_jingjielimit="境界未达到，不可购买",game.ClientCfg.spell_lock="lock",game.ClientCfg.blueDiamondBgUrl="images/image/wanba/blueDiamondBg"+n.JPG,game.ClientCfg.blueDiamondBtnOpenUrl="images/image/wanba/openBlueDiamond"+n.PNG,game.ClientCfg.yellowDiamondBgUrl="images/image/wanba/yellowDiamond"+n.JPG,game.ClientCfg.yellowDiamondBtnOpenUrl="images/image/wanba/openYellowDiamond"+n.PNG,game.ClientCfg.vipCustomer="vip/customer/vip_customer_bg",game.ClientCfg.activeMystery="images/image/active/mystery"+n.PNG,game.ClientCfg.worldCupBgUrl="images/image/worldcup/bg/worldCupBg"+n.PNG,game.ClientCfg.worldCupTitleBgUrl="images/image/worldcup/titlebg/worldTitleBg"+n.JPG,game.ClientCfg.worldCupQuizBgUrl="images/image/worldcup/bg/worldCupScoreBg"+n.JPG,game.ClientCfg.worldCupVsBgUrl="images/image/worldcup/bg/quizItemBg"+n.PNG,game.ClientCfg.worldCupRankBgUrl="images/image/worldcup/bg/worldcupItemBg"+n.PNG,game.ClientCfg.worldCupGroupBgUrl="images/image/worldcup/bg/world_cup_group"+n.JPG,game.ClientCfg.worldCupCollectBgUrl="images/image/worldcup/bg/collect_bg"+n.JPG,game.ClientCfg.worldCupR16Bg1Url="images/image/worldcup/bg/r16bg_0"+n.JPG,game.ClientCfg.worldCupR16Bg2Url="images/image/worldcup/bg/r16bg_1"+n.PNG,game.ClientCfg.worldCupNoneNationalFlag="images/image/worldcup/nationalFlag/noneIcon"+n.PNG,game.ClientCfg.welcomeBgUrl="images/image/welcome/welcomeBg"+n.PNG,game.ClientCfg.jdImgUrl="images/image/jingdong/jd_img"+n.JPG,game.ClientCfg.arena_challange="挑  战",game.ClientCfg.arena_one_button_challange="一键挑战",game.ClientCfg.rune_has_no_rune_wear="暂无可镶嵌的符文",game.ClientCfg.rune_was_best="暂无更好的同类型符文",game.ClientCfg.opt_too_quick="操作过快",game.ClientCfg.competeImgUrl="images/image/activeCompete/settled"+n.PNG,game.ClientCfg.mountEquipBg="images/image/accessory/mountequip/mountequipBg"+n.JPG,game.ClientCfg.newMapBg="images/image/worldMap/newMap"+n.JPG,game.ClientCfg.getOrnamentUrl=function(e){return n.IMAGE_URL+e+n.PNG},game.ClientCfg.wxAddShortcutImgUrl="images/image/welfare/wxAddShortcutBg"+n.PNG,game.ClientCfg.mainTopImgUrl="images/image/uimain/mainTop"+n.PNG,game.ClientCfg.mainTopIosImgUrl="images/image/uimain/mainTop_ios"+n.PNG,game.ClientCfg.mainTopbgImgUrl="images/image/uimain/mainTopbg"+n.PNG,game.ClientCfg.mainTopbgIosImgUrl="images/image/uimain/mainTopbg_ios"+n.PNG},{}],1089:[function(e,t,i){"use strict";var n=e("./cfg/scene/MainQuestCfg"),s=e("./cfg/ServerCodeCfg"),a=e("./cfg/scene/SceneCfg"),o=e("./cfg/scene/ClientSceneEffectCfg"),r=e("./cfg/scene/ClientAreaEventCfg"),h=e("./cfg/hero/HeroCfg"),g=e("./cfg/spell/SpellCfg"),l=e("./cfg/scene/MonsterCfg"),c=e("./cfg/scene/DungeonCfg"),u=e("./cfg/item/PrizeCfg"),m=e("./cfg/exp/ExpCfg"),_=e("./cfg/scene/MonGenCfg"),d=e("./cfg/scene/NpcGenCfg"),f=e("./cfg/scene/ClientMonsterGen"),p=e("./cfg/scene/ClientEntityCfg"),S=e("./cfg/scene/DialogCfg"),T=e("./cfg/language/LangCfg"),I=e("./cfg/notice/NoticeCfg"),v=e("./cfg/spriteStat/SpriteStatCfg"),A=e("./cfg/item/ItemInfoCfg"),C=e("./cfg/item/EquipCfg"),E=e("./cfg/accessory/AccessoryCfg"),b=e("./cfg/equip/EquipSlotIntensifyCfg"),y=e("./cfg/equip/EquipSlotStarCfg"),k=e("./cfg/gm/GmCmdCfg"),R=e("./cfg/gm/GmCmdShortCutCfg"),N=e("./cfg/beauty/BeautyDataCfg"),B=e("./cfg/beauty/BeautyFavorCfg"),P=e("./cfg/equip/EquipQualitySuitsCfg"),L=e("./cfg/equip/EquipStarSuitsCfg"),G=e("./cfg/spriteStat/AttrRulesCfg"),M=e("./cfg/equip/EquipTypeCfg"),D=e("./cfg/globalParam/GlobalParamCfg"),w=e("./cfg/bianshen/BianshenUpgradeJieCfg"),O=e("./cfg/bianshen/BianshenUpgradeLvCfg"),U=e("./cfg/power/LvPowerCoefCfg"),x=e("./cfg/power/AttrPowerCoefCfg"),H=e("./cfg/equip/EquipQualityCfg"),F=e("./cfg/trigger/ClientGuideCfg"),q=e("./cfg/trigger/ClientTriggerCfg"),W=e("./cfg/trigger/ClientCommandCfg"),z=e("./cfg/trigger/ClientViewDescCfg"),V=e("./cfg/trigger/ClientFunctionOpenCfg"),Q=e("./cfg/trigger/ClientPlotCfg"),Y=e("./cfg/draw/DrawDecksCfg"),Z=e("./cfg/welfare/WelfareCfg"),K=e("./cfg/welfare/WelfareGoldCfg"),j=e("./cfg/cost/CostCfg"),X=e("./cfg/StarCfg"),J=e("./cfg/equip/EquipRefineColorCfg"),$=e("./cfg/shop/ShopCfg"),ee=e("./cfg/goto/GotoCfg"),te=e("./cfg/strengthen/StrengthenCfg"),ie=e("./cfg/strengthen/StrengthenPowerCfg"),ne=e("./cfg/bianshen/BianshenCfg"),se=e("./cfg/head/HeadCfg"),ae=e("./cfg/strengthen/StrengthenGradeCfg"),oe=e("./cfg/guild/GuildActivityCfg"),re=e("./cfg/guild/GuildExpCfg"),he=e("./cfg/guild/GuildQuestAwardCfg"),ge=e("./cfg/guild/GuildQuestCfg"),le=e("./cfg/guild/GuildShaoxiangCfg"),ce=e("./cfg/guild/GuildXinfaCfg"),ue=e("./cfg/arenarankprize/ArenaRankPrizeCfg"),me=e("./cfg/vip/VipCfg"),_e=e("./cfg/worldBoss/WorldBossCfg"),de=e("./cfg/pay/RechargeCfg"),fe=e("./cfg/pay/NormalRechargeCfg"),pe=e("./cfg/pay/CardRechargeCfg"),Se=e("./cfg/pay/RechargeRebateCfg"),Te=e("./cfg/pay/AccumulateRechargeCfg"),Ie=e("./cfg/active/LoginPrizeCfg"),ve=e("./cfg/active/RebateCostCfg"),Ae=e("./cfg/StarGradeCfg"),Ce=e("./cfg/active/ClientActiveCfg"),Ee=e("./cfg/sura/SuraLevelCfg"),be=e("./cfg/sura/SurakillCfg"),ye=e("./cfg/sura/SuraPrizeCfg"),ke=e("./cfg/dujie/DujieCfg"),Re=e("./cfg/nationalBoss/NationalBossCfg"),Ne=e("./cfg/xiandan/XiandanCfg"),Be=e("./cfg/xiandan/XiandanBarCfg"),Pe=e("./cfg/fund/FundRechargeCfg"),Le=e("./cfg/nickname/NickNameCfg"),Ge=e("./cfg/wanba/WanbaPrizeCfg"),Me=e("./cfg/rebirth/RebirthCfg"),De=e("./cfg/nationalBoss/NationalAwardCfg"),we=e("./cfg/zhanyao/ZhanYaoCfg"),Oe=e("./cfg/zhanyao/ZhanYaoAwardCfg"),Ue=e("./cfg/worldBoss/WorldBossAwardCfg"),xe=e("./cfg/rechargeActive/SaleDailyCfg"),He=e("./cfg/tiangong/TianGongGuildAwardCfg"),Fe=e("./cfg/tiangong/TianGongPlayerAwardCfg"),qe=e("./cfg/tiangong/CSTianGongGuildAwardCfg"),We=e("./cfg/tiangong/CSTianGongPlayerAwardCfg"),ze=e("./cfg/onlineAward/OnlineAwardCfg"),Ve=e("./cfg/amulet/AmuletCfg"),Qe=e("./cfg/wanfa/WanfaCfg"),Ye=e("./cfg/countAward/CountAwardCfg"),Ze=e("./cfg/wanbagamevip/WanBaGameVipCfg"),Ke=e("./cfg/rank/RankBarCfg"),je=e("./cfg/functionpreview/FunctionPreviewCfg"),Xe=e("./cfg/item/HighEquipCfg"),Je=e("./cfg/roulette/ZhuanPanCfg"),$e=e("./cfg/roulette/ZhuanPanCostCfg"),et=e("./cfg/equip/EquipSlotEnchantCfg"),tt=e("./cfg/CSArenaLevelCfg"),it=e("./cfg/CSArenaRankAwardCfg"),nt=e("./cfg/tower/TowerCfg"),st=e("./cfg/rune/RuneCfg"),at=e("./cfg/welfare/WeekSignCfg"),ot=e("./cfg/sura/CsSuraPrizeCfg"),rt=e("./cfg/sura/CsSuraLevelCfg"),ht=e("./cfg/guild/GuildBossCfg"),gt=e("./cfg/guild/GuildBossAwardCfg"),lt=e("./cfg/welfare/WelfareRetrieveCfg"),ct=e("./cfg/shop/MysteryCfg"),ut=e("./cfg/guild/GuildExpCureCfg"),mt=e("./cfg/accessory/AccessorySpellCfg"),_t=e("./cfg/accessory/AccessorySpellConvertCfg"),dt=e("./cfg/vip/VipAwardCfg"),ft=e("./cfg/active/FragmentConvertCfg"),pt=e("./cfg/active/MysteryActivityCfg"),St=e("./cfg/bianshen/BianshenFetterCfg"),Tt=e("./cfg/bianshen/BianshenConvertCfg"),It=e("./cfg/activeCompete/ActiveCompeteCfg"),vt=e("./cfg/accessory/AccessoryEquipCfg"),At=e("./cfg/ornament/OrnamentCfg"),Ct=game.ConfigMgr={};Ct._config=[],Ct._configProto=null,Ct.register=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:game.BaseCfgType.TYPE_NONE;switch(n){case game.BaseCfgType.TYPE_NONE:if(null==(s=new i).setup)return void b8e.log(e+"未实现 setup 方法");break;case game.BaseCfgType.TYPE_DATA:case game.BaseCfgType.TYPE_ARRAY:var s;(s=new game.BaseCfg).defaultSetupType=n;break;default:return void b8e.log("cls ",e,"配置错误")}Ct._config[t]||b8e.error(e,"配置不存在"),s.name=e,s.setup(Ct._config[t]),game.ccfg[e]=s},Ct._initModuleConfig=function(){Ct.register("ServerCodeCfg","ServerCode",s),Ct.register("MainQuestCfg","MainQuest",n),Ct.register("SceneCfg","Scene",a),Ct.register("ClientSceneEffectCfg","ClientSceneEffect",o),Ct.register("ClientAreaEventCfg","ClientAreaEvent",r),Ct.register("HeroCfg","Hero",h),Ct.register("SpellCfg","Spell",g),Ct.register("MonsterCfg","Monster",l),Ct.register("DungeonCfg","Instance",c),Ct.register("DoorCfg","MovePoint",null,game.BaseCfgType.TYPE_ARRAY),Ct.register("PropertyCfg","Property",null,game.BaseCfgType.TYPE_DATA),Ct.register("PrizeCfg","DropItem",u),Ct.register("ExpCfg","Exp",m),Ct.register("MonGenCfg","MonGen",_),Ct.register("NpcGenCfg","NpcGen",d),Ct.register("ClientMonsterGenCfg","ClientMonsterGen",f),Ct.register("ClientEntityCfg","ClientEntity",p),Ct.register("DialogCfg","Dialog",S),Ct.register("LangCfg","Language",T),Ct.register("NoticeCfg","Notice",I),Ct.register("SpriteStatCfg","AttrList",v),Ct.register("ItemInfoCfg","Prop",A),Ct.register("EquipCfg","Equip",C),Ct.register("WingCfg","Wing",E),Ct.register("MountCfg","Mount",E),Ct.register("FaBaoCfg","Fabao",E),Ct.register("XianZhenCfg","XianZhen",E),Ct.register("EquipSlotIntensifyCfg","EquipSlotUpgrade",b),Ct.register("EquipSlotStarCfg","EquipSlotStar",y),Ct.register("GmCmdCfg","GmCmd",k),Ct.register("GmCmdShortCutCfg","GmCmdShortCut",R),Ct.register("BeautyDataCfg","BeautyData",N),Ct.register("BeautyFavorCfg","BeautyFavor",B),Ct.register("EquipQualitySuitsCfg","SuitQuality",P),Ct.register("EquipStarSuitsCfg","SuitStar",L),Ct.register("AttrRulesCfg","AttrRules",G),Ct.register("EquipTypeCfg","EquipType",M),Ct.register("GlobalParamCfg","GlobalParam",D),Ct.register("BianshenUpgradeJieCfg","BianshenUpgradeJie",w),Ct.register("BianshenUpgradeLvCfg","BianshenUpgradeLv",O),Ct.register("EquipRefineCfg","EquipRefine",null,game.BaseCfgType.TYPE_DATA),Ct.register("LvPowerCoefCfg","LvPowerCoef",U),Ct.register("AttrPowerCoefCfg","AttrPowerCoef",x),Ct.register("EquipQualityCfg","EquipQuality",H),Ct.register("ClientGuideCfg","ClientGuide",F),Ct.register("ClientTriggerCfg","ClientTrigger",q),Ct.register("ClientCommandCfg","ClientCommand",W),Ct.register("ClientViewDescCfg","ClientViewDesc",z),Ct.register("ClientFunctionOpenCfg","ClientFunctionOpen",V),Ct.register("ClientPlotCfg","ClientPlot",Q),Ct.register("DrawDecksCfg","Deck",Y),Ct.register("WelfareCfg","Sign",Z),Ct.register("WelfareGoldCfg","ConvertGold",K),Ct.register("CostCfg","Cost",j),Ct.register("StarCfg","Star",X),Ct.register("EquipRefineColorCfg","EquipRefineColor",J),Ct.register("ShopCfg","Shop",$),Ct.register("GotoCfg","Goto",ee),Ct.register("StrengthenCfg","Strengthen",te),Ct.register("StrengthenPowerCfg","StrengthenPower",ie),Ct.register("BianshenCfg","Bianshen",ne),Ct.register("HeadCfg","Head",se),Ct.register("StrengthenGradeCfg","StrengthenGrade",ae),Ct.register("GuildActivityCfg","GuildActivity",oe),Ct.register("GuildExpCfg","GuildExp",re),Ct.register("GuildQuestAwardCfg","GuildQuestAward",he),Ct.register("GuildQuestCfg","GuildQuest",ge),Ct.register("GuildShaoxiangCfg","Shaoxiang",le),Ct.register("GuildXinfaCfg","Xinfa",ce),Ct.register("ArenaRankPrizeCfg","ArenaRankAward",ue),Ct.register("VipCfg","Vip",me),Ct.register("WorldBossCfg","WorldBoss",_e),Ct.register("RechargeCfg","Recharge",de),Ct.register("NormalRechargeCfg","NormalRecharge",fe),Ct.register("CardRechargeCfg","CardRecharge",pe),Ct.register("RechargeRebateCfg","RechargeRebate",Se),Ct.register("AccumulateRechargeCfg","AccumulateRecharge",Te),Ct.register("LoginPrizeCfg","LoginPrize",Ie),Ct.register("RebateCostCfg","RebateCost",ve),Ct.register("StarGradeCfg","StarGrade",Ae),Ct.register("ClientActiveCfg","ClientActivity",Ce),Ct.register("ActivityCfg","Activity",null,game.BaseCfgType.TYPE_DATA),Ct.register("ClientSettingCfg","ClientSetting",null,game.BaseCfgType.TYPE_DATA),Ct.register("SuraLevelCfg","SuraLevel",Ee),Ct.register("SurakillCfg","SuraKill",be),Ct.register("SuraPrizeCfg","SuraReward",ye),Ct.register("ActiveBarCfg","ActiveBar",null,game.BaseCfgType.TYPE_DATA),Ct.register("DujieCfg","DuJie",ke),Ct.register("SurfaceCfg","Surface",null,game.BaseCfgType.TYPE_DATA),Ct.register("NationalBossCfg","NationalBoss",Re),Ct.register("XiandanCfg","Xiandan",Ne),Ct.register("XiandanBarCfg","XiandanBar",Be),Ct.register("AchievementCfg","Achievement",null,game.BaseCfgType.TYPE_DATA),Ct.register("AchievementAwardCfg","AchievementAward",null,game.BaseCfgType.TYPE_DATA),Ct.register("FundRechargeCfg","FundRecharge",Pe),Ct.register("NickNameCfg","Nickname",Le),Ct.register("WanbaPrizeCfg","WanbaPrize",Ge),Ct.register("MailCfg","Mail",null,game.BaseCfgType.TYPE_DATA),Ct.register("RebirthCfg","Rebirth",Me),Ct.register("NationalAwardCfg","NationalAward",De),Ct.register("ZhanYaoCfg","ZhanYao",we),Ct.register("ZhanYaoAwardCfg","ZhanYaoAward",Oe),Ct.register("SaleDailyCfg","SaleDaily",xe),Ct.register("DiscountDailyCfg","DiscountDaily",null,game.BaseCfgType.TYPE_DATA),Ct.register("ZhuanPanCfg","ZhuanPan",Je),Ct.register("ZhuanPanCostCfg","RouletteConfig",$e),Ct.register("DuoBaoCfg","DuoBao",null,game.BaseCfgType.TYPE_DATA),Ct.register("WorldBossAwardCfg","WorldBossAward",Ue),Ct.register("TianGongGuildAwardCfg","TianGongGuildAward",He),Ct.register("TianGongPlayerAwardCfg","TianGongPlayerAward",Fe),Ct.register("CSTianGongGuildAwardCfg","CSTianGongGuildAward",qe),Ct.register("CSTianGongPlayerAwardCfg","CSTianGongPlayerAward",We),Ct.register("OnlineAwardCfg","OnlineAward",ze),Ct.register("AmuletCfg","Amulet",Ve),Ct.register("WanfaCfg","Wanfa",Qe),Ct.register("WelfareBarCfg","WelfareBar",null,game.BaseCfgType.TYPE_DATA),Ct.register("CountAwardCfg","CountAward",Ye),Ct.register("CollectCfg","Collect",null,game.BaseCfgType.TYPE_DATA),Ct.register("WanBaGameVipCfg","WanbaPrize",Ze),Ct.register("RankBarCfg","RankBar",Ke),Ct.register("FailueBannerCfg","FailueBanner",null,game.BaseCfgType.TYPE_DATA),Ct.register("FunctionPreviewCfg","FunctionPreview",je),Ct.register("HighEquipCfg","HighEquip",Xe),Ct.register("EquipSlotEnchantCfg","Enchant",et),Ct.register("CSArenaQuestAwardCfg","CrossServerArenaQuestAward",null,game.BaseCfgType.TYPE_DATA),Ct.register("CSArenaLevelCfg","CrossServerArenaLv",tt),Ct.register("CSArenaRankAwardCfg","CrossServerArenaRankAward",it),Ct.register("TowerCfg","Tower",nt),Ct.register("RuneCfg","Rune",st),Ct.register("WeekSignCfg","WeekSign",at),Ct.register("CsSuraPrizeCfg","CrossServerSuraReward",ot),Ct.register("CsSuraLevelCfg","CrossServerSuraLevel",rt),Ct.register("GuildBossCfg","GuildBoss",ht),Ct.register("GuildBossAwardCfg","GuildBossAward",gt),Ct.register("WelfareRetrieveCfg","Retrieve",lt),Ct.register("EscortCfg","Escort",null,game.BaseCfgType.TYPE_DATA),Ct.register("GuildExpCureCfg","GuildExpCure",ut),Ct.register("FragmentConvertCfg","FragmentConvert",ft),Ct.register("AccessorySpellCfg","AccessorySpell",mt),Ct.register("AccessorySpellConvertCfg","AccessorySpellConvert",_t),Ct.register("VipAwardCfg","VipAward",dt),Ct.register("MysteryActivityCfg","MysteryActivity",pt),Ct.register("WorldCupBarCfg","WorldCupBar",null,game.BaseCfgType.TYPE_DATA),Ct.register("BianshenFetterCfg","Fetter",St),Ct.register("BianshenConvertCfg","BianshenConvert",Tt),Ct.register("ActiveCompeteCfg","ActiveCompete",It),Ct.register("AccessoryEquipCfg","AccessoryEquip",vt),Ct.register("OrnamentCfg","Ornament",At),Ct.register("ClientRuleImgCfg","ClientRuleImg",null,game.BaseCfgType.TYPE_DATA),game.ccfg.MysteryCfg=new ct},Ct._splitConfig=function(e){return Ct._config=e,Ct._initModuleConfig(),!0},Ct.parseConfig=function(e){return!!Ct._splitConfig(e)&&(game.MoveToHelper.inst().MOVE_SPEED=parseInt(game.ccfg.GlobalCfg.getValue("defaultMoveSpeed"))/1e3,game.CastSpellHelper.inst().minAttackLv=game.ccfg.GlobalParamCfg.getNumber(1206),!0)}},{"./cfg/CSArenaLevelCfg":1091,"./cfg/CSArenaRankAwardCfg":1092,"./cfg/ServerCodeCfg":1093,"./cfg/StarCfg":1094,"./cfg/StarGradeCfg":1095,"./cfg/accessory/AccessoryCfg":1096,"./cfg/accessory/AccessoryEquipCfg":1097,"./cfg/accessory/AccessorySpellCfg":1098,"./cfg/accessory/AccessorySpellConvertCfg":1099,"./cfg/active/ClientActiveCfg":1102,"./cfg/active/FragmentConvertCfg":1103,"./cfg/active/LoginPrizeCfg":1104,"./cfg/active/MysteryActivityCfg":1105,"./cfg/active/RebateCostCfg":1106,"./cfg/activeCompete/ActiveCompeteCfg":1101,"./cfg/amulet/AmuletCfg":1107,"./cfg/arenarankprize/ArenaRankPrizeCfg":1108,"./cfg/beauty/BeautyDataCfg":1109,"./cfg/beauty/BeautyFavorCfg":1110,"./cfg/bianshen/BianshenCfg":1111,"./cfg/bianshen/BianshenConvertCfg":1112,"./cfg/bianshen/BianshenFetterCfg":1113,"./cfg/bianshen/BianshenUpgradeJieCfg":1114,"./cfg/bianshen/BianshenUpgradeLvCfg":1115,"./cfg/cost/CostCfg":1117,"./cfg/countAward/CountAwardCfg":1118,"./cfg/draw/DrawDecksCfg":1119,"./cfg/dujie/DujieCfg":1120,"./cfg/equip/EquipQualityCfg":1121,"./cfg/equip/EquipQualitySuitsCfg":1122,"./cfg/equip/EquipRefineColorCfg":1123,"./cfg/equip/EquipSlotEnchantCfg":1124,"./cfg/equip/EquipSlotIntensifyCfg":1125,"./cfg/equip/EquipSlotStarCfg":1126,"./cfg/equip/EquipStarSuitsCfg":1127,"./cfg/equip/EquipTypeCfg":1128,"./cfg/exp/ExpCfg":1129,"./cfg/functionpreview/FunctionPreviewCfg":1130,"./cfg/fund/FundRechargeCfg":1131,"./cfg/globalParam/GlobalParamCfg":1132,"./cfg/gm/GmCmdCfg":1133,"./cfg/gm/GmCmdShortCutCfg":1134,"./cfg/goto/GotoCfg":1135,"./cfg/guild/GuildActivityCfg":1136,"./cfg/guild/GuildBossAwardCfg":1137,"./cfg/guild/GuildBossCfg":1138,"./cfg/guild/GuildExpCfg":1139,"./cfg/guild/GuildExpCureCfg":1140,"./cfg/guild/GuildQuestAwardCfg":1141,"./cfg/guild/GuildQuestCfg":1142,"./cfg/guild/GuildShaoxiangCfg":1143,"./cfg/guild/GuildXinfaCfg":1144,"./cfg/head/HeadCfg":1145,"./cfg/hero/HeroCfg":1146,"./cfg/item/EquipCfg":1147,"./cfg/item/HighEquipCfg":1148,"./cfg/item/ItemInfoCfg":1149,"./cfg/item/PrizeCfg":1150,"./cfg/language/LangCfg":1151,"./cfg/nationalBoss/NationalAwardCfg":1152,"./cfg/nationalBoss/NationalBossCfg":1153,"./cfg/nickname/NickNameCfg":1154,"./cfg/notice/NoticeCfg":1155,"./cfg/onlineAward/OnlineAwardCfg":1156,"./cfg/ornament/OrnamentCfg":1157,"./cfg/pay/AccumulateRechargeCfg":1158,"./cfg/pay/CardRechargeCfg":1159,"./cfg/pay/NormalRechargeCfg":1160,"./cfg/pay/RechargeCfg":1161,"./cfg/pay/RechargeRebateCfg":1162,"./cfg/power/AttrPowerCoefCfg":1163,"./cfg/power/LvPowerCoefCfg":1164,"./cfg/rank/RankBarCfg":1165,"./cfg/rebirth/RebirthCfg":1166,"./cfg/rechargeActive/SaleDailyCfg":1167,"./cfg/roulette/ZhuanPanCfg":1168,"./cfg/roulette/ZhuanPanCostCfg":1169,"./cfg/rune/RuneCfg":1170,"./cfg/scene/ClientAreaEventCfg":1171,"./cfg/scene/ClientEntityCfg":1172,"./cfg/scene/ClientMonsterGen":1173,"./cfg/scene/ClientSceneEffectCfg":1174,"./cfg/scene/DialogCfg":1175,"./cfg/scene/DungeonCfg":1176,"./cfg/scene/MainQuestCfg":1177,"./cfg/scene/MonGenCfg":1178,"./cfg/scene/MonsterCfg":1179,"./cfg/scene/NpcGenCfg":1180,"./cfg/scene/SceneCfg":1181,"./cfg/shop/MysteryCfg":1182,"./cfg/shop/ShopCfg":1183,"./cfg/spell/SpellCfg":1184,"./cfg/spriteStat/AttrRulesCfg":1185,"./cfg/spriteStat/SpriteStatCfg":1186,"./cfg/strengthen/StrengthenCfg":1187,"./cfg/strengthen/StrengthenGradeCfg":1188,"./cfg/strengthen/StrengthenPowerCfg":1189,"./cfg/sura/CsSuraLevelCfg":1190,"./cfg/sura/CsSuraPrizeCfg":1191,"./cfg/sura/SuraLevelCfg":1192,"./cfg/sura/SuraPrizeCfg":1193,"./cfg/sura/SurakillCfg":1194,"./cfg/tiangong/CSTianGongGuildAwardCfg":1195,"./cfg/tiangong/CSTianGongPlayerAwardCfg":1196,"./cfg/tiangong/TianGongGuildAwardCfg":1197,"./cfg/tiangong/TianGongPlayerAwardCfg":1198,"./cfg/tower/TowerCfg":1199,"./cfg/trigger/ClientCommandCfg":1200,"./cfg/trigger/ClientFunctionOpenCfg":1201,"./cfg/trigger/ClientGuideCfg":1202,"./cfg/trigger/ClientPlotCfg":1203,"./cfg/trigger/ClientTriggerCfg":1204,"./cfg/trigger/ClientViewDescCfg":1205,"./cfg/vip/VipAwardCfg":1206,"./cfg/vip/VipCfg":1207,"./cfg/wanba/WanbaPrizeCfg":1208,"./cfg/wanbagamevip/WanBaGameVipCfg":1209,"./cfg/wanfa/WanfaCfg":1210,"./cfg/welfare/WeekSignCfg":1211,"./cfg/welfare/WelfareCfg":1212,"./cfg/welfare/WelfareGoldCfg":1213,"./cfg/welfare/WelfareRetrieveCfg":1214,"./cfg/worldBoss/WorldBossAwardCfg":1215,"./cfg/worldBoss/WorldBossCfg":1216,"./cfg/xiandan/XiandanBarCfg":1217,"./cfg/xiandan/XiandanCfg":1218,"./cfg/zhanyao/ZhanYaoAwardCfg":1219,"./cfg/zhanyao/ZhanYaoCfg":1220}],1090:[function(e,t,i){"use strict";game.BaseCfgType=b8e.Enum({TYPE_NONE:0,TYPE_DATA:1,TYPE_ARRAY:2}),game.BaseCfg=b8e.Object.extends({name:"BaseCfg",data:null,baseCfgData:null,defaultSetupType:game.BaseCfgType.TYPE_DATA,setup:function(e){if(e){if(this.defaultSetupType==game.BaseCfgType.TYPE_DATA)this.setupIds(e);else{if(this.defaultSetupType!=game.BaseCfgType.TYPE_ARRAY)throw new Error("未知的默认配置类型",this.name);this.setupArray(e)}this.baseCfgData=e}else b8e.log("静态配置",this.name,"拿到了空数据")},setupIds:function(e){this.setupByKey(e,"id")},setupNames:function(e){this.setupByKey(e,"name")},setupArray:function(e){this.setupArrayByKey(e,"id")},setupByKey:function(e,t){var i;this.data=b8e.HashMap.get();for(var n=e.length,s=0;s<n;s++){if(i=e[s],this.data.get(i[t]))return void b8e.error("配置表",this.name," id ",i[t],"重复！！");"id"!=t&&"name"!=t||i[t]||b8e.error("配置表",this.name,"行数",s+4,t,"为空"),this.data.set(i[t],i)}},setupArrayByKey:function(e,t){var i,n;this.data=b8e.HashMap.get();for(var s=e.length,a=0;a<s;a++)i=e[a],(n=this.data.get(i[t]))||(n=[],this.data.set(i[t],n)),n.push(i)},getDataByKey:function(e){return this.data.get(e)},getDataById:function(e){return e instanceof Number?this.data.get(e):this.data.get(Number(e))},getDatas:function(){return this.data?this.data.values():null},getDatasCount:function(){return this.data?this.data.count():0},forEach:function(t,i){this.baseCfgData.forEach(function(e){t.call(i,e)})}}),game.BUILD_LOG&&cc.log("初始化 baseCfg 成功")},{}],1091:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CSArenaLevelCfg",_levelList:null,setup:function(e){this.setupByKey(e,"lv"),this.baseCfgData=e},getLevelByStart:function(e){var t;if(0==e)return 0;for(var i=this.baseCfgData.length,n=i;0<=n;n--)if((t=this.baseCfgData[n])&&e>=t.star)return t.lv;return this.baseCfgData[i-1].lv},getStar:function(e){var t=this.getLevelByStart(e),i=this.getDataById(t);return i?e-i.star:e},getLevelName:function(e){var t=this.getDataById(e);return t?t.name:""},getLevelList:function(){if(!this._levelList){this._levelList=[];for(var e,t=this.baseCfgData.length-1;0<=t;t--)(e=this.baseCfgData[t])&&0!=e.lv&&this._levelList.push(e)}return this._levelList}})},{}],1092:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CSArenaRankAwardCfg",setup:function(e){this.setupByKey(e,"rank")}})},{}],1093:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"ServerCodeCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.id,i.desc)}},getDesc:function(e){var t=this._map.get(e);return t||"系统繁忙，请稍后再试-"+e}})},{}],1094:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"StarCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.refine,i.type);this._map.set(n,i)}}},getStarInfo:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t);return this._map.get(i)}})},{}],1095:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"StarGradeCfg",_starMap:null,_bigStarMap:null,_badgeStarMap:null,_list:null,_map:null,setup:function(e){this._starMap=b8e.HashMap.get(),this._bigStarMap=b8e.HashMap.get(),this._map=b8e.HashMap.get(),this._badgeStarMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.star,i.grade);switch(i.type){case game.StarType.BIANSHEN_STAR:this._starMap.set(n,i),this._map.set(i.type,this._starMap);break;case game.StarType.BIANSHEN_DETAILS_STAR:this._bigStarMap.set(n,i),this._map.set(i.type,this._bigStarMap);break;case game.StarType.CSARENA_MAIN_STAR:this._badgeStarMap.set(n,i),this._map.set(i.type,this._badgeStarMap)}}}},getStarGradeInfo:function(e,t,i){var n=this._map.get(i);if(!n)return null;var s=b8e.CommonUtil.xyToInt(e,t);return n.get(s)}})},{}],1096:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({_maxLv:0,_maxStage:0,_minStageCfg:null,_maxStageCfg:null,setup:function(e){var t,i;e||b8e.log("dont have datas"),this._minStageCfg=b8e.HashMap.get(),this._maxStageCfg=b8e.HashMap.get(),this.data=b8e.HashMap.get(),this._spellList=[],this._unLockList=[];for(var n=0;n<e.length;n++)t=e[n],this.data.set(t.lv,t),this._minStageCfg.get(t.stage)||this._minStageCfg.set(t.stage,t),(!(i=this._maxStageCfg.get(t.stage))||i.lv<t.lv)&&this._maxStageCfg.set(t.stage,t)},getMaxLv:function(){if(0==this._maxLv&&this.data)for(var e,t=this.data.values(),i=t.length-1;0<=i;i--)if(0==(e=t[i]).expLimit&&0<e.stage){this._maxLv=e.lv;break}return this._maxLv},getMinStageLvCfg:function(e){return this._minStageCfg.get(e)},getMaxStageLvCfg:function(e){return this._maxStageCfg.get(e)},getMaxStage:function(){if(0==this._maxStage&&this.data)for(var e,t=this.data.values(),i=t.length-1;0<=i;i--)if(0==(e=t[i]).expLimit&&0<e.stage){this._maxStage=e.stage;break}return this._maxStage},getSpellIdByLv:function(e){return this.data.get(e).unlockedSpell}})},{}],1097:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AccessoryEquipCfg",_mountEquipMap:null,ctor:function(){this._super(),this._mountEquipMap=b8e.HashMap.get()},setup:function(e){if(e){var t;this.setupByKey(e,"itemId");for(var i=0;i<e.length;++i)(t=this._mountEquipMap.get(e[i].slot))||(t=[],this._mountEquipMap.set(e[i].slot,t)),t.push(e[i]);this._mountEquipMap.forEach(function(e,t){t.sort(this.sortByLevel)},this)}},sortByLevel:function(e,t){return e.level-t.level},getItemInfoById:function(e){var t=this.getDataByKey(e);return t||0},getupgradeCostByItemId:function(e){var t=this.getDataByKey(e);return t&&t.upgradeCost?t.upgradeCost[0].Num:0},getCostItemId:function(e){var t=this.getDataByKey(e);return t&&t.upgradeCost?t.upgradeCost[0].Id:0},getLevelByItemId:function(e){var t=this.getDataByKey(e);return t?t.level:0},getDujieLevelByItemId:function(e){var t=this.getDataByKey(e);return t?t.dujie:0},getDatasByEquipType:function(e){return this._mountEquipMap.get(e)},getCompoundEquipInfo:function(e){var t=this._mountEquipMap.get(e);return t&&0<t.length?t[0]:null},getHeightEquipLevel:function(e){var t=this._mountEquipMap.get(e);return t&&0<t.length?t[t.length-1].level:0}})},{}],1098:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AccessorySpellCfg",setup:function(e){this.setupIds(e)},getSpellIds:function(){return this.data?this.data.keys():null}})},{}],1099:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AccessorySpellConvertCfg",_map:null,ctor:function(){this._super(),this._map=b8e.HashMap.get()},setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.type,i.quality);this._map.set(n,i)}}},getData:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._map.get(i);return n||null},getProbability:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._map.get(i);return n?n.rate:0}})},{}],1100:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({_unLockList:null,_maxLv:0,_maxStage:0,_minStageCfg:null,setup:function(e){var t;this._minStageCfg=b8e.HashMap.get(),this.data=b8e.HashMap.get(),this._unLockList=[];for(var i=0;i<e.length;i++)t=e[i],this.data.set(t.lv,t),this._minStageCfg.get(t.stage)||this._minStageCfg.set(t.stage,t)},getMaxLv:function(){if(0==this._maxLv)for(var e,t=this.data.values(),i=t.length-1;0<=i;i--)if(0==(e=t[i]).expLimit){this._maxLv=e.lv;break}return this._maxLv},getMinStageLvCfg:function(e){return this._minStageCfg.get(e)},getMaxStage:function(){if(0==this._maxStage)for(var e,t=this.data.values(),i=t.length-1;0<=i;i--)if(0==(e=t[i]).expLimit){this._maxStage=e.stage;break}return this._maxStage},getSpellListByLv:function(e){return this.data.get(e).unlockedSpell}})},{}],1101:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ActiveCompeteCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"openDay")},getActiveDatas:function(){var e=this.getDatas();return e||null}})},{}],1102:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({setup:function(e){this.setupByKey(e,"type")}})},{}],1103:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"FragmentConvertCfg",_repMap:null,ctor:function(){this._super(),this._repMap=b8e.HashMap.get()},setup:function(e){for(var t,i=0;i<e.length;i++){var n=e[i];n&&((t=this._repMap.get(n.repository))||(t=b8e.HashMap.get(),this._repMap.set(n.repository,t)),t.set(n.itemId,n))}},getData:function(e,t){var i=this._repMap.get(e);if(i){var n=i.get(t);if(n)return n}return null}})},{}],1104:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({setup:function(e){this.setupByKey(e,"days")}})},{}],1105:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({shopIdsMap:null,repositoryMap:null,setup:function(e){var t,i;this.shopIdsMap=b8e.HashMap.get(),this.repositoryMap=b8e.HashMap.get();for(var n=0;n<e.length;n++)t=e[n],(i=this.repositoryMap.get(t.repository))||(i=[],this.repositoryMap.set(t.repository,i)),i.push(t),this.shopIdsMap.set(t.id,t)},getCfgByShopId:function(e){return this.shopIdsMap.get(e)},getCfgListByRepository:function(e){return this.repositoryMap.get(e)}})},{}],1106:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"RebateCostCfg",_map:null,_countMap:null,ctor:function(){this._super(),this._map=b8e.HashMap.get(),this._countMap=b8e.HashMap.get()},setup:function(e){for(var t,i=0;i<e.length;i++){var n=e[i];if(n){var s=b8e.CommonUtil.xyToInt(n.id,n.count);this._map.set(s,n),(t=this._countMap.get(n.id))||(t=[],this._countMap.set(n.id,t)),t.push(n.count),this._countMap.set(n.id,t)}}},getData:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._map.get(i);return n||null},getCount:function(e,t){var i=this._countMap.get(e);if(i&&0<i.length){for(var n=i.length-1;0<=n;n--){var s=i[n];if(s<=t)return s}return i[0]}return 0},getNextCfg:function(e,t){var i=this._countMap.get(e),n=0;if(i&&0<i.length){for(var s=i.length-1;0<=s;s--){var a=i[s];if(a<=t){n=i[s+1]?i[s+1]:a;break}}0==n&&i[1]&&(n=i[1])}var o=this.getData(e,n);return o||null},getRebateList:function(e){return this._countMap.get(e)}})},{}],1107:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AmuletCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"level")},getAmuletNameByLevel:function(e){0==e&&e++;var t="",i=this.getDataByKey(e);return i&&(t=i.name),t},getAmuletStateByLevel:function(e){if(0==e)return 1;var t=this.getDataByKey(e);return t?t.state:0},getAmuletReputationByLevel:function(e){var t=this.getDataByKey(e);return t?t.reputation:0},getAmuletAttrByLevel:function(e){var t=this.getDataByKey(e);return t?t.attr:0},getnextAmuletAttrByLevel:function(e){var t=this.getDatas();return!t||t.length<=0?0:e<=t[t.length-1].level?this.getAmuletAttrByLevel(e):0},getResIndexByLevel:function(e){if(0==e)return 1;var t=this.getDataByKey(e);return t?t.index:1}})},{}],1108:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ArenaRankPrizeCfg",_rankPrizeList:null,ctor:function(){this._super(),this._rankPrizeList=[]},setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.ArenaRankPrizeInfo;n._rank=i.rank,n._dropId=i.dropId,n.id=t,this._rankPrizeList.push(n)}}},getrankPrize:function(){return this._rankPrizeList}})},{}],1109:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"BeautyDataCfg",_beautyMap:null,ctor:function(){this._super()},setup:function(e){this.setupIds(e)},getBeautyDatas:function(){return this.data},getBeautyInfoById:function(e){return this.data.get(e)},getBeautyUnlockTalkById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.unlockTalk}return[]},getBeautyUpgradeTalkById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.upgradeTalk}return[]},getBeautyUseTalkById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.useTalk}return[]},getBeautyCostPowerById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.costPower}return 0},getBeautyReputationById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.reputation}return 0},getBeautyLevelById:function(e){if(this.data){var t=this.data.get(e);if(t)return t.level}return 0}})},{}],1110:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"BeautyFavorCfg",_beautyFavorMap:null,_maxBeautyFavorLevel:null,ctor:function(){this._super()},setup:function(e){this._beautyFavorMap=b8e.HashMap.get(),this._maxBeautyFavorLevel=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.BeautyFavorInfo;n.id=i.id,n.level=i.level,n.roleLv=i.roleLv,n.setData(i.items),n.attrId=i.attrId,n.fightAmount=i.fightAmount,n.basePrize=i.basePrize,n.randomPrize=i.randomPrize;var s=b8e.CommonUtil.xyToInt(n.id,n.level);this._beautyFavorMap.set(s,n)}}this.setMaxBeautyFavorLevel(e)},setMaxBeautyFavorLevel:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._maxBeautyFavorLevel.get(i.id);n?i.level>n&&this._maxBeautyFavorLevel.set(i.id,i.level):this._maxBeautyFavorLevel.set(i.id,i.level)}}},getMaxBeautyFavorLevel:function(e){if(this._maxBeautyFavorLevel){var t=this._maxBeautyFavorLevel.get(e);if(t)return t}return 0},getBeautyInfoById:function(e,t){if(this._beautyFavorMap){var i=b8e.CommonUtil.xyToInt(e,t),n=this._beautyFavorMap.get(i);if(n)return n}return null},getBeautyAttrId:function(e,t){if(this._beautyFavorMap){var i=b8e.CommonUtil.xyToInt(e,t),n=this._beautyFavorMap.get(i);if(n)return n.attrId}return 0},getBeautyUpgradeInfo:function(e,t){if(this._beautyFavorMap){var i=b8e.CommonUtil.xyToInt(e,t),n=this._beautyFavorMap.get(i);if(n)return n.upgradeInfo}return null},getBeautyFightAmountById:function(e,t){if(this._beautyFavorMap){var i=b8e.CommonUtil.xyToInt(e,t),n=this._beautyFavorMap.get(i);if(n)return n.fightAmount}return 0}})},{}],1111:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"BianshenCfg",datas:null,archive:null,_resolveIdList:null,setup:function(e){var t,i;this.datas=b8e.HashMap.get(),this.archive=b8e.HashMap.get(),this._resolveIdList=[];for(var n=0,s=0;s<e.length;s++)if(t=e[s]){if(this.datas.set(t.id,t),t.resolveAward&&0<t.resolveAward.length)for(n=0;n<t.resolveAward.length;n++)-1==this._resolveIdList.indexOf(t.resolveAward[n].Id)&&this._resolveIdList.push(t.resolveAward[n].Id);(i=new game.BianshenInfo).setup(t),this.archive.set(i.id,i)}},getResolveIdList:function(){return this._resolveIdList},getBianshenCfgById:function(e){return this.archive.get(e)},getArchiveShowMap:function(){var e=this.archive;if(e&&0<e.count()){for(var t,i=this.archive.values(),n=0;n<i.length;n++)0==(t=i[n]).needShow&&this.archive.del(t.id);return e}return null},getQuilatyEffectById:function(e){var t=this.datas.get(e);return t?t.qualityEffect:""},getNameById:function(e){var t=this.datas.get(e);return t?t.name:""},getIconById:function(e){var t=this.datas.get(e);return t?t.icon:""},getGenreById:function(e){var t=this.datas.get(e);return t?t.genre:0},getStarById:function(e){var t=this.datas.get(e);return t?t.star:0},getQualityById:function(e){var t=this.datas.get(e);return t?t.color:0},getAttrById:function(e){var t=this.datas.get(e);return t?t.attr:0},getExpById:function(e){var t=this.datas.get(e);return t?t.conToExp:0},getAttrBonusCoefById:function(e){var t=this.datas.get(e);return t?t.attrBonusCoef:0},getUiPosterById:function(e){var t=this.datas.get(e);return t?t.uiposter:0},getDtById:function(e){var t=this.datas.get(e);return t?t.dt:0},getQzById:function(e){var t=this.datas.get(e);return t?t.qz:0},getKzById:function(e){var t=this.datas.get(e);return t?t.kz:0},getFzById:function(e){var t=this.datas.get(e);return t?t.fz:0},getScById:function(e){var t=this.datas.get(e);return t?t.sc:0},getRestraintRate:function(e){var t=this.datas.get(e);return t?t.restraintRate:0},canActive:function(e){var t=this.datas.get(e);return!!t&&t.active},getGoto:function(e){var t=this.datas.get(e);return t?t.goto:null},getSortId:function(e){var t=this.datas.get(e);return t?t.sort:0},getFetterById:function(e){var t=this.datas.get(e);return t?t.fetterType:null},getResolveAwardById:function(e){var t=this.datas.get(e);return t?t.resolveAward:null},getDataById:function(e){return this.datas.get(e)},getArchiveDatas:function(){return this.archive.values()}})},{}],1112:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"BianshenConvertCfg",_costItemList:null,_convertTypeMap:null,_resolveMap:null,setup:function(e){var t,i,n;this._costItemList=[],this._convertTypeMap=b8e.HashMap.get(),this._resolveMap=b8e.HashMap.get(),this.setupIds(e);for(var s=0;s<e.length;s++)(i=e[s])&&(this._resolveMap.set(i.protoId,i),(n=this._convertTypeMap.get(i.type))||(n=[]),n.push(i),this._convertTypeMap.set(i.type,n),i.convertCost&&0<i.convertCost.length&&(t=i.convertCost[0].Id,-1==this._costItemList.indexOf(t)&&this._costItemList.push(t)))},getConvertCostItemId:function(){return this._costItemList},getListByType:function(e){var t=this._convertTypeMap.get(e);return t||null},getCfgByProtoId:function(e){return this._resolveMap.get(e)}})},{}],1113:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"BianshenFetterCfg",datas:null,typeDatas:null,setup:function(e){var t,i,n;this.datas=b8e.HashMap.get(),this.typeDatas=b8e.HashMap.get();for(var s=0;s<e.length;s++)(t=e[s])&&(i=b8e.CommonUtil.xyToInt(t.type,t.level),this.datas.set(i,t),(n=this.typeDatas.get(t.type))?n.push(t):((n=[]).push(t),this.typeDatas.set(t.type,n)))},getDataByTypeAndLv:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t);return this.datas.get(i)},getDatasByType:function(e){return this.typeDatas.get(e)}})},{}],1114:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"BianshenUpgradeJieCfg",setup:function(e){this.setupJie(e)},setupJie:function(e){var t;this.data=b8e.HashMap.get();for(var i=0;i<e.length;i++)t=e[i],this.data.set(t.jie,t)},getBianshenByJie:function(e){return this.data.get(Number(e))},getCostBianshenNumberByJie:function(e){var t=this.data.get(Number(e));return t?t.costBianshenNumber:0},getAttrCoefByJie:function(e){var t=this.data.get(Number(e));return t?t.attrCoef:0},getMaxJie:function(){var e=this.data.values();if(e.sort(this.onSort),e&&0<e.length){var t=e[e.length-1];if(t)return t.jie}return 0},onSort:function(e,t){return e.jie>t.jie?1:e.jie<t.jie?-1:0}})},{}],1115:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"BianshenUpgradeLvCfg",setup:function(e){this.setupLv(e)},setupLv:function(e){var t;this.data=b8e.HashMap.get();for(var i=0;i<e.length;i++)t=e[i],this.data.set(t.lv,t)},getDataByLv:function(e){return this.data.get(Number(e))},getBianshenExp:function(e,t){var i=this.getDataByLv(e),n=0;switch(t){case 0:n=i.expLimit;break;case 1:n=i.expLimit1;break;case 2:n=i.expLimit2;break;case 3:n=i.expLimit3;break;case 4:n=i.expLimit4}return n},getBianshenMaterialExp:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=0,n=1;n<e;n++)i+=this.getExpLimit(n,t);return i},getExpLimit:function(e,t){var i=this.getDataByLv(e);if(!i)return 0;switch(t){case 0:return i.expLimit;case 1:return i.expLimit1;case 2:return i.expLimit2;case 3:return i.expLimit3;case 4:return i.expLimit4;default:return 0}},getBianshenMaxUpExp:function(e,t){for(var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=0,s=e;s<=t;s++)this.getDataByLv(s)&&(n+=this.getExpLimit(s,i));return n},getMaxLv:function(){var e=this.data.values();if(e.sort(this.onSort),e&&0<e.length){var t=e[e.length-1];if(t)return t.lv}return 0},getBianshenAttrCoefByLv:function(e){var t=0,i=this.getDataByLv(e);return i&&(t=i.attrCoef),t},onSort:function(e,t){return e.lv>t.lv?1:e.lv<t.lv?-1:0}})},{}],1116:[function(e,t,i){"use strict";e("./BaseCfg")},{"./BaseCfg":1090}],1117:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"CostCfg",_map:null,_maxBuyCountArr:null,ctor:function(){this._super(),this._map=b8e.HashMap.get(),this._maxBuyCountArr=b8e.HashMap.get()},setup:function(e){for(var t,i,n,s=0;s<e.length;s++)(t=e[s])&&((i=new game.CostInfo).id=t.id,i.num=t.num,i.setData(t.items),n=b8e.CommonUtil.xyToInt(i.id,i.num),this._map.set(n,i));this.setMaxBuyCountArr(e)},getCostInfoByIdAndNum:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t);return this._map.get(i)},setMaxBuyCountArr:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=this._maxBuyCountArr.get(i.id);n?i.num>n&&this._maxBuyCountArr.set(i.id,i.num):this._maxBuyCountArr.set(i.id,i.num)}}},getMaxBuyCountById:function(e){if(this._maxBuyCountArr){var t=this._maxBuyCountArr.get(e);if(t)return t}return 0},getNextCost:function(e,t){var i=this.getMaxBuyCountById(e),n=i<=t?i:t+1,s=this.getCostInfoByIdAndNum(e,n);return s?s.upgradeInfo.amountInfo.getValue(game.AmountType.YUAN_BAO):0},getNextCostInfo:function(e,t){var i=this.getMaxBuyCountById(e),n=i<=t?i:t+1,s=this.getCostInfoByIdAndNum(e,n);return s||null}})},{}],1118:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CountAwardCfg",ctor:function(){this._super()},setup:function(e){this.setupArrayByKey(e,"countType")},getCountAwardListByType:function(e){var t=this.getDataByKey(e);return t&&0<t.length?t:null},getMaxAwardCountByType:function(e){var t=this.getDataByKey(e);return t&&0<t.length?t[t.length-1].count:1}})},{}],1119:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({setup:function(e){this.setupByKey(e,"id")},getBianshenCards:function(e){var t=this.getDataByKey(e);return game.ccfg.PrizeCfg.getPrizeById(t.normalDropId)}})},{}],1120:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"DujieCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"lv")},getDataByLevel:function(e){var t=this.getDataByKey(e);return t||0},getLastLv:function(){var e,t=this.getDatas();return t[t.length-1]&&(e=t[t.length-1].lv),e},getInsIDByLevel:function(e){var t=this.getDataByKey(e);return t?t.insId:0},getNameByLevel:function(e){var t=this.getDataByKey(e);return t?t.name:0},getTaskListByLevel:function(e){var t=this.getDataByKey(e);return t?t.conditions:0},getTaskByType:function(e,t){var i=this.getDataByKey(e);if(!i)return null;for(var n=0;n<i.conditions.length;n++)if(i.conditions[n].Type==t)return i.conditions[n];return null},getattrIDByLevel:function(e){var t=this.getDataByKey(e);return t?t.attrID:0}})},{}],1121:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"EquipQualityCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.id,i)}},getEquipQualityInfoByQuality:function(e){return this._map.get(e)},getAppendMaxByQuality:function(e){return this._map&&0<this._map.count()?this._map.get(e).max:0}})},{}],1122:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"EquipQualitySuitsCfg",_equipSuitsMap:null,_equipLevelArr:null,_equipQualityArr:null,_map:null,setup:function(e){this._equipSuitsMap=b8e.HashMap.get(),this._map=b8e.HashMap.get(),this._equipLevelArr=[],this._equipQualityArr=[];for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.EquipSuitsInfo;n.id=i.id,n.level=i.level,n.quality=i.quality,n.attrId=i.attrId;var s=game.ccfg.SpriteStatCfg.getSpriteStatById(n.attrId);n.suitsSpriteStat=s;var a=b8e.CommonUtil.xyToInt(n.level,n.quality);this._equipSuitsMap.set(a,n),this._map.set(n.id,n),-1==this._equipLevelArr.indexOf(n.level)&&this._equipLevelArr.push(n.level),-1==this._equipQualityArr.indexOf(n.quality)&&this._equipQualityArr.push(n.quality)}}this._equipLevelArr.sort(this.onSortLevel),this._equipQualityArr.sort(this.onSortQuality)},onSortLevel:function(e,t){return t<e?1:e<t?-1:0},onSortQuality:function(e,t){return t<e?1:e<t?-1:0},getSuitsInfoById:function(e){return this._map.get(e)},getSuitsInfoByLevelAndQuality:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._equipSuitsMap.get(i);return n||null},getNextEquipQualitySuitsLevel:function(e){if(this._equipLevelArr&&0<this._equipLevelArr.length){var t=this._equipLevelArr.indexOf(e);return t+1<this._equipLevelArr.length?this._equipLevelArr[t+1]:-1}return 0},getFirstLevel:function(){return this._equipLevelArr&&0<this._equipLevelArr.length?this._equipLevelArr[0]:0},getMaxLevel:function(){return this._equipLevelArr&&0<this._equipLevelArr.length?this._equipLevelArr[this._equipLevelArr.length-1]:0},getFirstQuality:function(){return this._equipQualityArr&&0<this._equipQualityArr.length?this._equipQualityArr[0]:0},getMaxQuality:function(){return this._equipQualityArr&&0<this._equipQualityArr.length?this._equipQualityArr[this._equipQualityArr.length-1]:0}})},{}],1123:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"EquipRefineColorCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.level,i.type);this._map.set(n,i)}}},getEquipRefineColorInfo:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t);return this._map.get(i)},getColor:function(e,t,i){var n=game.html.Q_WHITE,s=this.getEquipRefineColorInfo(e,t);if(s){if(i>=s.white&&i<s.green)return game.html.Q_WHITE;if(i>=s.green&&i<s.blue)return game.html.Q_GREEN;if(i>=s.blue&&i<s.purple)return game.html.Q_BLUE;if(i>=s.purple&&i<s.yellow)return game.html.Q_PURPLE;if(i>=s.yellow&&i<s.red)return game.html.Q_YELLOW;if(i>s.red)return game.html.Q_RED}return n},getColorStr:function(e,t,i,n){var s=this.getColor(e,t,i);return game.html.getText(s,n)}})},{}],1124:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"EquipSlotEnchantCfg",_equipSlotTypeMap:null,ctor:function(){this._super(),this._equipSlotTypeMap=b8e.HashMap.get()},setup:function(e){if(e){var t;this.setupByKey(e,"id");for(var i=0;i<e.length;++i)(t=this._equipSlotTypeMap.get(e[i].equipType))||(t=[],this._equipSlotTypeMap.set(e[i].equipType,t)),t.push(e[i]);this._equipSlotTypeMap.forEach(function(e,t){t.sort(this.sortByLevel)},this)}},getNameById:function(e){var t=this.getDataByKey(e);return t?t.name:""},getLevelById:function(e){var t=this.getDataByKey(e);return t?t.level:0},getAttrById:function(e){var t=this.getDataByKey(e);return t?t.attr:0},getCostItemId:function(e){var t=this.getDataByKey(e);return t&&t.cost?t.cost[0].Id:0},getCostItemNum:function(e){var t=this.getDataByKey(e);return t&&t.cost?t.cost[0].Num:0},getFirstDataByType:function(e){var t=this._equipSlotTypeMap.get(e);return!t&&t.length<=0?null:t[0]},getDataId:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this._equipSlotTypeMap.get(e);if(!i&&i.length<=0)return 0;for(var n=0;n<i.length;++n)if(t<=i[n].level)return i[n].id;return 0},sortByLevel:function(e,t){return e.level-t.level}})},{}],1125:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"EquipSlotIntensifyCfg",_equipSlotIntensifyMap:null,_weaponMap:null,_armorMap:null,_beltMap:null,_ringMap:null,_helmMap:null,_necklaceMap:null,_legguardMap:null,_shoeMap:null,setup:function(e){this._weaponMap=b8e.HashMap.get(),this._armorMap=b8e.HashMap.get(),this._beltMap=b8e.HashMap.get(),this._ringMap=b8e.HashMap.get(),this._helmMap=b8e.HashMap.get(),this._necklaceMap=b8e.HashMap.get(),this._legguardMap=b8e.HashMap.get(),this._shoeMap=b8e.HashMap.get(),this._equipSlotIntensifyMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.EquipSlotIntensifyInfo;switch(n.id=i.id,n.level=i.level,n.roleLv=i.roleLv,n.attrId=i.attrId,n.setData(i.items),n.id){case game.GoodsType.WEAPON:this._weaponMap.set(n.level,n);break;case game.GoodsType.ARMOR:this._armorMap.set(n.level,n);break;case game.GoodsType.BELT:this._beltMap.set(n.level,n);break;case game.GoodsType.RING:this._ringMap.set(n.level,n);break;case game.GoodsType.HELM:this._helmMap.set(n.level,n);break;case game.GoodsType.NECKLACE:this._necklaceMap.set(n.level,n);break;case game.GoodsType.LEGGUARD:this._legguardMap.set(n.level,n);break;case game.GoodsType.SHOE:this._shoeMap.set(n.level,n)}}}this._equipSlotIntensifyMap.set(game.GoodsType.WEAPON,this._weaponMap),this._equipSlotIntensifyMap.set(game.GoodsType.ARMOR,this._armorMap),this._equipSlotIntensifyMap.set(game.GoodsType.BELT,this._beltMap),this._equipSlotIntensifyMap.set(game.GoodsType.RING,this._ringMap),this._equipSlotIntensifyMap.set(game.GoodsType.HELM,this._helmMap),this._equipSlotIntensifyMap.set(game.GoodsType.NECKLACE,this._necklaceMap),this._equipSlotIntensifyMap.set(game.GoodsType.LEGGUARD,this._legguardMap),this._equipSlotIntensifyMap.set(game.GoodsType.SHOE,this._shoeMap)},getMaxIntensifyLevel:function(e,t){if(this._equipSlotIntensifyMap){var i=this._equipSlotIntensifyMap.get(e);if(i){var n=i.values();if(n.sort(this.onSort),n&&0<n.length){var s=n[n.length-1];if(s)return s.level}}}return 0},onSort:function(e,t){return e.slotLevel>t.slotLevel?1:e.slotLevel<t.slotLevel?-1:0},isMaxIntensifyLevel:function(e,t){return this.getMaxIntensifyLevel(e,t)<=t},getIntensifyInfo:function(e,t){if(this._equipSlotIntensifyMap){var i=this._equipSlotIntensifyMap.get(e);if(i){var n=i.get(t);if(n)return n}}return null},getIntensifyAttrId:function(e,t){if(this._equipSlotIntensifyMap){var i=this._equipSlotIntensifyMap.get(e);if(i){var n=i.get(t);if(n)return n.attrId}}return-1},getIntensifyUpgradeInfo:function(e,t){if(this._equipSlotIntensifyMap){var i=this._equipSlotIntensifyMap.get(e);if(i){var n=i.get(t);if(n)return n.upgradeInfo}}return null}})},{}],1126:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"EquipSlotStarCfg",_equipSlotUpMap:null,setup:function(e){this._equipSlotUpMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.EquipSlotStarInfo;n.slotStar=i.id,n.roleLv=i.roleLv,n.attrRate=i.attrRate/100,n.rate=i.rate/1e3,n.failAddRate=i.failAddRate/1e3,n.setUpgradeInfo(i.items),this._equipSlotUpMap.set(n.slotStar,n)}}},getEquipSlotStarInfoById:function(e){return this._equipSlotUpMap.get(e)},getMaxSlotStar:function(){if(this._equipSlotUpMap){var e=this._equipSlotUpMap.keys();if(e&&0<e.length)return e.length-1}return 0}})},{}],1127:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"EquipStarSuitsCfg",_equipSuitsMap:null,_equipLevelArr:null,_equipStarArr:null,_map:null,setup:function(e){this._equipSuitsMap=b8e.HashMap.get(),this._map=b8e.HashMap.get(),this._equipLevelArr=[],this._equipStarArr=[];for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.EquipSuitsInfo;n.id=i.id,n.level=i.level,n.star=i.star,n.attrId=i.attrId;var s=game.ccfg.SpriteStatCfg.getSpriteStatById(n.attrId);n.suitsSpriteStat=s;var a=b8e.CommonUtil.xyToInt(n.level,n.star);this._equipSuitsMap.set(a,n),this._map.set(n.id,n),-1==this._equipLevelArr.indexOf(n.level)&&this._equipLevelArr.push(n.level),-1==this._equipStarArr.indexOf(n.star)&&this._equipStarArr.push(n.star)}}this._equipLevelArr.sort(this.onSort),this._equipStarArr.sort(this.onSort)},onSort:function(e,t){return t<e?1:e<t?-1:0},getSuitsInfoById:function(e){return this._map.get(e)},getSuitsInfoByLevelAndStar:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._equipSuitsMap.get(i);return n||null},getNextEquipStarSuitsLevel:function(e){if(this._equipLevelArr&&0<this._equipLevelArr.length){var t=this._equipLevelArr.indexOf(e);return t+1<this._equipLevelArr.length?this._equipLevelArr[t+1]:-1}return 0},getFirstLevel:function(){return this._equipLevelArr&&0<this._equipLevelArr.length?this._equipLevelArr[0]:0},getFirstStar:function(){return this._equipStarArr&&0<this._equipStarArr.length?this._equipStarArr[0]:0},maxEquipLevel:function(){return this._equipLevelArr&&0<this._equipLevelArr.length?this._equipLevelArr[this._equipLevelArr.length-1]:0},maxEquipStar:function(){return this._equipStarArr&&0<this._equipStarArr.length?this._equipStarArr[this._equipStarArr.length-1]:0}})},{}],1128:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"EquipTypeCfg",_equipTypeMap:null,setup:function(e){this._equipTypeMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._equipTypeMap.set(i.type,i.name)}},getEquipTypeNameByType:function(e){return this._equipTypeMap.get(e)}})},{}],1129:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ExpCfg",_expMap:null,setup:function(e){this._expMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._expMap.set(i.level,i)}},getExpByLevel:function(e){var t=this._expMap.get(e);return t?t.exp:0},getCfgByLevel:function(e){var t=this._expMap.get(e);return t||null}})},{}],1130:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"FunctionPreviewCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")}})},{}],1131:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"FundRechargeCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"level")},getFundRechargeArr:function(){return this.getDatas()}})},{}],1132:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GlobalParamCfg",setup:function(e){this.setupIds(e)},getGlobalParamById:function(e){return this.data.get(Number(e))},getData:function(e){var t=this.data.get(Number(e));return t?t.value:""},getNumber:function(e){var t=this.data.get(Number(e));return t?Number(t.value):0}})},{}],1133:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GmCmdCfg",setup:function(e){this.setupByKey(e,"name")}})},{}],1134:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"GmCmdShortCutCfg",_gmCmdShortCutList:null,setup:function(e){this._gmCmdShortCutList=[];for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.GmCmdShortCut;n.desc=i.desc,n.cmdLine=i.cmdLine,this._gmCmdShortCutList.push(n)}}},getAllCmdShortCutList:function(){return this._gmCmdShortCutList}})},{}],1135:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GotoCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")}})},{}],1136:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"GuildActivityCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.id,i)}},getAllGuildActivityInfoMap:function(){return this._map},getAllGuildActivityInfoList:function(){if(!this._map)return null;var e=this._map.values();return!e||e.length<=0?null:(e.sort(this.onSort),e)},onSort:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},getGuildActivityInfoById:function(e){return this._map.get(e)}})},{}],1137:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildBossAwardCfg",setup:function(e){this.setupByKey(e,"level")},getCfgByLevel:function(){for(var e=game.mainRole.mainRoleData.getLv(),t=this.data.keys(),i=0,n=t.length-1;0<=n&&!((i=t[n])<=e);n--);var s=this.getDataById(i);return s||null}})},{}],1138:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildBossCfg",_map:null,ctor:function(){this._super(),this._map=b8e.HashMap.get()},setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.id,i.startServer);this._map.set(n,i)}}},getData:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._map.get(i);return n||null}})},{}],1139:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"GuildExpCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.level,i)}},getAllGuildExpInfoMap:function(){return this._map},getGuildExpInfoByLevel:function(e){return this._map.get(e)}})},{}],1140:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildExpCureCfg",_map:null,setup:function(e){this.setupByKey(e,"levelInterval"),this.baseCfgData=e},getCfgByLevelDiff:function(e){return this.getDataById(e)}})},{}],1141:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildQuestAwardCfg",_map:null,_weekAwardMap:null,setup:function(e){this._map=b8e.HashMap.get(),this._weekAwardMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&(1==i.awardType?this._map.set(i.id,i):this._weekAwardMap.set(i.id,i))}},getQuestAwardList:function(){if(!this._map)return null;var e=this._map.values();return!e||e.length<=0?null:(e.sort(this.onSort),e)},getQuestAwardById:function(e){return this._map.get(e)},getMaxScore:function(){if(!this._map)return 0;var e=this._map.values();return!e||e.length<=0?0:(e.sort(this.onSort),e.length>=e.length-1?e[e.length-1].score:0)},getWeekAwardList:function(){if(!this._weekAwardMap)return null;var e=this._weekAwardMap.values();return!e||e.length<=0?null:(e.sort(this.onSort),e)},getWeekAwardById:function(e){return this._weekAwardMap.get(e)},onSort:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}})},{}],1142:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"GuildQuestCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.id,i)}},getAllGuildDailyQuestInfoMap:function(){return this._map},getAllGuildDailyQuestInfoList:function(){if(!this._map)return null;var e=this._map.values();return!e||e.length<=0?null:(e.sort(this.onSort),e)},onSort:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},getGuildDailyQuestInfoById:function(e){return this._map.get(e)}})},{}],1143:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildShaoxiangCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")},getShaoxiangDatas:function(){return this.getDatas()},getShaoxiangNameById:function(e){var t=this.getDataById(e);return t?t.name:""},getShaoxiangExpById:function(e){var t=this.getDataById(e);return t?t.exp:0},getShaoxiangcontributionById:function(e){var t=this.getDataById(e);return t?t.contribution:0}})},{}],1144:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"GuildXinfaCfg",xinfaMap:null,ctor:function(){this._super(),this.xinfaMap=b8e.HashMap.get()},setup:function(e){for(var t=0,i=0;i<e.length;++i)t<e[i].xinfaType&&(t=e[i].xinfaType);var n=0;for(i=0;i<=t;++i){for(var s=[],a=0;a<e.length;++a)e[a].xinfaType==n&&(s.push(e[a]),this.xinfaMap.set(n,s));n++}},getXinFaTypeList:function(){return this.xinfaMap.keys()},getXinFaDataByType:function(e,t){var i=this.xinfaMap.get(e);if(!i)return null;if(0==t)return i[0];for(var n=0;n<i.length;++n)if(t==i[n].level)return i[n];return null},getXinFaMaxLevleByType:function(e){var t=this.xinfaMap.get(e);if(!t)return null;for(var i=0,n=0;n<t.length;++n)i<t[n].level&&(i=t[n].level);return i}})},{}],1145:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"HeadCfg",setup:function(e){this.setupIds(e)},getbigIcon:function(e){var t=this.data.get(e);return t?t.bigIcon:null},getsmallIcon:function(e){var t=this.data.get(e);return t?t.smallIcon:null}})},{}],1146:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"HeroCfg",data:null,spellList:null,publicSpellList:null,setup:function(e){var t;this.data=[],this.spellList=[],this.publicSpellList=[];for(var i=0;i<e.length;i++)(t=e[i])&&(this.data[t.id]=t,this.spellList[t.id]=t.spellList,this.publicSpellList[t.id]=t.publicSpellList)},getSpellListById:function(e){return this.spellList[e]},getHeroCfgById:function(e){return this.data[e]},getResIdById:function(e){return this.data[e]?this.data[e].resID:0},getPublicSpellList:function(e){return this.publicSpellList[e]}})},{}],1147:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"EquipCfg",setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];i&&game.ccfg.ItemInfoCfg.createItemInfo(i)}}})},{}],1148:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"HighEquipCfg",_highEquipMap:null,ctor:function(){this._super(),this._highEquipMap=b8e.HashMap.get()},setup:function(e){if(e){var t;this.setupByKey(e,"itemId");for(var i=0;i<e.length;++i)(t=this._highEquipMap.get(e[i].equipType))||(t=[],this._highEquipMap.set(e[i].equipType,t)),t.push(e[i]);this._highEquipMap.forEach(function(e,t){t.sort(this.sortByLevel)},this)}},getItemInfoById:function(e){var t=this.getDataByKey(e);return t||0},getSlotByItemId:function(e){var t=this.getDataByKey(e);return t?t.equipType:0},getLevelByItemId:function(e){var t=this.getDataByKey(e);return t?t.level:0},getobtainCostByItemId:function(e){var t=this.getDataByKey(e);return t&&t.obtainCost?t.obtainCost[0].Num:0},getupgradeCostByItemId:function(e){var t=this.getDataByKey(e);return t&&t.upgradeCost?t.upgradeCost[0].Num:0},getEquipLevelIndexById:function(e){var t=this.getDataByKey(e);return t?t.leveIndex:0},getCostItemId:function(e){var t=this.getDataByKey(e);return t&&t.obtainCost?t.obtainCost[0].Id:0},getDatasByEquipType:function(e){return this._highEquipMap.get(e)},sortByLevel:function(e,t){return e.level-t.level}})},{}],1149:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"ItemInfoCfg",_itemInfoMap:null,_useCost:null,ctor:function(){this._super(),this._itemInfoMap=b8e.HashMap.get()},setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];i&&this.createItemInfo(i)}},createItemInfo:function(e){e&&this._itemInfoMap.set(e.id,e)},getItemInfoById:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._itemInfoMap||this._itemInfoMap.count()<=0)return null;var i,n=this._itemInfoMap.get(e);return t?(n&&((i=new game.EquipInfo).id=n.id,i.name=n.name,i.group=n.group,i.type=n.type,i.effects=n.effects,i.iconName=n.iconName,i.desc=n.desc,i.goto=n.goto,i.quality=n.quality,i.qualityEffect=n.qualityEffect,i.maxCount=n.maxCount,i.level=n.level,i.isUse=0!=n.isUse,i.isCompound=0!=n.isCompound,i.baseAttrId=n.equipAttr,i.baseSpriteStat=game.ccfg.SpriteStatCfg.getSpriteStatById(i.baseAttrId),i.useCost=n.useCost,i.triggerId=n.triggerId,i.isEquip&&(i.appendMax=game.ccfg.EquipQualityCfg.getAppendMaxByQuality(i.quality),i.baseSpriteStat?i.basePower=game.CCommonUtil.getPower(i.baseSpriteStat,i.level):i.basePower=0,i.isHighEquip=!!n.highEquipAttr,i.highEquipAttrId=n.highEquipAttr,i.highSpriteStat=game.ccfg.SpriteStatCfg.getSpriteStatById(i.highEquipAttrId)),i.notShowRed=!!n.notShowRed,i.becomingVipLevelShowRed=n.becomingVipLevelShowRed),i):n},getUseCostById:function(e){var t=null;if(this._itemInfoMap&&0<this._itemInfoMap.count()){var i=this._itemInfoMap.get(e);if(i)(t=new game.UpgradeInfo).setUpgradeInfo(i.useCost)}return t},getQuilatyById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.quality}return-1},getQuilatyEffectById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.qualityEffect}return""},getNameById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.name}return""},getQualityNameById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t){var i=this.getQualityColorById(e);return game.html.getText(i,t.name)}}return""},getQualityColorById:function(e){var t;if(this._itemInfoMap&&0<this._itemInfoMap.count()){var i=this._itemInfoMap.get(e);if(i)switch(i.quality){case game.Quality.Q_WHITE:t=game.html.Q_WHITE;break;case game.Quality.Q_GREEN:t=game.html.Q_GREEN;break;case game.Quality.Q_BLUE:t=game.html.Q_BLUE;break;case game.Quality.Q_PURPLE:t=game.html.Q_PURPLE;break;case game.Quality.Q_YELLOW:t=game.html.Q_YELLOW;break;case game.Quality.Q_RED:t=game.html.Q_RED;break;default:t=game.html.Q_WHITE}}return t},getMaxCountById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.maxCount}return 0},getEffectsById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.effects}return null},getDescById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.desc}return""},getIsBindedById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.binded}return!1},getExpireTimeById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.expireTime}return 0},getIconNameById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.iconName}return 0},getTypeById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.type}return 0},getLevelById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.level}return 0},getBaseAttrId:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.equipAttr}return null},getIsUse:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return 0!=t.isUse}return!1},getIsCompound:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return 0!=t.isCompound}return!1},getTriggerIdById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.triggerId}return!1},getGotoById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.goto}return""},getIsHighEquip:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return 0!=t.highEquipAttr}return!1},getHighEquipAttrId:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.highEquipAttr}return 0},getEquipGetItemsById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.items}return 0},getGroupById:function(e){if(this._itemInfoMap&&0<this._itemInfoMap.count()){var t=this._itemInfoMap.get(e);if(t)return t.group}return 0}})},{}],1150:[function(e,t,i){"use strict";game.PrizeType=b8e.Enum({TypeItem:0,TypePrize:1}),t.exports=game.BaseCfg.extends({name:"PrizeCfg",_num:1,setup:function(e){this.prizeList=b8e.HashMap.get(),this.setupArray(e)},prizeList:null,getPrizeById:function(e){var t=this.prizeList.get(e);if(t)return t;var i,n=this.getDataById(e);if(t=[],!n||0==n.length)return t;for(var s=0;s<n.length;s++){if((i=n[s]).dropGroupItemId){(a=new game.PrizeItem).type=i.showType,a.itemId=i.dropGroupItemId,a.num=this._num,t.push(a);break}var a;if(i.itemType==game.PrizeType.TypeItem)(a=new game.PrizeItem).type=i.showType,a.itemId=i.itemId,a.num=i.itemMinNum,t.push(a);else if(i.itemType==game.PrizeType.TypePrize){if(i.itemId==e)throw new Error("礼包id",e,"配置重复了！");this._num=i.itemMinNum;var o=this.getPrizeById(i.itemId);t=t.concat(o)}}return this.prizeList.set(e,t),t}})},{}],1151:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"LangCfg",_textMap:null,setup:function(e){if(e){var t;this._textMap||(this._textMap=b8e.HashMap.get());for(var i=0;i<e.length;i++)(t=e[i])&&this._textMap.set(t.key,t)}else b8e.log("LanguageCfg配置表的数据为空，检查该表")},getLanguage:function(e){return this._textMap.get(e)},getText:function(e,t){t||(t=[]),t=this.getArrAgs(t);var i,n=this._textMap.get(e);return n||isNaN(e)?i=n?n.value:e:(b8e.warn("客户端文字配置表，找不到对应的id： ",e," 是否是没有同步表！！！"),i=n?n.value:t?"$":""),i=this.replaceStr(i,t)},getLang:function(e,t){t||(t=[]);var i,n=this._textMap.get(e);if(n||isNaN(e)?i=n?n.value:e:(b8e.warn("客户端文字配置表，找不到对应的id： ",e," 是否是没有同步表！！！"),i=n?n.value:t?"$":""),null!=t&&0<t.length&&null!=i){var s,a=t.length;for(s=0;s<a;s++)i=i.replace("{"+s+"}",t[s])}return i},getArrAgs:function(e){return 1==e.length&&e[0]instanceof Array&&(e=e[0]),e},replaceStr:function(e,t){if(null!=(t=this.getArrAgs(t))&&0<t.length&&null!=e){var i,n=t.length;for(i=0;i<n;i++)e=e.replace("$",t[i])}return e},replaceDian:function(e){if(-1==e.indexOf("・"))return e;for(var t="",i=e.split("・"),n=i.length,s=0;s<n;s++)t+=s==n-1?i[s]:i[s]+"·";return t}})},{}],1152:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"NationalAwardCfg",_nationalScoreList:null,_nationalLevelList:null,_nationalAwardMap:null,setup:function(e){this._nationalScoreList=[],this._nationalLevelList=[],this._nationalAwardMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){-1==this._nationalScoreList.indexOf(i.score)&&this._nationalScoreList.push(i.score),-1==this._nationalLevelList.indexOf(i.level)&&this._nationalLevelList.push(i.level);var n=b8e.CommonUtil.xyToInt(i.level,i.score);this._nationalAwardMap.set(n,i)}}this._nationalScoreList.sort(this.onSort)},getAwardByScore:function(e){var t=game.mainRole.mainRoleData.getLv();if(!t)return null;for(var i=0,n=this._nationalLevelList.length-1;0<=n&&!((i=this._nationalLevelList[n])<=t);n--);var s=b8e.CommonUtil.xyToInt(i,e),a=this._nationalAwardMap.get(s);return a?a.dropId:null},onSort:function(e,t){return e-t},getAwardScoreList:function(){return this._nationalScoreList},getMaxScore:function(){var e=this._nationalScoreList;return e&&0<e.length?e[e.length-1]:0}})},{}],1153:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"NationalBossCfg",setup:function(e){this.setupIds(e)},getNationalBossById:function(e){return this.data.get(Number(e))}})},{}],1154:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"NickNameCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")},getDataByIndex:function(e){var t=this.getDatas();return t?e+1>t.length?null:t[e]:null},getDataById:function(e){return e?this.getDataByKey(e):null},isGetBySelf:function(e){if(!e)return 0;var t=this.getDataByKey(e);return t?t.conditionType:0},getAllData:function(){return this.getDatas()},isNeedItems:function(e){var t=this.getDataById(e);return!!t&&!!t.items},getItemsById:function(e){var t=this.getDataById(e);return!!t&&(t.items?t.items:null)},getResById:function(e){var t=this.getDataById(e);return t?t.res:null},getNameById:function(e){var t="",i=this.getDataById(e);return i&&(t=i.name),t},getIsExpire:function(e){var t=this.getDataById(e);return!!t&&0<t.duration},getDuration:function(e){var t=this.getDataById(e);return t?t.duration:0}})},{}],1155:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"NoticeCfg",_noticeInfoMap:null,setup:function(e){this._noticeInfoMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._noticeInfoMap.set(i.type,i)}},getNoticeInfoMap:function(){return this._noticeInfoMap},getNoticeInfoByType:function(e){return this._noticeInfoMap.get(e)}})},{}],1156:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"OnlineAwardCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"time")}})},{}],1157:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"OrnamentCfg",setup:function(e){var t,i;this._dataMaxLvMap=b8e.HashMap.get(),this._dataItemIdAndLvMap=b8e.HashMap.get();for(var n=0;n<e.length;n++)(t=e[n])&&((!(i=this._dataMaxLvMap.get(t.itemId))||i<t.level)&&this._dataMaxLvMap.set(t.itemId,t.level),this._dataItemIdAndLvMap.set(b8e.CommonUtil.xyToInt(t.itemId,t.level),t))},getDatas:function(){return this._dataItemIdAndLvMap.values()},getMaxLevel:function(e){return 0|this._dataMaxLvMap.get(e)},getDataByItemIdAndLv:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this._dataItemIdAndLvMap.get(b8e.CommonUtil.xyToInt(e,0<t?t:1))},getName:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.name:""},getQuality:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.quality:1},getUIRes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.uiRes:""},getMainUIScale:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.uiScale1:1},getJinjieUIScale:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.uiScale2:1},getSceneRes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.sceneRes:""},getNameRes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.nameRes:""},getIconRes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.iconRes:""},getGoto:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.goto:""},getSkillName:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.skillName:""},getSkillIconRes:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.skillIconRes:""},getSkillDesc:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.skillDesc:""},getMaxEnSoul:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.ensoul:0},getCostItemInfo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getDataByItemIdAndLv(e,0<t?t:1);return i?i.cost:null}})},{}],1158:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AccumulateRechargeCfg",ctor:function(){this._super()},setup:function(e){this.setupArrayByKey(e,"group")},getAccumulateArrByGroup:function(e){return this.getDataByKey(e)},getAccumulateArr:function(){return this.getDatas()}})},{}],1159:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CardRechargeCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"itemId")},getCardRechargeArr:function(){for(var e,t=this.getDatas(),i=[],n=0;n<t.length;n++)(e=t[n]).pfType==game.pay.pfType&&i.push(e);return i},getCardRecharge:function(e){return this.getDataByKey(e)},getCardRechargeRate:function(e){var t=this.getDataByKey(e);return t?t.addAwardRate:0},getCardTypeById:function(e){var t=this.getDataByKey(e);return t?t.cardType:0},getAddMaterialRateById:function(e){var t=this.getDataByKey(e);return t?t.addMaterialRate:0}})},{}],1160:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"NormalRechargeCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"itemId")},getNormalRechargeInfoArr:function(){for(var e,t=this.getDatas(),i=[],n=0;n<t.length;n++)(e=t[n]).pfType==game.pay.pfType&&0==e.isFirstRecharge&&i.push(e);return i},getFirstRechargeArr:function(){for(var e,t=this.getDatas(),i=[],n=0;n<t.length;n++)(e=t[n]).pfType==game.pay.pfType&&1==e.isFirstRecharge&&i.push(e);return i},getRecharge:function(e){return this.getDataByKey(e)}})},{}],1161:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"RechargeCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"itemId")},getRechargeInfoArrByType:function(e){return this.getDataByKey(e)},getRecharge:function(e){return this.getDataByKey(e)},getIconByItemId:function(e){return this.getDataByKey(e).iconName},getRechargeTypeById:function(e){var t=this.getDataByKey(e);return t?t.rechargeType:null}})},{}],1162:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"RechargeRebateCfg",ctor:function(){this._super()},setup:function(e){this.setupArrayByKey(e,"group")},getRebateArrByGroup:function(e){return this.getDataByKey(e)},getArr:function(){return this.getDatas()}})},{}],1163:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AttrPowerCoefCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.AttrPowerCoefInfo;n.attr=i.attr,n.coef=i.coef,n.type=i.type,this._map.set(n.attr,n)}}},getAttrPowerCoefInfoByType:function(e){return this._map.get(e)}})},{}],1164:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"LvPowerCoefCfg",_map:null,setup:function(e){this._map=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.lv,i.coef)}},getLvCoefByLv:function(e){return this._map&&0<this._map.count()?this._map.get(e):0}})},{}],1165:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"RankBarCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")},getShortNameByType:function(e){for(var t,i=this.getDatas(),n=0;n<i.length;n++)if((t=i[n]).type==e)return t.shortName;return""}})},{}],1166:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({setup:function(e){this.setupByKey(e,"level")}})},{}],1167:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SaleDailyCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"itemId")},getSalePrizeArr:function(){var e,t=this.getDatas(),i=[];if(t&&0<t.length)for(var n=i.length=0;n<t.length;n++)(e=t[n]).pfType==game.pay.pfType&&i.push(e);return i}})},{}],1168:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ZhuanPanCfg",zhuanpanMap:null,ctor:function(){this._super(),this.zhuanpanMap=b8e.HashMap.get()},setup:function(e){this.setupByKey(e,"id"),this.setArrayByKey(e,"activitySubType")},setArrayByKey:function(e,t){var i,n;this.zhuanpanMap=b8e.HashMap.get();for(var s=e.length,a=0;a<s;a++)i=e[a],(n=this.zhuanpanMap.get(i[t]))||(n=[],this.zhuanpanMap.set(i[t],n)),n.push(i)},getArrByActiveType:function(e){return this.zhuanpanMap.get(e)}})},{}],1169:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ZhuanPanCostCfg",_upgradeInfo:null,ctor:function(){this._super(),this._upgradeInfo=new game.UpgradeInfo},setup:function(e){this.setupByKey(e,"activitySubType")},getCostByType:function(e){return this.getDataByKey(e)},getRaffleCountByType:function(e){var t=this.getCostByType(e);return t&&t.raffleCount?t.raffleCount:0},getPreciousInterval:function(e){var t=this.getCostByType(e);return t&&t.preciousInterval?t.preciousInterval:0},setUpgradeInfoByType:function(e,t){this._upgradeInfo.clear();var i=this.getCostByType(e);if(i)switch(t){case game.ZhuanPanCostType.AWARD_COST:i.award&&this._upgradeInfo.setUpgradeInfo(i.award);break;case game.ZhuanPanCostType.ONCE_COST:i.cost&&this._upgradeInfo.setUpgradeInfo(i.cost);break;case game.ZhuanPanCostType.MULTIPLE_COST:i.multipleCost&&this._upgradeInfo.setUpgradeInfo(i.multipleCost)}},getCostNum:function(e,t){if(this.setUpgradeInfoByType(e,t),this._upgradeInfo){var i=this._upgradeInfo.getAmountInfo();return 0<i.amountMap.count()?i.getFirstAmountValue():this._upgradeInfo.getFirstUpgradeInfoNum()}return 0},getCostItemId:function(e,t){if(this.setUpgradeInfoByType(e,t),this._upgradeInfo){var i=this._upgradeInfo.getAmountInfo();if(!(0<i.amountMap.count()))return this._upgradeInfo.getFirstUpgradeInfoId();var n=i.getFirstAmountType();switch(n=0|+n){case game.AmountType.SILVER:return game.AmountItemId.SILVER;case game.AmountType.YUAN_BAO:return game.AmountItemId.YUAN_BAO}}return 0}})},{}],1170:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"RuneCfg",_runeMap:null,_runeIdMap:null,_runeConvertList:null,_costConvertItemId:0,_resolveIdList:null,_runeChongMap:null,_runeLayerMap:null,setup:function(e){var t,i,n;this._runeMap=b8e.HashMap.get(),this._runeIdMap=b8e.HashMap.get(),this.data=b8e.HashMap.get(),this._runeChongMap=b8e.HashMap.get(),this._runeLayerMap=b8e.HashMap.get(),this._runeConvertList=[],this._resolveIdList=[];for(var s=0,a=0;a<e.length;a++)if(t=e[a]){var o=b8e.CommonUtil.xyToInt(t.group,t.level);if(this._runeMap.set(o,t),!(i=this._runeIdMap.get(t.group))||i.length<0?(i=[]).push(t):i.push(t),this._runeIdMap.set(t.group,i),t.convertCost&&0<t.convertCost.length&&(this._runeConvertList.push(t.id),this._costConvertItemId=t.convertCost[0].Id),t.resolveAward&&0<t.resolveAward.length)for(s=0;s<t.resolveAward.length;s++)-1==this._resolveIdList.indexOf(t.resolveAward[s].Id)&&this._resolveIdList.push(t.resolveAward[s].Id);1==t.level&&(this._runeChongMap.set(t.id,t),!(n=this._runeLayerMap.get(t.layer))||n.length<0?(n=[]).push(t):n.push(t),this._runeLayerMap.set(t.layer,n)),this.data.set(t.id,t)}this._runeIdMap.forEach(function(e,t){t&&0<t.length&&(t.sort(this.onSort),this._runeIdMap.set(e,t))},this)},onSort:function(e,t){return e.level-t.level},getRuneDataBIL:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._runeMap.get(i);return n||null},getMaxLvByGroup:function(e){var t=this._runeIdMap.get(e);if(t&&0<t.length){var i=t[t.length-1];if(i)return i.level}return 0},getRuneDataById:function(e){var t=this.data.get(e);return t||null},getConvertList:function(){return this._runeConvertList},getCostConvertItemId:function(){return this._costConvertItemId},getRuneAttrById:function(e){var t=this.data.get(e);return t?t.attr:null},getRuneResolveById:function(e){var t=this.data.get(e);return t?t.resolveAward:null},getResolveIdList:function(){return this._resolveIdList},getLayerMap:function(){return this._runeChongMap.values()},getRuneListByLayer:function(e){var t=this._runeLayerMap.get(e);return t||null},getUpgradeInfoByType:function(e,t){var i,n=this.getRuneDataById(e);n&&(n.upgradeCost&&(i=new game.UpgradeInfo).setUpgradeInfo(n.upgradeCost));if(t)return i?0<(s=i.getAmountInfo()).amountMap.count()?s.getFirstAmountValue():i.getFirstUpgradeInfoNum():0;if(i){var s;if(!(0<(s=i.getAmountInfo()).amountMap.count()))return i.getFirstUpgradeInfoId();switch(0|+s.getFirstAmountType()){case game.AmountType.SILVER:return game.AmountItemId.SILVER;case game.AmountType.YUAN_BAO:return game.AmountItemId.YUAN_BAO}}return 0}})},{}],1171:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientAreaEventCfg",setup:function(e){this.setupIds(e)}});var n=game.ClientAreaEvent={};n.playJumpEffect="playJumpEffect",n.moveToDoor="moveToDoor",n.endDoor="endDoor"},{}],1172:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"ClientEntityCfg",_clientEntityInfoList:null,_clientEntityListBySceneId:null,setup:function(e){this._clientEntityInfoList=b8e.HashMap.get(),this._clientEntityListBySceneId=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){this._clientEntityInfoList.set(i.id,i);var n=this._clientEntityListBySceneId.get(i.mapid);n||(n=[],this._clientEntityListBySceneId.set(i.mapid,n)),n.push(i)}}},getClientEntityListBySceneId:function(e){return this._clientEntityListBySceneId.get(e)},getNpcGenById:function(e){return this._clientEntityInfoList.get(e)}})},{}],1173:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"ClientMonsterGen",_genInfoList:null,_listByGenType:null,setup:function(e){this._genInfoList=b8e.HashMap.get(),this._listByGenType=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){this._genInfoList.set(i.id,i);var n=this._listByGenType.get(i.genType);n||(n=[],this._listByGenType.set(i.genType,n)),n.push(i)}}},getGenById:function(e){return this._genInfoList.get(e)},getListByGenType:function(e){return this._listByGenType.get(e)}})},{}],1174:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientSceneEffectCfg",setup:function(e){this.setupIds(e)}})},{}],1175:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"DialogCfg",_dialogInfoList:null,_dialogInfoByQuestId:null,setup:function(e){this._dialogInfoList=b8e.HashMap.get(),this._dialogInfoByQuestId=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i)if(this._dialogInfoList.set(i.id,i),0<i.questId)this._dialogInfoByQuestId.get(i.questId)?b8e.warn("【配置注意】对话表的questId必须唯一！"):this._dialogInfoByQuestId.set(i.questId,i)}},getDialogByQuestId:function(e){return this._dialogInfoByQuestId.get(e)},getDialogById:function(e){return this._dialogInfoList.get(e)}})},{}],1176:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"DungeonCfg",_loneyDungeonGroup:null,_loneyDungeonGroupName:null,_loneyDungeonGroupId:null,_monsterBySceneId:null,_dungeonTypeMap:null,_teamDungeonList:null,_towerDungeonList:null,setup:function(e){var t;this.data=b8e.HashMap.get(),this._monsterBySceneId=b8e.HashMap.get(),this._loneyDungeonGroup=b8e.HashMap.get(),this._dungeonTypeMap=b8e.HashMap.get(),this._loneyDungeonGroupName=[],this._loneyDungeonGroupId=[],this._teamDungeonList=[],this._towerDungeonList=[];for(var i=0;i<e.length;i++){var n,s=e[i];this.data.set(s.id,s),(n=this._dungeonTypeMap.get(s.type))||(n=b8e.HashMap.get(),this._dungeonTypeMap.set(s.type,n)),n.set(s.id,s);var a=this._monsterBySceneId.get(s.mapid);switch(a?b8e.warn("【配置注意】副本表的mapid必须唯一！"):(a=s.monster,this._monsterBySceneId.set(s.mapid,a)),s.type){case game.DungeonType.TYPE_LONEY:(t=this._loneyDungeonGroup.get(s.group))||(t=[],this._loneyDungeonGroupName[s.group]=s.groupName,this._loneyDungeonGroupId.push(s.group),this._loneyDungeonGroup.set(s.group,t)),t.push(s);break;case game.DungeonType.TYPE_TEAM:this._teamDungeonList.push(s);break;case game.DungeonType.TYPE_TOWER:this._towerDungeonList.push(s)}}0<this._teamDungeonList.length&&this._teamDungeonList.sort(this.sortTeamDungeonByLevel),0<this._towerDungeonList.length&&this._towerDungeonList.sort(this.sortTowerDungeonById)},sortTowerDungeonById:function(e,t){return e.id-t.id},sortTeamDungeonByLevel:function(e,t){return e.limitLv-t.limitLv},getTeamDungeonList:function(){return this._teamDungeonList?this._teamDungeonList:null},getTowerDungeonList:function(){return this._towerDungeonList?this._towerDungeonList:null},getDungeonById:function(e){return this.data&&e?this.data.get(e):null},getDungeonMapByType:function(e){return this._dungeonTypeMap.get(e)},getMonsterBySceneId:function(e){return this._monsterBySceneId.get(e)},getGroupById:function(e){return this._loneyDungeonGroup.get(e)},getGroupIdByIndex:function(e){var t=e;return e>=this._loneyDungeonGroupId.length&&(t=this._loneyDungeonGroup.length-1),e<0&&(t=0),this._loneyDungeonGroupId[t]},getMaxGroupIndex:function(){return this._loneyDungeonGroupId.length-1},getGroupNameByGroupId:function(e){return this._loneyDungeonGroupName[e]},getIsStartGruop:function(e){return 0==this._loneyDungeonGroupId.indexOf(e)},getIsEndGroup:function(e){return this._loneyDungeonGroupId.indexOf(e)==this._loneyDungeonGroupId.length-1}})},{}],1177:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"MainQuestCfg",_maxSequence:0,setup:function(e){var t;this.data=b8e.HashMap.get();for(var i=0;i<e.length;i++)t=e[i],this.data.set(t.id,t),t.sequence>this._maxSequence&&(this._maxSequence=t.sequence)},getQuestById:function(e){return this.data.get(Number(e))},getProcessById:function(e){var t=this.data.get(Number(e));return t?t.sequence/this._maxSequence:0}})},{}],1178:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"MonGenCfg",_monGenInfoList:null,_monGenListBySceneId:null,setup:function(e){this._monGenInfoList=b8e.HashMap.get(),this._monGenListBySceneId=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){this._monGenInfoList.set(i.id,i);var n=this._monGenListBySceneId.get(i.mapid);n||(n=[],this._monGenListBySceneId.set(i.mapid,n)),n.push(i)}}},getMonGenList:function(){return this._monGenInfoList},getMonGenListBySceneId:function(e){return this._monGenListBySceneId.get(e)},getMonGenInfoById:function(e){return this._monGenInfoList.get(e)},getPosById:function(e){var t=this.getMonGenInfoById(e);return t?t.pos:null},getMapIdById:function(e){var t=this.getMonGenInfoById(e);return t?t.mapid:0},getMonIdById:function(e){var t=this.getMonGenInfoById(e);return t?t.monid:0}})},{}],1179:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"MonsterCfg",setup:function(e){this.setupIds(e)},getMonsterModelById:function(e){return this.data.get(Number(e))}})},{}],1180:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"NpcGenCfg",_npcGenInfoList:null,_npcGenListBySceneId:null,setup:function(e){this._npcGenInfoList=b8e.HashMap.get(),this._npcGenListBySceneId=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){this._npcGenInfoList.set(i.id,i);var n=this._npcGenListBySceneId.get(i.mapid);n||(n=[],this._npcGenListBySceneId.set(i.mapid,n)),n.push(i)}}},getNpcGenListBySceneId:function(e){return this._npcGenListBySceneId.get(e)},getNpcGenById:function(e){return this._npcGenInfoList.get(e)}})},{}],1181:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SceneCfg",setup:function(e){this.setupIds(e)},getSceneById:function(e){return this.data.get(e)}})},{}],1182:[function(e,t,i){"use strict";var n=game.BaseCfg.extends({ctor:function(){this._super(),this.data=b8e.HashMap.get()},setConfig:function(e){if(e){var t=this.data.get(e.shopId);if(!t){var i,n,s;for((t={}).id=e.shopId,(i=e.award)&&(t.itemId=i.id,t.itemNum=i.num),t.discountCost=[],n=0,s=e.discountCost.length;n<s;n++)(i=e.discountCost[n])&&t.discountCost.push({Id:i.id,Num:i.num});for(t.normalCost=[],n=0,s=e.normalCost.length;n<s;n++)(i=e.normalCost[n])&&t.normalCost.push({Id:i.id,Num:i.num});t.sortId=e.sortId,t.isRecommended=e.isRecommended,t.isShowSpecialBag=e.isShowSpecialBag,this.data.set(e.shopId,t)}}},setConfigs:function(e){if(e&&0!=e.length)for(var t=0,i=e.length;t<i;t++)this.setConfig(e[t])}});t.exports=n},{}],1183:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({_idMap:null,setup:function(e){var t,i;this.data=b8e.HashMap.get(),this._idMap=b8e.HashMap.get();for(var n=0;n<e.length;n++)t=e[n],(i=this.data.get(t.showType))||(i=[],this.data.set(t.showType,i)),i.push(t),this._idMap.set(t.goodsId,t)},getCfg:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.data.get(i);if(!n||n.length<=0)return null;for(var s=0;s<n.length;s++)if((t=n[s]).goodsId==e)return t},getCfgByGoodsId:function(e){return this._idMap.get(e)}})},{}],1184:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SpellCfgData",setup:function(e){var i;this.data=b8e.HashMap.get();for(var t=0;t<e.length;t++){if(i=e[t],this.data.get(i.id))return void b8e.error("配置表",this.name," id ",i.id,"重复！！");this.data.set(i.id,i),i.rangeSet&&0<i.rangeSet.length&&(i.rangeSetList=[],i.rangeSet.forEach(function(e){var t=e.split(",");3==t.length?i.rangeSetList.push({x:0|t[0],y:0|t[1],z:0|t[2]}):b8e.Logger.error("范围技能id"+i.id+"配置错误")},this))}this.baseCfgData=e},getSpellById:function(e){return this.data.get(e)}})},{}],1185:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"AttrRulesCfg",_attrNameMap:null,setup:function(e){this._attrNameMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.AttrRulesInfo;n.type=i.type,n.name=i.name,n.attrType=i.attrType,n.format=i.format,n.sort=i.sort,this._attrNameMap.set(n.type,n)}}},getAttrRulesInfoByType:function(e){return this._attrNameMap&&0<this._attrNameMap.count()?this._attrNameMap.get(e):null},getAttrNameByType:function(e){if(this._attrNameMap&&0<this._attrNameMap.count()){var t=this._attrNameMap.get(e);if(t)return t.name}return""},getAttrSortByType:function(e){if(this._attrNameMap&&0<this._attrNameMap.count()){var t=this._attrNameMap.get(e);if(t)return t.sort}return 0}})},{}],1186:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({statNameToType:null,statName:null,spriteStatMap:null,ctor:function(){this._super(),this.statNameToType=[],this.spriteStatMap=[],this.statName=["maxhp","maxhpBonusCoef","atk","atkBonusCoef","def","defBonusCoef","dmgReduceCoef","dmgBonusCoef","dmgReduce","dmgBonus","hit","hitRate","dodge","dodgeRate","crit","critRate","critCoef","critReduce","critReduceRate","critReduceCoef","cdReduceCoef","moveSpeed","hpRecovery","dmgBonusCoefJin","dmgBonusCoefMu","dmgBonusCoefShui","dmgBonusCoefHuo","dmgBonusCoefTu","dmgReduceCoefJin","dmgReduceCoefMu","dmgReduceCoefShui","dmgReduceCoefHuo","dmgReduceCoefTu","dmgBonusCoefToJin","dmgBonusCoefToMu","dmgBonusCoefToShui","dmgBonusCoefToHuo","dmgBonusCoefToTu"],this.statNameToType.maxhp=game.SpriteStatType.MAXHP,this.statNameToType.maxhpBonusCoef=game.SpriteStatType.MAXHP_BONUS_COEF,this.statNameToType.atk=game.SpriteStatType.ATK,this.statNameToType.atkBonusCoef=game.SpriteStatType.ATK_BONUS_COEF,this.statNameToType.def=game.SpriteStatType.DEF,this.statNameToType.defBonusCoef=game.SpriteStatType.DEF_BONUS_COEF,this.statNameToType.dmgReduceCoef=game.SpriteStatType.DMG_REDUCTION_COEF,this.statNameToType.dmgBonusCoef=game.SpriteStatType.DMG_BONUS_COEF,this.statNameToType.dmgReduce=game.SpriteStatType.DMG_REDUCTION,this.statNameToType.dmgBonus=game.SpriteStatType.DMG_BONUS,this.statNameToType.hit=game.SpriteStatType.HIT,this.statNameToType.hitRate=game.SpriteStatType.HIT_RATE,this.statNameToType.dodge=game.SpriteStatType.DODGE,this.statNameToType.dodgeRate=game.SpriteStatType.DODGE_RATE,this.statNameToType.crit=game.SpriteStatType.CRIT,this.statNameToType.critRate=game.SpriteStatType.CRIT_RATE,this.statNameToType.critCoef=game.SpriteStatType.CRIT_COEF,this.statNameToType.critReduce=game.SpriteStatType.CRIT_REDUCTION,this.statNameToType.critReduceRate=game.SpriteStatType.CRIT_REDUCTION_RATE,this.statNameToType.critReduceCoef=game.SpriteStatType.CRIT_REDUCTION_COEF,this.statNameToType.cdReduceCoef=game.SpriteStatType.CD_REDUCTION_COEF,this.statNameToType.moveSpeed=game.SpriteStatType.MOVE_SPEED,this.statNameToType.hpRecovery=game.SpriteStatType.HP_RECOVERY,this.statNameToType.dmgBonusCoefJin=game.SpriteStatType.DMG_BONUS_COEF_JIN,this.statNameToType.dmgBonusCoefMu=game.SpriteStatType.DMG_BONUS_COEF_MU,this.statNameToType.dmgBonusCoefShui=game.SpriteStatType.DMG_BONUS_COEF_SHUI,this.statNameToType.dmgBonusCoefHuo=game.SpriteStatType.DMG_BONUS_COEF_HUO,this.statNameToType.dmgBonusCoefTu=game.SpriteStatType.DMG_BONUS_COEF_TU,this.statNameToType.dmgReduceCoefJin=game.SpriteStatType.DMG_REDUCTION_COEF_JIN,this.statNameToType.dmgReduceCoefMu=game.SpriteStatType.DMG_REDUCTION_COEF_MU,this.statNameToType.dmgReduceCoefShui=game.SpriteStatType.DMG_REDUCTION_COEF_SHUI,this.statNameToType.dmgReduceCoefHuo=game.SpriteStatType.DMG_REDUCTION_COEF_HUO,this.statNameToType.dmgReduceCoefTu=game.SpriteStatType.DMG_REDUCTION_COEF_TU,this.statNameToType.dmgBonusCoefToJin=game.SpriteStatType.DMG_BONUS_COEF_TO_JIN,this.statNameToType.dmgBonusCoefToMu=game.SpriteStatType.DMG_BONUS_COEF_TO_MU,this.statNameToType.dmgBonusCoefToShui=game.SpriteStatType.DMG_BONUS_COEF_TO_SHUI,this.statNameToType.dmgBonusCoefToHuo=game.SpriteStatType.DMG_BONUS_COEF_TO_HUO,this.statNameToType.dmgBonusCoefToTu=game.SpriteStatType.DMG_BONUS_COEF_TO_TU},setup:function(e){this.setupIds(e)},getSpriteStatById:function(e){var t;if(t=this.spriteStatMap[e])return t;t=game.SpriteStat.get();var i=this.getDataById(e);if(i)for(var n,s,a,o=0;o<this.statName.length;o++)if(n=this.statName[o],s=this.statNameToType[this.statName[o]],a=i[n],s&&a&&0!=a){var r=new game.StatData;r.type=s,r.value=a,t.setStatData(r)}return this.spriteStatMap[e]=t}})},{}],1187:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"StrengthenCfg",_map:null,_arr1:null,_arr2:null,ctor:function(){this._super(),this._map=b8e.HashMap.get(),this._arr1=[],this._arr2=[]},setup:function(e){for(var t,i=0;i<e.length;i++)if(t=e[i])switch(t.kindId){case 1:this._arr1.push(t);break;case 2:this._arr2.push(t)}this._map.set(1,this._arr1),this._map.set(2,this._arr2)},getArrByType:function(e){return this._map.get(e)}})},{}],1188:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"StrengthenGradeCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")},getGradeInfoById:function(e){return this.getDataByKey(e)},getGrade:function(e,t){var i=this.getGradeInfoById(e);if(i){if(t>=i.sss)return"SSS";if(t>=i.ss&&t<i.sss)return"SS";if(t>=i.s&&t<i.ss)return"S";if(t>=i.a&&t<i.s)return"A";if(t>=i.b&&t<i.a)return"B";if(t>=i.c&&t<i.b)return"C"}}})},{}],1189:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"StrengthenPowerCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"lv")},getPowerInfoByLv:function(e){return this.getDataByKey(e)}})},{}],1190:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CsSuraLevelCfg",ctor:function(){this._super()},setup:function(e){e&&this.setupByKey(e,"id")},getSuraLevelInfoListt:function(){return this.getDatas()},getSuraLevelInfoById:function(e){return this.getDataByKey(e)}})},{}],1191:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CsSuraPrizeCfg",_suraPrizeInfoMap:null,ctor:function(){this._super(),this._suraPrizeInfoMap=b8e.HashMap.get()},setup:function(e){if(e){this.setupByKey(e,"id");for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.SuraPrizeInfo;n.setup(i),this._suraPrizeInfoMap.set(n.id,n)}}}},getSuraPrizeInfoListt:function(){return this.getDatas()},getdisplayDropByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.displayDrop:null},getLevelDropsByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.levelDrops:null},getRankDropsByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.rankDrops:null},getIdByOpenDays:function(e){var t=1,i=this.getDatas();if(!i)return t;for(var n=0;n<i.length-1;++n)if(e>=i[n].zoneOpenDays&&e<i[n+1].zoneOpenDays){t=i[n].id;break}return t}})},{}],1192:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SuraLevelCfg",ctor:function(){this._super()},setup:function(e){e&&this.setupByKey(e,"id")},getSuraLevelInfoListt:function(){return this.getDatas()},getSuraLevelInfoById:function(e){return this.getDataByKey(e)}})},{}],1193:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SuraPrizeCfg",_suraPrizeInfoMap:null,ctor:function(){this._super(),this._suraPrizeInfoMap=b8e.HashMap.get()},setup:function(e){if(e){this.setupByKey(e,"id");for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.SuraPrizeInfo;n.setup(i),this._suraPrizeInfoMap.set(n.id,n)}}}},getSuraPrizeInfoListt:function(){return this.getDatas()},getdisplayDropByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.displayDrop:null},getLevelDropsByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.levelDrops:null},getRankDropsByOpenDays:function(e){var t=this.getIdByOpenDays(e),i=this._suraPrizeInfoMap.get(t);return i?i.rankDrops:null},getIdByOpenDays:function(e){var t=1,i=this.getDatas();if(!i)return t;for(var n=0;n<i.length-1;++n)if(e>=i[n].zoneOpenDays&&e<i[n+1].zoneOpenDays){t=i[n].id;break}return t}})},{}],1194:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"SurakillCfg",ctor:function(){this._super()},setup:function(e){e&&this.setupByKey(e,"killNumber")}})},{}],1195:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CSTianGongGuildAwardCfg",_list:null,setup:function(e){this.setupByKey(e,"rank"),this._list=this.data.keys(),!this._list||this._list.length<0||this._list.sort(this.onSort)},getList:function(){return this._list},getKeys:function(){return this.data.keys()},onSort:function(e,t){return e-t}})},{}],1196:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"CSTianGongPlayerAwardCfg",_list:null,setup:function(e){this.setupByKey(e,"score"),this._list=this.data.keys(),!this._list||this._list.length<0||this._list.sort(this.onSort)},getKeys:function(){return this.data.keys()},getList:function(){return this._list},getNextScore:function(e){if(!this._list||this._list.length<0)return null;for(var t=0;t<this._list.length;t++){var i=parseInt(this._list[t]);if(e<i)return i}return null},onSort:function(e,t){return e-t}})},{}],1197:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"TianGongGuildAwardCfg",_list:null,setup:function(e){this.setupByKey(e,"rank"),this._list=this.data.keys(),!this._list||this._list.length<0||this._list.sort(this.onSort)},getList:function(){return this._list},getKeys:function(){return this.data.keys()},onSort:function(e,t){return e-t}})},{}],1198:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"TianGongPlayerAwardCfg",_list:null,setup:function(e){this.setupByKey(e,"score"),this._list=this.data.keys(),!this._list||this._list.length<0||this._list.sort(this.onSort)},getKeys:function(){return this.data.keys()},getList:function(){return this._list},getNextScore:function(e){if(!this._list||this._list.length<0)return null;for(var t=0;t<this._list.length;t++){var i=parseInt(this._list[t]);if(e<i)return i}return null},onSort:function(e,t){return e-t}})},{}],1199:[function(e,t,i){"use strict";t.exports=b8e.Object.extends({name:"TowerCfg",_map:null,setup:function(e){if(e&&!(e.length<=0)){this._map=b8e.HashMap.get(),this._map.clear();for(var t=0;t<e.length;t++){var i=e[t];i&&this._map.set(i.layer,i)}}},getDataById:function(e){var t=this._map.keys(),i=1;if(t&&0<t.length)for(var n=0;n<t.length&&!(t[n]>e);n++)i=t[n];return this._map.get(i)},getRuneNotice:function(e){var t=this._map.keys();if(t&&0<t.length)for(var i=0;i<t.length;i++)if(t[i]>=e){var n=this._map.get(t[i]);if(n&&(0<n.unlockIndex||0<n.unlockRuneId.length))return n}return null}})},{}],1200:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientCommandCfg",setup:function(e){this.setupIds(e)}})},{}],1201:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientFunctionOpenCfg",setup:function(e){this.setupIds(e)}})},{}],1202:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientGuideCfg",setup:function(e){this.setupIds(e)}})},{}],1203:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientPlotCfg",setup:function(e){this.setupIds(e)}})},{}],1204:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientTriggerCfg",_levelTriggerList:null,_timingTriggerList:null,_taskTriggerList:null,_clickTriggerList:null,_joinGuildTriggerList:null,_dujieSucceedTriggerList:null,_cherishBeautyTriggerList:null,_bianShenTriggerList:null,_bianShenBattleTriggerList:null,_triggerListByScene:null,_triggerListByEquipType:null,_triggerListByGoodsType:null,_triggerListByPrizeType:null,_triggerListByAchievementType:null,_alltaskTriggerList:null,setup:function(e){this._levelTriggerList=b8e.HashMap.get(),this._timingTriggerList=b8e.HashMap.get(),this._taskTriggerList=b8e.HashMap.get(),this._triggerListByScene=b8e.HashMap.get(),this._triggerListByEquipType=b8e.HashMap.get(),this._triggerListByGoodsType=b8e.HashMap.get(),this._triggerListByPrizeType=b8e.HashMap.get(),this._clickTriggerList=b8e.HashMap.get(),this._joinGuildTriggerList=b8e.HashMap.get(),this._dujieSucceedTriggerList=b8e.HashMap.get(),this._cherishBeautyTriggerList=b8e.HashMap.get(),this._bianShenTriggerList=b8e.HashMap.get(),this._bianShenBattleTriggerList=b8e.HashMap.get(),this._triggerListByAchievementType=b8e.HashMap.get(),this._alltaskTriggerList=b8e.HashMap.get(),this.setupIds(e)},setupIds:function(e){var t,i,n;this.data=b8e.HashMap.get();for(var s=0;s<e.length;s++)if(t=e[s],this.data.set(t.id,t),t.triggerType==game.TriggerType.LEVEL)this._levelTriggerList.set(t.id,t);else if(t.triggerType==game.TriggerType.TIMING)1e3<=t.timingDelay?this._timingTriggerList.set(t.id,t):b8e.warn("【配置注意】定时触发类型触发器"+t.id+"的timingDelay不能小于1000！");else if(t.triggerType==game.TriggerType.SCENE)0<t.sceneId?((i=this._triggerListByScene.get(t.sceneId))||(i=[],this._triggerListByScene.set(t.sceneId,i)),i.push(t)):b8e.warn("【配置注意】场景触发类型触发器"+t.id+"的sceneId不能为空！");else if(t.triggerType==game.TriggerType.TASK)if(this._taskTriggerList.set(t.id,t),t.maxTaskSequence>t.minTaskSequence){n=t.maxTaskSequence-t.minTaskSequence;for(var a=0;a<=n;a++){var o=t.minTaskSequence+a;(i=this._alltaskTriggerList.get(o))||(i=[]),i.push(t),this._alltaskTriggerList.set(o,i)}}else(i=this._alltaskTriggerList.get(t.minTaskSequence))||(i=[]),i.push(t),this._alltaskTriggerList.set(t.minTaskSequence,i);else t.triggerType==game.TriggerType.GOODS?0<t.equipType?((i=this._triggerListByEquipType.get(t.equipType))||(i=[],this._triggerListByEquipType.set(t.equipType,i)),i.push(t)):0<t.goodsType?((i=this._triggerListByGoodsType.get(t.goodsType))||(i=[],this._triggerListByGoodsType.set(t.goodsType,i)),i.push(t)):0<t.prizeType?((i=this._triggerListByPrizeType.get(t.prizeType))||(i=[],this._triggerListByPrizeType.set(t.prizeType,i)),i.push(t)):b8e.warn("【配置注意】获得物品触发类型触发器"+t.id+"的equipType||goodsType||prizeType不能为空！"):t.triggerType==game.TriggerType.ACHIEVEMENT?0<t.achievementId?((i=this._triggerListByAchievementType.get(t.achievementId))||(i=[],this._triggerListByAchievementType.set(t.achievementId,i)),i.push(t)):b8e.warn("【配置注意】成就类型触发器"+t.id+"的achievementId不能为空！"):t.triggerType==game.TriggerType.CLICK?this._clickTriggerList.set(t.id,t):t.triggerType==game.TriggerType.JOIN_GUILD?this._joinGuildTriggerList.set(t.id,t):t.triggerType==game.TriggerType.DUJIE_SUCCEED?this._dujieSucceedTriggerList.set(t.id,t):t.triggerType==game.TriggerType.CHERISH_BEAUTY?this._cherishBeautyTriggerList.set(t.id,t):t.triggerType==game.TriggerType.BIAN_SHEN?this._bianShenTriggerList.set(t.id,t):t.triggerType==game.TriggerType.BIAN_SHEN_BATTLE&&this._bianShenBattleTriggerList.set(t.id,t)},getAchievementListById:function(e){return this._triggerListByAchievementType.get(e)},getLevelTriggerList:function(){return this._levelTriggerList},getTimingTriggerList:function(){return this._timingTriggerList},getTaskTriggerList:function(){return this._taskTriggerList},getTriggerListByScene:function(e){return this._triggerListByScene.get(e)},getTriggerListByEquipType:function(e){return this._triggerListByEquipType.get(e)},getTriggerListByGoodsType:function(e){return this._triggerListByGoodsType.get(e)},getTriggerListByPrizeType:function(e){return this._triggerListByPrizeType.get(e)},getClickTriggerList:function(){return this._clickTriggerList},getJoinGuildTriggerList:function(){return this._joinGuildTriggerList},getDujieSucceedTriggerList:function(){return this._dujieSucceedTriggerList},getCherishBeautyTriggerList:function(){return this._cherishBeautyTriggerList},getBianShenTriggerList:function(){return this._bianShenTriggerList},getBianShenBattleTriggerList:function(){return this._bianShenBattleTriggerList},getAlltaskTriggerList:function(){return this._alltaskTriggerList}})},{}],1205:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ClientViewDescCfg",setup:function(e){this.setupIds(e)}})},{}],1206:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"VipAwardCfg",setup:function(e){this.setupArrayByKey(e,"vipMinLv")}})},{}],1207:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"VipCfg",_maxVipLv:-1,_maxVipExp:-1,_maxVipRebateCount:0,_maxDailyRebateCount:0,_vipShowMap:null,_vipShowLvArr:null,ctor:function(){this._super(),this._vipShowMap=b8e.HashMap.get()},setup:function(e){if(this.setupByKey(e,"lv"),e&&0<e.length){for(var t,i=0;i<e.length;i++)(t=e[i])&&t.showPrize&&this._vipShowMap.set(t.lv,t);this._vipShowLvArr=this._vipShowMap.keys(),this._vipShowLvArr&&0<this._vipShowLvArr.length&&(this._vipShowLvArr.sort(this.onSort),this.maxVipShowLv=0|+this._vipShowLvArr[0]),this._maxVipRebateCount=e[e.length-1].vipRebateCount,this._maxDailyRebateCount=e[e.length-1].dailyRebateCount,this._maxVipLv=e.length-1}},getInfoByLv:function(e){return this.getDataByKey(e)},getMaxVipLv:function(){var e=game.vip.getVipLv();if(e<0&&(e=0),game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.LIMIT_VIP_LV)<=e)return this._maxVipLv;var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.NORMAL_MAX_VIP_LV);return 0<t?t:void 0},getVipShowInfoByLv:function(e){return this._vipShowMap.get(e)},getVipShowMapKeys:function(){return this._vipShowLvArr},onSort:function(e,t){return t-e},getMaxVipShowLv:function(){return this.maxVipShowLv},getMaxVipExp:function(){return this._maxVipExp=this.getVipExpByLv(this._maxVipLv),this._maxVipExp},getVipExpByLv:function(e){var t=this.getInfoByLv(e);return t?t.needVipExp:0},getQuickPassTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.quickPassTimes:1},getBuyPowerTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.buyBeautyTimes:3},getUseConvertGoldTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.useConvertGoldTimes:5},getBuyArenaTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.buyArenaTimes:5},getBuyInstanceTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.buyInstanceTimes:3},buyMaterialTimesByLv:function(e){var t=this.getInfoByLv(e);return t?t.buyMaterialTimes:0},addExpRate:function(e){var t=this.getInfoByLv(e);return t?t.addExpRate:0},addGoldRate:function(e){var t=this.getInfoByLv(e);return t?t.addGoldRate:0},rebirthItemUseCountByLv:function(e){var t=this.getInfoByLv(e);return t?t.rebirthItemUseCount:0},vipRebateCountByLv:function(e){var t=this.getInfoByLv(e);return t?t.vipRebateCount:3},dailyRebateCountByLv:function(e){var t=this.getInfoByLv(e);return t?t.dailyRebateCount:3},getVipAwardDesIdByLv:function(e){var t=this.getInfoByLv(e);return t?t.vipAwardDesId:3},getMaxRebateCount:function(){return this._maxVipRebateCount},getMaxDRC:function(){return this._maxDailyRebateCount},getMaxRetrieveDayCount:function(e){var t=this.getInfoByLv(e);return t?t.retrieveDays:1}})},{}],1208:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WanbaPrizeCfg",setup:function(e){this.setupIds(e)},getData:function(e){return this.data.get(Number(e))}})},{}],1209:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WanBaGameVipCfg",_vipDatas:null,ctor:function(){this._super()},setup:function(e){var t;this.data=b8e.HashMap.get(),this._vipDatas=b8e.HashMap.get();for(var i=0;i<e.length;i++)t=e[i],this.data.set(t.id,t),t.prizeType==game.WanbaPrizeType.WANBA_GAME_VIP&&this._vipDatas.set(t.id,t)},getWanBaGameVipDatas:function(){return this._vipDatas.values()},getWanBaDataById:function(e){return e?this.getDataByKey(e):null},getWanBaPrizeTypeById:function(e){return e?this.getDataByKey(e).prizeType:0}})},{}],1210:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WanfaCfg",ctor:function(){this._super()},setup:function(e){this.setupArrayByKey(e,"type")},getWanfaArrByType:function(e){var t=this.getDataByKey(e);return t&&0<t.length?t:[]}})},{}],1211:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WeekSignCfg",setup:function(e){this.setupByKey(e,"signDay")}})},{}],1212:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WelfareCfg",_map:null,_arr:null,ctor:function(){this._super(),this._map=b8e.HashMap.get(),this._arr1=[],this._arr101=[]},setup:function(e){for(var t,i=0;i<e.length;i++)if(t=e[i])switch(t.type){case game.SignType.NORMAL_TURN:this._arr1.push(t);break;case game.SignType.NEW_TURN:this._arr101.push(t)}this._map.set(game.SignType.NORMAL_TURN,this._arr1),this._map.set(game.SignType.NEW_TURN,this._arr101)},getWelfareExlInfoByType:function(e){return this._map.get(e)},getItemIdByType:function(e){var t=this.getWelfareExlInfoByType(e);return t?t.itemId:0},getItems:function(e){var t=this.getItemIdByType(e);return game.ccfg.ItemInfoCfg.getItemInfoById(t)}})},{}],1213:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WelfareGoldCfg",_map:null,ctor:function(){this._super(),this._map=b8e.HashMap.get()},setup:function(e){for(var t,i=0;i<e.length;i++)(t=e[i])&&this._map.set(t.level,t.gold)},getCoverGoldByLv:function(e){return this._map.get(e)}})},{}],1214:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WelfareRetrieveCfg",setup:function(e){this.setupByKey(e,"retrieveType")}})},{}],1215:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WorldBossAwardCfg",setup:function(e){this.setupByKey(e,"level")},getCfgByLevel:function(){for(var e=game.mainRole.mainRoleData.getLv(),t=this.data.keys(),i=0,n=t.length-1;0<=n&&!((i=t[n])<=e);n--);var s=this.getDataById(i);return s||null}})},{}],1216:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"WorldBossCfg",_map:null,ctor:function(){this._super(),this._map=b8e.HashMap.get()},setup:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=b8e.CommonUtil.xyToInt(i.id,i.startServer);this._map.set(n,i)}}},getData:function(e,t){var i=b8e.CommonUtil.xyToInt(e,t),n=this._map.get(i);return n||null}})},{}],1217:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"XiandanBarCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"type")},getIconByType:function(e){var t=this.getDataByKey(e);return t?t.titleBg:null}})},{}],1218:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"XiandanCfg",ctor:function(){this._super()},setup:function(e){this.setupByKey(e,"id")},getAttrById:function(e){var t=this.getDataByKey(e);return t?t.attr:null},getXiandanTypeById:function(e){var t=this.getDataByKey(e);return t?t.type:null},getUseLimitByDujieLv:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:700001;if(e<0)return 0;var i=this.getDataByKey(t);if(!i)return 0;var n=i.useTimesLimits;return!n||n.length<=0||e>=n.length?0:n[e]}})},{}],1219:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ZhanYaoAwardCfg",_zhanyaoScoreList:null,_zhanyaoLevelList:null,_zhanyaoAwardMap:null,getMaxScore:function(){var e=this._zhanyaoScoreList;return e&&0<e.length?e[e.length-1]:0},setup:function(e){this._zhanyaoScoreList=[],this._zhanyaoLevelList=[],this._zhanyaoAwardMap=b8e.HashMap.get();for(var t=0;t<e.length;t++){var i=e[t];if(i){-1==this._zhanyaoScoreList.indexOf(i.score)&&this._zhanyaoScoreList.push(i.score),-1==this._zhanyaoLevelList.indexOf(i.level)&&this._zhanyaoLevelList.push(i.level);var n=b8e.CommonUtil.xyToInt(i.level,i.score);this._zhanyaoAwardMap.set(n,i)}}this._zhanyaoScoreList.sort(this.onSort)},getAwardByScore:function(e){var t=game.mainRole.mainRoleData.getLv();if(!t)return null;for(var i=0,n=this._zhanyaoLevelList.length-1;0<=n&&!((i=this._zhanyaoLevelList[n])<=t);n--);var s=b8e.CommonUtil.xyToInt(i,e),a=this._zhanyaoAwardMap.get(s);return a?a.award:null},onSort:function(e,t){return e-t},getAwardScoreList:function(){return this._zhanyaoScoreList}})},{}],1220:[function(e,t,i){"use strict";t.exports=game.BaseCfg.extends({name:"ZhanYaoCfg",setup:function(e){this.setupIds(e)},getZhanyaoQuestById:function(e){return this.data.get(Number(e))}})},{}],1221:[function(e,t,i){"use strict";e("./ClientCfg"),e("./cfg/cfgIndex_0"),e("./ConfigMgr")},{"./ClientCfg":1088,"./ConfigMgr":1089,"./cfg/cfgIndex_0":1116}],1222:[function(e,t,i){"use strict";game.AttrPowerCoefType=b8e.Enum({TYPE_0:0,TYPE_1:1})},{}],1223:[function(e,t,i){"use strict";game.AttrRulesFormat=b8e.Enum({FORMAT_1:1,FORMAT_2:2,FORMAT_3:3})},{}],1224:[function(e,t,i){"use strict";game.AttrRulesType=b8e.Enum({AttrRulesType_0:0,AttrRulesType_1:1,AttrRulesType_2:2,AttrRulesType_3:3})},{}],1225:[function(e,t,i){"use strict";game.ClientRuleImgId=b8e.Enum({CS_ARENA_RULE_ID:100,RETRIEVE_RULE_ID:101,GUILD_EXP_CURE_RULE_ID:102,ACCESSORY_SKILL_RULE_ID:103,ESCORT_RULE_ID:104,BIANSHEN_FETTER_RULE_ID:105,WORLDCUP_RULE_ID:106,SELECT_BIANSHEN_RULE_ID:107})},{}],1226:[function(e,t,i){"use strict";game.GuildActiveType=b8e.Enum({GUILD_TASK:1,GUILD_WAR:2,GUILD_SHAO_XIANG:3,CHECK_XIN_FA:4,GUILD_BOSS:5,GUILD_CHUAN_GONG:6,CS_WAR:7})},{}],1227:[function(e,t,i){"use strict";game.GuildApplyType=b8e.Enum({REFUSED:1,AGREE:2,ALL_REFUSED:3,ALL_AGREE:4})},{}],1228:[function(e,t,i){"use strict";game.GuildLog=b8e.Enum({JOIN_TYPE:0,LEVEA_TYPE:1,LEVEL_UP_TYPE:2,CHANGE_RANK_TYPE:3})},{}],1229:[function(e,t,i){"use strict";game.GuildQuestType=b8e.Enum({CAN_RECEIVE:1,RECEIVE:2})},{}],1230:[function(e,t,i){"use strict";game.GuildRank=b8e.Enum({MASTER:0,ZHANG_LAO:1,MEMBER:2})},{}],1231:[function(e,t,i){"use strict";game.GuildState=b8e.Enum({OPEN:0,CLOSED:1,CHECK:2})},{}],1232:[function(e,t,i){"use strict";game.IcoSizeEnum=b8e.Enum({SIZE_72:72,SIZE_90:90,SIZE_107:107,SIZE_80:80,SIZE_95:95,SIZE_100:100})},{}],1233:[function(e,t,i){"use strict";game.IconScale=b8e.Enum({PERCENT_115:1.15,PERCENT_100:1,PERCENT_80:.8,PERCENT_67:.67,PERCENT_60:.6})},{}],1234:[function(e,t,i){"use strict";game.StarIconType=b8e.Enum({XINGXING:1,YUELIANG:2,TAIYANG:3,HUANGGUANG:4})},{}],1235:[function(e,t,i){"use strict";game.StarType=b8e.Enum({EQUIP_UP_STAR:0,BIANSHEN_STAR:2,BIANSHEN_DETAILS_STAR:3,CSARENA_MAIN_STAR:4})},{}],1236:[function(e,t,i){"use strict";game.SuraType=b8e.Enum({NORMAL_SURATYPE:0,CS_SURATYPE:1,CS_GUILDRANK_TYPE:2,CS_RANK_TYPE:3,CS_ENDGUILDRANK_TYPE:4})},{}],1237:[function(e,t,i){"use strict";game.SystemId=b8e.Enum({RELIVE_COUNT:1,PERSON_BOSS_COUNT:2,BUY_TILI_COUNT:3,BUY_BEAUTY_COUNT:4,BUY_ARENA_COUNT:5,TOTEM_COUNT:6,YINBI_INSPIRE_COUNT:7,YUANBAO_INSPIRE_COUNT:8,MYSTERY_REFRESH_COUNT:10,DUOBAO_COUNT:11,CS_ARENA:12,TEAM_CARD:13,TOWER_DAILY_AWARD:14,ACTIVITY_MYSTERY:15})},{}],1238:[function(e,t,i){"use strict";game.TriggerCompleteType=b8e.Enum({CLICK:"click",CLICK_MODAL:"click_modal",DIALOG_COMPLETE:"dialog_complete"})},{}],1239:[function(e,t,i){"use strict";game.TriggerType=b8e.Enum({LEVEL:"level",TIMING:"timing",SCENE:"scene",TASK:"task",CLICK:"click",GOODS:"goods",JOIN_GUILD:"join_guild",DUJIE_SUCCEED:"dujie_succeed",CHERISH_BEAUTY:"cherish_beauty",BIAN_SHEN:"bian_shen",BIAN_SHEN_BATTLE:"bian_shen_battle",ACHIEVEMENT:"achievement",CUSTOM:"custom"})},{}],1240:[function(e,t,i){"use strict";game.ZhuanPanCostType=b8e.Enum({AWARD_COST:1,ONCE_COST:2,MULTIPLE_COST:3})},{}],1241:[function(e,t,i){"use strict";e("./AttrPowerCoefType"),e("./AttrRulesFormat"),e("./AttrRulesType"),e("./GuildActiveType"),e("./GuildApplyType"),e("./GuildLog"),e("./GuildQuestType"),e("./GuildRank"),e("./GuildState"),e("./StarType"),e("./SystemId"),e("./TriggerType"),e("./TriggerCompleteType"),e("./IcoSizeEnum"),e("./IconScale")},{"./AttrPowerCoefType":1222,"./AttrRulesFormat":1223,"./AttrRulesType":1224,"./GuildActiveType":1226,"./GuildApplyType":1227,"./GuildLog":1228,"./GuildQuestType":1229,"./GuildRank":1230,"./GuildState":1231,"./IcoSizeEnum":1232,"./IconScale":1233,"./StarType":1235,"./SystemId":1237,"./TriggerCompleteType":1238,"./TriggerType":1239}],1242:[function(e,t,i){"use strict";game.CommandEvent=b8e.Enum({TRIGGER_COMMAND:b8e.Event.nextCode(),PREVENT_COMMAND:b8e.Event.nextCode()})},{}],1243:[function(e,t,i){"use strict";game.MiscEvent=b8e.Enum({UPDATE_MAIN_MUNE_BUTTON_STATE:b8e.Event.nextCode()})},{}],1244:[function(e,t,i){"use strict";game.RoleDataEvent=b8e.Enum({MAIN_ROLE_LEVEL_UP:b8e.Event.nextCode(),MAIN_ROLE_EXP_CHANGE:b8e.Event.nextCode(),MAIN_ROLE_APPEARANCE_UPDATE:b8e.Event.nextCode()})},{}],1245:[function(e,t,i){"use strict";game.SceneEvent=b8e.Enum({DROP_ITEM_OWNER_CHANGE:b8e.Event.nextCode(),LOAD_SCENE_COMPLETE:b8e.Event.nextCode(),ENTER_WORLD_BOSS:b8e.Event.nextCode(),LEAVE_WORLD_BOSS:b8e.Event.nextCode(),UPDATE_WORLD_BOSS:b8e.Event.nextCode(),UPDATE_ALL_WORLD_BOSS:b8e.Event.nextCode(),UPDATE_WORLD_BOSS_INSPIRE:b8e.Event.nextCode(),UPDATE_LINE:b8e.Event.nextCode(),SHOW_LINE_MENU:b8e.Event.nextCode(),PING_CHANGE:b8e.Event.nextCode()})},{}],1246:[function(e,t,i){"use strict";game.TrusteeshipEvent=b8e.Enum({AUTO_FIGHT_STATE_CHANGE:b8e.Event.nextCode()})},{}],1247:[function(e,t,i){"use strict";e("./RoleDataEvent"),e("./SceneEvent"),e("./CommandEvent")},{"./CommandEvent":1242,"./RoleDataEvent":1244,"./SceneEvent":1245}],1248:[function(e,t,i){"use strict";game.CastSpellHelper=b8e.Object.extends({_relaseSpellInfo:null,minAttackLv:0,ctor:function(){if(1==game.CastSpellHelper._singleton)throw new Error("CastSpellHelper 只能通过单例方法获取");this._relaseSpellInfo=new game.ReleaseSpellInfo},releaseSpell:function(e,t,i,n,s){var a=e.id;if(game.ShapeShiftMgr.inst().autoShapeToNext(),this._relaseSpellInfo.clear(),this._relaseSpellInfo.releaseEntityId=game.mainRole.mainRoleData.id,this._relaseSpellInfo.releaseSpellId=a,this._relaseSpellInfo.direction=n,this._relaseSpellInfo.targetId=t,this._relaseSpellInfo.targetIds=[t],game.SpellReleaseHelper.inst().releaseSpell(this._relaseSpellInfo),game.skill.releaseSpell(e.id),game.PlotMgr.inst().isPlaying()){if(s&&s.data.isClientRole){var o=game.mainRole.mainRoleEntity;game.HitSpellHelper.spellHit(o,s.type,e,this._relaseSpellInfo)}}else{var r=b8e.SceneMgr.inst().getActiveScene().getGridPosByPixel(i.x,i.y),h=game.pbmsg.CastSpellRequest;h.spellId=a,h.direction=n,h.targetEid=t,h.casterPos=r,engine.NetSender.getBytes().writeProtobuf(h);var g=game.pbmid.Spell.CastSpellRequest;b8e.sendN(g)}},checkReleaseSpell:function(e,t){return t},checkAttack:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e.data.type==game.RoleType.Npc)return!1;var i=game.mainRole.mainRoleEntity;if(i.data.pkMode==game.PkModeType.PEACE){if(e.data.type==game.RoleType.Hero)return!1}else{if(i.data.pkMode==game.PkModeType.GUILD&&i.data.guildId==e.data.guildId&&0!=i.data.guildId)return!1;if(e.data.type==game.RoleType.Hero){if(i.data.inSafeArea)return t&&game.notice.show("在安全区内不能攻击他人！"),!1;if(e.data.inSafeArea)return t&&game.notice.show("对方在安全区内不能被攻击！"),!1;if(e.data.getLv()<this.minAttackLv)return t&&game.notice.show("目标等级不足"+this.minAttackLv+"级，无法攻击"),!1;if(i.data.getLv()<this.minAttackLv)return t&&game.notice.show("自身等级不足"+this.minAttackLv+"级，无法攻击"),!1}}return!e.getStateMachine().isDeadState()}}),game.CastSpellHelper.castSpellCount=0,game.CastSpellHelper._instance=null,game.CastSpellHelper._singleton=!0,game.CastSpellHelper.inst=function(){return null==game.CastSpellHelper._instance&&(game.CastSpellHelper._singleton=!1,game.CastSpellHelper._instance=new game.CastSpellHelper,game.CastSpellHelper._singleton=!0),game.CastSpellHelper._instance}},{}],1249:[function(e,t,i){"use strict";game.CastSpellType=b8e.Enum({None:0,StateFail:-1,StateSuccess:-1,StateNotInReleaseDistance:-1})},{}],1250:[function(e,t,i){"use strict";game.FightFaceHelper=b8e.Object.extends({ctor:function(){if(1==game.FightFaceHelper._singleton)throw new Error("SpellReleaseHelper 只能通过单例方法获取")}}),game.FightFaceHelper._instance=null,game.FightFaceHelper._singleton=!0,game.FightFaceHelper.inst=function(){return null==game.FightFaceHelper._instance&&(game.FightFaceHelper._singleton=!1,game.FightFaceHelper._instance=new game.FightFaceHelper,game.FightFaceHelper._singleton=!0),game.FightFaceHelper._instance}},{}],1251:[function(e,t,i){"use strict";game.FightTargetMgr=b8e.Object.extends({_targetId:null,fightTarget:!1,_nextUpdateTime:0,_timer:null,ctor:function(){if(1==game.FightTargetMgr._singleton)throw new Error("TrusteeshipMgr 只能通过单例方法获取")},start:function(e){this._targetId=e,1!=this.fightTarget&&(this.fightTarget=!0,this.update(),this._timer||(this._timer=b8e.Timer.add(this,this.update,50,0,10)),this._timer.reset(),this._timer.start())},stop:function(){this._targetId=null,0!=this.fightTarget&&(this.fightTarget=!1,this._timer&&this._timer.stop())},update:function(e){var t=game.sceneRole.getDisplayById(this._targetId);if(t){if(0!=this.fightTarget&&b8e.scene.isLoaded()&&(e||!(b8e.timeStamp<this._nextUpdateTime))){var i=t.getStateMachine();if(i&&!i.isDeadState()){var n=null,s=game.mainRole.mainRoleEntity;if(s&&(n=s.getAiMachine()),n){var a=n.getReference(game.FindAttackableReference);a.setParams({x:s.x,y:s.y},null,[this._targetId],0),n.transition(game.AIStateType.FIND_ATTACKABLE,a,e)}}else this.stop()}}else this.stop()},setupNextUpdateTime:function(e){this._nextUpdateTime=b8e.timeStamp+e-16}}),game.FightTargetMgr._instance=null,game.FightTargetMgr._singleton=!0,game.FightTargetMgr.inst=function(){return null==game.FightTargetMgr._instance&&(game.FightTargetMgr._singleton=!1,game.FightTargetMgr._instance=new game.FightTargetMgr,game.FightTargetMgr._singleton=!0),game.FightTargetMgr._instance}},{}],1252:[function(e,t,i){"use strict";var _=game.HitSpellHelper={};_.spellHit=function(h,e,g,l){var c=0,u=0,t=_.findNearestEnemy(h,e);if(0<t.length){var m=0;t.every(function(e){if(c<g.maxVictims){var t=b8e.MathUtil.getDegree(h.x,h.y,e.x,e.y);t=b8e.MathUtil.normalDegree(t);var i=b8e.MathUtil.getDistance(h.x,h.y,e.x,e.y),n=b8e.CommonUtil.getAngleByDirection(game.Direction.getAnimatDirection(l.direction));n=b8e.MathUtil.normalDegree(n);var s=.5*g.angle;if(i<=g.radius&&(n-s<=t&&t<=n+s||n-s+360<=t&&t<=n+s+360)){var a=h.data.baseSpriteStat.getStatValue(game.SpriteStatType.ATK),o=a*a/(a+5*e.data.baseSpriteStat.getStatValue(game.SpriteStatType.DEF))*1.5*g.dmgCoef*b8e.MathUtil.random(.95,1.05);if(o=Math.ceil(o),h.data.isSelf?e.showBar():e.data.isSelf&&(h.updateAttackMeTime(),h.showBar()),e.updateLastAttackMeId(h.data.id),++u<=5){var r=e.getStateRef(game.HitEffectReference);r.setParams(h.data.id,g.hurtEffect,g.releaseDelay,o),r.hitType=game.BCType.NORMAL,r.isInTarget=g.isInTarget,e.transitionState(game.RoleStateType.CONTROL_HIT_EFFECT,r)}b8e.Tween.get(e).wait(g.releaseDelay+m).call(_.hitHurt,_,[h,h.poolHash,e,e.poolHash,o,game.BCType.NORMAL]),c++,m+=20}return!0}return!1},_)}},_.hitHurt=function(e,t,i,n,s){if(e.hashUsable(t)||(e=null),i.hashUsable(n)||(i=null),i){var a=i.data.spriteStat.getStatValue(game.SpriteStatType.HP);if(a-=s,i.data.spriteStat.setStatValue(game.SpriteStatType.HP,a),a<=0&&i.usable&&!i.getStateMachine().isDeadState())if(i.data.type==game.RoleType.Hero)i.transitionState(game.RoleStateType.ACTION_DEATH,null,!0);else if(i.data.type==game.RoleType.Monster){var o=i.getStateRef(game.DeathFlyReference);o.setParams(e?e.data.id:0,0),i.transitionState(game.RoleStateType.ACTION_DEATH_FLY,o)}i.updateHpBar();var r=game.BCType.NORMAL;game.bounceCharacters.hitFace(e,i,-s,r,i.data.isSelf)}},_.findNearestEnemy=function(s,t){var i=[];return b8e.scene.getDisplays().forEach(function(e){e.usable&&e instanceof game.SceneRole&&e.type==t&&(e.getStateMachine().isDeadState()||i.push(e))},this),i.sort(function(e,t){if(e.attackMeTime<t.attackMeTime)return 1;if(e.attackMeTime>t.attackMeTime)return-1;var i=b8e.MathUtil.getDistanceNoSqrt(s.x,s.y,e.x,e.y),n=b8e.MathUtil.getDistanceNoSqrt(s.x,s.y,t.x,t.y);return n<i?1:i<n?-1:0}),i}},{}],1253:[function(e,t,i){"use strict";game.MoveToHelper=b8e.Object.extends({MOVE_SPEED:0,moveToCd:0,_moveMsg:null,moveTo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];game.mainRole.mainRoleEntity.getStateMachine().isDeadState()||game.SceneMgr.inst().showGroundClickIndicator(e),this.moveToCd+200>game.SysTime.curTime?(b8e.Tween.kill(this),b8e.Tween.get(this).wait(200).call(this.clickMap,this,[e,t,i,n,s,a])):(this.moveToCd=game.SysTime.curTime,this.clickMap(e,t,i,n,s,a))},clickMap:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];b8e.Tween.kill(this),game.mainRole.mainRoleEntity.getStateMachine().isDeadState()||this.selfMoveTo(e,t,i,n,s,a)},stopMove:function(){b8e.Tween.kill(this);var e=game.mainRole.mainRoleEntity;if(e){var t=e.getStateRef(game.StopWalkMoveStateReference),i=e.getGridPosition();t.setParams(i.x,i.y),e.transitionState(game.RoleStateType.CONTROL_STOP_WALK_MOVE,t,!0)}},entityMoveTo:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;if(b8e.scene.isLoaded()){if(e){var r=this.MOVE_SPEED,h=e.getGridPosition(),g=t,l=e.getStateRef(game.WalkStateReference);l.setParams(r,0,0,null,{startTime:i,path:[h,g]}),l.onArrive(n,s,a),l.pathEndPos=o,e.transitionState(game.RoleStateType.ACTION_WALK,l,!0)}}else b8e.warn("场景没有初始化完成，但是想要开始寻路了")},_selfMoveComplete:null,_selfMoveThisArg:null,_selfMoveArgs:null,selfMoveTo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(b8e.scene.isLoaded()){if(!game.guild.isExpCure){var o=game.mainRole.mainRoleEntity,r=this.MOVE_SPEED,h=b8e.scene.getGridPosByPixel(e.x,e.y),g=o.getGridPosition();if(h.x==g.x&&h.y==g.y)return game.SceneMgr.inst().hideGroundClickIndicator(),void(i&&i.apply(n,s));var l=o.getStateRef(game.WalkStateReference);l.setParams(r,0,t,h),o.getStateMachine().isJumpMoving()||(game.EventAreaChecker.endPosTaget=h,i?(game.EventAreaChecker.completeEvent=i,game.EventAreaChecker.completeThisArg=n,game.EventAreaChecker.args=s):(game.EventAreaChecker.completeEvent=null,game.EventAreaChecker.completeThisArg=null,game.EventAreaChecker.args=null)),this._selfMoveComplete=i,this._selfMoveArgs=s,this._selfMoveThisArg=n,l.onArrive(this._moveComplete,this),l.onLeave(this._moveStateLeave,this),o.transitionState(game.RoleStateType.ACTION_WALK,l,a)}}else b8e.warn("场景没有初始化完成，但是想要开始寻路了")},_moveStateLeave:function(){game.SceneMgr.inst().hideGroundClickIndicator();var e=game.mainRole.mainRoleEntity;if(e){var t=e.getGridPosition();this.moveCompleteStopMove(t.x,t.y)}},_moveComplete:function(){game.SceneMgr.inst().hideGroundClickIndicator(),this._selfMoveComplete&&this._selfMoveThisArg&&this._selfMoveComplete.apply(this._selfMoveThisArg,this._selfMoveArgs)},addMoveCd:function(){this.moveToCd=game.SysTime.curTime+200},moveCompleteStopMove:function(e,t){if(!game.PlotMgr.inst().isPlaying()){this._moveMsg||(this._moveMsg=b8e.ProtobufUtil.createMessage(game.pbmsg.MovePosRequest)),this._moveMsg.ts=game.SysTime.curTime,this._moveMsg.pos||(this._moveMsg.pos={}),this._moveMsg.pos.x=e,this._moveMsg.pos.y=t,this._moveMsg.targetPos||(this._moveMsg.targetPos={}),this._moveMsg.targetPos.x=e,this._moveMsg.targetPos.y=t,this._moveMsg.pathEndPos||(this._moveMsg.pathEndPos={}),this._moveMsg.pathEndPos.x=e,this._moveMsg.pathEndPos.y=t,engine.NetSender.getBytes().writeProtobuf(this._moveMsg);var i=game.pbmid.Scene.MovePosRequest;b8e.sendN(i)}}}),game.MoveToHelper._instance=null,game.MoveToHelper._singleton=!0,game.MoveToHelper.inst=function(){return null==game.MoveToHelper._instance&&(game.MoveToHelper._singleton=!1,game.MoveToHelper._instance=new game.MoveToHelper,game.MoveToHelper._singleton=!0),game.MoveToHelper._instance}},{}],1254:[function(e,t,i){"use strict";game.SpellCenterType=b8e.Enum({SELF:0,TARGET:1})},{}],1255:[function(e,t,i){"use strict";game.SpellReleaseHelper=b8e.Object.extends({name:"SpellReleaseHelper",_effectTick:null,_selfEffectList:null,_otherEffectList:null,_effectPool:null,_dtCount:0,releaseSpellInfo:null,ctor:function(){if(1==game.SpellReleaseHelper._singleton)throw new Error("SpellReleaseHelper 只能通过单例方法获取");this._selfEffectList=[],this._otherEffectList=[],this._effectPool=[],this._effectTick=b8e.Ticker.add(this,this._effectUpdate),this.releaseSpellInfo=game.ReleaseSpellInfo.get()},_getEffectInfo:function(){return 0<this._effectPool.length?this._effectPool.shift():new game.SpellReleaseHelper.EffectInfo},_addEffect:function(e,t,i,n){if(e&&e.data&&e.usable){var s=this._getEffectInfo();s.releaseRole=e,s.callFun=t,s.thisArg=i,s.args=n,e.data.isSelf?this._selfEffectList.push(s):this._otherEffectList.push(s)}},_effectUpdate:function(e){if(0!=this._selfEffectList.length||0!=this._otherEffectList.length){var t,i;0<this._selfEffectList.length?i=this._selfEffectList:0<this._otherEffectList.length&&(i=this._otherEffectList);for(var n=0;n<2;n++)if(0<i.length){if(!(t=i.shift()).releaseRole||!t.releaseRole.data||!t.releaseRole.usable)continue;t.callFun.apply(t.thisArg,t.args),this._effectPool.push(t)}}},clearEffectList:function(){for(var e,t=this._selfEffectList.length,i=0;i<t;i++)e=this._selfEffectList[i],this._effectPool.push(e);this._selfEffectList.length=0,t=this._otherEffectList.length;for(i=0;i<t;i++)e=this._otherEffectList[i],this._effectPool.push(e);this._otherEffectList.length=0},releaseSpell:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){var i=null;if(i=0<e.releaseEntityType?game.sceneRole.getDisplayByTypeAndId(e.releaseEntityType,e.releaseEntityId):game.sceneRole.getDisplayById(e.releaseEntityId)){var n=game.ccfg.SpellCfg.getSpellById(e.releaseSpellId);if(n){var s=game.Direction.getRadian(e.direction);if(1==i.data.isSelf||i.getHierarchyVisible()&&i.getAttachVisible(game.AttachType.BODY)&&0<n.releaseAnimationDuration){var a=i.getStateRef(game.AttackStateReference);a.setParams(n.releaseAnimation,n.releaseEffect,s,0),a.breakFrameTime=n.releaseAnimationDuration,i.transitionState(game.RoleStateType.ACTION_ATTACK,a,t)}if(game.PerfMgr.inst().level!=game.PerfMgr.Level.LOW){var o=game.SceneMgr.inst().sceneType;if(!game.setting.getSpellSelect()||0!=i.data.isSelf||o==game.SceneType.ARENA||i.data.type==game.RoleType.Monster){switch(n.releaseEffect&&this._addEffect(i,this.showKnifeLightEffect,this,[n.releaseEffect,i,n.isInReleaser,n.effectOffsetPosY]),n.spellType){case game.SpellType.FlySpell:if(i&&i.data){var r=i.getPosition(),h=b8e.CommonUtil.getAngleByDirection(i.getDirection());this._addEffect(i,this.flySpellEffect,this,[n,r,h,i]);break}case game.SpellType.RangeSpell:if(n.center==game.SpellCenterType.SELF)this._addEffect(i,this.addRangeSpellEffect,this,[n,i]);else if(e.targetId){var g=game.sceneRole.getDisplayById(e.targetId);g?this._addEffect(i,this.addRangeSpellEffect,this,[n,g]):b8e.warn("目标消失了？")}break;case game.SpellType.RangeDirectionSell:this._addEffect(i,this.addRangeSpellDirectionEffect,this,[n,i])}i.data&&i.data.isSelf&&0<n.shake&&this._addEffect(i,this.addShake,this,[i,n])}}}else b8e.error("spellData null")}else b8e.log("未找到指定释放技能的对象")}else b8e.error("releaseSpellInfo null")},showKnifeLightEffect:function(e,t,i,n){if(t.getHierarchyVisible()&&t.getAttachVisible(game.AttachType.BODY)){var s,a=game.ClientCfg.getSkillFx(e),o=game.ccfg.PropertyCfg.getDataByKey(e);if(s=!!o&&0!=o.autoRotation,i){var r=t.getAnimator(game.AnimatorType.KNIFE_LIGHT_EFFECT,1);r||(r=t.addAnimator(game.AnimatorType.KNIFE_LIGHT_EFFECT,1,50)),r.load(a,null,null,{preload:t.data.isSelf,recycleDelay:t.data.isSelf?6e5:1e4}),r.play(),r.autoRelease()}else{var h=t.getPosition();game.EffectUtil.playEffect(t,a,t.getDirection(),h,s)}}},addShake:function(e,t){b8e.Tween.kill(b8e.scene),b8e.Tween.get(b8e.scene).wait(t.shakeDelay).call(this.shake,this,[t.shakeSpace,t.shakeCount])},addRangeSpellEffect:function(e,t){if(e&&e.rangeSetList&&e.rangeEffect&&t)for(var i,n=game.ClientCfg.getSkillFx(e.rangeEffect),s=0;s<e.rangeSetList.length;s++)if(void 0!==(i=e.rangeSetList[s]).x&&void 0!==i.y&&void 0!==i.z){var a=t.getPosition();a={x:a.x+i.x,y:a.y+i.y},this._addEffect(t,game.EffectUtil.playEffect,game.EffectUtil,[t,n,t.getDirection(),a,!1,!1,i.z])}else b8e.warn("范围技能配置错误",e.id);else b8e.warn("范围技能配置错误 rangeSet || rangeEffect",e.id)},addRangeSpellDirectionEffect:function(e,t){if(e&&e.rangeSet&&e.rangeEffect&&t)for(var i,n,s,a,o=game.ClientCfg.getSkillFx(e.rangeEffect),r=t.getDirection(),h=0;h<e.rangeSetList.length;h++)void 0!==(i=e.rangeSetList[h]).x&&void 0!==i.y&&void 0!==i.z?(n=t.getPosition(),s=b8e.CommonUtil.getRadianByDirection(r),s=b8e.MathUtil.getRadian(0,0,i.x,i.y)+1.57+s,a=b8e.MathUtil.getDistance(0,0,i.x,i.y),n=b8e.MathUtil.getRadianPos(n.x,n.y,s,a),this._addEffect(t,game.EffectUtil.playEffect,game.EffectUtil,[t,o,t.getDirection(),n,!1,!1,i.z])):b8e.warn("范围技能配置错误",e.id);else b8e.warn("范围技能配置错误 rangeSet || rangeEffect",e.id)},shake:function(e,t){this.isShake=!0;var i=t+5;this.shakeScene(0,t,e,i)},shakeScene:function(e,t,i,n){if(t<=e)b8e.scene.getContainer().setOffset(0,0);else{var s=0,a=0;e%3==0?(s=-(n-e)*Math.random(),a=-(n-e)*Math.random()):e%3==1?a=s=0:(s=(n-e)*Math.random(),a=(n-e)*Math.random()),b8e.scene.getContainer().setOffset(s,a),e++,b8e.Tween.kill(b8e.scene),b8e.Tween.get(b8e.scene).wait(i).call(this.shakeScene,this,[e,t,i,n])}},flySpellEffect:function(e,t,i,n){i=-1*i+90+180;var s=game.ClientCfg.getSkillFx(e.flyEffect),a=game.FlySceneEffect.get();a.setPosition(t.x,t.y),n&&n.data&&(b8e.scene.addDisplay(a,void 0,!0,!n.data.isSelf,!n.data.isSelf),a.playEffect(s,i,t,e.isRotation,n,e))}}),game.SpellReleaseHelper.EffectInfo=b8e.Object.extends({releaseRole:null,callFun:null,thisArg:null,args:null}),game.SpellReleaseHelper._instance=null,game.SpellReleaseHelper._singleton=!0,game.SpellReleaseHelper.inst=function(){return null==game.SpellReleaseHelper._instance&&(game.SpellReleaseHelper._singleton=!1,game.SpellReleaseHelper._instance=new game.SpellReleaseHelper,game.SpellReleaseHelper._singleton=!0),game.SpellReleaseHelper._instance}},{}],1256:[function(e,t,i){"use strict";game.SpellTargetType=b8e.Enum({None:0,All:-1,Self:-1,Team:-1})},{}],1257:[function(e,t,i){"use strict";game.SpellType=b8e.Enum({None:0,NormalSpell:1,FlySpell:2,Passive:3,RangeSpell:4,RangeDirectionSell:5})},{}],1258:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.TrusteeshipMgr=b8e.Object.extends((s(n={autoFight:!1,_targets:null,_isPause:!1,_isStart:!1,_autoTrusteeshipTimer:null,monsterModelId:0,autoFindEnemy:!1,_lastPkMode:game.PkModeType.PEACE,_timer:null,_nextUpdateTime:0},"_timer",null),s(n,"ctor",function(){if(1==game.TrusteeshipMgr._singleton)throw new Error("TrusteeshipMgr 只能通过单例方法获取")}),s(n,"clearMonsterModel",function(){this.monsterModelId=0}),s(n,"pause",function(e){if(e&&(this._targets=null,this.autoFindEnemy=!0),this.monsterModelId=0,this._isPause=!0,game.mainRole){var t=game.mainRole.mainRoleEntity;if(t){var i=t.getAiMachine();i&&i.transition(game.AIStateType.AI_NONE)}}}),s(n,"resume",function(e){e&&(this._targets=null,this.autoFindEnemy=!0),0!=this._isPause&&(this._isPause=!1)}),s(n,"start",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.resume(!0),this.monsterModelId=e,this.autoFindEnemy=t,this.autoFight||(game.FightTargetMgr.inst().stop(),this.autoFight=!0,this._timer||(this._timer=b8e.Timer.add(this,this.onUpdate,100,0,10)),this._timer.reset(),this._timer.start(),b8e.evt.dptG(game.TrusteeshipEvent.AUTO_FIGHT_STATE_CHANGE))}),s(n,"stop",function(){if(this.autoFight){this.monsterModelId=0,this.autoFight=!1,this._targets=null,this.autoFindEnemy=!0,game.ScenePickMgr.inst().selectTarget(null),game.FightTargetMgr.inst().stop();var e=null,t=game.mainRole.mainRoleEntity;t&&(e=t.getAiMachine()),e&&e.transition(game.AIStateType.AI_NONE),this._timer&&this._timer.stop(),b8e.evt.dptG(game.TrusteeshipEvent.AUTO_FIGHT_STATE_CHANGE)}}),s(n,"onUpdate",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(!this._isPause&&0!=this.autoFight&&b8e.scene.isLoaded()&&(e||!(b8e.timeStamp<this._nextUpdateTime))){var t=null,i=game.mainRole.mainRoleEntity;if(i&&(t=i.getAiMachine()),t){var n=t.getReference(game.FindAttackableReference);n.setParams({x:i.x,y:i.y},null,this._targets,0,this.monsterModelId,this.autoFindEnemy),t.transition(game.AIStateType.FIND_ATTACKABLE,n,e)}}}),s(n,"setupNextUpdateTime",function(e){this._nextUpdateTime=b8e.timeStamp+e-16}),s(n,"setTargets",function(e){if(this._targets&&e){var t=!0;e.every(function(e){return!(this._targets.indexOf(e)<0)||(t=!1)},this),t||(this._targets=e)}else this._targets=e}),n)),game.TrusteeshipMgr._instance=null,game.TrusteeshipMgr._singleton=!0,game.TrusteeshipMgr.inst=function(){return null==game.TrusteeshipMgr._instance&&(game.TrusteeshipMgr._singleton=!1,game.TrusteeshipMgr._instance=new game.TrusteeshipMgr,game.TrusteeshipMgr._singleton=!0),game.TrusteeshipMgr._instance}},{}],1259:[function(e,t,i){"use strict";e("./SpellCenterType"),e("./CastSpellHelper"),e("./CastSpellType"),e("./FightFaceHelper"),e("./MoveToHelper"),e("./SpellReleaseHelper"),e("./SpellTargetType"),e("./HitSpellHelper"),e("./SpellType"),e("./TrusteeshipMgr"),e("./FightTargetMgr")},{"./CastSpellHelper":1248,"./CastSpellType":1249,"./FightFaceHelper":1250,"./FightTargetMgr":1251,"./HitSpellHelper":1252,"./MoveToHelper":1253,"./SpellCenterType":1254,"./SpellReleaseHelper":1255,"./SpellTargetType":1256,"./SpellType":1257,"./TrusteeshipMgr":1258}],1260:[function(e,t,i){"use strict";game.AccSlotInfo=b8e.Object.extends({index:0,itemId:0,setup:function(e){if(!e)return this.index=0,void(this.itemId=0);this.index=e.index,this.itemId=e.itemId},isHasEquip:{get:function(){return 0!=this.itemId}},setSlotType:function(e){this.index=e}})},{}],1261:[function(e,t,i){"use strict";game.AccessoryData=b8e.Object.extends({_lv:0,exp:0,_wearedLv:0,expResetTs:0,setup:function(e){this._lv=e.lv,this.exp=e.exp,this._wearedLv=e.wearedLv,this.expResetTs=e.expResetTs},lv:{get:function(){return this._lv/10>>0},set:function(e){this._lv=e}},wearedLv:{get:function(){return this._wearedLv/10>>0}}})},{}],1262:[function(e,t,i){"use strict";e("./enum/AccessoryType"),e("./AccessoryData")},{"./AccessoryData":1261,"./enum/AccessoryType":1263}],1263:[function(e,t,i){"use strict";game.AccessoryType=b8e.Enum({None:0,Mount:1,Wing:2,FaBao:3,XianZhen:4})},{}],1264:[function(e,t,i){"use strict";game.ActiveConditionsInfo=b8e.Object.extends({type:0,value:0,expireTime:0})},{}],1265:[function(e,t,i){"use strict";game.ActiveRankInfo=b8e.Object.extends({id:0,rank:0,value:0,rankInfo:null})},{}],1266:[function(e,t,i){"use strict";game.ActiveSubType=b8e.Enum({ST_REBATE:0,ST_TARGET_LEVEL:1,ST_TARGET_FIGHGT_AMOUNT:2,ST_TARGET_REPUTATION:3,ST_TARGET_ARENA:4,ST_TARGET_EQUIP_STAR:5,ST_TARGET_MOUNT:6,ST_TARGET_WING:7,ST_TARGET_FABAO:8,ST_RANK_LEVEL:9,ST_RANK_FIGHGT_AMOUNT:10,ST_RANK_AMULET:11,ST_RANK_ARENA:12,ST_RANK_EQUIP_STAR:13,ST_RANK_MOUNT:14,ST_RANK_WING:15,ST_RANK_FABAO:16,ST_RECHARGE_ACTIVEREBATE:20,FESTIVAL_LOGIN:21,ST_FESTIVAL_REBATE:22,ST_DUOBAO_NORMAL:23,ST_ZHUANPAN_NORMAL:24,ST_COLLECT_EXCHANGE:25,ST_FESTIVAL_RECHARGE:26,ST_ZHUANPAN_BAOZHU:27,ST_ZHUANPAN_COMBINE:28,ST_ZHUANPAN_FOREVER:29,ST_ZHUANPAN_FESTIVAL:30,ST_COST_TARGET_MOUNT:31,ST_COST_TARGET_WING:32,ST_COST_TARGET_FABAO:33,ST_COST_TARGET_EXCHANGE:34,ST_COST_TARGET_RAFFLE:35,ST_COST_TARGET_ZHUANPAN:36,ST_COST_TARGET_REPUTATION:37,ST_COST_TARGET_STAR:38,ST_COST_TARGET_BIANSHEN:39,ST_COST_TARGET_ZHAOCAI:40,ST_COST_RANK_MOUNT:41,ST_COST_RANK_WING:42,ST_COST_RANK_FABAO:43,ST_COST_RANK_EXCHANGE:44,ST_COST_RANK_RAFFLE:45,ST_COST_RANK_ZHUANPAN:46,ST_COST_RANK_REPUTATION:47,ST_COST_RANK_STAR:48,ST_COST_RANK_BIANSHEN:49,ST_COST_RANK_ZHAOCAI:50,ST_SYSTEM_HONGBAO:51,ST_RECHARGE_ACCUMULATE_RECHARGE:1001,ST_RECHARGE_REBATE:1002,ST_RECHARGE_SALE_DAILY:1011,ST_RECHARGE_DAILY_DISCOUNT:1012,ST_WORLD_BOSS:52,ST_VIP_REBATE:55,ST_DAILY_REBATE:56,ST_ZHUANPAN_LOW_COST:70,ST_ZHUANPAN_MIDDLE_COST:71,ST_ZHUANPAN_UP_COST:72,ST_ZHUANPAN_RECHARGE:73,SINGLE_RECHARGE:75,ST_SINGLE_RECHARGE_2:350,ST_SINGLE_RECHARGE_3:351,ST_ZHUANPAN_EASTEREGG:76,ST_ZHUANPAN_EASTEREGG_GOLD:77,ST_ZHUANPAN_DIAMOND:78,ST_ZHUANPAN_VIP:79,ST_ZHUANPAN_BIANSHEN:80,ST_COST_TARGET_EASTEREGG:90,ST_COST_RANK_EASTEREGG:110,ST_COST_RANK_ZHUANPAN_BIANSHEN:111,ST_COST_TARGET_DIAMOND:61,ST_COST_TARGET_DIAMOND_DAILY:62,ST_COST_TARGET_MOUNT_NEW:120,ST_COST_TARGET_WING_NEW:121,ST_COST_TARGET_FABAO_NEW:122,ST_COST_TARGET_STAR_NEW:123,ST_NEW_RECHARGE:124,ST_COST_TARGET_ZHAOCAI_NEW:125,ST_COST_TARGET_RAFFLE_NEW:126,ST_COST_TARGET_XIANZHEN_NEW:127,ST_COST_TARGET_REPUTATION_NEW:128,ST_COST_TARGET_BIANSHEN_NEW:129,ST_COST_TARGET_ZHUANPAN_NEW:130,ST_COST_TARGET_TOWER_NEW:131,ST_COST_TARGET_HIGH_EQUIP_NEW:132,ST_COST_TARGET_XUNBAO_NEW:133,ST_COST_TARGET_CROSS_ZHUANPAN:150,ST_COST_TARGET_CROSS_STAR:151,ST_COST_TARGET_CROSS_FABAO:152,ST_COST_TARGET_CROSS_REPUTATION:153,ST_COST_TARGET_CROSS_MOUNT:154,ST_COST_TARGET_CROSS_WING:155,ST_COST_TARGET_CROSS_BIANSHEN:156,ST_COST_TARGET_CROSS_PURCHASE:157,ST_COST_TARGET_CROSS_XIANZHEN:158,ST_COST_RANK_CROSS_ZHUANPAN:180,ST_COST_RANK_CROSS_STAR:181,ST_COST_RANK_CROSS_FABAO:182,ST_COST_RANK_CROSS_REPUTATION:183,ST_COST_RANK_CROSS_MOUNT:184,ST_COST_RANK_CROSS_WING:185,ST_COST_RANK_CROSS_BIANSHEN:186,ST_COST_RANK_CROSS_PURCHASE:187,ST_COST_RANK_CROSS_XIANZHEN:188,ST_CROSS_REBATE:200,ST_CROSS_REBATE_PURCHASE:201,ST_CROSS_REBATE_ZHUANPAN:202,ST_CROSS_REBATE_STAR:203,ST_CROSS_REBATE_FABAO:204,ST_CROSS_REBATE_REPUTATION:205,ST_CROSS_REBATE_MOUNT:206,ST_CROSS_REBATE_WING:207,ST_CROSS_REBATE_BIANSHEN:208,ST_CROSS_REBATE_XIANZHEN:209,ST_FRAGMENT_CONVERT:220,ST_MYSTERY:380,ST_COLLECT_EXCHANGE_2:385,ST_COLLECT_EXCHANGE_3:386,ST_TARGET_XIANZHEN:240,ST_COST_TARGET_XIANZHEN:250,ST_RANK_XIANZHEN:280,ST_COST_RANK_XIANZHEN:290,ST_RANK_HIGH_EQUIP:400,ST_COST_TARGET_ZHUANPAN_BIANSHEN:91,ST_TIME_LIMIT_RECHARGE_1:420,ST_TIME_LIMIT_ACCUMULATE_RECHARGE_1:431,ST_TIME_LIMIT_RECHARGE_2:421,ST_TIME_LIMIT_ACCUMULATE_RECHARGE_2:432,ST_TARGET_ELITE_BOSS:241})},{}],1267:[function(e,t,i){"use strict";game.ActiveType=b8e.Enum({NEW_SERVER:0,UNION_SERVER:1,FESTIVAL:2,REBATE:3,FOREVER:4,CROSS_SERVER:5,REBATE_CONVERT:6,WORLD_CUP:7,GIFT:9,COMPETE:10,FESTIVAL_2:11})},{}],1268:[function(e,t,i){"use strict";game.ActiveTypeInfo=b8e.Object.extends({type:0,subType:0,endTime:0,activeIds:null,crossGroup:0,result:null,ctor:function(){this._super()},setup:function(e){e&&(this.type=e.type,this.subType=e.subType,this.endTime=e.endTime,this.setShowActiveIds(e.id),this.activeIds.sort(this.sortIds),this.crossGroup=e.crossGroup)},getActiveIds:function(){this.result||(this.result=[]),this.result.length=0;var e=game.mainRole.mainRoleData.getLv();if(this.activeIds)for(var t,i,n=0;n<this.activeIds.length;n++)t=this.activeIds[n],(i=game.ccfg.ActivityCfg.getDataById(t))&&(e<i.minLv||i.maxLv&&e>i.maxLv||this.result.push(t));return this.result},sortIds:function(e,t){return e-t},setShowActiveIds:function(e){if(e&&!(e.length<=0)){this.activeIds||(this.activeIds=[]),this.activeIds.length=0;for(var t=e.length,i=game.mainRole.mainRoleData.miscData.openServerDay,n=0;n<t;n++){var s=e[n],a=game.ccfg.ActivityCfg.getDataById(s);if(!a)return void b8e.warn("活动 ",s,"没有找到配置数据");(!a.openServerShowTime||a.openServerShowTime<=i)&&this.activeIds.push(s)}}}})},{}],1269:[function(e,t,i){"use strict";game.ActivityConditionType=b8e.Enum({TARGET_NONE:0,TARGET_LEVEL:1,TARGET_FIGHT_AMOUNT:2,TARGET_REPUTATION:3,TARGET_ARENA:4,TARGET_EQUIP_STAR:5,TARGET_MOUNT:6,TARGET_WING:7,TARGET_FABAO:8,RANK_LEVEL:21,RANK_FIGHT_AMOUNT:22,RANK_REPUTATION:23,RANK_ARENA:24,RANK_EQUIP_STAR:25,RANK_MOUNT:26,RANK_WING:27,RANK_FABAO:28,TARGET_RECHARGE:40,FESTIVAL_LOGIN:41,FESTIVAL_RECHARGE:42,COST_TARGET_MOUNT:9,COST_TARGET_WING:10,COST_TARGET_FABAO:11,COST_TARGET_EXCHANGE:12,COST_TARGET_RAFFLE:13,COST_TARGET_ZHUANPAN:14,COST_TARGET_REPUTATION:15,COST_TARGET_STAR:16,COST_TARGET_BIANSHEN:17,COST_TARGET_ZHAOCAI:18,COST_TARGET_EASTEREGG:20,COST_RANK_MOUNT:29,COST_RANK_WING:30,COST_RANK_FABAO:31,COST_RANK_EXCHANGE:32,COST_RANK_RAFFLE:33,COST_RANK_ZHUANPAN:34,COST_RANK_REPUTATION:35,COST_RANK_STAR:36,COST_RANK_BIANSHEN:37,COST_RANK_ZHAOCAI:38,LOW_COST_RECHARGE:43,MIDDLE_COST_RECHARGE:44,UP_COST_RECHARGE:45,ZHUANPAN_RECHARGE:46,SINGLE_RECHARGE:50,SINGLE_RECHARGE_2:350,SINGLE_RECHARGE_3:351,ZHUANPAN_EASTEREGG:51,ZHUANPAN_EASTEREGG_GOLD:52,ZHUANPAN_DIAMOND:53,COST_RANK_EASTEREGG:80,COST_TARGET_DIAMOND:19,COST_TARGET_DIAMOND_DAILY:90,COST_TARGET_MOUNT_NEW:120,COST_TARGET_WING_NEW:121,COST_TARGET_FABAO_NEW:122,COST_TARGET_STAR_NEW:123,NEW_RECHARGE:124,COST_TARGET_ZHAOCAI_NEW:125,COST_TARGET_RAFFLE_NEW:126,COST_TARGET_XIANZHEN_NEW:127,COST_TARGET_REPUTATION_NEW:128,COST_TARGET_BIANSHEN_NEW:129,COST_TARGET_ZHUANPAN_NEW:130,COST_TARGET_TOWER_NEW:131,COST_TARGET_HIGH_EQUIP_NEW:132,COST_TARGET_XUNBAO_NEW:133,COST_TARGET_ZHUANPAN_BIANSHEN:91,COST_RANK_ZHUANPAN_BIANSHEN:101,COST_TARGET_CROSS_ZHUANPAN:150,COST_TARGET_CROSS_STAR:151,COST_TARGET_CROSS_FABAO:152,COST_TARGET_CROSS_REPUTATION:153,COST_TARGET_CROSS_MOUNT:154,COST_TARGET_CROSS_WING:155,COST_TARGET_CROSS_BIANSHEN:156,COST_TARGET_CROSS_PURCHASE:157,COST_TARGET_CROSS_PURCHASE_GLOBAL:158,COST_TARGET_CROSS_XIANZHEN:159,COST_RANK_CROSS_ZHUANPAN:180,COST_RANK_CROSS_STAR:181,COST_RANK_CROSS_FABAO:182,COST_RANK_CROSS_REPUTATION:183,COST_RANK_CROSS_MOUNT:184,COST_RANK_CROSS_WING:185,COST_RANK_CROSS_BIANSHEN:186,COST_RANK_CROSS_PURCHASE:187,COST_RANK_CROSS_XIANZHEN:188,MYSTERY:380,TARGET_XIANZHEN:240,COST_TARGET_XIANZHEN:260,RANK_XIANZHEN:280,COST_RANK_XIANZHEN:300,COST_RANK_HIGH_EQUIP:400,COST_TARGET_HIGH_EQUIP:401,TIME_LIMIT_RECHARGE_1:420,TIME_LIMIT_ACCUMULATE_RECHARGE_1:430,TIME_LIMIT_ACCUMULATE_DAYS_1:431,TIME_LIMIT_RECHARGE_2:421,TIME_LIMIT_ACCUMULATE_RECHARGE_2:432,TIME_LIMIT_ACCUMULATE_DAYS_2:433,TARGET_ELITE_BOSS:241})},{}],1270:[function(e,t,i){"use strict";e("./ActiveRankInfo"),e("./ActiveSubType"),e("./ActiveType"),e("./ActiveTypeInfo"),e("./ActivityConditionType"),e("./ActiveConditionsInfo")},{"./ActiveConditionsInfo":1264,"./ActiveRankInfo":1265,"./ActiveSubType":1266,"./ActiveType":1267,"./ActiveTypeInfo":1268,"./ActivityConditionType":1269}],1271:[function(e,t,i){"use strict";game.AmountData=b8e.Object.extends({type:0,value:0,ctor:function(){this._super()},setData:function(e){e&&(this.type=e.type,this.value=e.num)}})},{}],1272:[function(e,t,i){"use strict";game.AmountInfo=b8e.Object.extends({amountMap:null,ctor:function(){this.amountMap=b8e.HashMap.get(),this.clear()},setData:function(e){if(e&&e.list&&!(e.list.length<=0))for(var t,i=0;i<e.list.length;i++){var n=e.list[i];n&&(this.amountMap&&this.hasSomeType(n.type)?(t=this.amountMap.get(n.type))&&this.addSomeType(t.type,n.num):((t=new game.AmountData).setData(n),t&&this.setSomeType(t.type,t)))}},reduceAmount:function(e){if(e&&e.list&&!(e.list.length<=0))for(var t,i=0;i<e.list.length;i++){var n=e.list[i];n&&this.amountMap&&this.hasSomeType(n.type)&&(t=this.amountMap.get(n.type))&&(t.type=n.type,t.value-n.num<=0?t.value=0:t.value=t.value-n.num)}},getValue:function(e){return this.hasSomeType(e)?this.amountMap.get(e).value:0},hasSomeType:function(e){return!!this.amountMap.get(e)},addSomeType:function(e,t){if(this.amountMap.get(e)){var i=this.amountMap.get(e).value+t;this.setAmount(e,i)}else{var n=new game.AmountData;n.type=e,n.value=t,this.amountMap.set(e,n)}},setSomeType:function(e,t){this.amountMap.set(e,t)},setAmount:function(e,t){var i;this.amountMap.get(e)?((i=this.amountMap.get(e)).type=e,i.value=t):((i=new game.AmountData).type=e,i.value=t);this.amountMap.set(e,i)},getAllTyps:function(){return this.amountMap.keys()},getAllDatas:function(){return this.amountMap.values()},getFirstAmountType:function(){var e=this.getAllDatas();if(e&&0<e.length){var t=e[0];return t?t.type:0}return 0},getFirstAmountValue:function(){return this.amountMap.get(this.getFirstAmountType()).value},resetData:function(){this.amountMap.forEach(function(e,t){t.value=0},this)},clear:function(){this.amountMap&&this.amountMap.clear()}})},{}],1273:[function(e,t,i){"use strict";e("./AmountData"),e("./AmountInfo"),e("./enum/enumIndex_1")},{"./AmountData":1271,"./AmountInfo":1272,"./enum/enumIndex_1":1275}],1274:[function(e,t,i){"use strict";game.AmountType=b8e.Enum({SILVER:1,YUAN_BAO:2,POPULARITY:3,CONTRIBUTION:5,HONOUR:7})},{}],1275:[function(e,t,i){"use strict";e("./AmountType")},{"./AmountType":1274}],1276:[function(e,t,i){"use strict";game.ArenaBianshen=b8e.Object.extends({id:0,lv:0,jie:0,ctor:function(){this._super()},setup:function(e){this.id=e.id,this.lv=e.lv,this.jie=e.jie}})},{}],1277:[function(e,t,i){"use strict";game.ArenaFinishInfo=b8e.Object.extends({state:0,prizeInfo:null,rank:null,stats:null,type:0,history_rank:0,diamond:0,ctor:function(){this._super()},setup:function(e){this.state=e.State,this.prizeInfo||(this.prizeInfo=new game.PrizeInfo),this.prizeInfo.setup(e.userItem),this.rank=e.rank,this.stats||(this.stats=new game.ArenaLogStat),this.stats.setup(e.stats),this.type=e.type,this.history_rank=e.historyRank,this.diamond=e.diamond}})},{}],1278:[function(e,t,i){"use strict";game.ArenaInfo=b8e.Object.extends({GET_INFO_SPACE:12e4,nextGetInfoTime:0,rank:0,times:0,buyTimes:0,list:null,ctor:function(){this._super()},setup:function(e){if(e&&(this.nextGetInfoTime=0,this.rank=e.rank,this.times=e.num,this.buyTimes=e.buy,this.list=[],e.list))for(var t,i=0;i<e.list.length;i++)(t=new game.ArenaSlot).setup(e.list[i]),this.list.push(t)}})},{}],1279:[function(e,t,i){"use strict";game.ArenaLogInfo=b8e.Object.extends({type:0,name:null,rank:null,ArenaStats:null,time:null,maxDamage:0,logType:0,ctor:function(){this._super()},setup:function(e){this.type=e.type,this.name=e.name,this.rank=e.rank,this.ArenaStats=new game.ArenaLogStat,this.ArenaStats.setup(e.stats),this.time=e.time,this.logType=game.ArenaLogInfo.Type.ARENA},setupCs:function(e){this.type=e.type,this.name=e.name,this.rank=e.level,this.ArenaStats=new game.ArenaLogStat,this.ArenaStats.setup(e.stats),this.time=e.time,this.logType=game.ArenaLogInfo.Type.CS_ARENA}}),game.ArenaLogInfo.Type={ARENA:0,CS_ARENA:1}},{}],1280:[function(e,t,i){"use strict";game.ArenaLogStat=b8e.Object.extends({State:0,Attacker:null,Target:null,LogStats:null,ctor:function(){this._super(),this.LogStats=[]},setup:function(e){if(e){var t;this.State=e.State,this.Attacker||(this.Attacker=new game.ArenaPlayerInfo),this.Attacker.setup(e.player1),this.Target||(this.Target=new game.ArenaPlayerInfo),this.Target.setup(e.player2),this.LogStats=[];for(var i=0;i<e.logs.length;++i)(t=new game.ArenaLogStatItem).setup(e.logs[i]),this.LogStats.push(t)}}})},{}],1281:[function(e,t,i){"use strict";game.ArenaLogStatItem=b8e.Object.extends({id:0,damage:0,isAttacker:!1,lv:0,jie:0,ctor:function(){this._super()},setup:function(e){this.id=e.id,this.damage=e.damage,this.isAttacker=e.attacker,this.lv=e.lv,this.jie=e.jie}})},{}],1282:[function(e,t,i){"use strict";game.ArenaLogType=b8e.Enum({None:0,Victory:1,Defeat:2,DefSucceed:3,DefFailed:4})},{}],1283:[function(e,t,i){"use strict";game.ArenaLogs=b8e.Object.extends({MAX_LEN:20,list:null,isInit:!1,ctor:function(){this._super(),this.list=[]},setup:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e&&e.logs){var i;this.list=[];for(var n=0;n<e.logs.length&&n<this.MAX_LEN;n++)i=new game.ArenaLogInfo,t?i.setupCs(e.logs[n]):i.setup(e.logs[n]),this.list.push(i);this.isInit=!0}}})},{}],1284:[function(e,t,i){"use strict";game.ArenaPlayerInfo=b8e.Object.extends({id:0,name:null,lv:0,head:0,power:0,shapes:null,bianshenCount:0,idList:null,bianshenMap:null,arenaLv:0,prower:0,ctor:function(){this._super(),this.shapes=b8e.HashMap.get(),this.idList=[],this.bianshenMap=b8e.HashMap.get()},setup:function(e){if(e){this.id=e.id,this.name=e.name,this.lv=e.level,this.head=e.head,this.bianshenCount=e.bianshen.length,this.shapes.clear(),this.idList=[],this.bianshenMap.clear(),this.power=e.power,this.arenaLv=e.arenaLv;for(var t=0;t<e.bianshen.length;t++){var i=e.bianshen[t].id;this.shapes.set(i,game.ArenaShapeState.NONE),this.idList.push(i);var n=new game.ArenaBianshen;n.setup(e.bianshen[t]),this.bianshenMap.set(i,n)}}},changeShapeState:function(e){e&&this.shapes.set(e.bianshenId,e.state)},getIdList:function(){return this.idList},getStateById:function(e){return this.shapes.get(e)},getBianshenById:function(e){return this.bianshenMap.get(e)}})},{}],1285:[function(e,t,i){"use strict";game.ArenaRank=b8e.Object.extends({GET_INFO_SPACE:12e4,nextGetInfoTime:0,list:null,isInit:!1,ctor:function(){this._super(),this.list=[]},setup:function(e){if(e){e.list||returnl,this.nextGetInfoTime=0,this.list=[];for(var t=0;t<e.list.length;++t){var i=new game.ArenaRankItem;i.setup(e.list[t]),this.list.push(i)}this.isInit=!0}}})},{}],1286:[function(e,t,i){"use strict";game.ArenaRankItem=b8e.Object.extends({rank:0,name:null,level:0,power:0,ctor:function(){this._super()},setup:function(e){this.rank=e.rank,this.name=e.name,this.level=e.level,this.power=e.power}})},{}],1287:[function(e,t,i){"use strict";game.ArenaRankPrizeInfo=b8e.Object.extends({_rank:0,_dropId:0,id:0,ctor:function(){this._super()}})},{}],1288:[function(e,t,i){"use strict";game.ArenaShapeState=b8e.Enum({NONE:0,USING:1,DIE:2})},{}],1289:[function(e,t,i){"use strict";game.ArenaSlot=b8e.Object.extends({rank:0,roleId:0,name:null,level:0,power:0,head:0,ctor:function(){this._super()},setup:function(e){this.rank=e.rank,this.roleId=e.roleId,this.name=e.name,this.level=e.level,this.power=e.power,this.head=e.head}})},{}],1290:[function(e,t,i){"use strict";e("./ArenaFinishInfo"),e("./ArenaLogInfo"),e("./ArenaInfo"),e("./ArenaLogInfo"),e("./ArenaLogs"),e("./ArenaLogStat"),e("./ArenaLogStatItem"),e("./ArenaLogType"),e("./ArenaPlayerInfo"),e("./ArenaRank"),e("./ArenaRankItem"),e("./ArenaRankPrizeInfo"),e("./ArenaShapeState"),e("./ArenaSlot")},{"./ArenaFinishInfo":1277,"./ArenaInfo":1278,"./ArenaLogInfo":1279,"./ArenaLogStat":1280,"./ArenaLogStatItem":1281,"./ArenaLogType":1282,"./ArenaLogs":1283,"./ArenaPlayerInfo":1284,"./ArenaRank":1285,"./ArenaRankItem":1286,"./ArenaRankPrizeInfo":1287,"./ArenaShapeState":1288,"./ArenaSlot":1289}],1291:[function(e,t,i){"use strict";game.BeautyFavorInfo=b8e.Object.extends({id:"",level:0,roleLv:0,upgradeInfo:null,attrId:null,fightAmount:0,basePrize:0,randomPrize:0,ctor:function(){this.upgradeInfo=new game.UpgradeInfo,this._super()},setData:function(e){this.upgradeInfo.setUpgradeInfo(e)}})},{}],1292:[function(e,t,i){"use strict";game.BeautyInfo=b8e.Object.extends({id:0,name:"",quality:0,icon:0,res:0,level:0,reputation:0,useTimes:0,costPower:0,unlockTalk:null,upgradeTalk:null,useTalk:null,nameRes:0,unlockNameRes:0,followEffectType:0,followEffectValue:0,followEffectIcon:0,followEffectDesc:"",sceneScale:0,sceneRes:0,ctor:function(){this._super(),this.unlockTalk=[],this.upgradeTalk=[],this.useTalk=[]}})},{}],1293:[function(e,t,i){"use strict";game.BeautyTalkType=b8e.Enum({UNLOCKTALK:0,UPGRADETALK:1,USETALK:2})},{}],1294:[function(e,t,i){"use strict";game.BeautyUnit=b8e.Object.extends({id:0,favorLevel:1,usedTimes:0,ctor:function(){this._super()},setup:function(e){this.id=e.id,this.favorLevel=e.favorLevel,this.usedTimes=e.usedTimes}})},{}],1295:[function(e,t,i){"use strict";e("./BeautyInfo"),e("./BeautyFavorInfo"),e("./BeautyUnit")},{"./BeautyFavorInfo":1291,"./BeautyInfo":1292,"./BeautyUnit":1294}],1296:[function(e,t,i){"use strict";game.BianshenAutoSelectType=b8e.Enum({ITEM:0,TWOSTAR:1,THREESTAR:2,FOURSTAR:3})},{}],1297:[function(e,t,i){"use strict";game.BianshenBattleSlotInfo=b8e.Object.extends({index:0,unlockLv:0,isUnlocked:!1,bianshenId:0,cdFinishTs:0,shapeRestoreTs:0,isIn:!1,dataId:0,misoperationTime:0,ctor:function(){},setup:function(e){this.index=e.index,this.unlockLv=e.unlockLv,this.isUnlocked=e.isUnlocked,this.bianshenId=e.bianshenId,this.cdFinishTs=e.cdFinishTs,this.shapeRestoreTs=e.shapeRestoreTs}})},{}],1298:[function(e,t,i){"use strict";game.BianshenInfo=game.BaseInfo.extends({wuxing:null,star:0,battle:!1,isProtected:!1,jie:0,exp:0,uiposter:-1,shapeChangeCd:-1,shapeLastDuration:-1,attr:-1,attrBonusCoef:-1,conToExp:-1,dt:-1,qz:-1,kz:-1,fz:-1,sc:-1,restraintRate:0,cdTime:0,obtainable:!1,active:!1,needShow:!1,resolveAward:null,sortId:0,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t)},setup:function(e){e&&(this.id=e.id,0==e.lv?this.level=1:this.level=e.lv?e.lv:1,this.name=e.name,this.type=e.type,this.iconName=e.icon,this.quality=e.color,this.qualityEffect=e.qualityEffect,this.wuxing=e.genre,this.star=e.star,this.uiposter=e.uiposter,this.shapeChangeCd=e.shapeChangeCd,this.shapeLastDuration=e.shapeLastDuration,this.attr=e.attr,this.attrBonusCoef=e.attrBonusCoef,this.conToExp=e.conToExp,this.dt=e.dt,this.qz=e.qz,this.kz=e.kz,this.fz=e.fz,this.sc=e.sc,this.restraintRate=e.restraintRate,this.goto=e.goto,this.needShow=e.needShow,this.resolveAward=e.resolveAward,this.obtainable=e.obtainable,this.sortId=e.sort)}})},{}],1299:[function(e,t,i){"use strict";game.BianshenWuxingType=b8e.Enum({NONE:0,JIN:1,MU:2,SHUI:3,HUO:4,TU:5})},{}],1300:[function(e,t,i){"use strict";e("./BianshenAutoSelectType"),e("./BianshenBattleSlotInfo"),e("./BianshenInfo"),e("./BianshenWuxingType")},{"./BianshenAutoSelectType":1296,"./BianshenBattleSlotInfo":1297,"./BianshenInfo":1298,"./BianshenWuxingType":1299}],1301:[function(e,t,i){"use strict";game.BuffItem=b8e.Object.extends({id:0,protoId:0,state:0,res:0,resNode:"buff",_isDisposed:!1,_isRecycled:!1,localBuffId:0,ctor:function(){this._super(),this.localBuffId=game.BuffItem.getLocalBuffId(),game.BuffItem.count++},setup:function(e){this.id=e.id,this.protoId=e.protoId,this.res=e.res,this.state=e.state,this.resNode=e.resNode?e.resNode:"buff"},showEffect:function(){return this.res},getEffectUrl:function(){return game.ClientCfg.getSkillFx(this.res)},clear:function(){this.id=0,this.protoId=0,this.state=0,this.res=0,this.resNode="buff",this.localBuffId=0},getType:function(){return this.state},restore:function(){this._isRecycled=!1,this.clear(),this.localBuffId=game.BuffItem.getLocalBuffId(),game.BuffItem.count++},recycle:function(){this._isRecycled=!0,game.BuffItem.resetLocalBuffId(this.localBuffId),this.clear(),game.BuffItem.count--},release:function(){game.BuffItem.put(this)},dispose:function(){this._isDisposed=!0,this._isRecycled=!1},destroy:function(){this.dispose()}}),game.BuffItem.count=0,game.BuffItem.pool=new b8e.Pool(game.BuffItem,1024),game.BuffItem.get=function(){return game.BuffItem.pool.get()},game.BuffItem.put=function(e){return e=game.BuffItem.pool.put(e)},game.BuffItem.localBuffId=1,game.BuffItem.localBuffIdPool=[],game.BuffItem.getLocalBuffId=function(){return 0<game.BuffItem.localBuffIdPool.length?game.BuffItem.localBuffIdPool.shift():++game.BuffItem.localBuffId},game.BuffItem.resetLocalBuffId=function(e){game.BuffItem.localBuffIdPool.push(e)}},{}],1302:[function(e,t,i){"use strict";game.BuffSet=b8e.Object.extends({_buffMap:null,_isDisposed:!1,_isRecycled:!1,ctor:function(){this._super(),this._buffMap=b8e.HashMap.get(),game.BuffSet.count++},setup:function(e){this.addBuffs(e)},addBuffs:function(e){if(e&&0!=e.length)for(var t,i=0;i<e.length;i++)(t=this._buffMap.get(e[i].id))?b8e.log("BUFF ID 重复"):t=game.BuffItem.get(),t.setup(e[i]),this._buffMap.set(t.id,t)},addBuff:function(e){this._buffMap.set(e.id,e)},removeBuff:function(e){var t=this._buffMap.get(e);return t?(this._buffMap.del(e),t.release(),t):null},getBuffById:function(e){return this._buffMap.get(e)},getBuffs:function(){return this._buffMap.values()},clear:function(){this._buffMap.forEach(this._clearBuffMap,this),this._buffMap.clear()},_clearBuffMap:function(e,t){t.release()},_disposeBuffMap:function(e,t){t.destroy()},restore:function(){this._isRecycled=!1,this.clear(),game.BuffSet.count++},recycle:function(){this._isRecycled=!0,this.clear(),game.BuffSet.count--},release:function(){game.BuffSet.put(this)},dispose:function(){this._buffMap&&(this._buffMap.forEach(this._disposeBuffMap,this),this._buffMap.destroy(),this._buffMap=null),this._isDisposed=!0,this._isRecycled=!1},destroy:function(){this.dispose()}}),game.BuffSet.count=0,game.BuffSet.pool=new b8e.Pool(game.BuffSet,1024),game.BuffSet.get=function(){return game.BuffSet.pool.get()},game.BuffSet.put=function(e){return e=game.BuffSet.pool.put(e)}},{}],1303:[function(e,t,i){"use strict";game.BuffType=b8e.Enum({None:0,Vertigo:1,Silent:2})},{}],1304:[function(e,t,i){"use strict";e("./BuffItem"),e("./BuffSet"),e("./BuffType")},{"./BuffItem":1301,"./BuffSet":1302,"./BuffType":1303}],1305:[function(e,t,i){"use strict";game.ChatItemInfo=b8e.Object.extends({type:0,content:null,roleId:0,roleName:null,head:0,guildName:null,guildOfficePos:0,funcType:0,zone:0,insId:0,teamId:0,setup:function(e){this.type=e.type,this.content=e.content,this.content=b8e.SensitiveWords.filter(this.content,"*"),this.roleId=e.roleId,this.roleName=e.roleName,this.head=e.head,this.guildName=e.guildName,this.guildOfficePos=e.guildOfficePos,this.funcType=e.funcType,this.zone=e.zone,e.teamBossChat&&(this.insId=e.teamBossChat.insId,this.teamId=e.teamBossChat.teamId)}})},{}],1306:[function(e,t,i){"use strict";game.ChatPanelInfo=b8e.Object.extends({MAX_CHAT_COUNT:20,type:0,isInit:!1,chats:null,logCount:0,ctor:function(e){this._super(),this.type=e,this.chats=[]},setup:function(e){if(e){for(var t,i=0;i<e.length;i++)(t=e[i])&&this.addChat(t);this.isInit=!0}else b8e.warn("聊天类型",this.type,"没有返回任何数据")},addChat:function(e,t){var i;return this.chats.length>=this.MAX_CHAT_COUNT&&this.chats.shift(),i||(i=new game.ChatItemInfo),i.setup(e),this.chats.push(i),t&&this.logCount++,i},addSysTem:function(e,t){var i;return this.chats.length>=this.MAX_CHAT_COUNT&&this.chats.shift(),i=new game.ChatItemInfo,t&&this.logCount++,i.type=game.ChatType.SYSTEM_CHAT,i.content=e,this.chats.push(i),i}})},{}],1307:[function(e,t,i){"use strict";game.ChatType=b8e.Enum({WORLD_CHAT:0,GUILD_CHAT:1,CHAT_PRIVATE:2,CS_CHAT:3,SYSTEM_CHAT:99})},{}],1308:[function(e,t,i){"use strict";game.RelationChatInfo=b8e.Object.extends({MAX_CHAT_COUNT:30,roleId:0,roleName:null,head:0,offlineMsgCount:0,lastMsgTime:0,chats:null,isInit:!1,ctor:function(){this._super(),this.type=game.ChatType.CHAT_PRIVATE,this.chats=[]},setup:function(e){if(e){var t,i;this.roleId=e.roleId,this.roleName=e.roleName,this.head=e.head,this.offlineMsgCount=e.offlineMsgCount,this.lastMsgTime=e.lastMsgTime;for(var n=e.chatContent,s=0;s<n.length;s++)(t=n[s])&&((i=new game.ChatItemInfo).setup(t),this.chats.push(i));this.isInit=!0}else b8e.warn("聊天类型",this.type,"没有返回任何数据")},addChat:function(e){var t;return this.chats.length>=this.MAX_CHAT_COUNT&&this.chats.shift(),t||(t=new game.ChatItemInfo),t.setup(e),this.chats.push(t),t},pushChat:function(e){e&&(this.chats.length>=this.MAX_CHAT_COUNT&&this.chats.shift(),this.chats.push(e))},getLastContent:function(){if(0<this.chats.length){var e=this.chats[this.chats.length-1];if(e)return e.content}return""}})},{}],1309:[function(e,t,i){"use strict";e("./ChatItemInfo"),e("./ChatPanelInfo"),e("./ChatType"),e("./RelationChatInfo")},{"./ChatItemInfo":1305,"./ChatPanelInfo":1306,"./ChatType":1307,"./RelationChatInfo":1308}],1310:[function(e,t,i){"use strict";game.ClientSettingEnum=b8e.Enum({None:0,Low:1,Middle:2,High:3})},{}],1311:[function(e,t,i){"use strict";game.ClientSettingType=b8e.Enum({BGM_MUSIC:1,MUSIC:2,WING:3,FABAO:4,SPELL:5,HERO:6,QUALITY:7,AUTO_SHAPE:8,SHAPE_ALERT:9,AllSOUND:10,HIDE_VIP:11,XIANZHEN:12})},{}],1312:[function(e,t,i){"use strict";e("./ClientSettingEnum"),e("./ClientSettingType")},{"./ClientSettingEnum":1310,"./ClientSettingType":1311}],1313:[function(e,t,i){"use strict";game.AnimConst=b8e.Enum({LvUp:"10002",Relive:"10002"})},{}],1314:[function(e,t,i){"use strict";e("./AnimConst")},{"./AnimConst":1313}],1315:[function(e,t,i){"use strict";game.CornucopiaLogInfo=b8e.Object.extends({type:game.CornucopiaLogType.LOOT,roleId:0,roleName:"",count:0,time:0,ctor:function(){this._super()},setData:function(e){this.type=e.type,this.roleId=e.roleId,this.roleName=e.roleName,this.count=e.count,this.time=e.time}})},{}],1316:[function(e,t,i){"use strict";game.CornucopiaLogType=b8e.Enum({LOOT:0,LOOTED:1})},{}],1317:[function(e,t,i){"use strict";e("./CornucopiaLogType"),e("./CornucopiaLogInfo")},{"./CornucopiaLogInfo":1315,"./CornucopiaLogType":1316}],1318:[function(e,t,i){"use strict";game.CostInfo=b8e.Object.extends({id:0,num:0,upgradeInfo:null,ctor:function(){this._super(),this.upgradeInfo=new game.UpgradeInfo},setData:function(e){this.upgradeInfo.setUpgradeInfo(e)}})},{}],1319:[function(e,t,i){"use strict";e("./CostInfo")},{"./CostInfo":1318}],1320:[function(e,t,i){"use strict";game.DrawDeckInfo=b8e.Object.extends({protoId:0,id:0,expireTs:"",leftFreeTimes:0,leftDiscountTimes:0,hasBatch:0,freeTimesResetTs:0,totalLeftTimes:0,leftTimesForSureDrop:0,ctor:function(){this._super()},setup:function(e){e&&(this.protoId=e.protoId,this.id=e.id,this.expireTs=e.expireTs,this.leftFreeTimes=e.leftFreeTimes,this.leftDiscountTimes=e.leftDiscountTimes,this.hasBatch=e.hasBatch,this.freeTimesResetTs=e.freeTimesResetTs,this.totalLeftTimes=e.totalLeftTimes,this.leftTimesForSureDrop=e.leftTimesForSureDrop)}})},{}],1321:[function(e,t,i){"use strict";game.DrawInfo=b8e.Object.extends({type:0,data:null,ctor:function(){this._super()}})},{}],1322:[function(e,t,i){"use strict";e("./DrawDeckInfo"),e("./DrawInfo")},{"./DrawDeckInfo":1320,"./DrawInfo":1321}],1323:[function(e,t,i){"use strict";game.DujieData=b8e.Object.extends({type:0,num:0,ctor:function(){this._super()},setup:function(e){this.type=e.type,this.num=e.num}})},{}],1324:[function(e,t,i){"use strict";game.DujieInfo=b8e.Object.extends({lv:0,state:0,list:null,typeItem:null,ctor:function(){this._super(),this.list=[]},setup:function(e){this.lv=e.lv,this.state=e.state,this.list=[];for(var t=0;t<e.list.length;++t){var i=new game.DujieData;i.setup(e.list[t]),this.list.push(i)}},getListByType:function(e){for(var t=0;t<this.list.length;++t)if(e==this.list[t].type)return this.list[t];return this.typeItem||(this.typeItem=new game.DujieData),this.typeItem.type=e,this.typeItem.num=0,this.typeItem}})},{}],1325:[function(e,t,i){"use strict";game.DujieState=b8e.Enum({FINISHED:1,UNFINISHED:0})},{}],1326:[function(e,t,i){"use strict";game.DungeonResultInfo=b8e.Object.extends({result:!1,reward:null})},{}],1327:[function(e,t,i){"use strict";e("./DungeonResultInfo")},{"./DungeonResultInfo":1326}],1328:[function(e,t,i){"use strict";game.EquipAppendInfo=b8e.Object.extends({confId:0,appendSpriteStat:null,ctor:function(){this._super()},setup:function(e,t,i){this.appendSpriteStat||(this.appendSpriteStat=game.SpriteStat.get()),this.confId=e;var n=new game.StatData;n.setData(t,i),this.appendSpriteStat.setStatData(n)}})},{}],1329:[function(e,t,i){"use strict";game.EquipInfo=game.ItemInfo.extends({_confId:0,_appendSpriteStat:null,_highEquipAttrId:0,_highSpriteStat:null,appendMap:null,confIdMap:null,_appendMax:0,_basePower:0,_appendPower:0,_power:0,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t),this.appendMap=b8e.HashMap.get(),this.confIdMap=b8e.HashMap.get(),this.appendSpriteStat=game.SpriteStat.get()},setEquipAppendInfo:function(e){if(this.appendMap&&this.appendMap.clear(),this.confIdMap&&this.confIdMap.clear(),!e||e.length<=0)this.appendSpriteStat=null;else{this.appendSpriteStat.clearSpriteSatats();for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.StatData;n.setData(i.attrId,i.value),this.appendSpriteStat.setStatData(n),this.appendMap.set(i.confId,n);var s=b8e.CommonUtil.xyToInt(n.type,n.value);this.confIdMap.set(s,i.confId)}}}},getAppendStatDataByConfig:function(e){return this.appendMap.get(e)},getConfId:function(e){var t=b8e.CommonUtil.xyToInt(e.type,e.value);return this.confIdMap.get(t)},confId:{set:function(e){this._confId=e},get:function(){return this._confId}},appendSpriteStat:{set:function(e){this._appendSpriteStat=e},get:function(){return this._appendSpriteStat}},appendSpriteStatLine:{get:function(){return this.appendMap&&0<this.appendMap.count()?this.appendMap.count():0}},isHasAppendInfo:{get:function(){return!!(this.appendMap&&0<this.appendMap.count())}},basePower:{set:function(e){this._basePower=e},get:function(){return this._basePower}},appendPower:{set:function(e){this._appendPower=e},get:function(){return this._appendPower}},power:{get:function(){return this._basePower+this._appendPower}},appendMax:{set:function(e){this._appendMax=e},get:function(){return this._appendMax}},highEquipAttrId:{set:function(e){this._highEquipAttrId=e},get:function(){return this._highEquipAttrId}},highSpriteStat:{set:function(e){this._highSpriteStat=e},get:function(){return this._highSpriteStat}}})},{}],1330:[function(e,t,i){"use strict";game.EquipSlotInfo=game.BaseInfo.extends({_slotIndex:-1,_slotType:-1,_slotLevel:0,_slotStar:-1,_attrId:-1,_intensifySpriteStat:null,_equip:null,rate:0,_intensifyPower:0,_upStarPower:0,_power:0,_totalPower:0,_enchant:0,_enchantSpriteStat:null,_enchantPower:0,_isenchant:!1,ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";this._super(t,e),this.slotType=e},intensifyPower:{set:function(e){this._intensifyPower=e},get:function(){return this._intensifyPower}},upStarPower:{set:function(e){this._upStarPower=e},get:function(){return this._upStarPower}},power:{get:function(){return this._intensifyPower+this._upStarPower+this._enchantPower}},totalPower:{get:function(){return this.equip?this._intensifyPower+this._upStarPower+this._enchantPower+this.equip.appendPower:this.power}},enchantPower:{set:function(e){this._enchantPower=e},get:function(){return this._enchantPower}},enchantSpriteStat:{set:function(e){this._enchantSpriteStat=e},get:function(){return this._enchantSpriteStat}},isenchant:{set:function(e){this._isenchant=e},get:function(){return 0<this._enchant}},enchant:{set:function(e){this._enchant=e},get:function(){return this._enchant}},slotIndex:{set:function(e){this._slotIndex=e},get:function(){return this._slotIndex}},slotType:{set:function(e){this._slotType=e},get:function(){return this._slotType}},slotLevel:{set:function(e){this._slotLevel=e},get:function(){return this._slotLevel}},slotStar:{set:function(e){this._slotStar=e},get:function(){return this._slotStar}},attrId:{set:function(e){this._attrId=e},get:function(){return this._attrId}},intensifySpriteStat:{set:function(e){this._intensifySpriteStat=e},get:function(){return this._intensifySpriteStat}},equip:{set:function(e){this._equip=e},get:function(){return this._equip}}})},{}],1331:[function(e,t,i){"use strict";game.EquipSlotIntensifyInfo=b8e.Object.extends({id:"",level:0,roleLv:0,upgradeInfo:null,attrId:null,ctor:function(){this._super(),this.upgradeInfo=new game.UpgradeInfo},setData:function(e){this.upgradeInfo.setUpgradeInfo(e)}})},{}],1332:[function(e,t,i){"use strict";game.EquipSlotStarInfo=b8e.Object.extends({slotStar:"",level:0,roleLv:0,upgradeInfo:null,attrRate:0,rate:0,failAddRate:0,ctor:function(){this._super(),this.upgradeInfo=new game.UpgradeInfo},setUpgradeInfo:function(e){this.upgradeInfo.setUpgradeInfo(e)}})},{}],1333:[function(e,t,i){"use strict";game.EquipSuitsInfo=game.BaseInfo.extends({id:-1,level:0,quality:-1,star:-1,attrId:-1,suitsSpriteStat:null,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t)}})},{}],1334:[function(e,t,i){"use strict";e("./EquipSlotInfo"),e("./EquipSlotIntensifyInfo"),e("./EquipSlotStarInfo"),e("./EquipSuitsInfo"),e("./EquipAppendInfo"),e("./EquipInfo")},{"./EquipAppendInfo":1328,"./EquipInfo":1329,"./EquipSlotInfo":1330,"./EquipSlotIntensifyInfo":1331,"./EquipSlotStarInfo":1332,"./EquipSuitsInfo":1333}],1335:[function(e,t,i){"use strict";game.EscortData=b8e.Object.extends({id:0,fairyId:2,startTime:3,robs:4,roleId:5,roleLv:6,roleName:7,rolePower:8,guildName:9,zone:10,friendId:11,friendName:12,friendPower:13,ctor:function(){this._super()},setupData:function(e){this.id=e.id,this.fairyId=e.fairyId,this.startTime=e.startTime,this.robs=e.robs,this.roleId=e.roleId,this.roleLv=e.roleLv,this.roleName=e.roleName,this.rolePower=e.rolePower,this.guildName=e.guildName,this.zone=e.zone,this.friendId=e.friendId,this.friendName=e.friendName,this.friendPower=e.friendPower}})},{}],1336:[function(e,t,i){"use strict";game.EscortInfo=b8e.Object.extends({escortList:null,escorts:0,robs:0,helps:0,invite:0,free:0,myEscort:null,fairyId:0,openTime:0,ctor:function(){this._super()},setup:function(e){e&&(this.escortList=e.list,this.escorts=e.escorts,this.robs=e.robs,this.helps=e.helps,this.invite=e.invite,this.free=e.free,this.myEscort=e.myEscort,this.fairyId=e.fairyId,this.openTime=e.openTime)},refreshList:function(e){this.escortList=e.list},isFriendInList:function(e){for(var t,i=0;i<this.escortList.length;i++)if((t=this.escortList[i])&&t.roleId==e)return!0;return!1}})},{}],1337:[function(e,t,i){"use strict";game.EscortLog=b8e.Object.extends({_logs:null,_pillageLogs:null,ctor:function(){this._super(),this._pillageLogs=b8e.HashMap.get()},setup:function(e){e&&(this._logs=e.logs)},getDatas:function(){return this._logs},getPillagedLogs:function(){var e,t=this._logs;if(!t||t.length<=0)return null;this._pillageLogs.clear();for(var i=0,n=0;n<t.length;n++)2==(e=t[n]).type&&(e.index=i,this._pillageLogs.set(e.index,e),i++);return this._pillageLogs.values()},getCurPillagedLogs:function(e){var t=this.getPillagedLogs();if(!t||t.length<=0)return null;for(var i,n=[],s=0;s<t.length;s++)(i=t[s]).id!=e||i.win||n.push(i);return n}})},{}],1338:[function(e,t,i){"use strict";game.GlobalEnum=b8e.Enum({WORLD_CHAT_LV:1511,WORLD_CHAT_SPEED_TIME:1512,WORLD_CHAT_FREE_TIME:1513,WORLD_CHAT_MAX_LEN:1514,WORLD_CHAT_COST:1515,OFFLINE_AWARD_MAX_TIME:1703,BEAUTY_MAX_POWER:1501,ADD_FIGHT_TIMES:2005,MAX_RELATION_NUM:1901,CREATE_GUILD_COST:4001,CREATE_GUILD_CHAT:4002,BIANSHEN_MAX_COUNT:4101,WORLD_BOSS_RANK:2401,WORLD_BOSS_SERVER:2402,WORLD_BOSS_MAX_INSPIRE_DAMAGE:2403,WORLD_BOSS_ONCE_INSPIRE_DAMAGE:2404,BEAUTY_MAX_BUYTIMES_POWER:1502,ARENA_COUNTDOWN:2001,WORLD_BOSS_MAX_YINBI_INSPIRE_COUNT:2405,WORLD_BOSS_MAX_YUANBAO_INSPIRE_COUNT:2406,MATERIAL_MAX_FIGHT_COUNT:2602,LONEY_DUNGEON_MAX_FIGHT_COUNT:2603,CORNUCOPIA_EQUIP_TIME:2501,CORNUCOPIA_EQUIP_BOOM_TIMES:2502,CORNUCOPIA_MAX_EQUIP_TIMES:2503,CORNUCOPIA_LOOT_TIMES:2505,FIRST_RECHARGE_PRIZE:2601,MAX_BACK_EQUIP_COUNT:2701,WEAK_GUIDE_MAX_LEVEL:2801,TASK_WEAK_GUIDE_TIME:2802,COMPLETE_TASK_WEAK_GUIDE_TIME:2803,SHARE_DAILY_TIMES:2901,SHARE_CD_TIMES:2902,SHARE_PRIZE:2903,MICRO_PRIZE:2904,SHARE_TITLE:2908,SHARE_MESSAGE:2909,TRANSFER_USE_TIME:3101,TRANSFER_SHOT_CD:3102,FUND_VIP_LEVEL:3001,FUND_PRICE:3002,AUTO_TRUSTEESHIP_TIME:3200,ADD_SHORTCUT_PRIZE:3301,FOCUS_PRIZE:3302,REBIRTH_ITEM_ID:3501,REBIRTH_ITEM_EXP:3502,VIP_TRIGGERID:3119,CHANG_AN_SCENE_ID:4400,SURAOPEN_TIME:2208,SURA_EXPPRIZE:2209,SURA_BUFF_TIPS:1000007,JIANGJIN_BEGINITIME:2905,JIANGJIN_ENDITIME:2906,JIANGJIN_EXPPRIZE:2907,IS_HAS_HONGBAO:3701,ADD_CHUMO_SCORE:3901,ADD_ZHANYAO_SCORE:3902,MAX_ZHANYAO_SCORE:3903,MAX_CHUMO_SCORE:3904,QUEST_ZHANYAO_COMPLETE:3905,ALLCLEAR_CHUMO:3906,TIAN_GONG_OPEN_TIME:3702,TIAN_GONG_END_TIME:3703,TIAN_GONG_NEED_SCORE:3704,TIAN_GONG_COLLECT_POSITION:4312,OVERLORD_AWARDS_ID:4301,OVERLORD_GUILD_MEMBER_AWARDS_ID:4302,OTHER_GUILD_MEMBER_AWARDS_ID:4303,TIAN_GONG_NOTICE_ID:4304,TIAN_GONG_COLLECT_TIME:4305,TIAN_GONG_POS:4306,TIAN_GONG_NAN_TIAN_MEN_SCENE_ID:4307,TIAN_GONG_LING_XIAO_DIAN_SCENE_ID:4308,TIAN_GONG_DAILY_OPEN_TIME:4309,UP_COST_MAX_COUNT:4201,COLLECT_MATERIAL:4501,ADD_FRIEND_RANDOM_CHAT:4611,MILLIONAWARD_LV:4604,BIANSHEN_LEIDA:4701,LIMIT_VIP_LV:4801,NORMAL_MAX_VIP_LV:4802,ACTIVE_BOSS_TIPS:4901,VIP_FREE_TALK:5001,LOW_COST_MAX_COUNT:5005,DISCOUNT_DAILY_ID:5101,TEAM_MAXAWARDNUM:5201,TEAM_BUYCARDNUM:5202,TEAM_COUNT_DOWN:5203,DRAW_COST_ITEM_ID:5401,RUNE_SLOT_LIMIT:5501,RUNE_MIN_LIMIT:5502,MAX_RUNE_BACK_COUNT:5503,MONDAY_WELFARE:6101,VIP_ROULLETE_LIMIT:6301,REAL_VERIFY_PRIZE:6401,RETRIEVE_COST_ITEM:6501,RETRIEVE_MONEY_RETIO:6502,RETRIEVE_GLOD_RETIO:6503,GUILD_EXP_CURE_LEVEL:4004,GUILD_EXP_CURE_TIME:4008,GUILD_EXP_CURE_MAX_TIMES:4009,GUILD_EXP_CURE_CD:4003,CS_TIAN_GONG_OPEN_TIME:4352,CS_TIAN_GONG_END_TIME:4353,CS_OVERLORD_GUILD_MEMBER_AWARDS_ID:4350,CS_OTHER_GUILD_MEMBER_AWARDS_ID:4351,CS_OVERLORD_AWARDS_ID:4354,CS_TIAN_GONG_DAILY_OPEN_TIME:4355,CS_TIAN_GONG_NAN_TIAN_MEN_SCENE_ID:4356,CS_TIAN_GONG_LING_XIAO_DIAN_SCENE_ID:4357,MATERIAL_FREE_LEVEL:6505,MATERIAL_FREE_VIP:6506,FUNCTION_SHIELD:1e4,SKILL_SLOT_UNLOCK_LEVEL:1406,ESCORT_ADV_REFRESH_COST:6601,ESCORT_DAILY_COUNT:6602,ESCORT_ROBS_COUNT:6603,ESCORT_HELPS_COUNT:6604,ESCORT_COM_REFRESH_COST:6605,ESCORT_INVITE_COUNT:6606,ESCORT_FREE_REFRESH_COUNT:6607,ESCORT_PILLAGE_COUNT:6611,CROSS_PURCHASELIMITSCORE:6901,ESCORT_BEGIN_TIME:6608,ESCORT_END_TIME:6609,JD_PRIZE:7040,ORNAMENT_ENSOUL_ITEM:7050,ORNAMENT_ENSOUL_ATTR:7051})},{}],1339:[function(e,t,i){"use strict";game.GmCmdShortCut=b8e.Object.extends({desc:"",cmdLine:"",ctor:function(){this._super()}})},{}],1340:[function(e,t,i){"use strict";e("./GmCmdShortCut")},{"./GmCmdShortCut":1339}],1341:[function(e,t,i){"use strict";game.GotoInfo=b8e.Object.extends({id:0,icon:"",title:"",describe:"",conditionParam:-1,openParam:-1,ctor:function(){this._super()}})},{}],1342:[function(e,t,i){"use strict";e("./GotoInfo")},{"./GotoInfo":1341}],1343:[function(e,t,i){"use strict";game.GuildBossInfo=b8e.Object.extends({bossId:0,hp:0,maxhp:0,state:0,startTime:0,endTime:0,ranks:null,memberRanks:null,selfGuildDamage:0,days:0,ctor:function(){this._super(),this.ranks=[],this.memberRanks=[]},setup:function(e){if(e){this.bossId=e.bossId,this.maxhp=e.hp,this.state=e.state,this.startTime=e.startTime,this.endTime=e.endTime;var t=0,i=game.guild.getSelfGuildInfo(),n=i?i.id:0;if(this.selfGuildDamage=0,e.ranks){var s;t=e.ranks.length;for(var a=this.ranks.length=0;a<t;++a)(s=new game.GuildBossRank).setup(e.ranks[a]),this.ranks.push(s),n==s.id&&(this.selfGuildDamage=s.score)}if(e.memberRanks){t=e.memberRanks.length;for(a=this.memberRanks.length=0;a<t;++a)(s=new game.GuildBossMemberRank).setup(e.memberRanks[a]),this.memberRanks.push(s)}switch(this.state){case game.WorldBossStateType.NO_OPEN:this.hp=this.maxhp;break;case game.WorldBossStateType.OVER:this.hp=0;break;case game.WorldBossStateType.OPENING:this.hp=this.maxhp*((this.endTime-game.SysTime.curTime)/(this.endTime-this.startTime));break;default:this.hp=0}this.days=e.days}},getRanks:function(){return this.ranks},getMembers:function(){return this.memberRanks}})},{}],1344:[function(e,t,i){"use strict";game.GuildBossMemberRank=b8e.Object.extends({type:1,rank:0,roleId:0,name:null,level:0,score:0,guildId:0,ctor:function(){this._super()},setup:function(e){e&&(this.rank=e.rank,this.roleId=e.roleId,this.name=e.name,this.level=e.level,this.score=e.score,this.guildId=e.guildId)}})},{}],1345:[function(e,t,i){"use strict";game.GuildBossNotify=b8e.Object.extends({unitId:0,hp:0,ranks:null,myRank:null,myDmg:0,_maxShow:5,ctor:function(){this._super(),this.ranks=[]},setup:function(e){if(e){this.unitId=e.unitId,this.hp=e.hp;var t=0;if(e.ranks){var i;t=e.ranks.length;for(var n=this.ranks.length=0;n<t&&n<this._maxShow;++n)(i=new game.GuildBossRank).setup(e.ranks[n]),this.ranks.push(i)}this.myRank=new game.GuildBossRank,this.myRank.setup(e.myRank),this.myDmg=e.myDmg}},getDamageRank:function(){return this.ranks}})},{}],1346:[function(e,t,i){"use strict";game.GuildBossRank=b8e.Object.extends({type:0,rank:0,id:0,name:null,masterName:null,score:0,zone:0,members:null,ctor:function(){this._super(),this.members=[]},setup:function(e){if(e){this.rank=e.rank,this.id=e.id,this.name=e.name,this.masterName=e.masterName,this.score=e.score,this.zone=e.zone;var t,i;t=e.members.length;for(var n=this.members.length=0;n<t;++n)(i=new game.GuildBossMemberRank).setup(e.members[n]),this.members.push(i)}},getMembers:function(){return this.members}})},{}],1347:[function(e,t,i){"use strict";game.GuildChangeRankInfo=b8e.Object.extends({rank:0,memberId:0,name:"",ctor:function(){this._super()}})},{}],1348:[function(e,t,i){"use strict";game.GuildInfo=b8e.Object.extends({id:0,name:"",level:0,exp:0,master:0,masterName:"",memberList:null,state:-1,powerLimit:0,createTime:0,notice:"",index:0,count:0,ctor:function(){this._super(),this.memberList=[]},setMembers:function(e){if(e&&!(e.length<=0)){for(var t,i=0;i<e.length;i++){var n=e[i];n&&((t=new game.GuildMemberInfo).id=n.id,t.name=n.name,t.head=n.head,t.level=n.level,t.power=n.power,t.rank=n.rank,t.logoutTime=n.logoutTime,this.memberList.push(t))}this.memberList.sort(this.onSort)}},onSort:function(e,t){return e.rank<t.rank?-1:e.rank>t.rank?1:e.power<t.power?1:e.power>t.power?-1:0},members:{get:function(){return this.memberList?this.memberList.length:0}}})},{}],1349:[function(e,t,i){"use strict";game.GuildLogInfo=b8e.Object.extends({type:-1,time:0,name:"",level:0,changeRankInfo:null,ctor:function(){this._super()},setChangeRankInfo:function(e){e&&(this.changeRankInfo||(this.changeRankInfo=new game.GuildChangeRankInfo),this.changeRankInfo.rank=e.rank,this.changeRankInfo.memberId=e.memberId,this.changeRankInfo.name=e.name)}})},{}],1350:[function(e,t,i){"use strict";game.GuildMemberInfo=b8e.Object.extends({id:0,name:"",phead:0,level:0,power:0,rank:-1,logoutTime:-1,reqExpCoreTime:0,ctor:function(){this._super()}})},{}],1351:[function(e,t,i){"use strict";game.GuildModuleInfo=b8e.Object.extends({contribution:0,shaoxiangDone:!1,expCureCount:!1,xinfaMap:null,isInit:!1,nowType:1,xinfaAtk:0,ctor:function(){this.xinfaMap=b8e.HashMap.get()},init:function(){if(!this.isInit){for(var e=game.ccfg.GuildXinfaCfg.getXinFaTypeList(),t=0;t<e.length;++t){var i=new game.GuildXinFa;i.xinfaType=e[t],i.level=0,this.xinfaMap.set(e[t],i)}this.isInit=!0}},setup:function(e){if(e){this.contribution=e.contribution,this.shaoxiangDone=e.shaoxiangDone,this.expCureCount=e.expCureCount,this.init();for(var t=0;t<e.xinfa.length;++t){var i=new game.GuildXinFa;i.setup(e.xinfa[t]),this.xinfaMap.set(e.xinfa[t].xinfaType,i)}this.updataXinFaAtk()}},updataXinFaAtk:function(){this.xinfaAtk=0,this.xinfaMap.forEach(this._update,this)},_update:function(e,t){if(0<t.level){var i=game.ccfg.GuildXinfaCfg.getXinFaDataByType(t.xinfaType,t.level);if(!i)return;var n=i.attr,s=this.getXinFaAtkByAttrId(n);this.xinfaAtk+=s}},getXinFaAtk:function(){return this.xinfaAtk},getXinFaAtkByAttrId:function(e){var t=game.ccfg.SpriteStatCfg.getSpriteStatById(e),i=game.mainRole.mainRoleData.getLv();return game.CCommonUtil.getPower(t,i)},setXinFaInfo:function(e){if(e){var t=new game.GuildXinFa;t.xinfaType=e.xinfaType,t.level=e.xinfaLevel,this.xinfaMap.set(e.xinfaType,t),this.updataXinFaAtk()}},getXinFaByType:function(e){return this.xinfaMap.get(e)},getXinFaList:function(){return this.xinfaMap?this.xinfaMap.values():null},getNowXinfaType:function(){return this.nowType},setNowXinfaType:function(e){0<e&&(this.nowType=e)}})},{}],1352:[function(e,t,i){"use strict";game.GuildQueatInfo=b8e.Object.extends({score:0,awardIds:null,guildQuestList:null,weeklyScore:0,weeklyIds:null,ctor:function(){this._super(),this.awardIds=[],this.guildQuestList=[],this.weeklyIds=[]},setGuildQuestInfo:function(e){if(this.guildQuestList.length=0,e&&!(e.length<=0)){for(var t="",i=0;i<e.length;i++){var n=e[i];if(!n)return;var s=new game.GuildQueatUnit;s.id=n.id,s.num=n.num,s.state=n.state,s.index=n.index,this.guildQuestList.push(s),t+=0==i?"帮会活动任务："+n.id:","+n.id}b8e.log(t)}},setAwardIds:function(e){if(this.awardIds.length=0,e&&!(e.length<=0))for(var t=0;t<e.length;t++){var i=e[t];this.awardIds.push(i)}},setWeeklyAwardIds:function(e){if(this.weeklyIds.length=0,e&&!(e.length<=0))for(var t=0;t<e.length;t++){var i=e[t];this.weeklyIds.push(i)}},setGetWeeklyAwardIds:function(e){this.weeklyIds.push(e)},setGetAwardIds:function(e){game.ccfg.GuildQuestAwardCfg.getQuestAwardById(e)?this.awardIds.push(e):this.setGetWeeklyAwardIds(e)}})},{}],1353:[function(e,t,i){"use strict";game.GuildQueatUnit=b8e.Object.extends({id:0,num:0,state:0,index:-1,ctor:function(){this._super()}})},{}],1354:[function(e,t,i){"use strict";game.GuildQuestAwardInfo=b8e.Object.extends({id:0,award:null,score:0,itemInfo:null,awardType:1,normalBg:null,receivedBg:null,ctor:function(){this._super()}})},{}],1355:[function(e,t,i){"use strict";game.GuildShaoxiang=b8e.Object.extends({guildLevel:0,guildExp:0,id:0,ctor:function(){this._super()},setup:function(e){this.guildLevel=e.guildLevel,this.guildExp=e.guildExp,this.id=e.id}})},{}],1356:[function(e,t,i){"use strict";game.GuildShaoxiangLogItem=b8e.Object.extends({time:0,name:0,id:0,ctor:function(){this._super()},setup:function(e){this.time=e.time,this.name=e.name,this.id=e.id}})},{}],1357:[function(e,t,i){"use strict";game.GuildShaoxiangLogItemType=b8e.Enum({NONE:0,BAITANXIANG:1,SUHEXIANG:2,TIANMUXIANG:3})},{}],1358:[function(e,t,i){"use strict";game.GuildShaoxiangLogs=b8e.Object.extends({LogList:null,LogPool:null,ctor:function(){this._super(),this.LogList=[],this.LogPool=[]},setup:function(e){this.clean();for(var t=0;t<e.logs.length;++t){var i=this.getItem();i.setup(e.logs[t]),this.LogList.push(i)}},getItem:function(){return 0<this.LogPool.length?this.LogPool.shift():new game.GuildShaoxiangLogItem},clean:function(){for(;0<this.LogList.length;){var e=this.LogList.shift();this.LogPool.push(e)}}})},{}],1359:[function(e,t,i){"use strict";game.GuildXinFa=b8e.Object.extends({xinfaType:0,level:0,ctor:function(){this._super()},setup:function(e){this.xinfaType=e.xinfaType,this.level=e.level}})},{}],1360:[function(e,t,i){"use strict";e("./GuildBossInfo"),e("./GuildBossMemberRank"),e("./GuildBossNotify"),e("./GuildBossRank"),e("./GuildChangeRankInfo"),e("./GuildInfo"),e("./GuildLogInfo"),e("./GuildMemberInfo"),e("./GuildModuleInfo"),e("./GuildQueatInfo"),e("./GuildQueatUnit"),e("./GuildQuestAwardInfo"),e("./GuildShaoxiang"),e("./GuildShaoxiangLogItem"),e("./GuildShaoxiangLogItemType"),e("./GuildShaoxiangLogs"),e("./GuildXinFa")},{"./GuildBossInfo":1343,"./GuildBossMemberRank":1344,"./GuildBossNotify":1345,"./GuildBossRank":1346,"./GuildChangeRankInfo":1347,"./GuildInfo":1348,"./GuildLogInfo":1349,"./GuildMemberInfo":1350,"./GuildModuleInfo":1351,"./GuildQueatInfo":1352,"./GuildQueatUnit":1353,"./GuildQuestAwardInfo":1354,"./GuildShaoxiang":1355,"./GuildShaoxiangLogItem":1356,"./GuildShaoxiangLogItemType":1357,"./GuildShaoxiangLogs":1358,"./GuildXinFa":1359}],1361:[function(e,t,i){"use strict";e("./item/itemIndex_1"),e("./equip/equipInfoIndex"),e("./amount/amountIndex_0"),e("./spritestat/spritestatIndex_0"),e("./notice/noticeIndex_1"),e("./pkMode/pkModeIndex_0"),e("./updrade/updradeIndex_0"),e("./prizeInfo/prizeInfoIndex_0"),e("./bianshen/bianshenIndex_2"),e("./dungeonResult/dungeonResultIndex_0"),e("./loneyDungeon/loneyDungeonIndex_1"),e("./quest/questIndex_0"),e("./relive/reliveIndex_1"),e("./role/roleIndex_1"),e("./scene/sceneIndex_1"),e("./shape/shapeIndex_0"),e("./skill/skillIndex_1"),e("./gm/gmIndex_2"),e("./goto/gotoInfoIndex"),e("./accessory/accessoryInfoIndex"),e("./mail/mailIndex_1"),e("./trans/transIndex"),e("./power/powerInfoIndex"),e("./draw/drawIndex_1"),e("./welfare/welfareIndex_0"),e("./cost/costIndex_2"),e("./rank/rankIndex_2"),e("./shop/shopInfoIndex"),e("./arena/arenaInfoIndex"),e("./power/powerInfoIndex"),e("./relation/relationInfoIndex"),e("./strengthen/strengthenIndex_1"),e("./pay/payInfoIndex_0"),e("./worldBoss/worldBossIndex_1"),e("./clientSetting/clientSettingInfoIndex"),e("./active/activeInfoIndex"),e("./surface/surfaceInfoIndex"),e("./recharge/rechargeIndex_0"),e("./cornucopia/cornucopiaIndex_1"),e("./buff/buffInfoIndex"),e("./nationalBoss/nationalBossIndex_1"),e("./xiandan/xiandanInfoIndex_0"),e("./redPacket/redPacketInfoIndex_0"),e("./mystery/mysteryInfoIndex"),e("./tiangong/tiangongInfoIndex"),e("./rune/runeIndex_2")},{"./accessory/accessoryInfoIndex":1262,"./active/activeInfoIndex":1270,"./amount/amountIndex_0":1273,"./arena/arenaInfoIndex":1290,"./bianshen/bianshenIndex_2":1300,"./buff/buffInfoIndex":1304,"./clientSetting/clientSettingInfoIndex":1312,"./cornucopia/cornucopiaIndex_1":1317,"./cost/costIndex_2":1319,"./draw/drawIndex_1":1322,"./dungeonResult/dungeonResultIndex_0":1327,"./equip/equipInfoIndex":1334,"./gm/gmIndex_2":1340,"./goto/gotoInfoIndex":1342,"./item/itemIndex_1":1372,"./loneyDungeon/loneyDungeonIndex_1":1378,"./mail/mailIndex_1":1381,"./mystery/mysteryInfoIndex":1385,"./nationalBoss/nationalBossIndex_1":1389,"./notice/noticeIndex_1":1394,"./pay/payInfoIndex_0":1397,"./pkMode/pkModeIndex_0":1399,"./power/powerInfoIndex":1402,"./prizeInfo/prizeInfoIndex_0":1408,"./quest/questIndex_0":1411,"./rank/rankIndex_2":1414,"./recharge/rechargeIndex_0":1417,"./redPacket/redPacketInfoIndex_0":1419,"./relation/relationInfoIndex":1423,"./relive/reliveIndex_1":1426,"./role/roleIndex_1":1444,"./rune/runeIndex_2":1452,"./scene/sceneIndex_1":1454,"./shape/shapeIndex_0":1456,"./shop/shopInfoIndex":1459,"./skill/skillIndex_1":1464,"./spritestat/spritestatIndex_0":1468,"./strengthen/strengthenIndex_1":1471,"./surface/surfaceInfoIndex":1490,"./tiangong/tiangongInfoIndex":1506,"./trans/transIndex":1510,"./updrade/updradeIndex_0":1514,"./welfare/welfareIndex_0":1518,"./worldBoss/worldBossIndex_1":1525,"./xiandan/xiandanInfoIndex_0":1532}],1362:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.BaseInfo=b8e.Object.extends((s(n={_index:-1,_id:"",_idx:0,group:-1,_type:-1,_baseType:-1,_name:"",_num:1,_maxCount:0,_iconName:"",_coolId:"",_quality:0,_level:0,_data:null,qualityEffect:"",ctor:function(e,t){this._super(),this._id=e,this._type=t},index:{set:function(e){this._index=e},get:function(){return this._index}},id:{set:function(e){this._id=e},get:function(){return this._id}},coolId:{set:function(e){this._coolId=e},get:function(){return this._coolId}},idx:{set:function(e){this._idx=e},get:function(){return this._idx}},type:{set:function(e){this._type=e},get:function(){return this._type}},baseType:{set:function(e){this._baseType=e},get:function(){return this._baseType}},name:{set:function(e){this._name=e},get:function(){return this._name}},num:{set:function(e){e||(e=1),this._num=e},get:function(){return this._num}},maxCount:{set:function(e){this._maxCount=e},get:function(){return this._maxCount}},iconName:{set:function(e){this._iconName=e},get:function(){return this._iconName}}},"coolId",{set:function(e){this._coolId=e},get:function(){return this._coolId}}),s(n,"quality",{set:function(e){this._quality=e},get:function(){return this._quality}}),s(n,"level",{set:function(e){this._level=e},get:function(){return this._level}}),s(n,"data",{set:function(e){this._data=e},get:function(){return this._data}}),n))},{}],1363:[function(e,t,i){"use strict";game.GridInfo=b8e.Object.extends({_containerId:-1,_index:-1,isTips:!0,_data:null,ctor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;this._super(),this._containerId=e,this._index=t},reset:function(){this._containerId=containerId,this._index=index},containerId:{set:function(e){this._containerId=e},get:function(){return this._containerId}},index:{get:function(){return this._index}},data:{set:function(e){this._data=e},get:function(){return this._data}}})},{}],1364:[function(e,t,i){"use strict";game.ItemInfo=game.BaseInfo.extends({_expireTime:0,_binded:!1,_baseAttrId:null,_baseSpriteStat:null,_desc:"",_goto:"",_effects:null,_effectsType:"",_effectValue:0,_isEquip:!1,isUse:!1,useCost:null,triggerId:0,isCompound:!1,isHighEquip:!1,notShowRed:!1,becomingVipLevelShowRed:!1,ctor:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._super(e,t),this._effects=[]},endCallBack:function(){b8e.Timer.remove(this,this.endCallBack),b8e.evt.dptG(game.BackEvt.BACK_REMOVE_ITEMINFO,this)},expireTime:{set:function(e){this._expireTime=e},get:function(){return this._expireTime}},binded:{set:function(e){this._binded=e},get:function(){return this._binded}},desc:{set:function(e){this._desc=e},get:function(){return this._desc}},goto:{set:function(e){this._goto=e},get:function(){return this._goto}},effects:{set:function(e){this._effects=e},get:function(){return this._effects}},effectsType:{set:function(e){this._effectsType=e},get:function(){return this._effectsType}},baseAttrId:{set:function(e){this._baseAttrId=e},get:function(){return this._baseAttrId}},baseSpriteStat:{set:function(e){this._baseSpriteStat=e},get:function(){return this._baseSpriteStat}},effectValue:{set:function(e){this._effectValue=e},get:function(){return this._effectValue}},isEquip:{get:function(){switch(this.type){case game.GoodsType.WEAPON:case game.GoodsType.ARMOR:case game.GoodsType.BELT:case game.GoodsType.RING:case game.GoodsType.HELM:case game.GoodsType.NECKLACE:case game.GoodsType.LEGGUARD:case game.GoodsType.SHOE:case game.GoodsType.ZUOAN:case game.GoodsType.GUAJIAN:case game.GoodsType.JIANGSHENG:case game.GoodsType.JIAODENG:this._isEquip=!0;break;default:this._isEquip=!1}return this._isEquip}},getEffectValueByType:function(e){for(var t=0;t<this._effects.length;t++){var i=this._effects[t];if(i.Type==e)return i.Value}},isCostYB:{get:function(){return!!this.useCost&&(!!this.useCost.amountInfo&&0<this.useCost.amountInfo.getValue(game.AmountType.YUAN_BAO))}}})},{}],1365:[function(e,t,i){"use strict";game.ContainerId=b8e.Enum({BACK_CONTAINER_ID:1,ROLE_EQUIP_CONTAINER_ID:2,EQUIP_INTENSIFY_CONTAINER_ID:3,EQUIP_INTENSIFY_CENTER_CONTAINER_ID:4,BIANSHEN_BACK_CONTAINER_ID:5,BIANSHEN_SLOT_CONTAINER_ID:6,BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:7,BIANSHEN_JIE_MATERIAL_BACK_CONTAINER_ID:8,BIANSHEN_BATTLE_LIST_ITEM_CONTAINER_ID:9,BIANSHEN_MATERIAL_BACK_CONTAINER_ID:10,BIANSHEN_BATTLE_BACK_CONTAINER_ID:11,BIANSHEN_SHOW_GRID_CONTAINER_ID:12,BIANSHEN_CARD_CONTAINER_ID:13,PRIZE_LIST_ID:14,GUILD_ACTIVE_CONTAINER_ID:15,SURA_PRIZE_ITEM_SHOWNAME:16,SURA_PRIZRITEN_SHOWICON:17,WORLD_BOSS_DROP_ID:18,SKILL_CONTAINER_ID:19,COST_CONTAINER_ID:20,TIPS_CONTAINER_ID:21,BEAUTY_CONTAINER_ID:22,BIANSHEN_MATERIAL_ITEM_BACK_CONTAINER_ID:23,DUNGEON_DROP_PRIZE_LIST_ID:24,TIAN_GONG_OVERLORD_CONTAINER_ID:25,EQUIP_UP_STAR_CONTAINER_ID:26,EQUIP_UP_STAR_CENTER_CONTAINER_ID:27,REWRADS_CONTAINER_ID:28,DUNGEON_SHOW_PRIZE_CONTAINER_ID:29,AOTU_EQUIP_CONTAINER_ID:30,EQUIP_REFINE_LEFT_CONTAINER_ID:31,EQUIP_REFINE_RIGHT_CONTAINER_ID:32,EQUIP_SELECT_WEAR_CONTAINER_ID:33,BAO_ZHU_CONTAINER_ID:34,ROULETTE_DB_CONTAINER_ID:35,ROULETTE_CONTAINER_ID:36,ROULETTE_SMALL_TIPS_CONTAINER_ID:37,SHOP_BUY_GRID_CONTAINER_ID:38,SHOP_GRID_CONTAINER_ID:39,MYSTERY_CONTAINER_ID:40,MILION_CONTAINER_ID:41,BIANSHEN_UPGRADE_GRID_CONTAINER_ID:42,BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:43,BIANSHEN_JIE_LEFT_GRID_CONTAINER_ID:44,BIANSHEN_JIE_RIGHT_GRID_CONTAINER_ID:45,BIANSHEN_JIE_MAX_GRID_CONTAINER_ID:46,BIANSHEN_ARCHIVE_GRID_CONTAINER_ID:47,LOW_COST_CONTAINER_ID:48,VIP_REBATE_CONTAINER_ID:49,EQUIP_ENCHAN_ID:50,DAILY_REBATE_CONTAINER_ID:51,CSARENA_RANK_BS_CONTAINER_ID:52,CSARENA_LAST_RANK_BS_CONTAINER_ID:53,GOLDED_PIG_CONTAINER_ID:54,CSARENA_ILLUSTRATION_CONTAINER_ID:55,CSARENA_DECOMPOSE_CONTAINER_ID:56,RUNE_SLOT_CONTAINER_ID:57,RUNE_CONVERTITEM_CONTAINER_ID:58,TOWER_BS_CONTAINER_ID:59,TOWER_NOTICE_ID:60,VIP_SHOW_BIANSHEN_GRID:61,WELFARE_WEEK_SIGN_CONTAINER_ID:62,GUILD_BOOS_GRID:63,CS_ARENA_RULE:64,RETRIEVE_RULE:65,GUILD_EXP_CURE_RULE:66,ACCESSORY_SKILL_CONTAINER:67,ACCESSORY_SKILL_CONVERT_CONTAINER:68,ACCESSORY_SKILL_SELECT_CONTAINER:69,ACCESSORY_SKILL_ARCHIVE_CONTAINER:70,ESCORT_PRIZE_CONTAINER_ID:71,VIP_CUSTOMER_CONTAINER_ID:72,ACTIVE_DEPOT_CONTAINER_ID:73,ACTIVE_Mystery_CONTAINER_ID:74,ESCORT_CONTAINER_ID:75,BIANSHEN_FETTER_CONTAINER_ID:76,WORLDCUP_CONTAINER_ID:77,BIANSHEN_CONVERT_CONTAINER_ID:78,BIANSHEN_RESOLVE_CONTAINER_ID:79,SELECT_REWARD_CONTAINER_ID:80,SELECT_BIANSHEN_CONTAINER_ID:81,BATTLE_BIANSHEN_CONTAINER_ID:82,ORNAMENT_CONTAINER_ID:83,MAX_CONTAINER_ID:999})},{}],1366:[function(e,t,i){"use strict";game.GoodsGroup=b8e.Enum({ITEM:1,EQUIP:2,MOUNTEQUIP:3})},{}],1367:[function(e,t,i){"use strict";game.GoodsType=b8e.Enum({YAO_SHUI:10,BIAN_SHEN_YAO_SHUI:11,CHANGE_NAME:12,MOUNT_UPGRADE:13,FABAO_UPGRADE:14,WING_UPGRADE:15,ACCESSORY_SKILL:16,GIFT_BAG:20,SELF_SELECTION:21,MATERIAL:30,WEAPON:41,ARMOR:42,BELT:43,RING:44,HELM:45,NECKLACE:46,LEGGUARD:47,SHOE:48,AMOUNT:50,XIANDAN:60,ORNAMENT:61,ZUOAN:81,GUAJIAN:82,BIAN_SHEN_CARD:1e3,ITEM_INFO:1001,RUNE:1002,JIANGSHENG:83,JIAODENG:84})},{}],1368:[function(e,t,i){"use strict";game.IconType=b8e.Enum({BaseIconSkin:0,BianshenGridSkin:1,BianshenSlotSkin:2})},{}],1369:[function(e,t,i){"use strict";game.ItemEffectType=b8e.Enum({EXP:"Exp",BIANSHENEXP:"BianshenExp",USELVLIMIT:"UseLvLimit",BEAUTYPOWER:"BeautyPower",CULTIVATION:"Cultivation"})},{}],1370:[function(e,t,i){"use strict";game.Quality=b8e.Enum({Q_WHITE:0,Q_GREEN:1,Q_BLUE:2,Q_PURPLE:3,Q_YELLOW:4,Q_RED:5})},{}],1371:[function(e,t,i){"use strict";e("./IconType"),e("./ContainerId"),e("./Quality"),e("./GoodsType"),e("./GoodsGroup")},{"./ContainerId":1365,"./GoodsGroup":1366,"./GoodsType":1367,"./IconType":1368,"./Quality":1370}],1372:[function(e,t,i){"use strict";e("./BaseInfo"),e("./ItemInfo"),e("./GridInfo"),e("./enum/enumIndex_2")},{"./BaseInfo":1362,"./GridInfo":1363,"./ItemInfo":1364,"./enum/enumIndex_2":1371}],1373:[function(e,t,i){"use strict";game.BattleState=b8e.Enum({Defeat:0,Victory:1})},{}],1374:[function(e,t,i){"use strict";game.DungeonType=b8e.Enum({NONE_TYPE:0,DUJIE_INSTANCE:1,TYPE_LONEY:2,TYPE_MATERIAL_MOUNT:4,TYPE_MATERIAL_WING:5,TYPE_MATERIAL_GLOD:6,TYPE_MATERIAL_FABAO:7,TYPE_MATERIAL_EQUIP:8,TYPE_MATERIAL_EXP:9,TYPE_TEAM:10,TYPE_TOWER:12,TYPE_MATERIAL_XIANZHEN:13})},{}],1375:[function(e,t,i){"use strict";game.LoneyDungeonInfo=b8e.Object.extends({state:0,id:0,freeNum:0,payNum:0,setup:function(e){this.state=e.state,this.id=e.id,this.freeNum=e.freeNum,this.payNum=e.payNum}})},{}],1376:[function(e,t,i){"use strict";game.LoneyDungeonState=b8e.Enum({LOCK:0,UNLOCK:1,FINISH:2})},{}],1377:[function(e,t,i){"use strict";game.MaterialInfo=b8e.Object.extends({type:0,challegeCount:0,qulickCount:0,setup:function(e){this.type=e.type,this.challegeCount=e.challengeCount,this.qulickCount=e.quickCount}})},{}],1378:[function(e,t,i){"use strict";e("./BattleState"),e("./LoneyDungeonInfo"),e("./LoneyDungeonState"),e("./DungeonType"),e("./MaterialInfo")},{"./BattleState":1373,"./DungeonType":1374,"./LoneyDungeonInfo":1375,"./LoneyDungeonState":1376,"./MaterialInfo":1377}],1379:[function(e,t,i){"use strict";game.MailInfo=b8e.Object.extends({id:0,title:"",content:"",time:0,expire:0,state:0,isRead:!1,isGet:!1,prizeInfo:null,sender:"",tid:"",params:"",ctor:function(){this._super(),this.prizeInfo=new game.PrizeInfo},setup:function(e){if(e){this.id=e.id,this.title=e.title,this.content=e.content,this.time=e.time,0==e.expire?this.expire=e.expire:this.expire=e.expire+e.time,this.state=e.state,this.sender=e.sender;var t=e.state>>16;this.isRead=0!=t;var i=65535&e.state;if(this.isGet=0!=i,1==this.isGet&&(this.isRead=!0),0==e.items.length&&(this.isGet=!0),this.setPrizeInfo(e.items),this.tid=e.tid,this.params=e.params,""!=e.tid){var n=game.ccfg.MailCfg.getDataByKey(e.tid);if(n){var s=n.content.split("|");this.title=s[0],this.sender=s[1];var a=s[2],o=e.params.split("|"),r=game.ccfg.LangCfg.getText(a,o);this.content=r}else this.title="未命名",this.sender="系统",this.content="系统繁忙，邮件内容显示异常"}}},setPrizeInfo:function(e){this.prizeInfo.setupItemList(e)}})},{}],1380:[function(e,t,i){"use strict";game.MailItemInfo=b8e.Object.extends({id:0,num:0,ctor:function(){this._super()}})},{}],1381:[function(e,t,i){"use strict";e("./MailInfo"),e("./MailItemInfo")},{"./MailInfo":1379,"./MailItemInfo":1380}],1382:[function(e,t,i){"use strict";game.MonGenInfo=b8e.Object.extends({id:0,mapId:0,monId:0,num:0,pos:null,radius:0,time:0,patrolRadius:0,ctor:function(){this._super()}})},{}],1383:[function(e,t,i){"use strict";e("./MonGenInfo")},{"./MonGenInfo":1382}],1384:[function(e,t,i){"use strict";game.MysteryInfo=b8e.Object.extends({shopId:0,state:0,itemId:0,itemNum:0,discountCost:null,discountCostId:null,normalCost:null,normalCostId:null,ctor:function(){this._super()},setup:function(e){e&&(this.shopId=e.shopId,this.state=e.state,this.itemId=game.shop.getItemId(this.shopId),this.itemNum=game.shop.getItemNum(this.shopId),this.discountCost=game.shop.getMysteryCost(this.shopId,!0),this.discountCostId=game.shop.getMysteryCost(this.shopId,!0,!0),this.normalCost=game.shop.getMysteryCost(this.shopId),this.normalCostId=game.shop.getMysteryCost(this.shopId,!1,!0))}})},{}],1385:[function(e,t,i){"use strict";e("./MysteryInfo")},{"./MysteryInfo":1384}],1386:[function(e,t,i){"use strict";game.NationalAwardInfo=b8e.Object.extends({id:0,score:0,award:"",ctor:function(){this._super()},setData:function(e){this.id=e.id,this.award=e.award,this.score=e.score}})},{}],1387:[function(e,t,i){"use strict";game.NationalBossInfo=b8e.Object.extends({sceneId:0,notifyState:!0,fightPopulation:0,time:0,isRelive:!1,isUnlock:!1,unlockLevel:0,unlockDJLevel:0,bossType:0,ctor:function(){this._super()},setData:function(e){e&&(this.sceneId=e.id,this.fightPopulation=e.fightPopulation,this.time=e.time)}})},{}],1388:[function(e,t,i){"use strict";game.NationalBossKillerInfo=b8e.Object.extends({index:0,name:"",power:0,time:0,zone:null,bianshens:null,ctor:function(){this._super()},setData:function(e){e&&(this.name=e.name,this.power=e.power,this.time=e.time,this.zone=e.zone,this.bianshens=e.bianshens)}})},{}],1389:[function(e,t,i){"use strict";e("./NationalBossInfo"),e("./NationalBossKillerInfo")},{"./NationalBossInfo":1387,"./NationalBossKillerInfo":1388}],1390:[function(e,t,i){"use strict";game.NickName=b8e.Object.extends({id:0,expire_time:0,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.expire_time=e.expireTime)}})},{}],1391:[function(e,t,i){"use strict";game.NickNameInfo=b8e.Object.extends({using_id:0,nickNameList:null,ctor:function(){this._super(),this.nickNameList=b8e.HashMap.get()},setup:function(e){if(e){this.using_id=e.usingId,this.nickNameList.clear();for(var t=0;t<e.nickname.length;++t){var i=new game.NickName;i.setup(e.nickname[t]),this.nickNameList.set(i.id,i)}}},getNickNameById:function(e){return this.nickNameList?this.nickNameList.get(e):null},chickNickNameById:function(e){return!!this.nickNameList&&this.nickNameList.has(e)},getNickNameList:function(){return this.nickNameList?this.nickNameList.keys():null},delNickNameById:function(e){this.nickNameList&&this.nickNameList.del(e)},addNickName:function(e){var t=new game.NickName;t.id=e;var i=game.ccfg.NickNameCfg.getDuration(e);t.expire_time=game.SysTime.curTime+60*i*1e3,this.nickNameList&&this.nickNameList.set(t.id,t)}})},{}],1392:[function(e,t,i){"use strict";game.BCInfo=b8e.Object.extends({value:0,type:0,posx:0,posy:0,isSelf:!1,isTweenUp:!1,ctor:function(){this._super()}})},{}],1393:[function(e,t,i){"use strict";game.NoticeInfo=b8e.Object.extends({msg:"",sort:-1,ctor:function(){this._super()}})},{}],1394:[function(e,t,i){"use strict";e("./NoticeInfo"),e("./BCInfo")},{"./BCInfo":1392,"./NoticeInfo":1393}],1395:[function(e,t,i){"use strict";game.OrnamentInfo=b8e.Object.extends({ctor:function(){this._super(),this.itemId=0,this.level=0,this.ensoul=0,this.attrMap=b8e.HashMap.get()},setup:function(e){e&&(this.itemId=e.itemId,this.level=e.level,this.ensoul=e.ensoul?e.ensoul:0)}})},{}],1396:[function(e,t,i){"use strict";game.PayInfo=b8e.Object.extends({rechargeDatas:null,cardDatas:null,rechargeDiamond:0,collectedFirstRecharge:!1,rechargeDiamondDaily:0,accumulatePrizeGroup:0,collectedAccumulatePrizes:null,rechargeDays:0,rebatePrizeGroup:0,collectedRebatePrizes:null,_rechargeMap:null,_cardsMap:null,buySaleRecords:null,collectedSalePrizeDaily:!1,discountId:!1,buyDiscountDaily:!1,ctor:function(){this._super(),this.collectedAccumulatePrizes=[],this.collectedRebatePrizes=[],this.buySaleRecords=[],this._rechargeMap=b8e.HashMap.get(),this._cardsMap=b8e.HashMap.get()},setup:function(e){e&&(this.rechargeDiamond=e.rechargeDiamond,this.collectedFirstRecharge=e.collectedFirstRecharge,this.rechargeDiamondDaily=e.rechargeDiamondDaily,this.accumulatePrizeGroup=e.accumulatePrizeGroup,this.collectedAccumulatePrizes=e.collectedAccumulatePrizes,this.rechargeDays=e.rechargeDays,this.rebatePrizeGroup=e.rebatePrizeGroup,this.collectedRebatePrizes=e.collectedRebatePrizes,this.saveRechargeDatas(e.rechargeDatas),this.saveCardDatas(e.cardDatas),this.buySaleRecords=e.buySaleRecords,this.collectedSalePrizeDaily=e.collectedSalePrizeDaily,this.discountId=e.discountId,this.buyDiscountDaily=e.buyDiscountDaily,game.pay.isShowDiscountDaily())},saveRechargeDatas:function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];if(i){var n=new game.RechargeDatasInfo;n.id=i.id,n.count=i.count,this.setRechargeMap(n)}}},setRechargeMap:function(e){this._rechargeMap.set(e.id,e)},getRechargeMap:function(){return this._rechargeMap},saveCardDatas:function(e){if(e&&0<e.length)for(var t,i,n=0;n<e.length;n++)(t=e[n])&&((i=new game.CardRechargeInfo).id=t.id,i.expireTime=t.expireTime,i.collectedPrizeDaily=t.collectedPrizeDaily,i.cardType=t.cardType,this.setCardsMap(i))},setCardsMap:function(e){this._cardsMap.set(e.cardType,e)},getCardsMap:function(){return this._cardsMap},getCardsInfoByCardType:function(e){return this._cardsMap.get(e)},delCardsInfoByCardType:function(e){return this._cardsMap.del(e)},addIdToAccumulatePrizes:function(e){this.collectedAccumulatePrizes.push(e)},addIdToRebatePrizes:function(e){this.collectedRebatePrizes.push(e)},addIdToSaleRecords:function(e){this.buySaleRecords.push(e)},isFirstRecharge:function(e){return null==this._rechargeMap.get(e)}})},{}],1397:[function(e,t,i){"use strict";e("./PayInfo")},{"./PayInfo":1396}],1398:[function(e,t,i){"use strict";game.PkModeType=b8e.Enum({None:0,PEACE:1,ALL:2,GUILD:3})},{}],1399:[function(e,t,i){"use strict";e("./PkModeType"),e("./pkModeInfo")},{"./PkModeType":1398,"./pkModeInfo":1400}],1400:[function(e,t,i){"use strict";game.PkModeInfo=b8e.Object.extends({availableModes:null,currentMode:null,ctor:function(){this._super()},setup:function(e){this.availableModes=e.availableModes,this.currentMode=e.currentMode},getAvailableModesByMode:function(e){for(var t=0;t<this.availableModes.length;t++){if(this.availableModes[t]==e)return!0}return!1}})},{}],1401:[function(e,t,i){"use strict";game.AttrPowerCoefInfo=b8e.Object.extends({attr:0,coef:0,type:0,ctor:function(){this._super()}})},{}],1402:[function(e,t,i){"use strict";e("./AttrPowerCoefInfo")},{"./AttrPowerCoefInfo":1401}],1403:[function(e,t,i){"use strict";game.AmountItemId=b8e.Enum({SILVER:500001,YUAN_BAO:500002,EXP:500003,POPULARITY:500004,CONTRIBUTION:500005,HONOUR:500008})},{}],1404:[function(e,t,i){"use strict";e("./PrizeItemType"),e("./AmountItemId"),e("./PrizeItem"),e("./PrizeInfo")},{"./AmountItemId":1403,"./PrizeInfo":1405,"./PrizeItem":1406,"./PrizeItemType":1407}],1405:[function(e,t,i){"use strict";game.PrizeInfo=b8e.Object.extends({_prizeArr:null,_percent:1,ctor:function(e){this._super(),this._prizeArr=[],this.setup(e)},setup:function(e){this._prizeArr.length=0,e&&(this.setupItemList(e.list,!1),this.setupAmount(e.amount,!1))},setupById:function(e){var t=game.ccfg.PrizeCfg.getPrizeById(e);t&&(this._prizeArr=t)},getPercent:function(){return this._percent},setPercent:function(e){this._percent=e},setupItemList:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(t&&(this._prizeArr.length=0),e)for(var n=0;n<e.length;n++){var s=e[n];if(s){var a=new game.PrizeItem;if(i?game.ccfg.BianshenCfg.getBianshenCfgById(s.Id):game.ccfg.BianshenCfg.getBianshenCfgById(s.id))a.type=game.PrizeItemType.BIAN_SHEN_CARD;else{var o=i?game.ccfg.RuneCfg.getRuneDataById(s.Id):game.ccfg.RuneCfg.getRuneDataById(s.id);a.type=o?game.PrizeItemType.RUNE:game.PrizeItemType.TYPE_ITEM}a.itemId=i?s.Id:s.id,a.num=i?s.Num:s.num,this._prizeArr.push(a)}}},setupAmount:function(e){if((!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&(this._prizeArr.length=0),e)for(var t=0;t<e.list.length;t++){var i=e.list[t];if(i){var n=new game.PrizeItem;switch(i.type){case game.AmountType.SILVER:n.type=game.PrizeItemType.TYPE_SILVER;break;case game.AmountType.YUAN_BAO:n.type=game.PrizeItemType.TYPE_YUAN_BAO;break;case game.AmountType.POPULARITY:n.type=game.PrizeItemType.TYPE_POPULARITY;break;case game.AmountType.CONTRIBUTION:n.type=game.PrizeItemType.CONTRIBUTION;break;case game.AmountType.HONOUR:n.type=game.PrizeItemType.HONOUR}n.num=i.num,this._prizeArr.push(n)}}},getPrizeList:function(){return this._prizeArr},clearPrizeList:function(){this._prizeArr&&(this._prizeArr.length=0)},getFristPrizeString:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this._prizeArr&&0!=this._prizeArr.length?((e=game.ccfg.BianshenCfg.getBianshenCfgById(this._prizeArr[0].itemId))||(e=game.ccfg.ItemInfoCfg.getItemInfoById(this._prizeArr[0].itemId)),e?0!=t?e.name+" * "+(this._prizeArr[0].num+t):e.name+" * "+this._prizeArr[0].num:void 0):"无"}})},{}],1406:[function(e,t,i){"use strict";game.PrizeItem=b8e.Object.extends({type:0,itemId:0,num:0})},{}],1407:[function(e,t,i){"use strict";game.PrizeItemType=b8e.Enum({TYPE_ITEM:1,TYPE_EXP:2,TYPE_SILVER:3,TYPE_YUAN_BAO:4,TYPE_POPULARITY:5,BIAN_SHEN_CARD:6,CONTRIBUTION:8,RUNE:9,HONOUR:10})},{}],1408:[function(e,t,i){"use strict";e("./AmountItemId"),e("./PrizeIndex"),e("./PrizeInfo"),e("./PrizeItem"),e("./PrizeItemType")},{"./AmountItemId":1403,"./PrizeIndex":1404,"./PrizeInfo":1405,"./PrizeItem":1406,"./PrizeItemType":1407}],1409:[function(e,t,i){"use strict";game.MainQuestType=b8e.Enum({ROLE_LV:0,KILL_MONSTER:1,KILL_SCENE_MONSTER:2,COMPLETE_INSTANCE:3,ARENA_CHALLENGE:4,UPGRADE_EQUIP_SLOT:5,SMELT_EQUIP:6,RAFFLE:7,TALK_WITH_NPC:8,COMPLETE_TYPE_INSTANCE:9})},{}],1410:[function(e,t,i){"use strict";game.QuestInfo=b8e.Object.extends({id:null,sequence:null,isAuto:null,desc:null,prevId:null,lvRequirement:null,dropId:null,conditionType:null,conditionParam1:null,conditionParam2:null,progress:null,completed:null,destinationList:null,isAutoComplete:!1,ctor:function(){this._super()},setup:function(e){this.id=e.id,this.desc=e.desc,this.prevId=e.prevId,this.lvRequirement=e.lvRequirement,this.dropId=e.dropId,this.conditionType=e.conditionType,this.conditionParam1=e.conditionParam1,this.conditionParam2=e.conditionParam2,this.progress=e.progress,this.completed=e.completed,this.destinationList=e.destinationList;var t=game.ccfg.MainQuestCfg.getQuestById(this.id);t&&(this.sequence=t.sequence,this.isAuto=t.isAuto,this.isAutoComplete=t.isAutoComplete)}})},{}],1411:[function(e,t,i){"use strict";e("./MainQuestType"),e("./QuestInfo")},{"./MainQuestType":1409,"./QuestInfo":1410}],1412:[function(e,t,i){"use strict";game.ExtraRankInfo=b8e.Object.extends({protoId:0,mount:0,wing:0,fabao:0,surface:0,ctor:function(){this._super()},setData:function(e){this.protoId=e.protoId,this.mount=e.mount,this.wing=e.wing,this.fabao=e.fabao,this.surface=e.surface}})},{}],1413:[function(e,t,i){"use strict";game.RankInfo=b8e.Object.extends({roleid:0,name:0,rank:0,score:0,level:0,power:0,time:0,info:0,rebirthLevel:0,type:-1,vip:0,vipLevel:0,zone:0,ctor:function(){this._super()},setInfo:function(e){e&&(this.info=new game.ExtraRankInfo,this.info.setData(e))}})},{}],1414:[function(e,t,i){"use strict";e("./RankInfo"),e("./ExtraRankInfo")},{"./ExtraRankInfo":1412,"./RankInfo":1413}],1415:[function(e,t,i){"use strict";game.CardRechargeInfo=b8e.Object.extends({id:0,expireTime:0,collectedPrizeDaily:0,cardType:0,ctor:function(){this._super()}})},{}],1416:[function(e,t,i){"use strict";game.RechargeDatasInfo=b8e.Object.extends({id:0,count:0,ctor:function(){this._super()}})},{}],1417:[function(e,t,i){"use strict";e("./RechargeDatasInfo"),e("./CardRechargeInfo")},{"./CardRechargeInfo":1415,"./RechargeDatasInfo":1416}],1418:[function(e,t,i){"use strict";game.RedPacketInfo=b8e.Object.extends({id:0,content:null,expireTime:0,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.content=e.content,this.expireTime=e.expireTime)}})},{}],1419:[function(e,t,i){"use strict";e("./RedPacketInfo")},{"./RedPacketInfo":1418}],1420:[function(e,t,i){"use strict";game.RelationInfo=b8e.Object.extends({type:0,_data:null,nextRequestTime:0,ctor:function(){this._super(),this._data=b8e.HashMap.get()},setup:function(e){if(e){this.type=e.type,this._data.clear();for(var t=0;t<e.roleDatas.length;t++){var i;(i=new game.RelationRoleData).setup(e.roleDatas[t]),this._data.set(i.roleId,i)}}},addInfo:function(e){if(e){var t=new game.RelationRoleData;t.setup(e.roleData),this._data.set(t.roleId,t)}},removeInfo:function(e){e&&this._data.del(e.roleId)},getInfo:function(e){return this._data.get(e)},getDatas:function(){return this._data.values()}})},{}],1421:[function(e,t,i){"use strict";game.RelationRoleData=b8e.Object.extends({roleId:0,roleName:null,head:0,lv:0,fightAmount:0,isOnline:!1,lastLogoutTime:0,rebirthLevel:0,setup:function(e){e&&(this.roleId=e.roleId,this.roleName=e.roleName,this.head=e.head,null!=this.roleId&&null!=this.roleName&&null!=this.head||b8e.log("服务器发送好友数据又问题"),this.lv=e.level,this.fightAmount=e.fightAmount,this.isOnline=e.isOnline,this.lastLogoutTime=e.lastLogoutTime,this.rebirthLevel=e.rebirthLevel)}})},{}],1422:[function(e,t,i){"use strict";game.RelationType=b8e.Enum({Friend:0,Black:1})},{}],1423:[function(e,t,i){"use strict";e("./RelationInfo"),e("./RelationRoleData"),e("./RelationType")},{"./RelationInfo":1420,"./RelationRoleData":1421,"./RelationType":1422}],1424:[function(e,t,i){"use strict";game.ReliveInfo=b8e.Object.extends({killer:null,waitTime:0,autoReliveTime:0,cost:0,canFreeRelive:!1,canCostRelive:!1,setup:function(e){this.killer=e.killer,this.waitTime=e.freeReliveTime,this.autoReliveTime=e.autoReliveTime,b8e.log("等待时间  ",this.waitTime),b8e.log("复活时间  ",this.autoReliveTime),this.canFreeRelive=e.canFreeRelive,this.canCostRelive=e.canCostRelive,this.cost=e.cost},getReliveViewType:function(){return this.canFreeRelive&&this.canCostRelive?game.ReliveViewType.ReliveType_1:this.canFreeRelive?game.ReliveViewType.ReliveType_2:this.canCostRelive?game.ReliveViewType.ReliveType_3:(b8e.log("没有找到指定的复活类型，说明这个副本不允许复活，但是后端发了复活了"),game.ReliveViewType.ReliveType_Fail)}})},{}],1425:[function(e,t,i){"use strict";game.ReliveViewType=b8e.Enum({ReliveType_1:0,ReliveType_2:1,ReliveType_3:2,ReliveType_Fail:4})},{}],1426:[function(e,t,i){"use strict";e("./ReliveInfo"),e("./ReliveViewType")},{"./ReliveInfo":1424,"./ReliveViewType":1425}],1427:[function(e,t,i){"use strict";game.AvatarInfo=b8e.Object.extends({bodyRes:null,bodyResId:null,mountResId:null,wingResId:null,faBaoResId:null,beautyResId:null,xianZhenResId:null,cornucopiaIsBoom:!1,usingSurface:null,surfaceBodyRes:null,nickname:0,expCureState:!1,_isDisposed:!1,_isRecycled:!1,setup:function(e){if(this.surfaceBodyRes=null,this.usingSurface=e.getSurface(),this.usingSurface){var t=game.ccfg.SurfaceCfg.getDataById(this.usingSurface);t&&(this.surfaceBodyRes=t.res)}this.bodyResId=e.getBodyResId(),this.bodyRes=e.getBodyRes(),this.mountResId=e.getMountResId(),this.wingResId=e.getWingResId(),this.faBaoResId=e.getFaBaoResId(),this.xianZhenResId=e.getXianZhenResId(),this.cornucopiaIsBoom=e.getCornucopiaIsBoom(),this.nickname=e.getNickName(),this.beautyResId=e.getBeautyResId(),this.expCureState=e.getExpCureState(),this.ornamentResId=e.getOrnamentId()},clear:function(){this.bodyRes=null,this.bodyResId=null,this.mountResId=null,this.wingResId=null,this.faBaoResId=null,this.beautyResId=null,this.xianZhenResId=null,this.cornucopiaIsBoom=!1,this.usingSurface=null,this.surfaceBodyRes=null,this.nickname=0,this.expCureState=!1,this.ornamentResId=0},restore:function(){this.clear(),this._isRecycled=!1},recycle:function(){this.clear(),this._isRecycled=!0},release:function(){game.AvatarInfo.put(this)},dispose:function(){this.clear(),this._isDisposed=!0,this._isRecycled=!1},destroy:function(){this.dispose()}}),game.AvatarInfo.pool=new b8e.Pool(game.AvatarInfo,1024),game.AvatarInfo.get=function(e,t){return game.AvatarInfo.pool.get(e,t)},game.AvatarInfo.put=function(e){return e=game.AvatarInfo.pool.put(e)}},{}],1428:[function(e,t,i){"use strict";game.BaseRoleData=b8e.Object.extends({objectName:"BaseRoleData",type:game.RoleType.None,modelId:0,id:0,name:"",dujie:0,direction:game.Direction.None,loginPosition:null,baseSpriteStat:null,spriteStat:null,isSelf:!1,avatarInfo:null,buffSet:null,scale:1,quality:0,isClientRole:!1,_isDisposed:!1,_isRecycled:!1,ctor:function(){this._super(),this.reset()},reset:function(){this.spriteStat?this.spriteStat.clearSpriteSatats():this.spriteStat=game.SpriteStat.get(),this.baseSpriteStat?this.baseSpriteStat.clearSpriteSatats():this.baseSpriteStat=game.SpriteStat.get(),this.avatarInfo?this.avatarInfo.clear():this.avatarInfo=game.AvatarInfo.get(),this.buffSet?this.buffSet.clear():this.buffSet=game.BuffSet.get()},getHp:function(){var e=this.spriteStat.getStatDataByType(game.SpriteStatType.HP);return e?e.value:0},getResId:function(){},getLv:function(){return this.spriteStat?this.spriteStat.getStatValue(game.SpriteStatType.LV):0},restore:function(){this._isRecycled=!1,this.reset()},recycle:function(){this._isRecycled=!0,this.reset()},release:function(){game.BaseRoleData.put(this)},dispose:function(){this.spriteStat&&(this.spriteStat.dispose(),this.spriteStat=null),this.baseSpriteStat&&(this.baseSpriteStat.dispose(),this.baseSpriteStat=null),this.avatarInfo&&(this.avatarInfo.dispose(),this.avatarInfo=null),this.buffSet&&(this.buffSet.dispose(),this.buffSet=null),this._isDisposed=!0,this._isRecycled=!1},destroy:function(){this.dispose()}}),game.BaseRoleData.pool=new b8e.Pool(game.BaseRoleData,1024),game.BaseRoleData.get=function(e,t){return game.BaseRoleData.pool.get(e,t)},game.BaseRoleData.put=function(e){return e=game.BaseRoleData.pool.put(e)}},{}],1429:[function(e,t,i){"use strict";game.ClientEntityData=game.BaseRoleData.extends({bodyRes:"",mountResId:0,wingResId:0,faBaoResId:0,xianZhenResId:0,ctor:function(){this._super(),this.type=game.RoleType.ClientEntity},setData:function(e){this.id=e.id,this.direction=e.direction,this.loginPosition=cc.v2(e.pos.X,e.pos.Y),this.name=e.name,this.scale=e.scale/100,this.bodyRes=e.bodyRes,this.mountResId=e.mountResId,this.wingResId=e.wingResId,this.faBaoResId=e.faBaoResId,this.xianZhenResId=e.xianZhenResId},restore:function(){this._super()},recycle:function(){this._super()},release:function(){game.ClientEntityData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.ClientEntityData.pool=new b8e.Pool(game.ClientEntityData,1024),game.ClientEntityData.get=function(){return game.ClientEntityData.pool.get()},game.ClientEntityData.put=function(e){return e=game.ClientEntityData.pool.put(e)}},{}],1430:[function(e,t,i){"use strict";game.Direction=b8e.Enum({None:0,Up:-1,UpRight:-1,Right:-1,DownRight:-1,Down:-1,DownLeft:-1,Left:-1,UpLeft:-1}),game.Direction.getRadian=function(e){var t=game.Direction.getAnimatDirection(e);return b8e.CommonUtil.getRadianByDirection(t)},game.Direction.getAnimatDirection=function(e){var t={x:0,y:0};return e==game.Direction.Up?(t.x=0,t.y=1):e==game.Direction.UpRight?(t.x=1,t.y=1):e==game.Direction.Right?(t.x=1,t.y=0):e==game.Direction.DownRight?(t.x=1,t.y=-1):e==game.Direction.DownLeft?(t.x=-1,t.y=-1):e==game.Direction.Down?(t.x=0,t.y=-1):e==game.Direction.Left?(t.x=-1,t.y=0):e==game.Direction.UpLeft?(t.x=-1,t.y=1):(t.x=0,t.y=-1),t},game.Direction.getDirection=function(e){var t=e.x,i=e.y;return 0==t&&1==i?game.Direction.Up:1==t&&1==i?game.Direction.UpRight:1==t&&0==i?game.Direction.Right:1==t&&-1==i?game.Direction.DownRight:-1==t&&-1==i?game.Direction.DownLeft:0==t&&-1==i?game.Direction.Down:-1==t&&0==i?game.Direction.Left:-1==t&&1==i?game.Direction.UpLeft:game.Direction.Down}},{}],1431:[function(e,t,i){"use strict";game.DoorData=game.BaseRoleData.extends({ctor:function(){this._super(),this.type=game.RoleType.Door},setDoorData:function(e){this.modelId=e.resName,this.id=++game.DoorData.startIndex,this.direction=game.Direction.Down,this.loginPosition=cc.v2(e.inPos.X,e.inPos.Y),this.name=e.name},getResId:function(){return this.modelId},restore:function(){this._super()},recycle:function(){this._super()},release:function(){game.DoorData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.DoorData.startIndex=1e8,game.DoorData.pool=new b8e.Pool(game.DoorData,1024),game.DoorData.get=function(){return game.DoorData.pool.get()},game.DoorData.put=function(e){return e=game.DoorData.pool.put(e)}},{}],1432:[function(e,t,i){"use strict";game.DropItemData=game.BaseRoleData.extends({type:game.RoleType.DropItem,cfgId:0,dropType:0,nameColor:"#ffffff",quality:0,setItemData:function(e){var t,i,n=game.ccfg.RuneCfg.getRuneDataById(e.id);n?(t=n.iconName,this.name=n.name,i=game.html.getColorByQuality(n.quality),this.quality=n.quality):(t=game.ccfg.ItemInfoCfg.getIconNameById(e.id),this.name=game.ccfg.ItemInfoCfg.getNameById(e.id),i=game.ccfg.ItemInfoCfg.getQualityColorById(e.id),this.quality=game.ccfg.ItemInfoCfg.getQuilatyById(e.id)),0==t&&(t=game.ccfg.ItemInfoCfg.getIconNameById(330001),b8e.log(e.id,"没有配置图标,但是掉落了")),this.modelId=game.ClientCfg.getImgUrl(t),""==this.name&&b8e.log("道具",e.id,"未配置名字"),this.id=++game.DropItemData.startIndex,this.dropType=game.DropDataType.Item,this.nameColor=b8e.ColorUtil.toCCColor(i)},setAmountDropData:function(e){var t;switch(e.type){case game.AmountType.SILVER:t=500001;break;case game.AmountType.YUAN_BAO:t=500002,this.quality=game.Quality.Q_YELLOW;break;case game.AmountType.POPULARITY:t=500004;break;case game.AmountType.HONOUR:t=500008;break;default:t=500001}var i=game.ccfg.ItemInfoCfg.getIconNameById(t);this.modelId=game.ClientCfg.getImgUrl(i),this.name=e.value,this.id=++game.DropItemData.startIndex,this.dropType=game.DropDataType.Glod,this.nameColor=b8e.ColorUtil.toCCColor(game.html.Q_WHITE)},setPosition:function(e){e&&(this._position=cc.v2(e.x,e.y))},getResId:function(){return this.modelId},restore:function(){this._super()},recycle:function(){this._super()},release:function(){game.DropItemData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.DropItemData.startIndex=2e8,game.DropItemData.pool=new b8e.Pool(game.DropItemData,1024),game.DropItemData.get=function(){return game.DropItemData.pool.get()},game.DropItemData.put=function(e){return e=game.DropItemData.pool.put(e)}},{}],1433:[function(e,t,i){"use strict";game.DropDataType=b8e.Enum({Item:0,Glod:1,Money:2})},{}],1434:[function(e,t,i){"use strict";game.FollowerData=game.BaseRoleData.extends({objectName:"FollowerData",setData:function(e,t){this.id=e;var i=game.ccfg.FaBaoCfg.getDataById(t);i&&(this.avatarInfo.bodyRes=i.res,this.type=game.RoleType.Follower)},setOrnamentData:function(e,t){e&&(this.id=e.id,this.avatarInfo.bodyRes=game.ccfg.OrnamentCfg.getSceneRes(t),this.type=game.RoleType.Ornament)},setBeautyData:function(e,t){if(e){this.id=e.id;var i=game.ccfg.BeautyDataCfg.getBeautyInfoById(t);i&&(this.avatarInfo.bodyRes=i.sceneRes,this.type=game.RoleType.Beauty,this.name=e.name+"的\n"+i.name,this.quality=i.quality)}},restore:function(){this._super()},recycle:function(){this._super()},release:function(){game.FollowerData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.FollowerData.pool=new b8e.Pool(game.FollowerData,1024),game.FollowerData.get=function(){return game.FollowerData.pool.get()},game.FollowerData.put=function(e){return e=game.FollowerData.pool.put(e)}},{}],1435:[function(e,t,i){"use strict";game.HeroData=game.BaseRoleData.extends({playerId:0,mapId:0,defaultModelId:0,exp:0,equipSlotsMap:null,heroModel:null,isRiding:!1,pkMode:game.PkModeType.PEACE,head:"",_wing_lv:0,_mount_lv:0,_fabao_lv:0,_xianzhen_lv:0,quality_taoz_id:0,star_taoz_id:0,_isHasGuild:!1,guildId:0,guildName:"",miscData:null,vipLevel:0,inSafeArea:!1,line:0,gmPrivilege:!1,ctor:function(){this._super(),this.type=game.RoleType.Hero,this.reset(),game.HeroData.count++},setHeroData:function(e){this.modelId=e.conid,this.id=e.id,this.guildName=e.guildName,this.guildId=e.guildId,this.protoName="",this.direction=game.Direction.Down,this.loginPosition=cc.v2(e.pos.x,e.pos.y),e.player&&(this.name=e.player.name,this.dujie=e.player.dujie,this.head=e.player.head),e.stat&&this.spriteStat.setup(e.stat),this.heroModel.clear(),this.heroModel.setup(e.appearance),this.avatarInfo.setup(this.heroModel),this.buffSet.setup(e.buffs),this.isRiding=e.isRiding,this.guildId=e.guildId,this.guildName=e.guildName,this.isHasGuild=0<this.guildId,this.defaultModelId=e.conid},setupMineData:function(e){this.playerId=e.id,this.defaultModelId=e.sceneUnit.conid,this.head=e.head,this.setHeroData(e.sceneUnit),this.setHeroEquipData(e.equip),this.exp=e.exp,e.stat&&this.baseSpriteStat.setup(e.stat),this.guildId=e.guildId,this.guildName=e.guildName,this.isHasGuild=0<this.guildId,this.gmPrivilege=0!=e.gmPrivilege},setHeroEquipData:function(e){if(this.equipSlotsMap.clear(),e&&e.slots&&0<e.slots.length){e.slots.sort(this.onSort);for(var t,i,n,s,a=game.mainRole.mainRoleData.getLv(),o=0;o<e.slots.length;o++){var r=e.slots[o];if(r){if(r.item?(i=game.ItemInfoUtil.createItemInfo(r.item),(t=new game.EquipSlotInfo(i.type,i.id)).equip=i):(t=new game.EquipSlotInfo(r.type)).equip=null,t.rate=r.rate,t.slotIndex=o,t.slotLevel=r.level,t.slotStar=r.star,t.attrId=game.ccfg.EquipSlotIntensifyCfg.getIntensifyAttrId(t.slotType,r.level),(n=game.ccfg.SpriteStatCfg.getSpriteStatById(t.attrId))&&(t.intensifySpriteStat=n,t.intensifySpriteStat?t.intensifyPower=game.CCommonUtil.getPower(t.intensifySpriteStat,a):t.intensifyPower=0),t.equip&&(s=game.ccfg.EquipSlotStarCfg.getEquipSlotStarInfoById(t.slotStar))?t.upStarPower=game.CCommonUtil.getPower(t.equip.baseSpriteStat,t.equip.level,s.attrRate):t.upStarPowe=0,t.enchant=r.enchant,t.enchant){var h=game.ccfg.EquipSlotEnchantCfg.getDataId(t.slotType,t.enchant),g=game.ccfg.EquipSlotEnchantCfg.getAttrById(h);(n=game.ccfg.SpriteStatCfg.getSpriteStatById(g))?(t.enchantSpriteStat=n,t.enchantPower=game.CCommonUtil.getPower(t.enchantSpriteStat,a)):t.enchantPower=0}this.equipSlotsMap.set(t.slotType,t)}}}},setOthersData:function(e){e&&(this.defaultModelId=e.oriProtoId,this._wing_lv=e.wingLv,this._mount_lv=e.mountLv,this._fabao_lv=e.fabaoLv,this._xianzhen_lv=e.xianzhenLv,this.setHeroEquipData(e.equip),this.quality_taoz_id=e.equip.qualityTaozId,this.star_taoz_id=e.equip.starTaozId,this.guildName=e.guildName,this.name=e.roleName,this.dujie=e.dujieLevel,e.stat&&this.baseSpriteStat.setup(e.stat))},onSort:function(e,t){return e.type>t.type?1:e.type<t.type?-1:0},getName:function(){return this.name},getExp:function(){return this.exp},getZhanLi:function(){return this.baseSpriteStat?this.baseSpriteStat.getStatValue(game.SpriteStatType.POWER):0},isInOriginalShape:function(){return this.defaultModelId==this.modelId},getResId:function(){return game.ccfg.HeroCfg.getResIdById(this.modelId)},getPkMode:function(){return this.pkMode},getVipLv:function(){return this.vipLevel},setPkMode:function(e){this.pkMode=e},setVipLv:function(e){this.vipLevel=e},setLine:function(e){this.line=e},isHasGuild:{get:function(){return this._isHasGuild},set:function(e){this._isHasGuild=e}},sex:{get:function(){return 1002==this.defaultModelId?game.Sex.WOMAN:game.Sex.MAN}},reset:function(){this.equipSlotsMap?this.equipSlotsMap.clear():this.equipSlotsMap=b8e.HashMap.get(),this.miscData||(this.miscData=new game.MiscData),this.heroModel?this.heroModel.clear():this.heroModel=new game.HeroModel,this._super()},restore:function(){this._super(),this.reset(),game.HeroData.count++},recycle:function(){this.reset(),this._super(),game.HeroData.count--},release:function(){game.HeroData.put(this)},dispose:function(){this.equipSlotsMap&&(this.equipSlotsMap.destroy(),this.equipSlotsMap=null),this.heroModel&&(this.heroModel.clear(),this.heroModel=null),this.miscData&&(this.miscData=null),this._super()},destroy:function(){this.dispose(),this._super()}}),game.HeroData.count=0,game.HeroData.pool=new b8e.Pool(game.HeroData,1024),game.HeroData.get=function(){return game.HeroData.pool.get()},game.HeroData.put=function(e){return e=game.HeroData.pool.put(e)}},{}],1436:[function(e,t,i){"use strict";game.HeroModel=b8e.Object.extends({_heroModel:null,setup:function(e){this._heroModel=e,this._heroModel||(this._heroModel={bodyId:this.bodyId,mountLv:this.mountLv,wingLv:11,cornucopiaIsBoom:this.cornucopiaIsBoom,nickname:this.nickname,surface:this.surface,beauty:this.beauty,ornamentId:this.ornamentId})},getBodyResId:function(){return this._heroModel.bodyId},getBodyRes:function(){return 0!=this._heroModel.bodyId?game.ccfg.HeroCfg.getResIdById(this._heroModel.bodyId):0},getMountResId:function(){return this._heroModel?this._heroModel.mountLv:0},getWingResId:function(){return this._heroModel?this._heroModel.wingLv:0},getFaBaoResId:function(){return this._heroModel?this._heroModel.fabaoLv:0},getXianZhenResId:function(){return this._heroModel?this._heroModel.xianzhenLv:0},getCornucopiaIsBoom:function(){return!!this._heroModel&&this._heroModel.cornucopiaIsBoom},getSurface:function(){return this._heroModel.surface},getNickName:function(){return this._heroModel?this._heroModel.nickname:0},getBeautyResId:function(){return this._heroModel?this._heroModel.beauty:0},getExpCureState:function(){return this._heroModel?this._heroModel.expCureState:0},getOrnamentId:function(){return this._heroModel?this._heroModel.ornamentId:0},clear:function(){this._heroModel=null}})},{}],1437:[function(e,t,i){"use strict";game.MiscData=b8e.Object.extends({loginTime:0,totalOnlineTime:0,loginDay:0,dailyOnlineTime:0,openServerDay:0,setupServerData:function(e){this.openServerDay=e.startServerDay},setup:function(e){e&&(this.loginTime=e.loginTime,this.loginDay=e.loginDay,this.totalOnlineTime=e.totalOnlineTime,this.dailyOnlineTime=e.dailyOnlineTime)}})},{}],1438:[function(e,t,i){"use strict";game.MonsterData=game.BaseRoleData.extends({ctor:function(){this._super(),this.type=game.RoleType.Monster,game.MonsterData.count++},setMonsterData:function(e){this.modelId=e.conid,this.id=e.id,this.direction=game.Direction.Down,this.loginPosition=cc.v2(e.pos.x,e.pos.y);var t=game.ccfg.MonsterCfg.getMonsterModelById(this.modelId);this.name=t.name,this.buffSet.setup(e.buffs),e.stat&&this.spriteStat.setup(e.stat),this.spriteStat.setStatValue(game.SpriteStatType.LV,t.level)},getMonsterType:function(){var e=game.ccfg.MonsterCfg.getMonsterModelById(this.modelId);return e?e.type:0},getResId:function(){var e=game.ccfg.MonsterCfg.getMonsterModelById(this.modelId);return e?e.model:0},getMonsterHeadId:function(){var e=game.ccfg.MonsterCfg.getMonsterModelById(this.modelId);return b8e.log(e.Headportrait),e.Headportrait},getConfigScale:function(){return game.ccfg.MonsterCfg.getMonsterModelById(this.modelId).scale/100},restore:function(){game.MonsterData.count++,this._super()},recycle:function(){game.MonsterData.count--,this._super()},release:function(){game.MonsterData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.MonsterData.count=0,game.MonsterData.pool=new b8e.Pool(game.MonsterData,1024),game.MonsterData.get=function(){return game.MonsterData.pool.get()},game.MonsterData.put=function(e){return e=game.MonsterData.pool.put(e)}},{}],1439:[function(e,t,i){"use strict";game.MonsterType=b8e.Enum({Mon1:0,Mon2:1,BOSS:2,WORLD_BOSS:3})},{}],1440:[function(e,t,i){"use strict";game.NpcData=game.BaseRoleData.extends({dialogRange:0,dialogId:0,bodyRes:"",mountResId:0,wingResId:0,faBaoResId:0,ctor:function(){this._super(),this.type=game.RoleType.Npc},setNpcCfg:function(e){this.id=e.id,this.direction=e.direction,this.loginPosition=cc.v2(e.pos.X,e.pos.Y),this.name=e.name,this.scale=e.scale/100,this.dialogRange=e.dialogRange,this.dialogId=e.dialogId,this.bodyRes=e.bodyRes,this.mountResId=e.mountResId,this.wingResId=e.wingResId,this.faBaoResId=e.faBaoResId},restore:function(){this._super()},recycle:function(){this._super()},release:function(){game.NpcData.put(this)},dispose:function(){this._super()},destroy:function(){this.dispose(),this._super()}}),game.NpcData.pool=new b8e.Pool(game.NpcData,1024),game.NpcData.get=function(){return game.NpcData.pool.get()},game.NpcData.put=function(e){return e=game.NpcData.pool.put(e)}},{}],1441:[function(e,t,i){"use strict";game.RoleType=b8e.Enum({None:0,Hero:1,Monster:2,Npc:3,Door:4,DropItem:5,Effect:6,Follower:7,FlyEffect:8,Beauty:9,ClientEntity:10,Ornament:11,UIRole:1001})},{}],1442:[function(e,t,i){"use strict";game.Sex=b8e.Enum({MAN:1,WOMAN:2})},{}],1443:[function(e,t,i){"use strict";game.SpriteStatType=b8e.Enum({NONE:0,HP:1,MAXHP:2,MAXHP_BONUS_COEF:3,ATK:4,ATK_BONUS_COEF:5,DEF:6,DEF_BONUS_COEF:7,DMG_BONUS_COEF:8,DMG_REDUCTION_COEF:9,DMG_BONUS:10,DMG_REDUCTION:11,HIT:12,HIT_RATE:13,DODGE:14,DODGE_RATE:15,CRIT:16,CRIT_RATE:17,CRIT_COEF:18,CRIT_REDUCTION:19,CRIT_REDUCTION_RATE:20,CRIT_REDUCTION_COEF:21,CD_REDUCTION_COEF:22,MOVE_SPEED:23,HP_RECOVERY:24,DMG_BONUS_COEF_JIN:25,DMG_BONUS_COEF_MU:26,DMG_BONUS_COEF_SHUI:27,DMG_BONUS_COEF_HUO:28,DMG_BONUS_COEF_TU:29,DMG_REDUCTION_COEF_JIN:30,DMG_REDUCTION_COEF_MU:31,DMG_REDUCTION_COEF_SHUI:32,DMG_REDUCTION_COEF_HUO:33,DMG_REDUCTION_COEF_TU:34,DMG_BONUS_COEF_TO_JIN:35,DMG_BONUS_COEF_TO_MU:36,DMG_BONUS_COEF_TO_SHUI:37,DMG_BONUS_COEF_TO_HUO:38,DMG_BONUS_COEF_TO_TU:39,POWER:40,LV:41})},{}],1444:[function(e,t,i){"use strict";e("./RoleType"),e("./Direction"),e("./BaseRoleData"),e("./HeroModel"),e("./AvatarInfo"),e("./BaseRoleData"),e("./DoorData"),e("./DropData"),e("./HeroData"),e("./NpcData"),e("./ClientEntityData"),e("./MonsterData"),e("./MonsterType"),e("./SpriteStatType"),e("./FollowerData"),e("./Sex")},{"./AvatarInfo":1427,"./BaseRoleData":1428,"./ClientEntityData":1429,"./Direction":1430,"./DoorData":1431,"./DropData":1432,"./FollowerData":1434,"./HeroData":1435,"./HeroModel":1436,"./MonsterData":1438,"./MonsterType":1439,"./NpcData":1440,"./RoleType":1441,"./Sex":1442,"./SpriteStatType":1443}],1445:[function(e,t,i){"use strict";game.BaozhuAwardRecord=b8e.Object.extends({name:"",id:0,ctor:function(){this._super()},setup:function(e){this.name=e.name,this.id=e.id}})},{}],1446:[function(e,t,i){"use strict";game.BaozhuItemInfo=b8e.Object.extends({maxRecordNum:20,records:null,ctor:function(){this._super(),this.records=[]},setup:function(e){this.records=[];for(var t=0;t<e.length&&t<this.maxRecordNum;++t){var i=new game.BaozhuAwardRecord;i.setup(e[t]),this.records.push(i)}},getRecords:function(){return this.records},addRecord:function(e){if(e){var t=new game.BaozhuAwardRecord;t.setup(e),this.records.length>=this.maxRecordNum&&this.records.shift(),this.records.push(t)}}})},{}],1447:[function(e,t,i){"use strict";game.DuoBaoInfo=b8e.Object.extends({activitySubType:0,duoBaoList:null,ctor:function(){this._super(),this.duoBaoList=[]},setup:function(e){this.activitySubType=e.activitySubType,this.duoBaoList=e.duoBaoList}})},{}],1448:[function(e,t,i){"use strict";game.ZhuanPanInfo=b8e.Object.extends({activitySubType:0,zhuanPanCount:0,dailyFreeUsed:!1,awardRecord:null,positions:null,ctor:function(){this._super(),this.awardRecord=[]},setup:function(e){this.activitySubType=e.activitySubType,this.zhuanPanCount=e.zhuanPanCount,this.dailyFreeUsed=e.zhuanPanDailyFreeUsed,this.awardRecord=e.zhuanPanCountAwardRecord,this.positions=e.positions}})},{}],1449:[function(e,t,i){"use strict";game.RuneGroupType=b8e.Enum({HP:0,ATK:1,DEF:2,HIT:3,DODGE:4,CRIT:5,CRIT_DMG:6,CRIT_REDUCTION:7,CRIT_REDUCTION_DMG:8,WUXING_DMG_REDUCTION:9})},{}],1450:[function(e,t,i){"use strict";game.RuneInfo=game.BaseInfo.extends({idx:0,id:0,runeSuitId:0,targetSlot:0,layer:0,group:0,ctor:function(){},setup:function(e){this.idx=e.idx,this.id=e.id,e.targetBianshenIdx&&b8e.warn("符文已无bianshenId"),this.runeSuitId=e.slotIndex,this.targetSlot=e.targetSlot;var t=game.ccfg.RuneCfg.getRuneDataById(this.id);t&&(this.type=t.type,this.level=t.level,this.quality=t.quality,this.iconName=t.iconName,this.name=t.name,this.layer=t.layer,this.group=t.group)},setupByCfg:function(e){this.id=e.id,this.type=e.type,this.level=e.level,this.quality=e.quality,this.iconName=e.iconName,this.name=e.name,this.layer=e.layer,this.group=e.group},reset:function(){this.targetSlot=0}})},{}],1451:[function(e,t,i){"use strict";game.RuneSlotStateType=b8e.Enum({LOCK:0,UNLOCK_N:1,UNLOCK_Y:2})},{}],1452:[function(e,t,i){"use strict";e("./RuneInfo")},{"./RuneInfo":1450}],1453:[function(e,t,i){"use strict";game.SceneType=b8e.Enum({NORMAL:-1,DUNGEON:-1,HUANJING:-1,ARENA:-1,SURA:-1,WORLDBOSS:-1,NATIONALBOSS:-1,TIANGONG:-1,TEAM_BOSS:-1,DUJIEBOSS:-1,TOWER:-1,MAIN_QUEST_DUNGEON:-1})},{}],1454:[function(e,t,i){"use strict";e("./SceneType")},{"./SceneType":1453}],1455:[function(e,t,i){"use strict";game.ShapeData=b8e.Object.extends({id:0,durationEndTime:0,cdEndTime:0,isIn:!1})},{}],1456:[function(e,t,i){"use strict";e("./ShapeData")},{"./ShapeData":1455}],1457:[function(e,t,i){"use strict";game.ShopGoodInfo=b8e.Object.extends({id:0,count:0,dailyTimes:0,goodsId:0,items:0,sortId:0,needDujieLv:0,dujieType:0,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.goodsId=e.goodsId,this.items=e.items,this.sortId=e.sortId,this.needDujieLv=e.dujieLevel,0<this.needDujieLv?this.dujieType=(this.needDujieLv+2)/3|0:b8e.error("渡劫等级<=0?"))}})},{}],1458:[function(e,t,i){"use strict";game.ShopType=b8e.Enum({Item:0,BianShen:1,Mystery:2,Honour:3})},{}],1459:[function(e,t,i){"use strict";e("./ShopType")},{"./ShopType":1458}],1460:[function(e,t,i){"use strict";game.CastSpellInfo=b8e.Object.extends({spellData:null,targetId:0,releasePos:null,direction:0,range:0})},{}],1461:[function(e,t,i){"use strict";game.ReleaseSpellInfo=b8e.Object.extends({releaseSpellId:0,releaseEntityType:0,releaseEntityId:0,releasePosX:0,releasePosY:0,direction:0,targetId:0,targetIds:null,ctor:function(){this._super()},clear:function(){this.releaseSpellId=0,this.releaseEntityType=0,this.releaseEntityId=0,this.releasePosX=0,this.releasePosY=0,this.direction=0,this.targetId=0,this.targetIds=null},release:function(){this.clear()}}),game.ReleaseSpellInfo.get=function(){return new game.ReleaseSpellInfo}},{}],1462:[function(e,t,i){"use strict";game.SkillData=b8e.Object.extends({protoId:0,maxDistance:0,cdDuration:0,applyStartTime:0,hpDelta:0,cdFinishTime:0,isNormalSpell:!1,_isRecycled:!1,_isDisposed:!1,ctor:function(){this._super(),this._isRecycled=!1,this._isDisposed=!1},clear:function(){this.protoId=0,this.maxDistance=0,this.cdDuration=0,this.applyStartTime=0,this.hpDelta=0,this.cdFinishTime=0,this.isNormalSpell=!1},restore:function(){this._isRecycled=!1,this.clear()},recycle:function(){this._isRecycled=!0,this.clear()},release:function(){game.SkillData.put(this)},dispose:function(){this._isRecycled=!1,this._isDisposed=!0},destroy:function(){this.recycle(),this.dispose()}}),game.SkillData.pool=new b8e.Pool(game.SkillData,128),game.SkillData.get=function(){return game.SkillData.pool.get()},game.SkillData.put=function(e){return e=game.SkillData.pool.put(e)}},{}],1463:[function(e,t,i){"use strict";game.SkillIconType=b8e.Enum({TYPE_A:0,TYPE_B:1,TYPE_C:2,TYPE_D:3,TYPE_BEAUTY:4,TYPE_WING_SKILL:5,TYPE_ORNAMENT_SKILL:6})},{}],1464:[function(e,t,i){"use strict";e("./CastSpellInfo"),e("./ReleaseSpellInfo"),e("./SkillData"),e("./SkillIconType")},{"./CastSpellInfo":1460,"./ReleaseSpellInfo":1461,"./SkillData":1462,"./SkillIconType":1463}],1465:[function(e,t,i){"use strict";game.AttrRulesInfo=b8e.Object.extends({type:0,name:"",attrType:0,format:0,sort:0,ctor:function(){this._super()}})},{}],1466:[function(e,t,i){"use strict";game.SpriteStat=b8e.Object.extends({dataHashMap:null,_isDisposed:!1,_isRecycled:!1,ctor:function(e){this._super(),this.dataHashMap=b8e.HashMap.get(),e&&e.stats&&this.setup(e)},setup:function(e){if(this.dataHashMap.clear(),e&&e.stats)for(var t=0;t<e.stats.length;t++){var i=new game.StatData(e.stats[t]);this.dataHashMap.set(i.type,i)}},initDefault:function(){var e=[game.SpriteStatType.HP,game.SpriteStatType.ATK,game.SpriteStatType.DEF,game.SpriteStatType.HIT,game.SpriteStatType.CRIT,game.SpriteStatType.DODGE,game.SpriteStatType.CRIT_REDUCTION];this.clearSpriteSatats();for(var t=0;t<e.length;t++){var i=new game.StatData;i.setData(e[t],0),this.dataHashMap.set(i.type,i)}},update:function(e){if(e&&e.stats)for(var t=0;t<e.stats.length;t++){var i=e.stats[t];this.setStatValue(i.type,i.value)}},getStatDataByType:function(e){return this.dataHashMap.get(e)},addStatData:function(e){if(e){var t=this.getStatValue(type);t+=e.value,this.setStatValue(e.type,t)}},setStatData:function(e){e&&this.dataHashMap.set(e.type,e)},setStatValue:function(e,t){t<0&&(b8e.log("statData.type",e,"value",t,"小于0了，默认修复到0"),t=0);var i=this.dataHashMap.get(e);i||(i=new game.StatData,this.dataHashMap.set(e,i)),i.setData(e,t)},getStatValue:function(e){var t=this.dataHashMap.get(e);return t?t.value:0},getSpriteStats:function(){return this.dataHashMap.values()},clearSpriteSatats:function(){this.dataHashMap.clear()},addSpriteStat:function(e){if(e){var t=e.getSpriteStats();if(t&&0!=t.length)for(var i=0;i<t.length;i++){var n=t[i],s=this.getStatValue(n.type);s+=n.value,this.setStatValue(n.type,s)}}},clone:function(){var i=game.SpriteStat.get();return this.dataHashMap.forEach(function(e,t){i.setStatValue(e,this.getStatValue(e))},this),i},restore:function(){this._isRecycled=!1},recycle:function(){this.dataHashMap&&this.dataHashMap.clear(),this._isRecycled=!0},release:function(){game.SpriteStat.put(this)},dispose:function(){this.dataHashMap&&(this.dataHashMap.destroy(),this.dataHashMap=null),this._isDisposed=!0,this._isRecycled=!1},destroy:function(){this.dispose()}}),game.SpriteStat.pool=new b8e.Pool(game.SpriteStat,1024),game.SpriteStat.get=function(e,t){return game.SpriteStat.pool.get(e,t)},game.SpriteStat.put=function(e){return e=game.SpriteStat.pool.put(e)}},{}],1467:[function(e,t,i){"use strict";game.StatData=b8e.Object.extends({type:0,value:0,ctor:function(e){this._super(),this.setup(e)},setup:function(e){e&&(this.type=e.type,this.value=e.value)},setData:function(e,t){this.type=e,this.value=t}})},{}],1468:[function(e,t,i){"use strict";e("./SpriteStat"),e("./StatData")},{"./SpriteStat":1466,"./StatData":1467}],1469:[function(e,t,i){"use strict";game.StrengthenAttInfo=b8e.Object.extends({score:0,grade:"",fonts:"",enum:"",partPower:"",ctor:function(){this._super()}})},{}],1470:[function(e,t,i){"use strict";game.StrengthenInfo=b8e.Object.extends({kindId:0,id:0,title:"",goto:"",iconName:"",score:0,grade:"",partPower:"",openId:0,ctor:function(){this._super()}})},{}],1471:[function(e,t,i){"use strict";e("./StrengthenInfo"),e("./StrengthenAttInfo")},{"./StrengthenAttInfo":1469,"./StrengthenInfo":1470}],1472:[function(e,t,i){"use strict";game.SuraDefeatInfo=b8e.Object.extends({killer_id:0,killer_name:null,paid_relive_price:0,auto_relive_ts:0,ctor:function(){this._super()},setup:function(e){e&&(this.killer_id=e.killerId,this.killer_name=e.killerName,this.paid_relive_price=e.paidRelivePrice,this.auto_relive_ts=e.autoReliveTs)}})},{}],1473:[function(e,t,i){"use strict";game.SuraEndInfo=b8e.Object.extends({type:0,level_id:0,rank_entries:null,myRank:0,myScore:0,myTotalKillTimes:0,myTotalDieTimes:0,myMaxSuccessiveKillTimes:0,myGuildRank:0,guildRankEntries:null,ctor:function(){this._super(),this.rank_entries=[],this.guildRankEntries=[]},setup:function(e){if(e){this.level_id=e.levelId,this.myRank=e.myRank,this.myScore=e.myScore,this.myTotalKillTimes=e.myTotalKillTimes,this.myTotalDieTimes=e.myTotalDieTimes,this.myMaxSuccessiveKillTimes=e.myMaxSuccessiveKillTimes;for(var t=this.rank_entries.length=0;t<e.rankEntries.length;++t){(i=new game.SuraScoreRankEntry).setup(e.rankEntries[t]),i.type=0,this.rank_entries.push(i)}this.myGuildRank=e.myGuildRank;for(t=this.guildRankEntries.length=0;t<e.guildRankEntries.length&&t<5;++t){var i;(i=new game.SuraGuildScoreRankEntry).setup(e.guildRankEntries[t]),i.type=game.SuraType.CS_ENDGUILDRANK_TYPE,this.guildRankEntries.push(i)}}},getRankData:function(){return this.rank_entries},getGuildRankEntries:function(){return this.guildRankEntries}})},{}],1474:[function(e,t,i){"use strict";game.SuraGuildScoreRankEntry=b8e.Object.extends({type:2,rank:0,score:0,guildId:0,guildName:null,masterName:null,zone:null,ctor:function(){this._super()},setup:function(e){e&&(this.rank=e.rank,this.score=e.score,this.guildId=e.guildId,this.guildName=e.guildName,this.masterName=e.masterName,this.zone="s"+e.zone)}})},{}],1475:[function(e,t,i){"use strict";game.SuraKillInfo=b8e.Object.extends({killNumber:0,killScore:0,killBulletin:null,killedBulletin:null,ctor:function(){this._super()},setup:function(e){e?(this.killNumber=e.killNumber,this.killScore=e.killScore,this.killBulletin=e.killBulletin,this.killedBulletin=e.killedBulletin):b8e.log("读取配置表失败")}})},{}],1476:[function(e,t,i){"use strict";game.SuraLevelData=b8e.Object.extends({_level_id:0,_rank_entries:null,_my_rank:0,_buffEffectCoef:0,myGuildRank:0,guildRankEntries:null,myGuildScore:0,ctor:function(){this._super(),this._rank_entries=[],this.guildRankEntries=[]},setup:function(e){if(e){this._rank_entries.length=0,this._level_id=e.levelId;for(var t=0;t<e.rankEntries.length;++t){var i=new game.SuraScoreRankEntry;i.setup(e.rankEntries[t]),this._rank_entries.push(i)}if(this._my_rank=e.myRank,e.buffEffectCoef){var n=Math.round(100*e.buffEffectCoef);this._buffEffectCoef=n}else this._buffEffectCoef=0;this.myGuildRank=e.myGuildRank;for(t=this.guildRankEntries.length=0;t<e.guildRankEntries.length;++t){var s=new game.SuraGuildScoreRankEntry;s.setup(e.guildRankEntries[t]),this.myGuildRank==s.rank&&(this.myGuildScore=s.score),this.guildRankEntries.push(s)}}},getBuffCoef:function(){return this._buffEffectCoef}})},{}],1477:[function(e,t,i){"use strict";game.SuraLevelInfo=b8e.Object.extends({id:0,name:null,sceneId:0,upScore:0,downScore:0,ctor:function(){this._super()},setup:function(e){e?(this.id=e.id,this.name=e.name,this.sceneId=e.sceneId,this.upScore=e.upScore,this.downScore=e.downScore):b8e.log("读取配置表失败")}})},{}],1478:[function(e,t,i){"use strict";game.SuraLevelPrizeInfo=b8e.Object.extends({index:0,prizeDropId:0,ctor:function(){this._super()}})},{}],1479:[function(e,t,i){"use strict";game.SuraLevelType=b8e.Enum({NONE:0,LEVEL_1:1,LEVEL_2:2,LEVEL_3:3})},{}],1480:[function(e,t,i){"use strict";game.SuraOvervieInfo=b8e.Object.extends({_status:0,_player_number:0,endTs:0,server_open_days:0,ctor:function(){this._super()},setup:function(e){e&&(this._status=e.status,this._player_number=e.playerNumber,this.endTs=e.endTs,this.server_open_days=e.serverOpenDays)}})},{}],1481:[function(e,t,i){"use strict";game.SuraPrizeInfo=b8e.Object.extends({id:0,zoneOpenDays:0,displayDrop:0,levelDrops:null,rankDrops:null,ctor:function(){this._super(),this.displayRewardItems=[],this.levelDrops=[],this.rankDrops=[]},setup:function(e){this.id=e.id,this.zoneOpenDays=e.zoneOpenDays,this.levelDrops=[],this.rankDrops=[],this.displayDrop=e.displayDrop;for(var t=0;t<e.levelDrops.length;t++){var i=new game.SuraLevelPrizeInfo;i.index=t+1,i.prizeDropId=e.levelDrops[t],this.levelDrops.push(i)}for(t=0;t<e.rankDrops.length;t++){var n=new game.SuraRankPrizeInfo;n.rank=t+1,n.prizeDropId=e.rankDrops[t],this.rankDrops.push(n)}}})},{}],1482:[function(e,t,i){"use strict";game.SuraRankPrizeInfo=b8e.Object.extends({rank:0,prizeDropId:0,ctor:function(){this._super()}})},{}],1483:[function(e,t,i){"use strict";game.SuraScoreInfo=b8e.Object.extends({levelData:null,type:0})},{}],1484:[function(e,t,i){"use strict";game.SuraScoreRankEntry=b8e.Object.extends({type:0,_rank:0,_score:0,_role_id:0,_role_name:null,totalKillTimes:0,totalDieTimes:0,maxSuccessiveKillTimes:0,zone:null,ctor:function(){this._super()},setup:function(e){this._rank=e.rank,this._score=e.score,this._role_id=e.roleId,this._role_name=e.roleName,this.totalKillTimes=e.totalKillTimes,this.totalDieTimes=e.totalDieTimes,this.maxSuccessiveKillTimes=e.maxSuccessiveKillTimes,this.zone="s"+e.zone}})},{}],1485:[function(e,t,i){"use strict";game.SuraScoreUpdateInfo=b8e.Object.extends({_changeScore:0,_score:0,ctor:function(){this._super()},setup:function(e){e&&(this._changeScore=e.score-this._score,this._score=e.score)},clearData:function(){this._changeScore=0,this._score=0}})},{}],1486:[function(e,t,i){"use strict";game.SuraStatus=b8e.Enum({NONE:0,CLOSE:1,OPEN:2,END:3})},{}],1487:[function(e,t,i){"use strict";e("./SuraDefeatInfo"),e("./SuraKillInfo"),e("./SuraLevelData"),e("./SuraLevelInfo"),e("./SuraLevelPrizeInfo"),e("./SuraLevelType"),e("./SuraOvervieInfo"),e("./SuraPrizeInfo"),e("./SuraRankPrizeInfo"),e("./SuraScoreRankEntry"),e("./SuraScoreUpdateInfo"),e("./SuraStatus"),e("./SuraEndInfo")},{"./SuraDefeatInfo":1472,"./SuraEndInfo":1473,"./SuraKillInfo":1475,"./SuraLevelData":1476,"./SuraLevelInfo":1477,"./SuraLevelPrizeInfo":1478,"./SuraLevelType":1479,"./SuraOvervieInfo":1480,"./SuraPrizeInfo":1481,"./SuraRankPrizeInfo":1482,"./SuraScoreRankEntry":1484,"./SuraScoreUpdateInfo":1485,"./SuraStatus":1486}],1488:[function(e,t,i){"use strict";game.SurfaceConditionType=b8e.Enum({None:0,EquipStar:1})},{}],1489:[function(e,t,i){"use strict";game.SurfaceType=b8e.Enum({Fashion:0,NickName:1,Ornament:2})},{}],1490:[function(e,t,i){"use strict";e("./SurfaceConditionType"),e("./SurfaceType")},{"./SurfaceConditionType":1488,"./SurfaceType":1489}],1491:[function(e,t,i){"use strict";game.AllTeamInfo=b8e.Object.extends({insId:0,teams:null,ctor:function(){this._super(),this.teams=[]},setup:function(e){if(e){this.insId=e.insId;for(var t=this.teams.length=0;t<e.datas.length;++t){var i=new game.Team;i.setup(e.datas[t]),this.teams.push(i)}0!=this.teams.length&&this.teams.sort(this.sortTeams)}},sortTeams:function(e,t){return e.state-t.state}})},{}],1492:[function(e,t,i){"use strict";game.LeaveTeamType=b8e.Enum({INITIATIVE:0,KICK:1})},{}],1493:[function(e,t,i){"use strict";game.MemberRelationType=b8e.Enum({NONE:0,FRIEND:2,GUILD:1})},{}],1494:[function(e,t,i){"use strict";game.Team=b8e.Object.extends({id:0,insId:0,leader:0,leaderName:null,members:null,state:0,count:0,ctor:function(){this._super(),this.members=[]},setup:function(e){if(e&&(this.id=e.id,this.insId=e.insId,this.leader=e.leader,this.leaderName=e.leaderName,this.state=e.state,this.count=e.count,this.members.length=0,e.members))for(var t=0;t<e.members.length;++t){var i=new game.TeamMember;i.setup(e.members[t]),this.members.push(i)}},addMember:function(e){if(e){var t=new game.TeamMember;t.setup(e),this.members.push(t)}},getNameById:function(e){if(!e)return"";for(var t=0;t<this.members.length;++t)if(e==this.members[t].id)return this.members[t].name},leaveMember:function(e){if(e)for(var t=0;t<this.members.length;++t)if(e==this.members[t].id)return void this.members.splice(t,1)},changeLeader:function(e){if(e){this.leader=e;for(var t=0;t<this.members.length;++t)if(e==this.members[t].id)return void(this.leaderName=this.members[t].name)}},getLeaderId:function(){return this.leader}})},{}],1495:[function(e,t,i){"use strict";game.TeamMember=b8e.Object.extends({id:0,name:null,head:null,level:0,power:0,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.name=e.name,this.head=e.head,this.level=e.level,this.power=e.power)}})},{}],1496:[function(e,t,i){"use strict";game.TeamModule=b8e.Object.extends({firstAwardIds:null,awardNum:0,buyAwardNum:0,ctor:function(){this._super(),this.firstAwardIds=[]},setup:function(e){if(e){for(var t=this.firstAwardIds.length=0;t<e.firstAwardIds.length;++t)this.firstAwardIds.push(e.firstAwardIds[t]);this.awardNum=e.awardNum,this.buyAwardNum=e.buyAwardNum}},getFirstAwardIds:function(){return this.firstAwardIds?this.firstAwardIds:null},addFirstAwardId:function(e){this.firstAwardIds&&e&&this.firstAwardIds.push(e)}})},{}],1497:[function(e,t,i){"use strict";game.TeamRecommendData=b8e.Object.extends({id:0,name:null,head:null,level:0,power:0,relation:0,nextInviteTime:0,times:30,isInvite:!1,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.name=e.name,this.head=e.head,this.level=e.level,this.power=e.power,this.relation=e.relation,this.nextInviteTime=e.nextInviteTime,this.isInvite=0<this.nextInviteTime)},setBeInVite:function(){this.nextInviteTime=game.SysTime.curTime+1e3*this.times+300,this.isInvite=!0}})},{}],1498:[function(e,t,i){"use strict";game.TeamState=b8e.Enum({WAIT:0,ENTER:1})},{}],1499:[function(e,t,i){"use strict";e("./AllTeamInfo"),e("./LeaveTeamType"),e("./MemberRelationType"),e("./Team"),e("./TeamMember"),e("./TeamModule"),e("./TeamRecommendData"),e("./TeamState")},{"./AllTeamInfo":1491,"./LeaveTeamType":1492,"./MemberRelationType":1493,"./Team":1494,"./TeamMember":1495,"./TeamModule":1496,"./TeamRecommendData":1497,"./TeamState":1498}],1500:[function(e,t,i){"use strict";game.TianGongBattleInfo=b8e.Object.extends({state:0,collectionOpenTime:0,guildInfo:null,collector:null,ctor:function(){this._super()},setData:function(e){e&&(this.state=e.state,this.collectionOpenTime=e.collectionOpenTime,1==this.state&&e.master&&(this.guildInfo||(this.guildInfo=new game.TianGongGuildInfo),this.guildInfo.setData(e.master)),2==this.state&&e.collector&&(this.collector||(this.collector=new game.TianGongCollectorInfo),this.collector.setData(e.collector)))}})},{}],1501:[function(e,t,i){"use strict";game.TianGongCollectorInfo=b8e.Object.extends({roleId:0,name:"",unitId:0,guildId:0,startTime:0,ctor:function(){this._super()},setData:function(e){e&&(this.roleId=e.roleId,this.name=e.name,this.unitId=e.unitId,this.guildId=e.guildId,this.startTime=e.startTime)}})},{}],1502:[function(e,t,i){"use strict";game.TianGongGuildInfo=b8e.Object.extends({id:0,name:"",masterId:0,masterName:"",protoId:0,surface:0,wing:0,ctor:function(){this._super()},setData:function(e){e&&(this.id=e.id,this.name=e.name,this.masterId=e.masterId,this.masterName=e.masterName,this.protoId=e.masterProtoid,this.surface=e.masterSurface,this.wing=e.masterWing)}})},{}],1503:[function(e,t,i){"use strict";game.TianGongInfo=b8e.Object.extends({isCrossServer:!1,isOpen:!1,endTime:0,guildInfo:null,isHasAward:!1,notice:"",noticeCount:0,lastNextOpenTime:0,nextOpenTime:0,crossServerAward:!1,crossServerRank:-1,crossServerRankAward:!1,ctor:function(){this._super()},setData:function(e){e&&(this.resetData(),this.isOpen=e.isOpen,this.endTime=e.endTime,e.master&&(this.guildInfo||(this.guildInfo=new game.TianGongGuildInfo),this.guildInfo.setData(e.master)),this.isCrossServer=e.crossServer,this.isHasAward=e.award,this.notice=e.notice,this.noticeCount=e.noticeCount,this.nextOpenTime=e.nextOpenTime,this.crossServerAward=e.crossServerAward,this.crossServerRank=e.crossServerRank,this.crossServerRankAward=e.crossServerRankAward)},resetData:function(){this.isCrossServer=!1,this.isOpen=!1,this.endTime=0,this.guildInfo=null,this.isHasAward=!1,this.notice="",this.noticeCount=0,this.lastNextOpenTime=0,this.nextOpenTime=0,this.crossServerAward=!1,this.crossServerRank=-1,this.crossServerRankAward=!1}})},{}],1504:[function(e,t,i){"use strict";game.TianGongLastInfo=b8e.Object.extends({guildInfo:null,guildRanks:null,playerRanks:null,ctor:function(){this._super(),this.guildRanks=[],this.playerRanks=[]},setData:function(e){e&&(e.master&&(this.guildInfo||(this.guildInfo=new game.TianGongGuildInfo),this.guildInfo.setData(e.master)),this.setGuildRanks(e),this.setPlayerRanks(e))},setGuildRanks:function(e){var t;if(0<this.guildRanks.length&&(this.guildRanks.length=0),e.guildRanks&&0<e.guildRanks.length)for(var i=0;i<e.guildRanks.length;i++){var n=e.guildRanks[i];n&&((t=new game.TianGongRankInfo).type=1,t.setData(n),this.guildRanks.push(t))}},setPlayerRanks:function(e){var t;if(0<this.playerRanks.length&&(this.playerRanks.length=0),e.playerRanks&&0<e.playerRanks.length)for(var i=0;i<e.playerRanks.length;i++){var n=e.playerRanks[i];n&&((t=new game.TianGongRankInfo).type=2,t.setData(n),this.playerRanks.push(t))}}})},{}],1505:[function(e,t,i){"use strict";game.TianGongRankInfo=b8e.Object.extends({type:0,rank:0,name1:"",name2:"",score:0,guildId:0,playerId:0,zone:0,bianshens:null,ctor:function(){this._super()},setData:function(e){e&&(this.rank=e.rank,this.name1=e.name1,this.name2=e.name2,this.score=e.score,this.guildId=e.guildId,this.playerId=e.playerId,this.zone=e.zone,this.bianshens=e.bianshens)}})},{}],1506:[function(e,t,i){"use strict";e("./TianGongInfo"),e("./TianGongGuildInfo"),e("./TianGongRankInfo"),e("./TianGongLastInfo"),e("./TianGongBattleInfo"),e("./TianGongCollectorInfo")},{"./TianGongBattleInfo":1500,"./TianGongCollectorInfo":1501,"./TianGongGuildInfo":1502,"./TianGongInfo":1503,"./TianGongLastInfo":1504,"./TianGongRankInfo":1505}],1507:[function(e,t,i){"use strict";game.LatelyInfo=b8e.Object.extends({name:null,level:0,rebirthLevel:0,power:0,bianshens:null,ctor:function(){this._super(),this.bianshens=[]},setup:function(e){e&&(this.name=e.name,this.level=e.level,this.rebirthLevel=e.rebirthLevel,this.power=e.power,this.bianshens=e.slots,this.bianshens.sort(this.sortBianshen))},sortBianshen:function(e,t){return e.slot<t.slot?-1:e.slot>t.slot?1:0}})},{}],1508:[function(e,t,i){"use strict";game.TowerInfo=b8e.Object.extends({insId:0,collect_count:1,latelyInfo:null,ctor:function(){this._super()},setup:function(e){e&&(this.insId=e.layer,this.collect_count=e.collectCount,this.latelyInfo||(this.latelyInfo=new game.LatelyInfo),this.latelyInfo.setup(e.latelyInfo))}})},{}],1509:[function(e,t,i){"use strict";game.SceneTransType=b8e.Enum({TYPE_NORMAL:1,TYPE_MAIN_QUEST:2,TYPE_TRUSTEESHIP:3,TYPE_TARGET_POS:4,TYPE_ZHANYAO:5})},{}],1510:[function(e,t,i){"use strict";e("./SceneTransType")},{"./SceneTransType":1509}],1511:[function(e,t,i){"use strict";game.CostItem=b8e.Object.extends({id:0,num:0,_isRecycled:!1,_isDisposed:!1,ctor:function(){this.constructor===game.CostItem&&(game.CostItem.poolCall||b8e.warn("强烈建议用game.CostItem.get代替new操作！")),this._super(),this._isRecycled=!1,this._isDisposed=!1,this.id=0,this.num=0},restore:function(){this._isRecycled=!1,this.id=0,this.num=0},recycle:function(){this._isRecycled=!0,this.id=0,this.num=0},release:function(){game.CostItem.put(this)},dispose:function(){this._isRecycled=!1,this._isDisposed=!0},destroy:function(){this.recycle(),this.dispose()}}),game.CostItem.pool=new b8e.Pool(game.CostItem,512),game.CostItem.get=function(){return game.CostItem.pool.get()},game.CostItem.put=function(e){return e=game.CostItem.pool.put(e)}},{}],1512:[function(e,t,i){"use strict";game.EmStringType=b8e.Enum({COMMA:"，",NEW_LINE:"<br/>",SPACE:" ",PLUS:" + ",SEMICOION:"；"})},{}],1513:[function(e,t,i){"use strict";game.UpgradeInfo=b8e.Object.extends({_costItemList:null,amountInfo:null,ctor:function(){this._super(),this._costItemList=[],this.amountInfo=new game.AmountInfo},setUpgradeInfo:function(e){if(e&&!(e.length<=0))for(var t,i=0;i<e.length;i++){var n=e[i];n&&(this.isCurrencyById(n.Id)?this.amountInfo&&this.amountInfo.setAmount(game.ccfg.ItemInfoCfg.getTypeById(n.Id),n.Num):((t=game.CostItem.get()).id=n.Id,t.num=n.Num,this._costItemList.push(t)))}},isCurrencyById:function(e){var t=!1,i=game.ccfg.ItemInfoCfg.getItemInfoById(e);if(i)switch(i.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.HONOUR:t=!0}return t},addCostItem:function(e,t){var i=game.CostItem.get();i.id=e,i.num=t,this._costItemList.push(i)},setAmount:function(e){e&&this.amountInfo.setData(e)},setData:function(e,t){this.amountInfo.setAmount(e,t)},getCostItemList:function(){return this._costItemList},getAmountInfo:function(){return this.amountInfo},getFirstUpgradeInfo:function(){if(this._costItemList&&0<this._costItemList.length){var e=this._costItemList[0];if(e)return e}return null},getFirstUpgradeInfoId:function(){if(this._costItemList&&0<this._costItemList.length){var e=this._costItemList[0];if(e)return e.id}return 0},getFirstUpgradeInfoName:function(){var e=this.getFirstUpgradeInfoId(),t=game.ccfg.ItemInfoCfg.getNameById(e);return t||(t="无"),t},getFirstUpgradeInfoNum:function(){var e=this.getFirstUpgradeInfo();return e?e.num:0},clear:function(){if(this._costItemList){for(var e=0;e<this._costItemList.length;e++){var t=this._costItemList[e];t&&game.CostItem.put(t)}this._costItemList.length=0}this.amountInfo&&this.amountInfo.clear()}})},{}],1514:[function(e,t,i){"use strict";e("./CostItem"),e("./UpgradeInfo"),e("./EmStringType")},{"./CostItem":1511,"./EmStringType":1512,"./UpgradeInfo":1513}],1515:[function(e,t,i){"use strict";game.MillionAwardData=b8e.Object.extends({maxrecordnum:30,surplusNum:0,records:null,ctor:function(){this._super(),this.records=[]},setup:function(e){this.records=[],this.surplusNum=e.surplusNum;for(var t=0;t<e.records.length&&t<this.maxrecordnum;++t){var i=new game.MillionAwardRecord;i.setup(e.records[t]),this.records.push(i)}},getRecords:function(){return this.records},addRecord:function(e){if(e){var t=new game.MillionAwardRecord;t.setup(e),this.records.length>=this.maxrecordnum&&this.records.shift(),this.records.push(t)}}})},{}],1516:[function(e,t,i){"use strict";game.MillionAwardRecord=b8e.Object.extends({name:"zzfcg",num:0,time:0,ctor:function(){this._super()},setup:function(e){this.name=e.name,this.num=e.num,this.time=e.time}})},{}],1517:[function(e,t,i){"use strict";game.WelfareInfo=b8e.Object.extends({convertGoldTimes:0,signId:0,signDays:0,hasSigned:!1,todayIsSign:!1,weekSignDays:0,weekLoginDays:0,weekEndTime:0,weekStartTime:0,today:0})},{}],1518:[function(e,t,i){"use strict";e("./WelfareInfo"),e("./MillionAwardData"),e("./MillionAwardRecord")},{"./MillionAwardData":1515,"./MillionAwardRecord":1516,"./WelfareInfo":1517}],1519:[function(e,t,i){"use strict";game.ActiveWorldBossInfo=b8e.Object.extends({bossId:0,maxhp:0,hp:0,state:0,startTime:0,endTime:0,ranks:null,urank:null,worldBossRankInfoList:null,ctor:function(){this._super(),this.ranks=[]},setData:function(e){if(e)switch(this.bossId=e.bossId,this.maxhp=e.hp,this.state=e.state,this.startTime=e.startTime,this.endTime=e.endTime,this.state){case game.WorldBossStateType.NO_OPEN:this.hp=this.maxhp;break;case game.WorldBossStateType.OVER:this.hp=0;break;case game.WorldBossStateType.OPENING:this.hp=this.maxhp*((this.endTime-game.SysTime.curTime)/(this.endTime-this.startTime));break;default:this.hp=0}}})},{}],1520:[function(e,t,i){"use strict";game.WorldBossAwardInfo=b8e.Object.extends({rank:0,userItem:null,ctor:function(){this._super()},setData:function(e){e&&(this.rank=e.rank,this.userItem=e.userItem)}})},{}],1521:[function(e,t,i){"use strict";game.WorldBossInfo=b8e.Object.extends({id:0,poster:"",head:"",startServer:"",name:"",reviceTime:"",rankPrize:null,showPrize:0,actId:0,title:"",ctor:function(){this._super()}})},{}],1522:[function(e,t,i){"use strict";game.WorldBossRankInfo=b8e.Object.extends({rank:0,name:"",guildName:"",score:0,bianshens:null,ctor:function(){this._super()},setData:function(e){e&&(this.rank=e.rank,this.name=e.name,this.guildName=e.guildName,this.score=e.score,this.bianshens=e.bianshens)}})},{}],1523:[function(e,t,i){"use strict";game.WorldBossStateType=b8e.Enum({NO_OPEN:0,OPENING:1,OVER:2})},{}],1524:[function(e,t,i){"use strict";game.WorldBossUnit=b8e.Object.extends({id:0,state:game.WorldBossStateType.NO_OPEN,ranks:null,urank:null,ctor:function(){this._super(),this.ranks=[]},setData:function(e){e&&(this.ranks.length=0,this.id=e.id,this.state=e.state)}})},{}],1525:[function(e,t,i){"use strict";e("./WorldBossStateType"),e("./WorldBossRankInfo"),e("./WorldBossUnit"),e("./WorldBossInfo"),e("./ActiveWorldBossInfo")},{"./ActiveWorldBossInfo":1519,"./WorldBossInfo":1521,"./WorldBossRankInfo":1522,"./WorldBossStateType":1523,"./WorldBossUnit":1524}],1526:[function(e,t,i){"use strict";game.WorldCupQuiz=b8e.Object.extends({match:"",num1:0,num2:0,num3:0,ctor:function(){this._super()},setup:function(e){this.match=e.match,this.num1=e.num1,this.num2=e.num2,this.num3=e.num3},addNum:function(e){switch(e.type){case game.WorldCupQuizType.QUIZ_WIN:this.num1+=e.num;break;case game.WorldCupQuizType.QUIZ_LOSE:this.num2+=e.num;break;case game.WorldCupQuizType.QUIZ_DRAW:this.num3+=e.num}},getQuizNUmByType:function(e){switch(e){case game.WorldCupQuizType.QUIZ_WIN:return this.num1;case game.WorldCupQuizType.QUIZ_LOSE:return this.num2;case game.WorldCupQuizType.QUIZ_DRAW:return this.num3}}})},{}],1527:[function(e,t,i){"use strict";game.WorldCupRank=b8e.Object.extends({rank:0,name:0,score:0,zone:0,ctor:function(){this._super()},setup:function(e){this.rank=e.rank,this.name=e.name,this.score=e.score,this.zone=e.zone}})},{}],1528:[function(e,t,i){"use strict";game.WorldCupSchedule=b8e.Object.extends({match:0,zone:0,type:0,teamName1:"",teamIcon1:"",teamName2:"",teamIcon2:"",time:0,result:0,team1Score:0,team2Score:0,isGameEnd:!1,winnerName:null,winnerIcon:null,index:0,resultType:0,worldCupWinTeam:null,isWin:!1,ctor:function(){this._super(),this.worldCupWinTeam=new game.WorldCupWinTeam},setup:function(e){this.match=e.match,this.zone=e.zone,this.teamIcon1=e.teamIcon1,this.teamName1=e.teamName1,this.teamIcon2=e.teamIcon2,this.teamName2=e.teamName2,this.time=e.time,this.worldCupWinTeam._beginTime=this.time,this.result=e.result,this.setType(e.type);var t=this.result.split(":");t&&2<=t.length?(this.team1Score=0|t[0],this.team2Score=0|t[1],this.isGameEnd=!0):this.isGameEnd=!1,this.isGameEnd&&(this.team1Score>this.team2Score?(this.resultType=game.WorldCupQuizType.QUIZ_WIN,this.worldCupWinTeam.winnerName=this.teamName1,this.worldCupWinTeam.winnerIcon=this.teamIcon1,this.isWin=!0):this.team1Score==this.team2Score?this.resultType=game.WorldCupQuizType.QUIZ_DRAW:(this.worldCupWinTeam.winnerName=this.teamName2,this.worldCupWinTeam.winnerIcon=this.teamIcon2,this.resultType=game.WorldCupQuizType.QUIZ_LOSE,this.isWin=!1))},setType:function(e){var t=0;switch(e){case"team":t=game.WorldCupScheduleType.TEAM;break;case"r16":t=game.WorldCupScheduleType.R16;break;case"quarter-final":t=game.WorldCupScheduleType.QUATER_FINAL;break;case"semi-final":t=game.WorldCupScheduleType.SEMI_FINAL;break;case"third":t=game.WorldCupScheduleType.THIRD;break;case"final":t=game.WorldCupScheduleType.FINAL}this.type=t},isEnd:function(){return this.isGameEnd},getWinnerName:function(){return this.isGameEnd?this.winnerName:null},setIndex:function(e){this.index=e},isQuizEnd:function(){return game.SysTime.curTime>=this.time},getResultType:function(){return this.resultType}})},{}],1529:[function(e,t,i){"use strict";game.WorldCupTeam=b8e.Object.extends({name:"",icon:"",won:0,draw:0,lost:0,points:0,group:0,goalsFor:0,ctor:function(){this._super()},setup:function(e){this.name=e.name,this.icon=e.icon,this.won=e.won,this.draw=e.draw,this.lost=e.lost,this.points=e.points,this.group=e.group,this.goalsFor=e.goalsFor}})},{}],1530:[function(e,t,i){"use strict";game.WorldCupWinTeam=b8e.Object.extends({winnerName:null,winnerIcon:null,_beginTime:0,ctor:function(){this._super()}})},{}],1531:[function(e,t,i){"use strict";game.XiandanInfo=b8e.Object.extends({id:0,usedTimes:0,ctor:function(){this._super()},setup:function(e){e&&(this.id=e.id,this.usedTimes=e.usedTimes)}})},{}],1532:[function(e,t,i){"use strict";e("./XiandanInfo")},{"./XiandanInfo":1531}],1533:[function(e,t,i){"use strict";game.BeanProcess=b8e.BaseProcess.extends({_isRegister:!1,getState:function(){return game.MainProcessTypes.BEAN},processHandler:function(e){game.LoadingPage.inst().setProgress(e)},startProcess:function(){this._super(),b8e.log("process:"+game.MainProcessTypes.BEAN+"开始..."),game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在请求设置..."),this.setProcessPercent(1,3e3);var e=game.LoginConfig.heroData;e?(game.mainRole.onLogin(e),this.isProcessed?this.completeProcess():(b8e.startup.removeDummyHot(),this._isRegister||(this._isRegister=!0,game.BeanRegisterMgr.inst().setup(),game.BeanMgr.inst().register()),game.MiscSender.clientDataRequest())):(game.LoadingPage.inst().setErrorText("英雄数据异常！"),b8e.Toast.launch("英雄数据异常！",4294901760,0),b8e.error("英雄数据异常"))},completeProcess:function(){this.isProcessed||(game.mainGui.showMainUI(),game.TriggerMgr.inst().setup()),this._super()}})},{}],1534:[function(e,t,i){"use strict";game.EnterScene=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super()},getState:function(){return game.MainProcessTypes.ENTER_SCENE},processHandler:function(e){game.ReconnectLoading&&game.ReconnectLoading.inst().setProgress(e),game.LoadingPage.inst().setProgress(e)},startProcess:function(){this._super(),b8e.Tween.kill(this);var e=game.SceneMgr.inst().getSceneConfig();if(game.SceneMgr.inst().isFirstEnterScene?(game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在进入场景...")):e.type==game.SceneType.ARENA&&game.arena.isCSArena?game.CSArenaVsPage.inst().showPage():e.loadingEffect?game.LoadingDungeonPage.inst().showPage():(game.LoginConfig.isReconnect?game.ReconnectLoading&&(game.ReconnectLoading.inst().show(),game.ReconnectLoading.inst().setTipText("请稍候，正在进入游戏...")):(game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏...")),b8e.log("正在进入场景...")),this.setProcessPercent(1,3e3),!this.isProcessed){if(game.sdk.stepLog({progress:100}),game.sdk.enterGameLog(),game.LoginConfig.wanbaGiftId&&game.WelfareSender.wanbaPrizeRequest(game.LoginConfig.wanbaGiftId),game.LoginConfig.canFocus&&game.LoginConfig.isFocus,game.LoginConfig.canDownloadMicro&&game.LoginConfig.isMicroLogin&&game.WelfareSender.sendMicroPrizeRequest(),game.IS_HUO_SHU){var t=game.HuoShuSDK.getAppId();"2038"!=t&&"2066"!=t||game.sdk.getCoinRemain()}}if(game.SceneMgr.inst().isFirstEnterScene)this.closeLoadingPage(),this.loadMapComplete();else if(game.LoginConfig.isReconnect)this.closeLoadingPage(),this.loadMapComplete();else{var i=0;if(e.type==game.SceneType.ARENA&&game.arena.isCSArena)b8e.Tween.get(this).wait(500).call(function(){game.CSArenaVsPage.inst().hidePage()},this),i=500;else if(e.loadingEffect){b8e.Tween.get(this).wait(300).call(function(){game.LoadingDungeonPage.inst().hidePage()},this),i=300+this.playPlayerGhost(300)}else{this.closeLoadingPage(),i=this.playPlayerGhost()}0<i?b8e.Tween.get(this).wait(i).call(this.loadMapComplete,this):this.loadMapComplete()}},playPlayerGhost:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=game.SceneMgr.inst().getSceneConfig(),i=0,n=null;if(t.entrySceneEffectId&&(n=game.ccfg.ClientSceneEffectCfg.getDataById(t.entrySceneEffectId)),n){var s=game.mainRole.mainRoleEntity,a=s.sceneX,o=s.sceneY;s.setScenePosition(a+n.jumpUpOffsetX,o+n.jumpUpOffsetY),i=n.jumpUpTime+n.jumpDownTime,0<e?b8e.Tween.get(this).wait(e).call(this.playGhostEffect,this,[n.ghostSpacing,n.ghostDuration,a,o,n.jumpUpTime,n.jumpDownTime,n.jumpHeight]):this.playGhostEffect(n.ghostSpacing,n.ghostDuration,a,o,n.jumpUpTime,n.jumpDownTime,n.jumpHeight)}return i},playGhostEffect:function(e,t,i,n,s,a,o){var r=game.mainRole.mainRoleEntity,h=r.getStateRef(game.JumpStateReference);h.setParams({x:i,y:n},100,s,a,o,e,t),r.transitionState(game.RoleStateType.ACTION_JUMP,h)},closeLoadingPage:function(){game.LoginConfig.isReconnect=!1,game.LoadingPage.inst().hide(),game.ReconnectLoading&&game.ReconnectLoading.inst().hide(),game.CSArenaVsPage.inst().hidePage(),game.LoadingDungeonPage.inst().hidePage()},loadMapComplete:function(){this.completeProcess(),this.closeLoadingPage(),game.SceneMgr.inst().loadMapComplete()},completeProcess:function(){b8e.Tween.kill(this),this._super()},dispose:function(){b8e.Tween.kill(this),this._super()}})},{}],1535:[function(e,t,i){"use strict";game.LoadAnimat=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super(),this._batchList=[]},getState:function(){return game.MainProcessTypes.LOAD_ANIMAT},startProcess:function(){if(this._super(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在加载动画..."),game.SceneMgr.inst().isFirstEnterScene){game.sdk.stepLog({progress:50})}b8e.res.unloadBatchRes(this._batchList,this.batchLoadProcess,this),this._batchList.length=0;this.completeProcess()},addLoadSpellIds:function(e,t){if(e&&"0"!=e)for(var i=e.split("|"),n=i.length,s=0;s<n;s++){var a=i[s];this.addLoadSpellEffect(a,t)}},addLoadSpellEffect:function(e,t){if(0<e){var i=game.ccfg.SpellCfg.getSpellById(Number(e));if(i){if(i.releaseEffect){var n=game.ClientCfg.getSkillFx(i.releaseEffect);t.push(n)}this.addLoadSpellEffect(i.nextSpellId)}else b8e.warn("技能ID："+e+"没有配置？")}},batchLoadProcess:function(e,t,i,n){e?game.LoadingPage.inst().setErrorText("加载动画错误！"):i==n&&(b8e.res.unloadBatchRes(this._batchList,this.batchLoadProcess,this),this._batchList.length=0,this.completeProcess())}})},{}],1536:[function(e,t,i){"use strict";game.LoadConfig=b8e.BaseProcess.extends({_configUrl:null,ctor:function(){this._configUrl="config/config_"+game.VERSION_NAME+".bcd",this._super()},getState:function(){return game.MainProcessTypes.LOAD_CONFIG},processHandler:function(e){game.LoadingPage.inst().setProgress(e)},startProcess:function(){this._super(),this.isProcessed?this.completeProcess():(game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在加载配置..."),this.setProcessPercent(1,3e3),this.loadConfig(),game.mainProcess.runPreload())},loadConfig:function(){var e=[{url:this._configUrl,useManifest:!1,proto:"conf.Config"},{url:"proto/proto.bpd",useManifest:!1}];b8e.res.loadBatchRes(e,this.batchLoadProcess,this,null,!1,!1)},batchLoadProcess:function(e,t,i,n,s){e?game.LoadingPage.inst().setErrorText("加载配置错误！"):(s==this._configUrl&&game.ConfigMgr.parseConfig(t),i==n&&this.completeProcess())}})},{}],1537:[function(e,t,i){"use strict";game.LoadFont=b8e.BaseProcess.extends({_preload:!1,ctor:function(e){this._super(),this._preload=e},getState:function(){return game.MainProcessTypes.LOAD_FONT},processHandler:function(e){game.LoadingPage.inst().setProgress(e)},startProcess:function(){this._super(),this.completeProcess()}})},{}],1538:[function(e,t,i){"use strict";game.LoadMainUI=b8e.BaseProcess.extends({_isLoading:!1,_isLoaded:!1,_preload:!1,ctor:function(e){this._super(),this._preload=e},getState:function(){return game.MainProcessTypes.LOAD_MAIN_UI},processHandler:function(e){game.LoadingPage.inst().setProgress(e)},startProcess:function(){this._super(),this._preload||(game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在加载UI..."),this.setProcessPercent(1,3e3)),this.completeProcess()},loadUIs:function(){b8e.macro.IS_RELEASE?b8e.res.loadPrefabBundleData("ui/ui.data",this.onLoadComplete,this):b8e.res.loadPrefabBundleData("ui/ui_preview.data",this.onLoadComplete,this)},onLoadComplete:function(e){e?this._preload||game.LoadingPage.inst().setErrorText("加载UI错误！"):(this._isLoading=!1,this._isLoaded=!0,this.completeProcess())},completeProcess:function(){this._super()}})},{}],1539:[function(e,t,i){"use strict";game.LoadMap=b8e.BaseProcess.extends({_batchList:null,ctor:function(){this._super(),this._batchList=[]},getState:function(){return game.MainProcessTypes.LOAD_MAP},processHandler:function(e){game.ReconnectLoading&&game.ReconnectLoading.inst().setProgress(e),game.LoadingPage.inst().setProgress(e)},startProcess:function(){var e=game.mainRole.mainRoleData;this.isProcessing&&b8e.error("正在进入场景，不允许再次进入场景！----场景id："+e.mapId),this._super(),b8e.Tween.kill(this),this.isProcessed||b8e.LogReport.send("INFO");var t,i=game.PlotMgr.inst().getCurrScenePlot();if(t=i?i.sceneId:e.mapId,b8e.scene.clearEntity(),game.SceneMgr.inst().leaveScene(),game.SceneMgr.inst().sceneId=t,game.SceneMgr.inst().isFirstEnterScene){game.SysTime.syncTime();game.sdk.stepLog({progress:25}),this.startLoad()}else{var n=this.playPlayerGhost();0<n?b8e.Tween.get(this).wait(n).call(function(){this.startLoad()},this):this.startLoad()}},playPlayerGhost:function(){var e=game.SceneMgr.inst().getSceneConfig(),t=0,i=null;if(e.leaveSceneEffectId&&(i=game.ccfg.ClientSceneEffectCfg.getDataById(e.leaveSceneEffectId)),i){var n=game.mainRole.mainRoleEntity,s=n.sceneX,a=n.sceneY;t=i.jumpUpTime+i.jumpDownTime,this.playGhostEffect(i.ghostSpacing,i.ghostDuration,s+i.jumpDownOffsetX,a+i.jumpDownOffsetY,i.jumpUpTime,i.jumpDownTime,i.jumpHeight)}return t},playGhostEffect:function(e,t,i,n,s,a,o){var r=game.mainRole.mainRoleEntity,h=r.getStateRef(game.JumpStateReference);h.setParams({x:i,y:n},100,s,a,o,e,t),r.transitionState(game.RoleStateType.ACTION_JUMP,h)},startLoad:function(){if(game.SceneMgr.inst().isFirstEnterScene)game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏..."),b8e.log("正在加载地图...");else{var e=game.SceneMgr.inst().getSceneConfig();e.type==game.SceneType.ARENA&&game.arena.isCSArena?game.CSArenaVsPage.inst().showPage():e.loadingEffect?game.LoadingDungeonPage.inst().showPage():(game.LoginConfig.isReconnect?game.ReconnectLoading&&game.ReconnectLoading.inst().setTipText("请稍候，正在进入游戏..."):(game.LoadingPage.inst().show(),game.LoadingPage.inst().setTipText("请稍候，正在进入游戏...")),b8e.log("正在加载地图..."))}var t=game.SceneMgr.inst().sceneId;this.setProcessPercent(1,3e3);var i=game.SceneMgr.inst().getSceneConfig();if(!i)return game.LoadingPage.inst().setErrorText("进入的场景id:"+t+"没有配置！"),void b8e.log("想进入一个没有配置的场景？");var n=game.mainRole.mainRoleEntity;n&&n.setPosition(0,0);var s=i.resName;this.loadMap(s),game.SceneMgr.inst().lastSceneId=t},loadMap:function(e){var t=game.SceneMgr.inst().lastSceneId,i=0<t?game.ccfg.SceneCfg.getSceneById(t):null;if(b8e.scene.isLoaded()&&i&&e==i.resName)this.enterMap();else{var n=game.ClientCfg.getMap(e);b8e.scene.loadMap(n,function(e,t){e?(game.LoadingPage.inst().setErrorText("加载地图配置错误！"),b8e.error(e)):this.enterMap()},this)}},enterMap:function(){b8e.res.unloadBatchRes(this._batchList,this.batchLoadProcess,this),this._batchList.length=0;var e=game.mainRole.mainRoleEntity,t=game.PlotMgr.inst().getCurrScenePlot();if(t){var i=t.sceneId,n=game.ccfg.SceneCfg.getSceneById(i);n?e.setScenePosition(n.inPos.X,n.inPos.Y):b8e.error("剧情场景ID:"+i+"的场景配置没有找到！")}else{var s=game.mainRole.mainRoleData;e.setGridPosition(s.loginPosition.x,s.loginPosition.y)}b8e.scene.startRender();var a=b8e.scene.getMapLayer().getEarthSurface().getThumbUrl(),o=[];a&&o.unshift(a),o.forEach(function(e){this._batchList.push({url:e,type:b8e.SpriteFrame,useManifest:!1})},this),0<this._batchList.length?b8e.res.loadBatchRes(this._batchList,this.batchLoadProcess,this):this.completeProcess()},batchLoadProcess:function(e,t,i,n){e?game.LoadingPage.inst().setErrorText("加载地图错误！"):i==n&&(b8e.res.unloadBatchRes(this._batchList,this.batchLoadProcess,this),this._batchList.length=0,this.completeProcess())},completeProcess:function(){b8e.Tween.kill(this),this._super()},dispose:function(){b8e.Tween.kill(this),this._super()}})},{}],1540:[function(e,t,i){"use strict";game.MainProcessRun=b8e.Object.extends({main:null,_preload:null,initProcess:function(){this.main=new b8e.ProcessStateMachine,this.main.pushProcess(new game.LoadConfig),this.main.pushProcess(new game.LoadMainUI),this.main.pushProcess(new game.BeanProcess),this.main.pushProcess(new game.LoadMap),this.main.pushProcess(new game.LoadAnimat),this.main.pushProcess(new game.EnterScene),this._preload=new b8e.ProcessStateMachine,this._preload.pushProcess(new game.LoadFont(!0))},runPreload:function(){this._preload.free(),this._preload.addPreProcess(game.MainProcessTypes.LOAD_FONT),this._preload.run()},runProcess:function(){this.main.free(),this.main.addPreProcess(game.MainProcessTypes.LOAD_CONFIG,.7,.85),this.main.addPreProcess(game.MainProcessTypes.LOAD_MAIN_UI,.85,.95),this.main.addPreProcess(game.MainProcessTypes.BEAN,.95,.95),this.main.addPreProcess(game.MainProcessTypes.LOAD_MAP,.95,1),this.main.addPreProcess(game.MainProcessTypes.LOAD_ANIMAT,1,1),this.main.addPreProcess(game.MainProcessTypes.ENTER_SCENE,1,1),this.main.run()},runSceneProcess:function(){this.main.free(),this.main.addPreProcess(game.MainProcessTypes.LOAD_MAP,0,.8),this.main.addPreProcess(game.MainProcessTypes.LOAD_ANIMAT,.8,1),this.main.addPreProcess(game.MainProcessTypes.ENTER_SCENE,1,1),this.main.run()}})},{}],1541:[function(e,t,i){"use strict";game.MainProcessTypes=b8e.Enum({NONE:0,LOAD_CONFIG:1,LOAD_FONT:2,LOAD_MAIN_UI:3,BEAN:4,LOAD_MAP:5,LOAD_ANIMAT:6,ENTER_SCENE:7})},{}],1542:[function(e,t,i){"use strict";e("./MainProcessTypes"),e("./LoadConfig"),e("./BeanProcess"),e("./LoadMap"),e("./LoadAnimat"),e("./EnterScene"),e("./LoadFont"),e("./LoadMainUI"),e("./MainProcessRun")},{"./BeanProcess":1533,"./EnterScene":1534,"./LoadAnimat":1535,"./LoadConfig":1536,"./LoadFont":1537,"./LoadMainUI":1538,"./LoadMap":1539,"./MainProcessRun":1540,"./MainProcessTypes":1541}],1543:[function(e,t,i){"use strict";game.FirstEnterSceneMgr=b8e.Object.extends({name:"FirstEnterSceneMgr",_isInit:!1,_callMap:null,_callIndex:0,_callPriority:3,_timer:null,ctor:function(){if(this._super(),1==game.FirstEnterSceneMgr._singleton)throw new Error("FirstEnterSceneMgr 只能通过单例方法获取");this._callMap=[]},addCall:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:game.FirstEnterSceneMgr.Priority.MIDDLE,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=this._callMap[i];s||(this._callMap[i]=s=[]),s.push({callFun:e,openId:n,thisArg:t})},setup:function(){this._isInit?(this._callIndex=0,this._callPriority=game.FirstEnterSceneMgr.Priority.HIGH,this._timer.reset(),this._timer.start()):(this._timer||(this._timer=b8e.Timer.add(this,this.update,200)),this._callIndex=0,this._callPriority=3,this._isInit=!0,this.addCall(game.spotAlert.initAlert,game.spotAlert,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.BackSender.bagRequest,game.BackSender,game.FirstEnterSceneMgr.Priority.HIGH,game.FunctionType.BACK_PACK),this.addCall(game.BianshenSender.QryBianshenModuleModelRequest,game.BianshenSender,game.FirstEnterSceneMgr.Priority.HIGH),this.addCall(game.equip.setup,game.equip,game.FirstEnterSceneMgr.Priority.HIGH),this.addCall(game.beauty.firstEnterScene,game.BeautySender,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.MailSender.reqMailInfo,game.MailSender,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.MAIL),this.addCall(game.chat.init,game.chat,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.CHAT),this.addCall(game.DrawSender.reqDecksInfo,game.DrawSender,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.WelfareSender.reqWelfareInfo,game.WelfareSender,game.FirstEnterSceneMgr.Priority.MIDDLE,game.FunctionType.WELFARE),this.addCall(game.menu.setup,game.menu,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.relation.initFriendInfo,game.relation,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.FRIEND),this.addCall(game.relation.initBlackInfo,game.relation,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.FRIEND),this.addCall(game.worldBoss.firstEnterScene,game.SceneSender,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.guild.init,game.guild,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.GUILD),this.addCall(game.relationChat.initData,game.relationChat,game.FirstEnterSceneMgr.Priority.MIDDLE,game.FunctionType.FRIEND),this.addCall(game.material.getMaterialInfo,game.material,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.MATERIAL),this.addCall(game.rebirth.getRebirthData,game.rebirth,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.REBIRTH),this.addCall(game.MountMgr().onInit,game.MountMgr(),game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.MOUNT),this.addCall(game.WingMgr().onInit,game.WingMgr(),game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.WING),this.addCall(game.FaBaoMgr().onInit,game.FaBaoMgr(),game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.FA_BAO),this.addCall(game.XianZhenMgr().onInit,game.XianZhenMgr(),game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.XIANZHEN),this.addCall(game.ActiveSender.ActivityModuleRequest,game.ActiveSender,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.PaySender.reqRechargeInfo,game.PaySender,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.SurfaceSender.initSurface,game.SurfaceSender,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.SURFACE),this.addCall(game.AchievementMgr.inst().getData,game.AchievementMgr.inst(),game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.xiandan.checkOpen,game.xiandan,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.XIAN_DAN),this.addCall(game.nationalBoss.firstEnterScene,game.nationalBoss,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.NATIONAL_BOSS),this.addCall(game.loneyDungeon.firstEnterScene,game.loneyDungeon,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.TIAO_ZHAN),this.addCall(game.nickName.onNicknameModuleRequest,game.nickName,game.FirstEnterSceneMgr.Priority.MIDDLE,game.FunctionType.CHENG_HAO),this.addCall(game.dujie.checkOpen,game.dujie,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.JING_JIE),this.addCall(game.shop.checkOpen,game.shop,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.SHOP),this.addCall(game.zhanyao.firstEnterScene,game.zhanyao,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.ZHANYAO),this.addCall(game.quest.firstEnterScene,game.quest,game.FirstEnterSceneMgr.Priority.MIDDLE,game.FunctionType.AUTO_QUEST),this.addCall(game.tianGong.resetData,game.tianGong,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.GUILD),this.addCall(game.amulet.reqAmuletModule,game.amulet,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.AMULET),this.addCall(game.tianGong.firstEnterScene,game.tianGong,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.GUILD),this.addCall(game.arena.reqArenaInfo,game.arena,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.FENG_SHEN_BANG),this.addCall(game.rank.getArenaRank,game.rank,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.FENG_SHEN_BANG),this.addCall(this.miscData,this,game.FirstEnterSceneMgr.Priority.HIGH),this.addCall(game.skill.initSpell,game.skill,game.FirstEnterSceneMgr.Priority.HIGH),this.addCall(game.SceneMgr.inst()._showQAPanel,game.SceneMgr.inst(),game.FirstEnterSceneMgr.Priority.HIGH),this.addCall(game.cornucopia.firstEnterScene,game.cornucopia,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.CORNUCOPIA),this.addCall(game.sdk.reportLog,game.sdk,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.team.init,game.team,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.TEAM_BOSS),this.addCall(game.rune.firstEnterScene,game.rune,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.tower.firstEnterScene,game.tower,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.TOWER),this.addCall(game.csArena.getInfo,game.csArena,game.FirstEnterSceneMgr.Priority.LOW,game.FunctionType.CSARENA),this.addCall(game.retrieve.getDatas,game.retrieve,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.guild.initExpCureCfg,game.guild,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.escort.firstEnterScene,game.escort,game.FirstEnterSceneMgr.Priority.LOW),this.addCall(game.ornament.firstEnterScene,game.ornament,game.FirstEnterSceneMgr.Priority.MIDDLE,game.FunctionType.ORANMENT))},update:function(){var e,t,i,n;if(!(e=this._callMap[this._callPriority]))return this._callPriority--,void(this._callIndex=0);for(this._callPriority==game.FirstEnterSceneMgr.Priority.HIGH?t=5<=e.length-this._callIndex-1?5:e.length-this._callIndex:this._callPriority==game.FirstEnterSceneMgr.Priority.MIDDLE?t=3<=e.length-this._callIndex-1?3:e.length-this._callIndex:this._callPriority==game.FirstEnterSceneMgr.Priority.LOW&&(t=2<=e.length-this._callIndex-1?2:e.length-this._callIndex),n=this._callIndex+t;this._callIndex<=n;this._callIndex++)(i=e[this._callIndex])&&(i.openId&&!game.funcOpen.checkOpen(i.openId)||i.callFun.call(i.thisArg));this._callIndex>e.length-1&&(this._callPriority==game.FirstEnterSceneMgr.Priority.LOW?this._timer.stop():(this._callPriority--,this._callIndex=0))},miscData:function(){b8e.sendN(game.pbmid.Misc.MiscDataRequest),b8e.sendN(game.pbmid.Misc.ServerDataRequest)}}),game.FirstEnterSceneMgr.Priority={HIGH:3,MIDDLE:2,LOW:1},game.FirstEnterSceneMgr._instance=null,game.FirstEnterSceneMgr._singleton=!0,game.FirstEnterSceneMgr.inst=function(){return null==game.FirstEnterSceneMgr._instance&&(game.FirstEnterSceneMgr._singleton=!1,game.FirstEnterSceneMgr._instance=new game.FirstEnterSceneMgr,game.FirstEnterSceneMgr._singleton=!0),game.FirstEnterSceneMgr._instance}},{}],1544:[function(e,t,i){"use strict";game.FogMgr=b8e.Object.extends({_fog:null,_curUrl:null,_init:!1,_syncInfo:null,_fogWidth:null,_fogHeight:null,_isShow:!1,ctor:function(){if(1==game.FogMgr._singleton)throw new Error("FogMgr 只能通过单例方法获取")},init:function(){if(!this._init){this._sceneLayer=b8e.layer.getSceneLayer(),this._fog=b8e.Sprite.get(),this._fog.setLocalZOrder(99998),this._fog.active=!0,this._fog.setBlendMode(b8e.BlendMode.ADD),this._sceneLayer.addChild(this._fog),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageResize);var e=game.mainRole.mainRoleEntity;this._syncInfo=new b8e.DisplaySyncInfo(this),e.addSyncInfo(this._syncInfo),this._init=!0}},loadSceneComplete:function(){if(this._isShow=!1,0!=this._init){var e=game.SceneMgr.inst().getSceneConfig();if(e)if(e.fog){var t=game.ClientCfg.getFogUrl(e.fog);if(t&&""!=t)if(this._curUrl!=t){this._curUrl=t,this._fog.loadTexture(t,this.loadComplte,this,{useManifest:!1}),this._fog.setAnchor(.5,.5);var i=game.mainRole.mainRoleEntity;this.syncInfo(i)}else this._isShow=!0}else this._fog.unloadTexture();else b8e.log("找不到场景配置！")}else b8e.warn("没有初始化迷雾")},loadComplte:function(e){e&&(this._fogWidth=e.width,this._fogHeight=e.height,this._isShow=!0,this.onStageResize())},syncInfo:function(e){var t=e.localToGlobal();this._fog.setPosition(t.x,t.y)},onStageResize:function(){if(0!=this._isShow){var e=b8e.stageWidth,t=b8e.stageHeight;this._fog.setSize(2*e,2*t);var i=game.mainRole.mainRoleEntity;this.syncInfo(i)}}}),game.FogMgr._instance=null,game.FogMgr._singleton=!0,game.FogMgr.inst=function(){return null==game.FogMgr._instance&&(game.FogMgr._singleton=!1,game.FogMgr._instance=new game.FogMgr,game.FogMgr._singleton=!0),game.FogMgr._instance}},{}],1545:[function(e,t,i){"use strict";game.MainRoleMgr=b8e.Object.extends({name:"MainRoleMgr",mainRoleEntity:null,mainRoleData:null,mainRoleId:0,setMainRoleData:function(e){this.mainRoleData||(this.mainRoleData=game.HeroData.get(),this.mainRoleData.isSelf=!0),this.mainRoleData.setupMineData(e),this.mainRoleData.mapId=e.mapid,this.mainRoleId=this.mainRoleData.id,game.sceneRole.createMainRole()},getMainRoleId:function(){return this.mainRoleId},getMainRoleData:function(){return this.mainRoleData},setMainRoleEntity:function(e){this.mainRoleEntity=e,b8e.scene.getCamera().setFocusTarget(this.mainRoleEntity)},updateRoleData:function(e){if(this.mainRoleEntity&&this.mainRoleId!=e){var t,i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Follower,this.mainRoleEntity.id);i&&(t=i.getController(),this.mainRoleEntity.removeSyncInfo(t),b8e.scene.removeDisplay(i));var n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Ornament,this.mainRoleEntity.id);n&&(t=n.getController(),this.mainRoleEntity.removeSyncInfo(t),b8e.scene.removeDisplay(n));var s=b8e.scene.getDisplayByTypeAndId(game.RoleType.Beauty,this.mainRoleEntity.id);s&&((t=s.getController()).release(),this.mainRoleEntity.removeSyncInfo(t),b8e.scene.removeDisplay(s)),this.mainRoleId=e,game.mainRole.mainRoleData.id=e,b8e.scene.modifyDisplayId(this.mainRoleEntity,e),game.BuffUtil.resetBuff(),game.BuffUtil.setBuffs(this.mainRoleEntity),game.AvatarUtil.updateAvatar(this.mainRoleEntity)}},updateRoleAvatar:function(){game.AvatarUtil.updateAvatar(this.mainRoleEntity)},getMainRoleEntity:function(){return this.mainRoleEntity},onLogin:function(e){this.setMainRoleData(e)}}),game.MainRoleMgr._instance=null,game.MainRoleMgr._singleton=!0,game.MainRoleMgr.inst=function(){return null==game.MainRoleMgr._instance&&(game.MainRoleMgr._singleton=!1,game.MainRoleMgr._instance=new game.MainRoleMgr,game.MainRoleMgr._singleton=!0),game.MainRoleMgr._instance}},{}],1546:[function(e,t,i){"use strict";game.SceneMgr=b8e.Object.extends({_modalRefs:null,isFirstEnterScene:!0,sceneId:0,sceneType:0,lastSceneId:0,isInImageScene:!1,_groundClickIndicator:null,sceneTransType:game.SceneTransType.TYPE_NORMAL,_isSentReady:!1,_quickEnterPanel:null,_loadMapTimer:null,_callList:null,_callIndex:0,_entityVisible:!0,ctor:function(){var e;this._super(),b8e.isMobile?(e=6,b8e.scene.setMaxRenderNum(game.RoleType.Hero,10),b8e.scene.setMaxAttachNum(game.RoleType.Hero,game.AttachType.BODY,3),b8e.scene.setMaxRenderNum(game.RoleType.Follower,3),b8e.scene.setMaxRenderNum(game.RoleType.Beauty,3),b8e.scene.setMaxRenderNum(game.RoleType.Ornament,3)):(e=20,b8e.scene.setMaxRenderNum(game.RoleType.Hero,20),b8e.scene.setMaxAttachNum(game.RoleType.Hero,game.AttachType.BODY,10),b8e.scene.setMaxRenderNum(game.RoleType.Follower,10),b8e.scene.setMaxRenderNum(game.RoleType.Beauty,10),b8e.scene.setMaxRenderNum(game.RoleType.Ornament,10)),b8e.scene.setMaxRenderNum(game.RoleType.Npc,e),b8e.scene.setMaxRenderNum(game.RoleType.DropItem,e),b8e.scene.setMaxRenderNum(game.RoleType.FlyEffect,e),b8e.scene.setMaxOtherRenderNum(e),b8e.scene.setMaxRenderNum(1e8,1e3),b8e.scene.setMaxAttachNum(1e8,game.AttachType.BODY,1e3),this.updateRenderNum(),game.setting.startCheck(),this._modalRefs=[]},updateRenderNum:function(){var e;game.PlotMgr.inst().isPlaying()?(b8e.scene.setMaxRenderNum(game.RoleType.Monster,10),b8e.scene.setMaxRenderNum(game.RoleType.Effect,8)):(e=b8e.isMobile?6:20,b8e.scene.setMaxRenderNum(game.RoleType.Monster,e),b8e.scene.setMaxRenderNum(game.RoleType.Effect,e))},addModalRef:function(e){this._modalRefs.indexOf(e)<0&&this._modalRefs.push(e),this.updateSceneShowState()},removeModalRef:function(e){var t=this._modalRefs.indexOf(e);-1<t&&this._modalRefs.splice(t,1),this.updateSceneShowState()},updateSceneShowState:function(){game.PlotMgr.inst().isPlaying()?(game.mainGui.hideAppShowOther(),b8e.scene.getEntityLayer().setVisible(!0,!1),game.bounceCharacters.showScene()):this._modalRefs.length<1?(this._entityVisible=!0,game.mainGui.hideAppShowOther(),b8e.scene.getEntityLayer().setVisible(!0,!1),game.bounceCharacters.showScene()):(this._entityVisible=!1,game.bounceCharacters.hideScene(),game.mainGui.showAppHideOther(),b8e.scene.getEntityLayer().setVisible(!1))},IsEntityVisible:function(){return this._entityVisible},heroCountInfo:function(){return b8e.scene.getCurrRenderNum(game.RoleType.Hero)+"/"+b8e.scene.getMaxRenderNum(game.RoleType.Hero)+"/"+b8e.scene.getCountByType(game.RoleType.Hero)},monsterCountInfo:function(){return b8e.scene.getCurrRenderNum(game.RoleType.Monster)+"/"+b8e.scene.getMaxRenderNum(game.RoleType.Monster)+"/"+b8e.scene.getCountByType(game.RoleType.Monster)},otherCountInfo:function(){return b8e.scene.getCurrOtherRenderNum()+"/"+b8e.scene.getMaxOtherRenderNum()},getSceneConfig:function(){return game.ccfg.SceneCfg.getSceneById(this.sceneId)},isHeroTouchable:function(){var e=this.getSceneConfig();if(!e)return!0;var t=!0;switch(e.SceneType){case game.SceneType.NORMAL:case game.SceneType.DUNGEON:case game.SceneType.HUANJING:case game.SceneType.ARENA:case game.SceneType.SURA:case game.SceneType.TIANGONG:case game.SceneType.TOWER:case game.SceneType.MAIN_QUEST_DUNGEON:t=!0;break;case game.SceneType.WORLDBOSS:case game.SceneType.TEAM_BOSS:t=!1;break;default:t=!0}return t},leaveScene:function(){var e=game.ccfg.SceneCfg.getSceneById(this.lastSceneId);e&&e.triggerId&&game.TriggerMgr.inst().triggerById(e.triggerId),e&&e.type==game.SceneType.ARENA&&game.arena.isCSArena&&(game.escort.isEscort?(game.app.show(game.AppConstant.ESCORT_MAIN_PANEL),game.escort.isEscort=!1):game.app.show(game.AppConstant.CSARENA_PANEL)),game.MoveToHelper.inst().stopMove(),game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().pause(!0),game.FightTargetMgr.inst().stop(),game.PerfMgr.inst().stop(),this._loadMapTimer&&this._loadMapTimer.stop()},firstEnterScene:function(){b8e.log("首次进入场景--------------"),b8e.scene.addEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.addEventListener(b8e.SceneEvent.SCENE_ENTITY_CLICK,this.onClickEntity,this),game.FirstEnterSceneMgr.inst().setup()},loadMapComplete:function(){this.isFirstEnterScene&&this.firstEnterScene(),this.isFirstEnterScene=!1,this._isSentReady=!1,game.LoginConfig.isSentReady=this._isSentReady,this._loadMapTimer?(this._loadMapTimer.reset(),this._loadMapTimer.start()):this._loadMapTimer=b8e.Timer.add(this,this._loadMapUpdate,100,0,2),this._callIndex=0,this._callList||(this._callList=[],this._addLoadMapCall(this._scenePlot,this),this._addLoadMapCall(this._sceneReady,this),this._addLoadMapCall(game.sceneRole.createDoors,game.sceneRole),this._addLoadMapCall(game.sceneRole.createNpcs,game.sceneRole),this._addLoadMapCall(game.sceneRole.createClientEntitys,game.sceneRole),this._addLoadMapCall(game.SceneQuickEnterMgr.inst().spitOutQuickEnter,game.SceneQuickEnterMgr.inst()),this._addLoadMapCall(this._sanZangJiangJing,this),this._addLoadMapCall(game.SceneDesMgr.inst().showSceneDes,game.SceneDesMgr.inst())),game.PerfMgr.inst().reset(),game.ScenePickMgr.inst().selectTarget(null);var e=this.getSceneConfig();this.sceneType=e.type;var t=game.mainRole.mainRoleData,i=game.mainRole.mainRoleEntity;switch(e.canLootCornucopia?i.updateCornucopiaEffects(t.avatarInfo.cornucopiaIsBoom):i.updateCornucopiaEffects(!1),game.TriggerMgr.inst().sceneTrigger(this.sceneId),this.sceneTransType){case game.SceneTransType.TYPE_NORMAL:break;case game.SceneTransType.TYPE_MAIN_QUEST:game.quest.moveToMapTask(),this.sceneTransType=game.SceneTransType.TYPE_NORMAL;break;case game.SceneTransType.TYPE_TRUSTEESHIP:game.quest.StartTrusteeship(),this.sceneTransType=game.SceneTransType.TYPE_NORMAL;break;case game.SceneTransType.TYPE_ZHANYAO:game.zhanyao.moveToMapTask(),this.sceneTransType=game.SceneTransType.TYPE_NORMAL}game.mainRole&&game.mainRole.updateRoleAvatar&&game.mainRole.updateRoleAvatar(),b8e.evt.dptG(game.SceneEvent.LOAD_SCENE_COMPLETE)},_showQAPanel:function(){if(!game.LoginConfig.isReconnected){var e=game.LoginConfig.queryZoneAnnouncementListUrl;if(e&&""!=e){var t={uid:game.LoginConfig.uid,server_id:game.LoginConfig.serverId};game.sdk.sdkNet.requestData(game.LoginConfig.queryZoneAnnouncementListUrl,t,function(e,t){e?b8e.error(e):t&&0==t.code&&(game.LoginConfig.zoneAnnouncementContents=t.data.list,t.data.list&&0<t.data.list.length&&game.app.show(game.AppConstant.ANNOUNCEMENT_PANEL))},this,null,!0,{isJson:!0})}}},_sceneReady:function(){game.PlotMgr.inst().isPlaying()||(this.serverSceneReady(),game.TriggerMgr.inst().isPlotComplete()||game.sdk.sceneLog("2：剧情完结"))},_scenePlot:function(){var e=game.PlotMgr.inst().getCurrScenePlot();e&&game.PlotMgr.inst().storyLineNextPart(e)},_sanZangJiangJing:function(){var e=game.SceneMgr.inst().sceneId;game.sceneRole.isInBubbleExp&&e==game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CHANG_AN_SCENE_ID)?game.app.isShow(game.AppConstant.SANZANG_JIANGJIN_PANEL)||game.app.show(game.AppConstant.SANZANG_JIANGJIN_PANEL):game.app.isShow(game.AppConstant.SANZANG_JIANGJIN_PANEL)&&game.app.hide(game.AppConstant.SANZANG_JIANGJIN_PANEL)},_loadMapUpdate:function(){var e=this._callList[this._callIndex];this._callIndex++,e?e.callFun.call(e.thisArg):this._loadMapTimer.stop()},_addLoadMapCall:function(e,t){var i,n,s;this._callList.push(((n="thisArg")in(i={callFun:e,thisArg:s=t})?Object.defineProperty(i,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[n]=s,i))},serverSceneReady:function(){if(!this._isSentReady){this.getSceneConfig().autoTrusteeship?game.TrusteeshipMgr.inst().start():game.TrusteeshipMgr.inst().resume(!0);var e=game.pbmid.Scene.SceneReady;b8e.sendN(e),this._isSentReady=!0,game.LoginConfig.isSentReady=this._isSentReady}},getIsSentReady:function(){return this._isSentReady},onClickMap:function(e){var t=game.SceneMgr.inst().getSceneConfig();t&&t.type==game.SceneType.ARENA||(game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().clearMonsterModel(),game.TrusteeshipMgr.inst().pause(!0),game.MoveToHelper.inst().moveTo(new cc.Vec2(e.data.x,e.data.y),0,this._clickMapMoveComplete,this,null,!0))},onClickEntity:function(e){var t=game.SceneMgr.inst().getSceneConfig();t&&t.type==game.SceneType.ARENA||(game.TrusteeshipMgr.inst().clearMonsterModel(),game.ScenePickMgr.inst().pickTarget(e.data))},clickMap:function(e,t){var i=game.mainRole.mainRoleEntity;if(!i.getStateMachine().isDeadState()){var n={x:e,y:t};game.ScenePickMgr.inst().pickTarget(null),game.TrusteeshipMgr.inst().pause(!0),game.MoveToHelper.inst().moveTo(new cc.Vec2(e,t),0,this._clickMapMoveComplete,this),i.getStateMachine().isWalking()?this.showGroundClickIndicator(n):this.hideGroundClickIndicator()}},_clickMapMoveComplete:function(){game.TrusteeshipMgr.inst().resume(!0)},showGroundClickIndicator:function(e){if(!this._groundClickIndicator){this._groundClickIndicator=b8e.SceneEntity.get(),this._groundClickIndicator.clearDisabled=!0;var t=this._groundClickIndicator.addAnimator(1,1),i=game.ClientCfg.getSceneFx("arrow");t.load(i,null,null,{recycleDelay:-1}),t.play()}this._groundClickIndicator.getScene()||b8e.scene.addDisplay(this._groundClickIndicator,9999,!0,!1,!1),this._groundClickIndicator.setScenePosition(e.x,e.y);var n=this._groundClickIndicator.y;b8e.Tween.kill(this._groundClickIndicator),b8e.Tween.get(this._groundClickIndicator,{loop:!0}).to({y:n+20},600).to({y:n},600)},hideGroundClickIndicator:function(){this._groundClickIndicator&&(b8e.Tween.kill(this._groundClickIndicator),this._groundClickIndicator.getScene()&&b8e.scene.removeDisplay(this._groundClickIndicator,!1))},clear:function(){this.lastSceneId=0,this.isFirstEnterScene=!0,b8e.scene.removeEventListener(b8e.SceneEvent.SCENE_MAP_CLICK,this.onClickMap,this),b8e.scene.removeEventListener(b8e.SceneEvent.SCENE_ENTITY_CLICK,this.onClickEntity,this),b8e.scene.clear()}}),game.SceneMgr._instance=null,game.SceneMgr._singleton=!0,game.SceneMgr.inst=function(){return null==game.SceneMgr._instance&&(game.SceneMgr._singleton=!1,game.SceneMgr._instance=new game.SceneMgr,game.SceneMgr._singleton=!0),game.SceneMgr._instance}},{}],1547:[function(e,t,i){"use strict";game.ScenePickMgr=b8e.Object.extends({_pickTarget:null,getTarget:function(){return this._pickTarget},pickTarget:function(e){if(this._pickTarget&&this._pickTarget.usable&&(this.hideSelectTip(this._pickTarget),!this._pickTarget.data.isSelf)){switch(this._pickTarget.type){case game.RoleType.Hero:case game.RoleType.Monster:this._pickTarget.hideBar()}b8e.evt.dptG(game.BossEvents.BOSS_CLEAR)}if(this._pickTarget=null,e&&e.data&&1!=e.data.isSelf&&e.type!=game.RoleType.ClientEntity){switch(game.SceneMgr.inst().hideGroundClickIndicator(),e.type){case game.RoleType.Hero:var t=game.mainRole.mainRoleData;switch(t.pkMode){case game.PkModeType.PEACE:e.getStateMachine().isDeadState()||e.data.isSelf||(e.showBar(),game.notice.show(game.ccfg.LangCfg.getText(10013)));break;case game.PkModeType.ALL:if(!e.getStateMachine().isDeadState()&&!e.data.isSelf){if(e.showBar(),0==game.CastSpellHelper.inst().checkAttack(e,!0))return;this.showSelectTip(e),game.TrusteeshipMgr.inst().autoFight?(game.TrusteeshipMgr.inst().setTargets([e.id]),game.TrusteeshipMgr.inst().resume()):game.FightTargetMgr.inst().start(e.id)}break;case game.PkModeType.GUILD:if(e.data.guildId!=t.guildId||0==e.data.guildId){if(!e.getStateMachine().isDeadState()&&!e.data.isSelf){if(e.showBar(),0==game.CastSpellHelper.inst().checkAttack(e,!0))return;this.showSelectTip(e),game.TrusteeshipMgr.inst().autoFight?(game.TrusteeshipMgr.inst().setTargets([e.id]),game.TrusteeshipMgr.inst().resume()):game.FightTargetMgr.inst().start(e.id)}}else if(!e.data.isSelf)return e.showBar(),void game.notice.show(game.ccfg.LangCfg.getText(10014))}break;case game.RoleType.Monster:if(!e.getStateMachine().isDeadState()&&(this.showSelectTip(e),!e.data.isSelf)){e.showBar(),game.TrusteeshipMgr.inst().autoFight?(game.TrusteeshipMgr.inst().setTargets([e.id]),game.TrusteeshipMgr.inst().resume()):game.FightTargetMgr.inst().start(e.id);var i=(this._pickTarget=e).data.getMonsterType();i!=game.MonsterType.BOSS&&i!=game.MonsterType.WORLD_BOSS||b8e.evt.dptG(game.BossEvents.BOSS_EMERGE)}break;case game.RoleType.Npc:game.DialogMgr.inst().pickNpcDialog(e.id);break;case game.RoleType.Door:var n=e.getScenePosition();game.MoveToHelper.inst().moveTo({x:n.x,y:n.y},0,this._onMoveToDoorComplete,this)}this._pickTarget=e}else game.FightTargetMgr.inst().stop()},selectTarget:function(e){e!=this._pickTarget&&this.pickTarget(e)},_onMoveToDoorComplete:function(){var e=game.mainRole.mainRoleEntity,t=e.gridX,i=e.gridY;game.SceneSender.moveToDoor(t,i)},showSelectTip:function(e){var t=e.getAnimator(game.AnimatorType.SELECT_TIP,1);t||(t=e.addAnimator(game.AnimatorType.SELECT_TIP,1,-999,!0));var i=game.ClientCfg.getSceneFx("circle");t.load(i,null,null,{recycleDelay:-1}),t.play()},hideSelectTip:function(e){e.getAnimator(game.AnimatorType.SELECT_TIP,1)&&e.removeAnimator(game.AnimatorType.SELECT_TIP,1)}}),game.ScenePickMgr._instance=null,game.ScenePickMgr.inst=function(){return null==game.ScenePickMgr._instance&&(game.ScenePickMgr._instance=new game.ScenePickMgr),game.ScenePickMgr._instance}},{}],1548:[function(e,t,i){"use strict";game.SceneQuickEnterMgr=b8e.Object.extends({name:"SceneQuickEnterMgr",_quickEnterMap:null,ctor:function(){if(1==game.SceneQuickEnterMgr._singleton)throw new Error("SceneQuickEnterMgr 只能通过单例方法获取");this._super(),this._quickEnterMap=b8e.HashMap.get()},addQuickEnter:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=game.SceneMgr.inst().getSceneConfig();s&&(s.isQuickEnter?i.call(e,n):this._quickEnterMap.set(t,{callback:i,obj:{thisArg:e,data:n}}))},spitOutQuickEnter:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e&&e.isQuickEnter){var t=this._quickEnterMap.count();if(t&&0<t){var i=this._quickEnterMap.values();if(!i||i.length<=0)return;for(var n=0;n<i.length;n++){var s=i[n];s&&s.callback.call(s.obj.thisArg,s.obj.data)}this._quickEnterMap.clear()}}},delQuickEnter:function(e){this._quickEnterMap.del(e)}}),game.SceneQuickEnterMgr._instance=null,game.SceneQuickEnterMgr._singleton=!0,game.SceneQuickEnterMgr.inst=function(){return game.SceneQuickEnterMgr._instance||(game.SceneQuickEnterMgr._singleton=!1,game.SceneQuickEnterMgr._instance=new game.SceneQuickEnterMgr,game.SceneQuickEnterMgr._singleton=!0),game.SceneQuickEnterMgr._instance}},{}],1549:[function(e,t,i){"use strict";game.SceneRoleCmd=game.BaseBean.extends({start:function(){b8e.net.sub({SceneUnitNotify:this.onSceneUnitNotify,MoveToNotify:this.MoveToNotify,LeaveNotify:this.LeaveNotify,MoveToMapNotify:this.MoveToMapNotify,MovePosNotify:this.MovePosNotify,DoorResponse:this.DoorResponseNotify,MoveToMapResponse:this.onMoveToMapResponse,EnterInsResponse:this.EnterInsResponse,StopMoveNotify:this.onStopMoveNotify,AppearanceUpdateNotify:this.onAppearanceUpdateNotify,RideStatusUpdateNotify:this.onRideStatusUpdateNotify,EndTalkWithNpcResponse:this.onEndTalkWithNpcNotify,KillPlayerNotify:this.onKillPlayerNotify,ExpNotify:this.ExpNotify,AttrUpdateNotify:this.AttrUpdateNotify,DropItemNotify:this.onDropItemNotify,DropOwnerUpdateNotify:this.onDropOwnerUpdateNotify,GuajiRewardRateNotify:this.onGuajiRewardRateNotify,WorldBossListResponse:this.onWorldBossListResponse,WorldBossInfoResponse:this.onWorldBossInfoResponse,WorldBossInspireResponse:this.onWorldBossInspireResponse,WorldBossNotify:this.onWorldBossNotify,EnterWorldBossSceneResponse:this.onEnterWorldBossSceneResponse,WorldBossAwardNotify:this.onWorldBossAwardNotify,LineNotify:this.onLineNotify,LineInfoResponse:this.onLineInfoResponse,TransferResponse:this.onTransferResponse,PaodianNotify:this.onPaodianNotify},game.pbmid.Scene,this)},onGuajiRewardRateNotify:function(e){var t=e.readProtobuf(game.pbmsg.GuajiRewardRateNotify);t&&game.SceneDesMgr.inst().showSceneDesPrize(t)},onDropOwnerUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.DropOwnerUpdateNotify);t&&game.BossMgr.inst().setOwner(t)},onDropItemNotify:function(e){var t=e.readProtobuf(game.pbmsg.DropItemNotify);t&&game.sceneRole.createDropItems(t)},onWorldBossListResponse:function(e){var t=e.readProtobuf(game.pbmsg.WorldBossListResponse);t&&game.worldBoss.setWorldBoss(t)},onWorldBossInfoResponse:function(e){var t=e.readProtobuf(game.pbmsg.WorldBossInfoResponse);t&&game.worldBoss.setWorldBossById(t)},onWorldBossInspireResponse:function(e){var t=e.readProtobuf(game.pbmsg.WorldBossInspireResponse),i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.worldBoss.inspireComplete(t)},onWorldBossNotify:function(e){var t=e.readProtobuf(game.pbmsg.WorldBossNotify);t&&game.worldBoss.setWorldBossStateById(t.id,t.state)},onEnterWorldBossSceneResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterWorldBossSceneResponse).code;0<t?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t)):game.worldBoss.enterSceneComplete()},onWorldBossAwardNotify:function(e){var t=e.readProtobuf(game.pbmsg.WorldBossAwardNotify);t&&game.worldBoss.setWorldBossAwardInfo(t)},AttrUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.AttrUpdateNotify);if(t){var i=game.sceneRole.getDisplayById(t.eid);if(i&&i.data){if(i.data.type==game.RoleType.Monster)if(i.data.getMonsterType()==game.MonsterType.WORLD_BOSS)return void game.worldBoss.setSceneWorldBoss();var n=i.data.spriteStat.getStatValue(game.SpriteStatType.HP);i.data.spriteStat.update(t.stat),b8e.evt.dptG(game.AttributesEvents.ATTR_UPDATA),i.data.spriteStat.getStatValue(game.SpriteStatType.HP)<=0?i.usable&&!i.getStateMachine().isDeadState()&&i.transitionState(game.RoleStateType.ACTION_DEATH,null,!0):n<=0&&i.transitionState(game.RoleStateType.ACTION_IDLE,null,!0),game.SceneMgr.inst().IsEntityVisible()&&i.updateHpBar()}else b8e.log("AttrUpdateNotify Entity 没有找到",t.eid)}},ExpNotify:function(e){var t=e.readProtobuf(game.pbmsg.ExpNotify);if(t){var i=game.mainRole.mainRoleData;if(t.levelup){i.exp=t.levelup.exp,i.spriteStat.setStatValue(game.SpriteStatType.LV,t.levelup.level),b8e.evt.dptG(game.RoleDataEvent.MAIN_ROLE_LEVEL_UP),game.autoEquip.onChangeEquip();var n=game.mainRole.mainRoleEntity;if(n){n.updateLevel(),b8e.evt.dptG(game.ActiveBarEvent.ACTIVE_BAR_CHANGE);var s=game.ClientCfg.getSceneFx("levelUp"),a=n.getPosition();game.EffectUtil.playEffect(n,s,0,a)}game.sdk.levelUpLog()}else{var o=!1;i.exp=i.exp+t.exp;var r=game.mainRole.mainRoleData.getLv(),h=game.ccfg.ExpCfg.getExpByLevel(r);i.exp>=h&&(i.exp=h-1,o=!0);var g=game.SceneMgr.inst().sceneId,l=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CHANG_AN_SCENE_ID);game.sceneRole.isInBubbleExp&&g==l&&(o?game.notice.show("等级已满，转生后方可继续升级"):game.notice.show(100009,[game.sceneRole.bubbleExpRate,t.exp])),game.sceneRole.isEnterSuraExpUp&&(o?game.notice.show("等级已满，转生后方可继续升级"):game.notice.show(100009,[game.sceneRole.suraExpRate,t.exp]))}b8e.evt.dptG(game.RoleDataEvent.MAIN_ROLE_EXP_CHANGE)}},onRideStatusUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.RideStatusUpdateNotify);if(t){var i=game.sceneRole.getDisplayById(t.eid);if(i&&i.data&&i.data.heroModel){i.data.isRiding=t.isRiding;var n=i.getStateMachine();t.isRiding?i.transitionState(game.RoleStateType.CONTROL_RIDE):n.removeState(game.RoleStateType.CONTROL_RIDE),n.updateAvatar()}}},onEndTalkWithNpcNotify:function(e){var t=e.readProtobuf(game.pbmsg.EndTalkWithNpcResponse);if(t){var i=t.code;0<i&&game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i))}},onAppearanceUpdateNotify:function(e){var t=e.readProtobuf(game.pbmsg.AppearanceUpdateNotify);if(t){var i=game.sceneRole.getDisplayById(t.eid);i&&i.data&&i.data.heroModel&&(i.data.heroModel.setup(t.appearance),i.data.avatarInfo.setup(i.data.heroModel),game.AvatarUtil.updateAvatar(i),1==i.data.isSelf&&b8e.evt.dptG(game.RoleDataEvent.MAIN_ROLE_APPEARANCE_UPDATE))}},EnterInsResponse:function(e){var t=e.readProtobuf(game.pbmsg.EnterInsResponse);if(t){var i=t.code;0<i?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(i)):game.leaveDungeon.show(0,game.SceneType.MAIN_QUEST_DUNGEON)}},onStopMoveNotify:function(e){var t=e.readProtobuf(game.pbmsg.StopMoveNotify);if(t){var i=game.sceneRole.getDisplayById(t.id);i&&i.data&&i&&0==i.data.isSelf&&(i.setGridPosition(t.pos.x,t.pos.y),i.transitionState(game.RoleStateType.ACTION_IDLE))}},onMoveToMapResponse:function(e){var t=e.readProtobuf(game.pbmsg.MoveToMapResponse);t&&(0==t.code?b8e.log("地图传送成功"):game.notice.show(game.ccfg.ServerCodeCfg.getDesc(t.code)))},DoorResponseNotify:function(e){var t=e.readProtobuf(game.pbmsg.DoorResponse);if(t){var i=t.code;if(0<i)b8e.error(game.ccfg.ServerCodeCfg.getDesc(i));else if(t.door){var n=game.mainRole.mainRoleEntity;game.EventAreaChecker.moveEffect(n)}else b8e.error("传送门未找到！")}},MovePosNotify:function(e){var t=e.readProtobuf(game.pbmsg.MovePosNotify);if(t){var i=game.sceneRole.getDisplayById(t.id);i&&(i.setGridPosition(t.pos.x,t.pos.y),i.data.isSelf&&game.quest.isCanAuto&&game.quest.isAuto&&game.quest.autoQuest())}},MoveToMapNotify:function(e){var t=e.readProtobuf(game.pbmsg.MoveToMapNotify);if(t){var i=game.mainRole.mainRoleData;i.mapId=t.mapid,i.loginPosition=cc.v2(t.pos.x,t.pos.y),game.sceneRole.setLine(t.line),game.mainProcess.runSceneProcess(),0<t.unitId&&game.mainRole.updateRoleData(t.unitId)}},LeaveNotify:function(e){var t=e.readProtobuf(game.pbmsg.LeaveNotify);if(t){var i=game.sceneRole.getDisplayById(t.id);if(i&&i.data){var n,s=b8e.scene.getDisplayByTypeAndId(game.RoleType.Follower,t.id);s&&(n=s.getController(),i.removeSyncInfo(n),b8e.scene.removeDisplay(s));var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Ornament,t.id);a&&((n=a.getController()).release(),i.removeSyncInfo(n),b8e.scene.removeDisplay(a));var o=b8e.scene.getDisplayByTypeAndId(game.RoleType.Beauty,t.id);o&&((n=o.getController()).release(),i.removeSyncInfo(n),b8e.scene.removeDisplay(o)),b8e.scene.removeDisplay(i),game.ScenePickMgr.inst().getTarget()==t.id&&game.ScenePickMgr.inst().selectTarget(null)}else b8e.log("没有找到指定的需要删除的场景实体",t.id)}},MoveToNotify:function(e){var t=e.readProtobuf(game.pbmsg.MoveToNotify);if(t){var i=game.sceneRole.getDisplayById(t.id);if(i&&i.data){var n=b8e.SceneMgr.inst().getActiveScene();if(0==i.data.isSelf){var s=n.getPixelPosByGrid(t.targetPos.x,t.targetPos.y);game.MoveToHelper.inst().entityMoveTo(i,t.targetPos,t.ts,null,null,null,s)}}}},onSceneUnitNotify:function(e){var a=game.pbmsg,t=e.readProtobuf(a.SceneUnitNotify);if(t){var o=game.mainRole.mainRoleData;t.list.forEach(function(e){if(e.id!=o.id){var t=game.sceneRole.getDisplayById(e.id);if(t)b8e.warn("服务器发送的某个角色重复了",e.type,b8e.TimeUtil.formatTimestamp(game.SysTime.curTime)),b8e.scene.removeDisplay(t),game.ScenePickMgr.inst().getTarget()==e.id&&game.ScenePickMgr.inst().selectTarget(null);if(e.type==a.SceneUnit.Type.TPlayer){var i=game.HeroData.get();i.setHeroData(e);var n=game.sceneRole.createHero(i);game.AvatarUtil.updateDujieSpAnim(n)}else{if(e.type!=a.SceneUnit.Type.TMonster)return void b8e.log("生成了类型我不知道是什么的东西",e.type);var s=game.MonsterData.get();s.setMonsterData(e),s.getMonsterType()==game.MonsterType.WORLD_BOSS&&game.worldBoss.updateWorldBossInfo(),game.sceneRole.createMonster(s)}}},this)}},onLineNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.LineNotify);if(i){var n=i.line;game.sceneRole.setLine(n)}},onLineInfoResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.LineInfoResponse);if(i){var n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):game.sceneRole.showLineMenu(i.line,i.lines)}},onTransferResponse:function(e){var t=game.pbmsg,i=e.readProtobuf(t.TransferResponse);if(i){var n=i.code;0<n?game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n)):b8e.evt.dptG(game.SceneEvent.UPDATE_LINE)}},onPaodianNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.PaodianNotify);if(i){var n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{game.sceneRole.isInBubbleExp=i.state,game.sceneRole.bubbleExpRate=i.rate,game.sceneRole.bubbleStarTime=i.startTime,game.sceneRole.bubbleEndTime=i.endTime,b8e.evt.dptG(game.SanzangjiangjinEvent.UPDATE_VIEW);var s=game.SceneMgr.inst().sceneId,a=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.CHANG_AN_SCENE_ID);i.state?(game.app.show(game.AppConstant.BUBBLE_EXP_ALERT),s==a&&(game.app.isShow(game.AppConstant.SANZANG_JIANGJIN_PANEL)||game.app.show(game.AppConstant.SANZANG_JIANGJIN_PANEL))):(game.app.isShow(game.AppConstant.BUBBLE_EXP_ALERT)&&game.app.hide(game.AppConstant.BUBBLE_EXP_ALERT),s==a&&game.app.isShow(game.AppConstant.SANZANG_JIANGJIN_PANEL)&&game.app.hide(game.AppConstant.SANZANG_JIANGJIN_PANEL),game.notice.show("三藏讲经活动已结束！")),b8e.evt.dptG(game.SuraEvent.UPDATA_SCORE)}}},onKillPlayerNotify:function(e){var t=game.pbmsg,i=e.readProtobuf(t.KillPlayerNotify);if(i){var n=i.code;if(0<n)game.notice.show(game.ccfg.ServerCodeCfg.getDesc(n));else{var s=game.ccfg.LangCfg.getText(10402,[i.killerName]);game.chat.addSystemChat(s),game.notice.show(60001,[i.killerName])}}}})},{}],1550:[function(e,t,i){"use strict";game.SceneRoleMgr=b8e.Object.extends({_lineArr:null,isInBubbleExp:!1,bubbleExpRate:0,isEnterSuraExpUp:!1,bubbleStarTime:0,bubbleEndTime:0,suraExpRate:0,ctor:function(){if(1==game.SceneRoleMgr._singleton)throw new Error("SceneRoleMgr 只能通过单例方法获取");this._lineArr=[]},_robotId:1e8,_wingId:1,_mountId:2,_fabaoId:3,createRobot:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;for(e<1&&(e=1);0<e;){var t=game.ccfg.GlobalCfg.getValue("nanxing"),i=game.ccfg.GlobalCfg.getValue("nanming"),n=t.split(","),s=i.split(","),a=game.HeroData.get(),o=n[Math.floor(n.length*Math.random())],r=s[Math.floor(s.length*Math.random())],h=game.ccfg.BianshenCfg.datas,g=h.keys(),l=h.get(g[g.length*Math.random()>>0]),c=game.ccfg.HeroCfg.getHeroCfgById(l.id);a.name=o+r,a.type=1e8,a.id=this._robotId,a.spellList=[];for(var u=c.spellList.length,m=0;m<u;m++){var _=game.ccfg.SpellCfg.getSpellById(c.spellList[m]);_?a.spellList.push(_):b8e.warn("技能ID:"+c.spellList[m]+"不存在！")}a.spellList.sort(this.sortSkill);var d=game.mainRole.mainRoleEntity;a.loginPosition={},a.loginPosition.x=d.gridX,a.loginPosition.y=d.gridY,a.spriteStat=game.ccfg.SpriteStatCfg.getSpriteStatById(l.attr);var f=game.SceneRole.get(a.type,a.id);f.data=a,f.data.heroModel=new game.HeroModel,f.data.heroModel._heroModel={},f.data.heroModel._heroModel.bodyId=l.id,f.data.heroModel._heroModel.mountLv=this._mountId+200*Math.random()>>0,f.data.heroModel._heroModel.wingLv=this._wingId+200*Math.random()>>0,f.data.heroModel._heroModel.fabaoLv=this._fabaoId+200*Math.random()>>0,f.data.avatarInfo.setup(f.data.heroModel),f.data.avatarInfo.wingResId=390*Math.random()>>0,game.AvatarUtil.updateAvatar(f),f.setGridPosition(a.loginPosition.x,a.loginPosition.y),f.transitionState(game.RoleStateType.CONTROL_RIDE),f.transitionState(game.RoleStateType.ACTION_IDLE),f.getAiMachine().autoRun(),b8e.scene.addDisplay(f,void 0,!0,!0),this._robotId++,e--}},sortSkill:function(e,t){return e.sort>t.sort?-1:e.sort<t.sort?1:e.id>t.id?1:-1},createClientMonster:function(e){var t=game.MonsterData.get();t.isClientRole=!0,t.id=e.id,t.direction=e.direction,t.loginPosition=cc.v2(e.pos.X,e.pos.Y),t.scale=e.scale/100,t.name=e.name,t.baseSpriteStat.setStatValue(game.SpriteStatType.ATK,e.atk),t.baseSpriteStat.setStatValue(game.SpriteStatType.DEF,e.def),t.spriteStat.setStatValue(game.SpriteStatType.LV,e.level),t.spriteStat.setStatValue(game.SpriteStatType.MAXHP,e.maxhp),t.spriteStat.setStatValue(game.SpriteStatType.HP,e.maxhp),t.spellList=[];for(var i=e.spellList.split("|"),n=i.length,s=0;s<n;s++){var a=game.ccfg.SpellCfg.getSpellById(Number(i[s]));a?t.spellList.push(a):b8e.warn("技能ID:"+spellList[s]+"不存在！")}var o=game.SceneRole.get(t.type,t.id);o.data=t,o.data.avatarInfo.bodyRes=e.bodyResID;var r=t.scale;o.setScale(r,r),o.setTouchable(!0),o.setScenePosition(t.loginPosition.x,t.loginPosition.y);var h=game.Direction.getAnimatDirection(t.direction);return o.setDirection(h),o.addVisibledCallback(function(){game.AvatarUtil.updateBodyAvatar(o),o.transitionState(game.RoleStateType.ACTION_IDLE)},this),b8e.scene.addDisplay(o,void 0,!0,!0),o},createMainRole:function(){var e=game.mainRole.mainRoleData,t=game.mainRole.mainRoleEntity;if(t){var i,n=b8e.scene.getDisplayByTypeAndId(game.RoleType.Follower,t.id);n&&(i=n.getController(),t.removeSyncInfo(i),b8e.scene.removeDisplay(n));var s=b8e.scene.getDisplayByTypeAndId(game.RoleType.Ornament,t.id);s&&((i=s.getController()).release(),t.removeSyncInfo(i),b8e.scene.removeDisplay(s));var a=b8e.scene.getDisplayByTypeAndId(game.RoleType.Beauty,t.id);a&&((i=a.getController()).release(),t.removeSyncInfo(i),b8e.scene.removeDisplay(a)),b8e.scene.modifyDisplayId(t,e.id),game.BuffUtil.resetBuff(),game.BuffUtil.setBuffs(t),game.AvatarUtil.updateAvatar(t),t.data.spriteStat.getStatValue(game.SpriteStatType.HP)<=0?t.usable&&!t.getStateMachine().isDeadState()&&t.transitionState(game.RoleStateType.ACTION_DEATH,null,!0):(e.isRiding&&t.transitionState(game.RoleStateType.CONTROL_RIDE,null,!0),game.app.hide(game.AppConstant.RELIVE_PANEL),t.transitionState(game.RoleStateType.ACTION_IDLE,null,!0))}else{t=this.createHero(e),game.AvatarUtil.updateDujieSpAnim(t);var o=new game.EventAreaChecker;t.addSyncInfo(new b8e.SceneDisplaySyncInfo(o)),game.mainRole.setMainRoleEntity(t)}},createHero:function(t){var i=game.SceneRole.get(t.type,t.id);i.data=t,i.isUniqueId=!0,i.clearDisabled=t.isSelf;var e=game.SceneMgr.inst().isHeroTouchable()&&!t.isSelf;return i.setTouchable(e),game.BuffUtil.setBuffs(i),i.setGridPosition(t.loginPosition.x,t.loginPosition.y),i.addVisibledCallback(function(){var e=new game.SafeAreaChecker;i.addSyncInfo(new b8e.SceneDisplaySyncInfo(e)),game.AvatarUtil.updateAvatar(i),i.data.spriteStat.getStatValue(game.SpriteStatType.HP)<=0?i.usable&&!i.getStateMachine().isDeadState()&&i.transitionState(game.RoleStateType.ACTION_DEATH,null,!0):t.isRiding&&i.transitionState(game.RoleStateType.CONTROL_RIDE)},this),b8e.scene.addDisplay(i,void 0,!t.isSelf,!t.isSelf,!t.isSelf),i},createMonster:function(t){var i=game.SceneRole.get(t.type,t.id);i.data=t,i.data.avatarInfo.bodyRes=t.getResId();var e=t.getConfigScale();i.setScale(e,e),i.isUniqueId=!0,i.setTouchable(!0),i.setGridPosition(t.loginPosition.x,t.loginPosition.y);var n=game.Direction.getAnimatDirection(t.direction);return i.setDirection(n),game.BuffUtil.setBuffs(i),i.addVisibledCallback(function(){var e=0;switch(t.getMonsterType()){case game.MonsterType.Mon2:e=60061;break;case game.MonsterType.BOSS:case game.MonsterType.WORLD_BOSS:e=60060}e&&this.addApertureEffect(i,e),game.AvatarUtil.updateBodyAvatar(i),i.transitionState(game.RoleStateType.ACTION_IDLE)},this),b8e.scene.addDisplay(i),i},createDoors:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e){var t=game.ccfg.DoorCfg.getDataById(e.id);t&&0<t.length&&t.forEach(function(e){var t=game.DoorData.get();t.setDoorData(e);var i=game.SceneRole.get(t.type,t.id);i.data=t,i.data.avatarInfo.bodyRes=t.getResId(),i.data.avatarInfo.bodyRes&&game.AvatarUtil.updateBodyAvatar(i),i.setTouchable(!0),i.setScenePosition(t.loginPosition.x,t.loginPosition.y),i.transitionState(game.RoleStateType.ACTION_IDLE),b8e.scene.addDisplay(i)},this)}},createNpcs:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e){var t=game.ccfg.NpcGenCfg.getNpcGenListBySceneId(e.id);t&&0<t.length&&t.forEach(function(e){var t=game.NpcData.get();t.setNpcCfg(e);var i=game.SceneRole.get(t.type,t.id);i.data=t,i.data.avatarInfo.bodyRes=t.bodyRes,i.data.avatarInfo.mountResId=t.mountResId,i.data.avatarInfo.wingResId=t.wingResId,i.data.avatarInfo.faBaoResId=t.faBaoResId,i.setScale(t.scale,t.scale),i.setTouchable(!0);var n=game.Direction.getAnimatDirection(t.direction);i.setDirection(n),i.setScenePosition(t.loginPosition.x,t.loginPosition.y),i.addVisibledCallback(function(){game.AvatarUtil.updateAvatar(i),i.transitionState(game.RoleStateType.ACTION_IDLE)},this),b8e.scene.addDisplay(i)},this)}},createClientEntitys:function(){var e=game.SceneMgr.inst().getSceneConfig();if(e){var t=game.ccfg.ClientEntityCfg.getClientEntityListBySceneId(e.id);t&&0<t.length&&t.forEach(function(e){var t=game.ClientEntityData.get();t.setData(e);var i=game.SceneRole.get(t.type,t.id);i.data=t,i.data.avatarInfo.bodyRes=t.bodyRes,i.data.avatarInfo.mountResId=t.mountResId,i.data.avatarInfo.wingResId=t.wingResId,i.data.avatarInfo.faBaoResId=t.faBaoResId,i.setScale(t.scale,t.scale),i.setTouchable(!0);var n=game.Direction.getAnimatDirection(t.direction);i.setDirection(n),i.setScenePosition(t.loginPosition.x,t.loginPosition.y),i.addVisibledCallback(function(){game.AvatarUtil.updateAvatar(i),i.transitionState(game.RoleStateType.ACTION_IDLE)},this),b8e.scene.addDisplay(i)},this)}},_tempAmountInfo:null,createDropItems:function(e){if(e&&e.userItem){var t,i,n=[],s=e.userItem.list,a=e.userItem.amount;if(s)for(i=0;i<s.length;i++){var o=s[i];(t=game.DropItemData.get()).setItemData(o),n.push(t)}if(a&&a.list&&0<a.list.length){this._tempAmountInfo||(this._tempAmountInfo=new game.AmountInfo),this._tempAmountInfo.resetData(),this._tempAmountInfo.setData(a);var r=this._tempAmountInfo.getAllDatas();for(i=0;i<r.length;i++)0<(o=r[i]).value&&((t=game.DropItemData.get()).setAmountDropData(o),n.push(t))}if(game.SceneMgr.inst().sceneId==e.mapid){var h,g,l,c=9<n.length?9:n.length,u=Math.floor(Math.sqrt(c));h=b8e.scene.getPixelPosByGrid(e.pos.x,e.pos.y),h=b8e.scene.sceneUIToGLPos(h.x,h.y);var m=game.mainRole.mainRoleEntity,_=-u/2*100;for(i=0;i<c;i++){t=n[i],g=h.x-i%u*100-_,l=h.y-100*Math.floor(i/u)-_,t.setPosition(cc.v2(h.x,h.y));var d=game.SceneRole.get(t.type,t.id);d.data=t,d.setPosition(g,l),d.addVisibledCallback(function(s){return function(){var e=s.data,t=b8e.Sprite.get();t.loadTexture(e.getResId(),null,null,{useManifest:!1}),t.setScale(.5,.5),t.setPosition(-20,0),t.setAnchor(.5,.5),b8e.stage.addChild(t);var i=s.getAnimator(game.AnimatorType.BODY,1);i.addChildToBindNode(t,"body");var n="";switch(e.quality){case game.Quality.Q_PURPLE:n=game.ClientCfg.getSceneFx(10080);break;case game.Quality.Q_YELLOW:n=game.ClientCfg.getSceneFx(10081);break;case game.Quality.Q_RED:n=game.ClientCfg.getSceneFx(10082)}n&&((i=s.getAnimator(game.AnimatorType.DROP_ITEM_EFFECT,1))||(i=s.addAnimator(game.AnimatorType.DROP_ITEM_EFFECT,1,1e3,!0)),i.setBlendMode(b8e.BlendMode.LIGHTEN),i.load(n),i.play())}}(d),this),b8e.Tween.get(d).wait(1500).to({x:m.x,y:m.y},300,b8e.Ease.quadIn).call(this._onDropItemTweenComplete,this,[d]),b8e.scene.addDisplay(d)}}}},_onDropItemTweenComplete:function(e){e.usable&&b8e.scene.removeDisplay(e)},createFollower:function(e,t){if(e&&e.data){var i=game.FollowerData.get();i.setData(e.data.id,t);var n=game.SceneFollower.get(game.RoleType.Follower,i.id);n.data=i,n.clearDisabled=e.data.isSelf;var s=new game.FollowController(n,e);e.addSyncInfo(s.displaySyncInfo),n.setController(s);var a=e.getPosition();return n.setPosition(a.x+50,a.y+100),n.setTouchable(!1),n.addVisibledCallback(function(){game.AvatarUtil.updateBodyAvatar(n),n.getAnimator(game.AnimatorType.BODY,1).play()},this),b8e.scene.addDisplay(n,void 0,!0,!0),n}},createOrnament:function(e){if(e&&e.data){var t=game.FollowerData.get();t.setOrnamentData(e.data,e.data.avatarInfo.ornamentResId);var i=game.SceneFollower.get(game.RoleType.Ornament,t.id);i.data=t,i.clearDisabled=e.data.isSelf;var n=new game.FollowController(i,e,!0);e.addSyncInfo(n.displaySyncInfo),i.setController(n);var s=e.getPosition();return i.setPosition(s.x-50,s.y+100),i.setTouchable(!1),i.addVisibledCallback(function(){game.AvatarUtil.updateBodyAvatar(i),i.getAnimator(game.AnimatorType.BODY,1).play()},this),b8e.scene.addDisplay(i,void 0,!0,!0),i}},createBeauty:function(e){if(e&&e.data){var t=game.FollowerData.get();t.setBeautyData(e.data,e.data.avatarInfo.beautyResId);var i=game.SceneFollower.get(game.RoleType.Beauty,t.id);i.data=t,i.clearDisabled=e.data.isSelf;var n=new game.FollowController(i,e,!0);e.addSyncInfo(n.displaySyncInfo),i.setController(n);var s=e.getPosition();return i.setPosition(s.x+50,s.y+100),i.setTouchable(!1),i.addVisibledCallback(function(){game.AvatarUtil.updateBodyAvatar(i),i.getAnimator(game.AnimatorType.BODY,1).play()},this),b8e.scene.addDisplay(i,void 0,!0,!0),i}},addApertureEffect:function(e,t){if(e&&t){var i=e.getAnimator(game.AnimatorType.APERTURE_EFFECT,1);i||(i=e.addAnimator(game.AnimatorType.APERTURE_EFFECT,1,-1e4,!0));var n=game.ClientCfg.getSceneFx(t);i.load(n,null,null,{priority:10}),i.play();var s=1/e.getScene().getSceneScale()/e.scaleX;i.setScale(s,s)}},getDisplayById:function(e){var t;return(t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Hero,e))?t:(t=b8e.scene.getDisplayByTypeAndId(game.RoleType.Monster,e))?t:t=b8e.scene.getDisplayById(e)},getDisplayByTypeAndId:function(e,t){return b8e.scene.getDisplayByTypeAndId(e,t)},setLine:function(e){game.mainRole.mainRoleData.setLine(e),b8e.evt.dptG(game.SceneEvent.UPDATE_LINE)},showLineMenu:function(e,t){for(var i=this._lineArr.length=0;i<t.length;i++){var n=t[i];-1!=n&&(n!=e&&this._lineArr.push(n))}this._lineArr&&0<this._lineArr.length&&this._lineArr.sort(this.onSort),b8e.evt.dptG(game.SceneEvent.SHOW_LINE_MENU)},getLines:function(){return this._lineArr},onSort:function(e,t){return t<e?1:e<t?-1:0},initSpotAlert:function(){game.spotAlert.addSpotAlert(game.SpotAlertTargetType.SANZHANGJIANGJIN_ALERT,null,this.jiangjingAlert,this)},jiangjingAlert:function(){return this.isInBubbleExp}}),game.SceneRoleMgr._instance=null,game.SceneRoleMgr._singleton=!0,game.SceneRoleMgr.inst=function(){return null==game.SceneRoleMgr._instance&&(game.SceneRoleMgr._singleton=!1,game.SceneRoleMgr._instance=new game.SceneRoleMgr,game.SceneRoleMgr._singleton=!0),game.SceneRoleMgr._instance}},{}],1551:[function(e,t,i){"use strict";var n=game.SceneSender=function(){};n.changeChar=function(e){var t=game.pbmsg.ChangeShapeRequest;t.newShapeId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Char.ChangeShapeRequest;b8e.sendN(i)},n.enterAloneDungeon=function(){var e=game.pbmid.Scene.EnterInsRequest;b8e.sendN(e)},n.leaveAloneDungeon=function(){var e=game.pbmid.Scene.LeaveInsRequest;b8e.sendN(e)},n.moveToDoor=function(e,t){var i=game.pbmsg.DoorRequest;i.pos={x:e,y:t},engine.NetSender.getBytes().writeProtobuf(i);var n=game.pbmid.Scene.DoorRequest;b8e.sendN(n)},n.moveToRequest=function(e,t,i){var n=game.pbmsg.MoveToMapRequest;n.mapid=t,(n.type=e)==game.SceneTransType.TYPE_MAIN_QUEST?n.params=i:e==game.SceneTransType.TYPE_TARGET_POS&&(n.params=i),engine.NetSender.getBytes().writeProtobuf(n);var s=game.pbmid.Scene.MoveToMapRequest;b8e.sendN(s)},n.endTalkWithNpc=function(e){var t=game.pbmsg.EndTalkWithNpcRequest;t.npcId=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.EndTalkWithNpcRequest;b8e.sendN(i)},n.bossActivityListRequest=function(){var e=game.pbmid.Scene.WorldBossListRequest;b8e.sendN(e)},n.bossActivityInfoRequest=function(e){var t=game.pbmsg.WorldBossInfoRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.WorldBossInfoRequest;b8e.sendN(i)},n.bossAcitivtyInspireRequest=function(e){var t=game.pbmsg.WorldBossInspireRequest;t.type=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.WorldBossInspireRequest;b8e.sendN(i)},n.enterWorldBossSceneRequest=function(e){var t=game.pbmsg.EnterWorldBossSceneRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.EnterWorldBossSceneRequest;b8e.sendN(i)},n.reqLine=function(){var e=game.pbmid.Scene.LineInfoRequest;b8e.sendN(e)},n.transferRequest=function(e){var t=game.pbmsg.TransferRequest;t.id=e,engine.NetSender.getBytes().writeProtobuf(t);var i=game.pbmid.Scene.TransferRequest;b8e.sendN(i)}},{}],1552:[function(e,t,i){"use strict";game.WeatherMgr=b8e.Object.extends({_sceneLayer:null,_weather:null,_particleSystem:null,ctor:function(){if(1==game.WeatherMgr._singleton)throw new Error("WeatherMgr 只能通过单例方法获取");this._sceneLayer=b8e.layer.getSceneLayer(),this._weather=new cc.Node,this._weather.setLocalZOrder(99999),this._weather.active=!0,this._sceneLayer.addChild(this._weather),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageResize)},changeWeather:function(){this._particleSystem||(this._particleSystem=this._weather.addComponent(cc.ParticleSystem),this._particleSystem.playOnLoad=!0),this._particleSystem.stopSystem();var e=game.SceneMgr.inst().getSceneConfig();if(e){if(e.particle){var t=game.ClientCfg.getParticleUrl(e.particle);this._particleSystem.file=t,this.onStageResize(),b8e.Timer.add(this,this.callLater,5e3)}}else b8e.log("找不到场景配置！")},callLater:function(){this._particleSystem.resetSystem(),b8e.Timer.remove(this,this.callLater)},onStageResize:function(){var e=b8e.stageWidth,t=b8e.stageHeight;this._weather.setPosition(.5*e,t)}}),game.WeatherMgr._instance=null,game.WeatherMgr._singleton=!0,game.WeatherMgr.inst=function(){return null==game.WeatherMgr._instance&&(game.WeatherMgr._singleton=!1,game.WeatherMgr._instance=new game.WeatherMgr,game.WeatherMgr._singleton=!0),game.WeatherMgr._instance}},{}],1553:[function(e,t,i){"use strict";var n;function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}game.AnimatorType=b8e.Enum((s(n={BODY:1,MOUNT_BODY:2,MOUNT_HEAD:3,WING:4,FA_BAO:5,SELECT_TIP:101,KNIFE_LIGHT_EFFECT:102,HIT_EFFECT:103,LEVEL_UP_EFFECT:104,RELIVE_EFFECT:105,BUFF_EFFECT:106,BIANSHEN_EFFECT:107,CORNUCOPIA_BOOM_EFFECT:108,MAIN_QUEST_COMPLETE_EFFECT:109,BEAUTY_USE_EFFECT:110,EQUIP_INTENSIFY_EFFECT:111,EQUIP_UPSTAR_EFFECT:112,SIGN_GRIDS_EFFECT:113,FIRST_RECHARGE_EFFECT:114,FIRST_RECHARGE_EFFECT_2:115,EQUIP_INTENSIFY_EFFECT_2:116,GUILD_SCORE_EFFECT:117,EQUIP_REFINE_EFFECT:118,WELFARE_EFFECT:119,DRAW_NORMAL_EFFECT:120,ITEM_EFFECT:121,DRAW_BIANSHEN_BODY:122,DRAW_PURPLE_EFFECT:123,DRAW_ORANGE_EFFECT:124,DUJIE_EFFECT:125,ACCESSORY_EFFECT:126,DUJIE_FINISHED_EFFECT:127,BIANSHEN_UPGRADE_EFFECT:128,BIANSHEN_JINJIE_EFFECT:129,ACHIEVEMENT_EFFECT:130,ACHIEVEMENT_PRIZE_EFFECT:131,ACHIEVEMENT_ALERT_EFFECT:132,ACHIEVEMENT_SCORE_ALERT_EFFECT:133,FUND_BTN_EFFECT:134,NICKNAME_EFFECT:135,REBIRTH_UPGRADE_EFFECT:136,REBIRTH_CONVERT_EFFECT:137,REBIRTH_UPGRADE_SUCCESS_EFFECT:138,DROP_ITEM_EFFECT:139,APERTURE_EFFECT:140,BIANSHEN_UPGRADE_EFFECT_2:141,HIGH_STAR_DOWN_EFFECT:142,ACCESSORY_UPGRADE_EFFECT:143,BIANSHEN_JINJIE_EFFECT_2:144,RED_PACKET_EFFECT:145,SALE_DAILY_EFFECT:146,GUILD_UPGRADE_EFFECT:147,ACTIVE_NICK_NAME_EFFECT:148,ROULETTE_EFFECT:149,EQUIP_REFINE_LEFT_EFFECT:150,EQUIP_REFINE_RIGHT_EFFECT:151,ACTIVE_ALERT_EFFECT:152,AMULET_UPGRADE_EFFECT:153,AMULET_BIGUPFRADE_EFFECT:154,TIAN_GONGBA_ZHU_EFFECT:155,COLLECT_EFFECT:156},"COLLECT_EFFECT",157),s(n,"TIAN_GONG_ICON_EFFECT",158),s(n,"TIAN_GONG_TRACK_BAR_EFFECT",159),s(n,"TIAN_GONG_QIANG_EFFECT",160),s(n,"BIANSHEN_CAN_UPGRADE_EFFECT",161),s(n,"DUJIE_UPGRADEEFFECT",162),s(n,"MILLIONAWARD_BNTEFFECT",163),s(n,"MILLION_GOLDEFFECT_1",164),s(n,"MILLION_GOLDEFFECT_2",165),s(n,"FA_BAO_NAME_EFFECT",200),s(n,"BAOZHU_EFFECT",201),s(n,"TRANSFER",202),s(n,"FLYSPELL",203),s(n,"HIGHEQUIP_EFFECT",204),s(n,"ENCHANT_EFFECT",205),s(n,"RESULT_EFFECT",206),s(n,"CSARENA_STAR_EFFECT",207),s(n,"CSARENA_BADGE_EFFECT",208),s(n,"RUNE_INTENSIFY_EFFECT",209),s(n,"TIAN_GONG_SAN_JIE_ICON_EFFECT",210),s(n,"WEEK_SIGN_EFFECT",300),s(n,"XIAN_ZHEN_EFFECT",301),s(n,"EXP_CURE_EFFECT",302),s(n,"ESCORT_FAIRY",303),s(n,"ACCESSORY_SKILL",304),s(n,"DUJIE",305),s(n,"DUJIE_PROGRESS",306),s(n,"DUJIE_UP_COMBAT",307),n))},{}],1554:[function(e,t,i){"use strict";game.AttachType=b8e.Enum({BODY:1,MOUNT:2,WING:3,FA_BAO:4,HEAD_BAR:5})},{}],1555:[function(e,t,i){"use strict";game.AvatarUtil={},game.AvatarUtil.updateAvatar=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e&&e.usable?(game.AvatarUtil.updateBodyAvatar(e,t),game.AvatarUtil.updateMountAvatar(e,t),game.AvatarUtil.updateWingAvatar(e,t),game.AvatarUtil.updateXianZhenAvatar(e,t),game.AvatarUtil.updateFaBao(e,t),game.AvatarUtil.updateOrnament(e),game.AvatarUtil.updateCornucopiaBoom(e),game.AvatarUtil.updateGuildName(e),game.AvatarUtil.updateNickName(e),game.AvatarUtil.updateBeauty(e),game.AvatarUtil.updateGuildExpCureState(e),game.AvatarUtil.updateDujieSp(e),e.updateShadow()):b8e.warn("game.AvatarUtil.updateAvatar warn")},game.AvatarUtil.updateBodyAvatar=function(e){var t,i,n,s=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||e.data.avatarInfo;(t=s.surfaceBodyRes&&s.bodyResId==e.data.defaultModelId?s.surfaceBodyRes:s.bodyRes)?((i=e.getAnimator(game.AnimatorType.BODY,1))||(i=e.addAnimator(game.AnimatorType.BODY,1,10)),e.data.type==game.RoleType.Hero||(e.data.type,game.RoleType.Monster),n=game.ClientCfg.getAvatarAnim(e.data.type,t),i.soundEffectsEnabled=e.data.isSelf,i.ghostable=!0,i.load(n,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),i.play()):b8e.warn("game.AvatarUtil.updateAvatar warn dont have bodyRes")},game.AvatarUtil.updateMountAvatar=function(e){var t,i,n,s,a,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=!1;if(t=e.getAnimator(game.AnimatorType.MOUNT_BODY,1),i=e.getAnimator(game.AnimatorType.MOUNT_HEAD,1),a=(o||e.data.avatarInfo).mountResId){var h=!0;(s=game.ccfg.MountCfg.getDataById(a))&&(n=game.ClientCfg.getMount(s.sceneRes),h&&(h=!0),h&&(r=!0))}if(1!=r)return t&&t.clear(),void(i&&i.clear());t||((t=e.addAnimator(game.AnimatorType.MOUNT_BODY,1,-15,!0)).setAsBoundary(!0),t.setTouchable(!0)),t.load(n,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),t.ghostable=!0,t.play(),t.setScale(s.sceneScale,s.sceneScale),r&&s.head?(i||((i=e.addAnimator(game.AnimatorType.MOUNT_HEAD,1,11)).setAsBoundary(!0),i.setTouchable(!0)),n=game.ClientCfg.getMount(s.head),i.load(n,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),i.ghostable=!0,i.play(),i.setScale(s.sceneScale,s.sceneScale)):i&&i.clear()},game.AvatarUtil.updateWingAvatar=function(e){var t,i,n,s,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=!1;if(t=e.getAnimator(game.AnimatorType.WING,1),o=!1,s=(a||e.data.avatarInfo).wingResId){var r=!0;(n=game.ccfg.WingCfg.getDataById(s))&&(i=game.ClientCfg.getWing(n.sceneRes),r&&(r=game.AvatarUtil.canShowAvatar(e)),r&&(o=!0))}o?(t||(t=e.addAnimator(game.AnimatorType.WING,1,9)),t.load(i,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),t.ghostable=!0,t.play(),e.data.type==game.RoleType.UIRole?(t.setScale(n.uiScale,n.uiScale),t.setPosition(0,-50)):(t.setScale(n.sceneScale,n.sceneScale),t.setPosition(0,0))):t&&t.clear()},game.AvatarUtil.updateXianZhenAvatar=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e&&e.type==game.RoleType.Hero){var i,n,s=!1,a=e.getAnimator(game.AnimatorType.APERTURE_EFFECT,1),o=t||e.data.avatarInfo,r=o.xianZhenResId;r?(i=game.ccfg.XianZhenCfg.getDataById(r))&&(n=game.ClientCfg.getXianZhen(i.sceneRes),s=game.AvatarUtil.canShowAvatar(e)):e.data&&e.data.isSelf&&(n=game.ClientCfg.getSceneFx(60059),s=game.AvatarUtil.canShowAvatar(e)),s&&n?(a||(a=e.addAnimator(game.AnimatorType.APERTURE_EFFECT,1,-1e4,!0)),a.load(n,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),a.ghostable=!0,a.play(),a.setPosition(0,0),i&&a.setScale(i.sceneScale,i.sceneScale),o.mountResId&&(i=game.ccfg.MountCfg.getDataById(o.mountResId))&&a.setPosition(0,i.xzPosY)):a&&a.clear()}},game.AvatarUtil.updateFaBao=function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||e.data.avatarInfo,i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Follower,e.data.id),n=!1;if(t.faBaoResId){var s=game.ccfg.FaBaoCfg.getDataById(t.faBaoResId);s||(n=!0)}else n=!0;if(n||(n=0==game.AvatarUtil.canShowAvatar(e)),n){if(i){var a=i.getController();a.release(),e.removeSyncInfo(a),b8e.scene.removeDisplay(i)}}else i?(i.data.setData(e.data.id,t.faBaoResId),game.AvatarUtil.updateBodyAvatar(i)):i=game.sceneRole.createFollower(e,t.faBaoResId),s&&i&&i.setScale(s.sceneScale)},game.AvatarUtil.updateOrnament=function(e){var t=e.data.avatarInfo,i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Ornament,e.data.id),n=!1;if(t&&t.ornamentResId){var s=game.ccfg.OrnamentCfg.getDataByItemIdAndLv(t.ornamentResId);s||(n=!0)}else n=!0;if(n||(n=0==game.AvatarUtil.canShowAvatar(e)),n){if(i){var a=i.getController();a.release(),e.removeSyncInfo(a),b8e.scene.removeDisplay(i)}}else i?(i.data.setOrnamentData(e.data.id,t.ornamentResId),game.AvatarUtil.updateBodyAvatar(i)):i=game.sceneRole.createOrnament(e),s&&i&&i.setScale(s.sceneScale)},game.AvatarUtil.updateBeauty=function(e){var t=e.data.avatarInfo,i=b8e.scene.getDisplayByTypeAndId(game.RoleType.Beauty,e.data.id),n=!1;if(t&&t.beautyResId){var s=game.ccfg.BeautyDataCfg.getBeautyInfoById(t.beautyResId);s||(n=!0)}else n=!0;if(n||(n=0==game.AvatarUtil.canShowAvatar(e)),n){if(i){var a=i.getController();e.removeSyncInfo(a),a.release(),b8e.scene.removeDisplay(i)}}else i?(i.data.setBeautyData(e.data,t.beautyResId),game.AvatarUtil.updateBodyAvatar(i)):i=game.sceneRole.createBeauty(e),s&&i&&i.setScale(s.sceneScale)},game.AvatarUtil.updateCornucopiaBoom=function(e){var t=e.data.avatarInfo;if(t){var i=game.SceneMgr.inst().getSceneConfig();if(!i)return;i.canLootCornucopia?e.updateCornucopiaEffects(t.cornucopiaIsBoom):e.updateCornucopiaEffects(!1)}},game.AvatarUtil.updateGuildExpCureState=function(e){var t=e.data.avatarInfo,i=e.getAnimator(game.AnimatorType.EXP_CURE_EFFECT,1);if(t.expCureState){var n=e.getAnimator(game.AnimatorType.BODY,1);i||(i=e.addAnimator(game.AnimatorType.EXP_CURE_EFFECT,1,99,!0),n.addChildToBindNode(i,"head",50)),i.load(game.ClientCfg.guildExpCureEffect,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),i.ghostable=!0,i.play()}else i&&i.clear()},game.AvatarUtil.canShowAvatar=function(e){if(!b8e.isMobile)return!0;var t=game.SceneMgr.inst().sceneType;return t!==game.SceneType.SURA&&t!==game.SceneType.WORLDBOSS&&t!==game.SceneType.TIANGONG},game.AvatarUtil.updateNickName=function(e){var t=e.data.avatarInfo;t&&e.updateNickNameEffects(t.nickname)},game.AvatarUtil.updateDujieSp=function(e){e.updateDujieSp(e.data);var t=game.AvatarUtil.canShowAvatar(e);e.updateShow(t),this.updateDujieSpAnim(e)},game.AvatarUtil.updateDujieSpAnim=function(e){var t=e.data.dujie;if(0!=t){var i,n=!1,s=game.ccfg.DujieCfg.getDataByLevel(t);if(i=e.getAnimator(game.AnimatorType.DUJIE,2),n=!1,s){var a=game.ClientCfg.getDujie(s.resPath),o=!0;o&&(o=game.AvatarUtil.canShowAvatar(e)),o&&(n=!0)}n?(i||(i=e.addAnimator(game.AnimatorType.DUJIE,2,9999,!0)),i.load(a,null,null,{preload:e.data.isSelf,recycleDelay:e.data.isSelf?6e5:1e4}),i.ghostable=!0,i.play(),i.setBlendMode(b8e.BlendMode.ADD),e.data.type==game.RoleType.UIRole?(i.setScale(s.uiScale,s.uiScale),i.setPosition(0,-50)):(i.setScale(s.sceneScale,s.sceneScale),i.setPosition(0,50))):i&&i.clear()}},game.AvatarUtil.updateGuildName=function(e){e.updateGuildName(e.data)}},{}],1556:[function(e,t,i){"use strict";var _=game.EventAreaChecker=b8e.Object.extends({ctor:function(){this._super()},syncGridInfo:function(e,t){e.getStateMachine().isJumpMoving()||_.checkEffect(e)}});_.currSelfStartEvent=null,_.currSelfMoveEvent=null,_.endPosTaget=null,_.completeEvent=null,_.completeThisArg=null,_.args=null,_.checkEffect=function(e){var t=e.gridX,i=e.gridY,n=b8e.scene.getMapLayer().getEarthSurface(),s=n.getGridEventType(t,i),a=null;if(0<s&&(a=game.ccfg.ClientAreaEventCfg.getDataById(s)),a)for(var o=a.eventType.split(","),r=o.length,h=0;h<r;h++){var g=o[h];switch(g){case game.ClientAreaEvent.moveToDoor:if(-1<o.indexOf(game.ClientAreaEvent.playJumpEffect)){b8e.warn("[配置异常]区域事件id:"+s+"作为playJumpEffect不能再作为moveToDoor存在！");break}if(e.data.isSelf){_.currSelfStartEvent=a,_.currSelfMoveEvent=a;t=e.gridX,i=e.gridY;game.SceneSender.moveToDoor(t,i)}break;case game.ClientAreaEvent.playJumpEffect:if(-1<o.indexOf(game.ClientAreaEvent.moveToDoor)){b8e.warn("[配置异常]区域事件id:"+s+"作为moveToDoor不能再作为playJumpEffect存在！");break}e.data.isSelf?_.currSelfStartEvent&&_.currSelfStartEvent.flag==a.flag&&(_.currSelfMoveEvent=a,_.moveEffect(e)):_.moveEffect(e);break;case game.ClientAreaEvent.endDoor:if(-1<o.indexOf(game.ClientAreaEvent.moveToDoor)){b8e.warn("[配置异常]区域事件id:"+s+"作为moveToDoor不能再作为endDoor存在！");break}if(-1<o.indexOf(game.ClientAreaEvent.playJumpEffect)){b8e.warn("[配置异常]区域事件id:"+s+"作为playJumpEffect不能再作为endDoor存在！");break}if(e.data.isSelf&&_.currSelfStartEvent&&_.currSelfStartEvent.flag==a.flag){_.currSelfMoveEvent=null,_.currSelfStartEvent=null;var l=e.getStateMachine(),c=l.getReference(game.WalkMoveStateReference),u=c.path;if(u&&1<u.length){var m=u[u.length-1];n.gridIsSpecifyType(m.x,m.y,b8e.MapGridType.EVENT)||((c=l.getReference(game.WalkStateReference)).moveToPos=m,e.transitionState(game.RoleStateType.ACTION_WALK,c,!0))}}break;default:e.data.isSelf&&(_.currSelfMoveEvent=null,_.currSelfStartEvent=null,b8e.warn("[配置异常]区域事件id:"+s+"存在无效事件["+g+"]！"))}}},_.eac=function(){if(!game.mainRole.mainRoleEntity.getStateMachine().isJumpMoving()){var e=b8e.scene.getPixelPosByGrid(game.EventAreaChecker.endPosTaget.x,game.EventAreaChecker.endPosTaget.y);if(_.completeEvent){var t=_.completeThisArg?_.completeThisArg:this;game.MoveToHelper.inst().moveTo(e,0,_.completeEvent,t,_.args,!0,null!=_.completeThisArg)}else game.MoveToHelper.inst().moveTo(e)}},_.moveEffect=function(e){var t=null;if(e.data.isSelf)t=_.currSelfMoveEvent;else{var i=e.gridX,n=e.gridY,s=b8e.scene.getMapLayer().getEarthSurface().getGridEventType(i,n);0<s&&(t=game.ccfg.ClientAreaEventCfg.getDataById(s))}if(t){var a=null;t.sceneEffectId&&(a=game.ccfg.ClientSceneEffectCfg.getDataById(t.sceneEffectId)),a?_.playGhostEffect(e,a.ghostSpacing,a.ghostDuration,a.jumpDownX,a.jumpDownY,a.jumpUpTime,a.jumpDownTime,a.jumpHeight):b8e.warn("[配置异常]区域事件id:"+s+"配置的sceneEffectId:"+t.sceneEffectId+"无效！")}},_.playGhostEffect=function(e,t,i,n,s,a,o,r){var h=e.getStateRef(game.JumpStateReference);h.setParams({x:n,y:s},100,a,o,r,t,i),e.transitionState(game.RoleStateType.ACTION_JUMP,h)}},{}],1557:[function(e,t,i){"use strict";game.FlySceneEffect=b8e.SceneEntity.extends({_spellData:null,_rotation:0,_startPos:null,_endPos:null,_radian:0,_animList:null,ctor:function(){game.FlySceneEffect.effectId++,this._super(game.RoleType.FlyEffect,game.FlySceneEffect.effectId),this._animList=[]},playEffect:function(e,t,i,n,s,a){if(this.getScene())if(e&&i){var o,r;this._spellData=a;var h=this._animList.length=0;for(h=0;h<a.trajectoryCount&&!(9<h);h++){r=t-(o=a.flyRadian/(a.trajectoryCount-1))*(a.trajectoryCount-1)/2+o*h;var g=this.getAnimator(game.AnimatorType.FLYSPELL,h);g||(g=this.addAnimator(game.AnimatorType.FLYSPELL,h,10)),s?(g.soundEffectsEnabled=s.data.isSelf,g.load(e,null,null,{preload:s.data.isSelf,recycleDelay:s.data.isSelf?6e5:1e4})):g.load(e),a.isRotation&&g.setRotation(r,r,r),this._startPos=g.getPosition(),this._spellData.effectOffsetPosY&&(this._startPos={x:this._startPos.x,y:this._startPos.y+this._spellData.effectOffsetPosY},g.setPosition(this._startPos.x,this._startPos.y)),g.setVisible(!1),b8e.Tween.get(g).wait(a.releaseEffectSpaceTime+a.flySpaceTime*h).call(this.play,this,[g,r]),this._animList.push(g)}b8e.Tween.get(this).wait(a.releaseEffectSpaceTime+a.flySpaceTime*h+a.flyTime).call(this.release,this)}else b8e.warn("播放不能没有资源路径和位置");else b8e.warn("game.SceneEffect因继承自引擎engine.SceneEntity，不适用于UI界面！请使用engine.Animator！")},play:function(e,t){b8e.Tween.kill(e),e.play(),e.setVisible(!0);var i=e.getPosition();this._radian=(90-t+180)/180*Math.PI;var n=3*this._spellData.flySpeed,s=i.x+n*Math.cos(this._radian),a=i.y+n*Math.sin(this._radian);b8e.Tween.get(e).to({x:s,y:a},this._spellData.flyTime).call(this.stopAnim,this,[e])},stopAnim:function(e){e.stop(),e.setVisible(!1)},restore:function(){this._super()},recycle:function(){b8e.Tween.kill(this),this._super()},release:function(){game.FlySceneEffect.put(this)},dispose:function(){this._super()}}),game.FlySceneEffect.effectId=0,game.FlySceneEffect.pool=new b8e.Pool(game.FlySceneEffect,1024),game.FlySceneEffect.get=function(){return game.FlySceneEffect.pool.get()},game.FlySceneEffect.put=function(e){return e=game.FlySceneEffect.pool.put(e)}},{}],1558:[function(e,t,i){"use strict";game.HeadBarEffect=b8e.Sprite.extends({_cornucopiaBoom:null,_nicknameeffect:null,space:20,offsetY:45,_ishasnicknameeffect:!1,ctor:function(){this._super(),this._map=b8e.HashMap.get()},addEffect:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i="";switch(e){case game.AnimatorType.CORNUCOPIA_BOOM_EFFECT:i=game.ClientCfg.getUIFxs(10031),this.addCornucopiaBoom(i);break;case game.AnimatorType.NICKNAME_EFFECT:if(0==t)return;var n=game.ccfg.NickNameCfg.getResById(t);i=game.ClientCfg.getUIFxs(n),this.addNickNameEffect(i)}this.updateEffectPos()},removeEffect:function(e){switch(e){case game.AnimatorType.CORNUCOPIA_BOOM_EFFECT:this.removeCornucopiaBoom();break;case game.AnimatorType.NICKNAME_EFFECT:this.removeNickNameEffect()}this.updateEffectPos()},removeAllEffect:function(){this.removeCornucopiaBoom(),this.removeNickNameEffect()},addCornucopiaBoom:function(e){this._cornucopiaBoom||(this._cornucopiaBoom=b8e.Animator.get(game.AnimatorType.CORNUCOPIA_BOOM_EFFECT,1),this._cornucopiaBoom.addToParent(this)),this._cornucopiaBoom.load(e),this._cornucopiaBoom.play()},removeCornucopiaBoom:function(){this._cornucopiaBoom&&(this._cornucopiaBoom.removeFromParent(),this._cornucopiaBoom.clear(),this._cornucopiaBoom=null)},addNickNameEffect:function(e){this._nicknameeffect||(this._nicknameeffect=b8e.Animator.get(game.AnimatorType.NICKNAME_EFFECT,1),this._nicknameeffect.addToParent(this)),this._nicknameeffect.load(e),this._nicknameeffect.play(),this._nicknameeffect.setScale(.85),this._nicknameeffect.y=-25},removeNickNameEffect:function(){this._nicknameeffect&&(this._nicknameeffect.removeFromParent(),this._nicknameeffect.clear(),this._nicknameeffect=null)},updateEffectPos:function(){this._cornucopiaBoom&&(this._nicknameeffect?this._cornucopiaBoom.y=45:this._cornucopiaBoom.y=0)}})},{}],1559:[function(e,t,i){"use strict";game.SafeAreaChecker=b8e.Object.extends({ctor:function(){this._super()},syncGridInfo:function(e,t){var i=game.SceneMgr.inst().getSceneConfig();if(i){var n=i.isSafeScene,s=b8e.scene.gridIsSpecifyType(t.x,t.y,b8e.MapGridType.FIGHT_DEFINE),a=!0;n?s&&(a=!1):s||(a=!1),e.data.inSafeArea!=a&&(e.data.inSafeArea=a,e.data.isSelf&&(a?game.notice.show(1000005):game.notice.show(1000006)))}}})},{}],1560:[function(e,t,i){"use strict";game.SceneEffect=b8e.SceneEntity.extends({ctor:function(){game.SceneEffect.effectId=game.SceneEffect.getEffectId(),this._super(game.RoleType.Effect,game.SceneEffect.effectId)},playEffect:function(e,t,i,n,s){var a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0;if(this.getScene())if(e&&i){var r=this.getAnimator(game.AnimatorType.BODY,1);if(r||(r=this.addAnimator(game.AnimatorType.BODY,1,10)),n){var h=b8e.CommonUtil.getAngleByDirection(t);h=-1*(h-90)+180,this.setRotation(h,h,h)}else{var g=b8e.CommonUtil.getRadianByDirection(t);this.setFaceRadian(g)}s?(r.soundEffectsEnabled=s.data.isSelf||a,r.load(e,null,null,{preload:s.data.isSelf||a,recycleDelay:s.data.isSelf||a?6e5:1e4})):r.load(e),0==o?(r.play(),this.setVisible(!0)):(r.stop(),b8e.Tween.get(this).wait(o).call(this._playCall)),this.animAutoRelease(game.AnimatorType.BODY,1)}else b8e.warn("播放不能没有资源路径和位置");else b8e.warn("game.SceneEffect因继承自引擎engine.SceneEntity，不适用于UI界面！请使用engine.Animator！")},_playCall:function(){var e=this.getAnimator(game.AnimatorType.BODY,1);e&&(this.setVisible(!0),e.play())},pauseEffect:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.getAnimator(game.AnimatorType.BODY,1);t&&t.stop(),this.setVisible(e)},resumeEffect:function(){var e=this.getAnimator(game.AnimatorType.BODY,1);e&&e.play(null,-1),this.setVisible(!0)},clear:function(){game.SceneEffect.effectId=0;var e=this.getAnimator(game.AnimatorType.BODY,1);e&&e.clear()},restore:function(){this._super(),game.SceneEffect.effectId=game.SceneEffect.getEffectId()},recycle:function(){game.SceneEffect.resetEffectId(game.SceneEffect.effectId),this._super()},release:function(){b8e.Tween.kill(this),game.SceneEffect.put(this)},dispose:function(){this._super()}}),game.SceneEffect.effectId=0,game.SceneEffect.pool=new b8e.Pool(game.SceneEffect,1024),game.SceneEffect.get=function(){return game.SceneEffect.pool.get()},game.SceneEffect.put=function(e){return e=game.SceneEffect.pool.put(e)},game.SceneEffect.effectIdPool=[],game.SceneEffect.getEffectId=function(){return 0<game.SceneEffect.effectIdPool.length?game.SceneEffect.effectIdPool.shift():++game.SceneEffect.effectId},game.SceneEffect.resetEffectId=function(e){game.SceneEffect.effectIdPool.push(e)}},{}],1561:[function(e,t,i){"use strict";game.SceneRole=b8e.SceneEntity.extends({_stateMachine:null,_headBar:null,_headBarVisible:!0,_shadowSprite:null,_bodyAnim:null,_aiMachine:null,lastAttackMeId:0,attackMeTime:0,ctor:function(e,t){this._super(e,t),this._stateMachine=new game.RoleStateMachine(this),this.reset()},reset:function(){this.attackMeTime=0,this.lastAttackMeId=0,this.attachLimitable=[game.AttachType.BODY],this._bodyAnim=this.addAnimator(game.AnimatorType.BODY,1,10),this._bodyAnim.setAsBoundary(!0),this._bodyAnim.setTouchable(!0)},onAttachVisible:function(e,t){var i;switch(e){case game.AttachType.BODY:(i=this.getAnimator(game.AnimatorType.BODY,1))&&i.setAnimationActive(t),this._setMountActive(t),this._setWingActive(t),this._setFaBaoActive(t),this._setXianZhenActive(t)}},onChnageQuailty:function(){switch(game.PerfMgr.inst().level){case game.PerfMgr.Level.LOW:this.onChangeLowQuality();break;case game.PerfMgr.Level.HIGH:this.onChangeHighQuality()}},onChangeLowQuality:function(){switch(this.data.type){case game.RoleType.Hero:this._setFaBaoActive(!1),this._setXianZhenActive(!1),this._setDuJieActive(!1),this.hideShadow(),this._headBar.callProp("setDujieVisible",!1);break;case game.RoleType.Follower:this._setFaBaoFallowerActive(!1)}},onChangeHighQuality:function(){switch(this.data.type){case game.RoleType.Hero:this._setFaBaoActive(!0),this._setXianZhenActive(!0),this._setDuJieActive(!0),this.hideShadow(),this._headBar.callProp("setDujieVisible",!0);break;case game.RoleType.Follower:this._setFaBaoFallowerActive(!0)}this.data.type,game.RoleType.Follower},_setFaBaoFallowerActive:function(e){var t=this.getAnimator(game.AnimatorType.BODY,1);t&&(t.setAnimationActive(e),t.setTouchable(!1))},_setFaBaoActive:function(e){var t=this.getAnimator(game.AnimatorType.FA_BAO,1);t&&(t.setAnimationActive(e),t.setTouchable(!1))},_setMountActive:function(e){var t=this.getAnimator(game.AnimatorType.BODY,1);t&&(e=!!t.getAnimationActive()&&e),(t=this.getAnimator(game.AnimatorType.MOUNT_BODY,1))||((t=this.addAnimator(game.AnimatorType.MOUNT_BODY,1,-15,!0)).setAsBoundary(!0),t.setTouchable(!1)),t.setAnimationActive(e),(t=this.getAnimator(game.AnimatorType.MOUNT_HEAD,1))||((t=this.addAnimator(game.AnimatorType.MOUNT_HEAD,1,11)).setAsBoundary(!0),t.setTouchable(!1)),t.setAnimationActive(e)},_setXianZhenActive:function(e){var t;(t=this.getAnimator(game.AnimatorType.BODY,1))&&(e=!!t.getAnimationActive()&&e),(t=this.getAnimator(game.AnimatorType.APERTURE_EFFECT,1))||(t=this.addAnimator(game.AnimatorType.APERTURE_EFFECT,1,-1e4,!0)),t.setAnimationActive(e),t.setTouchable(!1)},_setDuJieActive:function(e){var t=this.getAnimator(game.AnimatorType.DUJIE,2);t&&(t.setAnimationActive(e),t.setTouchable(!1))},_setWingActive:function(e){var t=this.getAnimator(game.AnimatorType.BODY,1);t&&(e=!!t.getAnimationActive()&&e),(t=this.getAnimator(game.AnimatorType.WING,1))||(t=this.addAnimator(game.AnimatorType.WING,1,9)),t.setAnimationActive(e),t.setTouchable(!1)},updateShow:function(e){this._headBar&&(this._headBar.callProp("setDujieVisible",e),this._headBar.callProp("updateCornucopiaEffects",e&&this.data.avatarInfo.cornucopiaIsBoom))},onHierarchyVisible:function(e){if(this._super(e),e){switch(this._shadowSprite||(this._shadowSprite=b8e.Sprite.get(),this._shadowSprite.setAnchor(.5,.5),this._shadowSprite.loadTexture(game.ClientCfg.getTextureUrl("yinying.png"),null,null,{useManifest:!1,recycleDelay:-1})),this._headBar||(this._headBar=new b8e.PrefabDisplay,this.addChild(this._headBar),this._headBar.clearDisabled=!0,this._headBar.loadPrefab("app/prefabs/HeadBar","HeadBar")),this._headBar.callProp("headRootAddToAnim",this._bodyAnim),this.updateName(),this.updateLevel(),this.updateHpBar(),this._headBar.callProp("setHpBarVisible",!1),this._headBar.callProp("setNameVisible",!1),this._headBar.callProp("setLvVisible",!1),this._headBar.callProp("setHpLblVisible",!1),this._headBar.callProp("setGuildNameVisible",!1),this._headBar.callProp("setBarOffset",{x:0,y:0,z:0}),this._headBar.callProp("setDujieVisible",!1),this._headBar.callProp("setTGBtnVisible",!1),this.hideBar(),this.hideShadow(),this.data.type){case game.RoleType.Hero:this._headBar.callProp("setHpBarVisible",!0),this._headBar.callProp("setNameVisible",!0),this._headBar.callProp("setLvVisible",!0),this._headBar.callProp("setHpLblVisible",!0),this._headBar.callProp("setGuildNameVisible",!0),this._headBar.callProp("updateCornucopiaEffects",this.data.avatarInfo.cornucopiaIsBoom),this.updateNickNameEffects(this.data.avatarInfo.nickname),this._headBar.callProp("setDujieVisible",!0),this._headBar.callProp("updateDujieSp",this.data),this._headBar.callProp("setGuildNameLabel",this.data),this._headBarVisible&&this.showBar(),this.showShadow(),b8e.evt.addG(this,game.PerEvents.PER_CHANGE_QUAILTY,this.onChnageQuailty);break;case game.RoleType.Monster:this._headBar.callProp("setHpBarVisible",!0),this._headBar.callProp("setNameVisible",!0),this._headBar.callProp("setLvVisible",!0),this._headBar.callProp("setHpLblVisible",!0),this.hideBar(),this.showShadow();break;case game.RoleType.Npc:case game.RoleType.Beauty:this._headBar.callProp("setNameVisible",!0),this._headBarVisible&&this.showBar(),this.showShadow();break;case game.RoleType.Door:this.hideBar(),this.hideShadow();break;case game.RoleType.DropItem:this._headBar.callProp("setBarOffset",{x:0,y:25,z:0}),this._headBar.callProp("setNameVisible",!0),this._headBarVisible&&this.showBar(),this.showShadow();break;case game.RoleType.Effect:this.hideBar(),this.hideShadow();break;case game.RoleType.ClientEntity:this.showBar(),this._headBar.callProp("setTGBtnVisible",!0);break;case 1e8:this._headBar.callProp("setNameVisible",!0),this.showBar(),this.showShadow();break;default:this.data.type===game.RoleType.Follower&&b8e.evt.addG(this,game.PerEvents.PER_CHANGE_QUAILTY,this.onChnageQuailty),this.hideBar(),this.hideShadow()}this.updateShadow(),this.updateScale(),this.getScene().addEventListener(b8e.CameraEvent.CAMERA_DISTANCE_CHANGE,this.onCameraDistanceChange,this)}else this.data.type!==game.RoleType.Hero&&this.data.type!==game.RoleType.Follower||b8e.evt.rmvG(this,game.PerEvents.PER_CHANGE_QUAILTY,this.onChnageQuailty),this.getScene().removeEventListener(b8e.CameraEvent.CAMERA_DISTANCE_CHANGE,this.onCameraDistanceChange,this)},onCameraDistanceChange:function(e){this.updateScale()},updateScale:function(){var e=1/this.getScene().getSceneScale()/this.scaleX;this._headBar&&this._headBar.callProp("headRootScale",e),this._shadowSprite&&this._shadowSprite.setScale(e,e)},getAiMachine:function(){return this._aiMachine||(this._aiMachine=new game.AIStateMachine(this)),this._aiMachine},getStateMachine:function(){return this._stateMachine},transitionState:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._stateMachine&&this._stateMachine.transition(e,t,i)},getStateRef:function(e){return this._stateMachine.getReference(e)},updateName:function(){this._headBar&&this._headBar.callProp("setNameLabel",this.data)},updateHpBar:function(){this._headBar&&this._headBar.callProp("setHpBar",this.data)},updateLevel:function(){this._headBar&&this._headBar.callProp("setLevel",this.data)},updateCornucopiaEffects:function(e){this._headBar&&this._headBar.callProp("updateCornucopiaEffects",e)},updateNickNameEffects:function(e){this._headBar&&this._headBar.callProp("updateNicknameEffects",e)},updateDujieSp:function(e){this._headBar&&this._headBar.callProp("updateDujieSp",e)},updateGuildName:function(e){this._headBar&&this._headBar.callProp("setGuildNameLabel",e)},updateShadow:function(){var e=this.getAnimator(game.AnimatorType.MOUNT_BODY,1);!e||e.isFree()?this.shadowAddToAnim(this._bodyAnim):this.shadowAddToAnim(e)},showBar:function(){this._headBar&&this._headBar.callProp("showBar",!0)},hideBar:function(){this._headBar&&this._headBar.callProp("showBar",!1)},setBarOffset:function(e,t,i){this._headBar&&this._headBar.setOffset(e,t,i)},showShadow:function(){this._shadowSprite&&this._shadowSprite.setVisible(!0)},hideShadow:function(){this._shadowSprite&&this._shadowSprite.setVisible(!1)},shadowAddToAnim:function(e){this._shadowSprite&&e.addChildToBindNode(this._shadowSprite,"root",-999)},updateAttackMeTime:function(){this.attackMeTime=b8e.timeStamp},updateLastAttackMeId:function(e){this.lastAttackMeId=e},restore:function(e,t){this._super(e,t),this.reset()},recycle:function(){this.hideBar(),this._shadowSprite&&this._shadowSprite.removeFromParent(),this._stateMachine.clear(),this._aiMachine&&this._aiMachine.clear(),this._headBar&&this._headBar.callProp("removeAllEffect"),this._headBar&&this._headBar.callProp("clearDujie"),this.data&&this.data.release(),b8e.Tween.kill(this),this.attackMeTime=0,this.lastAttackMeId=0,this._bodyAnim=null,this._super()},release:function(){game.SceneRole.put(this)},dispose:function(){this._stateMachine&&(this._stateMachine.destroy(),this._stateMachine=null),this._aiMachine&&(this._aiMachine.destroy(),this._aiMachine=null),this._headBar&&(this._headBar.destroy(),this._headBar=null),this._shadowSprite&&(this._shadowSprite.release(),this._shadowSprite=null),this._bodyAnim=null,this._super()}}),game.SceneRole.pool=new b8e.Pool(game.SceneRole,1024),game.SceneRole.get=function(e,t){return game.SceneRole.pool.get(e,t)},game.SceneRole.put=function(e){return e=game.SceneRole.pool.put(e)}},{}],1562:[function(e,t,i){"use strict";game.AIIdle=b8e.AIState.extends({ctor:function(){this._super(game.AIStateType.AI_IDLE)},execute:function(){this._super()},afterEnter:function(){},leave:function(){this._super()}})},{}],1563:[function(e,t,i){"use strict";game.AINone=b8e.AIState.extends({ctor:function(){this._super(game.AIStateType.AI_NONE)},execute:function(){this._super()}})},{}],1564:[function(e,t,i){"use strict";var n=game.AIStateMachine=b8e.StateMachine.extends({_role:null,_timer:null,autoChase:!1,ctor:function(e){this._super(e),n.init(this),this.autoChase=!0},autoRun:function(){this._timer||(this._timer=b8e.Timer.add(this,this.onUpdate,100)),this._timer.reset(),this._timer.start()},isNone:function(){var e=this.getCurrState("AIState");return e&&e.type==game.AIStateType.AI_NONE},clear:function(){if(this._timer){this._timer.dispose(),this._timer=null;var e=this.owner.getStateRef(game.StopWalkMoveStateReference),t=this.owner.getGridPosition();e.setParams(t.x,t.y),this.owner.transitionState(game.RoleStateType.CONTROL_STOP_WALK_MOVE,e,!0)}this.autoChase=!0,this._super()},recycle:function(){this.autoChase=!0,this._super()},onUpdate:function(){this.transition(game.AIStateType.RELEASE_SPELL)}});n.stateMapping=null,n.init=function(e){if(!n.stateMapping){var t=n.stateMapping={};t[game.AIStateType.AI_NONE]=game.AINone,t[game.AIStateType.FIND_ATTACKABLE]=game.FindAttackable,t[game.AIStateType.ATTACK_TARGET]=game.AttackTarget,t[game.AIStateType.PATROL]=game.PatrolState,t[game.AIStateType.RELEASE_SPELL]=game.ReleaseSpellState,t[game.AIStateType.AI_IDLE]=game.AIIdle}e.setStateMapping(n.stateMapping)}},{}],1565:[function(e,t,i){"use strict";game.AIStateType=b8e.Enum({AI_NONE:0,FIND_ATTACKABLE:1,ATTACK_TARGET:2,PATROL:3,RELEASE_SPELL:4,AI_IDLE:5})},{}],1566:[function(e,t,i){"use strict";game.AttackTarget=b8e.AIState.extends({_spacing:void 0,_targetPathEndPos:null,_relaseTimer:null,ctor:function(){this._super(game.AIStateType.ATTACK_TARGET)},execute:function(){if(this._super(),!(this._ref instanceof game.AttackTargetReference))throw new Error("攻击对象状态引用必须是AttackTargetReference类型！");this.releaseToTarget()},findUseableSpell:function(e){var t=this,i=0;if(e&&e.usable&&!e.getStateMachine().isDeadState()){var n=b8e.MathUtil.getDistance(this._machine.owner.x,this._machine.owner.y,e.x,e.y),s=game.skill.getNextSpellId(),a=game.skill.resetNextSpellTime,o=game.SysTime.curTime;this._spacing=void 0;var r=this._machine.owner.getStateMachine().isSilentState();if(o<a&&0!=s&&null!=s){var h=game.ccfg.SpellCfg.getSpellById(s);!h||r&&!h.isNormalSpell||(n<=h.releaseDistance&&(i=s),this._spacing=h.releaseDistance)}if(0==i)game.skill.getAllSkillData().every(function(e){return!(o>=e.cdFinishTime&&(!r||e.isNormalSpell))||((null==t._spacing||e.maxDistance<t._spacing)&&(t._spacing=e.maxDistance),!(n<=e.maxDistance)||(i=e.protoId,!1))},this)}return i},releaseToTarget:function(){this._spacing=void 0;var e=this._machine.owner,t=game.ScenePickMgr.inst().getTarget();if(t&&t.usable&&!t.getStateMachine().isDeadState()){var i=this.findUseableSpell(t),n=t.getScenePosition();if(0<i){var s=game.ccfg.SpellCfg.getSpellById(i);e.faceTo(n.x,n.y);var a=e.getScenePosition(),o=game.Direction.getDirection(e.getDirection());game.CastSpellHelper.inst().releaseSpell(s,t.id,a,o,t);var r=game.SysTime.curTime,h=game.skill.getSkillById(i);h&&(h.cdFinishTime=r+s.cd),0!=s.nextSpellId?(game.skill.nextSpellId=s.nextSpellId,game.skill.resetNextSpellTime=s.resetNextSpellTime+r+100):game.skill.nextSpellId=0;s=game.ccfg.SpellCfg.getSpellById(i);this._relaseTimer&&this._relaseTimer.stop(),this.transition(game.AIStateType.NONE)}else{null==this._spacing&&(this._spacing=0);var g=n,l=!1;if(b8e.MathUtil.getDistance(this._machine.owner.x,this._machine.owner.y,t.x,t.y)<=150)return;var c=t.getStateMachine();if(c&&(l=c.isWalking())){var u=c.getCurrState("MoveState");if(u){var m=u.getPathEndPos();m&&(g=m)}}if(l&&this._targetPathEndPos&&this._targetPathEndPos.x==g.x&&this._targetPathEndPos.y==g.y)return;this._targetPathEndPos={x:g.x,y:g.y},game.MoveToHelper.inst().selfMoveTo(g,100),this._relaseTimer?(this._relaseTimer.reset(),this._relaseTimer.start()):this._relaseTimer=b8e.Timer.add(this,this.releaseToTarget,500,2)}}else this.transition(game.AIStateType.NONE)},leave:function(){this._relaseTimer&&this._relaseTimer.stop(),this._super()},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.owner.getStateMachine().isWalkMoving()&&!t)&&(!(this._machine.owner.getStateMachine().isJumpMoving()&&!t)&&(!this._machine.owner.getStateMachine().isBlinkMoving()&&(!this._machine.owner.getStateMachine().isBeatMoving()&&(!!this._machine.owner.getStateMachine().passTo(game.RoleStateType.ACTION_ATTACK)&&(!this._machine.owner.getStateMachine().isDeadState()&&(!this._machine.owner.getStateMachine().isAttackHarding()&&!this._machine.owner.getStateMachine().isLockCaseSpell()))))))},clear:function(){this._super()}})},{}],1567:[function(e,t,i){"use strict";game.AttackTargetReference=b8e.StateReference.extends({roleList:null,trusteeshipRange:0,ctor:function(){this._super()},setParams:function(e,t){this.roleList=e,this.trusteeshipRange=t},clear:function(){this.roleList=null,this.trusteeshipRange=0,this._super()}})},{}],1568:[function(e,t,i){"use strict";game.FindAttackable=b8e.AIState.extends({ctor:function(){this._super(game.AIStateType.FIND_ATTACKABLE)},execute:function(){if(this._super(),!(this._ref instanceof game.FindAttackableReference))throw new Error("查找可攻击对象状态引用必须是FindAttackableReference类型！");this.gotoAttackRole()},gotoAttackRole:function(){if(0!=game.TrusteeshipMgr.inst().autoFight||0!=game.FightTargetMgr.inst().fightTarget){var e=game.ScenePickMgr.inst().getTarget();if(e&&e.usable){if(0==game.CastSpellHelper.inst().checkAttack(e,!0))return}else e=this.findNearestRole(this._ref.origin,this._ref.spellData,this._ref.trusteeshipRange,this._ref.roleIds,this._ref.monsterModelId,this._ref.autoFindEnemy),game.ScenePickMgr.inst().selectTarget(e);if(e){var t=this._machine.getReference(game.AttackTargetReference);this.transition(game.AIStateType.ATTACK_TARGET,t,!0)}}},findNearestRole:function(e,i,t,n,s){var a,o,r=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],h=[],g=game.mainRole.mainRoleData;(n&&n.forEach(function(e){var t=game.sceneRole.getDisplayById(e);if(t&&t.usable&&t instanceof game.SceneRole){if(0==game.CastSpellHelper.inst().checkAttack(t,!0))return;if(o=t.getGridPosition(),b8e.scene.gridIsSolid(o.x,o.y))return;if(t.type==game.RoleType.Monster){if(t.getStateMachine().isDeadState())return;if(0!=s&&s!=t.data.modelId)return;(a=game.CastSpellHelper.inst().checkReleaseSpell(i,t))&&h.push(a)}if(t.type==game.RoleType.Hero&&0==t.data.isSelf&&0==s){if(t.getStateMachine().isDeadState())return;switch(g.pkMode){case game.PkModeType.PEACE:break;case game.PkModeType.ALL:(a=game.CastSpellHelper.inst().checkReleaseSpell(i,t))&&h.push(a);break;case game.PkModeType.GUILD:t.data.guildId==g.guildId&&0!=t.data.guildId||(a=game.CastSpellHelper.inst().checkReleaseSpell(i,t))&&h.push(a)}}}},this),0==h.length&&r)&&b8e.scene.getDisplays().forEach(function(e){if(e.usable&&e instanceof game.SceneRole){if(0==game.CastSpellHelper.inst().checkAttack(e))return;if(e.getStateMachine().isDeadState())return;if(o=e.getGridPosition(),b8e.scene.gridIsSolid(o.x,o.y))return;if(e.type==game.RoleType.Monster){if(s&&s!=e.data.modelId)return;(a=game.CastSpellHelper.inst().checkReleaseSpell(i,e))&&h.push(a)}else if(e.type==game.RoleType.Hero&&0==e.data.isSelf&&0==s)switch(g.pkMode){case game.PkModeType.PEACE:break;case game.PkModeType.GUILD:case game.PkModeType.ALL:(a=game.CastSpellHelper.inst().checkReleaseSpell(i,e))&&h.push(a)}}},this);if(h.sort(this.onSortNearestRole),0<h.length){var l=h[0];if(l.type==game.RoleType.Hero&&0<l.attackMeTime)return l;var c=0<t&&i?t+i.releaseDistance+i.radius:0,u=!1;if(0<c?b8e.MathUtil.getDistanceNoSqrt(e.x,e.y,l.x,l.y)<c*c&&(u=!0):u=!0,u)return l}return null},onSortNearestRole:function(e,t){if(game.SceneMgr.inst().sceneType==game.SceneType.NATIONALBOSS){if(e.type==game.RoleType.Hero&&t.type==game.RoleType.Monster)return 1;if(e.type==game.RoleType.Monster&&t.type==game.RoleType.Hero)return-1}var i=game.mainRole.mainRoleEntity,n=b8e.MathUtil.getDistanceNoSqrt(i.x,i.y,e.x,e.y),s=b8e.MathUtil.getDistanceNoSqrt(i.x,i.y,t.x,t.y);return s<n?1:n<s?-1:0},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.owner.getStateMachine().isWalkMoving()&&!t)&&(!this._machine.owner.getStateMachine().isVertigo()&&(!this._machine.owner.getStateMachine().isBlinkMoving()&&(!this._machine.owner.getStateMachine().isBeatMoving()&&(!!this._machine.owner.getStateMachine().passTo(game.RoleStateType.ACTION_ATTACK)&&(!(this._machine.owner.getStateMachine().isAttacking()&&!t)&&(!this._machine.owner.getStateMachine().isDeadState()&&(!this._machine.owner.getStateMachine().isAttackHarding()&&!this._machine.owner.getStateMachine().isLockCaseSpell())))))))},clear:function(){this._super()}})},{}],1569:[function(e,t,i){"use strict";game.FindAttackableReference=b8e.StateReference.extends({origin:null,spellData:null,roleIds:null,trusteeshipRange:0,monsterModelId:0,autoFindEnemy:!1,ctor:function(){this._super()},setParams:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];this.origin=e,this.spellData=t,this.roleIds=i,this.trusteeshipRange=n,this.monsterModelId=s,this.autoFindEnemy=a},clear:function(){this.origin=null,this.spellData=null,this.roleIds=null,this.trusteeshipRange=0,this.monsterModelId=0,this.autoFindEnemy=!1,this._super()}})},{}],1570:[function(e,t,i){"use strict";game.PatrolState=b8e.AIState.extends({_poses:null,ctor:function(){this._super(game.AIStateType.PATROL),this._poses=[{x:28,y:22},{x:20,y:20},{x:34,y:24},{x:31,y:26},{x:25,y:27},{x:19,y:24},{x:27,y:20}]},execute:function(){this._super();var e=this._poses[this._poses.length*Math.random()>>0];game.MoveToHelper.inst().entityMoveTo(this._machine.owner,e,game.SysTime.curTime)},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.owner.getStateMachine().isWalkMoving()&&!t)&&!!this._machine.owner.getStateMachine().passTo(game.RoleStateType.ACTION_ATTACK)},clear:function(){this._super()}})},{}],1571:[function(e,t,i){"use strict";game.ReleaseSpellState=b8e.AIState.extends({_spellCDMap:null,_enemyType:null,_relaseSpellInfo:null,_targetEntity:null,_spellData:null,ctor:function(){this._super(game.AIStateType.RELEASE_SPELL),this._relaseSpellInfo=new game.ReleaseSpellInfo,this._spellCDMap={}},execute:function(){this._super();var e=this._machine.owner;e.data.type==game.RoleType.Hero?this._enemyType=game.RoleType.Monster:e.data.type==game.RoleType.Monster&&(this._enemyType=game.RoleType.Hero);for(var t=b8e.timeStamp,i=this._spellData=null,n=e.data.spellList,s=n.length,a=0;a<s;a++){var o=n[a],r=this._spellCDMap[o.id];if(!(r&&t<r)){i=o;break}}if(i){this._spellData=i,this._targetEntity=null;var h=game.HitSpellHelper.findNearestEnemy(e,this._enemyType,i);if(0<h.length){var g=h[0],l=i.releaseDistance+i.radius-50,c=!1;if(0<l)b8e.MathUtil.getDistanceNoSqrt(e.x,e.y,g.x,g.y)<=l*l&&(c=!0);else c=!0;if(this._targetEntity=g,c)this.releaseSpell();else if(this._machine.autoChase){var u=l,m=game.MoveToHelper.inst().MOVE_SPEED,_=b8e.scene.getGridPosByPixel(g.sceneX,g.sceneY),d=e.getGridPosition();if(_.x==d.x&&_.y==d.y)return void this.releaseSpell();var f=e.getStateRef(game.WalkStateReference);f.setParams(m,0,u,_),f.onArrive(this.releaseSpell,this),e.transitionState(game.RoleStateType.ACTION_WALK,f)}}}},releaseSpell:function(){if(this._targetEntity&&this._targetEntity.usable&&!this._targetEntity.getStateMachine().isDeadState()){var e=b8e.timeStamp,t=this._machine.owner,i=b8e.MathUtil.getDegree(t.x,t.y,this._targetEntity.x,this._targetEntity.y);this._spellCDMap[this._spellData.id]=e+this._spellData.cd,this._relaseSpellInfo.clear(),this._relaseSpellInfo.releaseEntityType=t.data.type,this._relaseSpellInfo.releaseEntityId=t.data.id,this._relaseSpellInfo.releaseSpellId=this._spellData.id,this._relaseSpellInfo.targetId=this._targetEntity.data.id,this._relaseSpellInfo.direction=game.Direction.getDirection(b8e.CommonUtil.getDirectionByAngle(i)),game.SpellReleaseHelper.inst().releaseSpell(this._relaseSpellInfo),game.HitSpellHelper.spellHit(t,this._enemyType,this._spellData,this._relaseSpellInfo)}},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._machine.owner.getStateMachine().isWalkMoving()){if(this._targetEntity&&this._spellData){var i=this._machine.owner,n=this._spellData.releaseDistance+this._spellData.radius-50,s=!1;if(0<n)b8e.MathUtil.getDistanceNoSqrt(i.x,i.y,this._targetEntity.x,this._targetEntity.y)<=n*n&&(s=!0);else s=!0;if(s)return!0}if(!t)return!1}return!(this._machine.owner.getStateMachine().isJumpMoving()&&!t)&&!!this._machine.owner.getStateMachine().passTo(game.RoleStateType.ACTION_ATTACK)},clear:function(){this._spellCDMap={},this._relaseSpellInfo.clear(),this._targetEntity=null,this._spellData=null,this._super()}})},{}],1572:[function(e,t,i){"use strict";e("./AIStateType"),e("./AINone"),e("./AttackTarget"),e("./AttackTargetReference"),e("./FindAttackable"),e("./FindAttackableReference"),e("./PatrolState"),e("./ReleaseSpellState"),e("./AIStateMachine")},{"./AINone":1563,"./AIStateMachine":1564,"./AIStateType":1565,"./AttackTarget":1566,"./AttackTargetReference":1567,"./FindAttackable":1568,"./FindAttackableReference":1569,"./PatrolState":1570,"./ReleaseSpellState":1571}],1573:[function(e,t,i){"use strict";game.FollowController=b8e.Object.extends({_owner:null,displaySyncInfo:null,_target:null,_moveState:!1,ctor:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._super(),this._owner=e,this._target=t,this._moveState=i,this.displaySyncInfo=new b8e.SceneDisplaySyncInfo(this)},setOwner:function(e,t){this._owner=e,this._target=e},syncGridInfo:function(e,t){var i=e.getPosition(),n=this._owner.getPosition(),s=b8e.MathUtil.getDistance(i.x,i.y,n.x,n.y);if(500<s)this._owner.setPosition(i);else if(150<s)if(this._moveState){var a=game.MoveToHelper.inst().MOVE_SPEED,o=this._owner.getGridPosition(),r=this._owner.getStateRef(game.WalkStateReference),h=e.getGridPosition();r.setParams(a,0,100,null,{startTime:game.SysTime.curTime,path:[o,h]}),r.transitionWalkMove=!1,this._owner.transitionState(game.RoleStateType.ACTION_WALK,r),this._owner.faceToGrid(h.x,h.y),b8e.Tween.kill(this._owner),i=this._owner.data.type==game.RoleType.Ornament?this._getOrnamentFollowGrid(e,i):this._getBeautyFollowGrid(e,i),s=b8e.MathUtil.getDistance(i.x,i.y,n.x,n.y),b8e.Tween.get(this._owner).to({x:i.x,y:i.y},166.6*s/50).call(this._moveComplete,this)}else i=this._getTargetPos(e,i),b8e.Tween.kill(this._owner),b8e.Tween.get(this._owner).to({x:i.x,y:i.y},500)},_moveComplete:function(){this._owner.transitionState(game.RoleStateType.ACTION_IDLE)},_getBeautyFollowGrid:function(e,t){var i=e.getDirection();if(!i)return{x:0,y:0};var n=b8e.CommonUtil.getRadianByDirection(i);return t=b8e.MathUtil.getRadianPos(t.x,t.y,n,-100)},_getOrnamentFollowGrid:function(e,t){var i=e.getDirection();if(!i)return{x:0,y:0};var n=i.x,s=i.y;return t.y=t.y+120,0==n&&1==s||1==n&&1==s||1==n&&0==s||-1==n&&-1==s?t.x+=70:t.x-=70,t},_getTargetPos:function(e,t){var i=e.getDirection();if(!i)return{x:0,y:0};var n=i.x,s=i.y;return t.y=t.y+100,0==n&&1==s||1==n&&1==s||1==n&&0==s||-1==n&&-1==s?t.x-=50:t.x+=50,t},release:function(){this._target&&this._target.removeSyncInfo(this)}})},{}],1574:[function(e,t,i){"use strict";game.SceneFollower=game.SceneRole.extends({_controller:null,ctor:function(e,t){this._super(e,t)},setController:function(e){this._controller=e},getController:function(){return this._controller},restore:function(e,t){this._super(e,t)},recycle:function(){this._super()},release:function(){this._controller&&(this.removeSyncInfo(this._controller),this._controller.release(),this._controller=null),game.SceneFollower.put(this)},dispose:function(){this._controller&&(this.removeSyncInfo(this._controller),this._controller.release(),this._controller=null),this._super()}}),game.SceneFollower.pool=new b8e.Pool(game.SceneFollower,256),game.SceneFollower.get=function(e,t){return game.SceneFollower.pool.get(e,t)},game.SceneFollower.put=function(e){return e=game.SceneFollower.pool.put(e)}},{}],1575:[function(e,t,i){"use strict";e("./AnimatorType"),e("./AvatarUtil"),e("./SceneRole"),e("./HeadBarEffect"),e("./state/stateIndex"),e("./ai/aiIndex"),e("./SceneEffect"),e("./SafeAreaChecker"),e("./EventAreaChecker"),e("./FlySceneEffect")},{"./AnimatorType":1553,"./AvatarUtil":1555,"./EventAreaChecker":1556,"./FlySceneEffect":1557,"./HeadBarEffect":1558,"./SafeAreaChecker":1559,"./SceneEffect":1560,"./SceneRole":1561,"./ai/aiIndex":1572,"./state/stateIndex":1604}],1576:[function(e,t,i){"use strict";game.AttackState=b8e.ActionState.extends({_speed:1,_actionType:null,_hitFrameTween:null,_totalFrameTween:null,_breakFrameTween:null,_attackFinished:!1,_attackBroken:!1,_canWalkRelease:!1,_breakFrameTime:null,_hitFrameTime:null,ctor:function(){this._super(game.RoleStateType.ACTION_ATTACK)},execute:function(){if(this._machine&&this._machine.usable){if(this._super(),this._attackBroken=!1,this._attackFinished=!1,this._canWalkRelease=!1,!(this._ref instanceof game.AttackStateReference))throw new Error("攻击状态引用必须是AttackStateReference类型！");0<this._ref.speed?this._speed=this._ref.speed:this._speed=1,this._canWalkRelease=!1,this._canWalkRelease,this._actionType=this._ref.actionType,this._actionType?(this._startFrameTime=0,this._breakFrameTime=this._ref.breakFrameTime-this._startFrameTime):(this._startFrameTime=0,this._breakFrameTime=0),this._machine.owner.setFaceRadian(this._ref.radian),this.syncSpeedRatio(1),this.syncAnimation(!1,0)}},afterExecute:function(){if(this._machine&&this._machine.usable){this._super();var e=0;if(this._actionType){var t=this._machine.owner.getAnimator(game.AnimatorType.BODY,1);e=t?t.getDuration()-this._startFrameTime:200}0==e&&(e=450);var i=0<this._breakFrameTime?this._breakFrameTime:e;e=i,this._machine.owner.data&&this._machine.owner.data.isSelf&&(game.TrusteeshipMgr.inst().setupNextUpdateTime(e),game.FightTargetMgr.inst().setupNextUpdateTime(e));var n=0<this._hitFrameTime?this._hitFrameTime:i;i<n&&(n=i),this._hitFrameTween&&(this._hitFrameTween.kill(),this._hitFrameTween=null),this._totalFrameTween&&(this._totalFrameTween.kill(),this._totalFrameTween=null),this._breakFrameTween&&(this._breakFrameTween.kill(),this._breakFrameTween=null),1==this._machine.owner.data.isSelf||this._machine.owner.getHierarchyVisible()&&this._machine.owner.getAttachVisible(game.AttachType.BODY)&&0<e?this._totalFrameTween=b8e.Tween.get(this).wait(e).call(this.onTotalFrameCmp,this):this.onTotalFrameCmp()}},stopAttack:function(){this._attackBroken=!0,this._attackFinished=!0,this._canWalkRelease=!1,this._hitFrameTween&&(this._hitFrameTween.kill(),this._hitFrameTween=null),this._breakFrameTween&&(this._breakFrameTween.kill(),this._breakFrameTween=null),this._totalFrameTween&&(this._totalFrameTween.kill(),this._totalFrameTween=null)},leave:function(){this._super(),this.stopAttack(),this._attackBroken=!1,this._attackFinished=!1,this._canWalkRelease=!1},onHitFrameCmp:function(){this._hitFrameTween&&(this._hitFrameTween.kill(),this._hitFrameTween=null),this._ref&&this._ref.hitFrame()},onTotalFrameCmp:function(){this._machine&&this._machine.usable&&(this.onHitFrameCmp(),this.onBreakFrameCmp(),this._totalFrameTween&&(this._totalFrameTween.kill(),this._totalFrameTween=null),this._ref&&this._ref.totalFrame(),this.stopAttack(),this.transition(game.RoleStateType.ACTION_IDLE),this._machine.owner.data&&this._machine.owner.data.isSelf&&(game.TrusteeshipMgr.inst().autoFight?game.TrusteeshipMgr.inst().onUpdate(!0):game.FightTargetMgr.inst().fightTarget&&game.FightTargetMgr.inst().update(!0)))},onBreakFrameCmp:function(){this._attackBroken=!0,this._machine&&this._machine.usable&&(this._breakFrameTween&&(this._breakFrameTween.kill(),this._breakFrameTween=null),this._ref&&this._ref.breakFrame())},pause:function(){this._super(),this._totalFrameTween&&this._totalFrameTween.pause()},resume:function(){this._super(),this._totalFrameTween&&this._totalFrameTween.resume()},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=this._actionType?this._actionType:game.RoleActionType.IDLE;switch(t.type){case game.AnimatorType.BODY:t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},setAnimationSpeed:function(e,t,i){switch(this._super(e,t,i),t.type){case game.AnimatorType.BODY:t.setSpeedRatio(i)}},getAttackBroken:function(){return this._attackBroken},getCanWalkRelease:function(){return this._canWalkRelease},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._super(),e.type==game.RoleStateType.ACTION_DEATH)return!0;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!0;if(this._machine.isBingDong())return!1;if(e.type==game.RoleStateType.ACTION_IDLE){if(!t&&!this._attackFinished)return!1}else if(e.type==game.RoleStateType.ACTION_BLINK){if(!t&&!this._attackBroken)return!1}else if(e.type==game.RoleStateType.ACTION_ATTACK){if(!t&&!this._attackBroken)return!1}else if(e.type==game.RoleStateType.ACTION_HIT){if(!t&&!this._attackFinished)return!1}else if(e.type==game.RoleStateType.ACTION_COLLECT){if(!t&&!this._attackFinished)return!1}else{if(e.type==game.RoleStateType.ACTION_WALK)return!0;if(e.type==game.RoleStateType.ACTION_JUMP)return!0;if(e.type==game.RoleStateType.ACTION_BEAT_BACK){if(!t&&!this._attackFinished)return!1}else if(!this._attackFinished)return!1}return!0},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._super(),e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1}return!(!t&&this._machine.isAttackHarding())&&(!(!t&&this._machine.isLockCaseSpell())&&(!(!t&&this._machine.isJumpMoving())&&(!(!t&&this._machine.isBlinkMoving())&&(!(!t&&this._machine.isBeatMoving())&&(!(!t&&this._machine.isStun())&&!(!t&&this._machine.isHush()))))))},clear:function(){this._actionType=null,this._attackBroken=!1,this._attackFinished=!1,this._canWalkRelease=!1,this._hitFrameTween&&(this._hitFrameTween.kill(),this._hitFrameTween=null),this._breakFrameTween&&(this._breakFrameTween.kill(),this._breakFrameTween=null),this._totalFrameTween&&(this._totalFrameTween.kill(),this._totalFrameTween=null),this._super()}})},{}],1577:[function(e,t,i){"use strict";game.AttackStateReference=b8e.StateReference.extends({radian:0,actionType:null,knifeLight:null,speed:0,_hitFrameCb:null,_breakFrameCb:null,_totalFrameCb:null,_resetFrameCb:null,breakFrameTime:0,hitFrameTime:0,throwFrameTime:0,effectOffsetPosY:0,isInReleaser:!1,ctor:function(){this._super()},setParams:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];this.actionType=e,this.knifeLight=t,this.radian=i,this.speed=n,this.isInReleaser=s},onHitFrame:function(e,t,i){return this._hitFrameCb=e?{func:e,thisArg:t,args:i}:null,this},onBreakFrame:function(e,t,i){return this._breakFrameCb=e?{func:e,thisArg:t,args:i}:null,this},onTotalFrame:function(e,t,i){return this._totalFrameCb=e?{func:e,thisArg:t,args:i}:null,this},onResetFrame:function(e,t,i){return this._resetFrameCb=e?{func:e,thisArg:t,args:i}:null,this},resetFrame:function(){var e;this._resetFrameCb&&(e=this._resetFrameCb.args?this._resetFrameCb.args.concat(this):[this],this._resetFrameCb.func.apply(this._resetFrameCb.thisArg,e))},hitFrame:function(){var e;this._hitFrameCb&&(e=this._hitFrameCb.args?this._hitFrameCb.args.concat(this):[this],this._hitFrameCb.func.apply(this._hitFrameCb.thisArg,e))},breakFrame:function(){var e;this._breakFrameCb&&(e=this._breakFrameCb.args?this._breakFrameCb.args.concat(this):[this],this._breakFrameCb.func.apply(this._breakFrameCb.thisArg,e))},totalFrame:function(){var e;this._totalFrameCb&&(e=this._totalFrameCb.args?this._totalFrameCb.args.concat(this):[this],this._totalFrameCb.func.apply(this._totalFrameCb.thisArg,e))},clear:function(){this.radian=0,this.actionType=null,this.knifeLight=null,this.hitFrameTime=0,this.throwFrameTime=0,this.speed=0,this._hitFrameCb=null,this._breakFrameCb=null,this._totalFrameCb=null,this._super()}})},{}],1578:[function(e,t,i){"use strict";game.DeathFlyReference=b8e.StateReference.extends({releaserId:0,deathDelay:0,ctor:function(){this._super()},setParams:function(e,t){this.releaserId=e,this.deathDelay=t},clear:function(){this._super(),this.deathDelay=0,this.releaserId=0}})},{}],1579:[function(e,t,i){"use strict";game.DeathFlyState=b8e.ActionState.extends({_movePos_1:null,_movePos_2:null,_movePos_3:null,_movePos_4:null,_deathTween:null,ctor:function(){this._super(game.RoleStateType.ACTION_DEATH_FLY)},execute:function(){this._machine&&this._machine.usable&&(this._super(),this.syncAnimation(!1,0))},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=game.RoleActionType.DIE;switch(t.type){case game.AnimatorType.BODY:t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},afterExecute:function(){this._machine&&this._machine.usable&&(this._ref instanceof game.DeathFlyReference?0<this._ref.deathDelay?this._deathTween=b8e.Tween.get(this).wait(this._ref.deathDelay).call(this.onPlayerDeathCall,this,[this._ref.releaserId]):this.onPlayerDeathCall(this._ref.releaserId):b8e.error("DeathFlyState 传入类型必须是game.DeathFlyReference"))},onPlayerDeathCall:function(e){if(this._machine&&this._machine.usable){this._deathTween&&(this._deathTween.kill(),this._deathTween=null),this._machine.owner.hideBar(),game.ScenePickMgr.inst().getTarget()==this._machine.owner&&game.ScenePickMgr.inst().pickTarget(null);var t=this._machine.owner.getAnimator(game.AnimatorType.BODY,1).getDuration();t<1e3&&(t=1e3);var i,n=game.sceneRole.getDisplayById(e),s=this._machine.owner;i=n?b8e.MathUtil.getRadian(n.x,n.y,s.x,s.y):2*Math.random();this._movePos_1=b8e.MathUtil.getRadianPos(s.x,s.y,i,50,this._movePos_1),this._movePos_2=b8e.MathUtil.getRadianPos(s.x,s.y,i,75,this._movePos_2),this._movePos_3=b8e.MathUtil.getRadianPos(s.x,s.y,i,105,this._movePos_3),this._movePos_4=b8e.MathUtil.getRadianPos(this._movePos_3.x,this._movePos_3.y,i,30,this._movePos_4),this._machine.owner.type==game.RoleType.Monster&&(this._deathTween=b8e.Tween.get(s).to({x:this._movePos_1.x,y:this._movePos_1.y,scaleX:1.2,scaleY:1.2},100,b8e.Ease.quadIn).to({x:this._movePos_2.x,y:this._movePos_2.y},200,b8e.Ease.quadIn).to({x:this._movePos_3.x,y:this._movePos_3.y,scaleX:1,scaleY:1},100,b8e.Ease.quadIn).to({x:this._movePos_4.x,y:this._movePos_4.y},300,b8e.Ease.bounceInOut).call(this.onRoleDied,this))}},onRoleDied:function(){this._machine&&this._machine.usable&&(this._deathTween&&(this._deathTween.kill(),this._deathTween=null),this._machine.owner.type==game.RoleType.Monster?b8e.scene.removeDisplay(this._machine.owner):b8e.log("不是怪物？"))},enterPass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1}return!0},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e.type==game.RoleStateType.ACTION_DEATH?!!t:e.type==game.RoleStateType.ACTION_DEATH_FLY?!!t:e.type!=game.RoleStateType.ACTION_IDLE&&(e.type!=game.RoleStateType.ACTION_ATTACK&&(e.type!=game.RoleStateType.ACTION_HIT&&(e.type!=game.RoleStateType.ACTION_COLLECT&&(e.type!=game.RoleStateType.ACTION_BEAT_BACK&&(e.type!=game.RoleStateType.ACTION_BLINK&&(e.type!=game.RoleStateType.ACTION_DEATH&&(e.type!=game.RoleStateType.ACTION_DEATH_FLY&&(e.type!=game.RoleStateType.ACTION_WALK&&e.type!=game.RoleStateType.ACTION_JUMP))))))))},clear:function(){this._deathTween&&(this._deathTween.kill(),this._deathTween=null),this._super()}})},{}],1580:[function(e,t,i){"use strict";game.DeathState=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_DEATH)},execute:function(){if(this._machine&&this._machine.usable){this._super();var e=this._machine.owner.getAnimator(game.AnimatorType.MOUNT_BODY,1),t=this._machine.owner.getAnimator(game.AnimatorType.MOUNT_HEAD,1);e&&e.clear(),t&&t.clear(),this.syncAnimation(!1,0)}},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=game.RoleActionType.DIE;switch(t.type){case game.AnimatorType.BODY:t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},afterExecute:function(){if(this._machine&&this._machine.usable){this._deathTween&&(this._deathTween.kill(),this._deathTween=null),0==this._machine.owner.isSelf&&this._machine.owner.hideBar(),game.ScenePickMgr.inst().getTarget()==this._machine.owner&&game.ScenePickMgr.inst().pickTarget(null);var e=this._machine.owner.getAnimator(game.AnimatorType.BODY,1).getDuration();e<1e3&&(e=1e3),0<e?this._machine.owner.type!=game.RoleType.Hero&&(this._deathTween=b8e.Tween.get(this).wait(e).call(this.onRoleDied,this)):this.onRoleDied()}},onRoleDied:function(){this._machine&&this._machine.usable&&(this._deathTween&&(this._deathTween.kill(),this._deathTween=null),this._machine.owner.type!=game.RoleType.Hero&&b8e.scene.removeDisplay(this._machine.owner))},enterPass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1}return!0},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e.type==game.RoleStateType.ACTION_IDLE?!!t:e.type!=game.RoleStateType.ACTION_ATTACK&&(e.type!=game.RoleStateType.ACTION_HIT&&(e.type!=game.RoleStateType.ACTION_COLLECT&&(e.type!=game.RoleStateType.ACTION_BEAT_BACK&&(e.type!=game.RoleStateType.ACTION_BLINK&&(e.type!=game.RoleStateType.ACTION_DEATH&&(e.type!=game.RoleStateType.ACTION_DEATH_FLY&&(e.type!=game.RoleStateType.ACTION_WALK&&e.type!=game.RoleStateType.ACTION_JUMP)))))))},clear:function(){this._deathTween&&(this._deathTween.kill(),this._deathTween=null),this._super()}})},{}],1581:[function(e,t,i){"use strict";game.FixedState=b8e.ControlState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_WALK_MOVE)},enter:function(){this._machine&&this._machine.usable&&this._super()},execute:function(){}})},{}],1582:[function(e,t,i){"use strict";game.HitEffectReference=b8e.StateReference.extends({releaserId:0,effectRes:null,hitDelay:0,hurtValue:0,isDie:!1,spellData:!1,hitType:0,ctor:function(){this._super()},setParams:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];this.releaserId=e,this.effectRes=t,this.hitDelay=i,this.hurtValue=n,this.isDie=s},clear:function(){this.releaserId=0,this.effectRes=null,this.hitDelay=0,this.hurtValue=0,this.hitType=0,this.isDie=!1,this._super()}})},{}],1583:[function(e,t,i){"use strict";game.HitEffectState=b8e.ControlState.extends({_lightShaderCd:0,ctor:function(){this._super(game.RoleStateType.CONTROL_HIT_EFFECT)},tribe:{get:function(){return"HitEffectState"}},execute:function(){if(this._super(),this._machine&&this._machine.usable){if(!(this._ref instanceof game.HitEffectReference))throw new Error("受击特效状态引用必须是HitEffectReference类型！");0<this._ref.hitDelay?b8e.Tween.get(this).wait(this._ref.hitDelay).call(this.showHitEffect,this,[this._ref.releaserId,this._ref.effectRes,this._machine.owner,this._ref.isInTarget,this._ref.hitType]):this.showHitEffect(this._ref.releaserId,this._ref.effectRes,this._machine.owner,this._ref.isInTarget,this._ref.hitType)}else b8e.log("收到被攻击死亡但是人没死掉",this._machine.owner.data.id)},showHitEffect:function(e,t,i,n,s){if(i.usable&&this._machine.owner.data){var a=game.mainRole.mainRoleId;if((!game.setting.getSpellSelect()||e==a||0!=this._machine.owner.data.isSelf)&&this._machine.owner.getHierarchyVisible()&&this._machine.owner.getAttachVisible(game.AttachType.BODY)){if(t){var o=game.ClientCfg.getSkillFx(t),r=i.getAnimator(game.AnimatorType.BODY,1);if(n){var h=i.getAnimator(game.AnimatorType.HIT_EFFECT,1);h||(h=i.addAnimator(game.AnimatorType.HIT_EFFECT,1,50,!0)),r.addChildToBindNode(h,"hit",999);var g=o;h.load(g,null,null,{recycleDelay:i.data.isSelf?6e5:1e4}),h.play(),h.autoRelease()}else{var l=r.getBindNode("hit"),c=i.getPosition();l&&(c.x=c.x+l.x,c.y=c.y+l.y),game.EffectUtil.playEffect(i,o,i.getDirection(),c,!1,e==a)}}this.addLightShader()}}},addLightShader:function(){!this._machine||this._machine.usable;var e=game.mainRole.mainRoleId;if(this._ref.releaserId==e&&this._machine.owner.data.type==game.RoleType.Monster){var t=this._machine.owner.data.getMonsterType();if(t==game.MonsterType.WORLD_BOSS||t==game.MonsterType.BOSS){var i=game.SysTime.curTime;this._lightShaderCd>i||(this._lightShaderCd=i+500,b8e.Tween.kill(this),this._machine.owner.forEachAnimator(function(e,t){switch(t.type){case game.AnimatorType.BODY:var i=t.getShader();i.getColorTransfrom().setData([8,8,8,1,0,0,0,0]),i.update()}},this),b8e.Tween.get(this).wait(100).call(this.removeLightShader,this))}}},removeLightShader:function(){this._machine&&this._machine.usable&&this._machine.owner.forEachAnimator(function(e,t){switch(t.type){case game.AnimatorType.BODY:var i=t.getShader();i.getColorTransfrom().clear(),i.update()}},this)},clear:function(){b8e.Tween.kill(this),this.removeLightShader(),this._lightShaderCd=0,this._super()}})},{}],1584:[function(e,t,i){"use strict";game.IdleState=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_IDLE)},execute:function(){this._machine&&this._machine.usable&&(this._super(),this.syncAnimation(!1,-1))},beforeExecute:function(e){this._machine&&this._machine.usable&&this._super(e)},afterEnter:function(){this._super()},afterExecute:function(){this._super(),this._machine&&this._machine.usable},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=game.RoleActionType.IDLE;switch(t.type){case game.AnimatorType.BODY:this._machine.isRiding()&&(a=game.RoleActionType.MOUNT_IDLE),t.play(a,n,s),i&&t.stop(n),t.setVisible(!0);break;case game.AnimatorType.MOUNT_BODY:case game.AnimatorType.MOUNT_HEAD:case game.AnimatorType.WING:t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.isBingDong()&&!t)},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){if(e.type==game.RoleStateType.ACTION_DEATH)return!!t;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!!t}return!0}})},{}],1585:[function(e,t,i){"use strict";game.JumpMoveState=game.MoveState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_JUMP_MOVE)},enter:function(){this._machine&&this._machine.usable&&this._super()},execute:function(){if(this._super(),!(this._ref instanceof game.JumpMoveStateReference))throw new Error("跳跃移动状态引用必须是JumpMoveStateReference类型！");this._machine.owner.setGhost(this._ref.ghostSpacing,this._ref.ghostDuration),this.jumpToPos(this._ref.moveToPos)},leave:function(){this._super(),this._machine&&this._machine.usable&&this.stopJump()},arrive:function(){this._machine&&this._machine.usable&&(b8e.Tween.kill(this),this._machine.isPrewarWaiting()?this.transition(game.RoleStateType.ACTION_PREWAR):this.transition(game.RoleStateType.ACTION_IDLE),this._ref.arrive())},stopJump:function(){if(this._machine&&this._machine.usable){b8e.Tween.kill(this);var e=this._machine.owner;e.offsetY=0,e.setScenePosition(this._ref.moveToPos.x,this._ref.moveToPos.y),e.setGhost(0,0),this._ref.stop()}},jumpToPos:function(e){if(this._machine&&this._machine.usable&&e){b8e.Tween.kill(this);var t=this._machine.owner.getScene(),i=this._ref.upTime,n=this._ref.downTime,s=this._ref.jumpHeight,a=i+n,o=t.sceneUIToGLPos(e.x,e.y);this._machine.owner.faceTo(e.x,e.y),b8e.Tween.get(this).to({roleX:o.x,roleY:o.y},a).call(this.arrive,this),b8e.Tween.get(this).to({roleOffsetY:s},i,b8e.Ease.quartOut).to({roleOffsetY:0},n,b8e.Ease.quartIn)}},roleX:{get:function(){return this._machine.owner.x},set:function(e){this._machine.owner.x=e}},roleY:{get:function(){return this._machine.owner.y},set:function(e){this._machine.owner.y=e}},roleOffsetY:{get:function(){return this._machine.owner.offsetY},set:function(e){this._machine.owner.offsetY=e}},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.isBingDong()&&!t)},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._machine.isDeadState())return!1;if(this._machine.isAttackHarding()){if(!t)return!1}else if(this._machine.isLockCaseSpell()){if(!t)return!1}else{if(this._machine.isStiff())return!1;if(this._machine.isStun())return!1;if(this._machine.isUnmovable())return!1;if(this._machine.isBlinkMoving())return!1;if(this._machine.isBeatMoving())return!1;if(this._machine.isJumpMoving())return!1;if(this._machine.isAttacking()){var i=this._machine.getCurrState("ActionState");if(!t&&!i.attackBroken&&!i.canWalkRelease)return!1}else if(this._machine.isBlinking()){var n=this._machine.getCurrState("ActionState");if(!t&&!n.blinkBroken)return!1}}return!0},clear:function(){this._super()}})},{}],1586:[function(e,t,i){"use strict";game.JumpMoveStateReference=b8e.StateReference.extends({_moveToPos:null,_arriveCb:null,_stopCb:null,_endCb:null,upTime:0,downTime:0,jumpHeight:0,ghostSpacing:0,ghostDuration:0,ctor:function(){this._super()},moveToPos:{get:function(){return this._moveToPos}},setParams:function(e,t,i,n,s,a){this._moveToPos=e,this.upTime=t,this.downTime=i,this.jumpHeight=n,this.ghostSpacing=s,this.ghostDuration=a},onArrive:function(e,t,i){return this._arriveCb=e?{func:e,thisArg:t,args:i}:null,this},onStop:function(e,t,i){return this._stopCb=e?{func:e,thisArg:t,args:i}:null,this},onEnd:function(e,t,i){return this._endCb=e?{func:e,thisArg:t,args:i}:null,this},arrive:function(){var e;this._arriveCb&&(e=this._arriveCb.args?this._arriveCb.args.concat(this):[this],this._arriveCb.func.apply(this._arriveCb.thisArg,e))},stop:function(){var e;this._stopCb&&(e=this._stopCb.args?this._stopCb.args.concat(this):[this],this._stopCb.func.apply(this._stopCb.thisArg,e))},end:function(){var e;this._endCb&&(e=this._endCb.args?this._endCb.args.concat(this):[this],this._endCb.func.apply(this._endCb.thisArg,e))},clear:function(){this._moveToPos=null,this._arriveCb=null,this._stopCb=null,this._endCb=null,this.upTime=0,this.downTime=0,this.jumpHeight=0,this.ghostSpacing=0,this.ghostDuration=0,this._super()}})},{}],1587:[function(e,t,i){"use strict";game.JumpState=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_JUMP)},execute:function(){if(this._machine&&this._machine.usable){if(this._super(),!(this._ref instanceof game.JumpStateReference))throw new Error("跳跃状态引用必须是JumpStateReference类型！");this.syncAnimation(!1,-1);var e=this.getReference(game.JumpMoveStateReference);e.setParams(this._ref.moveToPos,this._ref.upTime,this._ref.downTime,this._ref.jumpHeight,this._ref.ghostSpacing,this._ref.ghostDuration),this.transition(game.RoleStateType.CONTROL_JUMP_MOVE,e)}},afterEnter:function(){this._super()},afterExecute:function(){this._super()},leave:function(){this._super(),this.transition(game.RoleStateType.CONTROL_STOP_WALK_MOVE)},afterLeave:function(){this._super(),this._machine&&this._machine.usable&&game.EventAreaChecker.checkEffect(this._machine.owner)},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=game.RoleActionType.WALK,o=this._ref.suspendFrameTime;switch(t.type){case game.AnimatorType.BODY:this._machine.isRiding()&&(a=game.RoleActionType.MOUNT_IDLE),t.play(a,o,s),t.stop(o),t.setVisible(!0);break;case game.AnimatorType.MOUNT_BODY:case game.AnimatorType.MOUNT_HEAD:t.play(a,o,s),t.stop(o),t.setVisible(!0);break;case game.AnimatorType.WING:a=game.RoleActionType.IDLE,t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},setAnimationSpeed:function(e,t,i){switch(this._super(e,t,i),t.type){case game.AnimatorType.BODY:t.setSpeedRatio(i)}},enterPass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1;if(e.type==game.RoleStateType.ACTION_JUMP)return!1}return!this._machine.isVertigo()&&(!this._machine.isAttackHarding()&&(!this._machine.isStiff()&&(!this._machine.isStun()&&!this._machine.isUnmovable())))},leavePass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e.type==game.RoleStateType.ACTION_DEATH||(e.type==game.RoleStateType.ACTION_DEATH_FLY||e.type!=game.RoleStateType.ACTION_HIT&&!this._machine.isBingDong())},clear:function(){this._super()}})},{}],1588:[function(e,t,i){"use strict";game.JumpStateReference=b8e.StateReference.extends({_moveToPos:null,suspendFrameTime:0,upTime:0,downTime:0,jumpHeight:0,ghostSpacing:0,ghostDuration:0,arriveCb:null,ctor:function(){this._super()},setParams:function(e,t,i,n,s,a,o){this._moveToPos=e,this.suspendFrameTime=t,this.upTime=i,this.downTime=n,this.jumpHeight=s,this.ghostSpacing=a,this.ghostDuration=o},onArrive:function(e,t,i){return this.arriveCb={func:e,thisArg:t,args:i},this},moveToPos:{get:function(){return this._moveToPos}},clear:function(){this._moveToPos=null,this.arriveCb=null,this.suspendFrameTime=0,this.upTime=0,this.downTime=0,this.jumpHeight=0,this.ghostSpacing=0,this.ghostDuration=0,this._super()}})},{}],1589:[function(e,t,i){"use strict";game.MoveState=b8e.ControlState.extends({ctor:function(e){this._super(e)},tribe:{get:function(){return"MoveState"}}})},{}],1590:[function(e,t,i){"use strict";game.RideState=b8e.ControlState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_RIDE)},tribe:{get:function(){return"RidingState"}},afterEnter:function(){this._super(),this._machine.updateAvatar()},leave:function(){this._super()},afterLeave:function(){this._super(),this._machine.updateAvatar()}})},{}],1591:[function(e,t,i){"use strict";game.RoleActionType=b8e.Enum({IDLE:"stand",WALK:"run",MOUNT_IDLE:"standAndRide",MOUNT_WALK:"runAndRide",DIE:"die"})},{}],1592:[function(e,t,i){"use strict";var n=game.RoleStateMachine=b8e.StateMachine.extends({ctor:function(e){this._super(e),n.init(this)},isWalking:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_WALK},isJumping:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_JUMP},isRunning:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_RUN},isWalkMoving:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.CONTROL_WALK_MOVE},isJumpMoving:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.CONTROL_JUMP_MOVE},isDeath:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_DEATH},isDeathFly:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_DEATH_FLY},isDeadState:function(){return this.isDeath()||this.isDeathFly()},isAttacking:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_ATTACK},isCollecting:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_COLLECT},isRiding:function(){return null!=this.getCurrState("RidingState")},isBlinking:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_BLINK},isBlinkMoving:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.CONTROL_BLINK_MOVE},isBeatMoving:function(){var e=this.getCurrState("MoveState");return e&&e.type==game.RoleStateType.CONTROL_BEAT_MOVE},isBeatBack:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_BEAT_BACK},isIdle:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_IDLE},isPrewar:function(){var e=this.getCurrState("ActionState");return e&&e.type==game.RoleStateType.ACTION_PREWAR},isPrewarWaiting:function(){return null!=this.getCurrState("PrewarWaitingState")},isAttackHarding:function(){return null!=this.getCurrState("AttackHardState")},isLockCaseSpell:function(){return null!=this.getCurrState("CastSpellLockState")},isBingDong:function(){return null!=this.getCurrState("BingDongState")},isStun:function(){return null!=this.getCurrState("StunState")},isUnmovable:function(){return null!=this.getCurrState("UnmovableState")},isStiff:function(){return null!=this.getCurrState("StiffState")},isHush:function(){return null!=this.getCurrState("HushState")},isVertigo:function(){return null!=this.getCurrState("vertigo")},isSilentState:function(){return null!=this.getCurrState("silent")},updateAvatar:function(){var e=this.getCurrState("ActionState");e&&e.syncAnimation(e.isFreeze,-1)},actionPause:function(){var e=this.getCurrState("ActionState");e&&e.pause()},actionResume:function(){var e=this.getCurrState("ActionState");e&&e.resume()},clear:function(){this._super()},restore:function(e){this._super(e)},recycle:function(){this._super()}});n.stateMapping=null,n.init=function(e){if(!n.stateMapping){var t=n.stateMapping={};t[game.RoleStateType.ACTION_IDLE]=game.IdleState,t[game.RoleStateType.ACTION_WALK]=game.WalkState,t[game.RoleStateType.ACTION_JUMP]=game.JumpState,t[game.RoleStateType.ACTION_ATTACK]=game.AttackState,t[game.RoleStateType.ACTION_DEATH]=game.DeathState,t[game.RoleStateType.ACTION_DEATH_FLY]=game.DeathFlyState,t[game.RoleStateType.CONTROL_WALK_MOVE]=game.WalkMoveState,t[game.RoleStateType.CONTROL_JUMP_MOVE]=game.JumpMoveState,t[game.RoleStateType.CONTROL_STOP_WALK_MOVE]=game.StopWalkMoveState,t[game.RoleStateType.CONTROL_RIDE]=game.RideState,t[game.RoleStateType.CONTROL_HIT_EFFECT]=game.HitEffectState,t[game.RoleStateType.CONTROL_VERTIGO]=game.VertigoState,t[game.RoleStateType.CONTROL_SLIENT]=game.SilentState}e.setStateMapping(n.stateMapping)}},{}],1593:[function(e,t,i){"use strict";game.RoleStateType=b8e.Enum({ACTION_IDLE:1,ACTION_WALK:2,ACTION_JUMP:3,ACTION_DEATH:4,ACTION_HIT:5,ACTION_PREWAR:6,ACTION_ATTACK:7,ACTION_DEATH_FLY:8,CONTROL_WALK_MOVE:101,CONTROL_JUMP_MOVE:102,CONTROL_STOP_WALK_MOVE:103,CONTROL_BLINK_MOVE:104,CONTROL_BEAT_MOVE:105,CONTROL_RIDE:106,CONTROL_HIT_EFFECT:107,CONTROL_VERTIGO:108,CONTROL_SLIENT:109})},{}],1594:[function(e,t,i){"use strict";game.StopWalkMoveState=game.MoveState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_STOP_WALK_MOVE)},_moveMsg:null,execute:function(){if(this._super(),this._machine&&this._machine.usable&&this._ref){if(!(this._ref instanceof game.StopWalkMoveStateReference))throw new Error("停止行走移动状态引用必须是StopWalkMoveStateRef类型！");var e=this._ref.getTargetX(),t=this._ref.getTargetY();if(this._machine.owner.setGridPosition(e,t),this.transition(game.RoleStateType.ACTION_IDLE),!this._machine.owner.data.isSelf)return;game.MoveToHelper.inst().moveCompleteStopMove(e,t)}},clear:function(){this._super()}})},{}],1595:[function(e,t,i){"use strict";game.StopWalkMoveStateReference=b8e.StateReference.extends({_targetX:0,_targetY:0,ctor:function(){this._super(),this._targetX=0,this._targetY=0},setParams:function(e,t){this._targetX=e,this._targetY=t},getTargetX:function(){return this._targetX},getTargetY:function(){return this._targetY},clear:function(){this._targetX=0,this._targetY=0,this._super()}})},{}],1596:[function(e,t,i){"use strict";game.WalkMoveState=game.MoveState.extends({_isMoving:!1,_nextPos:null,_lastEndPos:null,_lastPos:null,_lastSpeed:0,_pathEndPos:null,_moveMsg:null,ctor:function(){this._super(game.RoleStateType.CONTROL_WALK_MOVE),this._isMoving=!1,this._nextPos=null,this._lastEndPos=null,this._lastPos=null,this._lastSpeed=0},enter:function(){this._machine&&this._machine.usable&&this._super()},execute:function(){if(this._super(),!(this._ref instanceof game.WalkMoveStateReference))throw new Error("行走移动状态引用必须是WalkMoveStateReference类型！");if(this._ref.startPos={x:this._machine.owner.gridX,y:this._machine.owner.gridY},this._pathEndPos=this._ref.pathEndPos,this._ref.path){var e=this._ref.path;this._lastPos=e.shift(),this.walkByPath(e)}else this._ref.moveToPos?(this._ref.endPos=this._ref.startPos,this.walkToPos(this._ref.moveToPos)):this._ref.moveInfo?(this._ref.endPos=this._ref.startPos,this.walkByInfo(this._ref.moveInfo)):this.refreshWalk()},leave:function(){this._super(),this._machine&&this._machine.usable&&this.stopWalk()},ready:function(){this._machine&&this._machine.usable&&this._ref.ready()},serverWalk:function(){this._machine&&this._machine.usable&&this._ref.serverWalk()},unable:function(){this._machine&&this._machine.usable&&(this._machine.isPrewarWaiting()?this.transition(game.RoleStateType.ACTION_PREWAR):this.transition(game.RoleStateType.ACTION_IDLE),this._ref.unable())},through:function(){this._ref&&this._ref.through()},startMove:function(e){this._ref&&(this._ref.nextPos=e,this.move())},move:function(){this._ref&&this._ref.move()},arrive:function(){this._machine&&this._machine.usable&&(b8e.Tween.kill(this),this._machine.isPrewarWaiting()?this.transition(game.RoleStateType.ACTION_PREWAR):this.transition(game.RoleStateType.ACTION_IDLE),this._ref.arrive())},stopWalk:function(){this._machine&&this._machine.usable&&(b8e.Tween.kill(this),this._isMoving&&this._ref.stop(),this._ref.end(),this._ref&&(this._lastEndPos=null,this._lastSpeed=0,this._lastPos=null,this._isMoving=!1,this._pathEndPos=null))},refreshWalk:function(){this._lastEndPos=null,this._lastSpeed=0;var e=this._ref.endPos;this.walkToPos(e)},walkToPos:function(e){if(this._machine&&this._machine.usable&&e)if(b8e.Tween.kill(this),this._machine.owner.data&&this._machine.owner.data.isSelf||this._machine.owner.getHierarchyVisible()){var t=this._machine.owner.getScene(),i=this._machine.owner.getGridPosition(),n=t.findPath(i.x,i.y,e.x,e.y,!0);if(null==n||n.length<2)return this._machine.owner.faceToGrid(e.x,e.y),void this.unable();var s=[];if(n.forEach(function(e){s.push({x:e.x,y:e.y})},this),0<this._ref.spacing){var a=s[s.length-2],o=s[s.length-1],r=t.getPixelPosByGrid(a.x,a.y),h=t.getPixelPosByGrid(o.x,o.y),g=b8e.MathUtil.getDistance(r.x,r.y,h.x,h.y)-this._ref.spacing,l=0<g?b8e.MathUtil.getSpaceDistance(r.x,r.y,h.x,h.y,g):{x:r.x,y:r.y};l=t.getGridPosByPixel(l.x,l.y),o.x=l.x,o.y=l.y}var c=s[0],u=s[s.length-1];if(this.isArriveTarget(c,u))this._machine.owner.faceToGrid(e.x,e.y),this.arrive();else{if(this._isMoving&&this._lastEndPos&&this.isArriveTarget(this._lastEndPos,u))return;this._ref.path=s,this._lastPos=s.shift(),this.walkByPath(s)}}else this._machine.owner.setGridPosition(e.x,e.y),this.arrive()},walkByInfo:function(e){if(this._machine&&this._machine.usable&&e){for(var t=[],i=[],n=this._lastPos=null,s=0,a=0,o=0,r=this._machine.owner.getScene(),h=e.path.length,g=0;g<h;g++){var l=e.path[g];if(n){a=n.x,o=n.y;var c=r.getPixelPosByGrid(a,o),u=r.getPixelPosByGrid(l.x,l.y);s+=b8e.MathUtil.getDistance(u.x,u.y,c.x,c.y)/this._ref.speed}else s=e.startTime;n={x:l.x,y:l.y},t.push(n),i.push(s)}var m=t[0],_=t[t.length-1];this.isArriveTarget(m,_)?this.arrive():(this._ref.path=t,this._ref.startPos=m,this._ref.endPos=_,this._lastPos=t.shift(),i.shift(),this.serverWalk(),this.walkByPath(t,i))}},isArriveTarget:function(e,t){return!1},walkByPath:function(e,t){if(this._machine&&this._machine.usable){if(this._isMoving=!0,this._lastEndPos=this._ref.endPos,this._lastSpeed=this._ref.speed,e.length<1)return void this.arrive();this.ready(),b8e.Tween.kill(this),this.startMoveStep(e,t)}},startMoveStep:function(e,t){this._machine&&this._machine.usable&&this.moveStep(e,t)},moveStep:function(e,t){if(this._machine&&this._machine.usable){if(!this._isMoving)return;if(b8e.Tween.kill(this),e&&0<e.length){var i,n=this._machine.owner.getScene();this._nextPos=e.shift();var s=n.getPixelPosByGrid(this._nextPos.x,this._nextPos.y);if(t){i=t.shift()-game.SysTime.curTime;var a=n.getPixelPosByGrid(this._lastPos.x,this._lastPos.y),o=b8e.MathUtil.getRadian(a.x,a.y,s.x,s.y),r=Math.cos(o),h=Math.sin(o),g=this._ref.speed*i,l=s.x-g*r,c=s.y-g*h;l<0||c<0?this._machine.owner.setScenePosition(s.x,s.y):this._machine.owner.setScenePosition(l,c)}else{var u=this._machine.owner.getScenePosition();i=b8e.MathUtil.getDistance(u.x,u.y,s.x,s.y)/this._ref.speed}if(this._machine.owner.faceToGrid(this._nextPos.x,this._nextPos.y),this.startMove(this._nextPos),this._ref.path=e,this._ref.startPos=this._lastPos,this._ref.endPos=this._nextPos,this._ref.sync(),this.syncSelf(this._ref),this._lastPos=this._nextPos,0<i){var m=n.sceneUIToGLPos(s.x,s.y);b8e.Tween.get(this).to({roleX:m.x,roleY:m.y},i).call(this.moveStep,this,[e,t])}else this._machine.owner.setScenePosition(s.x,s.y),this.moveStep(e,t)}else this.arrive()}},syncSelf:function(e){if(this._machine.owner.data.isSelf&&!game.PlotMgr.inst().isPlaying()){var t=e.endPos,i=this._machine.owner.getGridPosition(),n=0,s=0;e.path&&0<e.path.length&&(n=e.path[e.path.length-1].x,s=e.path[e.path.length-1].y),this._moveMsg||(this._moveMsg=b8e.ProtobufUtil.createMessage(game.pbmsg.MovePosRequest)),this._moveMsg.ts=game.SysTime.curTime,this._moveMsg.pos||(this._moveMsg.pos={}),this._moveMsg.pos.x=i.x,this._moveMsg.pos.y=i.y,this._moveMsg.targetPos||(this._moveMsg.targetPos={}),this._moveMsg.targetPos.x=t.x,this._moveMsg.targetPos.y=t.y,this._moveMsg.pathEndPos||(this._moveMsg.pathEndPos={}),this._moveMsg.pathEndPos.x=n,this._moveMsg.pathEndPos.y=s,engine.NetSender.getBytes().writeProtobuf(this._moveMsg);var a=game.pbmid.Scene.MovePosRequest;b8e.sendN(a),game.MoveToHelper.inst().addMoveCd()}},getPathEndPos:function(){return this._pathEndPos},roleX:{get:function(){return this._machine&&this._machine.owner?this._machine.owner.x:0},set:function(e){this._machine&&this._machine.owner&&(this._machine.owner.x=e)}},roleY:{get:function(){return this._machine&&this._machine.owner?this._machine.owner.y:0},set:function(e){this._machine&&this._machine.owner&&(this._machine.owner.y=e)}},leavePass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!(this._machine.isBingDong()&&!t)},enterPass:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this._machine.isDeadState())return!1;if(this._machine.isAttackHarding()){if(!t)return!1}else if(this._machine.isLockCaseSpell()){if(!t)return!1}else{if(this._machine.isStiff())return!1;if(this._machine.isStun())return!1;if(this._machine.isUnmovable())return!1;if(this._machine.isBlinkMoving())return!1;if(this._machine.isBeatMoving())return!1;if(this._machine.isJumpMoving())return!1;if(this._machine.isAttacking()){var i=this._machine.getCurrState("ActionState");if(!t&&!i.attackBroken&&!i.canWalkRelease)return!1}else if(this._machine.isBlinking()){var n=this._machine.getCurrState("ActionState");if(!t&&!n.blinkBroken)return!1}}return!0},clear:function(){this._lastEndPos=null,this._lastSpeed=0,this._lastPos=null,this._nextPos=null,this._isMoving=!1,this._pathEndPos=null,this._super()}})},{}],1597:[function(e,t,i){"use strict";game.WalkMoveStateReference=b8e.StateReference.extends({_moveToPos:null,_moveInfo:null,_speed:0,_spacing:0,_readyCb:null,_serverWalkCb:null,_unableCb:null,_throughCb:null,_moveCb:null,_updateCb:null,_arriveCb:null,_stopCb:null,_endCb:null,_syncCb:null,nextPos:null,path:null,startPos:null,endPos:null,isServerStop:!1,pathEndPos:null,ctor:function(){this._super()},moveToPos:{get:function(){return this._moveToPos}},moveInfo:{get:function(){return this._moveInfo}},speed:{get:function(){return this._speed}},spacing:{get:function(){return this._spacing}},setParams:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this._speed=e,this._spacing=t,this._moveToPos=i,this._moveInfo=n,this.isServerStop=!1,this.isDeviation=!1,this.path=null},onReady:function(e,t,i){return this._readyCb=e?{func:e,thisArg:t,args:i}:null,this},onServerWalk:function(e,t,i){return this._serverWalkCb=e?{func:e,thisArg:t,args:i}:null,this},onUnable:function(e,t,i){return this._unableCb=e?{func:e,thisArg:t,args:i}:null,this},onThrough:function(e,t,i){return this._throughCb=e?{func:e,thisArg:t,args:i}:null,this},onMove:function(e,t,i){return this._moveCb=e?{func:e,thisArg:t,args:i}:null,this},onUpdate:function(e,t,i){return this._updateCb=e?{func:e,thisArg:t,args:i}:null,this},onArrive:function(e,t,i){return this._arriveCb=e?{func:e,thisArg:t,args:i}:null,this},onStop:function(e,t,i){return this._stopCb=e?{func:e,thisArg:t,args:i}:null,this},onEnd:function(e,t,i){return this._endCb=e?{func:e,thisArg:t,args:i}:null,this},onSync:function(e,t,i){return this._syncCb=e?{func:e,thisArg:t,args:i}:null,this},serverWalk:function(){var e;this._serverWalkCb&&(e=this._serverWalkCb.args?this._serverWalkCb.args.concat(this):[this],this._serverWalkCb.func.apply(this._serverWalkCb.thisArg,e))},ready:function(){var e;this._readyCb&&(e=this._readyCb.args?this._readyCb.args.concat(this):[this],this._readyCb.func.apply(this._readyCb.thisArg,e))},unable:function(){var e;this._unableCb&&(e=this._unableCb.args?this._unableCb.args.concat(this):[this],this._unableCb.func.apply(this._unableCb.thisArg,e))},through:function(){var e;this._throughCb&&(e=this._throughCb.args?this._throughCb.args.concat(this):[this],this._throughCb.func.apply(this._throughCb.thisArg,e))},move:function(){var e;this._moveCb&&(e=this._moveCb.args?this._moveCb.args.concat(this):[this],this._moveCb.func.apply(this._moveCb.thisArg,e))},update:function(){var e;this._updateCb&&(e=this._updateCb.args?this._updateCb.args.concat(this):[this],this._updateCb.func.apply(this._updateCb.thisArg,e))},arrive:function(){var e;this._arriveCb&&(e=this._arriveCb.args?this._arriveCb.args.concat(this):[this],this._arriveCb.func.apply(this._arriveCb.thisArg,e))},stop:function(){var e;this._stopCb&&(e=this._stopCb.args?this._stopCb.args.concat(this):[this],this._stopCb.func.apply(this._stopCb.thisArg,e))},end:function(){var e;this._endCb&&(e=this._endCb.args?this._endCb.args.concat(this):[this],this._endCb.func.apply(this._endCb.thisArg,e))},sync:function(){var e;this._syncCb&&(e=this._syncCb.args?this._syncCb.args.concat(this):[this],this._syncCb.func.apply(this._syncCb.thisArg,e))},clear:function(){this._moveToPos=null,this._moveInfo=null,this._serverWalkCb=null,this._readyCb=null,this._unableCb=null,this._throughCb=null,this._moveCb=null,this._updateCb=null,this._arriveCb=null,this._stopCb=null,this._endCb=null,this._syncCb=null,this.nextPos=null,this.nextGridPos=null,this.path=null,this.startPos=null,this.endPos=null,this._speed=0,this._spacing=0,this.isServerStop=!1,this._super()}})},{}],1598:[function(e,t,i){"use strict";game.WalkState=b8e.ActionState.extends({ctor:function(){this._super(game.RoleStateType.ACTION_WALK)},execute:function(){if(this._machine&&this._machine.usable){if(this._super(),!(this._ref instanceof game.WalkStateReference))throw new Error("行走状态引用必须是WalkStateReference类型！");var e=this._ref.footSpan;this.syncSpeedRatio(e),this.syncAnimation(!1,-1);var t=this.getReference(game.WalkMoveStateReference);t.pathEndPos=this._ref.pathEndPos,t.setParams(this._ref.speed,this._ref.spacing,this._ref.moveToPos,this._ref.moveInfo),t.path=this._ref.path,this._machine.owner.data.isSelf&&(t.onSync(this.onSync,this,[t]),this._ref.arriveCb&&(t.onArrive(this._ref.arriveCb.func,this._ref.arriveCb.thisArg,this._ref.arriveCb.args),t.onUnable(this._ref.arriveCb.func,this._ref.arriveCb.thisArg,this._ref.arriveCb.args))),this._ref.transitionWalkMove&&this.transition(game.RoleStateType.CONTROL_WALK_MOVE,t)}},onSync:function(e){},afterEnter:function(){this._super()},afterExecute:function(){this._super()},leave:function(){this._super(),this.transition(game.RoleStateType.CONTROL_STOP_WALK_MOVE)},playAnimation:function(e,t,i,n,s){this._super(e,t,i,n);var a=game.RoleActionType.WALK;switch(t.type){case game.AnimatorType.BODY:this._machine.isRiding()&&(a=game.RoleActionType.MOUNT_IDLE),t.play(a,n,s),i&&t.stop(n),t.setVisible(!0);break;case game.AnimatorType.MOUNT_BODY:case game.AnimatorType.MOUNT_HEAD:t.play(a,n,s),i&&t.stop(n),t.setVisible(!0);break;case game.AnimatorType.WING:a=game.RoleActionType.IDLE,t.play(a,n,s),i&&t.stop(n),t.setVisible(!0)}},setAnimationSpeed:function(e,t,i){switch(this._super(e,t,i),t.type){case game.AnimatorType.BODY:t.setSpeedRatio(i)}},enterPass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e){if(e.type==game.RoleStateType.ACTION_DEATH)return!1;if(e.type==game.RoleStateType.ACTION_DEATH_FLY)return!1;if(e.type==game.RoleStateType.ACTION_JUMP)return!1}return!this._machine.isVertigo()&&(!this._machine.isAttackHarding()&&(!this._machine.isStiff()&&(!this._machine.isStun()&&!this._machine.isUnmovable())))},leavePass:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e.type==game.RoleStateType.ACTION_DEATH||(e.type==game.RoleStateType.ACTION_DEATH_FLY||e.type!=game.RoleStateType.ACTION_HIT&&!this._machine.isBingDong())},clear:function(){this._super()}})},{}],1599:[function(e,t,i){"use strict";game.WalkStateReference=b8e.StateReference.extends({_footSpan:0,moveToPos:null,_moveInfo:null,_speed:0,_spacing:0,arriveCb:null,pathEndPos:null,transitionWalkMove:!0,path:null,ctor:function(){this._super(),this._footSpan=0},setParams:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;this._footSpan=0<e&&0<t?e/t:1,this._speed=e,this._spacing=i,this.moveToPos=n,this._moveInfo=s,this.path=null},onArrive:function(e,t,i){return this.arriveCb={func:e,thisArg:t,args:i},this},footSpan:{get:function(){return this._footSpan}},moveInfo:{get:function(){return this._moveInfo}},speed:{get:function(){return this._speed}},spacing:{get:function(){return this._spacing}},clear:function(){this.moveToPos=null,this._moveInfo=null,this._footSpan=0,this._speed=0,this._spacing=0,this.arriveCb=null,this.transitionWalkMove=!0,this.path=null,this._super()}})},{}],1600:[function(e,t,i){"use strict";game.BuffState=b8e.ControlState.extends({ctor:function(e){e||new Error("继承自buffState没有传入类型"),this._super(e)},tribe:{get:function(){return"MoveState"}}})},{}],1601:[function(e,t,i){"use strict";game.BuffUtil={},game.BuffUtil.setBuffs=function(e){if(e&&e.data){var t=e.data.buffSet;if(t)for(var i,n,s,a=t.getBuffs(),o=e.getAnimator(game.AnimatorType.BODY,1),r=game.PerfMgr.inst().level,h=0;h<a.length;h++)if((i=a[h]).showEffect()&&r==game.PerfMgr.Level.HIGH&&((n=e.getAnimator(game.AnimatorType.BUFF_EFFECT,i.localBuffId))||(n=e.addAnimator(game.AnimatorType.BUFF_EFFECT,i.localBuffId,50),o.addChildToBindNode(n,i.resNode,50)),n.load(i.getEffectUrl()),n.play()),(s=i.getType())!=game.BuffType.None)switch(s){case game.BuffType.Vertigo:e.transitionState(game.RoleStateType.CONTROL_VERTIGO);break;case game.BuffType.Silent:e.transitionState(game.RoleStateType.CONTROL_SLIENT)}}},game.BuffUtil.addBuffs=function(e,t){if(e&&e.data){var i=e.data.buffSet;i&&(i.addBuffs(t),game.BuffUtil.setBuffs(e))}},game.BuffUtil.resetBuff=function(e){if(e&&e.data){var t=e.data.buffSet;if(t){t.clear();var i=e.getStateMachine();i.removeState(game.RoleStateType.CONTROL_VERTIGO),i.removeState(game.RoleStateType.CONTROL_SLIENT)}}},game.BuffUtil.removeBuffs=function(e,t){if(e&&e.data){var i=e.data.buffSet;if(i)for(var n,s,a=e.getStateMachine(),o=0;o<t.length;o++)if(n=i.getBuffById(t[o]))if(n.showEffect()&&e.getAnimator(game.AnimatorType.BUFF_EFFECT,n.localBuffId)&&e.removeAnimator(game.AnimatorType.BUFF_EFFECT,n.localBuffId),(s=n.getType())!=game.BuffType.None)switch(i.removeBuff(t[o]),s){case game.BuffType.Vertigo:a.removeState(game.RoleStateType.CONTROL_VERTIGO);break;case game.BuffType.Silent:a.removeState(game.RoleStateType.CONTROL_SLIENT)}else i.removeBuff(t[o]);else b8e.log("服务器试图删除",e.data.id,"身上一个不存在的buff",t[o])}}},{}],1602:[function(e,t,i){"use strict";game.SilentState=game.BuffState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_SLIENT)},tribe:{get:function(){return"silent"}}})},{}],1603:[function(e,t,i){"use strict";game.VertigoState=game.BuffState.extends({ctor:function(){this._super(game.RoleStateType.CONTROL_VERTIGO)},tribe:{get:function(){return"vertigo"}},execute:function(){this._machine&&this._machine.usable&&(this._super(),this.transition(game.RoleStateType.ACTION_IDLE))}})},{}],1604:[function(e,t,i){"use strict";e("./RoleStateType"),e("./RoleActionType"),e("./IdleState"),e("./MoveState"),e("./StopWalkMoveState"),e("./StopWalkMoveStateReference"),e("./WalkMoveState"),e("./WalkMoveStateReference"),e("./WalkState"),e("./WalkStateReference"),e("./JumpMoveState"),e("./JumpMoveStateReference"),e("./JumpState"),e("./JumpStateReference"),e("./RideState"),e("./AttackState"),e("./AttackStateReference"),e("./DeathState"),e("./HitEffectState"),e("./HitEffectReference"),e("./DeathFlyReference"),e("./DeathFlyState"),e("./FixedState"),e("./RoleStateMachine"),e("./buff/BuffState"),e("./buff/VertigoState"),e("./buff/BuffUtil"),e("./buff/SilentState")},{"./AttackState":1576,"./AttackStateReference":1577,"./DeathFlyReference":1578,"./DeathFlyState":1579,"./DeathState":1580,"./FixedState":1581,"./HitEffectReference":1582,"./HitEffectState":1583,"./IdleState":1584,"./JumpMoveState":1585,"./JumpMoveStateReference":1586,"./JumpState":1587,"./JumpStateReference":1588,"./MoveState":1589,"./RideState":1590,"./RoleActionType":1591,"./RoleStateMachine":1592,"./RoleStateType":1593,"./StopWalkMoveState":1594,"./StopWalkMoveStateReference":1595,"./WalkMoveState":1596,"./WalkMoveStateReference":1597,"./WalkState":1598,"./WalkStateReference":1599,"./buff/BuffState":1600,"./buff/BuffUtil":1601,"./buff/SilentState":1602,"./buff/VertigoState":1603}],1605:[function(e,t,i){"use strict";e("./MainRoleMgr"),e("./FirstEnterSceneMgr"),e("./SceneMgr"),e("./ScenePickMgr"),e("./SceneRoleCmd"),e("./SceneRoleMgr"),e("./SceneSender"),e("./role/roleIndex"),e("./WeatherMgr"),e("./FogMgr"),e("./SceneQuickEnterMgr")},{"./FirstEnterSceneMgr":1543,"./FogMgr":1544,"./MainRoleMgr":1545,"./SceneMgr":1546,"./ScenePickMgr":1547,"./SceneQuickEnterMgr":1548,"./SceneRoleCmd":1549,"./SceneRoleMgr":1550,"./SceneSender":1551,"./WeatherMgr":1552,"./role/roleIndex":1575}],1606:[function(e,t,i){"use strict";var n=game.CCommonUtil=function(){};n.getPower=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=0;if(!e)return n;var s=e.getSpriteStats();if(!s||s.length<=0)return n;for(var a=0;a<s.length;a++){var o=s[a];if(o){var r=game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(o.type);if(r){var h=game.ccfg.LvPowerCoefCfg.getLvCoefByLv(t),g=game.ValueUtil.getDigitsValueByNum(r.coef,4);switch(r.type){case game.AttrPowerCoefType.TYPE_0:n+=Math.round((o.value+Math.round(o.value*i))*g);break;case game.AttrPowerCoefType.TYPE_1:n+=Math.round((o.value+Math.round(o.value*i))*g*h)}}}}return Math.round(n)},n.getSingleAttrPower=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=0;if(!e||!t)return s;var a=game.ccfg.AttrPowerCoefCfg.getAttrPowerCoefInfoByType(e);if(a){var o=game.ccfg.LvPowerCoefCfg.getLvCoefByLv(i),r=game.ValueUtil.getDigitsValueByNum(a.coef,4);switch(a.type){case game.AttrPowerCoefType.TYPE_0:s+=Math.round((t+Math.round(t*n))*r);break;case game.AttrPowerCoefType.TYPE_1:s+=Math.round((t+Math.round(t*n))*r*o)}}return Math.round(s)},n.showItemTips=function(e){e.faceInfo.isEquip?game.app.show(game.AppConstant.EQUIP_BASE_TIPS,e.faceInfo):game.app.show(game.AppConstant.ITEM_TIPS,{itemInfo:e.faceInfo,containerId:e.gridInfo.containerId})},n.createRectGrids=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:4,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:120,r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:100,h=!(8<arguments.length&&void 0!==arguments[8])||arguments[8];if(e&&!(e.length<=0)){var g,l,c,u,m;s=s||e.length;for(var _=0;_<s;_++){if((c=game.GridUtil.creatItemGrid(t,i)).gridInfo=new game.GridInfo(game.ContainerId.ROULETTE_CONTAINER_ID),c.setScale(game.IconScale.PERCENT_80,game.IconScale.PERCENT_80),!(m=e[_]))return;game.back.isBianshenCard(m.itemId)?((u=game.ccfg.BianshenCfg.getBianshenCfgById(m.itemId)).type=game.GoodsType.BIAN_SHEN_CARD,u.desc=""):u=game.ccfg.ItemInfoCfg.getItemInfoById(m.itemId,!0),u&&(u.num=m.itemNum,game.GridUtil.setItemGrid(c,u),n&&c.fnOnClick(t,n),c.setNum(m.itemNum),g=_%a*o,l=(_/a>>0)*r,l=h?l:-l,c.setPosition(g,l),c.sortLayer())}}},n.isNumber=function(e){if(!e||e.length<=0)return!1;for(var t=0;t<e.length;t++)if(e.charAt(t)<"0"||"9"<e.charAt(t))return!1;return!0}},{}],1607:[function(e,t,i){"use strict";game.ColorEnum=b8e.Enum({COLOR_100:100,COLOR_101:101,COLOR_102:102,COLOR_103:103,COLOR_104:104,COLOR_105:105,COLOR_106:106,COLOR_107:107,COLOR_108:108,COLOR_109:109,COLOR_110:110,COLOR_111:111,COLOR_112:112})},{}],1608:[function(e,t,i){"use strict";game.EffectUtil={},game.EffectUtil.playEffect=function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,r=game.SceneEffect.get();return r.setPosition(n.x,n.y),b8e.scene.addDisplay(r,void 0,!0,!e.data.isSelf,!e.data.isSelf),r.playEffect(t,i,n,s,e,a,o),r},game.EffectUtil.pauseEffect=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e&&e.pauseEffect(t)},game.EffectUtil.resumeEffect=function(e){e&&e.resumeEffect()},game.EffectUtil.stopEffect=function(e){e&&(e.clear(),e=null)}},{}],1609:[function(e,t,i){"use strict";var n=game.GridUtil=function(){},s=[14,16,17,18,19,20,21,24,25,28,29,34,35,36,37,38,39,40,41,48,49,50,61,80];n.isShowEffect=function(e){return null!=s&&-1!=s.indexOf(e)},n.setItemGrid=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];4<arguments.length&&void 0!==arguments[4]&&arguments[4];if(e){if(e.gridInfo||b8e.log("setItemGrid的grid.gridInfo不能为空"),i&&e.clearData(),t){e.setVisible(!0),e.setAddIcon(!1),e.setAnchor(.5,.5),e.setSize(e.iconSize,e.iconSize);var s=t.iconName;s||(s=""),""!=s&&"0"!=s||(s="item/90001",b8e.log("---物品要加载的图标为空---\x3eitemInfo.id="+t.id+"__itemInfo.name"+t.name));var a,o="",r=0;if(e.gridInfo)switch(r=e.gridInfo.containerId,e.gridInfo.containerId){case game.ContainerId.BACK_CONTAINER_ID:game.GridUtil.setBackGridsState(e,t,s);break;case game.ContainerId.REWRADS_CONTAINER_ID:case game.ContainerId.ACTIVE_DEPOT_CONTAINER_ID:case game.ContainerId.ACTIVE_Mystery_CONTAINER_ID:e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(s)),o=t.isEquip?"Lv."+t.level:t.name,a=game.html.getColorByQuality(t.quality),e.setName(o,a);break;case game.ContainerId.ROLE_EQUIP_CONTAINER_ID:e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(s));break;case game.ContainerId.EQUIP_INTENSIFY_CENTER_CONTAINER_ID:case game.ContainerId.EQUIP_ENCHAN_ID:e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE)),s=game.equip.getEquipIconByType(t.type),e.setIcon(game.ClientCfg.getImgUrl(s));break;case game.ContainerId.SELECT_REWARD_CONTAINER_ID:e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(s)),a=game.html.getColorByQuality(t.quality),e.setName(t.name,a);break;default:e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),t instanceof game.BianshenInfo?e.setIcon(game.ClientCfg.getImgUrl(s),.8,.8):e.setIcon(game.ClientCfg.getImgUrl(s))}else e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(s));return t.num&&e.setNum(t.num),game.GridUtil.isShowEffect(r)?e.setEffect(t.qualityEffect,game.AnimatorType.ITEM_EFFECT):e.clearEffect(),e.faceInfo=t,e}n?(e.setAddIcon(!0),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90),e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE,game.IcoSizeEnum.SIZE_90)),e.sortLayer()):(e.setVisible(!1),e.clearData())}},n.setBackGridsState=function(e,t,i){var n=game.mainRole.mainRoleData.getLv();if(e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(i)),game.GridUtil.setEquipIconState(e,t),0!=t.expireTime?e.setTimelimit(!0):e.setTimelimit(!1),t.isEquip)return e.setRedMask(game.equip.isShowRedMask(t)),void e.setRedIcon(!1);if(e.setRedMask(!1),n<t.level)e.setRedIcon(!1);else if(t.isCostYB)e.setRedIcon(!0);else if(t.isUse)switch(t.type){case game.GoodsType.YAO_SHUI:game.rebirth.isRebirthExp()?e.setRedIcon(!1):e.setRedIcon(game.back.getIsEnough(t));break;case game.GoodsType.XIANDAN:game.xiandan.canUseXiandanById(t.id)?e.setRedIcon(game.back.getIsEnough(t)):e.setRedIcon(!1);break;case game.GoodsType.MOUNT_UPGRADE:case game.GoodsType.FABAO_UPGRADE:case game.GoodsType.WING_UPGRADE:e.setRedIcon(game.back.getIsSU(t));break;default:if(t.notShowRed)e.setRedIcon(!1);else if(t.becomingVipLevelShowRed){var s=game.vip.getVipLv();e.setRedIcon(s>=t.becomingVipLevelShowRed)}else e.setRedIcon(game.back.getIsEnough(t))}else e.setRedIcon(!1)},n.setEquipIconState=function(e,t){var i="",n=game.html.getColorByQuality(t.quality);t.isEquip?(game.equip.isRoleEquip(t)&&(e.setEqWearIcon(!1),e.setEqRefineIcon(!1),game.equip.isCanWear(t)?e.setEqWearIcon(!0):game.funcOpen.checkOpen(game.FunctionType.EQUIP_TI_LIAN)&&game.equip.isCanRefine(t)?e.setEqRefineIcon(!0):e.setEqRefineIcon(!1)),i="Lv."+t.level):i=t.name,e.setName(i,n)},n.setBianshenGrid=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],r=!(7<arguments.length&&void 0!==arguments[7])||arguments[7],h=!(8<arguments.length&&void 0!==arguments[8])||arguments[8],g=9<arguments.length&&void 0!==arguments[9]&&arguments[9];if(e){if(e.gridInfo||b8e.log("setBianshenGrid的grid.gridInfo不能为空"),i&&e.clearData(),t){var l=0;switch(e.gridInfo&&(l=e.gridInfo.containerId),l){case game.ContainerId.CSARENA_RANK_BS_CONTAINER_ID:case game.ContainerId.CSARENA_LAST_RANK_BS_CONTAINER_ID:case game.ContainerId.TOWER_NOTICE_ID:e.setRedIcon(!1);break;case game.ContainerId.BIANSHEN_ARCHIVE_GRID_CONTAINER_ID:case game.ContainerId.SELECT_BIANSHEN_CONTAINER_ID:e.setRedIcon(g,15,15);break;case game.ContainerId.BIANSHEN_BACK_CONTAINER_ID:if(t.battle&&!a)game.bianshen.checkBianShenAlert(t)||g?e.setRedIcon(!0,15,15):e.setRedIcon(!1);else e.setRedIcon(g);break;default:e.setRedIcon(!1)}e.setAddIcon(!1),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_107,game.IcoSizeEnum.SIZE_107),e.setBgImage(game.ClientCfg.getQualityBg(t.quality,game.IcoSizeEnum.SIZE_107));var c=t.iconName;if(c||(c=""),""!=c&&"0"!=c||(c="item/90001",b8e.log("---物品要加载的图标为空---\x3eitemInfo.id="+t.id+"__itemInfo.name"+t.name)),e.setIcon(game.ClientCfg.getImgUrl(c),.99,.99),e.setNum(t.num),h){var u=1;0!=t.level&&(u=t.level),e.setTRLabel("Lv"+u,null,null,null,null,null,null,2)}else e.setTRLabel("");r&&e.setWuxingIcon(game.ClientCfg.getWuxingIcon(t.wuxing)),a||(l==game.ContainerId.SELECT_BIANSHEN_CONTAINER_ID?e.setBattle(t.battle,1):e.setBattle(t.battle)),l==game.ContainerId.BATTLE_BIANSHEN_CONTAINER_ID&&e.setBattle(!1);var m=game.html.getColorByQuality(t.quality);return s?a||e.setName(t.name,m,null,null,null,null,null,1):(game.GridUtil.isShowEffect(l)?e.setEffect(t.qualityEffect,game.AnimatorType.ITEM_EFFECT,1.2,1.2):e.clearEffect(),a||e.setName(t.name,m)),o&&e.setStarBar(game.StarType.BIANSHEN_STAR,t.star,t.jie),e.faceInfo=t,e}n?(e.setAddIcon(!0),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_107,game.IcoSizeEnum.SIZE_107),e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_BLUE,game.IcoSizeEnum.SIZE_107)),e.sortLayer()):(e.setVisible(!1),e.clearData())}},n.setEquipSlotGrid=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(e)if(i&&e.clearData(),t){if(e.gridInfo){e.setVisible(!0),e.setAddIcon(!1),e.setAnchor(.5,.5),e.setSize(e.iconSize,e.iconSize);var o="item/90001",r=game.Quality.Q_WHITE,h=t.equip;if(h)(o=h.iconName)||(o=""),""!=o&&"0"!=o||(o="item/90001",b8e.log("---物品要加载的图标为空---\x3eequipInfo.id = "+h.id+"__equipInfo.name = "+h.name)),r=h.quality,e.gridInfo&&e.gridInfo.containerId,e.clearEffect();switch(e.gridInfo.containerId){case game.ContainerId.ROLE_EQUIP_CONTAINER_ID:t.equip||(o=game.equip.getEquipIconByType(t.slotType),r=game.Quality.Q_WHITE);break;case game.ContainerId.EQUIP_INTENSIFY_CONTAINER_ID:case game.ContainerId.EQUIP_INTENSIFY_CENTER_CONTAINER_ID:case game.ContainerId.EQUIP_ENCHAN_ID:o=game.equip.getEquipIconByType(t.slotType),r=game.Quality.Q_WHITE}if(!h)switch(e.gridInfo.containerId){case game.ContainerId.EQUIP_UP_STAR_CONTAINER_ID:case game.ContainerId.EQUIP_UP_STAR_CENTER_CONTAINER_ID:o=game.equip.getEquipIconByType(t.slotType),r=game.Quality.Q_WHITE}return e.setBgImage(game.ClientCfg.getQualityBg(r)),e.setIcon(game.ClientCfg.getImgUrl(o)),0<t.slotLevel&&(e.gridInfo.containerId==game.ContainerId.EQUIP_ENCHAN_ID?e.setTRLabel(""):(e.setTRLabel("+"+t.slotLevel,null,game.ClientCfg.digits4_0,null,30,30),e.setTRLPos(-5,-5))),0<a&&(e.setStarBar(game.StarType.EQUIP_UP_STAR,a),e.setStarBarPos(0,-30)),e.faceInfo=t,e}b8e.log("---grid.gridInfo为空---\x3e")}else n?(e.setAddIcon(!0),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90),e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE,game.IcoSizeEnum.SIZE_90)),e.sortLayer()):s?(e.setVisible(!0),e.setAddIcon(!1),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90),e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE,game.IcoSizeEnum.SIZE_90)),e.sortLayer()):(e.setVisible(!1),e.clearData())},n.setRuneGrid=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],o=!(6<arguments.length&&void 0!==arguments[6])||arguments[6];7<arguments.length&&void 0!==arguments[7]&&arguments[7];if(e){if(e.gridInfo||b8e.log("setRuneGrid的grid.gridInfo不能为空"),i&&e.clearData(),t){e.setAddIcon(!1),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90),e.setBgImage(game.ClientCfg.getQualityBg(t.quality,game.IcoSizeEnum.SIZE_90));var r=t.iconName;r||(r=""),""!=r&&"0"!=r||(r="item/90001",b8e.log("---物品要加载的图标为空---\x3eruneInfo.id="+t.id+"__runeInfo.name"+t.name)),e.setIcon(game.ClientCfg.getImgUrl(r),.99,.99),t.num&&e.setNum(t.num);var h=1;0!=t.level&&(h=t.level),o?e.setRuneWear(0!==t.runeSuitId&&0!==t.targetSlot):e.setRuneWear(!1);var g=game.html.getColorByQuality(t.quality);return n?e.setName(t.name,g,null,null,null,null,null,1):a&&e.setName("Lv"+h,g,null,null,null,null,null,1),e.faceInfo=t,e}s?(e.setAddIcon(!0),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(game.IcoSizeEnum.SIZE_90,game.IcoSizeEnum.SIZE_90),e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_BLUE,game.IcoSizeEnum.SIZE_90)),e.sortLayer()):(e.setVisible(!1),e.clearData())}},n.setRuneSlot=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];4<arguments.length&&void 0!==arguments[4]&&arguments[4];if(e){if(e.gridInfo||b8e.log("setRuneGrid的grid.gridInfo不能为空"),i&&e.clearData(),!t)return e.setVisible(!1),void e.clearData();if(e.setVisible(!0),e.setAnchor(.5,.5),game.rune.isOpenSlotBySlot(t.targetSlot)){if(e.setLabNamePos(0,0),0==t.idx)e.setBgImage(game.ClientCfg.getRuneSlotBg(game.RuneSlotStateType.UNLOCK_Y)),e.setSize(game.IcoSizeEnum.SIZE_107,game.IcoSizeEnum.SIZE_107),e.setName("",a,null,null,null,null,null,1);else if(0!=t.level){game.rune.canIntensify(t)?e.setRedIcon(!0,-5,-5):e.setRedIcon(!1);var s=t.iconName;if(s||(s=""),""!=s&&"0"!=s||(s="item/90001"),e.setIcon(game.ClientCfg.getImgUrl(s),.99,.99),!n){var a=game.html.getColorByQuality(t.quality);e.setName("Lv."+t.level,a,null,null,null,null,null,1)}}}else{if(e.setBgImage(game.ClientCfg.getRuneSlotBg(game.RuneSlotStateType.LOCK)),e.setSize(game.IcoSizeEnum.SIZE_107,game.IcoSizeEnum.SIZE_107),!n){var o=game.rune.getLimitBySlotId(t.targetSlot);o=Math.ceil(o/6),e.setName(game.ccfg.LangCfg.getText(29001,[o]),game.html.GRAY_WHITE,null,null,null,16,20,1,b8e.OverflowType.NONE)}e.setLabNamePos(0,60)}return e.faceInfo=t,e}},n.setRuneSlotNotice=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];3<arguments.length&&void 0!==arguments[3]&&arguments[3],4<arguments.length&&void 0!==arguments[4]&&arguments[4];if(e)return e.gridInfo||b8e.log("setRuneGrid的grid.gridInfo不能为空"),i&&e.clearData(),t?(e.setVisible(!0),e.setAnchor(.5,.5),e.setBgImage(game.ClientCfg.getRuneSlotBg(game.RuneSlotStateType.LOCK)),e.setSize(game.IcoSizeEnum.SIZE_107,game.IcoSizeEnum.SIZE_107),e.setName(game.ccfg.LangCfg.getText(50005,[t]),game.html.Q_PURPLE,null,null,null,18,20,1,b8e.OverflowType.NONE),e.setLabNamePos(0,-8),e.faceInfo=t,e):(e.setVisible(!1),void e.clearData())},n.setAccessorySkill=function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],r=7<arguments.length&&void 0!==arguments[7]&&arguments[7];if(e){if(e.gridInfo||b8e.log("setRuneGrid的grid.gridInfo不能为空"),i&&e.clearData(),e.setVisible(!0),e.setAnchor(.5,.5),e.setSize(e.iconSize,e.iconSize),!t)return a?(e.setBgImage(game.ClientCfg.spell_lock),void e.setName("")):s?(e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE,game.IcoSizeEnum.SIZE_90)),e.setName(""),void e.setAddIcon(!0)):r?(e.setBgImage(game.ClientCfg.getQualityBg(game.Quality.Q_WHITE,game.IcoSizeEnum.SIZE_90)),void e.setName("")):(e.setVisible(!1),void e.clearData());var h=t.iconName;if(h||(h=""),""!=h&&"0"!=h||(h="item/90001"),1<t.num&&o?e.setNum(t.num):e.setNum(""),e.setBgImage(game.ClientCfg.getQualityBg(t.quality)),e.setIcon(game.ClientCfg.getImgUrl(h)),n){var g=game.html.getColorByQuality(t.quality);e.setName(t.name,g,null,null,null,null,null,1)}return e.faceInfo=t,e}},n.creatItemGrid=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:-1;if(!t)return null;i||(i=game.IcoSizeEnum.SIZE_90);var o=new game.ItemGrid(i,a);return o.setAnchor(.5,.5),o.addToParent(t),o.gridInfo=new game.GridInfo(n,a),s&&o.fnOnClick(e,s),o}},{}],1610:[function(e,t,i){"use strict";game.HtmlUtil=b8e.Object.extends({name:"HtmlUtil",LIGHT_YELLOW:null,GRAY:null,GRAY_WHITE:null,Q_WHITE:null,Q_GREEN:null,Q_BLUE:null,Q_PURPLE:null,Q_YELLOW:null,Q_RED:null,REWARD_COLOR:null,DESC_COLOR:null,ON_LINE_COLOR:null,OLD_TIME_COLOR:null,_qualityMap:null,_qualityNameMap:null,ctor:function(){if(1==game.HtmlUtil._singleton)throw new Error("HtmlUtil 只能通过单例方法获取");this._super(),this.LIGHT_YELLOW=4293384103,this.GRAY=4286019447,this.GRAY_WHITE=4291155157,this.Q_WHITE=4294967295,this.Q_GREEN=4285847056,this.Q_BLUE=4285510379,this.Q_PURPLE=4291385073,this.Q_YELLOW=4294950981,this.Q_RED=4292686643,this.REWARD_COLOR=4294937670,this.DESC_COLOR=4293185947,this.ON_LINE_COLOR=4281387048,this.OLD_TIME_COLOR=4287468456,this._qualityMap=b8e.HashMap.get(),this._qualityNameMap=b8e.HashMap.get(),this._qualityMap.set(game.Quality.Q_WHITE,this.Q_WHITE),this._qualityMap.set(game.Quality.Q_GREEN,this.Q_GREEN),this._qualityMap.set(game.Quality.Q_BLUE,this.Q_BLUE),this._qualityMap.set(game.Quality.Q_PURPLE,this.Q_PURPLE),this._qualityMap.set(game.Quality.Q_YELLOW,this.Q_YELLOW),this._qualityMap.set(game.Quality.Q_RED,this.Q_RED),this._qualityNameMap.set(game.Quality.Q_WHITE,"白色"),this._qualityNameMap.set(game.Quality.Q_GREEN,"绿色"),this._qualityNameMap.set(game.Quality.Q_BLUE,"蓝色"),this._qualityNameMap.set(game.Quality.Q_PURPLE,"紫色"),this._qualityNameMap.set(game.Quality.Q_YELLOW,"橙色"),this._qualityNameMap.set(game.Quality.Q_RED,"红色")},getText:function(e,t){return"<color="+("#"+Number(e).toString(16))+">"+t+"</c>"},tranStrTo16:function(e){return Number(e.replace("#","0x"))},format:function(e,t,i){return this.getText(e,game.ccfg.LangCfg.getText(t,i))},getColorfulText:function(e){for(var t="",i=e.length,n=0;n<i;n++){var s=e[n],a=s.length,o=s[0],r=1<a?s[1]:this.Q_WHITE;r||(r=this.Q_WHITE),t+=this.getText(r,o)}return t},getQNameByQuality:function(e){var t=this._qualityNameMap.get(e);return t||""},getColorByQuality:function(e){var t=this._qualityMap.get(e);return t||this.Q_WHITE},getColorById:function(e){var t=this.Q_WHITE;switch(e){case game.ColorEnum.COLOR_100:t=this.LIGHT_YELLOW_COLOR;break;case game.ColorEnum.COLOR_101:t=this.GRAY_COLOR;break;case game.ColorEnum.COLOR_102:t=this.GRAY_WHITE;break;case game.ColorEnum.COLOR_103:t=this.Q_WHITE;break;case game.ColorEnum.COLOR_104:t=this.Q_GREEN;break;case game.ColorEnum.COLOR_105:t=this.Q_BLUE;break;case game.ColorEnum.COLOR_106:t=this.Q_PURPLE;break;case game.ColorEnum.COLOR_107:t=this.Q_YELLOW;break;case game.ColorEnum.COLOR_108:t=this.Q_RED;break;case game.ColorEnum.COLOR_109:t=this.REWARD_COLOR;break;case game.ColorEnum.COLOR_110:t=this.DESC_COLOR;break;case game.ColorEnum.COLOR_111:t=this.ON_LINE_COLOR;break;case game.ColorEnum.COLOR_112:t=this.OLD_TIME_COLOR;break;default:t=this.Q_WHITE}return t},getQualityString:function(e,t){return this.getText(this.getQualityColor(e),t)},getQualityColor:function(e){switch(e){case game.Quality.Q_WHITE:return this.Q_WHITE;case game.Quality.Q_GREEN:return this.Q_GREEN;case game.Quality.Q_BLUE:return this.Q_BLUE;case game.Quality.Q_PURPLE:return this.Q_PURPLE;case game.Quality.Q_YELLOW:return this.Q_YELLOW;case game.Quality.Q_RED:return this.Q_RED;default:return this.Q_WHITE}}}),game.HtmlUtil._instance=null,game.HtmlUtil._singleton=!0,game.HtmlUtil.inst=function(){return null==game.HtmlUtil._instance&&(game.HtmlUtil._singleton=!1,game.HtmlUtil._instance=new game.HtmlUtil,game.HtmlUtil._singleton=!0),game.HtmlUtil._instance}},{}],1611:[function(e,t,i){"use strict";var n=game.ImageURLUtil=function(){};n.POS_WEAPON_ICONAME=10010,n.POS_ARMOR_ICONAME=10014,n.POS_BELT_ICONAME=10013,n.POS_RING_ICONAME=10008,n.POS_HELM_ICONAME=10009,n.POS_NECKLACE_ICONAME=10011,n.POS_LEGGUARD_ICONAME=10007,n.POS_SHOE_ICONAME=10012,n.POS_ZUOAN_ICONAME=10023,n.POS_GUAJIAN_ICONAME=10024,n.POS_JIANGSHENG_ICONAME=10025,n.POS_JIAODENG_ICONAME=10026},{}],1612:[function(e,t,i){"use strict";var n=game.ItemInfoUtil=function(){};n.createItemInfo=function(e){if(!e)return b8e.warn("createItemInfo item：",e),null;var t=new game.EquipInfo(e.id);return e.equip&&e.equip.attr&&0<e.equip.attr.length&&t.setEquipAppendInfo(e.equip.attr),t.idx=e.idx,t.id=e.id,t.num=e.num,e.hasExpiry&&(t.expireTime=e.expireAt),game.ItemInfoUtil.createCfgItemInfo(t,e.id),t},n.createCfgItemInfo=function(e,t){var i=game.ccfg.ItemInfoCfg.getItemInfoById(t);return i&&(e.desc=i.desc,e.group=i.group,e.type=i.type,e.name=i.name,e.level=i.level,e.maxCount=i.maxCount,e.iconName=i.iconName,e.quality=i.quality,e.qualityEffect=i.qualityEffect,e.effects=i.effects,e.isUse=i.isUse,e.isCompound=0!=i.isCompound,e.triggerId=i.triggerId,e.goto=i.goto,e.notShowRed=!!i.notShowRed,e.becomingVipLevelShowRed=i.becomingVipLevelShowRed),e.useCost=game.ccfg.ItemInfoCfg.getUseCostById(t),e.baseAttrId=game.ccfg.ItemInfoCfg.getBaseAttrId(t),e.baseSpriteStat=game.ccfg.SpriteStatCfg.getSpriteStatById(e.baseAttrId),e.isEquip&&(e.appendMax=game.ccfg.EquipQualityCfg.getAppendMaxByQuality(e.quality),e.baseSpriteStat?e.basePower=game.CCommonUtil.getPower(e.baseSpriteStat,e.level):e.basePower=0,e.appendSpriteStat?e.appendPower=game.CCommonUtil.getPower(e.appendSpriteStat,e.level):e.appendPower=0,e.isHighEquip=!!game.ccfg.ItemInfoCfg.getHighEquipAttrId(t),e.isHighEquip&&(e.highEquipAttrId=game.ccfg.ItemInfoCfg.getHighEquipAttrId(t),e.highSpriteStat=game.ccfg.SpriteStatCfg.getSpriteStatById(e.highEquipAttrId))),e},n.createBianshenInfo=function(e){if(!e)return b8e.warn("createBianshenInfo bianshen：",e),null;var t=new game.BianshenInfo;return e.id&&(t.idx=e.id),e.protoId&&(t.id=e.protoId),t.exp=e.exp,e.cdFinishTs&&(t.cdTime=e.cdFinishTs),game.ItemInfoUtil.setBianShenInfo(t,e,t.id),t},n.createCSArenaBSInfo=function(e){if(!e)return b8e.warn("createCSArenaBSInfo bianshen：",e),null;var t=new game.BianshenInfo;return t.id=e.id,game.ItemInfoUtil.setBianShenInfo(t,e,t.id),t},n.createCommonBSInfo=function(e){if(!e)return b8e.warn("createCommonBSInfo bianshen：",e),null;var t=new game.BianshenInfo;return t.id=e.protoId,game.ItemInfoUtil.setBianShenInfo(t,e,t.id),t},n.setBianShenInfo=function(e,t,i){0==t.lv?e.level=1:e.level=t.lv,e.jie=t.jie?t.jie:0,e.name=game.ccfg.BianshenCfg.getNameById(i),e.iconName=game.ccfg.BianshenCfg.getIconById(i),e.quality=game.ccfg.BianshenCfg.getQualityById(i),e.star=game.ccfg.BianshenCfg.getStarById(i),e.wuxing=game.ccfg.BianshenCfg.getGenreById(i),e.restraintRate=game.ccfg.BianshenCfg.getRestraintRate(i),e.qualityEffect=game.ccfg.BianshenCfg.getQuilatyEffectById(i),e.resolveAward=game.ccfg.BianshenCfg.getResolveAwardById(i),e.goto=game.ccfg.BianshenCfg.getGoto(i),e.sortId=game.ccfg.BianshenCfg.getSortId(i)},n.createBianshenSlotInfo=function(e){var t=new game.BianshenBattleSlotInfo;return e.index&&(t.index=e.index),e.bianshenId&&(t.bianshenId=e.bianshenId),e.unlockLv&&(t.unlockLv=e.unlockLv),t.isUnlocked=!0,e.cdFinishTs&&(t.cdFinishTs=e.cdFinishTs),e.shapeRestoreTs&&(t.shapeRestoreTs=e.shapeRestoreTs),game.SysTime.curTime<e.shapeRestoreTs?t.isIn=!0:t.isIn=!1,t},n.createRuneInfo=function(e){if(!e)return b8e.warn("createRuneInfo item：",e),null;var t=new game.RuneInfo,i=game.ccfg.RuneCfg.getRuneDataById(e.id);return t.setupByCfg(i),t}},{}],1613:[function(e,t,i){"use strict";game.RFormat=function(){};game.RFormat.HTML_PATTERN="</?.*?[^>]>",game.RFormat.HTML_REG=new RegExp(game.RFormat.HTML_PATTERN,"g");var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000"],p=[""," ","  ","   ","    ","     ","      ","       ","        ","         ","          ","           ","            ","             ","              ","               ","                ","                 ","                  ","                   ","                    ","                     ","                      ","                       ","                        ","                         ","                          ","                           ","                            ","                             ","                              ","                               ","                                ","                                 ","                                  ","                                   ","                                    ","                                     ","                                      ","                                       ","                                        ","                                         ","                                          ","                                           ","                                            ","                                             ","                                              ","                                               ","                                                ","                                                 ","                                                   "];game.RFormat.sscanf=function(e,t){for(var i="",n=0;;){var s=e.search("\\{(-?\\d*)\\}");if(-1==s){i+=e;break}i+=e.substr(0,s);var a=(e=e.substr(s)).search("}"),o=e.substr(1,a-1),r=parseInt(o),h=Math.abs(r),g="0"==o.charAt(r==h?0:1),l=g?"0":" ",c=g?f:p,u=0,m=String(t[n++]),_=this.getCharCount(game.RFormat.remove_html(m)),d="";if(_<h)if(u=h-_,null==c||c.length<=u)for(;0<u--;)d+=l;else d=c[u];i+=0<r&&!g?m+d:d+m,e=e.substr(a+1)}this.getCharCount(i);return i},game.RFormat.remove_html=function(e){return e.replace(game.RFormat.HTML_REG,"")},game.RFormat.getCharCount=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),t+=this.isWideChars(i)?2:1;return t},game.RFormat.isWideChars=function(e){return!(e<128)&&(19968<=e&&e<=40959||(4352<=e&&e<=4447||11904<=e&&e<=42191&&12298!=(-18&e)&&12351!=e||44032<=e&&e<=55203||63744<=e&&e<=64255||65072<=e&&e<=65135||65280<=e&&e<=65375||65504<=e&&e<=65510||9728<=e&&e<=9841&&!(9785<=e&&e<=9788)&&!(9824<=e&&e<=9830)&&9833!=e&&9835!=e&&9836!=e&&9838!=e&&9839!=e&&9840!=e||9984<=e&&e<=10239))}},{}],1614:[function(e,t,i){"use strict";game.ReqLockUtil=b8e.Object.extends({name:"ReqLockUtil",_reqLockMap:null,ctor:function(){if(1==game.ReqLockUtil._singleton)throw new Error("ReqLockUtil 只能通过单例方法获取");this._super(),this._reqLockMap=b8e.HashMap.get()},lockReq:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=game.SysTime.curTime;this._reqLockMap.set(e,i+t)},unlockReq:function(e){this._reqLockMap.del(e)},isReqLocked:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._reqLockMap.get(e))return!1;var i=game.SysTime.curTime,n=this._reqLockMap.get(e);return t&&i<n?(game.notice.show("操作过于频繁，请稍后再试！"),!1):n<i},reqAndLock:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];t&&(this.isReqLocked(lockfun,n)||(this.lockReq(t,i),t.call(e)))}}),game.ReqLockUtil._instance=null,game.ReqLockUtil._singleton=!0,game.ReqLockUtil.inst=function(){return null==game.ReqLockUtil._instance&&(game.ReqLockUtil._singleton=!1,game.ReqLockUtil._instance=new game.ReqLockUtil,game.ReqLockUtil._singleton=!0),game.ReqLockUtil._instance}},{}],1615:[function(e,t,i){"use strict";game.ResControllerMgr=b8e.Object.extends({name:"ResControllerMgr",_atlas:null,_imgNodeMap:null,_atlasNameMap:null,ctor:function(){if(1==game.ResControllerMgr._singleton)throw new Error("ResControllerMgr 只能通过单例方法获取");this._super(),this._atlas=b8e.HashMap.get(),this._imgNodeMap=b8e.HashMap.get(),this._atlasNameMap=b8e.HashMap.get()},setQualitySpriteFrame:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s="";switch(""==i&&(i=game.ClientCfg.GRIDS_ALAST_URL),n){case game.ContainerId.BIANSHEN_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_UPGRADE_MATERIAL_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_JIE_MATERIAL_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_MATERIAL_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_SHOW_GRID_CONTAINER_ID:case game.ContainerId.BIANSHEN_CARD_CONTAINER_ID:case game.ContainerId.BIANSHEN_BATTLE_BACK_CONTAINER_ID:case game.ContainerId.BIANSHEN_BATTLE_LIST_ITEM_CONTAINER_ID:s=game.ClientCfg.BIANSHEN_ALAST+t;break;case game.ContainerId.BIANSHEN_SLOT_CONTAINER_ID:s=game.ClientCfg.BIANSHEN_SLOT_ALAST+t;break;case game.ContainerId.BEAUTY_CONTAINER_ID:s=game.ClientCfg.BEAUTY_ALAST+t;break;default:s=game.ClientCfg.GRIDS_QUALITY+t}this.setImgSpriteFrame(e,i,s)},setImgSpriteFrame:function(e,t,i){if(s=this._atlas.get(t))e instanceof b8e.Sprite?e.setFrame(s.getSpriteFrame(i)):e.getComponent(cc.Sprite).spriteFrame=s.getSpriteFrame(i);else{var n=this._imgNodeMap.get(t+"_"+i);n||(n=[],this._imgNodeMap.set(t+"_"+i,n)),n.push(e);var s,a=this._atlasNameMap.get(t+"_"+i);if(a||(a=[],this._atlasNameMap.set(t+"_"+i,a)),a.push(i),1===n.length)if(b8e.res.hasReference(t,this.onAtlasComplete,this))(s=b8e.res.getRes(t))&&this.onAtlasComplete(null,s,t,i);else b8e.res.loadRes(t,b8e.FrameAtlas,this.onAtlasComplete,this,[t,i])}},onAtlasComplete:function(e,r,h,t){e?b8e.error("图集加载错误！"+h):(this._atlas.set(h,r),this._imgNodeMap.forEach(function(e,t){if(t&&0<t.length)for(var i=this._atlasNameMap.get(e),n=0;n<t.length;n++){var s=t[n],a=i[n],o=r.getSpriteFrame(a);o&&(s instanceof b8e.Sprite?s.setFrame(o):s.getComponent(cc.Sprite).spriteFrame=o)}this._imgNodeMap&&this._imgNodeMap.del(h),this._atlasNameMap&&this._atlasNameMap.del(h)},this))}}),game.ResControllerMgr._instance=null,game.ResControllerMgr._singleton=!0,game.ResControllerMgr.inst=function(){return null==game.ResControllerMgr._instance&&(game.ResControllerMgr._singleton=!1,game.ResControllerMgr._instance=new game.ResControllerMgr,game.ResControllerMgr._singleton=!0),game.ResControllerMgr._instance}},{}],1616:[function(e,t,i){"use strict";game.RichTextUtil=b8e.Object.extends({name:"RichTextUtil",_map:null,ctor:function(){if(1==game.RichTextUtil._singleton)throw new Error("RichTextUtil 只能通过单例方法获取");this._super(),this._map=b8e.HashMap.get()},getString:function(e,t,i,n,s,a,o,r){return this._map.set(a,s),t.thisArg=e,r&&(t.onClickFunc=r),"<color="+("#"+Number(n).toString(16))+'><on click="'+o+"|"+a+'"><u>'+i+"</u></on></c>"},getData:function(e){return this._map.get(e)}}),game.RichTextUtil._instance=null,game.RichTextUtil._singleton=!0,game.RichTextUtil.inst=function(){return null==game.RichTextUtil._instance&&(game.RichTextUtil._singleton=!1,game.RichTextUtil._instance=new game.RichTextUtil,game.RichTextUtil._singleton=!0),game.RichTextUtil._instance}},{}],1617:[function(e,t,i){"use strict";game.ShieldEnum=b8e.Enum({SAN_JIE:"sjzb",ACCESSORY_SKILL:"cbjn",MOUNTEQUIP:"mountequip",SHIELD_RECHARGE:"shieldRecharge",SHIELD_IOS_RECHARGE:"shieldIOSRecharge"})},{}],1618:[function(e,t,i){"use strict";game.ShieldMgr=b8e.Object.extends({name:"ShieldMgr",_shieldArr:null,ctor:function(){if(1==game.ShieldMgr._singleton)throw new Error("ShieldMgr 只能通过单例方法获取")},isShield:function(e){if(this._shieldArr||(this._shieldArr=[]),0<this._shieldArr.length)return null!=this._shieldArr&&-1!=this._shieldArr.indexOf(e);var t=game.ccfg.GlobalParamCfg.getData(game.GlobalEnum.FUNCTION_SHIELD);return this._shieldArr=t.split(";"),null!=this._shieldArr&&-1!=this._shieldArr.indexOf(e)},isShieldRecharge:function(){if(b8e.isWeChatGame){var e=wx.getSystemInfoSync();if(e){var t=e.system;if(/iPad|iPhone|iOS|iPod/.test(t)&&this.isShield(game.ShieldEnum.SHIELD_RECHARGE))return!0}}return game.IS_SHIELD_IOS_RECHARGE}}),game.ShieldMgr._instance=null,game.ShieldMgr._singleton=!0,game.ShieldMgr.inst=function(){return null==game.ShieldMgr._instance&&(game.ShieldMgr._singleton=!1,game.ShieldMgr._instance=new game.ShieldMgr,game.ShieldMgr._singleton=!0),game.ShieldMgr._instance}},{}],1619:[function(e,t,i){"use strict";game.ShortNameMgr=b8e.Object.extends({name:"ShortNameMgr",ctor:function(){if(1==game.ShortNameMgr._singleton)throw new Error("ShortNameMgr 只能通过单例方法获取")},setup:function(){game.guide=game.GuideMgr.inst(),game.sdk=game.SDKMgr.inst(),game.shield=game.ShieldMgr.inst(),game.app=game.AppMgr.inst(),game.mainGui=game.MainUIMgr.inst(),game.bounceCharacters=game.BCMgr.inst(),game.back=game.BackMgr.inst(),game.resController=game.ResControllerMgr.inst(),game.equip=game.EquipMgr.inst(),game.quest=game.QuestMgr.inst(),game.pkMode=game.PkModeMgr.inst(),game.mainRole=game.MainRoleMgr.inst(),game.loneyDungeon=game.LoneyDungeonMgr.inst(),game.notice=game.NoticeMgr.inst(),game.bianshen=game.BianshenMgr.inst(),game.chat=game.ChatMgr.inst(),game.mail=game.MailMgr.inst(),game.beauty=game.BeautyMgr.inst(),game.draw=game.DrawMgr.inst(),game.funcOpen=game.FunctionOpenMgr.inst(),game.welfare=game.WelfareMgr.inst(),game.rank=game.RankMgr.inst(),game.offlineAward=game.OfflineAwardMgr.inst(),game.shop=game.ShopMgr.inst(),game.arena=game.ArenaMgr.inst(),game.othersRole=game.OthersRoleMgr.inst(),game.spriteStat=game.SpriteStatMgr.inst(),game.relation=game.RelationMgr.inst(),game.menu=game.MenuMgr.inst(),game.guild=game.GuildMgr.inst(),game.relationChat=game.RelationChatMgr.inst(),game.strengthen=game.StrengthenMgr.inst(),game.worldBoss=game.WorldBossMgr.inst(),game.pay=game.PayMgr.inst(),game.vip=game.VipMgr.inst(),game.active=game.ActiveMgr.inst(),game.sura=game.SuraMgr.inst(),game.setting=game.ClientSettingMgr.inst(),game.activeBar=game.ActiveBarMgr.inst(),game.sceneRole=game.SceneRoleMgr.inst(),game.dujie=game.DujieMgr.inst(),game.surface=game.SurfaceMgr.inst(),game.material=game.MaterialMgr.inst(),game.fog=game.FogMgr.inst(),game.cornucopia=game.CornucopiaMgr.inst(),game.spotAlert=game.SpotAlertMgr.inst(),game.nationalBoss=game.NationalBossMgr.inst(),game.transferNotice=game.TransferNoticeMgr.inst(),game.xiandan=game.XiandanMgr.inst(),game.fund=game.FundMgr.inst(),game.nickName=game.NickNameMgr.inst(),game.rebirth=game.RebirthMgr.inst(),game.redPacket=game.RedPacketMgr.inst(),game.zhanyao=game.ZhanyaoMgr.inst(),game.roulette=game.RouletteMgr.inst(),game.autoEquip=game.AutoEquipMgr.inst(),game.tianGong=game.TianGongMgr.inst(),game.leaveDungeon=game.LeaveDungeonMgr.inst(),game.collect=game.CollectMgr.inst(),game.amulet=game.AmuletMgr.inst(),game.wanfa=game.WanfaMgr.inst(),game.upgrade=game.UpgradeUtil.inst(),game.html=game.HtmlUtil.inst(),game.reqLock=game.ReqLockUtil.inst(),game.team=game.TeamMgr.inst(),game.richText=game.RichTextUtil.inst(),game.csArena=game.CSArenaMgr.inst(),game.skill=game.SkillMgr.inst(),game.tower=game.TowerMgr.inst(),game.rune=game.RuneMgr.inst(),game.retrieve=game.RetrieveMgr.inst(),game.gameAlert=game.GameAlertMgr.inst(),game.escort=game.EscortMgr.inst(),game.questAward=game.MainQuestAwardMgr.inst(),game.worldcup=game.WorldCupMgr.inst(),game.mountequip=game.MountEquipMgr.inst(),game.timeUtil=game.TimeUtil.inst(),game.ornament=game.OrnamentMgr.inst()}}),game.ShortNameMgr._instance=null,game.ShortNameMgr._singleton=!0,game.ShortNameMgr.inst=function(){return null==game.ShortNameMgr._instance&&(game.ShortNameMgr._singleton=!1,game.ShortNameMgr._instance=new game.ShortNameMgr,game.ShortNameMgr._singleton=!0),game.ShortNameMgr._instance}},{}],1620:[function(e,t,i){"use strict";game.TimeData=b8e.Object.extends({_arrYear:null,_arrMonth:null,_arrDate:null,_arrDay:null,_dicMaxDate:null,ctor:function(e){this._super(),this.setup(e)},setup:function(e){if(this._dicMaxDate=[],this._arrYear=[],this._arrMonth=[],this._arrDate=[],this._arrDay=[],e){var t,i,n=(e="]"+e.replace(/ /g,"")+"[").split("]["),s=n[1],a=n[2],o=n[3];o&&-1==o.indexOf("w")?t=o:i=o;var r=n[4];this.parseYear(s),this.parseMonth(a),this.parseDate(t),this.parseDay(i),this.parseTime(r)}},parseYear:function(e){if(-1==e.indexOf("*")){this._arrYear=[];for(var t=e.split(","),i=0;i<t.length;i++)this._arrYear.push(Number(t[i]))}},parseMonth:function(e){if(-1==e.indexOf("*")){this._arrMonth=[];for(var t=e.split(","),i=0;i<t.length;i++)this._arrMonth.push(Number(t[i])-1);this._arrMonth.sort(this.onSortByNumeric)}},parseDay:function(e){if(e&&-1==e.indexOf("*")){this._arrDay=[];for(var t=(e=e.replace(/w/g,"")).split(","),i=0;i<t.length;i++){var n=Number(t[i]);this._arrDay.push(7==n?0:n)}this._arrDay.sort(this.onSortByNumeric)}},parseDate:function(e){if(e&&-1==e.indexOf("*")){this._arrDate=[];for(var t=e.split(","),i=0;i<t.length;i++)this._arrDate.push(Number(t[i]));this._arrDate.sort(this.onSortByNumeric)}},parseTime:function(e){if(-1==e.indexOf("*")){this._arrTime=[];for(var t=e.split(","),i=0;i<t.length;i++){var n=t[i].split(":"),s=(Number(n[0])<<16)+Number(n[1]);this._arrTime.push(s)}this._arrTime.sort(this.onSortByNumeric)}},onSortByNumeric:function(e,t){return t<e?1:e<t?-1:0},getCurDate:function(e){return e||(e=new Date).setTime(game.SysTime.curTime),e},checkMonth:function(e,t){if(!this._arrMonth||this._arrMonth.length<=0)return!0;if(t){for(i=this._arrMonth.length-1;0<=i;i--)if(e.getMonth()==this._arrMonth[i])return!0}else for(var i=0;i<this._arrMonth.length;i++)if(e.getMonth()==this._arrMonth[i])return!0;return!1},getTimeWithDate:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=(e.getHours()<<16)+e.getMinutes();if(!this._arrTime||this._arrTime.length<=0)return e;for(var n=0;n<this._arrTime.length;n++)if(this._arrTime[n]>=i&&!t||this._arrTime[n]<=i&&t)return e.setHours(this._arrTime[n]>>16),e.setMinutes(255&this._arrTime[n]),e.setSeconds(0),e.setMilliseconds(0),e;return null},getMaxDate:function(e){var t=this._dicMaxDate[(e.getFullYear()<<4)+e.getMonth()];if(t&&0!=t)return t;var i=new Date(e.getFullYear(),e.getMonth()+1,1,0,0,0,0),n=e.getTime();return n-=10,i.setTime(n),this._dicMaxDate[(e.getFullYear()<<4)+e.getMonth()]=i.getDate(),i.getDate()},checkDay:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._arrDay||this._arrDay.length<=0)return!0;if(t){for(i=this._arrDay.length-1;0<=i;i--)if(e.getDay()==this._arrDay[i])return!0}else for(var i=0;i<this._arrDay.length;i++)if(e.getDay()==this._arrDay[i])return!0;return!1},getTimeWithBeforeMonth:function(e){if(!this.checkMonth(e,!0))return null;var t=0,i=null;if(this._arrDate&&0<this._arrDate.length)for(t=this._arrDate.length-1;0<=t;t--)if(this._arrDate[t]>e.getDate())this.cleanHour(e,!0);else{if(this._arrDate[t]<e.getDate()&&(this.cleanHour(e,!0),e.setDate(this._arrDate[t])),i=this.getTimeWithDate(e,!0))return i;this.cleanHour(e,!0)}else if(this._arrDay&&0<this._arrDay.length)for(t=e.getDate();0<t;t--)if(e.setDate(t),this.checkDay(e,!0)){if(i=this.getTimeWithDate(e,!0))return i;this.cleanHour(e,!0)}else this.cleanHour(e,!0);else for(t=e.getDate();0<t;t--){if(e.setDate(t),i=this.getTimeWithDate(e,!0))return i;this.cleanHour(e,!0)}return null},getTimeWithMonth:function(e){if(!this.checkMonth(e,!1))return null;var t=0,i=null;if(this._arrDate&&0<this._arrDate.length)for(t=0;t<this._arrDate.length;t++)if(this._arrDate[t]<e.getDate())this.cleanHour(e);else{if(e.getDate()!=this._arrDate[t]&&(this.cleanHour(e),e.setDate(this._arrDate[t])),i=this.getTimeWithDate(e))return i;this.cleanHour(e)}else if(this._arrDay&&0<this._arrDay.length)for(t=e.getDate();t<=this.getMaxDate(e);t++)if(e.setDate(t),this.checkDay(e)){if(i=this.getTimeWithDate(e))return i;this.cleanHour(e)}else this.cleanHour(e);else for(t=e.getDate();t<=this.getMaxDate(e);t++){if(e.setDate(t),i=this.getTimeWithDate(e))return i;this.cleanHour(e)}return null},checkYear:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this._arrYear||this._arrYear.length<=0)return!0;if(t){for(i=this._arrYear.length-1;0<=i;i--)if(this._arrYear[i]==e.getFullYear())return!0}else for(var i=0;i<this._arrYear.length;i++)if(this._arrYear[i]==e.getFullYear())return!0;return!1},getTimeWithBeforeYear:function(e){if(!this.checkYear(e,!0))return null;var t=0,i=null;if(!this._arrMonth||this._arrMonth.length<=0)for(t=e.getMonth();0<=t;t--){if(e.setMonth(t),i=this.getTimeWithBeforeMonth(e))return i;e.setDate(this.getLastDate(e)),this.cleanHour(e,!0)}else for(t=this._arrMonth.length-1;0<=t;t--)if(this._arrMonth[t]>e.getMonth())e.setDate(this.getLastDate(e)),this.cleanHour(e,!0);else{if(e.setMonth(this._arrMonth[t]),i=this.getTimeWithBeforeMonth(e))return i;e.setDate(this.getLastDate(e)),this.cleanHour(e,!0)}return null},getTimeWithYear:function(e){if(!this.checkYear(e))return null;var t=0,i=null;if(!this._arrMonth||this._arrMonth.length<=0)for(t=e.getMonth();t<12;t++){if(e.setMonth(t),i=this.getTimeWithMonth(e))return i;e.setDate(this.getFirstDate()),this.cleanHour(e)}else for(t=0;t<this._arrMonth.length;t++)if(this._arrMonth[t]<e.getMonth())e.setDate(this.getFirstDate()),this.cleanHour(e);else{if(e.setMonth(this._arrMonth[t]),i=this.getTimeWithMonth(e))return i;e.setDate(this.getFirstDate()),this.cleanHour(e)}return null},getBeforeYear:function(e){var t=e.getFullYear();if(!this._arrYear||this._arrYear.length<=0)return t-1;for(var i=this._arrYear.length-1;0<=i;i++)if(this._arrYear[i]<=t)return this._arrYear[i];return 0},getNextYear:function(e){var t=e.getFullYear();if(!this._arrYear||this._arrYear.length<=0)return t+1;for(var i=0;i<this._arrYear.length;i++)if(this._arrYear[i]>=t)return this._arrYear[i];return 0},getFirstMonth:function(){return!this._arrMonth||this._arrMonth.length<=0?0:this._arrMonth[0]},getLastMonth:function(){return!this._arrMonth||this._arrMonth.length<=0?11:this._arrMonth[this._arrMonth.length-1]},getFirstDate:function(){return!this._arrDate||this._arrDate.length<=0?1:this._arrDate[0]},getLastDate:function(e){return!this._arrDate||this._arrDate.length<=0?this.getMaxDate(e):this._arrDate[this._arrDate.length-1]},cleanHour:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1]?(e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(999)):(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0))},getBeforeTime:function(e){e||(e=new Date).setTime(game.SysTime.curTime);var t=e.getTime();t-=6e4,e.setTime(t);for(var i=null,n=0;n<10&&!(i=this.getTimeWithBeforeYear(e));n++)e.setFullYear(this.getBeforeYear(e)),e.setMonth(this.getLastMonth()),e.setDate(this.getLastDate(e)),this.cleanHour(e,!0);return i},getNextTime:function(e){e||(e=new Date).setTime(game.SysTime.curTime);var t=e.getTime();t+=6e4,e.setTime(t);for(var i=null,n=0;n<10&&!(i=this.getTimeWithYear(e));n++)e.setFullYear(this.getNextYear(e)),e.setMonth(this.getFirstMonth()),e.setDate(this.getFirstDate()),this.cleanHour(e);return i},getCheackNextTime:function(e){var t=new Date;t.setTime(game.SysTime.curTime-e);var i=t.getTime();i+=6e4,t.setTime(i);for(var n=null,s=0;s<10&&!(n=this.getTimeWithYear(t));s++)t.setFullYear(this.getNextYear(t)),t.setMonth(this.getFirstMonth()),t.setDate(this.getFirstDate()),this.cleanHour(t);return n.getTime()},arrDate:{get:function(){return this._arrDate}},arrDay:{get:function(){return this._arrDay}},arrTime:{get:function(){return this._arrTime}}})},{}],1621:[function(e,t,i){"use strict";game.TimeUtil=b8e.Object.extends({_data:null,_dayStr:"天",_hourStr:"小时",_minuteStr:"分",_secondStr:"秒",str:"",formatTimeSpace:function(e){var t;this.str="";var i=e;return this.isEnough=!1,e>b8e.TimeUtil.DAY_MICRO_SECONDS&&(t=i/b8e.TimeUtil.DAY_MICRO_SECONDS>>0,i%=b8e.TimeUtil.DAY_MICRO_SECONDS,this.str+=t+this._dayStr,this.isEnough=!0),e>b8e.TimeUtil.HOUR_MICRO_SECONDS&&(t=i/b8e.TimeUtil.HOUR_MICRO_SECONDS>>0,i%=b8e.TimeUtil.HOUR_MICRO_SECONDS,this.str+=t+this._hourStr),e>b8e.TimeUtil.MINUTE_MICRO_SECONDS&&(t=i/b8e.TimeUtil.MINUTE_MICRO_SECONDS>>0,i%=b8e.TimeUtil.MINUTE_MICRO_SECONDS,this.str+=t+this._minuteStr),this.isEnough||(t=i/b8e.TimeUtil.SECOND_MICRO_SECONDS>>0,this.str+=t+this._secondStr),this.str}}),game.TimeUtil._instance=null,game.TimeUtil._singleton=!0,game.TimeUtil.inst=function(){return null==game.TimeUtil._instance&&(game.TimeUtil._singleton=!1,game.TimeUtil._instance=new game.TimeUtil,game.TimeUtil._singleton=!0),game.TimeUtil._instance}},{}],1622:[function(e,t,i){"use strict";game.UpgradeUtil=b8e.Object.extends({name:"UpgradeUtil",_costMap:null,_moneyName:null,ctor:function(){if(1==game.UpgradeUtil._singleton)throw new Error("UpgradeUtil 只能通过单例方法获取");this._super(),this._costMap=b8e.HashMap.get(),this._moneyName=b8e.HashMap.get(),this._moneyName.set(game.AmountType.SILVER,"银币"),this._moneyName.set(game.AmountType.YUAN_BAO,"元宝"),this._moneyName.set(game.AmountType.POPULARITY,"声望"),this._moneyName.set(game.AmountType.HONOUR,"荣誉令")},costCheck:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(!t)return i&&i.call(e,!1),!1;if(!s){for(var o=t.amountInfo.getAllDatas(),r=0;r<o.length;r++){var h=o[r];if(h){var g=h.type,l=t.amountInfo.getValue(g);if(0<a&&(l*=a),!this.costCheckMoney(g,l,n,!0))return i&&i.call(e,!1),!1}}return this.isHasEnoughItem(t,n)?(i&&i.call(e,!0),!0):(i&&i.call(e,!1),!1)}var c=t.getFirstUpgradeInfo();if(c){this.checkConditions(e,c.id,c.num,game.AmountType.YUAN_BAO,i,n,s)}},isHasEnoughItem:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=e.getCostItemList(),n=0;n<i.length;n++){var s=i[n];if(!s)return!1;if(!game.back.isHasItemInfoById(s.id))return t&&this.checkItemInfo(s.id,s.num),!1;var a=game.back.getItemInfoById(s.id);if(!a)return t&&this.checkItemInfo(s.id,s.num),!1;if(a.num<s.num)return t&&this.checkItemInfo(s.id,s.num),!1}return!0},checkItemInfo:function(e,t){var i=game.ccfg.ItemInfoCfg.getNameById(e);this.isOpenGoToPanel(e,t),i=game.html.getText(game.html.Q_RED,i),game.notice.show("$不足",[i])},checkConditions:function(e,t,i,n,s){var a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],o=6<arguments.length&&void 0!==arguments[6]&&arguments[6],r=0,h=game.ccfg.ItemInfoCfg.getNameById(t),g=game.back.getItemInfoById(t),l=(game.ccfg.ItemInfoCfg.getItemInfoById(t),0);if(g&&(l=g.num),g&&i<=l)s&&s.call(e,!0);else if(o){var c=i-l;if(r=game.shop.getItemInfoPrice(t)*c,!this.costCheckMoney(n,r,a,!0))return void(s&&s.call(e,!1));var u=game.shop.getBuyShopInfoEx(t,0);if(!u)return void(s&&(a&&this.isOpenGoToPanel(t,i),h=game.html.getText(game.html.Q_RED,h),game.notice.show("商城没有$出售",[h]),s.call(e,!1)));game.shop.buyItemInfo(u.id,c),s&&s.call(e,!0)}else if(l<i)return void(s&&(a&&this.isOpenGoToPanel(t,i),s.call(e,!1)))},costCheckMoney:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return t<=game.back.getAmountInfo().getValue(e)||(n?e==game.AmountType.YUAN_BAO?game.gameAlert.showVipAlert(!0,101):this.isOpenGoToPanel(this.getAmountItemId(e),t):i&&this.noticeByType(e),!1)},noticeByType:function(e){var t=this.getMoneyNameByType(e);t=game.html.getText(game.html.Q_RED,t),game.notice.show("$不足",[t])},getCostStrByUpgradeInfo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i="",n="";if(!e)return i;var s,a,o=0,r=e.amountInfo.getAllDatas(),h=r.length,g=[],l=game.back.getAmountInfo().getValue(game.AmountType.SILVER);for(o=0;o<h;o++)if(s=r[o])switch(s.type){case game.AmountType.SILVER:0<(a=e.amountInfo.getValue(game.AmountType.SILVER))&&(n=game.ccfg.LangCfg.getText("$",[game.html.getText(a<=l?game.html.Q_GREEN:game.html.Q_RED,a)])),g.push(n)}var c,u=e.getCostItemList();if(u&&0<u.length)for(o=0;o<u.length;o++){c=u[o],n=game.back.getItemInfoById(c.id)>=c.num?game.ccfg.LangCfg.getText("$$",[game.html.getText(game.html.Q_GREEN,game.ccfg.ItemInfoCfg.getQualityNameById(c.id)),game.html.getText(game.html.Q_GREEN,c.num+"个")]):game.ccfg.LangCfg.getText("$$",[game.html.getText(game.html.Q_RED,game.ccfg.ItemInfoCfg.getQualityNameById(c.id)),game.html.getText(game.html.Q_RED,c.num+"个")]),g.push(n)}if(g&&0<g.length)if(1<g.length)for(var m=0;m<g.length;m++)""==t&&(t=game.EmStringType.COMMA),m==g.length-1?i+=g[m]:i+=g[m]+t;else i=g[0];return game.ccfg.LangCfg.getText("$",[i])},getMoneyNameByType:function(e){var t=this._moneyName.get(e);return t||""},getCostMap:function(e){this._costMap&&0<this._costMap.count()&&this._costMap.clear();var t=0,i=e.amountInfo.getAllDatas(),n=i.length;for(t=0;t<n;t++){var s=i[t];if(s){var a,o=0;switch(a=s.type){case game.AmountType.SILVER:0<(o=e.amountInfo.getValue(game.AmountType.SILVER))&&this._costMap.set(a,o)}}}return this._costMap},isCurrencyById:function(e){var t=!1,i=game.ccfg.ItemInfoCfg.getItemInfoById(e);if(i)switch(i.type){case game.AmountType.SILVER:case game.AmountType.YUAN_BAO:case game.AmountType.POPULARITY:case game.AmountType.HONOUR:t=!0}return t},getAmountItemId:function(e){var t;switch(e){case game.AmountType.SILVER:t=game.AmountItemId.SILVER;break;case game.AmountType.YUAN_BAO:t=game.AmountItemId.YUAN_BAO;break;case game.AmountType.POPULARITY:t=game.AmountItemId.POPULARITY;break;case game.AmountType.HONOUR:t=game.AmountItemId.HONOUR}return t},isOpenGoToPanel:function(e,t){var i=game.ccfg.ItemInfoCfg.getItemInfoById(e);i&&""!=i.goto&&game.app.show(game.AppConstant.GOTO_PANEL,{info:i,num:t})}}),game.UpgradeUtil._instance=null,game.UpgradeUtil._singleton=!0,game.UpgradeUtil.inst=function(){return null==game.UpgradeUtil._instance&&(game.UpgradeUtil._singleton=!1,game.UpgradeUtil._instance=new game.UpgradeUtil,game.UpgradeUtil._singleton=!0),game.UpgradeUtil._instance}},{}],1623:[function(e,t,i){"use strict";game.ValueUtil={getDigitsValueByNum:function(e,t){return Number(e.toFixed(t))},formatNumber:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],o=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:null,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:2147483647;return 1e8<=e?a?game.ValueUtil.format(e,["亿"],["100000000"],t,o,r,h):game.ValueUtil.format(e,["万"],["10000"],t,o,r,h):1e7<=e?s?game.ValueUtil.format(e,["千万"],["10000000"],t,o,r,h):game.ValueUtil.format(e,["万"],["10000"],t,o,r,h):1e6<=e?n?game.ValueUtil.format(e,["百万"],["1000000"],t,o,r,h):game.ValueUtil.format(e,["万"],["10000"],t,o,r,h):1e4<=e?i?game.ValueUtil.format(e,["万"],["10000"],0,o,r,h):1e5<=e?game.ValueUtil.format(e,["万"],["10000"],t,o,r,h):e+"":e+""},format:function(e,t,i){var n,s,a,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,g=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2147483647;if(0<o)return n=e*Math.pow(10,o),(s=this.getUnit(n,i))>=i.length?e.toString():(-1!=(a=((n=r?Math.floor(n/i[s]):Math.ceil(n/i[s]))/Math.pow(10,o)).toFixed(o)).indexOf(".0")&&(a=a.substr(0,a.length-2)),a+t[s]);if((s=this.getUnit(e,i))>=i.length)return e.toString();var l=i.length,c=0,u="";n=e;for(var m=s;m<l&&c<g;m++,c++){var _;_=c!=g-1&&m!=l-1||r?Math.ceil(n/i[m]>>0):Math.ceil(n/i[m]),u+=null==h?_.toString():this.fixLen(_,h[m]),u+=t[m],n%=i[m]}return u},getUnit:function(e,t){for(var i=0;i<t.length;i++)if(t[i]<=e)return i;return t.length-1},fixLen:function(e,t){for(var i=e.toString(),n="",s=i.length;s<t;s++)n+="0";return n+i}}},{}],1624:[function(e,t,i){"use strict";game.AttBounceCharactersPanel=b8e.BaseDisplay.extends({_showAttrList:null,_count:0,_height:35,_atlasMap:null,_cacheAttrList:null,ctor:function(){this._super(),this._atlasMap=b8e.HashMap.get(),this._showAttrList=[],this._cacheAttrList=[]},showAttrBounceCharacters:function(e,t){e>>=0;var i,n,s,a,o,r="";switch("sprite_stat/",i=game.BCType.ATLAS_SPRITE_STAT,t){case game.BCType.STAT_MAXHP:r=game.BCType.STAT_MAXHP_CHARACTERS;break;case game.BCType.STAT_ATK:r=game.BCType.STAT_ATK_CHARACTERS;break;case game.BCType.STAT_DEF:r=game.BCType.STAT_DEF_CHARACTERS;break;case game.BCType.STAT_HIT:r=game.BCType.STAT_HIT_CHARACTERS;break;case game.BCType.STAT_DODGE:r=game.BCType.STAT_DODGE_CHARACTERS;break;case game.BCType.STAT_CRIT:r=game.BCType.STAT_CRIT_CHARACTERS;break;case game.BCType.STAT_CRIT_REDUCTION:r=game.BCType.STAT_CRIT_REDUCTION_CHARACTERS;break;default:return}this.getAtlas("sprite_stat/",i,(n=this,s=e,a=i,o=r,b8e.DelegateUtil.create(n,n.statTweenUp,[s,a,o])))},getAtlas:function(e,s,t){var a=this;if(this._atlasMap.get(s))t&&t();else{this._cacheAttrList.push(t);var i="app/images/number/"+e+s;b8e.res.loadRes(i,cc.SpriteAtlas,function(e,t){if(e)cc.error(e,"---------",t,"图集找不到！！是不是路径不对了！！！");else{a._atlasMap.set(s,t);for(var i=0;i<a._cacheAttrList.length;i++){var n=a._cacheAttrList[i];n&&n()}a._cacheAttrList.length=0}},this)}},statTweenUp:function(e,t,i){if(this&&this._atlasMap){var n=this._atlasMap.get(t);if(n){this._count++;var s=game.BCUnit.get();s.createBounceCharactersUnit(n,e,i,!0,!0),s.setLocalZOrder(890),this.addChild(s),this._showAttrList.splice(0,0,s),b8e.Tween.get(s).wait(1e3).call(this.tweenEnd,this,[s]),s.y=-(this.y-200),b8e.Tween.get(s).to({y:-38*this._count},200)}if(7<this._showAttrList.length){var a=this._showAttrList[7];this._showAttrList.splice(7,1),b8e.Tween.kill(a),b8e.Tween.get(a).to({x:-100,alpha:0},500).call(function(e){null!=e&&(e.removeFromParent(),e.setScale(1,1),e.alpha=1,game.BCUnit.put(e))},this,[a])}var o=200+38*this._count;b8e.Tween.kill(this),b8e.Tween.get(this).to({y:o},200)}},tweenEnd:function(e){b8e.Tween.get(e).to({x:-100,alpha:0},300).call(this.statSpriteNodeTweenUpComplete,this,[e])},statSpriteNodeTweenUpComplete:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._showAttrList.pop(),this._showAttrList.length<=0&&(this._count=0,this.y=200),e.removeFromParent(),e.setScale(1,1),e.alpha=1,game.BCUnit.put(e)}})},{}],1625:[function(e,t,i){"use strict";var A="characters/";game.BCMgr=b8e.Object.extends({name:"BCMgr",_atlasMap:null,_sceneLayer:null,_guiLayer:null,_showHurtList:null,_lastShowTime:0,_maxCount:0,_hideScene:!1,_attBCPanel:null,ctor:function(){if(1==game.BCMgr._singleton)throw new Error("BCMgr 只能通过单例方法获取");this._super(),this._atlasMap=b8e.HashMap.get(),this._showHurtList=[],this._sceneLayer=b8e.layer.getSceneLayer(),this._guiLayer=b8e.layer.getGuiLayer()},showHurt:function(e,t,i,n){var s=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];if(!this._hideScene){var o=b8e.timeStamp;if(o-this._lastShowTime<500){if(5<this._maxCount)return;this._maxCount++,b8e.Tween.get(this).wait(150).call(this.delayBC,this,[e,t,i,n,s,a])}else this._lastShowTime=o,this.showBC(e,t,i,n,s,a)}},delayBC:function(e,t,i,n,s,a){this._maxCount--,this.showBC(e,t,i,n,s,a),this._lastShowTime=b8e.timeStamp},showBC:function(e,t,i,n,s,a){null==e&&be8.warn("伤害飘字传过来的value怎么是一个undefined！！！",t);var o,r,h,g,l,c,u,m,_,d,f,p=b8e.scene.sceneGLToViewGLPos(i,n),S=(i=p.x,n=p.y+50,e>>=0,""),T=!0,I=1,v=1.5;switch(t){case game.BCType.NORMAL:s?(o="self_hurt/",r=game.BCType.SELF_HURT):(o="target_hurt/",r=game.BCType.TARGET_HURT),I=1,v=1.5,T=!(S="");break;case game.BCType.CRIT:o="crit/",r=game.BCType.NUMBER_ATLAS_CRIT,S=game.BCType.CRIT_CHARACTERS;break;case game.BCType.MISS:o=A,r=game.BCType.CHARACTERS,S=game.BCType.MISS_CHARACTERS;break;case game.BCType.EXP:o="",r=game.BCType.CHARACTERS,S=game.BCType.EXP_CHARACTERS;break;case game.BCType.HP:o="hui_xue/",r=game.BCType.CHARACTERS,S=game.BCType.HP_CHARACTERS;break;case game.BCType.MP:o=A,r=game.BCType.CHARACTERS,S=game.BCType.MP_CHARACTERS;break;case game.BCType.ADD_HP:o="hui_xue/",r=game.BCType.CHARACTERS,S=game.BCType.HP_CHARACTERS;break;case game.BCType.ADD_MP:r=game.BCType.CHARACTERS,S=game.BCType.MP_CHARACTERS}this.getAtlas(o,r,(h=this,g=e,l=r,c=S,u=i,m=n,_=I,d=v,f=T,b8e.DelegateUtil.create(h,h.tweenUp,[g,l,c,u,m,_,d,f])))},getAtlas:function(e,i,n){var s=this;if(this._atlasMap.get(i))n&&n();else{var t="app/images/number/"+e+i;b8e.res.loadRes(t,cc.SpriteAtlas,function(e,t){e?cc.error(e,"---------",t,"图集找不到！！是不是路径不对了！！！"):(s._atlasMap.set(i,t),n&&n())},this)}},tweenUp:function(e,t,i,n,s,a,o,r){if(this&&this._atlasMap){var h=this._atlasMap.get(t);if(h){var g=game.BCUnit.get();g.createBounceCharactersUnit(h,e,i,r),g.setPosition(n-g.width/2,s),g.setLocalZOrder(9999),this._sceneLayer.addChild(g);var l=-(g.width*o>>1)+n,c=s;b8e.Tween.kill(g),b8e.Tween.get(g).to({x:l,y:c,scaleX:o,scaleY:o},150,b8e.Ease.quadIn).call(this.tweenSpriteNodeEnd,this,[g,n,s,a,o])}}},tweenSpriteNodeEnd:function(e,t,i,n,s){e.setScale(s,s);var a=t-e.width,o=i;b8e.Tween.kill(e),b8e.Tween.get(e).to({x:a,y:o,scaleX:n,scaleY:n},150,b8e.Ease.quadIn).call(this.spriteNodeScaleComplete,this,[e,t,i])},spriteNodeScaleComplete:function(e,t,i){var n=i+80;e.alpha=1,b8e.Tween.kill(e),b8e.Tween.get(e).to({y:n,alpha:0},600).call(this.spriteNodeTweenUpComplete,this,[e])},spriteNodeTweenUpComplete:function(e){e.setScale(1,1),game.BCUnit.put(e),e.removeFromParent()},hideScene:function(){this._hideScene=!0},showScene:function(){this._hideScene=!1},showAttrBounceCharacters:function(e,t){this._attBCPanel||(this._attBCPanel=new game.AttBounceCharactersPanel,this._guiLayer.addChild(this._attBCPanel),this._attBCPanel.y=300,this._attBCPanel.x=50,this._attBCPanel.setLocalZOrder(890)),this._attBCPanel.showAttrBounceCharacters(e,t)},hitFace:function(e,t,i,n,s){this.showHurt(i,n,t.x,t.y,s)}}),game.BCMgr._instance=null,game.BCMgr._singleton=!0,game.BCMgr.inst=function(){return game.BCMgr._instance||(game.BCMgr._singleton=!1,game.BCMgr._instance=new game.BCMgr,game.BCMgr._singleton=!0),game.BCMgr._instance}},{}],1626:[function(e,t,i){"use strict";game.BCType=b8e.Enum({NORMAL:0,CRIT:1,MISS:2,STAT_HP:3,STAT_MAXHP:4,STAT_MAXHP_BONUS_COEF:5,STAT_ATK:6,STAT_ATK_BONUS_COEF:7,STAT_DEF:8,STAT_DEF_BONUS_COEF:9,STAT_DMG_BONUS_COEF:10,STAT_DMG_REDUCTION_COEF:11,STAT_DMG_BONUS:12,STAT_DMG_REDUCTION:13,STAT_HIT:14,STAT_HIT_RATE:15,STAT_DODGE:16,STAT_DODGE_RATE:17,STAT_CRIT:18,STAT_CRIT_RATE:19,STAT_CRIT_COEF:20,STAT_CRIT_REDUCTION:21,STAT_CRIT_REDUCTION_RATE:22,STAT_CRIT_REDUCTION_COEF:23,STAT_CD_REDUCTION_COEF:24,STAT_MOVE_SPEED:25,STAT_HP_RECOVERY:26,STAT_DMG_BONUS_COEF_JIN:27,STAT_DMG_BONUS_COEF_MU:28,STAT_DMG_BONUS_COEF_SHUI:29,STAT_DMG_BONUS_COEF_HUO:30,STAT_DMG_BONUS_COEF_TU:31,STAT_DMG_REDUCTION_COEF_JIN:32,STAT_DMG_REDUCTION_COEF_MU:33,STAT_DMG_REDUCTION_COEF_SHUI:34,STAT_DMG_REDUCTION_COEF_HUO:35,STAT_DMG_REDUCTION_COEF_TU:36,STAT_DMG_BONUS_COEF_TO_JIN:37,STAT_DMG_BONUS_COEF_TO_MU:38,STAT_DMG_BONUS_COEF_TO_SHUI:39,STAT_DMG_BONUS_COEF_TO_HUO:40,STAT_DMG_BONUS_COEF_TO_TU:41,EXP:1e4,HP:10001,MP:10002,ADD_HP:10003,ADD_MP:10004,CHARACTERS:"characters",SELF_HURT:"self_hurt",TARGET_HURT:"target_hurt",HUI_XUE:"hui_xue",NUMBER_ATLAS_CRIT:"crit",ATLAS_SPRITE_STAT:"sprite_stat",MISS_CHARACTERS:"miss",CRIT_CHARACTERS:"crit",THUMP_CHARACTERS:"thump",JUMP_SHIELD_CHARACTERS:"jum_shield",INVINCIBLE_CHARACTERS:"invincible",PHYSICAL_IMMUNE_CHARACTERS:"physical_immune",MAGICAL_IMMUNE_CHARACTERS:"magcal_immune",REBOUND_CHARACTERS:"rebound",ABSORB_CHARACTERS:"absorb",STAT_HP_CHARACTERS:"hp",STAT_MAXHP_CHARACTERS:"max_hp",STAT_MAXHP_BONUS_COEF_CHARACTERS:"maxhp_bonus_coef",STAT_ATK_CHARACTERS:"atk",STAT_ATK_BONUS_COEF_CHARACTERS:"atk_bonus_coef",STAT_DEF_CHARACTERS:"def",STAT_DEF_BONUS_COEF_CHARACTERS:"def_bonus_coef",STAT_DMG_BONUS_COEF_CHARACTERS:"dmg_bonus_coef",STAT_DMG_REDUCTION_COEF_CHARACTERS:"dmg_reduction_coef",STAT_DMG_BONUS_CHARACTERS:"dmg_bonus",STAT_DMG_REDUCTION_CHARACTERS:"dmg_reduction",STAT_HIT_CHARACTERS:"hit",STAT_HIT_RATE_CHARACTERS:"hit_rate",STAT_DODGE_CHARACTERS:"dodge",STAT_DODGE_RATE_CHARACTERS:"dodge_rate",STAT_CRIT_CHARACTERS:"crit",STAT_CRIT_RATE_CHARACTERS:"crit_rate",STAT_CRIT_COEF_CHARACTERS:"crit_coef",STAT_CRIT_REDUCTION_CHARACTERS:"crit_reduction",STAT_CRIT_REDUCTION_RATE_CHARACTERS:"crit_reduction_rate",STAT_CRIT_REDUCTION_COEF_CHARACTERS:"crit_reduction_coef",STAT_CD_REDUCTION_COEF_CHARACTERS:"cd_reduction_coef",STAT_MOVE_SPEED_CHARACTERS:"move_speed",STAT_HP_RECOVERY_CHARACTERS:"hp_recovery",STAT_DMG_BONUS_COEF_JIN_CHARACTERS:"dmg_bonus_coef_jin",STAT_DMG_BONUS_COEF_MU_CHARACTERS:"dmg_bonus_coef_mu",STAT_DMG_BONUS_COEF_SHUI_CHARACTERS:"dmg_bonus_coef_shui",STAT_DMG_BONUS_COEF_HUO_CHARACTERS:"dmg_bonus_coef_huo",STAT_DMG_BONUS_COEF_TU_CHARACTERS:"dmg_bonus_coef_tu",STAT_DMG_REDUCTION_COEF_JIN_CHARACTERS:"dmg_reduction_coef_jin",STAT_DMG_REDUCTION_COEF_MU_CHARACTERS:"dmg_reduction_coef_mu",STAT_DMG_REDUCTION_COEF_SHUI_CHARACTERS:"dmg_reduction_coef_shui",STAT_DMG_REDUCTION_COEF_HUO_CHARACTERS:"dmg_reduction_coef_huo",STAT_DMG_REDUCTION_COEF_TU_CHARACTERS:"dmg_reduction_coef_tu",STAT_DMG_BONUS_COEF_TO_JIN_CHARACTERS:"dmg_bonus_coef_to_jin",STAT_DMG_BONUS_COEF_TO_MU_CHARACTERS:"dmg_bonus_coef_to_mu",STAT_DMG_BONUS_COEF_TO_SHUI_CHARACTERS:"dmg_bonus_coef_to_shui",STAT_DMG_BONUS_COEF_TO_HUO_CHARACTERS:"dmg_bonus_coef_to_huo",STAT_DMG_BONUS_COEF_TO_TU_CHARACTERS:"dmg_bonus_coef_to_tu"})},{}],1627:[function(e,t,i){"use strict";game.BCUnit=b8e.Sprite.extends({_digitizeArr:null,_spriteArr:null,_spritePool:null,_characterW:0,_bg:null,_isBg:!1,ctor:function(){this._super(),this._digitizeArr=[],this._spriteArr=[],this._spritePool=[]},createBounceCharactersUnit:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];this._characterW=0,(this._isBg=s)&&this.createBg(e),0<t&&n&&s&&this.createJiahaoSprite(e),""!=i&&this.createCharactersSprite(e,i,!0),this.createNumSprite(e,t,n)},createNumSprite:function(e,t,i){if(""!=t&&0!=t){this._digitizeArr=String(t).split("");for(var n=0;n<this._digitizeArr.length;n++){var s=this._digitizeArr[n];0<t&&i?this.createNumbersSprite(e,s,n,i):"-"==s?this.createNumbersSprite(e,"jian",n,i):this.createNumbersSprite(e,s,n,i)}}},createJiahaoSprite:function(e){var t=this.getBounceCharactersSprite();if(t){t._atlas=e;var i=t._atlas.getSpriteFrame("jia");i&&(t._sprite.spriteFrame=i,t.x=-25,this.width+=i._originalSize.width,this.height=i._originalSize.height,this.addChild(t),this._spriteArr.push(t))}},digitize:function(e){return(e+"").split("").map(String)},createNumbersSprite:function(e,t,i,n){var s=this.getBounceCharactersSprite();if(s){s._atlas=e;var a=s._atlas.getSpriteFrame(t);a&&(n||!this._digitizeArr.indexOf("+")&&!this._digitizeArr.indexOf("-")||(-1!=this._digitizeArr.indexOf("+")?i-=1:-1!=this._digitizeArr.indexOf("-")&&(i-=1)),this.addBounceCharacterData(s,a,!1,i),this._spriteArr.push(s))}},createCharactersSprite:function(e,t){var i=this.getBounceCharactersSprite();if(i){i._atlas=e;var n=i._atlas.getSpriteFrame(t);n&&(this.addBounceCharacterData(i,n,!0),this._spriteArr.push(i))}},addBounceCharacterData:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;e._sprite.spriteFrame=t,i?(this._characterW+=t._originalSize.width,e.x=t._originalSize.width*n):e.x=t._originalSize.width*n+this._characterW,this.width+=t._originalSize.width,this.height=t._originalSize.height,this.addChild(e)},createBg:function(e){this._bg||(this._bg=b8e.Sprite.get()),this.addChild(this._bg),this._bg._atlas=e;var t=this._bg._atlas.getSpriteFrame("bg");this._bg._sprite.spriteFrame=t,this._bg.x=-35},restore:function(){this._super()},recycle:function(){this.addBounceCharactersIntoPool(),this.isBg&&(this.isBg=!1,this._bg.setFrame(null),this._bg.removeFromParent()),this._super()},getBounceCharactersSprite:function(){return 0<this._spritePool.length?this._spritePool.shift():b8e.Sprite.get()},addBounceCharactersIntoPool:function(){for(;this._spriteArr.length;){var e=this._spriteArr.shift();e.setFrame(null),e.removeFromParent(),this._spritePool.push(e)}}}),game.BCUnit.pool=new b8e.Pool(game.BCUnit,255),game.BCUnit.get=function(e){return game.BCUnit.pool.get(e)},game.BCUnit.put=function(e){return e=game.BCUnit.pool.put(e)}},{}],1628:[function(e,t,i){"use strict";e("./BCMgr"),e("./BCType"),e("./BCUnit"),e("./AttBounceCharactersPanel")},{"./AttBounceCharactersPanel":1624,"./BCMgr":1625,"./BCType":1626,"./BCUnit":1627}],1629:[function(e,t,i){"use strict";game.CollectBar=b8e.BaseDisplay.extends({_collectInfo:null,_collectBg:null,_collectBgUrl:"",_collectBarBg:null,_collectBarBgUrl:"",_title:null,_labContent:null,_effectNode:null,_effect:null,_anim:null,_effectId:"",_cursorEffectNode:null,_cursorEffect:null,_cursorAnim:null,_cursorEffectId:"",_time:0,_isShowRate:!1,ctor:function(){this._super()},setData:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._collectInfo=e,this._time=t,this._isShowRate=i,this._collectInfo&&0!=this._time&&(this.clearData(),this.addCollectBg(),this.addCollectBarBg(),this.addTitle(),this.addContent(),this.addEffect(),this.addCursorEffect(),this.showCollect())},addCollectBg:function(){if(this._collectInfo.collectBg){if(this._collectBg||(this._collectBg=b8e.Sprite.get(),this._collectBg.setAnchor(0,0)),this.addChild(this._collectBg),this._collectBg.setVisible(!0),this._collectBgUrl=this._collectInfo.collectBg,this._collectInfo.collectBg9Inset){var e=this._collectInfo.collectBg9Inset.split(";");3<e.length&&(this._collectBg.setStyle(b8e.SpriteStyle.SLICED),this._collectBg.loadTexture(this._collectBgUrl,null,null,{scale9Inset:{top:parseInt(e[0]),bottom:parseInt(e[1]),left:parseInt(e[2]),right:parseInt(e[3])},useManifest:!1,recycleDelay:6e5}))}this._collectBg.setSize(this._collectInfo.collectBgWidth,this._collectInfo.collectBgHeight)}},addCollectBarBg:function(){if(this._collectInfo.collectBarBg){if(this._collectBarBg||(this._collectBarBg=b8e.Sprite.get(),this._collectBarBg.setAnchor(0,0)),this.addChild(this._collectBarBg),this._collectBarBg.setVisible(!0),this._collectBarBgUrl=this._collectInfo.collectBarBg,this._collectInfo.collectBarBg9Inset){var e=this._collectInfo.collectBarBg9Inset.split(";");3<e.length&&(this._collectBarBg.setStyle(b8e.SpriteStyle.SLICED),this._collectBarBg.loadTexture(this._collectBarBgUrl,null,null,{scale9Inset:{top:parseInt(e[0]),bottom:parseInt(e[1]),left:parseInt(e[2]),right:parseInt(e[3])},useManifest:!1,recycleDelay:6e5}))}this._collectBarBg.setSize(0,this._collectInfo.collectBarBgHeigth),this._collectBarBg.setPosition(1+this._collectInfo.collectBarBgOffsetX,1+this._collectInfo.collectBarBgOffsetY)}},addTitle:function(){if(!this._title){var e=b8e.BaseDisplay.get();e.getNode().pauseSystemEvents(!0),this._title=e.getNode().addComponent(cc.RichText),this._title.node.pauseSystemEvents(!0),this._title.node.setAnchorPoint(0,0),this._title.maxWidth=this._collectInfo.collectBarBgWidth,this._title.fontSize=this._collectInfo.titleSize,this._title.horizontalAlign=b8e.HorizontalAlign.CENTER,this._title.verticalAlign=b8e.VerticalAlign.MIDDLE}this.addChild(this._title.node),this._title.node.active=!0,this._title.node.setPosition(this._collectInfo.titleOffsetX,this._collectInfo.titleOffsetY),this._title.string=this._collectInfo.title},addContent:function(){if(!this._labContent){var e=b8e.BaseDisplay.get();e.getNode().pauseSystemEvents(!0),this._labContent=e.getNode().addComponent(cc.RichText),this._labContent.node.pauseSystemEvents(!0),this._labContent.node.setAnchorPoint(0,0),this._labContent.maxWidth=this._collectInfo.collectBarBgWidth,this._labContent.fontSize=this._collectInfo.contentSize,this._labContent.horizontalAlign=b8e.HorizontalAlign.CENTER,this._labContent.verticalAlign=b8e.VerticalAlign.MIDDLE}this.addChild(this._labContent.node),this._labContent.node.active=!0,this._labContent.node.setPosition(this._collectInfo.contentOffsetX,this._collectInfo.contentOffsetY),this._labContent.string="<outline color=#000000 width=1>"+this._collectInfo.content+"</outline>"},addEffect:function(){if(""==this._collectInfo.effectId||"0"==this._collectInfo.effectId||!this._collectInfo.effectId)return this.clearEffect(),void(this._effectNode&&(this._effectNode.active=!1,this._effectId=""));if(this._effectId!=this._collectInfo.effectId){if(!this._effectNode){var e=b8e.BaseDisplay.get();this._effectNode=e.getNode(),this._effectNode.setAnchorPoint(.5,.5),this._effectNode.x=this._collectInfo.effectOffsetX,this._effectNode.y=this._collectInfo.effectOffsetY}this.addChild(this._effectNode),this._effectNode.active=!0,this._effectId=this._collectInfo.effectId;var t=game.ClientCfg.getUIFxs(this._collectInfo.effectId);this.playEffect(t)}},playEffect:function(e){this._effect||(this._effect=b8e.BaseDisplay.get(),this._effect.addToParent(this._effectNode)),e?(this._anim||(this._anim=b8e.Animator.get(game.AnimatorType.COLLECT_EFFECT,1),this._effect.addChild(this._anim)),this._effect.setVisible(!0),this._effect.setScale(this._collectInfo.effectScale,this._collectInfo.effectScale),this._anim.load(e),this._anim.play()):this._anim&&this._anim.clear()},clearEffect:function(){this._anim&&this._anim.stop(),this._effect&&this._effect.setVisible(!1)},addCursorEffect:function(){if(""==this._collectInfo.cursorEffectId||"0"==this._collectInfo.cursorEffectId||!this._collectInfo.cursorEffectId)return this.clearCursorEffect(),void(this._cursorEffectNode&&(this._cursorEffectNode.active=!1,this._cursorEffectId=""));if(this._cursorEffectId!=this._collectInfo.cursorEffectId){if(!this._cursorEffectNode){var e=b8e.BaseDisplay.get();this._cursorEffectNode=e.getNode(),this._cursorEffectNode.setAnchorPoint(.5,.5),this._cursorEffectNode.y=this._collectBarBg.y+(this._collectInfo.collectBarBgHeigth>>1)+this._collectInfo.cursorEffectOffsetY}this._collectBarBg.addChild(this._cursorEffectNode),this._cursorEffectNode.active=!0,this._cursorEffectId=this._collectInfo.cursorEffectId;var t=game.ClientCfg.getUIFxs(this._collectInfo.cursorEffectId);this.playCursorEffect(t)}},playCursorEffect:function(e){this._cursorEffect||(this._cursorEffect=b8e.BaseDisplay.get(),this._cursorEffect.addToParent(this._cursorEffectNode)),e?(this._cursorAnim||(this._cursorAnim=b8e.Animator.get(game.AnimatorType.COLLECT_EFFECT,1),this._cursorEffect.addChild(this._cursorAnim)),this._cursorEffect.setVisible(!0),this._cursorEffect.setScale(this._collectInfo.cursorEffectScale,this._collectInfo.cursorEffectScale),this._cursorAnim.load(e),this._cursorAnim.play()):this._cursorAnim&&this._cursorAnim.clear()},clearCursorEffect:function(){this._cursorAnim&&this._cursorAnim.stop(),this._cursorEffect&&this._cursorEffect.setVisible(!1)},showCollect:function(){this._collectBarBg.width=0,b8e.Tween.kill(this._collectBarBg),this._isShowRate?b8e.Tween.get(this._collectBarBg).to({width:this._collectInfo.collectBarBgWidth},this._time).call(this.onCompleteFunc,this):b8e.Tween.get(this._collectBarBg,{onUpdate:this.onUpdateFunc,onUpdateThis:this}).to({width:this._collectInfo.collectBarBgWidth},this._time).call(this.onCompleteFunc,this)},onUpdateFunc:function(){var e=game.ValueUtil.getDigitsValueByNum(this._collectBarBg.width/this._collectInfo.collectBarBgWidth*100,0);this._labContent.string="<outline color=#000000 width=1>"+e+"%</outline>",this._cursorEffectNode&&(this._cursorEffectNode.x=this._collectBarBg.width+this._collectInfo.cursorEffectOffsetX)},onCompleteFunc:function(){b8e.Tween.kill(this),b8e.Tween.get(this).wait(100).call(this.onDelayHide,this)},onDelayHide:function(){this._collectBarBg.width=this._collectInfo.collectBarBgWidth,this.clearData(),game.collect.hide()},clearData:function(){this._collectBarBg&&b8e.Tween.kill(this._collectBarBg),this._title&&(this._title.node.removeFromParent(),this._title.node.active=!1),this._labContent&&(this._labContent.node.removeFromParent(),this._labContent.node.active=!1),this._collectBg&&(this._collectBg.removeFromParent(),this._collectBg.setVisible(!1)),this._collectBarBg&&(this._collectBarBg.width=0,this._collectBarBg.removeFromParent(),this._collectBarBg.setVisible(!1)),this.clearEffect(),this.clearCursorEffect(),this._cursorEffectId="",this._effectId="",this._isShowRate&&(this._isShowRate=!1)}})},{}],1630:[function(e,t,i){"use strict";game.CollectId=b8e.Enum({TIAN_GONG_COLLECT_ID:1})},{}],1631:[function(e,t,i){"use strict";game.CollectMgr=b8e.Object.extends({name:"CollectMgr",_collectBar:null,_collectInfo:null,_completeFun:null,_completeThisArg:null,_completeArgs:null,_isRegister:!1,ctor:function(){if(1==game.CollectMgr._singleton)throw new Error("CollectMgr 只能通过单例方法获取");this._super()},show:function(e,t){2<arguments.length&&void 0!==arguments[2]&&arguments[2];var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;if(t)if(this._collectInfo=game.ccfg.CollectCfg.getDataById(e),this._collectInfo){this._collectBar||(this._collectBar=new game.CollectBar);(game.PlotMgr.inst().isPlaying()?b8e.layer.getTopLayer():b8e.layer.getGuiLayer()).addChild(this._collectBar),this._completeFun=i,this._completeThisArg=n,this._completeArgs=s,this._collectBar.setData(this._collectInfo,t),this._onStageResize(),this._isRegister||(this._isRegister=!0,b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this._onStageResize))}else b8e.log("找不到采集条配置的数据：",e);else b8e.log("采集显示时间为0！！！！")},hide:function(){this._collectBar&&(this._collectBar.clearData(),this._collectBar.removeFromParent()),this._completeFun&&this._completeThisArg&&(this._completeArgs?this._completeFun.apply(this._completeThisArg,this._completeArgs):this._completeFun.apply(this._completeThisArg)),this._isRegister&&(this._isRegister=!1,b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this._onStageResize))},_onStageResize:function(){this._collectBar&&this._collectInfo&&(this._collectBar.x=(b8e.stageWidth>>1)-(this._collectInfo.collectBgWidth>>1)+this._collectInfo.collectX,this._collectBar.y=(b8e.stageHeight>>1)-(this._collectInfo.collectBgHeight>>1)+this._collectInfo.collectY)}}),game.CollectMgr._instance=null,game.CollectMgr._singleton=!0,game.CollectMgr.inst=function(){return game.CollectMgr._instance||(game.CollectMgr._singleton=!1,game.CollectMgr._instance=new game.CollectMgr,game.CollectMgr._singleton=!0),game.CollectMgr._instance}},{}],1632:[function(e,t,i){"use strict";e("./CollectBar"),e("./CollectId"),e("./CollectMgr")},{"./CollectBar":1629,"./CollectId":1630,"./CollectMgr":1631}],1633:[function(e,t,i){"use strict";game.StarBarCtr=b8e.Sprite.extends({_starSpVec:null,_starWidth:0,_starHeigth:0,_iconWidth:0,_iconHeight:0,ctor:function(){this._super(),this._starSpVec=[]},setData:function(e,t){this.clearData();var i=game.ccfg.StarCfg.getStarInfo(e,t);if(i){var n,s;for(this._iconWidth=i.iconWidth,this._iconHeight=i.iconHeight,n=0;n<i.huangguan;n++)s=b8e.Sprite.get(),this.addChild(s),s.loadTexture(i.huangguanUrl,null,null,{useManifest:!1}),s.setSize(i.iconWidth,i.iconHeight),this._starSpVec.push(s);for(n=0;n<i.taiyang;n++)s=b8e.Sprite.get(),this.addChild(s),s.loadTexture(i.taiyangUrl,null,null,{useManifest:!1}),s.setSize(i.iconWidth,i.iconHeight),this._starSpVec.push(s);for(n=0;n<i.yueliang;n++)s=b8e.Sprite.get(),this.addChild(s),s.loadTexture(i.yueliangUrl,null,null,{useManifest:!1}),s.setSize(i.iconWidth,i.iconHeight),this._starSpVec.push(s);for(n=0;n<i.xingxing;n++)s=b8e.Sprite.get(),this.addChild(s),s.loadTexture(i.xingxingUrl,null,null,{useManifest:!1}),s.setSize(i.iconWidth,i.iconHeight),this._starSpVec.push(s);this.layout()}else b8e.log("StarCfg找不到该配置！！！！！！_"+e+"_"+t)},setStarGradeData:function(e,t,i){this.clearData();var n=game.ccfg.StarGradeCfg.getStarGradeInfo(e,t,i);if(n){var s,a;for(this._iconWidth=n.iconWidth,this._iconHeight=n.iconHeight,s=0;s<n.hongxing;s++)a=b8e.Sprite.get(),this.addChild(a),a.loadTexture(n.hongxingUrl,null,null,{useManifest:!1}),a.setSize(n.iconWidth,n.iconHeight),this._starSpVec.push(a);for(s=0;s<n.xingxing;s++)a=b8e.Sprite.get(),this.addChild(a),a.loadTexture(n.xingxingUrl,null,null,{useManifest:!1}),a.setSize(n.iconWidth,n.iconHeight),this._starSpVec.push(a);this.layout()}else b8e.log("StarGradeCfg找不到该配置！！！！！！_"+e+"_"+t+"_"+i)},upgradeStar:function(e,t,i){this.clearData();var n=game.ccfg.StarGradeCfg.getStarGradeInfo(e,t,i);if(n){var s,a;for(this._iconWidth=n.iconWidth,this._iconHeight=n.iconHeight,s=0;s<n.hongxing;s++)a=b8e.Sprite.get(),this.addChild(a),a.loadTexture(n.hongxingUrl,null,null,{useManifest:!1}),a.setSize(n.iconWidth,n.iconHeight),this._starSpVec.push(a),s==n.hongxing-1&&(b8e.Tween.kill(a),b8e.Tween.get(a).to({scaleX:1.5,scaleY:1.5},200).to({scaleX:1,scaleY:1},200));for(s=0;s<n.xingxing;s++)a=b8e.Sprite.get(),this.addChild(a),a.loadTexture(n.xingxingUrl,null,null,{useManifest:!1}),a.setSize(n.iconWidth,n.iconHeight),this._starSpVec.push(a);this.layout()}else b8e.log("StarGradeCfg找不到该配置！！！！！！_"+e+"_"+t+"_"+i)},layout:function(){if(this._starSpVec&&!(this._starSpVec.length<=0)){for(var e=0;e<this._starSpVec.length;e++){this._starSpVec[e].x=this._iconWidth*e}this._starWidth=this._starSpVec.length*this._iconWidth,this._starHeigth=this._iconHeight}},clearData:function(){for(var e=0;e<this._starSpVec.length;e++){var t=this._starSpVec[e];t&&(t.setSize(t.width,t.height),t.setScale(1,1),t.setPosition(0,0),t.unloadTexture(),t.setTexture(null),t.removeFromParent(),b8e.Sprite.put(t))}this._starSpVec.length=0,this._starWidth=0,this._starHeigth=0},starWidth:{get:function(){return this._starWidth}},starHeigth:{get:function(){return this._starHeigth}},restore:function(){this._super()},recycle:function(){this.clearData(),this._super()}}),game.StarBarCtr.pool=new b8e.Pool(game.StarBarCtr,255),game.StarBarCtr.get=function(e){return game.StarBarCtr.pool.get(e)},game.StarBarCtr.put=function(e){return e=game.StarBarCtr.pool.put(e)}},{}],1634:[function(e,t,i){"use strict";e("./StarBarCtr")},{"./StarBarCtr":1633}],1635:[function(e,t,i){"use strict";game.ConditionInfo=b8e.Object.extends({_conditionMap:null,ctor:function(){this._super(),this._conditionMap=b8e.HashMap.get()},setup:function(e){if(e&&0!=e.length)for(var t=0;t<e.length;t++){var i=e[t];this._conditionMap.set(i.Type,i)}},setCondition:function(e,t){this._conditionMap.set(e,{Type:e,Value:t})},getConditions:function(){return this._conditionMap.values()}})},{}],1636:[function(e,t,i){"use strict";game.ConditionType=b8e.Enum({TARGET_NONE:0,TARGET_LEVEL:1,TARGET_FIGHT_AMOUNT:2,TARGET_REPUTATION:3,TARGET_ARENA:4,TARGET_EQUIP_STAR:5,TARGET_MOUNT:6,TARGET_WING:7,TARGET_FABAO:8,TARGET_RECHARGE:40})},{}],1637:[function(e,t,i){"use strict";game.ConditionUtil={},game.ConditionUtil.checkCondition=function(e){var t,i,n,s,a;if(!e)return!0;e instanceof Array?t=e:e instanceof game.ConditionInfo&&(t=e.getConditions());for(var o=0;o<t.length;o++)switch(n=(i=cfg.condition[o]).Type,s=i.Value,n){case game.ConditionType.TARGET_LEVEL:if(lv<s)return!1;break;case game.ConditionType.TARGET_FIGHT_AMOUNT:if((a=mainRole.getZhanLi())<s)return!1;break;case game.ConditionType.TARGET_REPUTATION:if((a=game.back.getAmountValue(game.AmountType.POPULARITY))<s)return!1;break;case game.ConditionType.TARGET_ARENA:if(0==(a=game.arena.arenaInfo.rank)||s<a)return!1;break;case game.ConditionType.TARGET_EQUIP_STAR:if((a=game.equip.getTotalStar())<s)return!1;break;case game.ConditionType.TARGET_MOUNT:if((a=game.MountMgr().accessoryData.lv)<s)return!1;break;case game.ConditionType.TARGET_WING:if((a=game.WingMgr().accessoryData.lv)<s)return!1;break;case game.ConditionType.TARGET_FABAO:if((a=game.FaBaoMgr().accessoryData.lv)<s)return!1}return!0}},{}],1638:[function(e,t,i){"use strict";game.Menu=b8e.Sprite.extends({MAX_WIDTH:150,LAB_MAX_HEIGHT:55,_modalBgNode:null,_screenOriginPos:null,_modalBgColor:null,_graphicsModalImg:null,_menuBg:null,isShowing:!1,_menuItemVec:null,_menuItemVisibleVec:null,_topLayer:null,_menuWidth:0,_menuHeight:0,ctor:function(){if(this._super(),1==game.Menu._singleton)throw new Error("Menu 只能通过单例方法获取");this._menuItemVec=[],this._menuItemVisibleVec=[]},show:function(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-1,a=arguments[4];if(this.isShowing&&this.clearData(),this.isShowing=!0,this.hideMenuItem(),!this._menuBg){this._menuBg=b8e.Sprite.get(),this.addChild(this._menuBg),this._menuBg.setStyle(b8e.SpriteStyle.SLICED),this._menuBg.loadTexture("images/image/icon/menu_bg.png",null,null,{scale9Inset:{top:11,bottom:11,left:11,right:11},useManifest:!1}),this._menuBg.width=this.MAX_WIDTH}this._topLayer||(this._topLayer=b8e.layer.getTopLayer());for(var o=t.length,r=this._menuItemVec.length,h=o-1;0<=h;h--)h<r?i=this._menuItemVec[h]:(i=new game.MenuItem,this.addChild(i),this._menuItemVec.push(i)),i.setData(t[h]),i.x=10+a>>1,i.y=this.LAB_MAX_HEIGHT*(o-1-h),i.index=o-1-h,i.layout(a),i.setVisible(!0),i.alpha=0,b8e.Tween.kill(i),b8e.Tween.get(i).to({alpha:1},100*h),this._menuItemVisibleVec.push(i);this._menuBg.setSize(a+10,o*this.LAB_MAX_HEIGHT+10),this._menuBg.setPosition(0,-(this.LAB_MAX_HEIGHT>>1)-5),this._menuWidth=a+10,this._menuHeight=o*this.LAB_MAX_HEIGHT+22,this.setSize(this._menuWidth,this._menuHeight),this.updatePos(e,n,s),this._topLayer.addChild(this),this._addModalBg(),this.menuShowAndHide(!0,50,this.onShowMenu),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageResize)},_addModalBg:function(){if(null==this._modalBgNode){var e=b8e.BaseDisplay.get();this._modalBgNode=e.getNode()}this.addChild(this._modalBgNode),null==this._screenOriginPos&&(this._screenOriginPos=this.convertToNodeSpaceAR(cc.Vec2.ZERO)),this._modalBgNode.setAnchorPoint(0,0),this._modalBgNode.setPosition(this._screenOriginPos),this.setBgNodeSize(this._modalBgNode)},setBgNodeSize:function(e){e.setContentSize(b8e.stageWidth,b8e.stageHeight),this._graphicsModalImg||(this._graphicsModalImg=b8e.Graphics.get(),this._graphicsModalImg.addToParent(e)),this._graphicsModalImg.clear();var t=this.x,i=this.y;this._modalBgNode.x=-t,this._modalBgNode.y=-i,this._modalBgNode.width=b8e.stageWidth+t,this._modalBgNode.height=b8e.stageHeight+i;var n=this._graphicsModalImg.getGraphics();this._modalBgColor||(this._modalBgColor=b8e.ColorUtil.toCCColor(0)),n.fillColor=this._modalBgColor,n.rect(-t,-i,b8e.stageWidth+t,b8e.stageHeight+i),n.fill(),e.setLocalZOrder(-999999999)},onShowMenu:function(){b8e.evt.onC(this._modalBgNode,this.onCloseMenu,this)},updatePos:function(e,t,i){var n=0,s=0;if(e){var a=e.getLocation();n=a.x,s=a.y}-1!=t?this.x=t:(this.x=n,this.x+this._menuWidth>b8e.stageWidth&&(this.x=b8e.stageWidth-this._menuWidth)),-1!=i?this.y=i:(this.y=s-(this._menuHeight>>1)-this.LAB_MAX_HEIGHT,this.y+this._menuHeight>b8e.stageHeight&&(this.y=b8e.stageHeight-this._menuHeight))},getMenuItemByType:function(e){for(var t=0;t<this._menuItemVisibleVec.length;t++){var i=this._menuItemVisibleVec[t];if(i.type==e)return i}return null},hideMenuItem:function(){for(var e=this._menuItemVec.length-1;0<=e;e--)this._menuItemVec[e].setVisible(!1)},clearData:function(){this.onHideMenu()},onHideMenu:function(){this._modalBgNode&&this._modalBgNode.removeFromParent();for(var e=0;e<this._menuItemVisibleVec.length;e++){var t=this._menuItemVisibleVec[e];t&&t.clearData()}this._menuItemVisibleVec.length=0,this.isShowing=!1,this.unregisterEvent(),b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onStageResize),this.removeFromParent()},unregisterEvent:function(){b8e.evt.offC(this._modalBgNode,this.onCloseMenu,this)},onCloseMenu:function(e){this.hide()},hide:function(){this.menuShowAndHide(!1,50,this.onHideMenu)},onStageResize:function(){this.isShowing&&this.onCloseMenu()},menuShowAndHide:function(e,t){var i,n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;e?(i=0,n=1):(i=1,n=0),this.alpha=i,b8e.Tween.kill(this),b8e.Tween.get(this).to({alpha:n},t).call(this.onComplete,this,[s])},onComplete:function(e){null!=e&&e.apply(this)}}),game.Menu._instance=null,game.Menu._singleton=!0,game.Menu.inst=function(){return game.Menu._instance||(game.Menu._singleton=!1,game.Menu._instance=new game.Menu,game.Menu._singleton=!0),game.Menu._instance}},{}],1639:[function(e,t,i){"use strict";game.MenuData=b8e.Object.extends({roleId:0,roleName:null,head:null,isCallBack:!1,datas:null,ctor:function(){this._super(),this.datas=[]},clear:function(){this.roleId=0,this.roleName=null,this.head=null,this.datas.length=0}})},{}],1640:[function(e,t,i){"use strict";game.MenuEvent=b8e.Enum({MENU_CLICK:b8e.Event.nextCode(),MENU_HIDE:b8e.Event.nextCode()})},{}],1641:[function(e,t,i){"use strict";game.MenuItem=b8e.Sprite.extends({MAX_WIDTH:150,LAB_MAX_HEIGHT:55,_menuBg:null,_menuSelectedBg:null,_lab:null,_type:"",_index:-1,ctor:function(){this._super(),this.init()},init:function(){this._menuBg=b8e.Sprite.get(),this.addChild(this._menuBg),this._menuBg.setAnchor(.5,.5),this._menuBg.setStyle(b8e.SpriteStyle.SLICED),this._menuBg.loadTexture("images/image/icon/menu_item_bg.png",null,null,{scale9Inset:{top:20,bottom:20,left:40,right:40},useManifest:!1});this._menuSelectedBg=b8e.Sprite.get(),this.addChild(this._menuSelectedBg),this._menuSelectedBg.setAnchor(.5,.5),this._menuSelectedBg.setStyle(b8e.SpriteStyle.SLICED),this._menuSelectedBg.loadTexture("images/image/icon/img_selected.png",null,null,{scale9Inset:{top:11,bottom:11,left:11,right:11},useManifest:!1}),this._menuSelectedBg.setVisible(!1),this._lab=b8e.Label.get(),this.addChild(this._lab),this._lab.setAnchor(.5,.5),this._lab.y=3,this._lab.setFontSize(24),this._lab.setStroke(1,0),this._lab.setOverflow(b8e.OverflowType.SHRINK),this._lab.setVerticalAlign(b8e.VerticalAlign.CENTER),this._lab.setHorizontalAlign(b8e.HorizontalAlign.CENTER),this._lab.setLineHeight(this.LAB_MAX_HEIGHT),this._lab.setSize(this.MAX_WIDTH,this.LAB_MAX_HEIGHT)},setData:function(e){this._type=e,this._lab.setText(game.menu.getMenuTitle(e)),this.registerEvent()},clearData:function(){this._type="",this._lab.setText(""),this.unregisterEvent()},registerEvent:function(){b8e.evt.onC(this,this.onClickItem,this),b8e.evt.onC(this._menuBg,this.onClickItem,this),b8e.evt.onC(this._lab,this.onClickItem,this)},unregisterEvent:function(){b8e.evt.offC(this,this.onClickItem,this),b8e.evt.offC(this._menuBg,this.onClickItem,this),b8e.evt.offC(this._lab,this.onClickItem,this)},onClickItem:function(e){b8e.Tween.kill(this),b8e.Tween.get(this).to({scaleX:.95,scaleY:.95},50).call(this.onTweenComplete,this)},onTweenComplete:function(){b8e.Tween.kill(this),b8e.Tween.get(this).to({scaleX:1,scaleY:1},50).call(this.onTweenComplete2,this)},onTweenComplete2:function(){b8e.evt.dptG(game.MenuEvent.MENU_CLICK,{type:this._type,index:this.index})},layout:function(e,t,i){this._menuBg.setSize(e,this.LAB_MAX_HEIGHT),this._menuBg.setPosition(0,0),this._lab.setSize(e-10,this.LAB_MAX_HEIGHT),this._menuSelectedBg.setSize(e,this.LAB_MAX_HEIGHT),this._menuSelectedBg.setPosition(0,0),this.setSize(e,this.LAB_MAX_HEIGHT)},type:{get:function(){return this._type}},index:{set:function(e){this._index=e},get:function(){return this._index}}})},{}],1642:[function(e,t,i){"use strict";game.MenuList={NORMAL_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.TALK,game.MenuType.ADD_FRIEND,game.MenuType.ADD_BLACK],FRIEND_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.TALK,game.MenuType.REMOVE_FRIEND,game.MenuType.ADD_BLACK],TALK_NORMAL_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.ADD_FRIEND,game.MenuType.ADD_BLACK,game.MenuType.TALK],TALK_FRIEND_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.REMOVE_FRIEND,game.MenuType.ADD_BLACK,game.MenuType.TALK],GUILD_MASTER_CLICK_SELF_MENU:[game.MenuType.LEAVA_GUILD,game.MenuType.DISSOLVE_GUILD],GUILD_MASTER_CLICK_OTHER_MENU:[game.MenuType.TRANSFER_MASTER,game.MenuType.SET_ZHANGLAO,game.MenuType.SET_MEMBER,game.MenuType.EVICT_GUILD],GUILD_ZHANG_LAO_CLICK_SELF_MENU:[game.MenuType.LEAVA_GUILD],GUILD_ZHANG_LAO_CLICK_OTHER_MENU:[game.MenuType.EVICT_GUILD,game.MenuType.TALK],GUILD_MEMBER_CLICK_SELF_MENU:[game.MenuType.LEAVA_GUILD],GUILD_MEMBER_CLICK_OTHER_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.TALK],GUILD_VIEW_GUILD_MASTER_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.ADD_FRIEND,game.MenuType.COPY_NAME,game.MenuType.ADD_BLACK,game.MenuType.TALK],COMMON_NORMAL_MASTER_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.ADD_FRIEND,game.MenuType.COPY_NAME,game.MenuType.ADD_BLACK,game.MenuType.TALK],COMMON_FRIEND_MASTER_MENU:[game.MenuType.VIEW_INFORMATION,game.MenuType.REMOVE_FRIEND,game.MenuType.COPY_NAME,game.MenuType.ADD_BLACK,game.MenuType.TALK]}},{}],1643:[function(e,t,i){"use strict";game.MenuMgr=b8e.Object.extends({name:"MenuMgr",MENU_ID_BACKPACK:1,curData:null,_callBack:null,_thisArg:null,_isRegisterEvt:!1,ctor:function(){if(1==game.MenuMgr._singleton)throw new Error("MenuMgr 只能通过单例方法获取")},setup:function(){this._isRegisterEvt||(this._isRegisterEvt=!0,b8e.evt.addG(this,game.MenuEvent.MENU_CLICK,this.menuClick))},show:function(e,t,i,n,s){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:-1,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:-1,r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:150;i=this.screeingMenus(i),this.curData=n,i.length<=0||(this._thisArg=e,this._callBack=s,game.Menu.inst().show(t,i,a,o,r))},screeingMenus:function(e){for(var t=e.length-1;0<=t;t--)this.isShowType(e[t])||e.splice(t,1);return e},getMenuTitle:function(e){return game.ccfg.LangCfg.getText(e)},isShowType:function(e){return!0},menuClick:function(e){var t=e.data;if(t){var i=t.type,n=t.index;game.Menu.inst().hide(),this.doMenu(i,n)}},doMenu:function(e,t){if(this.curData){var i,n,s,a=[];if(this.curData&&this.curData instanceof Array)i=(a=this.curData)[0],n=a[1],s=a[2];else i=this.curData.roleId,n=this.curData.roleName,s=this.curData.head,this.curData.isCallBack,a=this.curData.datas;if(this._callBack)this._callBack.call(this._thisArg,this.curData,t);else switch(e){case game.MenuType.TALK:game.relationChat.setChatTarget(i,n,s);break;case game.MenuType.ADD_FRIEND:game.relation.addFriend(i);break;case game.MenuType.REMOVE_FRIEND:game.relation.removeFriend(i);break;case game.MenuType.ADD_BLACK:game.relation.addBlack(i);break;case game.MenuType.LEAVA_GUILD:game.guild.reqLeaveGuild();break;case game.MenuType.DISSOLVE_GUILD:game.guild.reqGuildDisband();break;case game.MenuType.TRANSFER_MASTER:game.guild.reqTransGuildMaster(i);break;case game.MenuType.SET_ZHANGLAO:if(game.guild.isMaxZhangLao())return void game.notice.show("长老人数已满");game.GuildSender.reqChangeGuildRank(i,game.GuildRank.ZHANG_LAO);break;case game.MenuType.SET_MEMBER:game.GuildSender.reqChangeGuildRank(i,game.GuildRank.MEMBER);break;case game.MenuType.EVICT_GUILD:game.GuildSender.reqKickGuildMember(i);break;case game.MenuType.VIEW_INFORMATION:game.othersRole.initinfo(i);break;case game.MenuType.COPY_NAME:}}}}),game.MenuMgr._instance=null,game.MenuMgr._singleton=!0,game.MenuMgr.inst=function(){return game.MenuMgr._instance||(game.MenuMgr._singleton=!1,game.MenuMgr._instance=new game.MenuMgr,game.MenuMgr._singleton=!0),game.MenuMgr._instance}},{}],1644:[function(e,t,i){"use strict";game.MenuType={TALK:"私聊",ADD_FRIEND:"添加好友",REMOVE_FRIEND:"移除好友",ADD_BLACK:"屏蔽",LEAVA_GUILD:"离开帮会",DISSOLVE_GUILD:"解散帮会",TRANSFER_MASTER:"转让帮主",SET_ZHANGLAO:"设为长老",SET_MEMBER:"设为成员",EVICT_GUILD:"逐出帮会",VIEW_INFORMATION:"查看",COPY_NAME:"复制名字"}},{}],1645:[function(e,t,i){"use strict";game.MuneUnit=b8e.Object.extends({index:-1,data:null,ctor:function(){this._super()},clear:function(){this.index=-1}})},{}],1646:[function(e,t,i){"use strict";e("./MenuType"),e("./MenuEvent"),e("./MenuItem"),e("./Menu"),e("./MenuMgr"),e("./MenuData"),e("./MenuList")},{"./Menu":1638,"./MenuData":1639,"./MenuEvent":1640,"./MenuItem":1641,"./MenuList":1642,"./MenuMgr":1643,"./MenuType":1644}],1647:[function(e,t,i){"use strict";game.CenterNotice=b8e.Object.extends({CENTER_DIS:150,_topLayer:null,_timer_obj:null,_noticeUnitSp:null,_noticeUnit:null,_timerObj:null,ctor:function(){this._super(),this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){this._noticeUnitSp&&this.timingDelete(),this._noticeUnitSp=game.notice.getNoticeUnitSpByType(e,t,i),this._noticeUnit=game.ccfg.NoticeCfg.getNoticeInfoByType(e),this._noticeUnit&&(this._timerObj||(this._timerObj=b8e.Timer.add(this,this.timingDelete,this._noticeUnit.showTime)),this.adjustNoticePosition(),this._noticeUnitSp&&(this._noticeUnitSp.alpha=1,this._noticeUnitSp.setVisible(!0),this._guiLayer.addChild(this._noticeUnitSp)))},adjustNoticePosition:function(){this._noticeUnitSp&&(this._noticeUnitSp.x=(b8e.stageWidth-this._noticeUnitSp.noticeW)/2+this._noticeUnit.offsetX,this._noticeUnitSp.y=Math.max(b8e.stageHeight-this._noticeUnitSp.noticeH-this.CENTER_DIS,100)+this._noticeUnit.offsetY),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageSize)},timingDelete:function(){b8e.evt.rmvG(this,b8e.Event.STAGE_RESIZE,this.onStageSize),this._noticeUnitSp&&(game.NoticeUnitSprite.put(this._noticeUnitSp),this._noticeUnitSp.removeFromParent()),this._timerObj&&(b8e.Timer.remove(this,this.timingDelete),this._timerObj=null),this._noticeUnitSp=null,this._noticeUnit=null},onStageSize:function(e){this.adjustNoticePosition()}})},{}],1648:[function(e,t,i){"use strict";game.GMNotice=b8e.Object.extends({GM_NOTICE_WIDTH:500,GM_NOTICE_HEIGHT:50,GM_NOTICE_NUM:5,_bgNotice:null,_gmNoticeLabel:null,_gmNoticeLab:null,_gmNoticeContainer:null,_labelMask:null,_noticesList:null,_isScroll:!1,_isInit:!1,_type:-1,_guiLayer:null,_isHasTick:!1,_noticeInfo:null,ctor:function(){this._super(),this._noticesList=[],this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){this._type!=e&&(this._type=e,this._noticeUnit=game.ccfg.NoticeCfg.getNoticeInfoByType(this._type)),this._noticeUnit&&(this._noticeInfo||(this._noticeInfo=new game.NoticeInfo),this._noticeInfo.msg=t,this._noticeInfo.sort=i,this._noticesList.push(this._noticeInfo),this._noticesList.sort(this.onSort),this.initGMNoticeContainer(),this._isHasTick||(this._isHasTick=!0,b8e.Ticker.add(this,this.onScorllGMNotice)))},onSort:function(e,t){return e.sort>t.sort?1:e.sort<t.sort?-1:0},initGMNoticeContainer:function(){if(!this._isInit){if(this._isInit=!0,!this._bgNotice){this._bgNotice=b8e.Sprite.get(),this._bgNotice.setSize(this._noticeUnit.bgWidth,this._noticeUnit.bgHeight);var e=this._noticeUnit.itemBg;if(e){this._bgNotice.setStyle(b8e.SpriteStyle.SLICED);var t=game.notice.getScale9Inset(this._type);this._bgNotice.loadTexture(e,null,null,{scale9Inset:t,useManifest:!1})}}if(!this._gmNoticeLab){var i=b8e.BaseDisplay.get();i.getNode().pauseSystemEvents(!0),this._gmNoticeLab=i.getNode().addComponent(cc.RichText),this._gmNoticeLab.node.setAnchorPoint(0,0),this._gmNoticeLab.fontSize=this._noticeUnit.textSize,this._gmNoticeLab.lineHeight=this._noticeUnit.textSize+2,this._gmNoticeLab.node.pauseSystemEvents(!0)}this._gmNoticeContainer||(this._gmNoticeContainer=b8e.Sprite.get(),this._gmNoticeContainer.addChild(this._bgNotice),this._gmNoticeContainer.addChild(this._gmNoticeLab.node),this._gmNoticeContainer.setLocalZOrder(this._noticeUnit.layerOrder),this._gmNoticeContainer.getNode().pauseSystemEvents(!0),this._guiLayer.addChild(this._gmNoticeContainer)),this._labelMask||(this._labelMask=this._gmNoticeContainer.getNode().addComponent(cc.Mask),this._labelMask.type=cc.Mask.Type.RECT,this._labelMask.node.setAnchorPoint(0,0),this._labelMask.node.pauseSystemEvents(!0),this._labelMask.node.width=this._noticeUnit.bgWidth,this._labelMask.node.height=this._noticeUnit.bgHeight),this._gmNoticeContainer.alpha=0,this.adjustGMNoticeContainer(),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageSize)}},onStageSize:function(){this.adjustGMNoticeContainer()},adjustGMNoticeContainer:function(){if(this._noticeUnit){var e=(b8e.stageWidth-this._noticeUnit.bgWidth)/2,t=b8e.stageHeight-this._noticeUnit.bgHeight;this._gmNoticeContainer.x=e+this._noticeUnit.offsetX,this._gmNoticeContainer.y=t-this._noticeUnit.offsetY}},onScorllGMNotice:function(){if(this._isScroll){var e;this._gmNoticeLab.node.x-=this._noticeUnit.mobileDistance,this._gmNoticeLab.node.width>this._noticeUnit.bgWidth?e=-(this._gmNoticeLab.node.width-this._noticeUnit.bgWidth+this._noticeUnit.bgWidth+this._noticeUnit.hideTime):this._gmNoticeLab.node.width<this._noticeUnit.bgWidth&&(e=-(this._noticeUnit.bgWidth+this._noticeUnit.hideTime)),this._gmNoticeLab.node.x<e&&(this._isScroll=!1)}else{if(this._gmNoticeLab.node.x=this._noticeUnit.bgWidth,this._gmNoticeContainer.alpha=1,0==this._noticesList.length)return this._gmNoticeContainer.alpha=0,b8e.Ticker.remove(this,this.onScorllGMNotice),void(this._isHasTick=!1);this._isScroll=!0;var t=this._noticesList.shift();t&&(this._gmNoticeLab.string=t.msg);var i=(this._noticeUnit.bgHeight-this._gmNoticeLab.node.height)/2-1;this._gmNoticeLab.node.y=i}}})},{}],1649:[function(e,t,i){"use strict";game.GetNotice=b8e.Object.extends({_lastShowTime:0,_noticeList:null,_guiLayer:null,_timerObj:null,_isStart:!1,ctor:function(){this._super(),this._noticeList=[],this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){var n=game.notice.getNoticeUnitSpByType(e,t,i),s=game.ccfg.NoticeCfg.getNoticeInfoByType(e);if(s){for(;10<this._noticeList.length;){var a=this._noticeList.shift();a&&(a.removeFromParent(),game.NoticeUnitSprite.put(a))}var o=b8e.timeStamp;o-this._lastShowTime<500?(this._noticeList.push(n),this._isStart||(this._isStart=!0,this.stopDelatTimer(),this._timerObj||(this._timerObj=b8e.Timer.add(this,this.delayShowNotice,s.delayTime,0,0,[s])),this._timerObj.reset(),this._timerObj.start())):(this._lastShowTime=o,this.showANotice(n,s))}},stopDelatTimer:function(){this._timerObj&&this._timerObj.stop()},delayShowNotice:function(e){if(0!=this._noticeList.length){var t=this._noticeList.pop();this.showANotice(t,e),this._lastShowTime=b8e.timeStamp}0==this._noticeList.length&&(this.stopDelatTimer(),this._isStart=!1)},showANotice:function(e,t){b8e.Tween.kill(this),b8e.Tween.get(this).wait(50).call(this.delay,this,[e,t])},delay:function(e,t){var i=(b8e.stageWidth-e.noticeW)/2,n=(b8e.stageHeight-e.noticeH)/2;e.x=i+t.offsetX,e.y=n+t.offsetY,e.alpha=1,e.setVisible(!0),this._guiLayer.addChild(e),b8e.Tween.get(e).to({y:e.y+t.mobileDistance},t.showTime).to({alpha:0,y:e.y+t.mobileDistance+50},t.hideTime).call(function(e){b8e.Tween.kill(e),game.NoticeUnitSprite.put(e),e.removeFromParent()},this,[e])}})},{}],1650:[function(e,t,i){"use strict";game.KillNotice=b8e.Object.extends({_lastShowTime:0,_noticeList:null,_guiLayer:null,_timerObj:null,_isStart:!1,ctor:function(){this._super(),this._noticeList=[],this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){var n=game.notice.getNoticeUnitSpByType(e,t,i,0,10),s=game.ccfg.NoticeCfg.getNoticeInfoByType(e);if(s){switch(n.setLocalZOrder(s.layerOrder),s.textAlign){case"center":n.x=(b8e.stageWidth-n.noticeW)/2+s.offsetX;break;case"left":n.x=s.offsetX}for(;10<this._noticeList.length;){var a=this._noticeList.shift();a&&(a.removeFromParent(),game.NoticeUnitSprite.put(a))}var o=b8e.timeStamp;o-this._lastShowTime<500?(this._noticeList.push(n),this._isStart||(this._isStart=!0,this.stopDelatTimer(),this._timerObj||(this._timerObj=b8e.Timer.add(this,this.delayShowNotice,s.delayTime,0,0,[s])),this._timerObj.reset(),this._timerObj.start())):(this._lastShowTime=o,this.showANotice(n,s))}},stopDelatTimer:function(){this._timerObj&&this._timerObj.stop()},delayShowNotice:function(e){if(0!=this._noticeList.length){var t=this._noticeList.pop();this.showANotice(t,e),this._lastShowTime=b8e.timeStamp}0==this._noticeList.length&&(this.stopDelatTimer(),this._isStart=!1)},showANotice:function(e,t){b8e.Tween.kill(this),b8e.Tween.get(this).wait(50).call(this.delay,this,[e,t])},delay:function(e,t){var i=.15*(b8e.stageWidth-e.noticeW),n=.75*(b8e.stageHeight-e.noticeH);e.x=i+t.offsetX,e.y=n+t.offsetY,e.alpha=1,e.setVisible(!0),this._guiLayer.addChild(e),b8e.Tween.get(e).to({y:e.y+t.mobileDistance},t.showTime).to({alpha:0,y:e.y+t.mobileDistance+50},t.hideTime).call(function(e){b8e.Tween.kill(e),game.NoticeUnitSprite.put(e),e.removeFromParent()},this,[e])}})},{}],1651:[function(e,t,n){"use strict";game.NoticeMgr=b8e.Object.extends({name:"NoticeMgr",SYSTEM_ROLL:1,CENTER_BOTTOM:2,SYSTEM_SWITCH:3,WINDOW_CENTER:4,OPERATION_FEEDBACK:5,BEST_WISHED:6,KILL_NOTICE:7,_getNotice:null,_operationNotice:null,_centerNotice:null,_personNotice:null,_gMNotice:null,_killNotice:null,ctor:function(){if(1==game.NoticeMgr._singleton)throw new Error("NoticeMgr 只能通过单例方法获取");this._super(),this._getNotice=new game.GetNotice,this._operationNotice=new game.OperationNotice,this._centerNotice=new game.CenterNotice,this._personNotice=new game.PersonNotice,this._gMNotice=new game.GMNotice,this._wishNotice=new game.WishNotice,this._killNotice=new game.KillNotice},show:function(e,t){if(t||(t=[]),t instanceof Array){var n=game.ccfg.LangCfg.getLanguage(e);if(!n)return void this.notify(this.OPERATION_FEEDBACK,e,t);var s=n.type;if(s||(s="5"),-1==s.indexOf(";"))this.notify(Number(s),n,t);else{var a=s.split(";");if(null!=a)for(var o=0;o<a.length;o++)this.notify(a[i],n,t)}}else b8e.error("game.NoticeMgr.show()>>>>>>第二个参数必须是Array类型！！！")},notify:function(e,t,i){this.showByType(e,t,i)},showByType:function(e,t,i){var n,s=t.value;switch(s||(s=t),null!=i&&(i instanceof Number?b8e.warn("客户端文字配置表，配置id：",s,"不存在！！！"):s=game.ccfg.LangCfg.replaceStr(s,i)),e){case this.SYSTEM_ROLL:n=this._gMNotice;break;case this.CENTER_BOTTOM:n=this._personNotice;break;case this.SYSTEM_SWITCH:n=this._centerNotice;break;case this.WINDOW_CENTER:n=this._getNotice;break;case this.OPERATION_FEEDBACK:n=this._operationNotice;break;case this.BEST_WISHED:n=this._wishNotice;break;case this.KILL_NOTICE:n=this._killNotice}n&&n.addNotice(e,s,t)},broadcast:function(e,t){this._gMNotice.addNotice(this.SYSTEM_ROLL,e,t)},getNoticeUnitSpByType:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=game.NoticeUnitSprite.get();return a.createNoticeUnitSprite(e,t,i,n,s),game.ccfg.NoticeCfg.getNoticeInfoByType(e)?a.setLocalZOrder(6666):a.setLocalZOrder(layerOrder),a.alpha=0,a.setVisible(!1),a},getScale9Inset:function(e){var t,i=2,n=2,s=2,a=2,o=game.ccfg.NoticeCfg.getNoticeInfoByType(e);if(o){var r=o.scale9Inset.split(";");t=r&&4<=r.length?{top:i=Number(r[0]),bottom:n=Number(r[1]),left:s=Number(r[2]),right:a=Number(r[3])}:{top:i,bottom:n,left:s,right:a}}else t={top:i,bottom:n,left:s,right:a};return t}}),game.NoticeMgr._instance=null,game.NoticeMgr._singleton=!0,game.NoticeMgr.inst=function(){return game.NoticeMgr._instance||(game.NoticeMgr._singleton=!1,game.NoticeMgr._instance=new game.NoticeMgr,game.NoticeMgr._singleton=!0),game.NoticeMgr._instance}},{}],1652:[function(e,t,i){"use strict";game.NoticeUnitSprite=b8e.Sprite.extends({_noticeUnit:null,_type:null,_lab:null,_msg:null,_fontSize:null,_labArr:null,_labPool:null,_obj:null,ctor:function(){this._super(),this._labArr=[],this._labPool=[],this.restore()},createNoticeUnitSprite:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(this._type!=e&&(this._type=e,this._noticeUnit=game.ccfg.NoticeCfg.getNoticeInfoByType(e)),this._noticeUnit){var a=this._noticeUnit.itemBg;a&&(this._type!=e&&(this.setStyle(b8e.SpriteStyle.SLICED),this._obj=game.notice.getScale9Inset(e)),this.loadTexture(a,this.onComple,null,{scale9Inset:this._obj,useManifest:!1}));var o=this.getLabel();switch(o&&(o.node.anchorX=0,o.node.anchorY=0,o.node.x=n,o.node.y=s,o.node.pauseSystemEvents(!0),this._fontSize!=this._noticeUnit.textSize&&(this._fontSize=this._noticeUnit.textSize,o.fontSize=this._noticeUnit.textSize),o.lineHeight=this._noticeUnit.lineHeight,o.maxWidth=this._noticeUnit.bgWidth,this.addChild(o.node),this._labArr.push(o),this._msg!=t&&(this._msg=t,o.string=t)),this._type){case game.notice.SYSTEM_ROLL:case game.notice.CENTER_BOTTOM:case game.notice.SYSTEM_SWITCH:case game.notice.OPERATION_FEEDBACK:case game.notice.BEST_WISHED:case game.notice.WINDOW_CENTER:case game.notice.KILL_NOTICE:o.handleTouchEvent=!1}this.layout(o)}},onComple:function(e){e.alpha=.9},layout:function(e){this.setSize(this._noticeUnit.bgWidth,this._noticeUnit.bgHeight)},getLabel:function(){if(0<this._labPool.length)return this._labPool.shift();var e=b8e.BaseDisplay.get();e.getNode().pauseSystemEvents(!0);var t=e.getNode().addComponent(cc.RichText);return t.node.pauseSystemEvents(!0),t.node.anchorX=0,t.node.anchorY=0,t.node.setAnchorPoint(0,0),t.fontSize=this._noticeUnit.textSize,t.lineHeight=this._noticeUnit.bgHeight,t.maxWidth=this._noticeUnit.bgWidth,t.horizontalAlign=b8e.HorizontalAlign.CENTER,t.verticalAlign=b8e.VerticalAlign.MIDDLE,t},noticeW:{get:function(){return this._noticeUnit?this._noticeUnit.bgWidth:300}},noticeH:{get:function(){return this._noticeUnit?this._noticeUnit.bgHeight:50}},clearData:function(){this.clearLabs()},clearLabs:function(){for(;0<this._labArr.length;){var e=this._labArr.shift();e.node.removeFromParent(!1),this._labPool.push(e)}},restore:function(){this._super(),this.setPosition(0,0)},recycle:function(){this.clearData(),this._super()}}),game.NoticeUnitSprite.pool=new b8e.Pool(game.NoticeUnitSprite,255),game.NoticeUnitSprite.get=function(e){return game.NoticeUnitSprite.pool.get(e)},game.NoticeUnitSprite.put=function(e){return e=game.NoticeUnitSprite.pool.put(e)}},{}],1653:[function(e,t,i){"use strict";game.OperationNotice=b8e.Object.extends({_lastShowTime:0,_noticeList:null,_guiLayer:null,_timerObj:null,ctor:function(){this._super(),this._noticeList=[],this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){var n=game.notice.getNoticeUnitSpByType(e,t),s=game.ccfg.NoticeCfg.getNoticeInfoByType(e);if(s){for(;3<this._noticeList.length;){var a=this._noticeList.shift();a&&(a.removeFromParent(),game.NoticeUnitSprite.put(a))}var o=b8e.timeStamp;o-this._lastShowTime<500?(this._noticeList.push(n),this._timerObj||(this._timerObj=b8e.Timer.add(this,this.delayShowNotice,s.delayTime,0,0,[s]))):(this._lastShowTime=o,this.showANotice(n,s))}},delayShowNotice:function(e){if(0!=this._noticeList.length){var t=this._noticeList.pop();this.showANotice(t,e),this._lastShowTime=b8e.timeStamp,this._timerObj&&(b8e.Timer.remove(this,this.delayShowNotice),this._timerObj=null)}},showANotice:function(e,t){var i=(b8e.stageWidth-e.noticeW)/2,n=(b8e.stageHeight-e.noticeH)/2;e.x=i+t.offsetX,e.y=n+t.offsetY,e.alpha=1,e.setVisible(!0),this._guiLayer.addChild(e),b8e.Tween.get(e).to(null,t.showTime,b8e.Ease.elasticOut).call(this.onComplete,this,[e,t])},onComplete:function(e,t){b8e.Tween.get(e).to({alpha:0,y:e.y+t.mobileDistance},t.hideTime).call(function(e){b8e.Tween.kill(e),game.NoticeUnitSprite.put(e),e.removeFromParent()},this,[e])}})},{}],1654:[function(e,t,i){"use strict";game.PersonNotice=b8e.Object.extends({MAX_NOTICE_NUM:1,_deleteTimes:0,_personNotices:null,_noticeUnit:null,_guiLayer:null,_timerObj:null,ctor:function(){this._super(),this._personNotices=[],this._guiLayer=b8e.layer.getGuiLayer(),b8e.evt.addG(this,b8e.Event.STAGE_RESIZE,this.onStageSize)},addNotice:function(e,t,i){if(this._noticeUnit=game.ccfg.NoticeCfg.getNoticeInfoByType(e),this._noticeUnit){0==this._personNotices.length&&(this._timerObj||(this._timerObj=b8e.Timer.add(this,this.timingDelete,this._noticeUnit.delayTime)));var n=game.notice.getNoticeUnitSpByType(e,t,i);this._personNotices.splice(0,0,n),n&&(n.alpha=1,n.setVisible(!0),this._guiLayer.addChild(n),n.setLocalZOrder(this._noticeUnit.layerOrder)),this.adjustNoticePosition()}},adjustNoticePosition:function(){var e;if(this._noticeUnit&&this._noticeUnit){this._personNotices.length>this._noticeUnit.maxLine&&(null!=(e=this._personNotices[this._noticeUnit.maxLine])&&null!=e.parent&&(game.NoticeUnitSprite.put(e),e.removeFromParent()),this._personNotices.splice(this._noticeUnit.maxLine,1));for(var t=0,i=0;i<this._personNotices.length;++i){switch(e=this._personNotices[i],this._noticeUnit.textAlign){case"center":e.x=(b8e.stageWidth-e.noticeW)/2+this._noticeUnit.offsetX;break;case"left":e.x=this._noticeUnit.offsetX}t+=e.noticeH,e.y=t+this._noticeUnit.offsetY+2*i}}},timingDelete:function(){if(++this._deleteTimes,0!=this._personNotices.length){var e=this._personNotices[this._personNotices.length-1];null!=e&&(this._personNotices.pop(),b8e.Tween.get(e).to({alpha:0},this._noticeUnit.hideTime).call(function(e){null!=e&&(b8e.Tween.kill(e),e.removeFromParent(),game.NoticeUnitSprite.put(e))},this,[e]))}0==this._personNotices.length&&(this._deleteTimes=0,this._timerObj&&(b8e.Timer.remove(this,this.timingDelete),this._timerObj=null))},onStageSize:function(){this.adjustNoticePosition()}})},{}],1655:[function(e,t,i){"use strict";game.WishNotice=b8e.Object.extends({_lastShowTime:0,_noticeList:null,_guiLayer:null,_timerObj:null,ctor:function(){this._super(),this._noticeList=[],this._guiLayer=b8e.layer.getGuiLayer()},addNotice:function(e,t,i){var n=game.notice.getNoticeUnitSpByType(e,t,i),s=game.ccfg.NoticeCfg.getNoticeInfoByType(e);if(s){for(;10<this._noticeList.length;){var a=this._noticeList.shift();a&&(a.removeFromParent(),game.NoticeUnitSprite.put(a))}var o=b8e.timeStamp;o-this._lastShowTime<500?(this._noticeList.push(n),this._timerObj||(this._timerObj=b8e.Timer.add(this,this.delayShowNotice,s.delayTime,0,0,[s]))):(this._lastShowTime=o,this.showANotice(n,s))}},delayShowNotice:function(e){if(0!=this._noticeList.length){var t=this._noticeList.pop();this.showANotice(t,e),this._lastShowTime=b8e.timeStamp,this._timerObj&&(b8e.Timer.remove(this,this.delayShowNotice),this._timerObj=null)}},showANotice:function(e,t){var i=(b8e.stageWidth-e.noticeW)/2,n=(b8e.stageHeight-e.noticeH)/2;e.x=i+t.offsetX,e.y=n+t.offsetY,e.alpha=1,e.setVisible(!0),this._guiLayer.addChild(e),b8e.Tween.get(e).to({y:e.y+t.mobileDistance},t.showTime).call(this.onComplete,this,[e,t])},onComplete:function(e,t){b8e.Tween.get(e).to({alpha:0,y:e.y+50},t.hideTime).call(function(e){b8e.Tween.kill(e),e.removeFromParent(),game.NoticeUnitSprite.put(e)},this,[e])}})},{}],1656:[function(e,t,i){"use strict";e("./CenterNotice"),e("./GetNotice"),e("./GMNotice"),e("./OperationNotice"),e("./PersonNotice"),e("./NoticeUnitSprite"),e("./NoticeMgr"),e("./WishNotice")},{"./CenterNotice":1647,"./GMNotice":1648,"./GetNotice":1649,"./NoticeMgr":1651,"./NoticeUnitSprite":1652,"./OperationNotice":1653,"./PersonNotice":1654,"./WishNotice":1655}],1657:[function(e,t,i){"use strict";game.Roulette=b8e.Object.extends({runSpeedArray:null,runSpeedIndex:0,posArray_x:null,posArray_y:null,posIndex:0,runIndex:0,stopIndex:0,targetObj:null,runingComplete:null,runComplete:null,_thisArg:null,_timer:null,ctor:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;this._super(),this._thisArg=e,this.runSpeedArray=t,this.posArray_x=i,this.posArray_y=n,this.runingComplete=s,this.runComplete=a},run:function(e,t){this.targetObj=e,this.posIndex=0,this.runIndex=0,this.runSpeedIndex=0,this.stopIndex=t,this.marqueeRun()},marqueeRun:function(){var e;if(!(e=this.runSpeedArray[this.runSpeedIndex]))return this.runComplete&&this.runComplete.call(this._thisArg),this.targetObj.x=this.posArray_x[this.stopIndex],void(null!=this.posArray_y&&0<this.posArray_y.length&&(this.targetObj.y=this.posArray_y[this.stopIndex]));var t=e[0]*e[1]*this.posArray_x.length;this._timer||(this._timer=b8e.Timer.add(this,this.runing,t))},stop:function(){this._timer&&(b8e.Timer.remove(this,this.runing),this._timer=null)},runing:function(){return this.posIndex==this.posArray_x.length&&(this.posIndex=0,this.runIndex++,this.runSpeedIndex<this.runSpeedArray.length&&this.runSpeedArray[this.runSpeedIndex][1]<=this.runIndex)?(this.runIndex=0,this.marqueeRun(),void this.runSpeedIndex++):(this.targetObj.x=this.posArray_x[this.posIndex],null!=this.posArray_y&&0<this.posArray_y.length&&(this.targetObj.y=this.posArray_y[this.posIndex]),this.runSpeedIndex>=this.runSpeedArray.length&&this.runIndex>=this.runSpeedArray[this.runSpeedArray.length-1][1]&&this.stopIndex==this.posIndex+1?(this.posIndex++,this.runingComplete&&this.runingComplete.call(this._thisArg,this.posIndex),this.runComplete&&this.runComplete.call(this._thisArg),void this.stop()):(this.posIndex++,void(this.runingComplete&&this.runingComplete.call(this._thisArg,this.posIndex))))}})},{}],1658:[function(e,t,i){"use strict";game.SpotAlertChildrens={ROLE_ALERT_CHILDRENS:[game.SpotAlertTargetType.MOUNT_ALERT,game.SpotAlertTargetType.WING_ALERT,game.SpotAlertTargetType.FABAO_ALERT,game.SpotAlertTargetType.BEAUTY_ALERT,game.SpotAlertTargetType.SURFACE_ALERT,game.SpotAlertTargetType.XIANDAN_ALERT,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_0,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_1,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_2,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_3,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_4,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_5,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_6,game.SpotAlertTargetType.ROLE_EQUIP_ALERT_7,game.SpotAlertTargetType.REBIRTH_ALERT,game.SpotAlertTargetType.AMULET_ALERT,game.SpotAlertTargetType.XIANZHEN_ALERT],SURFACE_ALERT_CHILDRENS:[game.SpotAlertTargetType.FASHION,game.SpotAlertTargetType.NICKNAME_ALERT],BAG_ALERT_CHILDRENS:[game.SpotAlertTargetType.BAG_CORNUCOPIA_ALERT],SHAPE_ALERT_CHILDRENS:[game.SpotAlertTargetType.BIANSHEN_FETTER_ALERT],EQUIP_ALERT_CHILDRENS:[game.SpotAlertTargetType.EQUIP_INTERSIFY_ALL_ALERT,game.SpotAlertTargetType.EQUIP_UP_STAR_ALERT],RELATION_ALERT_CHILDRENS:[game.SpotAlertTargetType.RELATION_CHAT_ALERT],GUILD_ALERT_CHILDRENS:[game.SpotAlertTargetType.GUILD_OPEN_ALERT,game.SpotAlertTargetType.GUILD_MANAGER,game.SpotAlertTargetType.GUILD_XINFA,game.SpotAlertTargetType.DAILY_TASK,game.SpotAlertTargetType.GUILD_EXP_CURE],SHOP_ALERT_CHILDRENS:[game.SpotAlertTargetType.SHOP_DRAW_ALERT],ROOT_FIGHT_ALERT_CHILDRENDS:[game.SpotAlertTargetType.MATERIAL_ALERT,game.SpotAlertTargetType.ARENA_ALERT,game.SpotAlertTargetType.TOWER_ALERT],ROOT_XIANSHIFIGHT_CHILDRENDS:[game.SpotAlertTargetType.SURA_ALERT,game.SpotAlertTargetType.SANZHANGJIANGJIN_ALERT],ROOT_KUAFUFIGHT_CHILDRENDS:[game.SpotAlertTargetType.CSARENA_ALERT,game.SpotAlertTargetType.ESCORT_ALERT],ROOT_WANFA_CHILDRENDS:[game.SpotAlertTargetType.ROOT_FIGHT_ALERT,game.SpotAlertTargetType.ROOT_XIANSHI_ALERT,game.SpotAlertTargetType.ROOT_KUAFU_ALERT],ROOT_CHALLANGE_CHILDRENDS:[game.SpotAlertTargetType.ROOT_CHALLANGE_TASK_ALERT,game.SpotAlertTargetType.ROOT_CHALLANGE_DAILY_ALERT],ROOT_CHALLANGE_TASK_CHILDRENDS:[game.SpotAlertTargetType.MATERIAL_ALERT,game.SpotAlertTargetType.TOWER_ALERT],ROOT_CHALLANGE_DAILY_CHILDRENDS:[game.SpotAlertTargetType.SANZHANGJIANGJIN_ALERT,game.SpotAlertTargetType.ZHANYAO_ALERT,game.SpotAlertTargetType.CHUMO_ALERT],ROOT_WANFA_TSARENA_CHILDRENDS:[game.SpotAlertTargetType.ARENA_ALERT,game.SpotAlertTargetType.SURA_ALERT,game.SpotAlertTargetType.TIAN_GONG_WORSHIPALERT,game.SpotAlertTargetType.CS_TIAN_GONG_WORSHIPALERT],ROOT_WANFA_CSARENA_CHILDRENDS:[game.SpotAlertTargetType.CSARENA_ALERT,game.SpotAlertTargetType.ESCORT_ALERT],ROOT_WANFA_ARENA_CHILDRENDS:[game.SpotAlertTargetType.ROOT_WANFA_ARENA_THISSERVER_ALERT],ROOT_DAILY_ALERT_CHILDRENDS:[game.SpotAlertTargetType.WORLD_BOSS_ALERT,game.SpotAlertTargetType.NATIONAL_BOSS_ALERT,game.SpotAlertTargetType.NEUTRAL_BOSS_ALERT],ROOT_ACHIEVEMENT_ALERT_CHILDRENDS:[game.SpotAlertTargetType.ACHIEVEMENT_ALERT,game.SpotAlertTargetType.ACHIEVEMENT_PRIZE_ALERT,game.SpotAlertTargetType.MAINQUEST_AWARD_ALERT,game.SpotAlertTargetType.DAILY_TASK],DAILY_TASK_CHILDRENDS:[game.SpotAlertTargetType.GUILD_TASK,game.SpotAlertTargetType.GUILD_ACTIVE],REBIRTH_ALERT_CHILDRENDS:[game.SpotAlertTargetType.REBIRTH_EXP_BUY_ALERT,game.SpotAlertTargetType.REBIRTH_ITEM_BUY_ALERT,game.SpotAlertTargetType.REBIRTH_UPGRADE_ALERT],BAG_CORNUCOPIA_ALERT_CHILDRENDS:[game.SpotAlertTargetType.CORNUCOPIA_GET_PRIZE_ALERT,game.SpotAlertTargetType.CORNUCOPIA_LOG_ALERT],CHAT_ALERT_CHILDRENDS:[game.SpotAlertTargetType.WORLD_CHAT_ALERT,game.SpotAlertTargetType.GUILD_CHAT_ALERT,game.SpotAlertTargetType.SYSTEM_CHAT_ALERT,game.SpotAlertTargetType.CS_CHAT_ALERT],ARENA_ALERT_CHILDRENDS:[game.SpotAlertTargetType.ARENA_FIGHT_ALERT],MOUNT_ALERT_CHILDRENDS:[game.SpotAlertTargetType.MOUNT_SILVER_ALERT,game.SpotAlertTargetType.MOUNT_ITEM_ALERT,game.SpotAlertTargetType.MOUNT_EQUIP_ALERT],WING_ALERT_CHILDRENDS:[game.SpotAlertTargetType.WING_SILVER_ALERT,game.SpotAlertTargetType.WING_ITEM_ALERT],FABAO_ALERT_CHILDRENDS:[game.SpotAlertTargetType.FABAO_SILVER_ALERT,game.SpotAlertTargetType.FABAO_ITEM_ALERT],XIANZHEN_ALERT_CHILDRENDS:[game.SpotAlertTargetType.XIANZHEN_SILVER_ALERT,game.SpotAlertTargetType.XIANZHEN_ITEM_ALERT]}},{}],1659:[function(e,t,i){"use strict";game.SpotAlertEvent=b8e.Enum({SPOT_ALERT_STATE_CHANGE:b8e.Event.nextCode()})},{}],1660:[function(e,t,i){"use strict";game.SpotAlertInfo=b8e.Object.extends({type:0,childrens:null,filter:null,alert:!1,isRoot:!1,thisArg:null,ctor:function(){this._super()},setup:function(e,t,i,n,s){this.type=e,this.childrens=t,this.filter=i,this.isRoot=s,this.thisArg=n}})},{}],1661:[function(e,t,i){"use strict";game.SpotAlertMgr=b8e.Object.extends({_rootMap:null,_rootIndex:0,_spotMap:null,_isInit:!1,_nextRefreshTime:0,REFRESH_CD:200,_timer:null,ctor:function(){if(1==game.SpotAlertMgr._singleton)throw new Error("SpotAlertMgr 只能通过单例方法获取");this._super(),this._rootMap=[],this._spotMap=b8e.HashMap.get(),this._spotMap=b8e.HashMap.get(),this.initRoot()},initRoot:function(){this.addSpotAlert(game.SpotAlertTargetType.ROOT_ROLE_ALERT,game.SpotAlertChildrens.ROLE_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_BAG_ALERT,game.SpotAlertChildrens.BAG_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_SHAPE_ALERT,game.SpotAlertChildrens.SHAPE_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_EQUIP_ALERT,game.SpotAlertChildrens.EQUIP_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_RELATION_ALERT,game.SpotAlertChildrens.RELATION_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_GUILD_ALERT,game.SpotAlertChildrens.GUILD_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_SHOP_ALERT,game.SpotAlertChildrens.SHOP_ALERT_CHILDRENS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_FIGHT_ALERT,game.SpotAlertChildrens.ROOT_FIGHT_ALERT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_DAILY_ALERT,game.SpotAlertChildrens.ROOT_DAILY_ALERT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_ACHIEVEMENT_ALERT,game.SpotAlertChildrens.ROOT_ACHIEVEMENT_ALERT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_CHAT_ALERT,game.SpotAlertChildrens.CHAT_ALERT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_WANFA_ALERT,game.SpotAlertChildrens.ROOT_WANFA_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_XIANSHI_ALERT,game.SpotAlertChildrens.ROOT_XIANSHIFIGHT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_CHALLANGE_TASK_ALERT,game.SpotAlertChildrens.ROOT_CHALLANGE_TASK_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_CHALLANGE_DAILY_ALERT,game.SpotAlertChildrens.ROOT_CHALLANGE_DAILY_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_CHALLANGE_ALERT,game.SpotAlertChildrens.ROOT_CHALLANGE_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_WANFA_ARENA_THISSERVER_ALERT,game.SpotAlertChildrens.ROOT_WANFA_TSARENA_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_WANFA_ARENA_ALERT,game.SpotAlertChildrens.ROOT_WANFA_ARENA_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.ROOT_KUAFU_ALERT,game.SpotAlertChildrens.ROOT_KUAFUFIGHT_CHILDRENDS,null,null,!0),this.addSpotAlert(game.SpotAlertTargetType.DAILY_TASK,game.SpotAlertChildrens.DAILY_TASK_CHILDRENDS,null,null,!0)},initAlert:function(){this._isInit||(this._timer||(this._timer=b8e.Timer.add(this,this._updateSpotAlert,this.REFRESH_CD)),this._timer.reset(),this._timer.start(),this._isInit=!0,game.equip.initSpotAlert(),game.beauty.initSpotAlert(),game.surface.initSpotAlert(),game.xiandan.initSpotAlert(),game.dujie.initSpotAlert(),game.cornucopia.initSpotAlert(),game.relationChat.initSpotAlert(),game.worldBoss.initSpotAlert(),game.sura.initSpotAlert(),game.material.initSpotAlert(),game.guild.initSpotAlert(),game.bianshen.initSpotAlert(),game.shop.initSpotAlert(),game.AchievementMgr.inst().initSpotAlert(),game.nationalBoss.initSpotAlert(),game.rebirth.initSpotAlert(),game.nickName.initSpotAlert(),game.chat.initSpotAlert(),game.arena.initSpotAlert(),game.zhanyao.initSpotAlert(),game.amulet.initSpotAlert(),game.sceneRole.initSpotAlert(),game.tianGong.initSpotAlert(),game.csArena.initSpotAlert(),game.tower.initSpotAlert(),game.escort.initSpotAlert(),game.questAward.initSpotAlert(),this.registeListener())},addSpotAlert:function(e,t,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=this._spotMap.get(e);a?b8e.error("重复注册SpotAlertMgr！"):((a=new game.SpotAlertInfo).setup(e,t,i,n,s),this._spotMap.set(e,a),s&&this._rootMap.push(a))},getSpotAlertState:function(e){var t=this._spotMap.get(e);return!!t&&t.alert},registeListener:function(){},updateCallBack:function(){this._nextRefreshTime>b8e.timeStamp||(this._nextRefreshTime+=this.REFRESH_CD,b8e.Tween.get(this).wait(this.REFRESH_CD).call(this._updateSpotAlert))},_updateSpotAlert:function(){this._rootIndex>=this._rootMap.length&&(this._rootIndex=0);var e=this._rootMap[this._rootIndex];e&&this._updateChildrens(e),this._rootIndex++,b8e.evt.dptG(game.SpotAlertEvent.SPOT_ALERT_STATE_CHANGE)},_update:function(e,t){this._updateChildrens(t)},_updateChildrens:function(e){var t=!1;if(e.childrens)for(var i,n,s=0;s<e.childrens.length;s++)i=e.childrens[s],(n=this._spotMap.get(i))?1==this._updateChildrens(n)&&(t=!0):b8e.warn("注册SpotAlertMgr 类型",i,"没有addSpotAlert处理函数");else if(e.filter){b8e.ClassMgr.objHash,b8e.timeStamp;t=e.thisArg?e.filter.call(e.thisArg):e.filter()}else b8e.warn("注册SpotAlertMgr 类型",e.type,"没有字对象也没有检测方法！");return e.alert=t}}),game.SpotAlertMgr._instance=null,game.SpotAlertMgr._singleton=!0,game.SpotAlertMgr.inst=function(){return null==game.SpotAlertMgr._instance&&(game.SpotAlertMgr._singleton=!1,game.SpotAlertMgr._instance=new game.SpotAlertMgr,game.SpotAlertMgr._singleton=!0),game.SpotAlertMgr._instance}},{}],1662:[function(e,t,i){"use strict";game.SpotAlertTargetType=b8e.Enum({NONE:0,ROOT_ROLE_ALERT:1,ROOT_BAG_ALERT:2,ROOT_SHAPE_ALERT:3,ROOT_EQUIP_ALERT:4,ROOT_RELATION_ALERT:5,ROOT_GUILD_ALERT:6,ROOT_SHOP_ALERT:7,ROOT_FIGHT_ALERT:8,ROOT_DAILY_ALERT:9,ROOT_ACHIEVEMENT_ALERT:11,ROOT_CHAT_ALERT:12,ROOT_VIP_ALERT:13,ROOT_XIANSHI_ALERT:14,ROOT_WANFA_ALERT:15,ROOT_KUAFU_ALERT:16,ROOT_CHALLANGE_TASK_ALERT:17,ROOT_CHALLANGE_DAILY_ALERT:18,ROOT_CHALLANGE_ALERT:19,ROOT_WANFA_ARENA_THISSERVER_ALERT:20,ROOT_WANFA_ARENA_ALERT:22,MOUNT_ALERT:101,WING_ALERT:102,FABAO_ALERT:103,BEAUTY_ALERT:104,SURFACE_ALERT:105,REINCARNATION_ALERT:106,XIANDAN_ALERT:107,NICKNAME_ALERT:108,AMULET_ALERT:109,XIANZHEN_ALERT:110,ROLE_EQUIP_ALERT_0:200,ROLE_EQUIP_ALERT_1:201,ROLE_EQUIP_ALERT_2:202,ROLE_EQUIP_ALERT_3:203,ROLE_EQUIP_ALERT_4:204,ROLE_EQUIP_ALERT_5:205,ROLE_EQUIP_ALERT_6:206,ROLE_EQUIP_ALERT_7:207,FASHION:301,BAG_CORNUCOPIA_ALERT:403,RELATION_CHAT_ALERT:501,GUILD_TASK:601,GUILD_ACTIVE:602,GUILD_MANAGER:603,GUILD_OPEN_ALERT:604,GUILD_SHAOXIAO:605,GUILD_XINFA:606,DAILY_TASK:607,GUILD_GUILDBOSS:608,GUILD_EXP_CURE:609,MATERIAL_ALERT:701,SURA_ALERT:702,WORLD_BOSS_ALERT:801,NATIONAL_BOSS_ALERT:802,NEUTRAL_BOSS_ALERT:803,FIRST_RECHARGE:901,CARD_RECHARGE_ALERT:902,DUJIEI_RECHARGE:903,BIANSHEN_FETTER_ALERT:1004,EQUIP_INTERSIFY_ALL_ALERT:1101,EQUIP_UP_STAR_ALERT:1102,SHOP_DRAW_ALERT:1201,ACHIEVEMENT_ALERT:1301,ACHIEVEMENT_PRIZE_ALERT:1302,CHUMO_ALERT:1303,ZHANYAO_ALERT:1304,MAINQUEST_AWARD_ALERT:1305,REBIRTH_ALERT:1401,REBIRTH_EXP_BUY_ALERT:1402,REBIRTH_ITEM_BUY_ALERT:1403,REBIRTH_UPGRADE_ALERT:1404,CORNUCOPIA_GET_PRIZE_ALERT:1501,CORNUCOPIA_LOG_ALERT:1502,WORLD_CHAT_ALERT:1601,GUILD_CHAT_ALERT:1602,SYSTEM_CHAT_ALERT:1603,CS_CHAT_ALERT:1604,ARENA_ALERT:1701,ARENA_FIGHT_ALERT:1702,CSARENA_ALERT:1703,SANZHANGJIANGJIN_ALERT:1802,MOUNT_SILVER_ALERT:1901,WING_SILVER_ALERT:1902,FABAO_SILVER_ALERT:1903,MOUNT_ITEM_ALERT:1904,WING_ITEM_ALERT:1905,FABAO_ITEM_ALERT:1906,XIANZHEN_SILVER_ALERT:1907,XIANZHEN_ITEM_ALERT:1908,MOUNT_EQUIP_ALERT:1909,TIAN_GONG_WORSHIPALERT:2001,CS_TIAN_GONG_WORSHIPALERT:2002,TOWER_ALERT:2102,ESCORT_ALERT:2103})},{}],1663:[function(e,t,i){"use strict";e("./SpotAlertTargetType"),e("./SpotAlertChildrens"),e("./SpotAlertInfo"),e("./SpotAlertMgr"),e("./SpotAlertTargetType")},{"./SpotAlertChildrens":1658,"./SpotAlertInfo":1660,"./SpotAlertMgr":1661,"./SpotAlertTargetType":1662}],1664:[function(e,t,i){"use strict";e("./menu/menuIndex"),e("./ImageURLUtil"),e("./ItemInfoUtil"),e("./ReqLockUtil"),e("./ResControllerMgr"),e("./ShortNameMgr"),e("./ColorEnum"),e("./HtmlUtil"),e("./ValueUtil"),e("./bounce/bounceIndex_0"),e("./notice/noticeIndex_2"),e("./RFormat"),e("./UpgradeUtil"),e("./TimeData"),e("./componets/componetsIndex_0"),e("./CCommonUtil"),e("./EffectUtil"),e("./GridUtil"),e("./spotAlert/spotAlertIndex"),e("./collect/collectindex"),e("./RichTextUtil"),e("./ShieldEnum"),e("./ShieldMgr")},{"./CCommonUtil":1606,"./ColorEnum":1607,"./EffectUtil":1608,"./GridUtil":1609,"./HtmlUtil":1610,"./ImageURLUtil":1611,"./ItemInfoUtil":1612,"./RFormat":1613,"./ReqLockUtil":1614,"./ResControllerMgr":1615,"./RichTextUtil":1616,"./ShieldEnum":1617,"./ShieldMgr":1618,"./ShortNameMgr":1619,"./TimeData":1620,"./UpgradeUtil":1622,"./ValueUtil":1623,"./bounce/bounceIndex_0":1628,"./collect/collectindex":1632,"./componets/componetsIndex_0":1634,"./menu/menuIndex":1646,"./notice/noticeIndex_2":1656,"./spotAlert/spotAlertIndex":1663}],1665:[function(e,t,i){"use strict";e("./ModuleMain")},{"./ModuleMain":1}]},{},[1665,2,1060,1058,1059,1062,1061,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,4,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,41,42,43,44,45,46,47,48,49,50,101,99,100,5,6,7,8,9,10,11,102,103,104,105,106,107,108,109,110,111,112,123,113,114,115,116,117,118,119,120,121,122,124,125,126,127,128,129,130,131,132,133,134,135,136,137,139,138,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,166,167,168,169,170,171,172,173,174,175,176,177,178,179,164,180,181,182,183,184,185,165,186,187,188,191,189,190,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,232,231,233,234,235,236,237,238,239,240,241,242,243,245,244,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,267,266,269,268,270,272,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,310,309,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,334,331,332,333,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,375,374,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,395,394,396,397,398,399,401,400,411,412,413,415,414,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,452,437,440,438,439,441,442,443,444,445,446,447,448,449,450,451,453,454,402,403,404,405,406,407,408,409,410,455,456,457,458,459,460,461,462,464,463,466,465,467,468,469,470,471,472,473,474,475,477,476,479,478,480,481,482,483,484,485,486,487,488,489,490,492,491,493,494,495,496,497,498,499,500,501,502,503,504,505,512,506,507,508,509,510,511,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,531,530,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,561,559,560,562,563,564,565,566,567,568,569,570,571,572,573,574,575,577,576,578,579,580,581,582,583,584,585,586,587,588,589,591,592,593,590,594,595,596,597,598,599,600,602,601,603,605,604,607,606,610,608,609,611,612,613,615,614,617,616,619,618,621,620,622,623,624,625,627,626,628,630,629,632,631,634,633,636,635,640,637,638,639,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,682,681,684,683,686,685,687,688,689,690,692,691,694,693,696,695,697,703,700,701,702,704,698,699,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,745,746,744,747,749,748,752,750,751,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,781,783,782,779,780,784,785,786,788,787,792,789,790,791,795,793,794,797,796,802,798,799,800,801,803,804,805,807,806,809,808,811,810,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,845,844,847,846,849,848,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,876,875,877,878,879,880,881,882,883,884,885,889,886,887,888,890,891,892,893,894,896,895,897,898,899,900,901,902,903,904,905,907,906,908,909,910,911,912,913,914,915,916,917,918,920,919,921,923,922,924,925,926,927,928,930,929,931,932,933,934,935,936,939,937,938,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,961,959,960,962,965,963,964,968,966,967,971,969,970,972,973,974,975,992,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,993,995,994,996,998,997,999,1001,1e3,1002,1013,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1014,1015,1016,1017,1018,1019,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1049,1048,1050,1051,1052,1053,1054,1055,1056,1057,1074,1075,1078,1076,1077,1079,1080,1081,1082,1083,1087,1084,1085,1086,1096,1097,1098,1099,1100,1102,1103,1104,1105,1106,1101,1107,1108,1090,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1091,1092,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180,1181,1093,1182,1183,1184,1185,1186,1094,1095,1187,1188,1189,1190,1191,1194,1192,1193,1195,1196,1197,1198,1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1088,1221,1089,1222,1223,1224,1225,1241,1226,1227,1228,1229,1230,1231,1233,1232,1234,1235,1236,1237,1238,1239,1240,1242,1247,1243,1244,1245,1246,1248,1249,1250,1259,1251,1252,1253,1254,1255,1256,1257,1258,3,1261,1262,1260,1263,1264,1270,1265,1266,1267,1268,1269,1271,1273,1272,1274,1275,1276,1277,1278,1290,1279,1283,1280,1281,1282,1284,1285,1286,1287,1288,1289,1291,1295,1292,1293,1294,1296,1297,1300,1298,1299,1304,1301,1302,1303,1309,1305,1306,1307,1308,1310,1312,1311,1313,1314,1317,1315,1316,1319,1318,1320,1322,1321,1323,1324,1325,1327,1326,1328,1329,1334,1330,1331,1332,1333,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344,1345,1346,1347,1348,1360,1349,1350,1351,1352,1353,1354,1355,1356,1357,1358,1359,1361,1362,1365,1371,1366,1367,1368,1369,1370,1363,1372,1364,1373,1374,1378,1375,1376,1377,1381,1379,1380,1383,1382,1384,1385,1386,1389,1387,1388,1390,1391,1392,1394,1393,1395,1396,1397,1399,1400,1398,1401,1402,1403,1404,1405,1408,1406,1407,1409,1411,1410,1412,1414,1413,1415,1416,1417,1418,1419,1420,1423,1421,1422,1426,1424,1425,1427,1428,1429,1430,1431,1432,1433,1434,1435,1436,1437,1438,1439,1440,1444,1441,1442,1443,1445,1446,1447,1448,1449,1452,1450,1451,1454,1453,1455,1456,1457,1459,1458,1460,1461,1462,1463,1464,1465,1466,1468,1467,1469,1471,1470,1487,1472,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,1484,1485,1486,1488,1490,1489,1491,1492,1493,1494,1499,1495,1496,1497,1498,1500,1501,1502,1503,1506,1504,1505,1507,1508,1509,1510,1511,1512,1514,1513,1515,1516,1518,1517,1519,1520,1525,1521,1522,1523,1524,1526,1527,1528,1529,1530,1531,1532,1533,1534,1535,1536,1537,1538,1539,1540,1541,1542,1543,1544,1545,1562,1572,1563,1564,1565,1566,1567,1568,1569,1570,1571,1553,1554,1555,1556,1557,1573,1574,1558,1575,1559,1560,1561,1576,1577,1600,1601,1602,1603,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1604,1594,1595,1596,1597,1598,1599,1605,1546,1547,1548,1549,1550,1551,1552,1624,1625,1626,1627,1628,1606,1629,1630,1632,1631,1607,1634,1633,1635,1636,1637,1608,1609,1610,1611,1612,1638,1639,1640,1646,1641,1642,1643,1644,1645,1647,1649,1648,1650,1656,1651,1652,1653,1654,1655,1614,1615,1613,1616,1657,1617,1618,1619,1658,1659,1663,1660,1661,1662,1620,1621,1622,1664,1623,1]);