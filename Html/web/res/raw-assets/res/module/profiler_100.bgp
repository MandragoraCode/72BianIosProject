!function o(a,r,h){function c(s,t){if(!r[s]){if(!a[s]){var e="function"==typeof $require&&$require;if(!t&&e)return e(s,!0);if(l)return l(s,!0);var i=new Error("Cannot find module '"+s+"'");throw i.code="MODULE_NOT_FOUND",i}var n=r[s]={exports:{}};a[s][0].call(n.exports,function(t){var e=a[s][1][t];return c(e||t)},n,n.exports,o,a,r,h)}return r[s].exports}for(var l="function"==typeof $require&&$require,t=0;t<h.length;t++)c(h[t]);return c}({1:[function(t,e,s){"use strict";t("./src/com/black8/sunny/engine_profiler/SEngineProfiler")},{"./src/com/black8/sunny/engine_profiler/SEngineProfiler":2}],2:[function(t,e,s){"use strict";t("./profiler/SStats"),t("./profiler/SDebugUI"),t("./profiler/SBaseProfiler"),t("./profiler/SDomProfiler"),t("./profiler/SCanvasStats"),t("./profiler/SCanvasProfiler"),b8e.EngineProfiler=function(){},b8e.EngineProfiler.init=function(){b8e.profiler||(CC_JSB||b8e.isWeChatGame,b8e.profiler=new b8e.DomProfiler,b8e.profiler.ERROR_CAUTION=b8e.profiler.WARN_CAUTION=null==game.debugType||2!=game.debugType,b8e.profiler.addTestItem("Cost",function(t){b8e.profiler.clearLog(),b8e.log(b8e.ClassMgr.dumpInfo())},this),b8e.profiler.addTestItem("Txt",function(t){b8e.profiler.clearLog(),b8e.log(b8e.TextureCache.dumpInfo())},this))}},{"./profiler/SBaseProfiler":3,"./profiler/SCanvasProfiler":4,"./profiler/SCanvasStats":5,"./profiler/SDebugUI":6,"./profiler/SDomProfiler":7,"./profiler/SStats":8}],3:[function(t,e,s){"use strict";b8e.BaseProfiler=b8e.Object.extends({_inited:!1,_isShow:!1,_fpsStats:null,_capabilityWatchs:null,_testItems:null,_isShowCtrl:!1,_rootElem:null,_ctrlElem:null,_fpsStatsElem:null,_showFPS:!1,_logMsg:null,_infoMsg:null,_warnMsg:null,_errorMsg:null,_resMsg:null,ctor:function(){this._super(),this._testItems=[],this._logMsg=[],this._infoMsg=[],this._warnMsg=[],this._errorMsg=[],this._resMsg=[]},addTestItem:function(t,e,s){var i={label:t,handler:e,thisArg:s};this._testItems.push(i)},isShow:function(){return this._isShow},show:function(){this._isShow||(this._isShow=!0,this._inited||(this._inited=!0,this.init()),cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),cc.director.on(cc.Director.EVENT_AFTER_VISIT,this.afterVisit,this),cc.director.on(cc.Director.EVENT_AFTER_DRAW,this.afterDraw,this),this.onShow())},hide:function(){this._isShow&&(this._isShow=!1,cc.director.off(cc.Director.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),cc.director.off(cc.Director.EVENT_AFTER_VISIT,this.afterVisit,this),cc.director.off(cc.Director.EVENT_AFTER_DRAW,this.afterDraw,this),this.onHide())},onShow:function(){},onHide:function(){this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel()},showFpsStats:function(){this._showFPS||(this._showFPS=!0,this.onShowFpsStats())},hideFpsStats:function(){this._showFPS&&(this._showFPS=!1,this.onHideFpsStats())},onShowFpsStats:function(){this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel()},onHideFpsStats:function(){},init:function(){this._capabilityWatchs={fps:{desc:"Framerate (FPS)",below:20,average:500},frameTime:{desc:"Frame Time (ms)",min:0,max:50,over:18,average:500},draws:{desc:"Draw Call"},logic:{desc:"Game Logic (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"Renderer (ms)",min:0,max:50,average:500,color:"#f90"},memoryUsed:{desc:"Used Memory",extension:"memory.used",average:1e3,threshold:!0},memoryTotal:{desc:"Total Memory",extension:"memory.total",average:1e3,threshold:!0},memoryLimit:{desc:"Limit Memory",extension:"memory.limit",average:1e3,threshold:!0},costFrame:{desc:"Cost Frame (ms)"},textureCount:{desc:"Texture Count"},textureMemory:{desc:"Texture Memory (MB)",over:1e-6*b8e.TextureCache.MAX_MEMORY},raf:{desc:"Raf Time (ms)",average:100}},this.initView(),this._showOpenButton()},initView:function(){},_showOpenButton:function(){},beforeUpdate:function(){this._showFPS&&this._fpsStats&&(this._fpsStats("frameTime").start(),this._fpsStats("logic").start())},afterVisit:function(){this._showFPS&&this._fpsStats&&(cc.director.isPaused()?this._fpsStats("frameTime").start():this._fpsStats("logic").end(),this._fpsStats("render").start(),this._fpsStats("memoryUsed").snapshot(),this._fpsStats("memoryTotal").snapshot(),this._fpsStats("memoryLimit").snapshot())},afterDraw:function(){if(this._showFPS&&this._fpsStats&&(this._fpsStats("render").end(),this._fpsStats("draws").value=cc.g_NumberOfDraws,this._fpsStats("raf").tick(),this._fpsStats("fps").frame(),this._fpsStats("frameTime").end(),this._fpsStats("costFrame").value=b8e.ticker.getCostFrame()+"/"+b8e.ticker.getMaxCostFrame(),this._fpsStats("textureCount").value=b8e.TextureCache.getCounter(),this._fpsStats("textureMemory").value=Math.round(1e-4*b8e.TextureCache.getTotalBytes())/100,this._fpsStats().tick()),this._showWatch&&this._watchStats){var t=b8e.NetMgr.getMgr("main"),e=b8e.SceneMgr.inst().getScene("main"),s=e?e.getMapLayer().getEarthSurface()._startTileX:null,i=e?e.getMapLayer().getEarthSurface()._endTileX:null,n=e?e.getMapLayer().getEarthSurface()._startTileY:null,o=e?e.getMapLayer().getEarthSurface()._endTileY:null;this._watchStats("runTime").value=b8e.TimeUtil.formatTime(b8e.timeStamp),this._watchStats("serverTime").value=b8e.TimeUtil.formatTimestamp(b8e.startup.getServerTime()),this._watchStats("ping").value=b8e.startup.getPing(),this._watchStats("framerate").value=b8e.Ticker.getFps()+"/"+b8e.Ticker.getBackFps()+"/"+b8e.frameRate,this._watchStats("tileCount").value=e?e.tileRenderCount+"/"+e.tileCount+"/"+s+","+i+","+n+","+o:"",this._watchStats("resCount").value=b8e.res.resCount+"/"+b8e.res.cacheCount,this._watchStats("netIo").value=b8e.StringUtil.bytesToSize(t.getInputTotalbytes())+"/"+b8e.StringUtil.bytesToSize(t.getOutputTotalbytes())+"/"+t.maxFrameReceiveCount,this._watchStats("displayCount").value=b8e.BaseDisplay.inHierarchyCount+"/"+b8e.BaseDisplay.count,this._watchStats("tickerCount").value=b8e.Ticker.getCount(0)+"/"+b8e.Ticker.getCount(1)+"/"+b8e.Ticker.getCount(2),this._watchStats("timerCount").value=b8e.Timer?b8e.Timer.getCount(0)+"/"+b8e.Timer.getCount(1)+"/"+b8e.Timer.getCount(2):"0/0/0",this._watchStats("tweenCount").value=b8e.Tween?b8e.Tween.getCount()+"/"+b8e.Tween.pool.count:"0/0",this._watchStats("shaderCount").value=b8e.ShaderProgram?b8e.ShaderProgram.getCount():0,this._watchStats("glProgramCount").value=cc.GLProgram.count,this._watchStats("sceneDisplay").value=e?e.entityRenderCount+"/"+e.entityCount:"",this._watchStats("bufferCount").value=b8e.ByteBuffer.count+"/"+b8e.ByteBuffer.pool.count,this._watchStats("instCount").value=b8e.ClassMgr.objHash+"/"+b8e.ClassMgr.instHash,this._watchStats("clsCount").value=b8e.ClassMgr.clsHash,this._watchStats("funcCount").value=b8e.ClassMgr.funcHash,this._watchStats("stageSize").value=b8e.stageWidth+"*"+b8e.stageHeight,this._watchs.forEach(function(t){this._watchStats(t.label).value=t.getter.call(t.thisArg)},this),this._watchStats().tick()}},addLog:function(){var t=Array.prototype.slice.call(arguments).join(" ");t="LOG:"+t,this._logMsg.push(t),this._showInfo&&0==this._currInfoType&&this.updateInfo(this._logMsg)},clearLog:function(){this._logMsg.length=0,this._showInfo&&0==this._currInfoType&&this.updateInfo(this._logMsg)},addInfo:function(){var t=Array.prototype.slice.call(arguments).join(" ");t="INFO:"+t,-1<this._infoMsg.indexOf(t)||(this._infoMsg.push(t),this._showInfo&&1==this._currInfoType&&this.updateInfo(this._infoMsg))},addWarn:function(){var t=Array.prototype.slice.call(arguments).join(" ");300<t.length&&(t=t.substr(0,300)+"..."),t="WARN:"+t,-1<this._warnMsg.indexOf(t)||(this._warnMsg.push(t),this._showInfo&&2==this._currInfoType&&this.updateInfo(this._warnMsg),b8e.macro.IS_DEBUG&&this.WARN_CAUTION&&b8e.Toast.launch("运行时警告，请调试检查！",4294967040,3600,1))},addError:function(){var t=Array.prototype.slice.call(arguments).join(" ");300<t.length&&(t=t.substr(0,300)+"..."),t="ERROR:"+t,-1<this._errorMsg.indexOf(t)||(this._errorMsg.push(t),this._showInfo&&3==this._currInfoType&&this.updateInfo(this._errorMsg),b8e.macro.IS_DEBUG&&this.ERROR_CAUTION&&b8e.Toast.launch("运行时错误，请调试检查！",4294901760,3600,1))},addRes:function(){var t=Array.prototype.slice.call(arguments).join(" ");t="RES:"+t,this._resMsg.push(t),this._showInfo&&4==this._currInfoType&&this.updateInfo(this._resMsg)},updateInfo:function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1]}})},{}],4:[function(t,e,s){"use strict";b8e.CanvasProfiler=b8e.BaseProfiler.extends({ctor:function(){this._super()},initView:function(){this._super(),this._rootElem=new b8e.BaseDisplay.get,b8e.stage.addChild(this._rootElem),this._ctrlElem=new b8e.BaseDisplay.get;var t=new b8e.CanvasStats;t.setPosition(10,40),this._fpsStatsElem=t,this._fpsStats=t.init(this._capabilityWatchs);var e=new n("性能");e.setLocalZOrder(999999999),this._ctrlElem.addChild(e),e.setPosition(30,10),b8e.evt.onC(e,this.onClickFpsStats,this)},onShow:function(){this._super(),b8e.stage.addChild(this._rootElem)},onHide:function(){this._rootElem.removeFromParent()},_showOpenButton:function(){var t=new i("P");t.setLocalZOrder(999999999),b8e.stage.addChild(t),t.setPosition(10,10),b8e.evt.onC(t,this.onClickProfiler,this)},onShowFpsStats:function(){this._super(),this._rootElem.addChild(this._fpsStatsElem),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel()},onHideFpsStats:function(){this._super(),this._fpsStatsElem.removeFromParent()},onClickProfiler:function(t){this._isShowCtrl?(self._rootElem.remove(self._ctrlElem),this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea(),this.hideCtrlPanel(),this._isShowCtrl=!1):(this._rootElem.addChild(this._ctrlElem),this.showFpsStats(),this._isShowCtrl=!0)},onClickFpsStats:function(t){this.showFpsStats()}});var i=b8e.BaseDisplay.extends({_bg:null,ctor:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Button";this._super();var e=b8e.Label.get();e.setText(t),e.setFontSize(14),e.setColor(4294967295);var s=b8e.Graphics.get();s.setSize(e.width+5,e.height+5),s.fillColor(4281545523),s.fillRect(0,0,s.width,s.height),s.lineWidth(1),s.strokeColor(4294967295),s.stroke(),s.setPosition(0,0),this._bg=s,e.setPosition(.5*(s.width-e.width),.5*(s.height-e.height)),this.addChild(s),this.addChild(e),this.setSize(s.width,s.height)}}),n=i.extends({_isChecked:!1,ctor:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Button";this._super(t),b8e.evt.onC(b,this.onClick,this)},onClick:function(t){this._isChecked=!this._isChecked;var e=this._bg;e.clear(),e.fillColor(this._isChecked?4294967295:4281545523),e.fillRect(0,0,e.width,e.height),e.lineWidth(1),e.strokeColor(4294967295),e.stroke()},isChecked:{get:function(){return this._isChecked}}})},{}],5:[function(t,e,s){"use strict";b8e.CanvasStats=b8e.BaseDisplay.extends({_bg:null,_watchs:null,_itemByKey:null,ctor:function(){this._super();var t=b8e.Graphics.get();this.addChild(t),this._bg=t,this._itemByKey={}},init:function(t){this._watchs=t;var e=this._bg,s=0;for(var i in t){var n=this._watchs[i],o=new a(n.desc);this.addChild(o),o.setPosition(5,s+10),s+=o.height+5,e.moveTo(5,s-o.height+3),e.lineTo(255,s-o.height+3),this._itemByKey[i]=o}e.setSize(260,s+10),e.fillColor(4281545523),e.fillRect(0,0,e.width,e.height),e.lineWidth(1),e.strokeColor(4284900966),e.stroke(),e.setPosition(0,0)},tick:function(){for(var t in this._watchs){var e=this._itemByKey[t],s=this._watchs[t];e.setValue(s.getter.call(s.thisArg))}}});var a=b8e.BaseDisplay.extends({_maxWidth:250,_vl:null,ctor:function(t){this._super();var e=b8e.Label.get();e.setFontSize(14),e.setColor(4294967295),this.addChild(e),e.setPosition(0,0),e.setText(t);var s=b8e.Label.get();s.setFontSize(14),s.setColor(4294967295),this.addChild(s),this._vl=s,this.setSize(this._maxWidth,e.height),this.setValue("")},setValue:function(t){var e=e=this._vl;e.setText(t),e.setPosition(this._maxWidth-e.width,0)}})},{}],6:[function(t,e,s){"use strict";var u=b8e.DebugUI={};u.Element=function(t){this.dom=t},u.Element.prototype={add:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];e instanceof u.Element?this.dom.appendChild(e.dom):b8e.error("UI.Element:",e,"is not an instance of UI.Element.")}return this},remove:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];e instanceof u.Element?e.dom.parentElement===this.dom&&this.dom.removeChild(e.dom):b8e.error("UI.Element:",e,"is not an instance of UI.Element.")}return this},clear:function(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild)},setId:function(t){return this.dom.id=t,this},setClass:function(t){return this.dom.className=t,this},setStyle:function(t,e){for(var s=0;s<e.length;s++)this.dom.style[t]=e[s];return this},setDisabled:function(t){return this.dom.disabled=t,this},setTextContent:function(t){return this.dom.textContent=t,this},addEventListener:function(t,e){this.dom.addEventListener(t,e,!1)},removeEventListener:function(t,e){this.dom.removeEventListener(t,e)}};["position","left","top","right","bottom","width","height","display","overflow","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","background","backgroundColor","opacity","verticalAlign","fontSize","fontWeight","textAlign","textDecoration","textTransform","cursor","zIndex"].forEach(function(t){var e="set"+t.substr(0,1).toUpperCase()+t.substr(1,t.length);u.Element.prototype[e]=function(){return this.setStyle(t,arguments),this}});["KeyUp","KeyDown","MouseOver","MouseOut","Click","DblClick","Change"].forEach(function(e){var t="on"+e;u.Element.prototype[t]=function(t){return this.dom.addEventListener(e.toLowerCase(),t.bind(this),!1),this}}),u.Span=function(){return u.Element.call(this),this.dom=document.createElement("span"),this},u.Span.prototype=Object.create(u.Element.prototype),u.Span.prototype.constructor=u.Span,u.Div=function(){return u.Element.call(this),this.dom=document.createElement("div"),this},u.Div.prototype=Object.create(u.Element.prototype),u.Div.prototype.constructor=u.Div,u.Row=function(){u.Element.call(this);var t=document.createElement("div");return t.className="Row",this.dom=t,this},u.Row.prototype=Object.create(u.Element.prototype),u.Row.prototype.constructor=u.Row,u.Panel=function(){u.Element.call(this);var t=document.createElement("div");return t.className="Panel",this.dom=t,this},u.Panel.prototype=Object.create(u.Element.prototype),u.Panel.prototype.constructor=u.Panel,u.Text=function(t){u.Element.call(this);var e=document.createElement("span");return e.className="Text",e.style.cursor="default",e.style.display="inline-block",e.style.textAlign="left",e.style.fontSize="12px",e.style.width="50px",this.dom=e,this.setValue(t),this},u.Text.prototype=Object.create(u.Element.prototype),u.Text.prototype.constructor=u.Text,u.Text.prototype.getValue=function(){return this.dom.textContent},u.Text.prototype.setValue=function(t){return void 0!==t&&(this.dom.textContent=t),this},u.Input=function(t){u.Element.call(this);var e=document.createElement("input");return e.className="Input",e.style.padding="2px",e.style.border="1px solid transparent",e.addEventListener("keydown",function(t){t.stopPropagation()},!1),this.dom=e,this.setValue(t),this},u.Input.prototype=Object.create(u.Element.prototype),u.Input.prototype.constructor=u.Input,u.Input.prototype.getValue=function(){return this.dom.value},u.Input.prototype.setValue=function(t){return this.dom.value=t,this},u.TextArea=function(){u.Element.call(this);var s=document.createElement("textarea");return s.className="TextArea",s.style.padding="2px",s.spellcheck=!1,s.addEventListener("keydown",function(t){if(t.stopPropagation(),9===t.keyCode){t.preventDefault();var e=s.selectionStart;s.value=s.value.substring(0,e)+"\t"+s.value.substring(e),s.selectionStart=e+1,s.selectionEnd=s.selectionStart}},!1),this.dom=s,this},u.TextArea.prototype=Object.create(u.Element.prototype),u.TextArea.prototype.constructor=u.TextArea,u.TextArea.prototype.getValue=function(){return this.dom.value},u.TextArea.prototype.setValue=function(t){return this.dom.value=t,this},u.TextArea.prototype.setReadOnly=function(t){return this.dom.readOnly=t,this},u.TextArea.prototype.setResize=function(t){return this.dom.style.resize=t,this},u.Select=function(){u.Element.call(this);var t=document.createElement("select");return t.className="Select",t.style.padding="2px",this.dom=t,this},u.Select.prototype=Object.create(u.Element.prototype),u.Select.prototype.constructor=u.Select,u.Select.prototype.setMultiple=function(t){return this.dom.multiple=t,this},u.Select.prototype.setOptions=function(t){for(var e=this.dom.value;0<this.dom.children.length;)this.dom.removeChild(this.dom.firstChild);for(var s in t){var i=document.createElement("option");i.value=s,i.innerHTML=t[s],this.dom.appendChild(i)}return this.dom.value=e,this},u.Select.prototype.getValue=function(){return this.dom.value},u.Select.prototype.setValue=function(t){return t=String(t),this.dom.value!==t&&(this.dom.value=t),this},u.Checkbox=function(t){u.Element.call(this);var e=document.createElement("input");return e.className="Checkbox",e.type="checkbox",this.dom=e,this.setValue(t),this},u.Checkbox.prototype=Object.create(u.Element.prototype),u.Checkbox.prototype.constructor=u.Checkbox,u.Checkbox.prototype.getValue=function(){return this.dom.checked},u.Checkbox.prototype.setValue=function(t){return void 0!==t&&(this.dom.checked=t),this},u.Color=function(){u.Element.call(this);var t=document.createElement("input");t.className="Color",t.style.width="64px",t.style.height="17px",t.style.border="0px",t.style.padding="2px",t.style.backgroundColor="transparent";try{t.type="color",t.value="#ffffff"}catch(t){}return this.dom=t,this},u.Color.prototype=Object.create(u.Element.prototype),u.Color.prototype.constructor=u.Color,u.Color.prototype.getValue=function(){return this.dom.value},u.Color.prototype.getHexValue=function(){return parseInt(this.dom.value.substr(1),16)},u.Color.prototype.setValue=function(t){return this.dom.value=t,this},u.Color.prototype.setHexValue=function(t){return this.dom.value="#"+("000000"+t.toString(16)).slice(-6),this},u.Number=function(t){u.Element.call(this);var i=this,n=document.createElement("input");n.className="Number",n.value="0.00",n.addEventListener("keydown",function(t){t.stopPropagation(),13===t.keyCode&&n.blur()},!1),this.value=0,this.min=-1/0,this.max=1/0,this.precision=2,this.step=1,this.unit="",this.dom=n,this.setValue(t);var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!0);var a=0,r=0,h=[0,0],c=[0,0];function e(t){var e=i.value;h=[t.clientX,t.clientY],a+=h[0]-c[0]-(h[1]-c[1]);var s=r+a/(t.shiftKey?5:50)*i.step;e!==(s=Math.min(i.max,Math.max(i.min,s)))&&(i.setValue(s),n.dispatchEvent(o)),c=[t.clientX,t.clientY]}function s(t){document.removeEventListener("mousemove",e,!1),document.removeEventListener("mouseup",s,!1),Math.abs(a)<2&&(n.focus(),n.select())}function l(t){n.style.backgroundColor="transparent",n.style.cursor="col-resize"}return l(),n.addEventListener("mousedown",function(t){t.preventDefault(),a=0,r=i.value,c=[t.clientX,t.clientY],document.addEventListener("mousemove",e,!1),document.addEventListener("mouseup",s,!1)},!1),n.addEventListener("change",function(t){i.setValue(n.value)},!1),n.addEventListener("focus",function(t){n.style.backgroundColor="",n.style.cursor=""},!1),n.addEventListener("blur",l,!1),this},u.Number.prototype=Object.create(u.Element.prototype),u.Number.prototype.constructor=u.Number,u.Number.prototype.getValue=function(){return this.value},u.Number.prototype.setValue=function(t){return void 0!==t&&((t=parseFloat(t))<this.min&&(t=this.min),t>this.max&&(t=this.max),this.value=t,this.dom.value=t.toFixed(this.precision),""!==this.unit&&(this.dom.value+=" "+this.unit)),this},u.Number.prototype.setPrecision=function(t){return this.precision=t,this},u.Number.prototype.setStep=function(t){return this.step=t,this},u.Number.prototype.setRange=function(t,e){return this.min=t,this.max=e,this},u.Number.prototype.setUnit=function(t){return this.unit=t,this},u.Integer=function(t){u.Element.call(this);var i=this,n=document.createElement("input");n.className="Number",n.value="0",n.addEventListener("keydown",function(t){t.stopPropagation()},!1),this.value=0,this.min=-1/0,this.max=1/0,this.step=1,this.dom=n,this.setValue(t);var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!0);var a=0,r=0,h=[0,0],c=[0,0];function e(t){var e=i.value;h=[t.clientX,t.clientY],a+=h[0]-c[0]-(h[1]-c[1]);var s=r+a/(t.shiftKey?5:50)*i.step;e!==(s=0|Math.min(i.max,Math.max(i.min,s)))&&(i.setValue(s),n.dispatchEvent(o)),c=[t.clientX,t.clientY]}function s(t){document.removeEventListener("mousemove",e,!1),document.removeEventListener("mouseup",s,!1),Math.abs(a)<2&&(n.focus(),n.select())}function l(t){n.style.backgroundColor="transparent",n.style.cursor="col-resize"}return l(),n.addEventListener("mousedown",function(t){t.preventDefault(),a=0,r=i.value,c=[t.clientX,t.clientY],document.addEventListener("mousemove",e,!1),document.addEventListener("mouseup",s,!1)},!1),n.addEventListener("change",function(t){i.setValue(n.value)},!1),n.addEventListener("focus",function(t){n.style.backgroundColor="",n.style.cursor=""},!1),n.addEventListener("blur",l,!1),this},u.Integer.prototype=Object.create(u.Element.prototype),u.Integer.prototype.constructor=u.Integer,u.Integer.prototype.getValue=function(){return this.value},u.Integer.prototype.setValue=function(t){return void 0!==t&&(t=parseInt(t),this.value=t,this.dom.value=t),this},u.Integer.prototype.setStep=function(t){return this.step=parseInt(t),this},u.Integer.prototype.setRange=function(t,e){return this.min=t,this.max=e,this},u.Break=function(){u.Element.call(this);var t=document.createElement("br");return t.className="Break",this.dom=t,this},u.Break.prototype=Object.create(u.Element.prototype),u.Break.prototype.constructor=u.Break,u.HorizontalRule=function(){u.Element.call(this);var t=document.createElement("hr");return t.className="HorizontalRule",this.dom=t,this},u.HorizontalRule.prototype=Object.create(u.Element.prototype),u.HorizontalRule.prototype.constructor=u.HorizontalRule,u.Button=function(t){u.Element.call(this);var e=document.createElement("button");return e.className="Button",this.dom=e,this.dom.textContent=t,this},u.Button.prototype=Object.create(u.Element.prototype),u.Button.prototype.constructor=u.Button,u.Button.prototype.setLabel=function(t){return this.dom.textContent=t,this},u.Modal=function(t){var e=this,s=document.createElement("div");return s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.backgroundColor="rgba(0,0,0,0.5)",s.style.display="none",s.style.alignItems="center",s.style.justifyContent="center",s.addEventListener("click",function(t){e.hide()}),this.dom=s,this.container=new u.Panel,this.container.dom.style.width="200px",this.container.dom.style.padding="20px",this.container.dom.style.backgroundColor="#ffffff",this.container.dom.style.boxShadow="0px 5px 10px rgba(0,0,0,0.5)",this.add(this.container),this},u.Modal.prototype=Object.create(u.Element.prototype),u.Modal.prototype.constructor=u.Modal,u.Modal.prototype.show=function(t){return this.container.clear(),this.container.add(t),this.dom.style.display="flex",this},u.Modal.prototype.hide=function(){return this.dom.style.display="none",this}},{}],7:[function(t,e,s){"use strict";b8e.DomProfiler=b8e.BaseProfiler.extends({ERROR_CAUTION:!0,WARN_CAUTION:!0,_showWatch:!1,_showInfo:!1,_bodyElem:null,_fpsStatsDiv:null,_watchStatsElem:null,_watchStatsDiv:null,_watchStats:null,_watchs:null,_openFpsStatsCheck:null,_openWatchStatsCheck:null,_openCtrlPanelCheck:null,_activateCheck:null,_useImgCheck:null,_cacheCheck:null,_guiCheck:null,_sceneCheck:null,_tickCheck:null,_tweenCheck:null,_areaChecks:null,_fpsInput:null,_fpsButton:null,_gcButton:null,_closeButton:null,_resetButton:null,_openButton:null,_msgElem:null,_ctrlPanel:null,_msgArea:null,_currInfoType:0,_widthInput:null,_heightInput:null,_resizeButton:null,ctor:function(){this._super(),this._watchs=[],this._areaChecks=[]},addWatch:function(t,e,s,i){this._watchs.push({label:t,desc:e,getter:s,thisArg:i})},onShow:function(){this._super(),this._bodyElem.add(this._rootElem)},onHide:function(){this._super(),this._bodyElem.remove(this._rootElem)},onHideFpsStats:function(){this._super(),this._fpsStatsDiv&&this._fpsStatsDiv.parentElement===this._fpsStatsElem.dom&&this._fpsStatsElem.dom.removeChild(this._fpsStatsDiv),this._openFpsStatsCheck&&this._openFpsStatsCheck.setChecked(!1)},onShowFpsStats:function(){this._super(),null===this._fpsStatsDiv.parentElement&&this._fpsStatsElem.dom.appendChild(this._fpsStatsDiv),this._openFpsStatsCheck&&this._openFpsStatsCheck.setChecked(!0)},hideWatchStats:function(){this._showWatch&&(CC_JSB||b8e.isWeChatGame||this._watchStatsDiv&&this._watchStatsDiv.parentElement===this._watchStatsElem.dom&&this._watchStatsElem.dom.removeChild(this._watchStatsDiv),this._showWatch=!1,this._openWatchStatsCheck&&this._openWatchStatsCheck.setChecked(!1))},showWatchStats:function(){this._showWatch||(CC_JSB||b8e.isWeChatGame||null===this._watchStatsDiv.parentElement&&this._watchStatsElem.dom.appendChild(this._watchStatsDiv),this._showWatch=!0,this._openWatchStatsCheck&&this._openWatchStatsCheck.setChecked(!0),this.hideFpsStats(),this.hideInfoArea(),this.hideCtrlPanel())},initView:function(){this._super(),this._bodyElem=new b8e.DebugUI.Element(document.body),this._rootElem=new b8e.DebugUI.Div,this._rootElem.setZIndex(1e3),this._fpsStatsElem=new b8e.DebugUI.Div,this._rootElem.add(this._fpsStatsElem),this._watchStatsElem=new b8e.DebugUI.Div,this._rootElem.add(this._watchStatsElem),this._ctrlElem=new b8e.DebugUI.Div,this._rootElem.setPosition("absolute"),this._rootElem.setLeft("0px"),this._rootElem.setBottom("0px"),this._fpsStatsDiv=document.createElement("div"),this._fpsStatsDiv.id="fps_stats_div";var t=new b8e.Stats;this._fpsStats=t.init(this._fpsStatsDiv,{showGraph:!0,values:this._capabilityWatchs,fractions:[],extensions:["memory"],css:".stats {left: "+b8e.macro.PROFILER_POSITION.x+"px; bottom: "+b8e.macro.PROFILER_POSITION.y+"px;}"});var e={gameVersion:{desc:"Game Version"},engineVersion:{desc:"Engine Version"},resVersion:{desc:"Res Version"},isMobile:{desc:"Is Mobile"},textureFormat:{desc:"Texture Format"},runTime:{desc:"Run Time"},serverTime:{desc:"Server Time"},ping:{desc:"Ping (ms)"},framerate:{desc:"Framerate (FPS)"},renderType:{desc:"Render Type"},resCount:{desc:"Res Count"},netIo:{desc:"Net IO"},displayCount:{desc:"Display Count"},tickerCount:{desc:"Ticker Count"},timerCount:{desc:"Timer Count"},tweenCount:{desc:"Tween Count"},shaderCount:{desc:"Shader Count"},glProgramCount:{desc:"GLProgram Count"},sceneDisplay:{desc:"Scene Display"},tileCount:{desc:"Tile Count"},bufferCount:{desc:"Buffer Count"},instCount:{desc:"Inst Count"},clsCount:{desc:"Cls Count"},funcCount:{desc:"Func Count"},stageSize:{desc:"Stage Size"}};this._watchs.forEach(function(t){e[t.label]={desc:t.desc}},this),this._watchStatsDiv=document.createElement("div"),this._watchStatsDiv.id="watch_stats_div";var s=new b8e.Stats;this._watchStats=s.init(this._watchStatsDiv,{showGraph:!0,values:e,fractions:[],css:".stats {left: "+b8e.macro.PROFILER_POSITION.x+"px; bottom: "+b8e.macro.PROFILER_POSITION.y+"px;}"}),this._watchStats("gameVersion").value="V"+game.VERSION,this._watchStats("engineVersion").value="V"+b8e.VERSION,this._watchStats("resVersion").value="V"+b8e.res.getInitVersion()+"."+b8e.res.getVersion()+"."+b8e.res.getResVersion(),this._watchStats("isMobile").value=b8e.isMobile,this._watchStats("textureFormat").value=b8e.ResMgr.DEFAULT_FORMAT+"-"+b8e.Texture2D.DEFAULT_FORMAT;var i="";b8e.renderType===b8e.RenderType.CANVAS?i="canvas":b8e.renderType===b8e.RenderType.WEBGL&&(i="webgl"),this._watchStats("renderType").value=i;var n=this,o=b8e.macro.PROFILER_POSITION.x,a=b8e.macro.PROFILER_POSITION.y;o+=40,this._openFpsStatsCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"性能",function(t){t?n.showFpsStats():n.hideFpsStats()}),o+=30,this._openWatchStatsCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"状态",function(t){t?n.showWatchStats():n.hideWatchStats()}),o+=30,r=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"日志",function(t){t?n.updateInfoArea(0):n.updateInfoArea()},"#AAA"),this._areaChecks.push(r),o+=30;var r=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"信息",function(t){t?n.updateInfoArea(1):n.updateInfoArea()},"#00FF00");this._areaChecks.push(r),o+=30,r=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"警告",function(t){t?n.updateInfoArea(2):n.updateInfoArea()},"#FFFF00"),this._areaChecks.push(r),o+=30,r=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"错误",function(t){t?n.updateInfoArea(3):n.updateInfoArea()},"#FF0000"),this._areaChecks.push(r),o+=30,r=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"资源",function(t){t?n.updateInfoArea(4):n.updateInfoArea()},"#AAA"),this._areaChecks.push(r),o+=30,this._openCtrlPanelCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"控制",function(t){t?n.showCtrlPanel():n.hideCtrlPanel()}),o=b8e.macro.PROFILER_POSITION.x,a=b8e.macro.PROFILER_POSITION.y,a-=65,this._gcButton=new b8e.DebugUI.Button("G"),this._ctrlElem.add(this._gcButton),this._gcButton.setPosition("absolute"),this._gcButton.setWidth("28px"),this._gcButton.setLeft(o+"px"),this._gcButton.setBottom(a+"px"),this._gcButton.addEventListener("click",function(t){b8e.res.purge(!0),b8e.Toast.launch("执行GC！")}),o+=35,this._closeButton=new b8e.DebugUI.Button("C"),this._ctrlElem.add(this._closeButton),this._closeButton.setPosition("absolute"),this._closeButton.setWidth("28px"),this._closeButton.setLeft(o+"px"),this._closeButton.setBottom(a+"px"),this._closeButton.addEventListener("click",function(t){b8e.net.closeConnection()}),o+=35,this._resetButton=new b8e.DebugUI.Button("RS"),this._ctrlElem.add(this._resetButton),this._resetButton.setPosition("absolute"),this._resetButton.setWidth("28px"),this._resetButton.setLeft(o+"px"),this._resetButton.setBottom(a+"px"),this._resetButton.addEventListener("click",function(t){b8e.ticker.debugReset(),b8e.net.debugReset()}),o=b8e.macro.PROFILER_POSITION.x,a=b8e.macro.PROFILER_POSITION.y,a-=95,this._widthInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._widthInput),this._widthInput.setPosition("absolute"),this._widthInput.setWidth("28px"),this._widthInput.setLeft(o+"px"),this._widthInput.setBottom(a+"px"),o+=35,this._heightInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._heightInput),this._heightInput.setPosition("absolute"),this._heightInput.setWidth("28px"),this._heightInput.setLeft(o+"px"),this._heightInput.setBottom(a+"px"),o+=35,this._resizeButton=new b8e.DebugUI.Button("R"),this._ctrlElem.add(this._resizeButton),this._resizeButton.setPosition("absolute"),this._resizeButton.setWidth("28px"),this._resizeButton.setLeft(o+"px"),this._resizeButton.setBottom(a+"px"),this._resizeButton.addEventListener("click",function(t){b8e.SceneMgr.inst().setEmulatedScreenSize({width:parseInt(n._widthInput.getValue()),height:parseInt(n._heightInput.getValue())})}),o+=35,this._fpsInput=new b8e.DebugUI.Input(""),this._ctrlElem.add(this._fpsInput),this._fpsInput.setPosition("absolute"),this._fpsInput.setWidth("28px"),this._fpsInput.setLeft(o+"px"),this._fpsInput.setBottom(a+"px"),o+=35,this._fpsButton=new b8e.DebugUI.Button("F"),this._ctrlElem.add(this._fpsButton),this._fpsButton.setPosition("absolute"),this._fpsButton.setWidth("28px"),this._fpsButton.setLeft(o+"px"),this._fpsButton.setBottom(a+"px"),this._fpsButton.addEventListener("click",function(t){b8e.startup.setFrameRate(parseInt(n._fpsInput.getValue()))}),o=b8e.macro.PROFILER_POSITION.x,a=b8e.macro.PROFILER_POSITION.y,a-=95,this._activateCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"ACT",function(t){t?b8e.startup.activate():b8e.startup.deactivate()}),cc.game.on(cc.game.EVENT_SHOW,function(){n._activateCheck.setChecked(!0)}),cc.game.on(cc.game.EVENT_HIDE,function(){n._activateCheck.setChecked(!1)}),this._activateCheck.setChecked(b8e.isActivated),o+=30,this._cacheCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"缓存",function(t){t?b8e.res.setUseCache(!0):b8e.res.setUseCache(!1)}),this._cacheCheck.setChecked(!0),o+=30,this._useImgCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"IMG",function(t){b8e.ResMgr.ALLOW_SET_DEFAULT_FORMAT?b8e.ResMgr.DEFAULT_FORMAT=t?"img":"png":(n._useImgCheck.setChecked("img"==b8e.ResMgr.DEFAULT_FORMAT),b8e.Toast.launch("在动画加载前才允许切换格式！"))}),this._useImgCheck.setChecked("img"==b8e.ResMgr.DEFAULT_FORMAT),o+=30,this._guiCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"GUI",function(t){t?b8e.layer.getGuiLayer().setVisible(!0):b8e.layer.getGuiLayer().setVisible(!1)}),this._guiCheck.setChecked(!0),o+=30,this._sceneCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"场景",function(t){t?b8e.layer.getSceneLayer().setVisible(!0):b8e.layer.getSceneLayer().setVisible(!1)}),this._sceneCheck.setChecked(!0),o+=30,this._tickCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"TIC",function(t){t?b8e.ticker.setPaused(!1):b8e.ticker.setPaused(!0)}),this._tickCheck.setChecked(!0),o+=30,this._tweenCheck=new b8e.ProfilerCheckbox(this._ctrlElem,o,a,"TWE",function(t){b8e.Tween.tickPaused=!t}),this._tweenCheck.setChecked(!0)},_showOpenButton:function(){var e=this,t=b8e.macro.PROFILER_POSITION.x,s=b8e.macro.PROFILER_POSITION.y;this._openButton=new b8e.DebugUI.Button("P"),this._rootElem.add(this._openButton),this._openButton.setPosition("absolute"),this._openButton.setWidth("28px"),this._openButton.setLeft(t+"px"),this._openButton.setBottom(Number(s-35)+"px"),this._openButton.addEventListener("click",function(t){e._isShowCtrl?(e._rootElem.remove(e._ctrlElem),e.hideFpsStats(),e.hideWatchStats(),e.hideInfoArea(),e.hideCtrlPanel(),e._isShowCtrl=!1):(e._rootElem.add(e._ctrlElem),e.showFpsStats(),e._isShowCtrl=!0)})},showCtrlPanel:function(){if(!this._ctrlPanel){var t=this._testItems.length;this._ctrlPanel=new b8e.DebugUI.Div,this._ctrlPanel.setWidth("300px"),0<t?this._ctrlPanel.setHeight(30*((t-1)/3>>0)+38+"px"):this._ctrlPanel.setHeight("0px"),this._ctrlPanel.setPosition("absolute"),this._ctrlPanel.setLeft(b8e.macro.PROFILER_POSITION.x+"px"),this._ctrlPanel.setBottom(b8e.macro.PROFILER_POSITION.y+"px"),this._ctrlPanel.setBackgroundColor("rgba(0,0,0,0.2)"),this._ctrlPanel.setBorder("1px solid #444");for(var e=0,s=0,i=0;i<t;i++){e=i%3*100+8,s=30*(i/3>>0)+8;var n=this._testItems[i],o=n.label,a=new b8e.DebugUI.Input("");this._ctrlPanel.add(a),(n.input=a).setPosition("absolute"),a.setWidth("36px"),a.setLeft(e+"px"),a.setBottom(s+"px"),e+=40;var r=new b8e.DebugUI.Button(o);this._ctrlPanel.add(r),r.dom._item=n,r.setPosition("absolute"),r.setWidth("46px"),r.setHeight("22px"),r.setLeft(e+"px"),r.setBottom(s+"px"),r.addEventListener("click",function(t){var e=this._item,s=e.input,i=e.handler,n=e.thisArg;i?i.call(n,s.getValue()):b8e.Toast.launch("可以使用engine.profiler.addTestItem添加测试处理项！(输入值："+s.getValue()+")")})}}this._rootElem.add(this._ctrlPanel),this._openCtrlPanelCheck&&this._openCtrlPanelCheck.setChecked(!0),this.hideFpsStats(),this.hideWatchStats(),this.hideInfoArea()},hideCtrlPanel:function(){this._ctrlPanel&&this._rootElem.remove(this._ctrlPanel),this._openCtrlPanelCheck&&this._openCtrlPanelCheck.setChecked(!1)},updateInfoArea:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,s=this._areaChecks.length;for(t=0;t<s;t++){var i=this._areaChecks[t];t==e?i.setChecked(!0):i.setChecked(!1)}for(t=0;t<s;t++){if((i=this._areaChecks[t]).getChecked())return void this.showInfoArea(t)}this._msgElem&&(this._msgArea.setValue(""),this._rootElem.remove(this._msgElem)),this._showInfo=!1},showInfoArea:function(t){this._currInfoType=t,this._msgElem||(this._msgElem=new b8e.DebugUI.Div),this._msgArea||(this._msgArea=new b8e.DebugUI.TextArea,this._msgArea.setReadOnly(!0),this._msgArea.setPosition("absolute"),this._msgArea.setResize("none"),this._msgArea.setBackground("#444"),this._msgArea.setWidth("300px"),this._msgArea.setHeight("300px"),this._msgArea.setLeft(b8e.macro.PROFILER_POSITION.x+"px"),this._msgArea.setBottom(b8e.macro.PROFILER_POSITION.y+"px"),this._msgElem.add(this._msgArea)),this._rootElem.add(this._msgElem),0==t?(this._msgArea.setColor("#AAA"),this.updateInfo(this._logMsg)):1==t?(this._msgArea.setColor("#00FF00"),this.updateInfo(this._infoMsg)):2==t?(this._msgArea.setColor("#FFFF00"),this.updateInfo(this._warnMsg)):3==t?(this._msgArea.setColor("#FF0000"),this.updateInfo(this._errorMsg)):4==t&&(this._msgArea.setColor("#AAA"),this.updateInfo(this._resMsg)),this._showInfo=!0,this.hideFpsStats(),this.hideWatchStats(),this.hideCtrlPanel()},hideInfoArea:function(){this.updateInfoArea()},updateInfo:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,s=t.join("\n\n");0<e&&s.length>e&&(s=s.substr(0,e)),this._msgArea.setValue(s)}});b8e.ProfilerCheckbox=b8e.Object.extends({_label:null,_check:null,ctor:function(t,e,s,i,n){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"#AAA";this._super(),this._label=new b8e.DebugUI.Text(i),this._label.setColor(o),t.add(this._label),this._label.setPosition("absolute"),this._label.setLeft(e+"px"),this._label.setBottom(Number(s-20)+"px"),this._check=new b8e.DebugUI.Checkbox(!1),t.add(this._check),this._check.setPosition("absolute"),this._check.setLeft(e+"px"),this._check.setBottom(Number(s-40)+"px");var a=this;this._check.addEventListener("change",function(t){n(a._check.getValue())})},setChecked:function(t){this._check.setValue(t)},getChecked:function(){return this._check.getValue()}})},{}],8:[function(t,e,s){"use strict";b8e.Stats=b8e.Object.extends({_stats:null,_root:null,ctor:function(){this._super();var t=function(t,e){this._color=e||"#666",this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvasDot=document.createElement("canvas"),this._ctxDot=this._canvasDot.getContext("2d"),this._canvasAlarm=document.createElement("canvas"),this._ctxAlarm=this._canvasAlarm.getContext("2d"),this._canvas.className="stats-canvas",t.appendChild(this._canvas)};t.prototype.init=function(t,e){this._canvas.width=t,this._canvas.height=e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px",this._ctx.fillStyle="#444",this._ctx.fillRect(0,0,t,e),this._canvasDot.width=1,this._canvasDot.height=2*e,this._ctxDot.fillStyle="#444",this._ctxDot.fillRect(0,0,1,2*e),this._ctxDot.fillStyle=this._color,this._ctxDot.fillRect(0,e,1,e),this._ctxDot.fillStyle="#fff",this._ctxDot.globalAlpha=.5,this._ctxDot.fillRect(0,e,1,1),this._ctxDot.globalAlpha=1,this._canvasAlarm.width=1,this._canvasAlarm.height=2*e,this._ctxAlarm.fillStyle="#444",this._ctxAlarm.fillRect(0,0,1,2*e),this._ctxAlarm.fillStyle="#b70000",this._ctxAlarm.fillRect(0,e,1,e),this._ctxAlarm.globalAlpha=.5,this._ctxAlarm.fillStyle="#fff",this._ctxAlarm.fillRect(0,e,1,1),this._ctxAlarm.globalAlpha=1};(function(s){function t(t,e){s.call(this,t,e),this._current=0,this._max=0}s&&(t.prototype=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.draw=function(t,e){this._current+=.1*(t-this._current),this._max*=.99,this._current>this._max&&(this._max=this._current);var s=Math.round(-this._canvas.height*this._current/this._max);this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height),e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,s):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,s)}})(t),function(s){function t(t,e){s.call(this,t,e),this._threshold=0,this._canvas2=document.createElement("canvas"),this._ctx2=this._canvas2.getContext("2d")}s&&(t.prototype=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.init=function(t,e){s.prototype.init.call(this,t,e),this._canvas2.width=t,this._canvas2.height=e,this._ctx2.fillStyle="#444",this._ctx2.fillRect(0,0,t,e)},t.prototype.draw=function(t,e){if(t>this._threshold){var s=(t-t%this._canvas.height)/this._canvas.height,i=this._canvas.height*(s+1),n=this._threshold/(this._threshold=i);this._ctx2.drawImage(this._canvas,0,0),this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height),this._ctx.drawImage(this._canvas2,1,0,this._canvas.width-1,this._canvas.height,0,(1-n)*this._canvas.height,this._canvas.width-1,this._canvas.height)}else this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height);var o=Math.round(-this._canvas.height*t/this._threshold);e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,o):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,o)}}(t),function(n){function t(t,e,s,i){n.call(this,t,e),this._min=s,this._max=i}n&&(t.prototype=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.draw=function(t,e){var s=(t-this._min)/(this._max-this._min),i=-Math.ceil(this._canvas.height*s);this._ctx.drawImage(this._canvas,1,0,this._canvas.width-1,this._canvas.height,0,0,this._canvas.width-1,this._canvas.height),e?this._ctx.drawImage(this._canvasAlarm,this._canvas.width-1,i):this._ctx.drawImage(this._canvasDot,this._canvas.width-1,i)}}(t);var e=function(t,e){this._id=t,this._opts=e||{},this._value=0,this._total=0,this._averageValue=0,this._accumValue=0,this._accumSamples=0,this._accumStart=b8e.getNow()},s={value:{}};e.prototype._average=function(t){if(this._opts.average){this._accumValue+=t,++this._accumSamples;var e=b8e.getNow();e-this._accumStart>=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=e,this._accumSamples=0)}},s.value.get=function(){return this._value},s.value.set=function(t){this._value=t},e.prototype.sample=function(){"number"==typeof this._value&&this._average(this._value)},e.prototype.human=function(){if("number"==typeof this._value){var t=this._opts.average?this._averageValue:this._value;return Math.round(100*t)/100}return this._value},e.prototype.alarm=function(){return"number"==typeof this._value&&(this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over)},Object.defineProperties(e.prototype,s);var a=function(s){function t(t,e){s.call(this,t,e),this._time=b8e.getNow()}return s&&(t.prototype=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.start=function(){this._time=b8e.getNow()},t.prototype.end=function(){this._value=b8e.getNow()-this._time,this._average(this._value)},t.prototype.tick=function(){this.end(),this.start()},t.prototype.frame=function(){var t=b8e.getNow(),e=t-this._time;this._total++,(this._opts.average||1e3)<e&&(this._value=1e3*this._total/e,this._total=0,this._time=t,this._average(this._value))},t}(e),i=function(i){function t(t,e,s){i.call(this,e,s),this._stats=t,(this._start=0)===s.extension.indexOf("memory.")&&(this._field=s.extension.substring(7))}return i&&(t.prototype=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.snapshot=function(){this._value=this._stats[this._field]},t.prototype.start=function(){this._start=this._stats[this._field]},t.prototype.end=function(){this._value=this._stats[this._field]-this._start},t.prototype.human=function(){var t=i.prototype.human.call(this);return t?b8e.StringUtil.bytesToSize(t):"n/a"},t}(e),n=function(){window.performance.memory.totalJSHeapSize,this._used=0,this._total=0,this._limit=0,this._lastUsed=0},o={alarm:{},used:{},total:{},limit:{}};n.prototype.tick=function(){this._lastUsed=this._used,this._used=window.performance.memory.usedJSHeapSize,this._total=window.performance.memory.totalJSHeapSize,this._limit=window.performance.memory.jsHeapSizeLimit},o.alarm.get=function(){return this._used-this._lastUsed<0},o.used.get=function(){return this._used},o.total.get=function(){return this._total},o.limit.get=function(){return this._limit},n.prototype.counter=function(t,e){return new i(this,t,e)},Object.defineProperties(n.prototype,o);var S={memory:n},r=document.createElement("style");r.type="text/css",r.textContent="\n  .stats {\n    position: absolute;\n    z-index: 9999;\n\n    padding: 5px;\n    width: 150px;\n    right: 0;\n    bottom: 0;\n\n    font-size: 10px;\n    font-family: 'Roboto Condensed', tahoma, sans-serif;\n    overflow: hidden;\n    user-select: none;\n    cursor: default;\n\n    background: #222;\n    border-radius: 3px;\n\n  }\n\n  .stats-container {\n    display: flex;\n    flex-direction: column;\n    color: #888;\n    white-space: nowrap;\n  }\n\n.stats-item {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    border-bottom:1px solid #333;\n    }\n\n.stats-label {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n\n    text-align: left;\n    margin-right: 0px;\n\n    transition: background 0.3s;\n  }\n\n  .stats-label.alarm {\n    color: #ccc;\n    background: #800;\n\n    transition: background 0s;\n  }\n\n  .stats-counter-id {\n    flex: 1;\n  }\n\n  .stats-counter-value {\n    flex: 1;\n    text-align: right;\n  }\n\n  .stats-fraction {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-top: 1px;\n    margin-bottom: 1px;\n  }\n\n  .stats-legend {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n\n    text-align: right;\n    margin-right: 5px;\n  }\n.stats-canvas {\nwidth: 150px;\nheight: 10px;\n}\n",document.head.appendChild(r);var h=function(t,e){if(e=e||{},this._values=e.values||{},this._fractions=e.fractions||[],this._id2counter={},this._id2item={},this._name2extStats={},e.css){var s=document.createElement("style");s.type="text/css",s.textContent=e.css,document.head.appendChild(s)}if(e.extensions)for(var i=0;i<e.extensions.length;++i){var n=e.extensions[i],o=S[n];o?this._name2extStats[n]=new o:b8e.warn("Can not find extensions "+n+", please register your extension via stats.register().")}this._root=document.createElement("div"),this._root.className="stats";var a=document.createElement("div");a.className="stats-container",this._root.appendChild(a);var r=0;for(var h in this._values){var c=this._values[h],l=document.createElement("div");l.className="stats-item",l.style.top=12*r+"px";var u=document.createElement("div");u.className="stats-label";var d=document.createElement("span");d.className="stats-counter-id",d.textContent=c.desc||h;var p=document.createElement("div");p.className="stats-counter-value";var _=document.createTextNode("");_.nodeValue="0",u.appendChild(d),u.appendChild(p),p.appendChild(_),l.appendChild(u),this._id2item[h]={label:u,valueText:_},a.appendChild(l),r++}if(a.style.height=12*r,e.fractions)for(var m=0;m<e.fractions.length;++m){var f=e.fractions[m];f.colors=f.colors||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];var g=document.createElement("div");g.className="stats-fraction";var v=document.createElement("div");v.className="stats-legend";for(var b=f.steps,C=0;C<b.length;++C){var y=document.createElement("span");y.textContent=b[C],y.style.color=f.colors[C],v.appendChild(y)}g.appendChild(v),g.style.height=10*b.length+"px",f.values=new Array(b.length),a.appendChild(g)}t.appendChild(this._root)};h.prototype.item=function(t){if(!t)return null;var e=this._id2counter[t];if(e)return e;var s=this._values[t];if(!s)return null;if(s.extension){var i=s.extension.indexOf("."),n=s.extension.substring(0,i),o=this._name2extStats[n];if(!o)return b8e.error("extension "+n+" not found, make sure you have register and enable it."),null;e=o.counter(t,s)}else e=new a(t,s);return this._id2counter[t]=e},h.prototype.tick=function(){var t=this;for(var e in t._name2extStats){t._name2extStats[e].tick()}for(var s in t._values){var i=t._id2counter[s];if(i){i.sample();var n=i.alarm(),o=i.human(),a=t._id2item[s];a.label.classList.toggle("alarm",0<n),a.valueText.nodeValue=o}}for(var r=0;r<this._fractions.length;++r){var h=t._fractions[r],c=t._id2counter[h.base];if(c)for(var l=h.steps,u=0;u<l.length;++u){var d=l[u],p=t._id2counter[d];p&&(h.values[u]=p.value/c.value)}}},this._stats={new:function(t,e){var s=new h(t,e);return function(t){return t?s.item(t):s}},register:function(t,e){S[t]=e}}},init:function(t,e){return this._stats.new(t,e)},getRoot:function(){return this._root}})},{}]},{},[1,3,4,5,6,7,8,2]);